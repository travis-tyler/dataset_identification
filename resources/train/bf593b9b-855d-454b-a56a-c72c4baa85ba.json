[{"section_title": "Abstract", "text": "Accurate and consistent skull stripping of serial brain MR images is of great importance in longitudinal studies that aim to detect subtle brain morphological changes. To avoid inconsistency and the potential bias introduced by independently performing skull-stripping for each time-point image, we propose an effective method that is capable of skull-stripping serial brain MR images simultaneously. Specifically, all serial images of the same subject are first affine aligned in a groupwise manner to a common space to avoid any potential bias introduced by asymmetric transforms. A brain probability map, which encapsulates prior information gathered from a population of real brain MR images, is then warped to the aligned serial images for guiding skull-stripping via a deformable surface method. In particular, the same initial surface meshes representing the initial brain surfaces are first placed on all aligned serial images, and then all these surface meshes are simultaneously evolved to the respective target brain boundaries, driven by the intensity-based force, the force from the probability map, as well as the force from the spatial and temporal smoothness. Especially, imposing the temporal smoothness helps achieve longitudinally consistent results. Evaluations on 20 subjects, each with 4 time points, from the ADNI database indicate that our method gives more accurate and consistent result compared with 3D skull-stripping method. To better show the advantages of our 4D brain extraction method over the 3D method, we compute the Dice ratio in a ring area (\u00b15mm) surrounding the ground-truth brain boundary, and our 4D method achieves around 3% improvement over the 3D method. In addition, our 4D method also gives smaller mean and maximal surfaceto-surface distance measurements, with reduced variances."}, {"section_title": "INTRODUCTION", "text": "Longitudinal data analyses are especially useful in delineating changes in brain structures during the normal aging [1] , as well as in evaluating the temporal progression of neuropathology, such as Alzheimer's disease (AD). Brain volume loss and cortical thinning are observed even in healthy subjects during aging in old individuals. Researches on changes of brain volume [2] and cortical thickness [3] is used for detecting subtle changes in brain structure in cognitively normal subjects at the risk of developing AD and in subjects with mild cognitive impairment (MCI). In the longitudinal studies, it is critical and essential that the methods do not themselves introduce any bias. Methodological biases could confound placebo-treatment comparisons in trials, and the biased measurements from a pilot study could lead to under-powering or over-powering of subsequent trials, with ethical as well as scientific and financial implications [4] . Research on potential biases introduced by the interpolation methods and registration methods is presented for consistent brain atrophy estimation [5] ; while there is no related research on the potential biases introduced by the inconsistent skull stripping in the longitudinal study pipeline. In the last decade, many methods are proposed for automated skull stripping of a single brain image. For studying longitudinal changes of cortical structures in relation to brain development, aging, and diseases, more accurate and consistent skull stripping methods are required for serial brain MR images, especially for measuring subtle cortical changes. However, applying the existing methods independently for skull stripping of serial brain MR images in a longitudinal study may generate longitudinally inconsistent results and introduce bias by the interpolation and registration. As the first step in most neuroimaging processing pipelines, the bias and inconsistency in skull stripping will be propagated to the following steps, such as tissue segmentation, image registration, and group analysis. This paper presents a new method for consistent skull stripping of serial brain MR images by using a 4D deformablesurface based approach, built on our previous work [6] . Specially, all serial brain MR images of the same subject are groupwise affine aligned to a common space to avoid any bias by asymmetric transforms. A brain probability map, which encapsulates prior information gathered from a population of real brain MR images, is warped to the groupwise affine aligned serial images for guiding the deformable surface evolution. The same initial surface meshes are placed on all aligned serial images. With the temporal smoothness constraint on each vertex, all these surface meshes evolve simultaneously for all time-point serial images, thus achieving more accurate and consistent results."}, {"section_title": "METHOD", "text": ""}, {"section_title": "Overview", "text": "The proposed method consists of the following major steps: 1) Groupwise affine alignment of all serial brain MR images of the same subject; 2) Initialization by warping a brain probability map, which is obtained by warping a set of real brain MR images with manually delineated brain masks to the template space, to the aligned serial images and placing the initial surface meshes for all serial images; 3) Consistently evolving the initial surface meshes on all serial images simultaneously using a deformable-surface method with the temporal constraint, guided by intensity information as well as the brain probability map. The details of each step are given in the following sections."}, {"section_title": "Groupwise Affine Registration", "text": "To consider all serial images of the same subject simultaneously, all serial images need to be aligned to a common space. To avoid any possible bias introduced by asymmetric registration to a specific time point, groupwise affine registration is performed on the serial images of the same subject by using the congealing method [7] . This method was first introduced by Miller et al. [8] by considering the sum of univariate entropies along pixel stacks as a joint alignment criterion. Z\u00f6llei et al. [9] further extended this method to groupwise registration of medical images using affine transforms. Here we use the open-source implementation of the congealing method in ITK by Balci et al. [7] . Specifically, it optimizes the objective function using the gradient descent algorithm combined with a line search for the step size and is efficiently implemented by using a stochastic optimization scheme embedded in a multi-resolution setting. After groupwise affine registration, all serial images of the same subject are now located in the same space."}, {"section_title": "Initialization and Parameter Estimation", "text": "A good initialization of the deformable surface is important for avoiding local minima and suboptimal solutions. To facilitate more accurate parameter estimation and better positioning of the initial deformable surface, FLIRT (for affine registration) and Demons (for non-linear registration) are employed to help mask out most of the non-brain voxels. More specifically, the ICBM high-resolution single subject template (with skull) is warped to the aligned serial images by using FLIRT, followed by Demons. The accompanying brain probability map (binarized with the threshold 0), which is obtained by warping a set of real brain MR images with manually delineated brain masks to the template space, is used to mask the image at each time point for approximate skull stripping.\nAfter the initial skull stripping, most of the skull and scalp are removed. The resulting serial brain images are used to estimate a set of parameters for describing the image intensity distribution for each serial image: intensity minimum , intensity maximum , the intensity threshold separating brain and non-brain matters , and the median intensity . All voxels with intensity between and are regarded as brain voxels and are used as mass to weight the position of the voxels for the computation of the center of gravity (COG). Regarding these voxels as forming a spherical volume, the radius of the brain can be estimated. Finally, the COG and radius for all serial images of the target subject are obtained by averaging the COGs and radii obtained from all the serial images, and further used to initialize the brain surface model on all serial images."}, {"section_title": "4D Deformable-Surface-Based Skull Stripping", "text": "The 4D deformable-surface evolution is implemented by a parametric active surface, and the brain boundary is modeled by a surface tessellated using connected triangles. The surface is initialized as a sphere for all serial images using the COG and radius estimated in the previous step. From the initial position, the surface evolves gradually to the optimal position, one vertex at a time, driven by four forces as detailed below: 1) the spatial-smoothness-constrained force; 2) the intensity-based force; 3) the probability-map-guided force; and 4) the temporal-smoothness-constrained force.\nFor the vertex of the -th time-point image of a subject, the first force pertaining to the spatial smoothness constraint consists of two parts:\nwhere and are the tangential and normal components of . For the current vertex , is the difference vector between the position of the current vertex and the mean position of its one-ring neighboring vertices, which is defined as = \u2211 \u2212 . The sole role of is to shift the vertices along the surface to keep them equally spaced; while acts parallel to the local normal to move the current vertex into the plane formed by its neighbors to increase the smoothness of the surface. In Equation (1), is usually set as 0.5, and is defined as a nonlinear sigmoid function adaptive to the local surface geometry (i.e., local brain curvature) [6] .\nThe second force is from the intensity information in the surface vicinity, and it acts along the local surface normal . It accounts for the voxel intensity changes in the surface vicinity for each serial image, aiming to drive the surface model to move towards the real brain surface. For the vertex , the intensity-based force imposed on the -th time-point image of a subject is thus given as:\nwhere and are the local minimum and maximum intensity of the -th time-point image and defined by searching along the normal direction pointing inwards from the current vertex :\nwhere and represent the spatial search ranges pertaining to the minimum and maximum intensities, respectively. ( ) is the intensity of a voxel on the searching line with the mm away from the current vertex. Typically, is fixed on 20 mm for each image and = 2 \u2044 . As described in Section 2.3, for the -th time-point image, the image intensity minimum , the median intensity , and the threshold separating brain and non-brain matters are approximately estimated according to the intensity distribution of the initial skull-stripped brain image of the -th timepoint image. These values are used to help avoid outlier voxels that are too dark or too bright.\nin Equation (2) is a locally estimated intensity threshold which is used to distinguish between brain and non-brain tissues in the -th time point image:\nwhere parameter is called the fractional intensity threshold and [0,1].\nRelying on image intensity information alone to localize the brain boundary are relatively susceptible to local minima because of artifacts introduced by the noise or intensity inhomogeneity. Thus the brain probability map, encapsulating prior information gathered from a population of real brain MR images, is used to impose realistic shape and topological constraints for guiding the surface deformation, thus minimize the chances of falling into less desirable sub-optimal regions. Therefore, for the current vertex , the third force derived from the warped brain probability map is introduced for the -th time-point image:\nwhere [0,1] is the probability value from the warped probability map.\nTo force temporal consistency, the temporal smoothness constraint is also imposed on the -th time-point image at the current vertex : \nwhere M represents the set of the temporal neighborhood of the -th time point, i.e., M = ( \u2212 2, \u2212 1, + 1, + 2) \u22c2(1, \u2026 , ) , is the total number of serial images of a subject, and = ( ) \u2044 . Here is set as 2.73 experimentally.\nThus, at iteration , for each vertex in the -th time point, its updated position is:\nwhere = = 0.05 * ; = 0.1. Here is the mean inter-vertex distance over the whole surface, calculated from each vertex to its one-ring neighboring vertices."}, {"section_title": "EXPERIMENTAL RESULTS", "text": "The proposed algorithm is evaluated on the ADNI dataset. 20 Health Control (HC) subjects (age range: 55~90 years) each with 4 time points (with scan time interval of 6 months or 12 months) are randomly selected and used for validation. Before skull-stripping, all images were resampled to be of dimensions 256\u00d7256\u00d7256 and resolution 1\u00d71\u00d71 mm 3 . Nonparametric nonuniform intensity normalization (N3) [10] and histogram matching were performed before group-wise alignment. To better validate the effectiveness of our method, the proposed method is compared with our previously proposed 3D brain extraction method (without temporal constraint) [6] , which has demonstrated state-of-theart performance."}, {"section_title": "Overlap Consistency", "text": "Let and represent for the extracted brain image and the manual skull-stripped image (ground truth), respectively. Their similarity is calculated using the Dice ratio: ( , ) = 2| \u22c2 |/(| | + | |). To better show the difference between our 4D method and the 3D method, Dice ratio is calculated in the ring area (\u00b15mm) around the ground-truth brain boundary for each time point. As can be seen from Figure 1 , the proposed 4D brain extraction method has better performance than our previously proposed 3D method, with the results of the 4D method around 3% superior to the result of the 3D method. Typical skull-stripping results by our 4D method compared with our previous 3D method are shown in Figure 2 , where two subjects with each having 4-time-point serial images are shown. Due to the existence of artifacts introduced by noise or intensity inhomogeneity, independent skull-stripping of each time-point image of one subject is likely causing some time-point image to be trapped into local minima during the evolution of the deformable surface, e.g., the first-time-point image in subject (I) and the fourth-time-point image in subject (II), both with some nonbrain tissues unremoved. It can be observed from Figure 2 that the 4D method gives more consistent and accurate results by accounting for the longitudinal information simultaneously. "}, {"section_title": "Surface", "text": "To further v symmetric su are used to m shape differe surface-to-su boundary vo boundary vo maximal sym estimated bo proposed 4D with less var 1.1mm, com about 5.0mm ning is expecte as 1 year) is g hanges [11] "}]
[{"section_title": "Abstract", "text": "Abstract Predetermination of background error covariance matrix B is challenging in existing ocean data assimilation schemes such as the optimal interpolation (OI). An optimal spectral decomposition (OSD) has been developed to overcome such difficulty without using the B matrix. The basis functions are eigenvectors of the horizontal Laplacian operator, pre-calculated on the base of ocean topography, and independent on any observational data and background fields. Minimization of analysis error variance is achieved by optimal selection of the spectral coefficients. Optimal mode truncation is dependent on the observational data and observational error variance and determined using the steep-descending method. Analytical 2D fields of large and small mesoscale eddies with white Gaussian noises inside a domain with four rigid and curved boundaries are used to demonstrate the capability of the OSD method. The overall error reduction using the OSD is evident in comparison to the OI scheme. Synoptic monthly gridded world ocean temperature, salinity, and absolute geostrophic velocity datasets produced with the OSD method and quality controlled by the NOAA National Centers for Environmental Information (NCEI) are also presented."}, {"section_title": "Introduction", "text": "In ocean data assimilation (or analysis), the coordinates (x, y, z) are usually represented by the position vector r with grid points represented by r n , n = 1, 2, \u2026, N, and observational locations represented by r (m) , m = 1, 2, \u2026, M. Here, N is the total number of the grid points, and M is the total number of observational points. A single or multiple variables c = (u, v, T, S, \u2026), no matter two or three dimensional, can be ordered by grid point and by variable, forming a single vector of length NP with N the total number of grid points and P the number of variables. For multiple variables, non-dimensionalization is conducted before forming a single vector c (Chu et al. 2015) with \"true\", analysis, and background fields (c t , c a , c b ) and observational data (c o ) being represented by N and M dimensional vectors, \nrepresents the difference between the observational and background data at the observational points r (m) .\nHere, H = [h mn ] is an M \u00d7 N linear observation operator matrix converting the background field c b (at the grid points, r n ) into \"first guess observations\" at the observational points r (m) (Fig. 1 ). The analysis error (\u03b5 a ) and observational error (\u03b5 o ) are defined by\nwhich are evaluated at the grid points. The two errors are usually independent of each other,\nMinimization of the analysis error variance\ngives the optimal analysis field c a for the \"true\" field c t .\nA common practice in ocean data assimilation (or analysis) is to use a N \u00d7 M weight matrix W = [w nm ] to blend c b (at the grid points r n ) with innovation d (at observational points r (m) ) (Evensen 2003; Tang and Kleeman 2004; Chu et al. 2004a; Galanis et al. 2006; Oke et al. 2008; Han et al. 2013; Yan et al. 2015 )\nMinimization of the analysis error variance with respect to weights,\ndetermines the weight matrix\nHere, B is the N \u00d7 N background error covariance matrix; R is the M \u00d7 M observational error covariance matrix and is usually simplified as a product of an observational error variance (e 2 o ) and an identity matrix I,\nSubstitution of (7) into (5) leads to the optimal interpolation (OI) equation,\nwhich produces the analysis field c a from the innovation d.\nThe challenge for the OI method is the determination of the background error covariance matrix B.\nAn alternative approach is to use a spectral method with lateral boundary (\u0413) information to decompose the variable anomaly at the grid points [c(r n ) \u2212 c b (r n )] into (Chu et al. 2015) ,\nwhere {\u03d5 k } are basis functions; K is the mode truncation. The eigenvectors of the Laplace operator with the same lateral boundary condition of (c \u2212 c b ) can be used as the set of the basis functions {\u03d5 k } and written in matrix (Chu et al. 2015 )\nFor a given mode truncation K, minimization of the analysis error variance (4) with respect to the spectral coefficients\ngives the spectral ocean data assimilation equation (Chu et al. 2004b (Chu et al. , 2015 ,\nwhere F is an N \u00d7 N (diagonal) observational contribution matrix Here, the matrices \u03a6, F, and H are all given in comparison to the OI Eq. (9) where the background error covariance matrix B needs to be determined.\nThis spectral method has been proven effective for the ocean data analysis. Chu et al. (2003a, b) named the spectral method as the optimal spectral decomposition (OSD). With it, several new ocean phenomena have been identified from observational data such as a bi-modal structure of chlorophyll-a with winter/spring (FebruaryMarch) and fall (September-October) blooms in the Black Sea (Chu et al. 2005a) , fall-winter recurrence of current reversal from westward to eastward on the Texas-Louisiana continental shelf from the current-meter, near-surface drifting buoy (Chu et al. 2005b) , propagation of long Rossby waves at mid-depths (around 1000 m) in the tropical North Atlantic from the Argo float data (Chu et al. 2007) , and temporal and spatial variability of the global upper ocean heat content (Chu 2011) from the data of the Global Temperature and Salinity Profile Program (GTSPP, Sun et al. 2009 ).\nThe spectral mode truncation is the key for the success of the OSD method. It acts as a spatial low pass filter for the fields to allow the highest wave numbers corresponding to the highest spectral eigenvalues without aliasing due to the information provided from the observational network.\nQuestions arise: Can a simple and effective mode truncation method be developed to take into account of model resolution (i.e., total number of model grid points)? What are the major differences between OI and OSD? What is the quality and uncertainty of the OSD method? The purpose of this paper is to answer these questions. The remainder of the paper is organized as follows. Section 2 describes error analysis. Section 3 presents the steep-descending mode truncation method. Section 4 shows idealized \"truth\" and \"observational\" fields. Section 5 compares analysis fields between OSD and OI. Section 6 introduces three synoptic monthly gridded world ocean temperature, salinity, and absolute geostrophic velocity datasets produced with the OSD method and quality controlled by the NOAA National Centers for Environmental Information (NCEI). Conclusions are given in Section 7. Appendices A and B briefly describe several methods to determine the H matrix. Appendix C shows the determination of basis functions. Appendix D presents the Vapnik-Chervonenkis dimension for mode truncation. Appendix E depicts a special B matrix for this study."}, {"section_title": "Error analysis", "text": "Low mode truncation does not represent the reality well, while high mode truncation may contain too much noise. Let the truncated spectral representation s K in (10) at the grid points form an N-dimensional vector,\nThe\nwhere D(r n ) represents the observational innovation at the grid points,\nFrom Eq. (3a), observations at grid points are computed using c o (r n ) = H T c o (r m ). The original background state, c b (r n ), keeps in the grid space. The matrix form of (16) is where f n denotes contribution of all observational data unto the grid point r n . The larger the value of f n , the larger the observational influence on that grid point (r n ). D is an N-dimensional vector at the grid points,\nThe analysis error (i.e., analysis c a versus \"truth\" c t ) in the spectral data assimilation [see (10)] is given by\nHere, (10) and (17) are used. The analysis error is decomposed into two parts\nwith the truncation error given by\nand the observational error given by\n3 Steep-descending mode truncation\nThe Vapnik-Chervonenkis dimension (Vapnik 1983; Chu et al. 2003a Chu et al. , 2015 was used to determine the optimal mode truncation K OPT . As depicted in Appendix D, it depends only on the ratio of the total number of observational points (M) versus spectral truncation (K) and does not depend on the total number of model grid (32) points (N). This method neglects observational error and ignores the model resolution. In fact, the analysis error variance over the whole domain is given by\nwhere e 2 o is the observational error variance [see (8)]. Here, the observational error is assumaed the same at grid points as at the grid points. This is due to the simplification of the error covariance matrix\nBoth E K and E K-1 are large for small K (low-mode truncation), which may lead to a small value of \u03b3 K . Both E K and E K-1 are small for large K (high-mode truncation), which also leads to a small value of \u03b3 K . An optimal truncation should be between the low-mode and high-mode truncations with a larger value (over a threshold) of \u03b3 K . This procedure is illustrated as follows. The values (\u03b3 2 , \u03b3 2 , \u2026, \u03b3 KB ) are calculated using (25) from a large K B (say 250). The mean and standard deviation of \u03b3 can be computed as,\nSuppose that the relative error reductions (\u03b3 2 , \u03b3 3 , \u2026, \u03b3 KB ) satisfy the Gaussian distribution. A 100(1 \u2212 \u03b1) % upper onesided confidence bound on \u03b3 is given by\nwhich is used as the threshold for the mode truncation. Here, z is the random variable satisfying the Gaussian distribution with zero mean and standard deviation of 1. If several \u03b3 values exceed the threshold, the highest mode is selected for mode truncation. After the mode truncation K OPT is determined, the spectral coefficients (a k , k = 1, 2, \u2026, K OPT ) can be calculated, and so as the truncation error variance E 2 K OPT ."}, {"section_title": "Multi-platform observations", "text": "Let observation be conducted by L instruments with different e\n; :::; c o r M 2 \u00f0 \u00de 2 ; :::;\nThe observational error variance is given by\nThe relative error reduction \u03b3 K for mode truncation (25) is replaced by \nAfter the mode truncation is determined, the OSD Eq. (13) is used to get the analysis field. 4 \"Truth,\" \"background,\" and \"observational\" fields Consider an artificial non-dimensional horizontal domain (\u221219 < x < 19, \u221215 < y < 15) with the four curved rigid boundaries ( Fig. 2 ):\nThe domain is discretized with \u0394x = \u0394y = 0.5. The total number of the grid points inside the domain (N) is 3569. Figure 3 shows the first 12 basis functions {\u03d5 k }, which are the eigenvectors of the Laplacian operator with the Dirichlet boundary condition, i.e., b 1 = 0 in (61) of Appendix C.\nThe first basis function \u03d5 1 (x n ) shows a one-gyre structure. The second and third basis functions \u03d5 2 (x n )and \u03d5 3 (x n )show the east-west and north-south dual-eddies. The fourth basis function \u03d5 4 (x n ) shows the east-west slanted dipole-pattern with opposite signs in the northeastern region (positive) and the southwestern region (negative). The fourth basis function \u03d5 4 (x n ) shows the tripole-pattern with negative values in the western and eastern regions and positive values in between. The higher order basis functions have more complicated variability structures.\nTwo \"truth\" fields for the non-dimensional domain with 4 rigid and curved boundaries (Fig. 2) contain multiple mesoscale eddies (treated as \"truth\") given by\n; \u00f033\u00de for the large-eddy field (Fig. 4a) and given by\nfor the small-eddy field (Fig. 4b) . The background field is given by\nThe \"observational\" points {r (m) } are randomly selected inside the domain (Fig. 5) with the total number (M) of 300. The \"observational\" points {r (m) } are kept the same for all the sensitivity studies. The domain is discretized by \u0394x = \u0394y = 0.5 with total number (N) of grid points of 3569.\nSixteen sets of \"observations\" (c o ) are constructed from Fig. 4a , b using the analytical values plus white Gaussian noises (\u03b5 o ) of zero mean and various standard deviations (\u03c3) from 0 (no noise) to 2.0 with 0.1 increment from 0 to 1.0 and 0.2 increment from 1.0 to 2.0 (total 16 sets), generated by the MATLAB,\nFigure 6a, b show 6 out of the 16 constructed sets with \u03c3 = (0, 0.2, 0.5, 10., 1.6, 2.0). Both OSD and OI methods are used to get Table 1 Dependence of K OPT on (\u03c3, e o ) for the large-eddy field shown in Fig. 6a with significance level \u03b1 = 0.05 6 6 6 6 6 6 6 1.2 7 7 6 6 6 6 6 6 6 6 6 6 6 6 6 6\n1.4 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6\n1.6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 1.8 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 2.0 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 Fig. 7 Dependence of E 2 a and \u03b3 K on K for the \"observational\" data for the small-scale eddy field with \u03c3 = 0.8 and e o = 0.2 at two significant levels of a \u03b1 = 0.05 (z 0.05 = 1.645) and b \u03b1 = 0.10 (z 0.10 = 1.291) as the threshold of mode truncation [see Eq. (27)]. The optimal mode truncation is 58 for \u03b1 = 0.05 and 67 for \u03b1 = 0.10 the analysis field c a (r n ) from these \"observations\". The bilinear interpolation (see Appendix B) is used for the observation operator H in this study."}, {"section_title": "Comparison between OSD and OI", "text": ""}, {"section_title": "a. OSD analysis fields", "text": "The steep-descending mode truncation K OPT depends on the user-input parameter e o [see (25)] and observational noise \u03c3. E 2 a and \u03b3 K are computed from the \"observational\" data in Fig. 6a , b. The threshold of mode truncation (27) varies with the significance level \u03b1. In this study, (e 0 , \u03c3) vary between 0 and 2; \u03b1 has two levels of (0.05, 0.10) with z 0.05 = 1.645, z 0.10 = 1.287 in (27). For given values of e 0 (= 0.2) and \u03c3 (= 0.8), the optimal mode truncation depends on the significance level \u03b1 with K OPT = 58 for \u03b1 = 0.05 (Fig. 7a ) and K OPT = 67 for \u03b1 = 0.10 (Fig. 7b) . Most results shown in this section is for \u03b1 = 0.05 since it it a commonly used significance level.\nFor the large-eddy field, K OPT is not sensitive to the values of \u03c3 and e o . It is 7 in the upper-left portion and 6 in the lowerright portion of Table 1 . For the small-eddy field, K OPT takes (58, 67) for the most cases, 178 for the high noise levels (\u03c3 \u2265 1.8) and low e o values (e o \u2264 1.0), and 82 for the low noise levels (\u03c3 \u2264 0.1) and low e o values (e o \u2264 0.3) ( Table 2 ).\nThe analysis field using the OSD data assimilation (13) for a particular user-input parameter e o and noise level \u03c3, c OSD a r n ; e o ; \u03c3 \u00f0 \u00de , is represented in Fig. 8a (the large-eddy field) using \"observations\" in Fig. 6a (with various \u03c3), and in Fig. 8b (the small-eddy field) using \"observations\" in Fig. 6b (with various \u03c3) . "}, {"section_title": "b. OI Analysis Fields", "text": "With the assumption that the c field is statistically stationary and homogeneous, the OI Eq. (9) with the R and B matrices represented by (8) and (65) [see Appendix E] is used to analyze the \"observational\" data with three user-defined paramters: (r a , r b , e o ). Here, r a and r b are the decorrelation scale and zero crossing (r b > r a ); e o is the standard deviation of the observational error. Let these paramters take discrete values with total number of P a for r a , P b for r b , and P e for e o . In this study, we set P a = P b = P e = 5. e o has five values (0.2, 0.5, 1.0, 1.5, 2.0). Considering the horizontal domain from \u221215 to 15 in both (x, y) directions, r a takes 5 values (2, 3, 4, 5, 6); (r b -r a ) takes 5 values (0.5, 1.0, 1.5, 2.0, 2.5). There are 125 combinations of (r a , r b , e o ) for the test.\nThe analysis field from the OI data assimilation (9), c OI a r n ; \u03c3; r a ; r b ; e o \u00f0 \u00de , with four different sets of user-input parameters (r a , r b -r a , e o ): (2, 2.5, 1), (4, 5.5, 1), (6, 8.5, 1), and (6, 8.5, 2) , are presented in Fig. 9a (the large-eddy field) using \"observations\" in Fig. 6a , and in Fig. 9b (the small-eddy field) using \"observations\" in Fig. 6b . Comparison between Figs. 9a, b and 4a, b demonstrates strong dependence of the OI output on the selection of the parameters (r a , r b , e o ). For the large-scale eddies (Fig. 9a) , the analysis fields c a are very different from the \"truth\" field c t for r a = 2, r b = 2.5, e o = 1 for all \"observations\" (Fig. 6a) ; the difference between the reconstructed and \"truth\" fields decreases as r a and r b increase; the two fields are quite similar when r a = 6, r b = 8.5\nfor both e o = 1 and 2. Such similarity reduces with increasing e o . For the small-scale eddies (Fig. 9b) , the analysis fields c a are totally different from the \"truth\" field c t for r a = 6, r b = 8.5, e o = 1 and 2 for all \"observations\" (Fig. 6b) , less different as r a \nAverage over all the values of e o leads to the overall uncertainty The analysis field using OI (c OI a ) depends on three userdefined parameters (r a , r b , e o ). Its uncertainty due to a particular parameter is represented by\nwhich are compared to R OSD \u03c3 \u00f0 \u00de and R OSD (\u03c3, e o ). (\u03c3, r a ) and R OSD \u03c3 \u00f0 \u00de of the analysis fields from the same \"observations\" with different noise levels with varying parameter r a = (2, 3, 4, 5, 6) from top to bottom with the left panels using \"observations\" shown in Fig. 6a and the right panels using \"observations\" in Fig. 6b . The solid curves represent the OSD with the significance level of \u03b1 = 0.05; and the dotted curves refer to the OI The overall performance between OI and OSD with various noise levels (\u03c3) can be estimated by the error ratio,\n\u00f039\u00de Figure 13 shows the dependence of \u03ba(\u03c3) (evidently less than 1) on \u03c3 for the two types (large-scale and small-scale eddies) of the \"observational\" fields represented by Fig. 6a and b with two different significance levels (\u03b1 = 0.05, 0.10) for the threshold of mode truncation in the OSD method (27). At \u03b1 = 0.05 (Fig. 13a) , for the large-scale eddy field, \u03ba(\u03c3) takes 0.71 at \u03c3 = 0; fluctuates with \u03c3; and decreases to 0.57 at \u03c3 = 2.0. For the small-scale eddy field, \u03ba(\u03c3) increases monotonically with \u03c3 from 0.43 at \u03c3 = 0 to 0.67 at \u03c3 =2.0.At \u03b1 =0.10 (Fig.13b) , for the largescale eddy field, \u03ba(\u03c3) takes 1.17 at \u03c3 = 0; decreases monotonically \nwhich means that the overall error for the OSD is 76 % (51 %) of the OI error for the large-scale (small-scale) eddy field for \u03b1 = 0.05. The overall performance of the OSD method is relatively insensitive to the selection of the significance level \u03b1. The computational cost of the OSD and OI methods is comparable in the test cases. In the OSD method, the steepdescending method for mode truncation requires (a) the computation of a large number K b in Eq. (26) of eigenvectors and (b) the construction and solution of the OSD Eq. (13) can be done once for all. In the OI method, however, the construction and solution of the OI Eq. (9) must be repeated each time background/observations changes. OSD \u03c3 \u00f0 \u00de of the analysis fields from the same \"observations\" with different noise levels with different (r b \u2212 r a ) = (0.5, 1.0, 1.5, 2.0, 2.5) with the left panels using \"observations\" shown in Fig. 6a and the right panels using \"observations\" in Fig. 6b . The solid curves represent the OSD with the significance level of \u03b1 = 0.05; and the dotted curves refer to the OI 6 Synoptic monthly gridded temperature and salinity fields\nThe OSD method is used to to produce the synoptic monthly gridded (SMG) temperature (T) and salinity (S) datasets (Chu and Fan 2016a; Chu et al. 2016 ) from the two world ocean observational (T, S) profile datasets [the NOAA national Centers for Environmental Information (NCEI)'s World Ocean Database (WOD) and the Global Temperature and Salinity Profile Program (GTSPP)]. The synoptic monthly gridded absolute geostrophic velocity dataset (Chu and Fan 2016b) is also established from the SMG-WOD (T, S) fields using the P vector method (Chu 1995; Chu and Wang 2003) . These datasets have been quality controlled by the NCEI professionals and are openly downloaded for public use at http://data.nodc.noaa.gov/geoportal/rest/find/document ?searchText=synoptic+monthly+gridded&f=searchPage. The duration is January 1945 to December 2014 for the synoptic monthly gridded WOD (T, S) and absolute geostrophic velocity fields and January 1990 to December 2009 for the synoptic monthly gridded GTSPP (T, S) fields."}, {"section_title": "Conclusions", "text": "Ocean spectral data assimilation has been developed on the base of the classic theory of the generalized Fourier series expansion such that any ocean field can be represented by a linear combination of the products of basis functions (or called modes) and corresponding spectral coefficients. The basis functions are the eigenvectors of the Laplace operator, determined only by the topography with the same lateral boundary condition for the assimilated variable anomaly. They are pre-calculated and independent on any observational data and background fields. The mode truncation K depends on the observational data and a user input parameter e 2 o (i.e., observational error variance); and is determined via the steep-descending method.\nThe OSD completely changes the common ocean data assimilation procedures such as OI, KF, and variational methods, where the background error covariance matrix B needs to be pre-determined since the weight matrix W is used. However, the OSD uses the spectral form to represent the observational innovation at the grid points [see (17)]. Minimization of the truncation error variance leads to the Fig. 12 Comparison between R OI (\u03c3, e o ) and R OSD (\u03c3, e o ) of the analysis fields from the same \"observations\" with different noise levels with varying parameter e o = (0.2, 0.5, 1.0, 1.5, 2.0) from top to bottom with the left panels using \"observations\" shown in Fig. 6a and the right panels using \"observations\" in Fig. 6b . The solid curves represent the OSD with the significance level of \u03b1 = 0.05; and the dotted curves refer to the OI optimal selection of the spectral coefficients. Thus, the background error covariance matrix B vanishes in the OSD procedure since the weight matrix W is not used. It is contrast to the existing OI method, where the B matrix is often assumed to be stationary and homogeneous with user-defined parameters.\nThe capability of the OSD method is demonstrated through its comparison to OI using analytical 2D fields of large and small mesoscale eddies inside a domain with 4 rigid and curved boundaries as \"truth\", and addition to the \"truth\" of white Gaussian noises with zero mean and standard deviations (\u03c3) varying from 0 (no noise) to 2.0 with 0.1 increment at randomly selected locations used as \"observations.\" A simple covariance function (Bretherton et al. 1976 ) was used for the OI procedure with three user-defined parameters (r a , r b , e o ) taking 5 possible values each. The OSD uses the same value of e o . The performance of OSD and OI is compared by (1) patterns for each set of 125 combinations of parameters, (2) root mean square errors for varying parameters, and (3) overall root mean square errors. The results show that the overall error reduction using the OSD is evident, which is 76 % (51 %) [72 % (59 %)] for significance level \u03b1 = 0.05 (\u03b1 = 0.10) of the OI error for the large-scale (small-scale) eddy field. In context of practical application, synoptic monthly gridded world ocean temperature, salinity, and absolute geostrophic velocity datasets have been produced with the OSD method and quality controlled by the NOAA National Centers for Environmental Information (NCEI).\nTwo issues need to be addressed on the correlation matrix. First, the comparison between the OSD and OI is at one particular instant in time. The B matrix used in the OI is based only on distance. Second, in the covariance matrix-based methods, when the covariance matrix is fixed once and for all, it is well-known that the very first data assimilation cycle is doing well, but subsequent cycles are less effective because the remaining error has a tendency to be orthogonal to the directions of the covariance matrix. In the OSD method, the correction is based on spectral functions (i.e., basis functions) chosen once-and-for all. More sophisticated, flow-based covariance matrix will allow OI to perform much better. Further verification and validation under real-time ocean conditions are needed to verify the quality of OSD in time cycles and to compare between OSD and OI methods.\nIn the two test cases (large and small eddy fields), it is clear that the optimal mode truncation K OPT (around 6 for the large eddy field and around 60 for the small eddy field) are very closed to the number of eigenvectors required to represent the truth field (Fig. 4) . This shows the capability of the steep-descending mode truncation. However, the performance of the method for the truth field is a mixture of large and small scales in different parts of the domains needs to be further investigated.\nbe the distance between the grid point (x i , y j ) and observational point (x (m) , y (m) ). The influence of the grid point x n on the observational point x (m) is given by (Spepard 1968 )\nwhere q is an arbitrary positive real number called the power parameter (typically, q = 2). Another form of h mn is given by (Franke and Nielson 1991) h \nwhere D (m) is the distance from the observational point x (m) to the most distant grid point. Equation (43) has been found to give better results than (42). As a result, c b (x (m) , t), is somewhat symmetric about each grid point."}, {"section_title": "Appendix B. Determination of H-matrix using neighboring grid points", "text": "Consider the position vector x = (x, y) located inside the grid cell (Fig. 14) , x i \u2264 x < x i + 1 ,y j \u2264 y < y j + 1 .. Mathematically, the variable c b at r (inside the grid cell) can be represented approximately by a polynomial,\nwhere L = 1 refers to the bilinear interpolation, and L = 3 leads to the bicubic interpolation. For the bilinear interpolation, Eq. (44) et al. (1997, 2002) compute auto-correlation functions from historical observational data to fit the Gaussian function and get de-correlation scales for the B matrix. Recent studies show that some variables such as upper ocean current speed do not satisfy the normal distribution, but the Weibull distribution (Chu 2008 (Chu , 2009 )."}]
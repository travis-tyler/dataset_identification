[{"section_title": "Abstract", "text": "ABSTRACT A tool to estimate the ray-tracing component of the surveyed depth uncertainty was created and made publicly available through Web services and a Web geographic information system. The estimation is based on a spatial variability analysis at the time of validity of two popular, global-scope sources of oceanographic environmental data. The tool has potential applications in all the phases of ocean mapping, from survey planning to data collection and processing."}, {"section_title": "I. INTRODUCTION", "text": "Recent developments in sonar systems have greatly improved the quality and the efficiency of data collected for ocean mapping [1] , [2] . However, no matter how advanced the technology adopted is, the resulting uncertainty budget may still be heavily affected by a partial or erroneous understanding of the oceanographic environment in which the sonars operate [3] , [4] . Ray tracing, one of the most conventional methods for modeling underwater acoustic sound propagation [5] , predicts the propagation by splitting the water column into a set of finite layers and calculating the bending of a ray path across them. Thus, any bias in the environmental characterization of these layers will inevitably propagate to the quality of the sonar outcomes. This aspect of ocean mapping currently lacks effective solutions, although the level of predictability of the oceanographic environment has been largely improved by advances in numerical modeling, computing power and data transmission. In fact, nowadays reliable ocean nowcast and forecast model predictions can be easily accessed by public users, from local to global scales [6] - [9] . Similarly, the increasing amount and quality of oceanographic measurements collected all around the oceans, although spatially biased, has increased the reliability of available oceanographic atlases [10] , [11] . The existing three-dimensional forecast model predictions and atlas provide ocean mappers helpful visual information on the oceanographic variability of key environmental variables such as water temperature and salinity [12] - [14] . However, more qualitative and task-specific information may be derived by using the ocean model analyses and predictions as inputs to estimate the acoustic ray-tracing component of the depth uncertainty in ocean mapping surveys [15] , [16] and making that information accessible.\nProviding an uncertainty estimation of the oceanographic variability complements existing a-priori uncertainty models [17] - [19] . These uncertainty models evaluate the specifications of the adopted instrumentation to estimate the total propagated uncertainty (TPU) across the angular range of a sonar at the measured depth, but they do not take into account the spatial and temporal variability of the oceanographic conditions in which these systems are operated. From a practical perspective, an ocean mapper is called to routinely estimate and monitor the total uncertainty budget of the data as required by best practices and by international and national survey specifications [20] - [22] . A better understanding of the oceanographic conditions has implications on several aspects of the data collection: the planned survey lines may be modified in orientation, to reduce the number of passages across fronts of large uncertainty variability (uncertainty fronts), and in spacing (e.g., if the estimated uncertainty of the outmost depths in the sonar swath is too high to meet the survey requirements); the time of operations, as a component to be taken into account to identify the best time of the year to collect the data; the location of the calibration sites (since it is desirable to selected areas with limited environmental effects); the selection of the appropriate auxiliary instrumentation to collect water-column environmental profiles; etc. While it is relatively easy to use existing software tools to evaluate the instrumentation-based uncertainty, a tool to facilitate the estimation of the effects on spatial and temporal environmental changes is not currently available. Without the ability to estimate the effects of oceanographic variability on survey data, the ocean mapper can only wisely adopt a principle of caution by overestimating the effects, and either reducing the useable sonar swath width (thus resulting in reduced coverage per survey line which will require an increase in the number of survey lines and survey times) or oversampling the water column by adopting underway profiling systems, with the associated higher costs than when using traditional profiling systems [23] - [25] .\nThere are also clear advantages in actively monitoring the oceanographic environment during survey data collection. Traditionally, the ocean mapper adopts two types of in situ measurements as proxies in evaluating the surrounding underwater environment: point measurements, collected using a sound speed probe or a thermosalinograph (TSG) at a fixed draft and with temporal resolution of the order of 1 Hz; and profile measurements from instruments such as sound speed profilers or multi-parametric probes (i.e., CTD). This latter kind of measurements are usually performed on fixed intervals of hours, with additional casts executed on an as-needed basis. Although helpful, the combination of these two types of measurements provides a partial and limited understanding of the surrounding oceanographic environment. The missing general oceanographic picture can potentially be retrieved from atlases and forecast systems, but to be easily accessible the information provided by the three-dimensional, timevarying variables contained in these sources has to be collapsed into a two-dimensional map. Once obtained, ocean mappers can directly evaluate these maps rather than having to interpret ''on-the-fly'' the original variables.\nBased on such a consideration, the Sea Mappers' Acoustic Ray-Tracing Monitor And Planning (SMARTMAP) tool to calculate and provide access to an estimation of the ray-tracing component of the surveyed depth uncertainty was created and made publicly available (https://www.hydroffice.org/ smartmap/). The estimation of the percentage of depth bias due to ray-tracing uncertainty is performed by spatial variability analysis at the specific time of validity of the ocean model products. This analysis has the potential to improve the situational awareness that hydrographic surveyors and other ocean mappers have about effects of spatial and temporal oceanographic variability on the collected data. The scope of the guidance embraces all the three phases of a survey: the planning phase, since it makes possible to predict when and how to survey an area; the execution phase, by providing a synoptic representation of the oceanographic conditions at the time of the data acquisition; and the processing phase, as a mean to identify the possible source of artifacts in products derived from sonar data [26] - [28] . To evaluate the proposed approach, the SMARTMAP tool has been tested using inputs from two popular sources: the NOAA National Weather Service (NWS) National Centers for Environmental Prediction (NCEP) Global Real Time Operational Forecast System (RTOFS), a three-dimensional oceanographic forecast modeling system [29] , [30] , and the NOAA National Oceanographic Data Centre (NODC) World Ocean Atlas (WOA) 2013, a climatological ocean atlas [31] , [32] , both having a global spatial scope. The tool outputs are then made accessible using Open Geospatial Consortium (OGC) web services [33] , so that the SMARTMAP information can be loaded as a map layer in existing desktop geographic information system (GIS) applications, as well as through a dedicated Web GIS site, to lower the access barriers to the information and to reach a larger number of potential users."}, {"section_title": "II. METHODS", "text": ""}, {"section_title": "A. DATA SOURCES", "text": "Two popular, global sources of oceanographic data were selected for the initial development and testing of the SMARTMAP tool: the WOA 2013 and the Global RTOFS.\nThe WOA 2013 is a classic and world-wide used oceanographic climatology. This climatology provides the mean conditions for several ocean variables, at a specific epoch and over a series of defined depth levels. The climatological results can be heavily influenced by the analysis adopted to process the real point observations. The WOA 2013 derives directly from the first global oceanography made publicly available more than 30 years ago [34] , and it is based on the millions of observations present in the World Ocean Database (WOD) [10] . The SMARTMAP tool uses the highest grid resolution provided with WOA 2013 (i.e., 1/4 \u2022 ) and the smallest temporal step (i.e., monthly grid with depth extension up to 1,500 m).\nThe Global RTOFS was selected for its global coverage. The system provides three-dimensional forecast guidance for the global oceans up to eight days into the future. The forecast cycle uses the latest nowcast and it is based on several data types assimilated including in situ profiles of water temperature and salinity from a variety of sources and remotely sensed sea-ice concentrations, sea surface temperatures and sea surface heights. The forecast is driven using 3-hourly momentum, radiation and precipitation fluxes from the operational Global Forecast System (GFS) fields [35] . The Global RTOFS outputs are stored on a horizontal grid (4500 x 3298 nodes) that adopts a dual projection: a Mercator projection for latitudes in the range from 78.6 \u2022 S to 47 \u2022 N, and an Arctic bi-polar path for latitudes higher than 47 \u2022 N (\u223c1/12 \u2022 )."}, {"section_title": "B. RAY-TRACING UNCERTAINTY ESTIMATION", "text": "The recent developments and the massive adoption of multibeam echosounders (MBES) in ocean mapping has remarkably increased the quality and the efficiency VOLUME 6, 2018 of survey data [1] , [2] . A MBES usually operates by repeatedly emitting acoustic pulses that are narrow in the along-track direction and wide perpendicularly at the sailing direction. Those acoustic swaths insonify a seafloor area with a width that is usually several times the measured depths [36] . Electronic beam-steering applied to the returned pulse allows the determination of the travel-time for several angles. Those pairs of travel-time and angle can be converted to accurate measurements of target-detection (e.g., the seafloor, a school of fish) along the swath, provided that the acoustic sound speed profile along the water column is known. As such, the advantages associated with the wide acoustic swath of a MBES also come with the risk of introducing significant biases in the collected depths due to erroneous acoustic raytracing when the applied sound speed profile does not correspond to the environmental conditions of the insonified area. A few methods are present in literature to estimate [25] , [37] , or even correct [38] , the ray-tracing uncertainty. Those methods require the analysis of the collected data, and they share two main drawbacks: the outcomes are only valid for the sounding geometries of the seafloor that was mapped, and significant effort is required to properly process the collected data.\nIn order to overcome such limitations, the uncertainty estimation for the SMARTMAP tool was based on the method described in [39] . This method performs a simulation by mimicking, at a specific depth (z) and beam angle (\u03b2), the ray-tracing computation performed in acoustic systems. To improve the accuracy in the evaluation of the spatial progression of pair of acoustic ray paths, a constant gradient tracing algorithm [36] was used in place of the constant speed tracing algorithm originally implemented in [39] . In the derivation of both algorithms, the sound speed is considered a function of only one spatial dimension. This approximation is acceptable since horizontal variations are usually weaker than the variations with depth, although they can be significant near the estuary of large rivers, on the edges of large ocean currents like the Gulf Stream, and in areas close to melting ice packs [40] . Given the dependences of temperature, salinity, and pressure on depth, the variation of sound speed with depth was calculated using the United Nations Educational, Scientific and Cultural Organization (UNESCO) equation [41] .\nThe constant gradient ray-tracing algorithm models a sound speed profile, c(z), with a finite number (N ) of points (with indices n = 0, . . . , N ) [42] . In each of the N \u2212 1 elementary layers, the constant gradient of sound speed (g n ) is estimated as\nWithin each elementary layer, the ray is traced using the Snell-Descartes law for isotropic media in the following, where the constant a is known as the ray parameter:\nThe path of a ray through the elementary layer is an arc of a circle whose center lies at a baseline depth that can be calculated by extrapolating to zero the sound speed in the layer [40] . With the described configuration (shown in Figure 1) , it is possible to calculate the local radius of curvature (R n ) using (3) and to derive the circular refraction formulas for changes in depths and ranges (r) in (4); while the total travel time can be obtained by integration of the travel times along the layers [36] : The resulting ray tracks are used to estimate the divergence of the two solutions given a common two-way travel time (Figure 2) . Figure 2b shows, in magenta, the error tolerance limits derived from NOAA Office of Coast Survey's Hydrographic Surveys Specifications and Deliverables (HSSD) 2017 as an example of reference threshold. When the same calculation is applied over a range of two-way travel times and depression angles, it is possible to estimate the uncertainty related to ray-tracing along the swath. For common sounding geometries and environments, the maximum uncertainty value is associated with the outer most region of a swath (Figure 3) .\nThe adopted approach performs a variability analysis by using a set of synthetic sound speed profiles that can be derived both from climatological atlases and predictions from oceanographic forecast systems. First, synthetic sound speed profiles are derived from the temperature and the salinity data associated with the selected node location (L 0 r,c with r representing the grid row, and c the column) and its immediate eight neighbors (L j r,c with j = 1, . . . , 8). The number of valid retrieved profiles can be less than nine since some nodes which have the majority of their surface on land will not have valid data. Then, these synthetic profiles are pair-wise analyzed using the previously described comparison method to estimate the absolute depth bias (b j r,c ). The discrepancy between the evaluate node and its neighborhood provides an estimation of the ray-tracing uncertainty (\u03b4 rt r,c ) using the following, a direct measurement of the impact of the spatial variability of the oceanographic conditions at that location. This approach does not require the processing of the collected survey data, and it can also be adapted to the sounding geometry of a specific system (i.e., the angular aperture of the sonar swath):\nIn order to provide a unique map for each temporal estimation step, some parameters are set to average values in order to be meaningful for the majority of potential users. The analysis adopts an initial beam angle of 65 \u2022 , as well as an initial calculated sound speed value based on the average of all the nine synthetic profiles derived from the analysis. Finally, a variability analysis is performed up to the shallowest depth among the analyzed profiles."}, {"section_title": "C. PRODUCTS CREATION AND DISSEMINATION", "text": "The provided estimated value only captures the uncertainty up to the shallowest depth among the analyzed profiles. However, the majority of sound speed variations is commonly observed in the uppermost part of a profile: the surface layer, the seasonal thermocline, and the main thermocline are usually present in the upper 1000-m region of the water column [40] . Based on this consideration, the SMARTMAP tool provides a percentage of ray-tracing depth uncertainty (PDU rt r,c ) in function of the calculated uncertainty (\u03b4 rt r,c ) scaled to the 95% confidence level and the full depth (d r,c ) VOLUME 6, 2018 \nThe decision to provide a percentage of depth uncertainty facilitates the evaluation of the SMARTMAP outcomes against survey requirements as, for instance, the maximum allowable depth uncertainty associated with the International Hydrographic Organization's survey order accuracy [43] .\nSince the range of the resulting ray-tracing uncertainty map can be quite large, a logarithmic transformation is applied as final step of the pointwise processing at the scale of the data source. A regularly-spaced grid is then created using an inverse distance to a power gridding method that applies a weighted average interpolation limited to the seven nearest neighbors (1.5 is the adopted weighting power) [44] , [45] . The obtained interpolated grid is then stored in GeoTiff format [46] .\nSpatial data with limited temporal validity and covering large regions like the PDU rt maps risk not being fully utilized due to the difficulty of sharing and integration [47] . Since WebGIS map viewers have shown potential for many fields as a tool for managing, analyzing and decision making [48] , the SMARTMAP tool adopts a complete solution that goes from data ingestion to public dissemination and includes a client-server application framework, and a web mapping engine. The solution uses open-source software for the advantageous reasons of low cost, high stability and security [48] . The SMARTMAP products are stored and publicly served using GeoServer [49] . GeoServer is a Java-based open source geospatial server designed for interoperability by supporting data from any major spatial data source using open standards. Furthermore, GeoServer is the reference implementation of the OGC Web Feature Service (WFS) and Web Coverage Service (WCS) standards, as well as a high-performance certified-compliant Web Map Service (WMS) [50] . Given the SMARTMAP peculiarities, the OGC WMS was selected as the main web service for data sharing and integration [51] .\nFinally, a WebGIS map viewer was developed to demonstrate that the SMARTMAP web services can be easily integrated with various spatial data and, at the same time, to provide field-specific tools and to widen the adoption to a larger number of potential users. The WebGIS application is built using OpenLayers, a JavaScript-based open source library, that makes creation of interactive maps which are accessible through nearly any web browser easy [50] . The SMARTMAP WebGIS application enriches the SMARTMAP web services with several field-specific functionalities (like the selection of the base map to be visualized in the background, the animation of maps at a userdefined framerate, the visualization of survey lines and areas) together with common WebGIS tools (data legend, scale bar, panning and zooming functionalities, etc.)."}, {"section_title": "III. RESULTS", "text": "The SMARTMAP maps for both Global RTOFS and WOA 2013 data sources are available through GeoServer at https://smartmap.ccom.unh.edu/geoserver/web/. The accessibility of these services has been successfully tested on both commercial (ESRI ArcMap release 10.4, Blue Marble Global Mapper release 17.\n2) and open-source (QGIS release 2.18) GIS desktop applications.\nThe SMARTMAP WebGIS map viewer (accessible at https://www.hydroffice.org/smartmap/) provides a mean to visualize the ray-tracing uncertainty maps with the only requirement to have available a modern web browser. Figure 4 shows the visualization of a Global RTOFS-based map for a specific date, while Figure 5 provides a map with the same global coverage, but based on the climatological data for the corresponding month retrieved from the WOA 2013 database.\nThe visualization of the maps clearly highlights areas of strong spatial variability (i.e., ray-tracing uncertainty fronts) that the ocean mapper has to take into consideration to plan the timing and the spacing for environmental sampling.\nThe SMARTMAP maps share the same spatial and temporal resolutions and, thus, the intrinsic limitation of the source oceanographic data. In the currently implemented sources, the spatial resolutions are 1/4 \u2022 for the WOA 2013 and 1/12 \u2022 (outside of the arctic polar area) for the Global RTOFS; while the time frames of interest are a month and a day, respectively. Thus, oceanographic phenomena with a smaller temporal and spatial scale such as oceanic fronts of the Gulf Stream [42] cannot be resolved, and their effects will contribute to the background signal noise.\nWhen the outcomes from the two sources are compared on the same area, the effects of the WOA 2013 variables having been heavily smoothed as a result of the interpolation method VOLUME 6, 2018 adopted to process the irregular and sparse distribution of the WOD measurements are clearly visible. Nonetheless, the two maps provide similar information from a point of view of the potential environmental ray-tracing uncertainty. Several regions of high variability are present in both the maps: the Gulf Stream (east coast of North America), the Kuroshio Current (Japan), the northern edge of the Antarctic Circumpolar Current, the Agulhas Current (off the southern tip of Africa), as well as the fronts where Arctic waters encounter warmer water masses in the Bering Seas and in the Norwegian and Greenland Seas. It is also evident the spatial correlation between increasing uncertainty values and extended shelf breaks (e.g., the Georges Bank in the Gulf of Maine and the Grand Banks of Newfoundland), island chains, and midocean ridge. This effect is most likely due to the presence of bathymetric features that cause variation in the stratification of the water masses, but it can also be partially an artifact of the adopted method to analyze the eight surrounding nodes. For taking care of these latter situation, a set of special neighborhood cases has been introduced.\nOceanographic forecast systems, such as the Global RTOFS, usually have higher spatial resolution than oceanographic atlases such as the WOA 2013. Furthermore, they potentially provide a better estimation of the environmental conditions in regions with scarce data. On the other side, the oceanographic atlases provide a mean to evaluate environmental uncertainty farther out than the few days span of the current forecasts systems. The storage of past Global RTOFS maps on the SMARTMAP server provides a mean to investigate possible ray-tracing issues in the collected data at any time in the future as well as an indication of what the potential conditions might be over the same period of time in future years."}, {"section_title": "IV. CONCLUSION AND FUTURE WORK", "text": "Environments with large temporal and spatial variations in the acoustic sound speed along the water column prevent a reliable conversion from the measured acoustic travel-times to bathymetry. Situations of insufficient information regarding the prevailing sound speeds are, for example, typical of estuaries where fresh river water mixes with seawater. The resulting errors in the collected data can be high enough to even require survey repetition, a very undesirable outcome due the high costs involved.\nAlthough possible in principle to attempt the correction of the ray-tracing artifacts by estimating the required sound speed corrections from the introduced shifts in area of overlapping acoustic swaths [38] , this is not usually achievable in practice since the approach assumes that the ray-tracing is the dominant contributor to the depth uncertainty. As such, the acquisition of environmental profiles at the proper time and space represents the straightforward solution to drastically reduce the uncertainty budget due to acoustic ray-tracing and variability of oceanographic conditions. The SMARTMAP tool provides a robust and easyto-interpret mean to support the ocean mapper in such a relevant task. One of the advantage of the described tool is that the potential users do not need to understand the physical oceanography in order to be able to use the provided maps. Ocean mapper can use them to accordingly plan their surveys and to monitor the effectiveness of their strategy while performing the data collection.\nThe SMARTMAP maps are a unique mean for the ocean mapper to intuitively evaluate areas of high water column variability. Some of these areas were already known to be troublesome for surveys, however, the SMARTMAP tool adds an objective and quantitative method to evaluate it. The maps can be used to perform studies of seasonal variation in environmental ray-tracing uncertainty that will help ocean mappers to identify the best time of the year to perform surveys in a specific area or, in case that the timing of the survey is fixed, to better evaluate the required equipment needed to satisfy the survey requirements.\nWe plan to extend the data sources to forecast models at higher resolution, both at regional and local scales such as NOAA National Ocean Service (NOS) operational coastal and estuarine forecast modeling systems. This will expand the range of potential use cases and, at the same time, will provide means to evaluate the estimated ray-tracing uncertainty maps in terms of accuracy and consistency across different scales (i.e., local, regional, and global scales). Finally, the next development cycle will also focus on the formulation of an algorithm to predict the number, the locations, and the timing of required sound speed profiling operations. This latter development will also provide a mean to indirectly test the quality of the estimated uncertainty provided by SMARTMAP. "}]
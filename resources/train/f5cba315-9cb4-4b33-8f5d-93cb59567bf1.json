[{"section_title": "Abstract", "text": "Cortical thickness estimation performed in vivo via magnetic resonance imaging (MRI) is an important technique for the diagnosis and understanding of the progression of Alzheimer's disease (AD). Directly using raw cortical thickness measures as features with Support Vector Machine (SVM) for clinical group classification only yields modest results since brain areas are not equally atrophied during AD progression. Therefore, feature reduction is generally required to retain only the most relevant features for the final classification. In this paper, a spherical sparse coding and dictionary learning method is proposed and it achieves relatively high classification results on publicly available data from the Alzheimer's Disease Neuroimaging Initiative (ADNI) 2 dataset (N = 201) which contains structural MRI data of four clinical groups: cognitive unimpaired (CU), early mild cognitive impairment (EMCI), later MCI (LMCI) and AD. The proposed framework takes the estimated cortical thickness and the spherical parameterization computed by FreeSurfer as inputs and constructs weighted patches in the spherical parameter domain of the cortical surface. Then sparse coding is applied to the resulting surface patch features, followed by max-pooling to extract the final feature sets. Finally, SVM is employed for binary group classifications. The results show the superiority of the proposed method over other cortical morphometry systems and offer a different way to study the early identification and prevention of AD."}, {"section_title": "INTRODUCTION", "text": "Cortical thickness estimation in magnetic resonance imaging (MRI) is an important technique for Alzheimer's disease (AD) research. It helps precisely measure the wholebrain and temporal lobe volume atrophy, which has been proven to correlate closely with changes in cognitive performance and is therefore a valid imaging biomarker of AD progression [1] . A number of research has been focused on accurate estimation of cortical thickness (as reviewed in [2] ). Currently, two different computational paradigms exist, with methods generally classified as either surface-based [3] or voxel-based [4] . A surface-based thickness computation example is shown in Fig. 1 . Between them, surface-based cortical thickness is more widely used in AD research.\nThere has been a growing interest to apply computeraided diagnostic classification techniques to analyze cortical thickness features and diagnose different stages of AD and especially in preclinical individuals at high risk for AD to facilitate early interventions. Lerch et al. [5] investigated the potential of fully automated measurements of cortical thickness to reproduce the clinical diagnosis in 19 AD and 17 cognitive unimpaired (CU) subjects. The results show regionally variant patterns of discrimination ability, with over 90% accuracy, but the subject amounts are relative small. Cuingnet et al. [6] constructed a classifier at each vertex by using the cortical thickness as a feature vector. Although the vertex-wise data can reflect local deformity of a small region, they are sensitive to noise and registration errors. Cho et al. [7] overcame the difficulties associated with both types of features by adopting the noise-filtered vertex-wise cortical thickness data based on spatial frequency analysis. This improvement led to an improved accuracy in AD classification. In [8] , longitudinal cortical thickness changes were measured by 4D (spatial plus temporal) thickness measuring algorithm. Their proposed method can distinguish AD patients from CU at an accuracy of 96.1%. Nevertheless, having a different systematic approach, which focuses on cortical thickness and validated for different group classifications, including early MCI (EMCI) and later MCI (LMCI), to aid in the diagnosis and understanding of AD progression would be highly advantageous to the preclinical AD research.\nBased on the cortical thickness features computed by FreeSurfer, this paper proposes a novel machine learning framework for the diagnosis of different stages of AD. The main contributions of this work are as follows. First, to the best of our knowledge, it is the first sparse coding work formulated on the sphere domain although sparse coding has achieved great success on standard Euclidean image domains [9] and recently in the hyperbolic domain [10] . With an efficient Stochastic Coordinate Coding (SCC) [11] [12] [13] , our work generalizes sparse coding algorithms to the sphere domain and enriches our understanding of sparse coding. Since cortical thickness estimation algorithm generates high dimensional features, some feature reduction algorithms are usually applied before classification. Our second contribution is to adopt novel feature reduction scheme, such as sparse coding and max-pooling [14] , which improves the efficiency and efficacy of the performance using high-dimensional cortical thickness on a variety of AD diagnosis tasks. In our work, with the Support Vector Machine (SVM) classifier [15] , our system achieved an average of 91.5% on six different classification tasks in our relatively large-sized ADNI2 baseline dataset (N = 201).\n2. METHODS 2.1. System Pipeline Fig. 2 summarizes the overall pipeline of our new system. FreeSurfer [16] is used to segment images ( Fig. 2(a) ) and build white matter (WM) and pial cortical surfaces ( Fig. 2(b) ). FreeSurfer computes the cortical thickness by deforming the WM surface to pial surface and then measuring the deformation distance as the cortical thickness ( Fig. 1) . FreeSurfer also produces a spherical parameterization for each pial surface ( Fig. 2(c) ). The spherical parameter surface and weighted spherical harmonics [17] are used to register pial surfaces across subjects ( Fig. 2(d) ). In our approach, the spherical parameter surface is the canonical space from which patches are selected. Fig. 2 (e) shows some non-overlapping patches found on both the spherical surface and the cortical surface. After we compute these patches, sparse coding combined with max-pooling [14] are applied for cortical thickness feature dimension reduction. Max-pooling is an aggregate statistics dimensional reduction technique. It computes the max value of a particular feature over a region of the image. These summary statistics are much lower in dimension than the original data. Finally, SVM classifier is used for classification of different AD clinical groups."}, {"section_title": "Weighted Spherical Harmonics for Patch Selection", "text": "To build spherical patches on the parameter domain, we need regular underlying grids. However, the spherical parameterization results computed by FreeSurfer do not have regular structures. To overcome this problem, we adopted the weighted spherical harmonic representation (WSHR) [17] to generate the regular grids using the spherical parameterization computed by FreeSurfer. Additionally, the WSHR fixes the Gibbs phenomenon (ringing effects) associated with the traditional Fourier descriptors and spherical harmonic representation by weighting the series expansion with exponential weights. The exponential weights make the representation converges faster and reduces the amount of wiggling. It helps create consistent patches across subjects.\nWithin the unit sphere parameter space, the mesh parameter coordinates can be represented by the Euler angles \u03b8 \u2208 [0, \u03c0] and \u03d5 \u2208 [0, 2\u03c0) as p(\u03b8, \u03d5) = (p 1 (\u03b8, \u03d5), p 2 (\u03b8, \u03d5), p 3 (\u03b8, \u03d5)) . The weighted spherical harmonic representation of coordinates is then given by\nwhere c ij = \u03c0 \u03b8=0 2\u03c0 \u03d5=0 p(\u03b8, \u03d5)s ij (\u03b8, \u03d5) sin \u03b8d\u03b8d\u03d5, and s ij represents spherical harmonics of degree i and order j. Fig. 2(d) shows an example of the WSHR of 40th degree and set bandwidth \u00b5 of zero.\nAfter the cortical hemispheres have been registered with WSHR, consistent patches are defined from the spherical parameter space. As shown in Fig 2e, the spherical coordinate can be projected back to the cortical surface coordinate, which preserves the correspondences between the patches and cortical structures in 3(b). Within the canonical sphere space, it is straightforward to create consistent patches across subjects on spherical coordinates space. The patches are square-shaped on parameter space but distorted on the original surface. They smaller and more distorted at the sphere pole areas. Specifically, a number of 10 \u00d7 10 windows (defined by (\u03b8, \u03c6)) are created on the sphere to obtain a collection of small image Fig. 3 . Visualization of computed image patches on spherical geometry structure.\npatches based on the spherical geometry structure, shown in Fig. 3(c) . The zoomed-in picture shows some overlapping areas between image patches. The procedure is equivalent to applying a high-pass filter to the original mesh. As a result, the geometric structures are still preserved in the centered mesh, but some low frequencies have disappeared."}, {"section_title": "Sparse Coding and Dictionary Learning", "text": "Sparse coding and dictionary learning has been successful in many image processing tasks as it can concisely model natural image patches. In this work, Stochastic Coordinate Coding (SCC) [11] was adopted to construct the dictionary because of its computation efficiency.\nGiven a finite training set of signals, in this case thickness features, X = (x 1 , x 2 , \u00b7 \u00b7 \u00b7 , x n ) in R p\u00d7n image patches. Each image patch x i \u2208 R p , i = 1, 2, \u00b7 \u00b7 \u00b7 , n, where p is the dimension of image patch and n the number of image patches, the idea of sparse patch features can be incorporated into the following optimization problem:\nwhere \u03bb is the regularization parameter, || \u00b7 || is the standard Euclidean norm and ||z i || 1 is the summation of all the absolute value of elements from z i . x i can be represented by x i \u2248 Dz i . In this way, the p-dimensional vector x i is represented by an m-dimensional vector z i , which means the"}, {"section_title": "Algorithm 1 Stochastic Coordinate Coding (SCC) Algorithm", "text": "Input: Initial dictionary D and image patches {x 1 , \u00b7 \u00b7 \u00b7 , x n }. Output: The learned dictionary and coefficients D, Z where\nfor i = 1 to n do Calculate the sparse code z i by using several steps of coordinate descent (CD) [11] .\nUpdate the dictionary D by performing on step stochastic gradient descent (SGD) [11] .\nend for 7: end for \np\u00d7m is the dictionary. To prevent an arbitrary scaling of sparse codes, the columns d j are constrained by\nThus, the problem of dictionary learning can be rewritten as a matrix factorization problem as follows:\nwhere || \u00b7 || 2 F is the Frobenius norm. The matrix factorization is a convex problem when either D or Z is fixed. With the initial dictionary D by selected patches, we summarize the SCC algorithm in Algorithm 1. We call each cycle, i.e. each image patch has been trained once, as an epoch. Usually, several epochs are required to obtain a satisfactory result. T is the designed epoch number and t \u2208 {1, ..., T }. z i,t and D t denotes the value of z i and D in the t th epoch. Specifically, we use 7 epochs to learn the dictionary in this work. We set all the sparse codes to be zero at the beginning."}, {"section_title": "EXPERIMENTAL RESULTS", "text": ""}, {"section_title": "Datesets and Experiment Setting", "text": "In our experiments, the new approach is applied to Alzheimer's Disease Neuroimaging Initiative (ADNI) 2 database [18] . We used the full set of ADNI2 baseline dataset (202 subjects, 1 failed with FreeSurfer 5.3.0), which consists of: 40 patients of AD, 37 patients of LMCI, 73 patients of EMCI and 51 subjects of CU. All subjects underwent thorough clinical and cognitive assessment at the time of acquisition, the statistics with gender, age and the MiniMental State Examination (MMSE) score shown in Table. 1."}, {"section_title": "Classification Results", "text": "After we applied SCC to learn the sparse features, maxpooling [14] and SVM [15] were applied for additional dimension reduction and classification. We evaluated our proposed method on six classification experiments, including (1) AD vs. CU, (2) AD vs. LMCI, (3) AD vs. EMCI, (4) LMCI vs. CU, (5) EMCI vs. CU and (6) LMCI vs. EMCI. We randomly split the data into training and testing sets using a In each set of experiment, we compared cortical thickness on left, right hemisphere and both hemispheres (whole brain), respectively. For the comparison purpose, the raw cortical thickness data from FreeSurfer, whole brain volume and area calculated by FreeSurfer were also used as features with SVM as the classifier on the same set of classification tasks. Three performance measures: Accuracy (ACC), Sensitivity (SEN) and Specificity (SPE) were computed as evaluation [19] . Besides them, we also computed the area-underthe-curve (AUC) of the receiver operating characteristic (ROC) [19] . Table 2 shows classification performance on six different experiments. In our experimental results (Table 2), we can observe that the proposed method always achieved the best results in all six different classification tasks. Specifically, in AD vs. CU, AD vs. LMCI, AD vs. EMCI, LMCI vs. CU, EMCI vs. CU and EMCI vs. LMCI, the best accuracy rates (0.958, 0.933, 0.931, 0.940, 0.884, 0.843) were achieved by our new proposed method using the whole cortical thickness features. And among all six experiments, the new method with whole cortical thickness at least achieved three best measures among all comparisons. And the left thickness feature performs better than right one and always achieved highest sensitivity. Comparing with the Freesurfer thickness results, we observe our method selected useful features which can improve the classification accuracy.\nTo further compare performance, we also plot ROC curves with computed AUC measures, which are shown in Figure 3 . We can find that our new approach always achieved the best AUC among six different testing datasets. For AD vs. CU, AD vs. LMCI, AD vs. EMCI, LMCI vs. CU, EMCI vs. CU and LMCI vs. EMCI, the proposed method achieved the best AUC 0.963, 0.899, 0.923, 0.948, 0.866 and 0.791, respectively. These results show that our new method achieve higher AUC. It means the probability that the classifier will rank a randomly chosen positive example is higher than a randomly chosen negative example and indicates that we may have learned a good classifier."}, {"section_title": "CONCLUSIONS", "text": "In this paper, we presented a spherical sparse coding framework, applied it to study cortical thickness feature reduction problem, and evaluated our method on the ADNI2 dataset to check its classification performance. The empirical results, in a total of six comparisons, demonstrated that the spherical sparse coding method achieved greater statistical power than some other standard features."}]
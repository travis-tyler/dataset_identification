[{"section_title": "Introduction", "text": "The abundant and rapid availability of viral genomic data has had a profound effect on the response to the COVID-19 pandemic, from tracking and tracing of transmission [1, 2, 3], to vaccine and drug development [4]. Genomic SARS-CoV-2 data also allows us to investigate the evolutionary dynamics of the virus such as its mutational and selective pressures [5]. Understanding the contribution of mutation and selection in shaping SARS-CoV-2 genome evolution is important, for example, for drug and vaccine development [6], for predicting variants of clinical and epidemiological importance [7, 8, 9, 10, 11], for understanding the biological mechanisms underlying the virus\u2019 genome evolution (such as recombination [12] and mutagenic immune system responses [13, 14, 15, 16]), to improve the accuracy of phylogenetic approaches for epidemiological applications [17, 18, 19] and for inferring its origin [20].\nWhen deciphering genome evolution, one has to disentangle the effect of mutation and selection affecting the emergence and spread of genetic variants. It has been observed by several studies that SARS-CoV-2 presents a very skewed mutational spectrum, with most observed genetic variation resulting from C\u2192U mutations [21, 5, 22, 23]. It is important to account for these mutational skews when inferring selection, since recurrent mutations can generate a phylogenetic signal that can be confused with positive selection when using phylogenetic methods (e.g. [24, 25]). Such strong mutational skews, if unaccounted for, can also cause errors in phylogenetic tree inference [23, 22].\nHere, we identify common pitfalls when analysing SARS-CoV-2 genomic data, and we present alternative, more robust approaches for identifying the contribution of mutation and selection in SARS-CoV-2 evolution. We confirm that the C\u2192U mutation rate is very high in SARS-CoV-2, in particular within the context UCG\u2192UUG, putatively as the result of APOBEC (\u201cApolipoprotein B mRNA Editing Catalytic Polypeptide-like\u201d) proteins activity. However, the majority of C\u2192U mutations occur outside of this context. Secondly, and in contrast to most other studies, we find that the G\u2192U mutation rate is nearly as high (about 97%) as C\u2192U. The reason why this has not been noted in most other studies is because they did not account for the biases in the genetic code that causes most G\u2192U mutations to be selectively deleterious, particularly compared to C\u2192U mutations. This has a large effect on inferred mutation rates also because most of the SARS-CoV-2 genome is composed of coding sequence. This causes G\u2192U mutations to be underrepresented among the observed genetic variation, despite its high mutation rate. Finally, we investigate selection acting on synonymous variants. We find evidence contrary to previous claims of selection against U content [5]."}, {"section_title": "New Approaches", "text": "Estimating accurate mutation rates is essential for understanding the evolutionary and immunological pressures acting on the virus, as well as to infer accurate phylogenies and for detecting selection. One of the main aims of our work is the estimation of mutation rates in SARS-CoV-2, in particular while trying to account for the effects of selection, which can affect the spread of certain types of mutation, and therefore decrease or increase our chances of detecting them.\nPrevious studies investigating mutation rates in SARS-CoV-2 have used the approach of counting the number of genome positions at which alternative alleles are observed (see e.g. [5, 21]). This approach works well when the number of mutations occurred is small relative to the number of genome positions considered. However, when the same mutation events occur multiple times at the same position on different branches of the phylogenetic tree (as the case for SARS-CoV-2 [22, 23, 9]), this approach can underestimate the most elevated mutation rates, since multiple mutation events can end up conflated and counted as a single variant allele.\nOur approach consists instead of, first, inferring a maximum likelihood phylogenetic tree for considered SARS-CoV-2 genomes. Then, we infer a mutational history on this tree for each position of the genome using parsimony. This gives us, for each given mutation type (for example, synonymous mutations from nucleotide A to C) an estimated number of mutation events. We then normalize this number of mutation events, dividing it by the number of mutation \u201cpossibilities\u201d. These possibilities represent the number of sites in the reference genome in which a mutation of a certain type is possible. At each position, multiple mutation events of the same type are possible along the phylogeny, so the inferred number of mutation events of a certain type can be larger than the number of mutation possibilities for the same type. These normalized counts represents our estimates of relative neutral mutation rates.\nIn order to obtain multiple independent estimates, and in order to assess and possibly correct for the contribution of possible issues in our sequences, we separate mutation counts in 3 bins according to the number of descendants of each mutation: (i) those with only one descendant tip (\u201csingletons\u201d); (ii) those with \u2265 2 and \u2264 4 descendants (\u201clow frequency\u201d); and (iii) those with > 4 descendants (\u201chigh frequency\u201d). The main rationale for this is that sequence errors and RNA degradation, for example, are expected to mostly cause apparent mutation events with only 1 or very few descendants.\nFor completeness, we also show results from the alternative approach to estimating mutation rates used in previous studies, based on counting the number of alignment columns at which alternative alleles are observed. We note again, however, that due to possibly multiple mutation events of the same type occurring at the same site in different lineages, this approach is expected to underestimate the number of mutation events, in particular for recurring mutations. Similarly to before, we classify three classes of sites with a variant allele: (i) those where the variant allele is present in any number of sequences; (ii) those where it is present in at least two sequences; (iii) those where it is present in at least five sequences.\nAnother issue that needs to be considered when estimating mutation rates is that different mutations can have different effects on the ability of the virus to replicate and transmit. In this manuscript, we mainly focus on synonymous mutations, as they are sufficiently abundant in our dataset to allow reliable estimates of mutation rates, and as they are expected to usually have a more limited effect on the viral fitness [26], therefore providing more limited biases in the inference of neutral mutation rates.\nLater in the manuscript we describe a method to investigate possible fitness effects of synonymous mutations in SARS-CoV-2. This method is based on the comparison of ratios of estimated numbers of mutations with different numbers of descendants. The principle behind this method is that negative selection tends to decrease the frequency of new mutations, while positive selection tends to increase it. So, for example, if we want to compare the fitness of synonymous C\u2192U mutations versus A\u2192C ones, we can compare the ratio of high-frequency vs low-frequency synonymous C\u2192U mutations, to the same ratio for synonymous A\u2192C mutations. If the former is significantly higher, we take this as evidence that synonymous C\u2192U mutations have typically higher fitness than A\u2192C ones.\nMore details on our approaches are given in the Results and Material and Methods sections below."}, {"section_title": "Neutral mutation rates in SARS-CoV-2 ::: Results", "text": "Here, we want to estimate the underlying mutability of different nucleotides, in a way that is as unbiased as possible with regards to how these mutations might affect the ability of new mutations to replicate and spread. To do this, firstly, we mostly focus on synonymous mutations, which are expected to affect, on average, the fitness of the virus much less than nonsynonymous mutations [26]. Secondly, we only consider new SARS-CoV-2 mutations observed within the human population, and ignore long-term divergence (between-species substitutions) which are expected to be more affected by selective forces [27]. While we cannot exclude that selection still affects some of the patterns observed below, for example making some types of synonymous mutations more lethal for the virus than others, we tried to reduce these biases as much as possible in the following.\nFirst, to put our results in perspective of previous studies, we looked at numbers of sites with alternative alleles. When looking at patterns across the whole genome, it appears that all transitions (C\u2192U, U\u2192C, A\u2192G and G\u2192A) are quite common, as well as G\u2192U mutations; note however that A and U bases have more opportunities to mutate as they are more common in the genome (Figure 1A). If we focus only on possible synonymous mutations (which we expect to be less likely affected by strong selection), we see C\u2192U and G\u2192U synonymous alternative variants at the vast majority of sites at which such variants could have been observed (Figure 1B). This means that sites at which synonymous C\u2192U and G\u2192U mutations might have occurred are possibly saturated with such mutations. In fact, using our phylogenetic approach to estimate numbers of mutation events of each type at each genome position, we clearly see that C\u2192U and G\u2192U are the most frequent mutations (Figure 1C), despite having fewer opportunities to occur due to GC content being lower than AT content. Focusing again on synonymous mutations, we can see that, while we don\u2019t infer more overall G\u2192U mutations than U\u2192C or A\u2192G ones, given the very low number of sites at which synonymous G\u2192U mutations are possible, G\u2192U and C\u2192U seem the synonymous mutations that occur proportionally more often (Figure 1D). We also observe similar patterns for non-coding, non-synonymous and 4-fold degenerate sites (Figure S1). These observations suggest that the G\u2192U and C\u2192U underlying neutral mutation rates are considerably higher than all others.\nOur results further suggest that inferring mutation rates from counting the number of sites with variants (the counts in Figure 1A\u2013B, and as in e.g. [5, 21]) can lead to underestimating the G\u2192U and C\u2192U synonymous mutation rates. This is because sites at which such mutations are possible are probably often saturated (multiple mutation events of exactly the same type have occurred along the phylogeny). However, saturation in previous studies was probably not as extreme as here since we investigate a considerably larger number of genomes. Another difference of our approach from most previous studies (but similar to [5]), is that we aim to disentangle the contribution of selection acting on the amino acid sequence from the underlying mutation rates, and to do this we separate synonymous and nonsynonymous mutations. This has a considerable further effect on the inference of the G\u2192U mutation rates, because there are only a few sites at which a G\u2192U mutation is synonymous, and so most possible G\u2192U mutations are probably under significant purifying selection; skews in the genetic code [28, 29] are probably an important factor here. Of further impact, G is less frequent in the SARS-CoV-2 genome than U, in particular at 4-fold degenerate sites (sites where any 1-base mutation is synonymous) with a frequency of 6.5%, compared to frequencies of A 28.9%, C 11.4%, and U 50.9%; this causes a further under-representation of observed G\u2192U mutations relative to the underlying G\u2192U mutation rate.\nA confirmation that many synonymous G sites are saturated with mutations can be seen in Figures 2 and S2. C\u2192U and G\u2192U mutations are by far the most homoplasic (the same mutation occurs more than once along the phylogeny), especially at synonymous and non-coding positions. This is unlikely to be the result of positive selection favouring these mutations, or of phylogenetic tree inference or parsimony mutation inference errors (since this seems to affect only C\u2192U and G\u2192U mutations) and seems instead the result of underlying relatively high neutral C\u2192U and G\u2192U mutation rates.\nWe also mostly find C\u2192U or G\u2192U mutations among the most homoplasic mutations of the genome: 55 out of 59 total mutations that occur more than 60 times at the same position are C\u2192U or G\u2192U. Here we ignore sites that are so homoplasic as to probably cause issues in phylogenetic inference [23, 22]; these sites were masked before any analysis here, and are namely the G\u2192U mutation at position 11083, and the C\u2192U mutations at positions 16887 and 21575. These three sites appear as the most mutable in the genome. However, the next 3 most homoplasic mutations of the genome that we identify here are neither C\u2192U nor G\u2192U mutations. The most recurrent one is the A\u2192G nonsynonymous (K\u2192R) mutation at position 10323 which we inferred to have occurred 138 times, with a total of 1187 descendants, found in context CTTAAGCTTAAGGTTGATACA. The second is a A\u2192G nonsynonymous (K\u2192R) mutation at position 21137, which occurred 130 times with a total of 472 descendants, found in context ATACAACAAAAGCTAGCTCTT. The third is a T\u2192C synonymous mutation at position 27384 which occurred 119 times, with a total of 808 descendants, found in context TGGAGATTGATTAAACGAACA. We suspect that these 3 mutations are the results of frequent ADAR activity, considering also their context. For example, the first two are A\u2192G mutations with a G downstream and an A upstream (see [30, 31]). The third site is probably affected by ADAR acting on the negative strand. The fourth highly homoplasic mutation we found that is not G\u2192U or C\u2192U is the 11th most common in the genome, a G\u2192A nonsynonymous (G\u2192S) mutation at position 1820, with a total of 409 descendants and in context AGCTAAAAAAGGTGCCTGGAA.\nOne of the principal aims of our work is to estimate mutation rates while taking into account the effect of selection acting on the amino acid sequence, and trying to account as much as possible for other issues such as homoplasic mutations. To do this, firstly, we focus on synonymous mutations, which are expected to be less subject to selective constraints than nonsynonymous ones, while being much more abundant than non-coding mutations. Secondly, we use inferred counts of mutation events (using parsimony inference along our phylogenetic tree, see Methods); this accounts for the saturation of mutation events at more mutable positions, as discussed before. Thirdly, we separate mutation counts according to the number of observed descendants of each mutation - this allows us to have independent estimates, and to have estimates that do not rely on inferred mutation events with one descendant, which might be enriched in sequence errors or RNA degradation (in the case errors RNA degradation would be present in our alignment). Fourthly, we normalize mutation counts by the number of mutation possibilities, so to account for the fact that certain mutation types (for example synonymous G\u2192U mutations) are possible at fewer sites than other mutation types. For this last point, we divide the number of inferred mutations of a certain type (e.g., red, orange and yellow bars in Figure 1D) by the number of sites at which such mutations are possible (e.g., green bars in Figure 1D), always considering the reference genome as the mutational ancestral background. We find that the G\u2192U (transversion) mutation rate is similar to C\u2192U (transition) (Figures 3 and S3), and they are both considerably higher than all other rates (about 4 times higher than the next highest rate, G\u2192A, see Table 1). We confirm that all other transitions, U\u2192C, G\u2192A and A\u2192G, have lower rates, but higher than all remaining transversions. In particular, the mutational process seems highly asymmetrical and strand-asymmetrical, with mutation rate G\u2192U being 82.0 times higher than U\u2192G and 21.1 times higher than C\u2192A (Table 1). This strand-asymmetry is likely the result of ROS and APOBEC activity on single-strand RNA [14, 15].\nOur results differ remarkably from those studies that either estimated mutation rates by comparing numbers of sites with alternative alleles, did not divide these counts by the numbers of opportunities for such mutations, and/or did not account for the biases in the genetic code by separating synonymous and nonsynonymous mutations (e.g. [20, 32]). Our results are instead more consistent with those of studies that did take some of these steps and highlighted similarly high C\u2192U and G\u2192U mutation rates in SARS-CoV-2 (e.g. [5]). While elevated C\u2192U mutation rate in SARS-CoV-2 has been frequently observed and usually attributed to the effects of APOBEC activity, the elevated G\u2192U has been discussed much less, but it has been usually suggested to be the result of the activity of reactive oxygen species (ROS), see [5, 15]. The number of descendants of mutation events seems to have little impact on our inferred relative mutation rates (Figure 3B); this suggests that phenomena like RNA degradation or sequence errors, which are expected to overwhelmingly result in inferred mutation events with one descendant, do not considerably affect our mutation rate estimates."}, {"section_title": "Context dependencies ::: Results", "text": "One of the observations that suggests APOBEC activity being the leading cause of the elevated C\u2192U mutation rate in SARS-CoV-2 is that nucleotide context seems to affect the C\u2192U mutation rate in a way that is consistent with the action of some of the human APOBECs [15]. Here we study the effect of neighbouring base context on C\u2192U mutability. We divide the set of possible and observed C\u2192U mutations in classes based on the nucleotide context (5\u2019 to 3\u2019 preceding and following base). Even though we focus only on C\u2192U mutations, it is still important to separate synonymous and nonsynonymous mutations, since different contexts can lead to synonymous or nonsynonymous C\u2192U mutations with different proportions. Additionally, different contexts can be present with different frequencies in the SARS-CoV-2 genome. Focusing on synonymous mutations, and using the normalization procedure outlined above, we find that UCG\u2192UUG appears to be the most mutable context (Figures 4A and S4). Note that this pattern is not observed if one considers unnormalized mutation counts, particularly those from nonsynonymous mutations (Figure S5).\nThis confirms previous results which suggested an elevated UCG\u2192UUG mutation rate [32, 16, 5], attributed to either the context-specificity of APOBEC mutational targets, or to selection against CpG dinucleotides [15]. We discuss selection in the next section. Here, we note that while we found a signal of context affecting mutation rates in SARS-CoV-2, and while at least part of this observation is consistent with some of the known sequence targets of APOBEC, overall, C\u2192U mutations occurring in UCG or more generally UC\u2192UU context represent only part (and a very small part for UCG) of all C\u2192U mutations in SARS-CoV-2 (Figure S1) and as such they don\u2019t explain by themselves the whole C\u2192U relative hypermutability.\nWhen we look at longer sequence context (previous 5 bases and following 5 bases) we see that U in the 2 bases preceding a C seems to have a C\u2192U mutagenic effect, while G in the previous 2 bases and C in the following 2 bases seem to reduce the mutation rate (Figure S6).\nGiven the relatively high G\u2192U mutation rate, we performed a similar analysis of context effects on G\u2192U mutations. However, while having a high rate, G\u2192U synonymous mutations are quite rare (Figure S7 for numbers in different contexts) and so estimates of context-dependent rates are expected to have substantial uncertainty. Additionally, some contexts are not possible for G\u2192U synonymous mutations, for example AG\u2192AU mutations are never synonymous (Figure S7). We don\u2019t notice any one particularly elevated mutational G\u2192U context, however, a G being preceded or followed by a C (CG and GC contexts) seems to have a higher G\u2192U mutation rate (Figures 4B and S8)."}, {"section_title": "Testing for selection at synonymous sites using mutation frequencies ::: Results", "text": "Previous authors have discussed the effect of selection on synonymous mutations in SARS-CoV-2. For example, the elevated mutation rate in CpG context has been interpreted as a sign of selection against CpG content in SARS-CoV-2 in order to avoid zinc finger antiviral proteins (ZAP), see [15]. This is consistent with similar evidence found from depleted CpG content in other coronaviruses [33]. However, evidence from CpG content and substitution rates can be confounded by skewed mutation rates and mutational contexts like the ones due to APOBEC activity, which might be the leading cause of mutation in SARS-COV-2.\nTo overcome this limitation, and in order to disentangle the contribution of mutation and selection over the synonymous evolution of SARS-CoV-2, [5] compared equilibrium frequencies inferred from SARS-CoV-2 substitution rates to observed nucleotide and dinucleotide frequencies. Since selection tends to raise the frequency of favourable alleles in a population, and to decrease the frequency of deleterious alleles, if a certain nucleotide is advantageous over another at synonymous sites, for example, if C is advantageous over U, it is expected that relatively more U\u2192C mutations will reach fixation (completely replace the ancestral allele in the population) than C\u2192U mutations. This means that, in the long term, there would be fewer U nucleotides in the genome than expected based on the mutation rates estimated from observed genetic variation within the population. [5] observed that U nucleotides are less common at 4-fold degenerate sites in SARS-CoV-2 than expected from SARS-CoV-2 genetic variation within humans, and concluded that there is ongoing selection against U nucleotides in SARS-CoV-2. With a similar analysis, they also concluded that there is no ongoing selection against CpG content in SARS-CoV-2, despite opposite prior expectations (see [15, 33]).\n[5] assumed that the evolutionary process is stationary, that is, that mutation rates and selective pressures did not change recently (for example, since the introduction of SARS-CoV-2 into humans). This assumption is highly debatable. Due to the recent host shift and to the fact that many mutations in SARS-CoV-2 seem to be the consequence of host immune system activity, a recent significant change in mutation rates and selective pressure in SARS-CoV-2 (associated with its introduction to humans) is likely. In fact, studies have suggested that the current G\u2192U mutation rate of SARS-CoV-2 in humans, for example, is much higher than in its reservoir hosts [34, 35]. Specifically, [34] estimated that the G\u2192U mutation rate in SARS-CoV-2 increased 9-fold with its introduction in humans, possibly due to difference in ROS activity between hosts.\nWe used the approach of [5] on our dataset to estimate mutation rates at 4-fold degenerate sites, and then from these estimated equilibrium nucleotide frequencies using the python package discreteMarkovChain v0.22 https://pypi.org/project/discreteMarkovChain/. Similarly to [5], we find that 4-fold degenerate site U content is considerably lower than the equilibrium U content (50.9% vs 65.5%). However, if we re-calculate the equilibrium nucleotide frequencies after decreasing the G\u2192U mutation rate 9-fold in this analysis (to mimic the putative reservoir mutation rate estimated in [34]), the difference almost disappears (equilibrium U content 52.6%). If we repeat the analysis above using mutation rates as in Table 1 (inferred from mutation counts) instead of mutation rates inferred as in [5] (inferred from the numbers of sites with variant alleles, as in Figure 1B), we find an equilibrium U frequency of 77.4%, and, after decreasing G\u2192U rate 9-fold, of 64.9%. These observations suggest that, indeed, changes in mutation rates can cause strong changes in equilibrium frequencies, and the inference of selection from the comparison of current and equilibrium nucleotide frequencies can be affected by changes in mutation rates.\nTo address this issue, we propose an alternative approach to test for selection acting on synonymous mutations. Since selection increases the frequency of favourable alleles and decreases the frequency of deleterious alleles within a population, we expect selection to change the relative proportion of alleles at different population frequencies. The McDonald-Kreitman test [27], for example, compares numbers of synonymous and nonsynonymous within-species polymorphisms and between-species polymorphisms; within this framework, purifying selection is expected to decrease the number of nonsynonymous substitutions more than the number of nonsynonymous polymorphisms.\nHowever, the emergence of SARS-CoV-2 in humans is relatively recent, too recent for variants (and especially a statistically sufficient number of variants) to have reached fixation within the human population, making this type of test not applicable. Instead, we use an alternative version in which we compare low-frequency mutations against high-frequency ones. While our aim is to focus on comparing different types of synonymous mutations, we first apply this approach to compare synonymous and nonsynonymous mutations, so as to make the similarity to the McDonald-Kreitman test more apparent. Nonsynonymous mutations in SARS-CoV-2 appear significantly shifted towards lower frequencies (Figure 5), consistent with the expectation that purifying selection tends to decrease the frequencies of nonsynonymous mutations more than the frequencies of synonymous mutations.\nNext, we focused on the hypothesis that U variants at synonymous sites are on average mildly deleterious [5]. This time, not all of our comparisons are significant, but those that are, consistently suggest that selection favours U variants (Figure 6), not the opposite. As we discussed before, the difference with the estimate from [5] probably lies in the assumption of stationarity in SARS-CoV-2 evolution (although we also used a larger dataset and a different approach to estimate mutation rates).\nA possible explanation for the pattern we observe is that many mutations increasing U content are C\u2192U or G\u2192U, and therefore may sometimes reduce CpG content. Selection against CpG content has already been suggested in coronaviruses [33], and is expected due to ZAP activity [15]. However, using our approach the evidence in support of this hypothesis is not significant (Figure S9). Similarly, when investigating possible selection affecting GC content, only one of the comparisons is significant (Figure S10)."}, {"section_title": "Discussion", "text": "In this study, we investigated mutation rates and selection at synonymous sites in SARS-CoV-2. We used a different methodology than previous studies, so as to exploit more than 147,000 SARS-CoV-2 genome sequences while trying to avoid inaccuracies due to mutation saturation. Our approach also accounts for the fact that different types of mutations can have, on average, different fitness due to their impact on the amino acid sequence and due to skews in the genetic code. Also, we did not assume equilibrium in SARS-CoV-2 genome evolution, which is unlikely given the recent shift of host the virus underwent.\nWe found that two mutation rates, C\u2192U and G\u2192U, are similar to each other and much higher than all others mutation rates, leading to extremely frequent homoplasies. This also means that the SARS-CoV-2 mutation process is very far from being symmetric or strand-symmetric; it is also considerably far from equilibrium. We also found some sites with extremely high non-C\u2192U non-G\u2192U mutation rates that are consistent with targeted ADAR activity.\nA consequence of these findings is that popular and efficient phylogenetic substitution models such as JC69 [37], HKY85 [38], or GY94 [39] might be inappropriate with SARS-CoV-2 data and might cause biases in the inference of phylogenetic trees [23], positive selection [9] and recombination [12] due to the neutral high recurrence of certain mutations. It is therefore probably important to adopt phylogenetic substitution model that can account for elevated C\u2192U and G\u2192U rates, such as the non-reversible UNREST model [40], which however we found to usually cause numerical instability in current phylogenetic packages that allow it [41, 42]. In the future, if we want to alleviate these biases, it will be important to implement such more general substitution models more broadly and in a more numerically stable way.\nWhen investigating selection at synonymous sites possibly affecting CpG or GC content, we found mostly non-significant patterns. We also investigated the possibility of selection against U content in SARS-CoV-2 [5], but found significant evidence in the opposite direction. While further analyses will be needed to establish with confidence what kind of selection acts non SARS-CoV-2 synonymous mutations, we suggest that inference based on assumption of genome equilibrium can be biased by changes in mutation rates and selective pressures associated with host shift. While we tried to account for possible biases as much as possible, our methods still have some limitations. First of all, our inference of mutation events is based on a prior phylogenetic inference, but tree inference from SARS-CoV-2 data is typically not very reliable, in part due to the low genetic diversity among sequences, but also due to homoplasic mutations [43, 23]. As mentioned above, our phylogenetic inference might also have been negatively affected by the choice of substitution models; however, currently, more realistic models like UNREST are either not implemented or are numerically unstable in sufficiently efficient phylogenetic packages such as [41, 44, 42]. In this study we tried not to rely excessively on individual inferences of mutation events, but rather focused on general patterns averaged over many sites and clades, which we think should provide robust inference despite the fact the inference of individual mutation events might not be reliable. However, a potential bias that might affect our result derives from the fact that some sites are very homoplasic, and our phylogenetic inference might lead to an over-parsimonious inference of their mutational history. This, in turn, might lead us to underestimate their mutation rate and overestimate their number of descendant tips per mutation events. In the future, a Bayesian phylogenetic approach might be useful to assess and possibly resolve this issue and assess its impact on our inference of selective pressure; however so far Bayesian phylogenetic inference has proved prohibitive with datasets of this size.\nTo further investigate and disentangle selective and mutational forces in SARS-CoV-2, it would be very promising to combine an analysis of between-patients and within-patient SARS-CoV-2 genetic variation. In a similar way as selection is expected to decrease the frequency of deleterious SARS-CoV-2 alleles at the human population level, the same is true at the within-host levels, as selection is expected to act on within-host deleterious mutations and often prevent them from reaching high frequency and transmit further on. While within-patient genetic diversity data can indeed be very informative of the SARS-CoV-2 evolutionary patterns [13, 14, 45], it is important to consider that such data is also more prone to sequencing, read processing, and RNA degradation issues. These issues cause some errors in consensus sequences [23, 22] but they are expected to be even more problematic at the level of detected within-host variation. Indeed, so far there is reason to be cautious when interpreting these data [22], especially with specific datasets (see https://virological.org/t/gained-stops-in-data-from-the-peter-doherty-institute-for-infection-and-immunity/486). Given reliable data regarding evolution at different levels (e.g. within a patient, between patients, and between hosts), it would be interesting to combine these sources of information to improve estimates of selective pressures (see e.g. [46, 47]).\nOur methodology to detect selection could also be improved by using the full site frequency spectrum of mutations, instead of categorizing mutations into frequency classes (see e.g. [48, 49]). However, it is important to consider that complex epidemiological dynamics and sampling biases in SARS-CoV-2 mean that it is hard to interpret the shape of any individual site frequency spectrum in terms of the effects of mutation and selection. We infer mutation and selection patterns by comparing properties of site frequency spectra associated with different mutation types. This approach should be robust to the effects of variable population dynamics and sampling biases, since these forces are expected to affect in the same way site frequency spectra associated with different mutation types.\nIn the future, we hope to extend our current approach to also study insertions and deletions (indels): their frequency, recurrence and possible fitness effects (see e.g. [50]). However, we expect that incorporating indels in our approach will be challenging since standard phylogenetic approaches rarely model indels."}, {"section_title": "Data collection and phylogenetic inference ::: Materials and Methods", "text": "Full details and reproducible code for the construction of the global tree of SARS-CoV-2 samples are available in the 13/11/20 release of [51]. To summarise, this code creates a global phylogeny of all available samples from the GISAID data repository as follows.\nFirst, all sequences marked as \u2018complete\u2019 and \u2018high coverage\u2019 submitted up to 13/11/20 were downloaded from GISAID. Sequences with known issues from previous analyses were then removed from this database (details are in the excluded_sequences.tsv file at the above DOI).\nSecond, a global alignment was created by aligning every sequence individually to the NC_045512.2 accession from NCBI, using MAFFT v 7.471 [52], faSplit (http://hgdownload.soe.ucsc.edu/admin/exe/), faSomeRecords (https://github.com/ENCODE-DCC/kentUtils), and GNU parallel [53]. This approach aligns each sequence individually to the reference, then joins them into a global alignment by ignoring insertions relative to the reference.\nThird, sites that are likely to be dominated by sequencing error [23] are masked from the alignment using faSplit, seqmagick (https://seqmagick.readthedocs.io/en/latest/), and GNU parallel, sequences shorter than 28KB or with more than 1000 ambiguities are removed from the alignment using esl-alimanip (hmmer.org), and subsequently sites that are > 50% gaps are removed (after converting N\u2019s to gaps) using esl-alimask.\nFourth, the global phylogeny was estimated using IQ-TREE 2 [41] FastTree 2 [44] (v2.1.10 compiled with double precision) in two stages. First, new sequences added to GISAID between 11/11/20 and 13/11/20 were added to the phylogeny inferred on 11/11/20 using Maximum Parsimony placement in IQ-TREE 2. This produces a starting tree of all sequences available on 13/11/20. Second, the starting tree was optimised using FastTree 2 with 2 rounds of Subtree Pruning and Regrafting (SPR) using moves of length 1000 under a minimum evolution optimisation regime, and the tree was then further optimised using multiple rounds of Maximum Likelihood Nearest Neighbour Interchange (NNI) moves until no further improvement to the tree could be achieved using NNI. The resulting tree was rooted with our reference (NC_045512.2 / MN908947.3 / Wuhan/Hu-1) sequence using nw_reroot [54].\nFrom the resulting tree, we removed sequences on very long branches using TreeShrink [55] using the default, q <= 0.05 threshold, to identify such branches. These sequences are likely to be either of poor quality and/or poorly aligned, so rather unreliable to interpret in a phylogeny with such limited variation. The final tree and its related alignment contains 147,137 SARS-CoV-2 genomes."}, {"section_title": "Estimation of mutation rates ::: Materials and Methods", "text": "To separate mutation events into different categories, each position of the reference genome (NC_045512.2 /MN908947.3 / Wuhan/Hu-1, see https://www.ncbi.nlm.nih.gov/nuccore/MN908947) was classified as coding or non-coding. Start and Stop codons were not considered in the following analysis. The first and last 100bp of the genome, in addition to sites marked as problematic in https://github.com/W-L/ProblematicSites_SARS-CoV2/blob/master/problematic_sites_sarsCov2.vcf [22, 23], were also not considered here. We counted \u201cpossibilities\u201d of mutations based on the reference genome: for example a non-coding C allele in the reference genome represents 3 possibilities for non-coding mutations (C\u2192A, C\u2192G and C\u2192U). For coding sites, we split synonymous and non-synonymous mutation possibilities into two separate counts. Similarly, we also used the reference genome to define the number of possible mutations within each genetic context. Sites that were masked in the alignment were still used here to define the genetic context of possible mutations at neighbouring non-masked sites.\nWe then inferred a mutational history with parsimony over our global maximum likelihood tree, as described in [23]. The software for doing this analysis is available from https://github.com/yatisht/strain_phylogenetics. Given this inferred mutational history, for each site, we counted all the mutation events inferred from the reference allele to any alternative allele, and we recorded the number of descendant tips of each mutation event, excluding those that are descendants of further downstream mutations at the same site. Note that we do not count mutation events that modify a non-reference allele. For example, if at a U position of the genome we have a U\u2192C mutation, and in one of the descendants of this mutation event we have a C\u2192A mutation at the exact same position, then we count the first U\u2192C mutation but not the second C\u2192A; this is done to aid the normalization of mutation counts, see below. At each site and for each mutation type, we kept counts of three different classes of mutations: (i) those with only one descendant tip (\u201csingletons\u201d); (ii) those with \u2265 2 and \u2264 4 descendants (\u201clow frequency\u201d); and (iii) those with > 4 descendants (\u201chigh frequency\u201d). Number of different mutation types and mutation possibilities observed across the SARS-CoV-2 genome are given in Figures 1 and S1. Note that the number of observed mutations is often higher than the number of mutation possibilities. For example, a reference 4-fold degenerate site with an reference A allele counts as one A\u2192C, one A\u2192G and one A\u2192U synonymous mutation possibility. However, an A\u2192C mutation event can occur multiple times along the phylogeny at this site, possibly resulting in multiple A\u2192C synonymous mutations observed. When classifying mutation events into different categories, we assume that mutations happen in the genetic background of the reference genome. This might be inaccurate in some cases, but given the overall low level of divergence (all reliable sequences so far being diverged less than 50 substitutions from the reference genome) the effect of this approximation should be very limited.\nThe low mutation rate observed in SARS-CoV-2 makes parsimony an efficient and reliable approach to infer mutational histories [56]. However, phylogenetic inference from large SARS-CoV-2 datasets is difficult due to elevated computational demand and phylogenetic uncertainty [43], and we cannot exclude the presence of errors in our phylogenetic tree, and therefore in our mutational history.\nAs mentioned earlier, we also consider an alternative approach to estimating mutation rates, based on counting the number of alignment columns at which alternative alleles are observed. We classify three classes of variant allele: (i) those present in any number of sequences; (ii) those present in at least two sequences; (iii) those present in at least five sequences. Numbers of different types of variable sites found in our alignment are given in Figures 1 and S1.\nFor each class of mutations (synonymous, nonsynonymous, or noncoding; from any nucleotide to any other nucleotide; within any sequence context) we estimate an approximate mutation rate by dividing its total mutation count by its possibilities count. These rates represent the average number of mutation events of a certain type expected per given site along the considered phylogeny."}]
[{"section_title": "Abstract", "text": "A high replicability in region-of-interest (ROI) morphometric or ROI-based connectivity analyses is essential for such methods to provide biomarkers of good health or disease. In this article, we focus on package design, and more specifically on cortical parcellation protocols, for novel insight into their contribution to inter-package differences. A critical analysis of cortical parcellation protocols from FreeSurfer, BrainSuite, BrainVISA and BrainGyrusMapping revealed major limitations. Details of reference populations are generally missing, cortical variability is not always explicitly accounted for and, more importantly, definition of gyral borders can be inconsistent. We recommend that in the package selection process end users incorporate protocol suitability for the ROIs under investigation, with these particular points in mind, as inter-package differences are likely to be significant and the source of incompatibility between studies' results."}, {"section_title": "Introduction", "text": "It is of great interest to understand the brain morphology in particular populations, to link structure to function, e.g. specific behaviours in health or disease. The cortical surface of the human brain, depicted by many peaks and troughs, otherwise known as gyri and sulci, is thought to relate to many human traits (Sabuncu et al., 2016) . Because manual delineation, or segmentation, of anatomical structures is a tedious and unreliable process that heavily relies on user expertise, automated methods have become more popular to study brain morphology or simply parcellate the brain for subsequent analyses (Eickhoff et al., 2015) . These methods are implemented mainly in two phases: preprocessing and parcellation. During preprocessing, data are prepared using a suitable image registration method, skull stripping, bias field correction, and some form of tissue classification (also known as segmentation). At the end of this phase, each of the volume's voxels are assigned to either the grey matter (GM), white matter (WM), cerebrospinal fluid (CSF) or other class(es). During the parcellation phase, sub-regions are segmented and labeled based on the atlases and algorithms incorporated into the software. The preprocessing phase is usually automated, although driven by userspecified parameter values for its algorithms. The cortical parcellation phase can be either semi-or fully-automated, but often allows manual editing. Corresponding morphometric measurements usually accompany the segmented parcels. They classically include cortical thickness (Fischl and Dale, 2000) , sulcal length (Kochunov et al., 2012) , volume (Murphy et al., 2014; Shattuck and Leahy, 2002) , sulcal depth (Kochunov et al., 2012) , and surface area (Fischl and Dale, 2000) . These results are then entered into statistical analyses looking at population features (e.g., Resnick et al., 2000; Rettmann et al., 2005; Kochunov et al., 2007 Kochunov et al., , 2008 , and can serve as biomarkers or form the basis of classifiers for various diseases (Apostolova et al., 2007; Bakkour et al., 2008; Cuingnet et al., 2011; Dickerson et al., 2011; Schmitter et al., 2015; Sueyoshi et al., 2006) . It is therefore crucial to understand how parcellation is established: whether the parcellation protocols accommodate anatomical variability, and how they vary across software packages."}, {"section_title": "Software diversity", "text": "We searched the literature for brain parcellation software, seeking longstanding and widely used brain parcellation tools. Up to November 2012, we identified 22 packages in total, with 23 protocols (Fig. A.1 ), which can be classified into 3 categories: (1) manual segmentation (n=3), (2) cortical parcellation and automatic sulcal identification (n=11), and (3) cortical parcellation and/or classification (n=9). All packages but two segmented the entire cortical surface (or more), while the two only segmented the corpus callosum (Automatic Registration"}, {"section_title": "Cortical variability", "text": "Anatomical variability is greatly acknowledged and documented in the literature Damasio, 2005) . It is generally attributed to variations in the lengths and curvature of gyri or sulci or both, which in turn affect the properties of ROIs. Defining such regions is not a trivial issue, as most atlases do not define, or at least not consistently, where their gyri and sulci begin and end. This inconsistency is partly due to differences between the sources of information that atlases integrate: molecular architectonics (Ding et al., 2016; Essen et al., 2016; Glasser et al., 2016; Yates, 2016; Zhang et al., 2016) , fMRI, diffusion tensor imaging among others Essen et al., 2016) . In addition, anatomical differences typically exist between a subject's left and right hemisphere Purves et al., 2001) , and shape asymmetry has been associated with ageing and disease, such as Alzheimer's disease, both histologically (Stefanits et al., 2012) and analytically (Long et al., 2012; Thompson et al., 2007) . In the event that a parcellation protocol does not accurately address all possible variability scenarios -which is likely impossible -the fine parcellation details remain unknown. Gyral borders could very likely be mis-interpreted, with a knock-on effect on all associated and adjacent structures, ROI volumes and their corresponding morphometrics. Variability therefore becomes a source of uncertainty, be it for the atlas generator (typically a manual delineation of the 'ground truth'), the software developer, or the software end-user.\nTo best understand the forms in which cortical variability may present itself, and to later identify how they are dealt with by the various packages, we used Ono et al.'s comprehensive anatomical atlas . The colleagues log their findings with regards to the normal-appearing hemispheres of 25 fixed human brain specimens of unknown age and gender. This includes incidence rates per hemisphere, and a detailed description of the types of variability for each structure, which we summarize in Table A.1. They identify five general types of variability in sulci (double sulci, branching, sulcal interuption, connection, and absence) that are prevalent throughout the cortical surface, illustrated in Fig. 1 , as well as one type of gyral variability (absence).\nA double sulcal pattern is one where two sulcal curves are referred to using identical, rather than differentiable, nomenclature. The pattern's occurrence is greatest in the cingulate and calcarine sulci. Examples of this as well as of sulcal branching at the cingulate sulcus can be seen in Fig. 1a . For various reasons, sulcal interruptions occur at different levels, leaving the sulcus in several segments rather than one (Fig. 1b) . Sulcal connections (Fig. 1c, d ) occur when two or more sulci connect to one another. The highest sulcal absence is in the lunate sulcus, for both hemispheres. Absence of the cingulate gyrus and corpus callosum is also noted by Ono and his colleagues, but with no mention of incidence rates as it is a rare congenital disorder.\nGiven the range of anatomical possibilities, it becomes apparent that several questions can be asked when studying protocol details to best understand the variability measures taken: (1) with a double (rather than a single) sulcus, are both sulci delineated, or just one? If one, then which one? And if both, then how? By two separate curves or by one long curve joining both, or perhaps parts of both? (2) with sulcal branching, where are the sulcus' start and end points, and which of the branches are to be included? (3) with sulcal interruptions, where a sulcus consists of several curves rather than one, are one, several, or all interruptions considered? Furthermore, are all the considered interruptions assigned the same nomenclature? Are they considered independent segments, which together make up the interrupted sulcus, or are they joined to one another perhaps by an 'optimal' or 'minimal cost' path? (4) with sulcal connections, where is the endpoint of one sulcus and starting point of the next? It is not always obvious, (5) in the event that a sulcus is absent, yet is defined in the protocol as a landmark bordering a particular region, which alternative structure is to serve as the new border? An example of this scenario is the lunate sulcus, which borders the caudal end of the middle occipital gyrus when present ([p. 74] Ono et al., 1990; [pp. 7, 19] Duvernoy, 1999) . Similarly, the fronto-orbital sulcus ([pp. 92-93] Ono et al., 1990) , also referred to as the lateral orbital sulcus, divides between the pars orbitalis (of the inferior frontal gyrus) and the lateral orbital gyrus ([p. 10] Duvernoy, 1999) and may be absent.\nBased on the reported incidence rates (Table A .1), in any cohort similar to one can reasonably expect to have at least one subject with a listed variation. Therefore the specifics of a parcellation protocol in that regard cannot be taken lightly. When the available variability details are ambiguous to the end-user or incomplete, one is left wondering about how anatomical variability is considered, what the implications of that are, and whether or not the results will be reproducible.\nIt is therefore essential that all known and well-documented cases of variability are addressed and clearly defined, leaving no room for guessing. For example, in the event of a double sulcal pattern, the number of sulci to be used and joining details, if any, must be clarified. For sulci with a chance of branching, interruptions and/or connections, start and end points ought to be clearly identified. In the event of sulcal absence, it is of essence to indicate whether an alternative landmark is to take the sulcal name, and if not, what happens if this absent sulcus is meant to border a parcel. And finally, guidance on existence and location of a cingulate sulcus in the event of cingulate gyrus and corpus callosum absence would be helpful. From what our analysis of protocols shows, BrainSuite is the software to address explicitly these sorts of variability. BrainVISA also does so, although differently, by limiting its parcellation to the least variant of sulci, and avoiding the rest, with focus on the sulcal roots distributed across a fixed orthogonal system. Given the many possible combinations in cortical variability, it is practically unfeasible to rely on atlas population alone to address this. However, to adequately address this issue algorithmically, it is of great importance that the individual variations are present and documented in the atlas. In turn, how this information is leveraged by the algorithm should be equally well-documented.\nBecause different interpretations of variability could potentially lead to different gyral volumes and sulcal landmarks, any morphometrics conducted on these regions of interest could be very different as well. This, for example, could be in the form of gyral volume, sulcal length or depth, white matter surface area, and gyral thickness. It is therefore essential to be working with a reliable package that offers accuracy and reproducibility.\nAs previously mentioned, the BrainCOLOR protocol authors address and justify their choices of landmarks in the event of disagreement across packages, for the sake of clarity and consistency. For example they omit the pole regions of the frontal lobe, while aware of their use by others, and acknowledge that this will produce larger ROIs than other packages, consequently affecting morphometrics and statistics for the affected regions, including the SFG (Table 4) . To address variability at the fronto-parietal boundary on the medial surface, they decide to consistently use the central sulcus, or more specifically the coronal plane drawn at the sulcus's medial limit, thereby making it the PrG's posterior border. This border is defined by a plane relating to either the central or precentral sulcus in other packages. For the supracallosal areas of the CG, they mention variability in the posterior boundary across packages and have chosen the subparietal sulcus (and a projection from its inferior limit) for themselves. A double cingulate sulcus scenario is also considered ( Table 5 ). The anterior-most sulcus is referred to as the 'paracingulate sulcus' and when present contributes to the boundary of the cingulate gyrus (e.g., Fig. 5a ). This can be clearly seen in a parcellated left hemisphere of a right-handed middle-aged man, Fig. 5b . There is no other mention of double sulcal scenarios by this protocol. There also is no mention of a 'paracingulate sulcus' in the two anatomical reference books we studied. The posterior border of the SmG is also debated for this protocol before being assigned to the primary intermediate sulcus, with a projection where possible, for the sake of consisistency with most packages. Despite it being challenging to identify, the authors strive to achieve reliability with it by recruiting a large cohort for their atlas. No inter-package comparisons are made for the ITG borders. Cortical variability is further considered through the use of 'if' clauses, to factor in branching as well as the extent to which a sulcus extends. This, for example, is clearly seen in the border definitions for the opercular part of the inferior frontal gyrus, the precuneus, the superior frontal gyrus, as well as the superior, middle and inferior occipital gyri.\nIt is uncertain whether variability considerations were made at the Only a small portion of GM inferior to the upper sulcal curve is associated with the CG in FreeSurfer, unlike in BrainGyrusMapping and BrainSuite where a larger portion is associated (Mikhael, 2017) .\nlandmarks level or the algorithm's optimisation process in FreeSurfer, however, it is most likely that such considerations were incorporated, as we see in Fig. 5c , yet not necessarily publicised. Here a small, although not the entire, portion of the cortex between the 2 (double) cingulate sulci contributes to the CG. The authors of the newer DKT protocol (Klein and Tourville, 2012) state this as a 'common error' in the double sulcal scenario and resolve it by specifically mentioning the double cingulate sulci, and naming the anteriormost one as the CG's superior border. Several other uncertainties are alleviated throughout the cortical surface when they redefine gyral borders in terms of less variant and precise landmarks, less variant sulci specifically, and eliminate some regions. In this article we strive to highlight the significance of the knowledge of these variability details. The authors of the BrainSuite protocol clearly state how variability was handled when developing the package's sulcal curves atlas (Table  A. 3). In the event of a double sulcus, the most lateral one is outlined, as shown in Fig. 5d . Missing sulci are neither drawn nor replaced by others. Sulci do not intersect in this protocol, and are therefore drawn as several segments in such circumstances. The atlas was manually delineated by one of the aforementioned authors (Damasio) . It clearly specifies start and end points, of sulci, particularly when intersecting other sulci (e.g., superior frontal sulcus, inferior frontal sulcus, intraparietal sulcus) or when they vary from subject to subject (e.g., cingulate sulcus), while emphasizing consistency across all subjects.\nBecause BrainVISA's MarsAtlas is based on cortices formed from Brodmann areas, we expected to see differences in terms of parcel borders relative to those of other software packages. To avoid issues in the event of variability, the BrainVISA developers excluded the intermediate frontal sulcus from acting as a landmark in its orthogonal system. They found their protocol to be highly successful, even in the most variant and complex of lobes, the lateral frontal lobe (Auzias et al., 2016) , although we have not tested this package ourselves. The protocol solely identifies 24 primary and secondary sulci per hemisphere, rather than all sulci, to avoid addressing those with high variability. Moreover, because identification is limited to sulcal roots rather than the entire sulcal lengths, the MarsAtlas becomes more robust to the known and well-documented variations such as branching, interruptions, discontinuities, doubles etc., and theoretically avoids them. Package stability is further reinforced with the accompanying fixed coordinate system."}, {"section_title": "Accounting for variability in software design", "text": "Software packages have been compared to one another in numerous ways in the past, mostly with focus on either the output of one particular step (e.g., registration, brain extraction, etc.) or on the final package output. Klauschen et al., (2009) and Zhong et al. (2010) evaluated corresponding ROI morphometrics across different packages, while Cardinale et al., (2014) compared the morphometrics to their corresponding histological measurements. Other groups have investigated differences in ROI alignment as well as concordance across atlases by grouping together several regions of one atlas to match them to their equivalent in another (e.g., Bohland et al., 2009) . In this article, rather than focusing on package output, we have chosen to focus on the packages' design. In particular, we look at the parcellation protocols' underlying details and assumptions, providing a new understanding of why and how inter-package differences are observed. While Bohland et al. (2009) show that concordance cannot always be achieved considering regional overlap after mapping to a canonical space, here we show why, by characterizing the differences in the methodologies, atlases and border definitions adopted by each package. Cox et al. (2013) have done similar work in the past, although limited to the frontal lobe and subregions. With growing interest from the community in ageing and dementia, which have an effect on the entire cortical surface, we looked at differences for the whole brain and 5 regions of interest. We further contribute to identifying if and how landmark variability is addressed for each of these regions, thereby highlighting protocol challenges and potential pitfalls. We conclude by highlighting the importance of protocol transparency, accuracy and reproducibility and its implications, calling for open discussion on addressing this critical issue. The protocols we investigate are those of the three aforementioned packages (FreeSurfer, BrainSuite and BrainVISA), freely available to researchers and the general public, in addition to that of a novel fourth package, BrainGyrusMapping (Murphy et al., 2014) , developed by our funders for the MICCAI 2012 Grand Challenge. Although BrainGyrusMapping is a private package, its brain parcellation protocol is publicly available."}, {"section_title": "Materials and methods", "text": "For a comprehensive understanding of each of the 4 software packages' parcellation details and protocols, we studied the articles and user guides referenced by the packages, then identified the parcellation protocol(s) adopted by each package, as well as the manner in which these protocols are incorporated into the software. For FreeSurfer, the Desikan-Killiany (DK, Desikan et al., 2006 ) and the Destrieux (Fischl et al., 2004; Destrieux et al., 2010) reference atlases are used. The first is a cortical parcellation atlas; the second is both a cortical and subcortical atlas. The latter, however, segments the cortical surface into parcels based on local mean curvature and average convexity, in such a way that it separates what is visible on the outside of the pial surface from the remaining deeper parts of that surface. This at times generates parcels which consist of (1) both a gyrus and adjacent sulcus (e.g., cingulate gyrus and sulcus, inferior occipital gyrus and sulcus) or (2) a part of a gyrus, or a sub-gyrus. Both scenarios are undesirable as such parcels, and corresponding morphometrics, will be incomparable to their near 'equivalents' in other packages or in the literature without a significant amount of modification to the parcels. We therefore consider the Destrieux atlas beyond the scope of this article and solely focus on FreeSurfer's DK atlas. For BrainSuite, Pantazis et al. (2010) is the article of relevance, in which the sulcal curves atlas is detailed. It is an adaptation of the pre-existing LONI curve protocol and is based on 3 references- Damasio (2005) , Duvernoy (1999), and Ono et al. (1990) . For BrainVISA, the Ono et al. (1990) atlas is used to identify the sulcal segments, or \"sulcal roots\", which are present throughout the lifetime of a human, and are the least variant. The sulcal roots model is detailed in . A recently-developed gyral atlas (Auzias et al., 2016) is also available; it is based on the sulcal model as well as the orthogonal coordinate system of Auzias et al. (2013) . For BrainGyrusMapping, the brainCOLOR whole-brain protocol is used, as detailed by Neuromorphometrics. 6 We investigated additional articles or anatomical atlases when the original protocol articles reference them but omit the details. These additional references are listed in Table A .2. For each cortical parcellation protocol, we have identified and compared several factors that significantly influence parcellation procedures:\n\u2022 the details of the population(s) used to generate the atlases-e.g., ethnicity, age, sex, handedness, health, etc. and the number of parcellated atlases and reference populations adopted by the package. These details are essential for an end-user as they help Fig. 1 . Examples of sulcal patterns in a T1-weighted image of a middle-aged male subject (http://psydata.ovgu.de/studyforrest/structural/sub-01/) include: (a) a double sulcal pattern (arrows) and sulcal branching (stars) in the cingulate sulcus, (b) sulcal interruptions of the cingulate sulcus, (c) a side-to-side connection between the precentral and central sulci, and (d) an end-to-end connection between the cingulate and superior rostral sulci (Mikhael, 2017) .\nidentify whether or not the package developers have factored in their particular population of interest, and in turn, package suitability.\n\u2022 the nature of the protocol. First, we looked at the number of cortical structures, and number of gyri and sulci. Second, we identified whether the protocol was gyral-or sulcal-based. In gyral-based protocols, a gyrus runs from the deepest point of one sulcus to the deepest point of the next sulcus. A sulcus is represented by a line running along the deepest part of the surface, or the fundus. In sulcal-based protocols, a gyrus is limited to the visible part on the cortical surface, and a sulcus is made of the sulcal banks and fundus.\n\u2022 whether or not anatomical variability is considered and addressed by the software, with guidance from Ono et al. (1990) . To this day, this anatomical atlas is highly revered and regularly referenced by researchers and neuroscientists worldwide; it is also referenced by the 4 software packages we are examining and is often considered the ground truth. The authors define this variability as a consequence of variations in sulci and gyri. Sulcal variability is referred to in the form of double sulci (and double gyri), the absence of sulci, sulcal branching, sulcal interruptions, or sulcal connections. Gyral variability, i.e., single versus double, is also discussed. Here we identified to what degree this variability was addressed in each of the packages and the implications. We further attempted to answer the questions we pose at the end of the Introduction, although it became apparent that most of these questions will remain unanswered.\n\u2022 the clarity in ROI border definitions. ROIs that are defined relative to specific non-gyral landmarks (such as notches or sulci), have very clear borders, whereas those defined relative to other gyri have ambiguous borders. Clarity in border definitions was assessed generally (all ROIs), and specifically for 5 gyral ROIs-superior frontal gyrus (SFG), cingulate gyrus (CG), supramarginal gyrus (SmG), inferior temporal gyrus (ITG), and precentral gyrus (PrG). We did this by noting the anterior/rostral, posterior/caudal, medial, lateral, superior, and inferior borders for each ROI and each parcellation protocol, where available, thereby clarifying the level of accuracy with which they are defined. The ROIs were chosen on the basis that they (1) are situated in the various cortical lobes, (2) have been reported to be of significance for ageing (Thambisetty et al., 2010) and various types of dementia (Bakkour et al., 2008 , Boccardi et al., 2005 , Jones et al., 2005 , and (3) vary with gender (Thambisetty et al., 2010 , Sowell et al., 2006 ."}, {"section_title": "Results", "text": "All parcellation protocols serve a similar main purpose, that being the parcellation of the cortical surface into meaningful regions. How this is achieved, however, varies from one package to the next. This section summarizes the main differences that we identified between the 4 tools, with focus on population demographics, parcellation details, in terms of atlases, our understanding of how variability has been accounted for by each software, and finally, landmark and border clarity details for each protocol."}, {"section_title": "Population demographics", "text": "Population details were generally lacking, at least partially, from all 4 packages we evaluated (Table 1 ). In FreeSurfer it was the Clinical Dementia Rating (CDR- Morris (1993) ) of the participants constituting groups 3 and 4 (age 66 and over), despite the mention of CDR being obtained for participants over the age of 60 in the article. This rating is of interest to those active in dementia research for classification purposes. Handedness and demographic characteristics of all subjects are also missing. BrainSuite lacks most patient demographics. They also have limited their sulcal curve atlas to a very young population (mean age 26) all of whom are similar in age (22-28). Also, little is known about their single-subject parcellated atlas, aside from the gender and rough age estimate. We know that BrainVISA's sulcal model is based on a dataset of 62 mostly right-handed men ranging in age from 25 to 35, and scanned at 1.5T Perrot et al., 2011) . A list of subject sources is identified, however it is unclear which subjects belong to each. Therefore their health and demographic details, as well as exact ages are unknown. Furthermore, the first step in developing their gyral model, or MarsAtlas, involved creating an average sulcal roots template based on 138 subjects. Details on these subjects were obtained from (Auzias et al., 2015) , however their demographics are unknown, although could be extracted if provided with their original identification number linking them to the OASIS cross-sectional database (Marcus et al., 2007) to which they belong. BrainGyrusMapping is also missing population ethnicity, although it does provide education level and socioeconomic status for more than half of the subjects.\nAtlas sizes varied widely as well. Out of the 4 packages, BrainSuite used the least number of subjects (12) for their sulcal curves atlas and BrainVISA used the most (138) for their gyral parcellation atlas. Generally speaking, larger atlases could incorporate a larger variety of populations and different sorts of variability, generating greater confidence in a tool. Although for the case of multi-atlas labelling approaches, such as BrainGyrusMapping, this comes with the trade-off of longer runtime for the end user."}, {"section_title": "Whole brain parcellation", "text": "Parcellation details with regards to the methods, number of structures per region and what constitutes each structure vary greatly across the packages. Details of the parcellation protocols are summarized in Table 2 .\nOn the whole brain scale, it can be noted that the number of cortical parcels ranges from as little as 68 in FreeSurfer to 98 in BrainGyrusMapping. Methods vary greatly as well. FreeSurfer uses probabilistic labeling and spherical registration to parcellate volumes at the inflated GM/WM layer, then grows them to the outer GM/CSF layer. BrainSuite, in contrast, first identifies 26 sulcal landmarks based on a sulcal atlas, then uses these landmarks to register volumes to a parcellated atlas. Although these sulci are part of the parcellation protocol, they are not incorporated into the results, i.e., they are neither segmented nor measured. One is therefore limited to gyral analysis when working with this package. BrainVISA, on the other hand identifies both the sulcal segments (48 per brain) and gyral parcels (82 per brain) at the GM/WM layer, in several stages, before growing them to the outer GM/CSF layer via the watershed algorithm. In all four packages, the gyral parcels, or gyral volumes, are regions bound by the grey matter, or pial, layer on the exterior, and the WM layer on the interior (Fig. 2) .\nAll packages are gyral-based, with the exception of BrainVISA. Until the beginning of 2016, BrainVISA's parcellation was sulcal-based, but can now be followed by a gyral-based approach (version 4.5, Auzias et al., 2016) . BrainVISA's sulcal parcellation is based on a unique orthogonal coordinate system, or the HIP-HOP parametrization model (Auzias et al., 2013 (Auzias et al., , 2016 , relying on the theory of orthogonal distribution of the sulcal roots from early life, and their minimal variability throughout a lifespan and between subjects Toro and Burnod, 2003) . The model's 48 sulci are distributed along either the system's latitudes or longitudes, representing their Table 1 A summary of population demographics for each of the 4 software packages-BrainGyrusMapping, FreeSurfer, BrainSuite and BrainVISA. u/k: unknown. (Evans et al., 1994; Perrot et al., 2011) , made of 62 subjects' right and left hemispheres. Gyral parcellation could optionally follow as per the recently released MarsAtlas (Auzias et al., 2016) . The model is an average template of 138 subjects, with 41 gyral parcels defined per hemisphere. The parcels are bound by a combination of the previously identified sulcal roots and the latitudes and longitudes constituting the orthogonal coordinate system."}, {"section_title": "Accounting for variability", "text": "At the methods level, variability is considered by FreeSurfer in several ways including, first, a probabilistic labelling algorithm (Fischl et al., 2002 (Fischl et al., , 2004 ) and a spherical atlas, used to generate its labelled 40-subject atlas; second, an inflated cortical surface concept, allowing for missed details, such as the deep sulcal grooves, to be incorporated into the atlas; if desired, missed details on new subjects can be fixed manually by the end-user and the software can be re-run; third, with the broad age range and population mix for the atlas.\nBrainSuite developers also acknowledge the need to address anatomical variability and have done so with their automated tool, which follows a curvature-weighted lowest cost path algorithm to identify the sulcal landmarks of their 12-subject atlas . This fast algorithm is expected to provide great accuracy and reduced inter-rater variability. The atlas is limited to the same 26 sulci per subject, intentionally chosen on the basis that they are situated throughout the brain and are found in all subjects.\nBrainVISA addresses unusual anatomy by solely identifying the least variant of sulcal roots at the macroscopic scale-63 in the left hemisphere and 62 in the right hemisphere-in its first step. They are then grouped giving each subject 24 sulci per hemisphere. By excluding the more variant sulci from the process, it is expected to accurately identify these consistent 24, despite the variability that may arise elsewhere, and despite its source or location . The orthogonal coordinate system, which then follows to identify the various gyral parcels, also shows versatility by not relying on an average atlas representing a limited number of cohorts and disorders (Auzias et al., 2016) .\nLike in FreeSurfer, the selection of subjects constituting BrainGyrusMapping's (maximum of) 28-subject atlas contributes to variability consideration. Furthermore, the use of hierarchical atlas clustering identifies the most suitable of atlases for the registration (Mikhael, 2017). phase. This eliminates the atlases that are less appropriate, promoting better registration and, consequently, better parcellation results. Murphy and his colleagues (Murphy et al., 2014) have also noted that 'structures that are topologically inconsistent (not simply connected) with the ground truth have been observed in some cases'. This implies that anatomical variations in new datasets from the manually segmented landmarks of the 28-subject atlas may not be identifiable."}, {"section_title": "Clarity of landmarks and borders", "text": "Following the Ono and Duvernoy atlases, we first identified the equivalent of the 5 gyral ROIs (SFG, CG, SmG, ITG, PrG) in each of the parcellation protocols. Depending on the protocol, at times the gyri and sulci of interest were the sum of 1 or more parcellated regions/labels. BrainVISA's MarsAtlas does not aim to identify gyri, but instead identifies subgyral regions, or \"cortices\", formed of grouped Brodmann areas (BA) (Brodmann, 1909) with stable boundaries, as in Fig. 3 . We therefore listed the cortices with closest correlation to the 5 gyral regions for this particular protocol. Because of this system, the cortices will not accurately represent the gyri and therefore care will be needed when comparing them to their equivalents from other packages as it is not trivial. Some BrainVISA cortices, such as the dorsomedial motor (Mdm) and the ventral inferior parietal (IPCv) cortices, will include parts belonging to several gyri. The Mdm's lateral side corresponds to the superior region of the PrG and its medial side corresponds to the caudal region of the SFG. The IPCv includes the lower portion of the SmG as well as the caudal end of the superior temporal gyrus. ROI constituents for all packages are summarized in Table 3 .\nBrainGyrusMapping's protocol includes a \"Notes on variable regions\" section, which highlights the variablility that they've noted across popular packages and how they've chosen to address them following feedback from several experts. (Mikhael, 2017) ."}, {"section_title": "Table 3", "text": "The parcel(s) representing a gyral region in each of the software packages. In BrainVISA, these parcels are Brodmann areas (BAs). differences at the parcellation stage across packages, despite similarities in nomenclature, will contribute to differences in the final corresponding parcels and therefore volumetric measurements. This brings us to the atlas concordance problem that has been reported in the literature (Bohland et al., 2009) and consequently followed by an effort at matching corresponding ROIs across 9 atlases (http://qnl.bu. edu/obart)."}, {"section_title": "Gyral", "text": "The 5 tables clearly show a variety of boundary differences across software when defined, and the lack of such details for certain ROIs and software. Details regarding sulcal connections and interruptions were not available for any of the packages. Table 4 defines the SFG boundaries as considered by each of the packages. The gyrus's anterior or rostral border is clearly defined on both the lateral and medial surfaces by BrainGyrusMapping's protocol (as the frontomarginal sulcus and anterior limit of medial orbital sulcus, respectively), whereas one landmark (the superior frontal sulcus) is identified by FreeSurfer's. BrainSuite's protcol refers to BAs 8 and 9, yet BrainVISA defines it with a longitudinal line. The posterior or caudal border is the precentral sulcus in BrainGyrusMapping, yet the paracentral sulcus in both FreeSurfer and BrainSuite, and is identified on the inflated surface for the first. In BrainVISA it is a combination of a longitudinal line and central sulcus. The SFG's medial border differs across the 4 packages and is not mentioned by BrainSuite. The lateral border is more consistent in 3 packages (FreeSurfer, BrainSuite and BrainVISA) identifying it as the superior frontal sulcus, with an additional line of latitude by BrainVISA. BrainGyrusMapping on the other hand uses 2 other sulci for this border (lateral orbital sulcus and middle frontal sulcus). Only BrainSuite has an inferior border (cingulate sulcus) for this gyrus, perhaps because it lacks the medial one.\nIn Table 5 , we highlight the CG boundaries, where available. BrainGyrusMapping's protocol offers the option of dividing it into supra-and sub-callosal areas, with 4 boundaries for each. The cingulate sulcus defines the CG's anterior border in both BrainGyrusMapping and FreeSurfer; that border is limited to a longitudinal line (at 151\u00b0) in BrainVISA and contains a Brodmann field (24) in BrainSuite. The posterior border differs for all 4 packages. FreeSurfer, like the Ono atlas and our own BrainVISA classification, consider it as the isthmus (or ICC in BrainVISA), whereas the BrainGyrusMapping and BrainSuite packages include the isthmus as part of the CG. Additionally, the medial and inferior borders of the cingulate varies from 3 landmarks in BrainGyrusMapping (superior rostral, callosal and calcarine sulci) to 2 in FreeSurfer (medial aspect of the cortex and corpus callosum) and yet another 2 in BrainVISA (cingular pole and subcallosal sulcus at 180 latitude). No medial or inferior borders are defined by BrainSuite for this gyrus. Lateral and inferior borders are only defined by FreeSurfer and BrainVISA.\nOf the 5 ROIs we investigate, the SmG is the vaguest one in terms of bordering landmarks (Table 6 ). Little is known about the ROI in BrainSuite aside from the Brodmann area that it contains (area 40) and its inferior border (superior temporal gyrus). In FreeSurfer it is mainly bound by gyri rather than known anatomical landmarks. On the other hand, it is clearly bordered by 4 precise landmarks in BrainGyrusMapping (sulci) and BrainVISA (latitudinal and longitudinal lines).\nWith the ITG, the anterior and posterior borders, defined in Table 7 , differ across the 4 packages. The medial and lateral borders in FreeSurfer and BrainSuite are identical to one another, and to the inferior and superior borders defined by BrainGyrusMapping's protocol, respectively. The biggest differences are seen at the anterior border. Once again, its bordering landmarks are clear in BrainVISA.\nPrG borders are summarized in Table 8 . The 4 packages are all mostly in agreement with regards to the central sulcus (posteriorly) and the precentral sulcus (anteriorly). FreeSurfer uniquely considers its medial boundary as the superior, middle and inferior frontal gyri rather than the precentral sulcus, creating a vague landmark. The PrG is limited superiorly by the rostral extent of the central sulcus in FreeSurfer, as opposed to extending over into the medial surface and terminating at the cingulate sulcus like it does in BrainGyrusMapping. We have also assumed this medial extension in BrainVISA allowing it to terminate at the insula (0\u00b0latitude). The gyrus's medial, lateral, superior and inferior borders are undefined in BrainSuite. These factors will all contribute to differences in the length and width of this thin gyral strip."}, {"section_title": "Discussion", "text": "While cortical parcellation determines the regions into which a brain is divided, it also serves as a starting point for a broad range of analysis and classifications, in both health and disease. Our analysis of the most popular software protocols shows that cortical parcellation is mainly based on, although not limited to, sulcal landmarks identification via atlas registration, which in turn helps identify gyral volumes. Because of fundamental differences in protocols and in the ways for handling variability, variations in parcellation exist. These underlying differences, more than differences in parcels themselves which can be (Goodman et al., 2016) ), obtained with different software."}, {"section_title": "Atlas population details", "text": "Generally speaking, in atlas-based analysis, the closer the match between the template and the data, the greater the confidence one can have in the results. A significant contributor to the strength of an atlasbased parcellation package is the population used to make up its atlas(es). It serves as a good indicator of the package's limitations, its potential level of success in processing new datasets, and in turn, the amount of manual correction that may be necessary afterwards (Mandal et al., 2012) . It is therefore essential to have population details and demographics publicised along with the package. These demographics include the number of subjects, age-related details (mean and range), gender distribution, handedness, education, socioeconomic status, ethnicity, etc. All of these are known to have an influence on brain structure and consequently its parcellation. Therefore, conventional templates, such as the single-subject Talairach and Tournoux atlas (Toga and Thompson, 1999; Toga et al., 2006) , are being replaced by population-specific ones. Gousias et al. (2010) demonstrate the weaknesses of a 30-subject adult atlas in segmenting paediatric brains, when compared to a 33-subject paediatric atlas (including multiple scans). They further identify differences between preterm and term-born babies, leading them to develop a newborn brain atlas incorporating both groups (Gousias et al., 2012) . Other recently developed paediatric atlases include the M-CRIB atlas (Alexander et al., 2016) that is based on the DK atlas and could therefore prove useful in longitudinal studies where the same subjects are assessed at an older age. Similarly, healthy middle-aged atlases haven't been as successful in segmenting aged or demented populations due to the associated morphological changes (e.g., enlarged ventricles, atrophy, and widened sulcal spaces), and have led to their incorporation in atlases, such as the ICBM consortium (Mazziotta et al., 2001a (Mazziotta et al., , 2001b , to accommodate for the analysis of such populations. Zilles et al. (1997) , and more recently, shape asymmetry (e.g., Wachinger et al., 2016) . Significant ethnicity differences, e.g., between Chinese and Caucasian populations or between Korean and Caucasian populations, have also been found and consequently lead to the creation of ethnicity-specific templates (Tang et al., 2010; Lee et al., 2005 Lee et al., , 2016 .\nInformation about the reference population used to create an atlas is therefore paramount to any data analysis relying on it. It is clear from the protocols we have studied that at present many atlas population details remain unknown. Obtaining the missing details (e.g. handedness, demographic details, and health) would be beneficial, permitting users to make an informed decision about software to use. Examples of recent databases with a significant amount of associated population details include the ADNI (Weiner et al., 2010) , OASIS (Marcus et al., 2007; Marcus et al., 2010) , BRAINnet, 8 and BRAINS databases (Dickie et al., 2016) ."}, {"section_title": "Addressing variability", "text": "There is general consistency across FreeSurfer's ROI definitions scheme, which is important considering FreeSurfer is the most popular software. Where available, anterior/rostral, posterior/caudal, medial, lateral, superior and inferior limits are specified for all ROIs, mostly in Table 5 Rostral (R), anterior (A), caudal (C), posterior (P), medial (M), lateral (L), and superior (S) the form of a sulcus. Although, because of sulcal variability, there still is some vagueness to the exact borders as there is no mention of variability throughout the protocol. The authors did seek advice from numerous sources (Table A. 2), however, there is no indication as to which of the source(s) is followed for each of the landmarks, particularly in the event of contradicting advice between them. There are numerous instances in FreeSurfer's atlas where specific limiting landmarks are not provided, particularly between (1) the PrG and 3 frontal gyri, (2) the medial orbitofrontal cortex and SFG and CG, (3) the SmG and superior temporal gyrus (STG), (4) the CG and isthmus, and (5) the ITG and lateral occipital cortex (loc). Instead, one or more gyri are identified as borders for another gyrus, and vice versa. The gyri refer to Fig. 4a , is said to be bound medially by the superior, middle and inferior frontal gyri, and vice versa-the middle and inferior frontal gyri are said to be bound caudally by the PrG. Which unique feature will act as the boundary between these gyri remains unclear. Following our assessment of FreeSurfer v5.1 ROIs in late 2012, a revised version of the DK protocol, the Desikan-KillianyTourville (DKT) protocol (Klein and Tourville, 2012) , was introduced and later incorporated in FreeSurfer (v5.3), with the intention of increasing package accuracy and consistency. In the above example, the 4 gyri (with slight variation in terminology) now specifically lie on either side of a more accurate landmark, the precentral sulcus. The medial orbitofrontal cortex (moc) of the DK protocol is bound laterally by the medial bank of the SFG and CG, and similarly the SFG and CG are bound laterally by the medial division of the orbitofrontal gyrus (Fig. 4b) . The DKT protocol further specifies these gyral dividers by labelling the superior rostral and (antero-dorsal region of the) cingulate sulci as the SFG and CG's lateral borders, respectively. The moc's lateral border has been replaced by the superior rostral sulcus, or the cingulate sulcus when the two merge. Minor confusion in the DKT atlas, however, remains: with the cingulate gyrus being bound by the moc on one side, it is expected that the two share the superior rostral sulcus as a boundary, but that is not the case from what is described in the article although this is shown on Fig. 2 in Klein and Tourville (2012) where both (the antero-dorsal region of) the cingulate sulcus and the superior rostral sulcus appear to demarcate the CG's lateral border. This leads us to believe that this extra detail was perhaps accidentally missed from the text. Another example of vagueness in the DK protocol is when the rostral boundary of the SmG is defined as the caudal extent of the STG, and vice versa-the STG is bound medially by the SmG where present (Fig. 4a) . The DKT protocol replaces this uncertainty by specifying the SmG-STG boundary as the posterior horizontal ramus of the lateral sulcus posteriorly and the lateral sulcus anteriorly. Similarly, no clear bounding landmark is defined between the CG and isthmus (I) in the DK protocol either (Fig. 4b) . The caudal border of the CG is named as the isthmus, and the rostral border of the isthmus is defined as the posterior division of the cingulate cortex, i.e., the CG. The DKT protocol includes the isthmus as part of the CG, thereby revising and simplifying the posterior border which it specifies as the subparietal sulcus. Uncertainty is once again perceived in the DK protocol when the ITG is said to be bound caudally by the loc, and this cortex's lateral boundary is the ITG (Fig. 4c) . This too has been resolved in the newer DKT protocol by referring to the anterior occipital sulcus as the landmark separating the two (ITG and loc). Another example of the lack of a clearly identifiable landmark in FreeSurfer's DK protocol is when the CG's lateral border is defined as the SFG, and yet the SFG's medial border is referred to as the 'medial aspect of frontal lobe' (Fig. 4b) . In the DKT protocol, the cingulate sulcus specifically separates the two gyri. Similarly, the CG's (particularly the rostral anterior and caudal anterior divisions) medial border in the DK protocol is defined as the 'medial aspect of the cortex', which is likely to be the corpus callosum, but again this not specified. The DKT protocol, in addition to mentioning the corpus callosum, clearly specifies the callosal sulcus. These might seem like little details but if there is a lack of consistency across subjects or a bias given some features, this could lead to population differences unintentionally emerging or getting masked. Our main point is that when no standard exists, this fact should simply be stated, along with details on how it is addressed by the package. While BrainSuite's protocol very clearly defines both sulcal start and endpoints, as well as variation handling (Table A. 3), fewer details are available for the gyral borders. There is no explicit gyral parcellation protocol or reference; however, because Professor Damasio manually delineated the package's atlas (single-subject BCI-DNI/ _brain atlas), we refer to her 2005 atlas (Damasio, 2005) as the source to define the gyral borders, assuming that this reference is used in the parcellation process. The precise details are evidently few and incomplete in the BrainSuite columns of Tables 4-8. Scarce information makes analysis challenging when wanting to compare the output of this package to that of other packages or to manually drawn data. It appears that the greater focus of this package was on the overall distribution of Brodmann's cytoarchitectonic areas across the brain atlas, relative to the various gyral regions.\nIn a similar spirit, BrainVisa relies on the MarsAtlas that is based on cortices from the Brodmann atlas rather than gyri, implying that they occasionally span across gyri. BrainVISA-generated regions and any corresponding statistics will therefore not always be directly comparable to those of the other packages and will only serve as an approximation when grouped, as in Table 3 , to represent specific gyri. Owing to the obvious limitations in terms of region selection with the orthogonal grid, our attempt at grouping leaves us with volumes that include more than the intended gyrus.\nBrainGyrusMapping's protocol clearly identifies gyral borders, however, the only cortical variability mentioned is the double cingulate sulcus, leading to questions around implications this could have on the atypical cortical surfaces that do not closely resemble any of the ones included in their 28-subject atlas. Fig. 4. Lateral (a), medial (b) , and inferior (c) cortical surfaces of a 30-35 year-old right-handed male subject, as per FreeSurfer's Desikan-Killiany parcellation protocol. Border precision lacked for the ROIs we investigated, particularly at (1) the PrG's medial border, (2) the SFG and CG's anterior border, (3) the SmG-STG border, (4) the CG-isthmus border, and (5) the ITG-loc border. The raw volume was downloaded from http://psydata.ovgu.de/studyforrest/structural/sub-01/. I: isthmus, moc: medial orbitofrontal cortex, loc: lateral occipital cortex (Mikhael, 2017) ."}, {"section_title": "Regions of interest", "text": "At first glance, differences between parcellation protocols may not be obvious to the end-user. This particularly occurs when two parcellation protocols refer to an ROI using the same nomenclature. Initially, one may assume that the two will be identical, but as we indicate in Tables 4-8, the details reveal otherwise-the gyral borders across the packages are different. As previously mentioned, the CG of BrainGyrusMapping and BrainSuite includes the isthmus (Fig. 5) whereas that of FreeSurfer (Deskian-Killiany protocol) and BrainVISA (Fig. 3, following Ono's classification) does not. Another example of differences despite the same nomenclature is with the PrG boundaries on the cortical surface's medial side. In BrainGyrusMapping they are identified as the imaginary extensions of the precentral and central sulci on that side (plane prcs-med and plane cs-med), yet in FreeSurfer it is the central sulcus. The 2 corresponding volumes with therefore differ, and in turn affect the SFG and postcentral gyrus (and corresponding morphometrics) that they border. In such situations, additional work will be necessary if a comparison is to be drawn between them. Despite FreeSurfer's latest efforts to reduce ambiguity, the DKT protocol remains less popular than the DK protocol, with only 7 hits in the last 2 years for the first, compared to 83 hits for the latter (detailed search in Software diversity).\nTo accurately interpret the software outputs, it is important for the end user to know the tissue types comprising an ROI, and the details regarding the derivation of their corresponding statistics. Some ROI statistics are offered on the pial layer, but others are on the middle or inner cortical layers of the cortex, rendering them comparable only approximately, by projection of the layers onto each other. As such, measured differences will no longer be due to a combination of actual difference and protocol difference only, but also a measurement error due to the projection is introduced. Sulcal lines, for example, are drawn on the mid-cortical surface in BrainSuite, yet on the inner (WM) cortical surface in BrainVisa. BrainSuite developers prefer the midcortical layer over the outer pial (GM/CSF) layer because of the low contrast in the volume at the latter, making their automated method more accurate. Consequent sulcal statistics (e.g., length, depth and width) will therefore vary between the two packages."}, {"section_title": "Conclusion", "text": "A cortical parcellation software includes a complex set of tools that serve to identify the various structures of any given brain and provide corresponding measurements. This generally involves some preprocessing, tissue classification, cortical and subcortical segmentation, and morphometrics. To identify a suitable package for processing a given dataset, these individual steps and their corresponding details are taken into consideration. The focus of this article is solely limited to the cortical parcellation phase.\nThe purpose of this article was by no means to identify the superiority of any particular package over another, but to solely raise awareness of, or highlight, protocol significance and differences via commonly used packages and 5 sample ROIs. Traditional population atlases, such as those of the 4 packages we examined, are generally based on few subjects and a limited number of parcels when compared to recently published ones. For instance, the digital Brain Atlas developed at the Allen Institute for Brain Science (Ding et al., 2016) is based on a single subject, but uses microscopic details, from histology and immunohistochemistry, along with high resolution (7T) multi-modal images. Their analysis revealed 862 structures (sulci, gyri, and BAs) per hemisphere and 117 white matter tracts and cranial nerves. Similarly, but based on a larger population, the Human Connectome Project \"Multimodal parcellation of the human cerebral cortex\" showed variations in the location of at least one cortical area (55b) and identified 360 different regions (Glasser et al., 2016) with high accuracy rates (96.6.%). Such results suggest that current anatomical parcellation tools used for morphometric and connectomic analysis might underestimate grossly the number of parcels needed to understand human brain structure/function relationships.\nThe implications of the parcellation protocol are immense. Having tools that delineate, at the subject level, and in a consistent and well defined manner, anatomical (or anatomo-functional) regions, is key for understanding brain variations that underpin health and disease, given the level of anatomical variability of folds and branches (e.g. Essen, 2005) , shape asymmetries (Wachinger et al., 2016) and in the location of patterns of functional activity (e.g., Gordon et al., 2016) . Although all 4 packages we investigate are gyral-based, we show how protocols can be very different, even when referring to the same ROI. It is therefore essential for the end users to move towards clear, reproducible protocols (for instance choosing DKT over DK for cortical parcellation in Freesurfer, or the MarsAtlas in BrainVISA), with consistent ROI nomenclature and explicit border definitions. Additionally, with atlas-based packages, we highlight the importance of working with an atlas of close resemblance to that of the population under investigation and one that has ideally factored in sufficient variability to assess this cohort."}, {"section_title": "Conflict of interest", "text": "The first author is partially funded by Toshiba Medical Visualization Systems, Edinburgh (TMVSE) -who also developed the BrainGyrusMapping software. The second author is employed by TMVSE. Table A. 2 The 4 software packages we identified and further studied with regards to their cortical parcellation protocols and details. Table A .1 Types of variability in the cortical surface and their incidence rates in the various sulci, and the various hemispheres (hems), as reported by Ono et al. (1990) ."}, {"section_title": "Acknowledgements", "text": ""}, {"section_title": "Types of Cortical Variability", "text": "Occurrence Details (Incidence Rates) "}]
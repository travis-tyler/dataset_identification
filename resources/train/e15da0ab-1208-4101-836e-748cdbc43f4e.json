[{"section_title": "Abstract", "text": "Abstract. Brain functional connectivity (FC) extracted from restingstate fMRI (RS-fMRI) has become a popular approach for disease diagnosis, where discriminating subjects with mild cognitive impairment (MCI) from normal controls (NC) is still one of the most challenging problems. Dynamic functional connectivity (dFC), consisting of timevarying spatiotemporal dynamics, may characterize \"chronnectome\" diagnostic information for improving MCI classification. However, most of the current dFC studies are based on detecting discrete major \"brain status\" via spatial clustering, which ignores rich spatiotemporal dynamics contained in such chronnectome. We propose Deep Chronnectome Learning for exhaustively mining the comprehensive information, especially the hidden higher-level features, i.e., the dFC time series that may add critical diagnostic power for MCI classification. To this end, we devise a new Fully-connected bidirectional Long Short-Term Memory (LSTM) network (Full-BiLSTM) to effectively learn the periodic brain status changes using both past and future information for each brief time segment and then fuse them to form the final output. We have applied our method to a rigorously built large-scale multi-site database (i.e., with 164 data from NCs and 330 from MCIs, which can be further augmented by 25 folds). Our method outperforms other state-of-the-art approaches with an accuracy of 73.6% under solid cross-validations. We also made extensive comparisons among multiple variants of LSTM models. The results suggest high feasibility of our method with promising value also for other brain disorder diagnoses."}, {"section_title": "Introduction", "text": "Alzheimer's Disease (AD) is an irreversible neurodegenerative disease leading to progressive cognitive and memory deficits. Early diagnosis of its preclinical stage, mild cognitive impairment (MCI), is of critical value as timely treatment could be the most effective during this stage. Resting-state functional MRI (RSfMRI) provides an opportunity to assess brain function non-invasively and has been successfully exploited to identify MCI [1] .To capture the time-varying information brain networks, dynamic functional connectivity (dFC) was proposed to characterize the time-resolved connectome, i.e., chronnectome, mostly using sliding-window correlation approach [2, 4] . While promising, many current studies have not deeply exploited the rich spatiotemporal information of the chronnectome and utilized it in classification. For example, many studies focused on group comparison by detecting a set of discrete major brain status via clustering time-resolved FC matrices and further calculating their occurrence and dwelling time [4] . Inspired by the new finding that the brain dynamics are hierarchically organized in time(i.e., certain networks are more likely to occur preceding and/or following others [5] ), we propose to learn diagnostic features in an end-to-end deep learning framework to better classify MCI.\nRecurrent neural networks (RNNs) is a powerful neural sequence learning model for time series analysis. LSTMs are improved RNNs that can effectively solve the \"gradient exploding/vanishing\" problem by controlling information flow with several gates [6] . It has recently been demonstrated to be able to handle large-scale learning in speech recognition and language translation tasks [7] . However, there is still a significant gap between brain chronnectome modeling and common time series analysis. Directly applying LSTM to dFC-based MCI diagnosis is non-trivial:1) Brain is extraordinary complex whose dynamics could be substantially different from natural language interpretation.2) The background noise is usually more intense in the brain dFC signals, compared to audio/video signals, making it very difficult to capture.3) The brain may continuously use contextual information for guiding higher-level cognitive functions rather than produce an output at the end of the time series with a strict direction. Therefore, a general LSTM could not be suitable for brain chronnectome-based classification. To solve this problem, we propose a new deep learning framework that changes the traditional LSTM in two aspects. First, we create Full-LSTM that connects the outputs of all cells to a \"fusion\" layer to capture a common timeinvariant status-switching pattern, based on which the MCI can be diagnosed. Second, to excavate the contextual information hidden in the dFC, we further use a bidirectional LSTM (BiLSTM) to access long-range context in both directions [8] . We hereby come out with an end-to-end chronnectome-based classification model, namely Full-BiLSTM. The performance of our proposed method has been compared with state-of-the-art methods on ADNI-2 database. As the first \"Deep Chronnectome Learning\" study, we comprehensively compared the performance of three variants of LSTMs and reported the effect of different hyperparameters. The results support our hypothesis and significantly improved MCI diagnosis. First, the dFC of each subject is calculated using a sliding windowbased method. Second, the dFC vector is used as the input of the BiLSTM module. Finally, the outputs of each repeating BiLSTM cell are concatenated into a dense layer for further prediction."}, {"section_title": "Computing dFC via a Sliding Window Method", "text": "For each subject, the whole-brain time-varying connectivity matrices are computed based on M (M = 116) ROIs from the automated anatomical labeling (AAL) template using a sliding window approach [3, 4] . As shown in Fig. 1 , the averaged BOLD time-series S i in ROI i are first computed. Then, the window {W t } are generated and applied to S = {S i }, where T is the total number of sliding windows. Next, for each W t , an FC matrix R t of size M * M that includes FC strengths between all pairs of S it are calculated. Thus, for each subject, a set of R t (t = 1, 2, . . . , T ) are obtained, representing the subjects' whole-brain dFC. Due to the symmetry of each R t , all FC strengths in R t among M ROIs corresponding to a window t are converted to a vector x t with M (M \u2212 1)/2 elements. Therefore, all the dFC time series from the k th subject can be represented by a matrix\nwith a size of T * {M (M \u2212 1)/2} and used as input to Full-BiLSTM classification model."}, {"section_title": "Fully-Connected Bidirectional LSTM (Full-BiLSTM)", "text": "Long Short-Term Memory (LSTM). LSTMs incorporates recurrently connected units, each of which receives an input h t\u22121 from its previous unit as well as the current input x t for the current time point t. Each unit has its memory updating the previous memory c t\u22121 with the current input modulation. The network takes three inputs: x t ,h t\u22121 ,and c t\u22121 , and has two outputs: h t (the output of the current cell state) and c t (the current cell state). Three gates separately controls input, forget, output. The unit can be expressed as:\nInput Gate :\nSpecifically, the input gate i t controls how much influence the inputs x t and h t\u22121 exerts to the current memory cell (Eq.1). The forget gate f t controls how much influence the previous memory cell c t\u22121 exerts to the current memory cell c t (Eq.2). Output gate controls how much influence the current cell c t has on the hidden state cell h t (Eq.3). The memory cell unit c t is a summation of two components: the previous memory cell unit c t\u22121 , which is modulated by f t and g t (Eq.4), and a weighted combination of the current input and the previous hidden state, modulated by the input gate i t (Eq.5). Likewise, cell state is filtered with the output gate o(t) for a hidden state updating (Eq.6), which is the final output from an LSTM cell. With the inputting dFC time series, W x\u00b7 matrices (containing weights applied to the current input) and W h\u00b7 matrices (representing weights applied to the previous hidden state) can be learned, b \u00b7 vectors are biases for each layer, \u03c3 is sigmoid, \u03c6 is tanh function, and\u2299 denotes element-wise multiplication.\nBidirectional LSTM (BiLSTM). BiLSTM is an effective solution that gets access to both preceding and succeeding information (i.e., context) by involving two separate hidden layers with opposite information flow directions [9] . For a brief description, we denote a process of an LSTM cell as H. BiLSTM first computes the forward hidden \u2212 \u2192 h and the backward hidden sequence \u2190 \u2212 h separately(Eq.7-8), and then combines \u2212 \u2192 h t and \u2190 \u2212 h t to generate the final output y t (Eq.9). The W x\u00b7 and W h\u00b7 matrices in (Eq.7-8) are the same as those in(Eq.1-4). The W\u2212 \u2192 h y (representing weights applied to the forward hidden state) and W\u2190 \u2212 h y (representing weights applied to the backward hidden state) are learned with the inputting dFC time series. b \u00b7 vectors are biases for each layer.\nBackward LST M :\nCombined Output :\nFull-BiLSTM. The traditional BiLSTM classification model usually uses the final state y T for classification [8] . However, this is insufficient for chronnectomebased diagnosis, because brain may continuously use contextual information to facilitate higher-level cognition and guide status transition, rather than producing a single output at the end of the scanning period. Therefore, the outputs of every repeating cell could be of equally important use and should be concatenated into a dense layer Y = [y 1 , . . . y t , . . ., y T ] (see \"Concatenation Layer\" in Fig. 1). ). With this layer, we may abstract a common and time-invariant dynamic transition pattern from all the BiLSTM cells which may represent a constant \"trait\" information of each subject, instead of the continuously varying brief brain status. While the latter could be of great use in previous statusbased studies such as those used Hidden Markov Chain for status transition probability modeling in group-level comparison studies [5] , it will inevitably lose the precious temporal information which could capture more subtle individual differences for the more challenging disease diagnosis studies. In our framework for MCI diagnosis, the dense layer Y is followed with softmax layer to get the final classification result."}, {"section_title": "Experiments and Results", "text": ""}, {"section_title": "Data Preprocessing", "text": "In this study, we use the publicly available Alzheimer's Disease Neuroimaging Initiative dataset (ADNI) to test our method. As shown in Table 1 , 143 age-and gender-matched subjects (48 NCs with 164 RS-fMRI scans, and 95 MCIs with 330 RS-fMRI scans) were selected from ADNI-2 database. The goal of ADNI-2 study is to validate the use of various biomarkers including RS-MRI to find the best way to diagnose AD at pre-dementia stage. Each RS-fMRI scan was acquired using 3.0T Philips scanners at different medical centers. All the data were carefully reviewed by the quality control team in Mayo Clinic. ADNI is to date the largest, multi-site, rigorously controlled early AD diagnosis data. The RS-fMRI data were preprocessed following the standard procedure [1] ."}, {"section_title": "Dynamic Functional Connectivity Matrix", "text": "In this experiment, the window length was 90s (30 volumes) as suggested by previous dFC studies [4] . The window slides in a step of 2 volumes (6s), resulting in 54 segments of BOLD signals. For each subject and each scan, 54 FC matrices were obtained, reflecting the chronnectome. The upper half of the matrix containing 6670 unique dFC links were used and then reshaped into X k with the size of 54 * 6670. Training deep learning models requires a large number of samples. Fortunately, only part of the dFC time series might be sufficient for discriminating MCIs from NCs because the FC dynamics could happen in a very brief period [5] . This allows us to conduct data augmentation to increase the sample size. Specifically, for each X k , a continuous submatrix of length 30 were cropped as a new sample. By using a sliding window strategy with a stride of 1, the original X k can be augmented for 54 \u2212 30 + 1 = 25 times (augmented by a factor of 25). The label of the augmented data from the same subject was kept the same. Of note, all augmented sequences belonging to the same subject were used solely in the training, or validation, or testing phase. In the testing phase, the predicted labels for all the augmented data from the same subject was derived with majority voting to determine the final label for this subject."}, {"section_title": "Data Augmentation", "text": ""}, {"section_title": "Full-BLSTM Parameters and Training Strategy", "text": "The Full-BiLSTM model was trained and evaluated using Keras. Data was split into 80% for training and 20% for testing (5-fold cross-validation). 10% of samples from training data were further selected for validation to monitor the training procedure. Training was stopped when the validation loss stopped decreasing for 20 epochs or when the maximum epochs had been executed. The testing data was applied to the trained model to evaluate the performance. The model was trained for minimizing the weighted cross-entropy loss function using stochastic gradient descent (SGD) optimizer. The learning rate (lr) was started from 0.001 and decayed over each update as follow: lr t = lr t\u22121 /(1 + decay rate * epochs). The decay rate was 10 \u22126 , and the maximum epochs was 200. The batch size was 32. The weights and biases were initialized randomly. To improve the generalization performance of the model and overcome the overfitting problem, we used a dropout method (dropout = 0.5) and l 1 norm regularization (l1 = 0.0005)."}, {"section_title": "Method Comparison", "text": "As dFC is novel in this field, the disease diagnosis works using dFC are quite limited. We compared our approach against various classifiers commonly used. The majority of the dFC studies focus on brain statuses detected by clustering, or the temporal variability of dFC series. Therefore, in the competing methods, we also use these two types of the dFC features for MCI classification. In summary, we compared our method with the classification models using: 1) static FC (sFC); 2) dFC-based brain statuses [4] ; and 3) dFC variability [1] , as detailed below.\nsFC. The traditional FC method used in most of the FC studies are based on Pearson's correlation of full-length BOLD signals. After building sFC matrix, an SVM classifier is trained based on the sFC strengths.\nStatus-based. Group-level chronnectome status is identified by using k-means clustering with all of the dFC matrices in the training data. The occurrence frequency of each status is computed to as features. Then, an SVM classifier is constructed based on the frequency features of all status.\nVariability-based. Based on the dFC matrices, the quadratic mean value is computed for each dFC. A total of 6670 features are generated for each subject representing the fluctuation of the signals. The features are further reduced using two-sample t-test. An SVM classifier is constructed based on the dFC variability features.\nThe performance comparison results are summarized in Table 2 and Fig. 2 showing the ROI curves of all methods. Because of sample imbalance, the area under the ROC curve (AUC) was used as the main metric for comparing the performance of all the methods. Our method achieved 79.8% in AUC and significantly outperformed the traditional sFC and dFC methods. The dFC variability method achieved the lowest result, which could be caused by the severe noise in dFC time series. In contrast, our method could learn the intrinsic brain status transition, thus is more robust to such noise. To validate the advantage of Full-BiLSTM, we tested three other LSTMbased architectures. The BiLSTM Last model uses the output of the last BiL-STM cell for classification, as used in the traditional sequence processing studies. The Full-LSTM uses the same architecture as our method, but with unidirectional LSTM cells. To investigate whether a deeper BiLSTM layer could increase the performance, the third model is built using stacked Full-BiLSTM (two layers). All these three models use the same parameters as our Full-BiLSTM method. As shown in Fig. 2 )., our model still outperformed all these three LSTMbased competing models. Specifically, we observed that 1)BiLSTM outperforms uni-directional LSTM; 2)Full-BiLSTM performs better than BiLSTM Last; 3)A deeper model does not improve the final performance. In addition, we also compared the performance with and without data augmentation, and found that the accuracy was decreased by 2% without data augmentation. Furthermore, the number of hidden nodes in LSTM may directly affect the learning capacity of an LSTM network. Therefore, we compared the performance of Full-BiLSTM models with a varying number of hidden units, i.e., 16, 32, 64. As shown in Fig. 3 , the Full-BiLSTM model with 16 hidden nodes has decreased performance and increased performance variability, compared to the Full-BiLSTM model with 32 hidden nodes. It is likely that 16 hidden units are too limited to store the sequential information of the dFC process. The model with 64 hidden nodes also has suboptimal performance, which could be attributed to overfitting.\nThe results together indicate that data augmentation and the choice of network structure are crucial for training an effective dFC-based classification model. Most notably, this is the first attempt to use a deep learning framework for individualized disease diagnosis based on dFC. Our results indicate that a sequence model can take advantage of more series information from dFC than the conventional methods. It is also worth noting that our model can be applied to other brain disorder diagnoses."}]
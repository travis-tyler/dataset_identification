[{"section_title": "Introduction", "text": "News on the scarcity of medicines to treat COVID-19 have appeared in many countries around the world over the past months. Due to the increasing demand during the peaks of infections worldwide and other problems associated to logistics, doctors and pharmacists were struggling to treat their patients. We confirmed this situation after a series of interviews with doctors, pharmacists and other people from regional Health Services. In the absence of sufficient medication for such a large amount of patients, practitioners started applying disused arXiv:2012.01953v1 [cs.CL] 3 Dec 2020 drugs that were available in hospital pharmacies and modifying the usual doses of those available. However, identifying which drugs can be used as replacements for others to treat this little-known disease and its associated symptoms is a difficult challenge. New experiments and results are continually being published, and people in charge of clinical protocols cannot keep up to date with all of them [5] . This situation calls for solutions that help health care providers and researchers easily extract such knowledge from the enormous scientific corpus that is being created.\nSeveral initiatives have emerged to bring together scientific publications in this domain. For instance, the COVID-19 Data Portal maintained by the EU, or those published by Humandata focused on COVID-19 cases around the world. Similarly, other research groups and universities have also published valuable datasets, such as the Open COVID-19 Data Working Group 4 , the DisGeNET COVID-19 dataset 5 or the data gathered by John Hopkins University 6 , among others.\nThe Allen Institute for Artificial Intelligence created the COVID-19 Open Research Dataset (CORD-19) [22] . It is a continuously growing corpus with all publicly available COVID-19 and coronavirus-related research (e.g. SARS, MERS, etc.) in the last fifty years. This dataset can be used as a source of information to extract knowledge related to the disease. At the time of this study, it is composed of 23 ,428 open access articles from PubMed Central, 35,240 research articles from a corpus maintained by the World Health Organization (WHO), and 1,945 bioRxiv and medRxiv pre-prints.\nGiven that volume, a combined used of natural language processing with word embeddings techniques and knowledge extraction technologies can provide doctors and medical researchers with tools that make their work easier by structuring the information contained within the papers. Our goal is to automatically extract, organize and publish the drug-oriented knowledge from the medical literature needed to answer common questions posed by domain experts such as What are the effects of using chloroquine and hydroxychloroquine to treat COVID-19 patients? Have drugs that combine immunosuppressive and antimalarial activity with macrolide antibiotics been used? In which experiments have mefloquine and azithromycin been used and related to which diseases?\nWe processed more than 60k medical publications to discover relations amongst drugs and diseases. The tools created from our workflow help to quickly create domain-specific search engines and knowledge graphs (KG) (Fig. 1 ) over any corpus of scientific documents. Such techniques can be reused for other similar crisis in the future, and in any other situation where these tools could be valuable. All the work presented in this paper is available in a GitHub repository 7"}, {"section_title": "Related Work", "text": "Due to the fast evolution of the SARS-COV-2, worldwide scientists have been working as fast as possible to provide tools that help health professionals treat patients during this pandemic. Most of the ongoing work has been shared inside research communities (e.g. W3C Semantic Web and W3C Healthcare and Life Sciences), in hackathons (e.g. the European Commission hosted EUvsVirus 8 , VenceAlVirus 9 in the region of Madrid), and in preliminary reports in blogs and archival services. Multiple datasets 10 have been provided for finding new insights about the novel coronavirus.\nSemantic Web technologies have been traditionally used to publish many data sources in the biomedical domain such as Bio2RDF that provides a network of linked data for the biomedical domain, DisGeNET RDF that relates diseases and genes, or SNOMED Clinical Terms that provides a clinical healthcare terminology. Some of this earlier work has been used by language technologies to add semantic annotations to scientific literature. The CORD19-Named Entities Knowledge identified and disambiguated named entities in CORD-19 using DBpedia Spotlight and the NCBO BioPortal annotator. Similarly, a Linked Data version of the CORD-19 data is provided by the CORD-19-on-FHIR project introducing semantic annotations on conditions, medications, and procedures.\nSome knowledge graphs have also been created such as the Knowledge4COVID-19 11 that integrates knowledge from scientific literature and databases, and uses predictive models to derive interactions among drugs used in the treatment of COVID-19. Others are mainly focused on a collective generation of knowledge such as KG-COVID-19 Hub 12 or the Covid Graph project 13 . Both seek to build collaboratively a KG hub for COVID-19 so that developers can ingest new sources into this hub. And there are also initiatives focused on particular domains such as the SIB COVID-19 Integrated Knowledgebase that is specialized on genetic information, and the COVID-19 by STKO Lab that combines recorded cases and suspensions of commercial airline routes.\nHowever, none of these approaches provide sufficient information on how the knowledge is generated. When two drugs are related through an interaction in the knowledge graph, the information used to induce that kind of relation is missing and would be very relevant for its potential users. We believe that conclusions are as important as the data that led to them during the learning process. Hence, in this paper we describe a process to create a knowledge graph that, together with the diseases and drugs identified in the CORD-19 corpus, links to the texts (i.e paragraphs, sentences or even full articles) that support the inferred knowledge."}, {"section_title": "Drug and Disease Annotations", "text": "Searching for similar drugs and exploring major diseases covered by different publications are key activities when browsing medical papers. This manual knowledge-intensive task becomes less tedious and even leads to unexpected relevant findings when applying unsupervised algorithms to help researchers.\nIn this work we have addressed the problem of generating drug-and diseasebased annotations for the documents within a large collection of research articles. We have created vectorial representations of each of them using state-of-the-art techniques based on word embeddings and probabilistic topic models. Then, diseases and drugs have been related to each other and suggested drugs that may be considered as replacements for others.\nMore than 60k scientific papers were analyzed from the CORD-19 dataset. Around 5M sentences and 2M paragraphs were annotated with the drugs and diseases mentioned in them. A total of 6,400 diseases and 2,400 drugs were characterized to enrich the searches on the corpus and the knowledge graph."}, {"section_title": "Taxonomies used for annotation", "text": "Textual searches on a collection like CORD-19 bring accuracy issues since the terminology associated with drugs and diseases varies between countries. A search based on an active substance should lead to the drugs that contain it. Such drugs can be traded under different brand names among countries, hence appearing with different names in different papers. For example, the active substance Enalapril/Hydrochlorothiazide is distributed in Spain under the trade names Co-Renitec, Crinoretic or Dabond Plus, while its trade name is Renidur in Portugal, and Corodil in Denmark. Thus, we need to unify drugs and diseases with codes that abstract them from their particular names or textual representations. We have used the trade names published by the Spanish Agency of Medicines and Health Products (AEMPS) and considered the Anatomical Therapeutic Chemical (ATC) classification system to annotate drugs. The ATC is supported by the World Health Organization (WHO) and widely used in hospital pharmacies to identify drug components. It groups active substances according to the organ or system on which they act and their therapeutic, pharmacological, and chemical properties. Drugs are classified into groups at five different levels. The first one corresponds to main groups, the second one to pharmacological or therapeutic subgroups, the third and the fourth one are chemical-pharmacologicaltherapeutic subgroups and the last one is the chemical substance.\nDiseases have been annotated with the Medical Subject Headings (MeSH) vocabulary, which is used for indexing, cataloging, and searching biomedical information by the MEDLINE/PubMed article database, the NLM\u00b4s books catalog, and ClinicalTrials.gov among others. This vocabulary is organized in a hierarchical, numbered tree structure that enables browsing from broader to narrower topics.\nOur goal is not to annotate according to a single classification system, but to integrate different classification codes suggested by our users to allow crosssearching from their terminologies."}, {"section_title": "Annotation techniques", "text": "Common entities identified in medical literature are diseases, drugs and chemical names among others [20, 10, 19, 6] . These named entities can also be used to discover relations between them. We created a pipeline to prepare the textual content from the CORD-19 dataset [22] and index it together with some additional information in a document-oriented database. It is based on the librAIry framework [2] , which provides a high-performance infrastructure for text mining tasks. We focused on the following data for this task:\nid: unique identifier for each research article.\nname: publication title.\nabstract: brief summary made by the author.\ntext: full textual content of the article. url: online resource available from Allen AI repository.\nThe Named Entity Recognition (NER) task was performed combining different state-of-the-art methods such as scispaCy [14] and CliNER [4] . After they were tested to identify disorders, substances, trials and treatments from texts, we realized the methods did not unify the identification of drugs and diseases as described in the ATC or MeSH classifications. Sometimes they are identified as different drugs or diseases, since they are referred by different names, when in fact they correspond to the same element. To adjust this behavior we have developed Bio-NLP 14 , a NER service built on top of scispaCy that uses the MeSH vocabulary and the ATC codes as gazetteers of terms respectively to identify named entities."}, {"section_title": "Drug and Disease Representational Models", "text": "In order to establish relations among drugs or diseases, so as to improve searches on the corpus, we have created representational models capable of abstracting the entities from their textual forms and relating them to each other."}, {"section_title": "Identifying Related Texts", "text": "Some text mining algorithms represent documents in a common feature space that abstracts away from the specific sequence of words used in each of them. That is, they treat documents as bags-of-words. With appropriate representations, they ease the analysis of relationships between documents, even when written using different vocabularies.\n-Representational Model: We have used topic models, which are widely used to uncover the latent semantic structure from text corpora. In particular, Probabilistic Topic Models (PTM) represent documents as a mixture of topics, where topics are probability distributions over words. This eases the exploitation of large document collections, since documents are mapped into a low-dimensional latent space (i.e they are described by a small number of topics). It also abstracts the representation of the documents from the words themselves. Topics emerge as density distributions on the vocabulary to define the dimensions of the vectors that represent the documents. We used librAIry [2] to create and fine-tune a PTM that describes the annotated drugs as probability distributions on the vocabulary of the corpus. Each topic matches an active substance (see Table 1 ), avoiding distinctions between different drug names by country. The model is created and distributed as a Rest-API to facilitate its reuse. -Similarity Metric: Due to low storage cost and fast retrieval speed, hashing is a popular solution for the calculation of approximate nearest neighbors in the probability simplex space created from topic models. We opted for a density-based hierarchical hashing method [3] to compare the texts contained in CORD-19. This approach has proven to obtain high-precision results and can accommodate additional query restrictions. -Space Partitioning: Since documents are compared from sets of topics distributed in levels according to their relevance, the representational space can be organized in k-d trees. The most discriminating topics and levels define the branches of the tree and each text is organized among them according to its topic distributions. We created a web-based document browser 15 to navigate through the corpus using the active substances and content-based relations ( Figure 2 )."}, {"section_title": "Finding Related Drugs", "text": "Drugs were described by the diseases with which they are mentioned in texts (e.g sentence, paragraph, or full-text). Paragraphs showed an appropriate balance between generality and particularity to describe drugs, since their content is more strongly related than the full-text, and less incomplete than the sentences.\n-Representational Model: A drugs-diseases matrix was created with the times a disease appears in the same paragraph than a drug. Then, we used Term Frequency-Inverse Document Frequency (TFIDF) to transform drugs into numeric vectors. Two drugs described by TFIDF will be similar if they share rare, but informative, diseases. -Similarity Metric: Cosine similarity was adopted as the measure of interest as it is well-known and frequently-used in vector space models [18] . we created a dendrogram based on simple linkage from their vectorial representations. As a result we obtained a hierarchical aggregation of drugs that suggests an optimal number of groups according to the Silhouette coefficient. Several settings were tested and finally 120 clusters offered the best performance (Fig. 3) . We developed a Rest-API, Bio-API 16 , that makes use of the Annoy 17 method to index drugs in a kd-tree. It allows queries like bio-api/replacements?keywords=chloroquine to retrieve related drugs."}, {"section_title": "Finding Related Diseases", "text": "In order to measure the similarity amongst diseases, a three-step procedure was followed: 1) Creation of disease-focused word embedding models, 2) Generation of a terminology representing the whole corpus, used to align the compared diseases, 3) Disease similarity calculation from the identified key terms. -Terminology Generation: The aim of this step was to discover common terminology amongst diseases. We extracted the most frequent terms from a representative sample of 100.000 paragraphs from CORD-19. Given the complex nature of the source texts (full of technical expressions, numbers, figures, symbols) this task presented a challenge when tested with two terminology extraction methods: Rake [17] and TBXTools [21] . While the former did not solve many of the above mentioned hindrances and some extracted terms were linguistically incorrect, the latter gave good results that needed only some post-processing work ( Table 2 ). -Representational Model: Out of the existing state-of-the-art word embedding models, Word2Vec [13] was selected to generate a representational model for each disease. To ensure comparability between models, the same initialization values were used from the pre-trained BioWordVec model [23] . Using a proper initialization not only enables direct comparability between disease models, but eases the convergence of the model. -Similarity Metric: Diseases were represented as vectorial models, where each word featured in the training corpus found a corresponding embedding. However, not all words in the resulting vocabulary were equally explanatory of the disease, and thus comparisons between models should not be established using the totality of the embedded words. We retrieved the 25 most frequent terms in CORD-19 with the aim of discovering common terms amongst diseases ( Table 2 ). They were used as reference points to compare models that visually represent each disease, considering each term as a node, and the distance between each pair of nodes as edges. Similarity between diseases is obtained by averaging individual distances between the representations of the same term on each disease model. Word Mover's Distance [12] was used to measure the distance between terms, as it captures the underlying semantics between the resulting word representations. -Space Partitioning: Disease models were initialized using the same values, meaning that the initial embedding of each term was the same across every disease. During training, these embeddings evolve, or move throughout the vectorial space to fit the context constraints from the disease-specific training corpus. Therefore, while the initial representations were equal, the final representations differ, as they also embedded specific information about the disease. However, the resulting representations can still be compared. Pairwise comparison between diseases can be established by measuring the Euclidean distance between the embeddings of same terms on each model. Small distances between term representations mean that they occur in a similar context, thus their final embeddings remain close. Figure 4 illustrates pairwise comparison between three diseases. According to the obtained results, COVID-19 is closer to Malaria than to Conjunctivitis, as the cumulative distance of all pairwise term distances is lesser in that case. This functionality was also added to our Bio-API service."}, {"section_title": "Drugs4Covid Knowledge Graph", "text": "All the work described in previous sections allowed us to create the knowledge to enable the search and navigation over the corpus. To facilitate its (re)use, we "}, {"section_title": "The Drugs4Covid vocabulary", "text": "The vocabulary defined to support the D4C-KG was developed following the LOT methodology [16] , relying heavily in the communication with users (i.e. developers generating annotations and KG developers) and domain experts (i.e. biologists and pharmacists) throughout the ontology development process. The main goals of the vocabulary were to represent and relate some parts of the papers analyzed with biomedical concepts, as obtained with the application of language technologies. The process started with a meeting where the potential annotations, based on drugs and diseases, were analyzed. A first set of requirements was extracted: 1) A paper contains paragraphs and sentences; 2) A paragraph and a sentence can mention chemical substances and disorders; 3) A paper mentions a drug; 4) A drug has active substances, which are a type of chemical substances; 5) A drug treats a disorder; 6) A disease has symptoms. The vocabulary requirements evolved throughout the development of the project.\nThe vocabulary conceptualization was carried out following the guidelines for ontology diagrams presented in [9] and splitting the team into the two main domains involved in the data, namely \"publications\" and \"biomedical\" domains. Figure 5 depicts the vocabulary conceptualization, whose main concepts are: -Paper: A document of the corpus, subject of annotations. It can contain paragraphs (one of a series of subsections each usually devoted to one idea) and sentences (a sequence of words capable of standing alone to make an assertion, ask a question, or give a command). These concepts can mention disorders and/or chemical substances.\n-Disorder: A disruption to regular bodily structure and function. A disease is often known to be a medical disorder that is associated with specific symptoms, while a symptom refers to a physical or mental feature that is regarded as indicating a condition of disease. -Chemical substance: A substance produced by or used in a chemical process. Active substances are chemical substances that are the main ingredients of drugs used to treat or prevent a disorder. Each active substance matches an ATC code as described in the Annotation Section. The vocabulary reuses some Dublin-Core Metadata Terms 18 for bibliographic resources such as abstract, license, and source. Since we are pursuing a progressively more complex construction of the knowledge graph, we decided to initially create a basic model that allows easy alignment with existing ontologies in the biomedical domain later on. However, some modeling decisions were already taken in this direction, by aligning the active substance class attributes to the ATC annotations from bioontology 19 .\nWe carried out a twofold evaluation: (1) quality and correctness of the ontology using OOPS! [15] , and (2) a data-directed evaluation where we checked that the data in the indexed corpus can be transformed, annotated and queried with the vocabulary. Finally, the HTML documentation of the vocabulary was generated with Widoco [8] and published 20 using OnToology [1] ."}, {"section_title": "Knowledge Graph Construction", "text": "The D4C-KG contains RDF annotations extracted from the CORD-19 dataset that are described by the D4C vocabulary. The relations between the source data (annotations) and the developed ontology were declared using the RML mapping language [7] . We used YARRRML 21 , a human-friendly RML serialization in YAML format, to define 44 subject and 150 predicateObject mappings. The rules created by this technique were easy to define and not time-consuming.\nThe building process was automated and modular, based on standard W3C technologies in order to ensure the maintainability of the KG construction process. The following steps were performed:\n-Data Preparation: Annotations from the CORD-19 corpus were exported into CSV files, cleaned and normalized exploiting CSVW annotations. -Mapping Definition: RML mapping rules between the data and the ontology were defined, as well as the rules to link other KGs. -RDF Generation: The cleaned data and mapping rules were processed with SDM-RDFizer [11] to generate the corresponding RDF dataset. -Publication: The resulting RDF, along with the ATC data available in BioPortal, were published through a Virtuoso SPARQL endpoint 22 . In addition, federated queries across different datasets can be performed to external knowledge graphs to enhance the completeness of the provided knowledge."}, {"section_title": "Use Cases", "text": "As a result of our work, users can quickly locate the paragraphs in the articles where immunosuppressive and antimalarial activity with macrolide antibiotics are discussed ; or have a list of related diseases to mefloquine and azithromycin when used to treat the COVID-19. All this information is available for end users through our search engine, and for anybody who wants to reuse the results through the restful Bio-API and the open knowledge graph described above. The main use scenarios are:\n-Drug-oriented Search: Our search engine 23 provides the paragraphs of the articles where the drug is mentioned, either by its trade name, its generic name or its ATC classification; and a list of related drugs and related diseases inferred from the representational models created for each of them (Fig.6 ). -Keyword-oriented Search: Our RESTful API 24 browses scientific literature through the relations inferred among drugs 25 and diseases 26 . The drugs used in conjunction with lopinavir (e.g. /bio-api/drugs?keywords= lopinavir), or the diseases treated with chloroquine (e.g. /bio-api/diseases? keywords=chloroquine) can be easily explored. ?paragraph onto:mentions ?activeSubstance2 . 10 ?activeSubstance1 skos:notation \"P01BA02\"^^xsd:string . 11 ?activeSubstance2 skos:notation ?notation2 ."}, {"section_title": "12", "text": "?paragraph onto:mentions ?disease ."}, {"section_title": "13", "text": "?disease a onto:Disease . 14 ?disease onto:MESHCode 'C000657245' ."}, {"section_title": "15", "text": "?disease dc:title ?titleDisease ."}, {"section_title": "16", "text": "FILTER (STRSTARTS(?notation2,\"J01FA\")) 17 }"}, {"section_title": "Lessons Learned and Future Work", "text": "This paper presents our work to create a knowledge graph and a search engine to facilitate the exploration of the CORD-19 corpus through the relations discovered between drugs, diseases and texts. It required an effective collaboration between language technology and semantic web researchers, and with domain experts (doctors and pharmacists) who helped us to resolve doubts and guide functional decisions. The obtained results, software, models and resources are publicly available for anyone to use.\nAfter the initial release of our services and the creation of a knowledge graph together with its associated vocabulary, we have received numerous requests to continue expanding the types of annotations and the information offered by the knowledge graph. Our results are also being used by third parties, e.g. to obtain \"therapeutic targets\". The relations sought in this case arise from the proteins described in articles, with the added difficulty that they are usually mentioned by acronyms. Their feedback is promising, and they encourage us to continue incorporating also the management of genes and biological pathways.\nThis would lead to an increment of the possibilities offered to users when browsing the corpus. Moreover, the exploitation of these annotations in the knowledge graph leads us to increase the reuse of existing biomedical ontologies and terminologies.\nWe are also working on a Citizen Science initiative with students of Pharmacy and Medicine to validate our annotations and help understand the type of relations that may exist between drugs and diseases. The consensus acquired from the contributions made by these citizen scientists will serve to measure the quality of the results and improve the system as a whole. As in many other Citizen Science projects, a score-based system will be created using parameters such as user participation, quality of contributions (based on gold standards and community contributions), etc. And finally, a helpdesk will allow us receiving feedback from users to continue improving the results that we provide.\nOther more general functionalities that have been already requested by end users are related to usability and to the creation of alerts when a drug, protein or combinations of them appear in the corpus."}]
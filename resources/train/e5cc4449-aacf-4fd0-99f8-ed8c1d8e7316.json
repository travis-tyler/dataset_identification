[{"section_title": "Abstract", "text": "The COVID-19 pandemic continues to have a devastating effect on the health and well-being of the global population. A critical step in the fight against COVID-19 is effective screening of infected patients, with one of the key screening approaches being radiological imaging using chest radiography. It was found in early studies that patients present abnormalities in chest radiography images that are characteristic of those infected with COVID-19. Motivated by this, a number of artificial intelligence (AI) systems based on deep learning have been proposed and results have been shown to be quite promising in terms of accuracy in detecting patients infected with COVID-19 using chest radiography images. However, to the best of the authors' knowledge, these developed AI systems have been closed source and unavailable to the research community for deeper understanding and extension, and unavailable for public access and use. Therefore, in this study we introduce COVID-Net, a deep convolutional neural network design tailored for the detection of COVID-19 cases from chest radiography images that is open source and available to the general public. We also describe the chest radiography dataset leveraged to train COVID-Net, which we will refer to as COVIDx and is comprised of 16,756 chest radiography images across 13,645 patient cases from two open access data repositories. Furthermore, we investigate how COVID-Net makes predictions using an explainability method in an attempt to gain deeper insights into critical factors associated with COVID cases, which can aid clinicians in improved screening. By no means a productionready solution, the hope is that the open access COVID-Net, along with the description on constructing the open source COVIDx dataset, will be leveraged and build upon by both researchers and citizen data scientists alike to accelerate the development of highly accurate yet practical deep learning solutions for detecting COVID-19 cases and accelerate treatment of those who need it the most. arXiv:2003.09871v2 [eess.IV] "}, {"section_title": "Introduction", "text": "The COVID-19 pandemic continues to have a devastating effect on the health and well-being of the global population, caused by the infection of individuals by the severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2). A critical step in the fight against COVID-19 is effective screening of infected patients, such that those infected can receive immediate treatment and care, as well as be isolated to mitigate the spread of the virus. The main screening method used for detecting COVID-19 cases is polymerase chain reaction (PCR) [12] testing, which can detect SARS-CoV-2 RNA from respiratory specimens (collected through a variety of means such as nasopharyngeal or oropharyngeal swabs). While PCR testing is the gold standard as it is highly sensitive, it is a very time-consuming, laborious, and complicated manual process that is in short supply.\nAn alternative screening method that has also been utilized for COVID-19 screening has been radiography examination, where chest radiography imaging (e.g., X-ray or computed tomography (CT) imaging) is conducted and analyzed by radiologists to look for visual indicators associated with SARS-CoV-2 viral infection. It was found in early studies that patients present abnormalities in chest radiography images that are characteristic of those infected with COVID-19 [10, 6] , with some suggesting that radiography examination could be used as a primary tool for COVID-19 screening in epidemic areas [2] . While radiography examination can be conducted faster and have greater availability given the prevalence of chest radiology imaging systems in modern healthcare systems, making them a good complement to PCR testing (in some cases, even exhibiting higher sensitivity [4] ), one of the biggest bottlenecks faced is the need for expert radiologists to interpret the radiography images, since the visual indicators can be subtle. As such, computer-aided diagnostic systems that can aid radiologists to more rapidly and accurately interpret radiography images to detect COVID-19 cases is highly desired. Motivated by the need for faster interpretation of radiography images, a number of artificial intelligence (AI) systems based on deep learning [7] have been proposed and results have shown to be quite promising in terms of accuracy in detecting patients infected with COVID-19 via radiography imaging [5, 13, 9] . However, to the best of the authors' knowledge, these developed AI systems have been closed source and unavailable to the research community to build upon for deeper understanding and extension of these systems. Furthermore, such systems are unavail-able for public access and use. As a result, there has been recent efforts to push for open access and open source AI solutions for radiography-driven COVID-19 case detection, with an exemplary effort being the open source COVID Chest X-ray Dataset, an effort by Cohen et al. [3] to build a dataset consisting of COVID-19 cases (as well as SARS and MERS cases) with annotated chest X-ray and CT images, so that the research community and citizen data scientists can leverage the dataset to explore and build AI systems for COVID-19 detection.\nMotivated by the urgent need to develop solutions to aid in the fight against the COvID-19 pandemic and inspired by the open source and open access efforts by the research community, this study introduces COVID-Net, a deep convolutional neural network design tailored for the detection of COVID-19 cases from chest radiography images that is open source and available to the general public. We also describe the dataset leveraged to train COVID-Net, which we will refer to as COVIDx and is comprised of 16,756 chest radiography images across 13,645 patient cases, created as a combination and modification of two open access data repositories containing chest radiography images (i.e., [3] and [15] ). Furthermore, we investigate how COVID-Net makes predictions using an explainability method in an attempt to gain deeper insights into critical factors associated with COVID cases, which can aid clinicians in improved screening.\nThe paper is organized as follows. First, Section 2 discusses the strategy leveraged to create the proposed COVID-Net, the architecture design of COVID-Net, as well as the strategy used to create the COVIDx dataset. Section 3 presents and discusses the results of experiments conducted to evaluate the efficacy of the proposed COVID-Net in both a quantitative and qualitative manner. Finally, conclusions are drawn and future directions discussed in Section 4."}, {"section_title": "Methods", "text": "Here, we will discuss the design methodology behind the proposed COVID-Net, the resulting network architecture, the process of creating the COVIDx dataset, as well as the implementation details in creating COVID-Net."}, {"section_title": "COVID-Net Architecture Design", "text": "In this study, a human-machine collaborative design strategy is leveraged to create COVID-Net, where humandriven principled network design prototyping is combined with machine-driven design exploration to produce a network architecture tailored for the detection of COVID-19 cases from chest radiography images. Each of the two design stages are described below.\nPrincipled network design prototyping.\nThe first stage of the human-machine collaborative design strategy Figure 2 . COVID-Net Architecture. High architectural diversity and selective long-range connectivity can be observed as it is tailored for COVID-19 case detection from chest radiography images. The heavy use of a projection-expansion-projection design pattern in the COVID-Net architecture can also be observed, which strikes a strong balance between computational efficiency and representational capacity. employed to create the proposed COVID-Net is a principled network design prototyping stage, where an initial network design prototype is constructed based on human-driven design principles and best practices. More specifically in this study, we leveraged residual architecture design principles [14] as they have been shown time and again to enable reliable neural network architectures that are easier to train to high performance, and enables deeper architectures to be built successfully.\nIn this study, we construct the initial network design prototype to make one of the following three predictions: a) no infection (normal), b) non-COVID19 infection (e.g., viral, bacterial, etc.), and c) COVID-19 viral infection (see Fig. 1 for example chest radiography images of non-COVID19 and COVID-19 infections). The rationale for choosing these three possible predictions is that it can aid clinicians to better decide not only who should be prioritized for PCR testing for COVID-19 case confirmation, but also which treatment strategy to employ depending on the cause of infection, since COVID-19 and non-COVID19 infections require different treatment plans.\nMachine-driven Design Exploration. The second stage of the human-machine collaborative design strategy employed to create the proposed COVID-Net is a machine-driven design exploration stage, where the initial network design prototype, data, along with human specific design requirements, act as a guide to a design exploration strategy to learn and identify the optimal macroarchitecture and microarchitecture designs with which to construct the final tailor-made deep neural network architecture. In this study, we leverage generative synthesis [11] as the machine-driven design exploration strategy for generating the final COVID-Net network architecture that satisfies the following human specified design requirements: (i) test accuracy \u2265 80%, and (ii) network computational complexity \u2264 2.5 billion multiply-accumulate (MAC) operations.\nNetwork Architecture.\nThe proposed COVID-Net network architecture is shown in Fig. 2 , and available publicly for open access at https: //github.com/lindawangg/COVID-Net.\nIt can be observed that the COVID-Net network architecture makes heavy use of a lightweight residual projectionexpansion-projection-extension (PEPX) design pattern, which consists of:\n\u2022 First-stage Projection: 1\u00d71 convolutions for projecting input features to a lower dimension,\n\u2022 Expansion: 1\u00d71 convolutions for expanding features to a higher dimension that is different than that of the input features,\n\u2022 Depth-wise Representation: efficient 3\u00d73 depthwise convolutions for learning spatial characteristics to minimize computational complexity while preserving representational capacity,\n\u2022 Second-stage Projection: 1\u00d71 convolutions for projecting features back to a lower dimension, and\n\u2022 Extension: 1\u00d71 convolutions that finally extend channel dimensionality to a higher dimension to produce the final features.\nFurthermore, it can be observed that there is considerable architectural diversity and selective long-range connectivity in the COVID-Net architecture, which reflects the fact that the machine-driven design exploration has tailored the network architecture at a very fine level of granularity for COVID-19 case detection from chest radiography images to strike a strong balance between representational capacity and computational complexity."}, {"section_title": "COVIDx Dataset Generation", "text": "The dataset used to train and evaluate the proposed COVID-Net, which we will refer to as COVIDx, is comprised of a total of 16,756 chest radiography images across 13,645 patient cases. To generate the COVIDx dataset, we combined and modified two different publicly available datasets: 1) COVID-19 image data collection [3] , and 2) RSNA Pneumonia Detection Challenge dataset [15] . The choice of these two datasets from which to create COVIDx is guided by the fact that both are open source and fully accessible to the research community and the general public, and as datasets grow we will continue to grow COVIDx accordingly. The distribution of images and patient cases amongst the different infection types shown in Fig. 3 and 4 , respectively.\nThe most noticeable trend is the limited amount of COVID-19 infection cases and associated radiography images, which reflects the scarcity of COVID-19 case data available in the public domain but also highlights the need to obtain more COVID-19 data as more case data becomes available to improve the dataset. More specifically, the COVIDx dataset contains only 76 radiography images from 53 COVID-19 patient cases. For chest radiography images with no pneumonia and non-COVID19 pneumonia, there are significantly more patient cases and corresponding radiography images. More specifically, there are a total of 8066 patient cases who have no pneumonia (i.e., normal) and 5526 patient cases who have non-COVID19 pneumonia. Dataset generation scripts for constructing the COVIDx dataset is available publicly for open access at https://github.com/lindawangg/COVID-Net. "}, {"section_title": "Implementation Details", "text": "The proposed COVID-Net was pretrained on the Ima-geNet [1] dataset and then trained on the COVIDx dataset using the Adam optimizer using a learning rate policy where the learning rate decreases when learning stagnates for a period of time (i.e., 'patience'). The following hyperparameters were used for training: learning rate=2e-5, number of epochs=10, batch size=8, factor=0.7, patience=5. Furthermore, data augmentation was leveraged with the following augmentation types: translation, rotation, horizontal flip, and intensity shift. Finally, we introduce a batch re-balancing strategy to promote better distribution of each infection type at a batch level. The proposed COVID-Net was built and evaluated using the Keras deep learning library with a TensorFlow backend."}, {"section_title": "Experimental Results", "text": "To evaluate the efficacy of the proposed COVID-Net, we perform both quantitative and qualitative analysis to get a better understanding of its detection performance and decision-making behaviour."}, {"section_title": "Quantitative Analysis.", "text": "To investigate the proposed COVID-Net in a quantitative manner, we computed the test accuracy, as well as sensitivity and positive predictive value (PPV) for each infection type, on the aforementioned COVIDx dataset. The test accuracy, along with the architectural complexity (in terms of number of parameters) and computational complexity (in terms of number of multiply-accumulation (MAC) operations) are shown in Table 1 . It can be observed that COVID-Net strikes a good balance between accuracy and computational complexity by achieving 92.4% test accuracy while requiring just 2.26 billion MAC operations to perform case prediction. These findings also highlight the efficacy of leveraging a human-machine collaborative design strategy for creating highly-customized deep neural network architectures in an accelerated manner, tailored around task, data, and operational requirements. This is especially important for scenarios such as disease detection, where new cases and new data are collected continuously and the ability to rapidly generate new deep neural network architectures tailored to the ever-evolving knowledge base over time is highly desired. Next, we take a deeper exploration into the current limitations of the proposed COVID-Net by studying the sensitivity and PPV for each infection type, which is shown in Table 2 and Table 3 , respectively, and the confusion matrix in Fig. 5 . A number of interesting observations can be made about how COVID-Net performs under the different scenarios. First, it can be observed that COVID-Net can achieve good sensitivity for COVID-19 cases (80% sensitivity), which is important since we want to limit the number of missed COVID-19 cases as much as possible. While promising, it should be noted that the number of COVID-19 patient cases available is quite limited compared to the other infection types in COVIDx and as such a better view of effectiveness will improve as more COVID-19 patient cases becomes available. Second, it can be observed that COVID-Net achieves high PPV for COVID-19 cases (88.9% PPV), which indicates very few false positive COVID-19 detections (for example, as seen in Fig. 5, 1 patient with non-COVID19 infection was misidentified as having COVID-19 viral infections). This high PPV is important given that too many false positives would increase the burden for the healthcare system due to the need for additional PCR testing and additional care.\nThird, it can be observed that the PPV for normal and non-COVID19 infection cases is noticeably higher than for COVID-19 infection. Fourth, it can also be observed that sensitivity is noticeably higher for normal and non-COVID19 infection cases than COVID-19 infection cases. The third and fourth observations can be primarily attributed to the significant larger number of images for both normal and non-COVID19 infection cases. Therefore, based on these results, it can be seen that while COVID-Net performs well as a whole in detecting COVID-19 cases from chest radiography images, there are several areas of improvement that can benefit from collecting additional data, as well as improving the underlying training methodology to generalize better across such scenarios.\nQualitative Analysis. We further investigate and explore how COVID-Net makes predictions by leveraging GSInquire [8] , an explainability method that has been shown to provide good insights into how deep neural networks come to their decisions. The critical factors identified in some example chest radiography images of COVID-19 cases are shown in Fig. 6 . It can be observed that the proposed COVID-Net identifies localized areas within the lungs in the chest radiography images as being critical factors in determining whether a radiography image is of a patient with a SARS-CoV-2 viral infection, as shown in red in Fig. 6 . The ability to interpret and gain insights into how the proposed COVID-Net detects COVID-19 infections is important for a number of reasons:\n\u2022 Transparency. By understanding the critical factors being leveraged in COVID-19 case detection, the predictions made by the proposed COVID-Net become more transparent and trustworthy for clinicians Figure 6 . Example chest radiography images of COVID-19 cases from 2 different patients and their associated critical factors (highlighted in red) as identified by GSInquire [8] .\nto leverage during their screening process to aid them in making faster yet accurate assessments.\n\u2022 New insight discovery. The critical factors leveraged by the proposed COVID-Net could potentially help clinicians discover new insights into the key visual indicators associated with SARS-CoV-2 viral infection, which they can then leverage to improve screening accuracy.\n\u2022 Performance validation. By understanding the critical factors being leveraged in COVID-19 case detection, one can validate that the proposed COVID-Net is not relying on improper information to make decisions (e.g., erroneous visual indicators outside the body, embedded markup symbols, imaging artifacts, etc.)"}, {"section_title": "Conclusion", "text": "In this study, we introduced COVID-Net, a deep convolutional neural network design for the detection of COVID-19 cases from chest radiography images that is open source and available to the general public. We also described COVIDx, a chest radiography dataset leveraged to train COVID-Net that is comprised of 16,756 chest radiography across 13,645 patient cases from two open access data repositories. Moreover, we investigated how COVID-Net makes predictions using an explainability method in an attempt to gain deeper insights into critical factors associated with COVID cases, which can aid clinicians in im-proved screening as well as improve trust and transparency when leveraging COVID-Net for accelerated computeraided screening.\nBy no means a production-ready solution, the hope is that the promising results achieved by COVID-Net on the COVIDx test dataset, along with the fact that it is available in open source format alongside the description on constructing the open source dataset, will lead it to be leveraged and build upon by both researchers and citizen data scientists alike to accelerate the development of highly accurate yet practical deep learning solutions for detecting COVID-19 cases from chest radiography images and accelerate treatment of those who need it the most. Future directions include continuing to improve sensitivity and PPV to COVID-19 infections as new data is collected, as well as extend the proposed COVID-Net to risk stratification for survival analysis, predicting risk status of patients, and predicting hospitalization duration which would be useful for triaging and individualized care planning."}]
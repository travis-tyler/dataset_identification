[{"section_title": "Introduction", "text": "At the end of 2019, a new coronavirus SARS-CoV-2 (Severe Acute Respiratory Syndrome Coronavirus 2) appeared in Wuhan, which then triggered a global pandemic. SARS-CoV-2-induced pneumonia has been termed COVID-19 (Coronavirus Disease 2019). The main symptoms of COVID-19 are high fever, 5 dry cough, shortness of breath, muscle pain, diarrhea, myalgia, nasal obstruction and runny nose [1] . As of 15 July 2020, a total of 13,690,108 confirmed cases with COVID-19 pneumonia have been reported globally, including 586,265 deaths (4.28 %).\nThe current diagnostic method for COVID-19 is real time reverse transcription 10 -polymerase chain reaction (RT-PCR) [2] . The main limitation of this method is the insufficient amount and quality of the clinical material from which the nucleic acids are isolated [3] . This can result in false negative results.\nLung CT and radiograph scans are gradually recognised as an alternative for COVID-19 diagnosis. The lungs of people infected with COVID-19 are 15 characterised by consolidation, ground-glass opacification, bilateral involvement, peripheral and diffuse distribution. Lung CT scans can be used to diagnose COVID-19 in patients in acute and convalescent periods of disease [1] . Only patients with severe or permanent lung damage will show changes in CT after recovery, which makes it impossible to determine the percentage of the population 20 that has undergone the disease based on lung scans [4] . The favorable aspects of CT scanners are their availability in many hospitals and the short amount of time required to obtain the results estimated to be around 15 minutes. The use of CT for initial diagnostics might significantly increase testing capabilities.\nOn the other hand, the imaging costs are relatively high, which may limit the 25 use of CT for COVID-19 diagnostics. Moreover, the use of CT for COVID-19 diagnostics requires thorough cleaning of the equipment between examinations 2 J o u r n a l P r e -p r o o f and a large surface of contact increases the risk of infection, compared to the RT-PCR method performed in sterile conditions [5] . Despite the large number of publications indicating high sensitivity and specificity of CT, the radiologists' The advantages of radiograph scans for COVID-19 diagnostics include greater availability of radiographs, lower radiation doses to which the patient is subjected and a short scanning time. 35 Recently, both CT and radiograph scans have been shown to enable training models which achieve promising results in the COVID-19 classification task [7, 8] .\nConsidering the advantages and disadvantages of both methods we decided to create a database containing both CT and radiograph images.\nCurrently, the most popular datasets for COVID-19 classification are COVID- 40 CT [9] and COVID-19 Image Data Collection [10] . These datasets contain images of CT and radiograph chest scans of individuals affected with COVID-19 as well as of patients not affected with COVID-19."}, {"section_title": "COVID-19 Image Data Collection contains images of both CT and radiograph", "text": "scans. The number of CT scans is insufficient for training deep models. The 45 number of radiograph images is higher but there is not enough negative samples.\nMoreover, this dataset does not define a data split.\nCOVID-CT concentrates on CT scans and defines a data split. However, it provides only a rough categorisation of samples into COVID-19-positive and negative cases, where negative cases can be images of healthy individuals or 50 patients with a different disease.\nTraining neural networks on these datasets requires including samples from additional data sources such as common bacterial pneumonia [11] or lung nodule analysis [12, 13] .\nApostolopoulos and Mpesiana [14] used a MobileNet v2 [15] pre-trained on 55 ImageNet [16] for fine-tuning on two datasets which were created using samples from COVID-19 Image Data Collection [10] , COVID-19 X-ray collection available on kaggle [17] , and a dataset containing radiograph scans of common bacterial 3 J o u r n a l P r e -p r o o f pneumonia [11] . They achieved sensitivity of 98% and specificity of 96% on the dataset which included both common bacterial pneumonia and viral pneumonia 60 cases as distractors for the COVID-19 class, and sensitivity of 99% and specificity of 97% on the dataset which included only common bacterial pneumonia cases.\nZhao et al. [9] pre-trained a DenseNet [18] on ChestX-ray14 [19] and fine-tuned it on COVID-CT. They achieve AUC of 0.82. He et al. [7] used models pre-trained on ImageNet, which were further pre-65 trained using contrastive self-learning [20] first on LUNA dataset [12, 13] and then on COVID-CT, followed by fine-tuning on COVID-CT. This methodology allowed them to achieve AUC of 0.94 with DenseNet-169.\nThe huge variety of scenarios in which the models are evaluated prevents any comparison between them. As a result, it is difficult to tell which design choices 70 contribute to improved performance of some models and to use this knowledge to build incrementally more reliable solutions.\nIn this work, we propose COVID-19 CT&Radiograph Image Data Stock, which combines data from multiple sources into a single dataset. The advantages of COVID-19 CT&Radiograph Image Data Stock include:"}, {"section_title": "75", "text": "\u2022 a large number of both CT and radiograph scans of COVID-19 class,\n\u2022 a large number of negative samples in both modi,\n\u2022 the exact class of the negative samples is known,\n\u2022 the source of each sample is known,\n\u2022 a data split is defined."}, {"section_title": "80", "text": "Using COVID-19 CT&Radiograph Image Data Stock does not require employing any additional data sources. We hope that this dataset will allow for better understanding of the influence of individual choices on the final performance of COVID-19 classification models. 4 . we show that using a precise class information helps to improve the model's 100 ability to distinguish between COVID-19-positive and negative samples.\nThe rest of this work is organised as follows: in section 2 we shortly characterise COVID-CT and COVID-19 Image Data Collection, and describe in detail how was COVID-19 CT&Radiograph Image Data Stock created. In section 3, we describe the evaluation of models trained on each of the datasets and in section 105 4, we present the results. In section 5, we conclude the paper."}, {"section_title": "COVID-19 CT&Radiograph Image Data Stock", "text": "In this section, we briefly characterize COVID-CT [9] and COVID-19 Image Data Collection [10] shortly discussing their strong and weak points and describe in detail how the proposed COVID-19 CT&Radiograph Image Data Stock was and are in png format. The task is to classify images as belonging to COVID-19-positive or negative class. This dataset has a defined split which allows for Radiograph Image Data Stock is to create a public pool of CT and radiograph images of lungs to increase the efficiency of distinguishing COVID-19 from other types of pneumonia and from healthy lungs. We hope this can help to prepare a \"ground\" for distinguishing between newly discovered and already known viruses and bacteria strains causing pneumonia in order to improve diagnostics in the Images were searched by entering the following phrases: COVID-19 lung CT / radiograph images, normal chest CT / radiograph/X-RAY, bacterial pneumonia CT / radiograph images, viral pneumonia CT / radiograph and fungal CT / 145 radiograph images. To qualify the image for the database, it must contain an accurate annotation about the disease (a type of pneumonia). Therefore, images from COVID-CT [9] were rejected for the lack of this information. Most of the images from online publications were downloaded as high quality pictures directly from the web pages. Importantly, each image in the database is accompanied with a precise The number of COVID-19-negative samples is insufficient for training neural networks. Therefore, following [14] , we decided to enrich the COVID-19-negative class with radiograph images from dataset of common bacterial pneumonia [11] .\nThe COVID-19-positive samples were split into train, validation and test sets following 75-15-10 ratio. "}, {"section_title": "Models", "text": "We trained the following models: ResNet-18, ResNet-50 [55] , WideResNet-50 [56] , and DenseNet-169 [18] . For these models we used pytorch implementations 235 and ImageNet initialisation. Additionally, we used DenseNet-121 from [57] which is pre-trained on seven datasets: ChestX-ray14 [19] , PadChest [58] , Chexpert\n[59], MIMIC-CXR [60], Indiana chest X-ray collection [61] , dataset from [62] , and the RSNA Pneumonia Detection Challenge dataset 2 which is a subset of ChestX-ray8 [19] . We refer to this model as DenseNet-121 + to highlight that it 240 has been pre-trained on medical datasets instead of ImageNet.\nAll of the models were trained with Adam optimiser and used step scheduler with step size 7 and gamma equal to 0.1. ResNet-18 was trained with batch size equal to 32, ResNet-50 with batch size equal to 16, and the remaining networks with batch size equal to 8. The loss function for all the models was cross entropy."}, {"section_title": "245", "text": "The networks were trained for 100 epochs with early stopping with patience equal to 10. The other training parameters were chosen using random search which we describe next. "}, {"section_title": "Metrics", "text": "In case of binary classification we report the following metrics: precision, recall, F1 score, accuracy and area under ROC curve (AUC). We assume that 265 the positive class is COVID-19.\nIn case of multiclass classification we report: precision, recall, F1 score, accuracy, binary AUC calculated by merging COVID-19-negative classes together, and multiclass AUC obtained by calculating binary AUC scores for each class in one-versus-rest regime and taking an unweighted mean of these scores. 3 . Again, 270 we assume COVID-19 to be the positive class and the remaining classes to be negative.\nFor all these metrics the higher the score, the better the performance."}, {"section_title": "Results", "text": "In this section we present the results of binary classifiers trained on COVID- "}, {"section_title": "Results of the binary classifiers trained on CTs on their respective test sets.", "text": "The results for binary classifiers trained on images of CT scans are shown in resulting mean is not over-influenced by the most common class in the dataset.\nThe confusion matrices for the best performing models are presented in figure 5 and the confusion matrices of the remaining models are shown in Appendix B.\nThe multiclass AUC of the presented models ranges between 0.74 for ResNet- CT&Radiograph Image Data Stock we constructed two additional test sets. We "}, {"section_title": "355", "text": "In case of CT data we have not found any images that were present in COVID-CT train or validation sets which is not surprising as this dataset was not used as a source of images for COVID-19 CT&Radiograph Image Data Stock.\nSince COVID-CT does not provide an exact diagnosis for COVID-19-negative samples we could not ensure the data distribution in the reduced test set to In To conclude, these results suggest that precise label information can improve the performance of neural networks on the task of binary COVID-19 classification."}, {"section_title": "Conclusion", "text": "In this work, we proposed a new self-contained dataset for COVID-19 classi-440 fication which includes a significant number of both CT and radiograph images from a diverse set of classes. The dataset was constructed ensuring a high quality of samples with each image carefully annotated with its precise label and source.\nA train-validation-test split is defined. The dataset is publicly available and will be updated monthly until the inhibition of COVID-19 pandemic."}, {"section_title": "445", "text": "We fine-tuned several neural network architectures pre-trained on ImageNet or medical dataset to provide benchmark results for the proposed dataset. We Neural networks for CT were trained for each slide separately, which corresponds to the radiograph dimension.In the future we would like to investigate the whole series for patient at ones. Also, we would like to address several remaining questions which include using additional information about the patient to build 460 better-performing models or analysing how the models trained on images of CT and radiograph will perform when used directly on CT or radiograph scans. "}, {"section_title": "Appendix B", "text": "Here, we present the confusion matrices of multiclass classifiers trained on COVID-19 CT&Radiograph Image Data Stock."}, {"section_title": "675", "text": "In figure 6 the results of multiclass classifiers trained on CT data is shown.\nA careful analysis shows that these models struggle to separate between healthy and COVID-19-positive cases -most of the COVID-19-positive samples are well classified but when mistakes occur they are more likely to be categorised as shown. In this case, the COVID-19-positive samples are always correctly classified and hardly any samples of bacterial pneumonia or healthy chest are categorised 685 as COVID-19-positive samples. The class which is most commonly confused with COVID-19 is viral pneumonia but the number of samples misclassifed as COVID-19 never exceeds 10% of samples in this class. Viral and bacterial pneumonia classes are not well separated with bacterial pneumonia cases categorised as viral pneumonia more often than the other way around."}, {"section_title": "690", "text": "The performance metrics for these models are shown in table 14."}]
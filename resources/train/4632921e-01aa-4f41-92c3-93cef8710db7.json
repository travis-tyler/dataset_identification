[{"section_title": "Abstract", "text": "Magnetic Resonance Imaging (MRI) offers highresolution in vivo imaging and rich functional and anatomical multimodality tissue contrast. In practice, however, there are challenges associated with considerations of scanning costs, patient comfort, and scanning time that constrain how much data can be acquired in clinical or research studies. In this paper, we explore the possibility of generating high-resolution and multimodal images from low-resolution single-modality imagery. We propose the weakly-supervised joint convolutional sparse coding to simultaneously solve the problems of super-resolution (SR) and cross-modality image synthesis. The learning process requires only a few registered multimodal image pairs as the training set. Additionally, the quality of the joint dictionary learning can be improved using a larger set of unpaired images 1 . To combine unpaired data from different image resolutions/modalities, a hetero-domain image alignment term is proposed. Local image neighborhoods are naturally preserved by operating on the whole image domain (as opposed to image patches) and using joint convolutional sparse coding. The paired images are enhanced in the joint learning process with unpaired data and an additional maximum mean discrepancy term, which minimizes the dissimilarity between their feature distributions. Experiments show that the proposed method outperforms state-of-the-art techniques on both SR reconstruction and simultaneous SR and cross-modality synthesis."}, {"section_title": "Introduction", "text": "With the rapid progress in Magnetic Resonance Imaging (MRI), there are a multitude of mechanisms to generate tissue contrast that are associated with various anatomical or functional features. However, the acquisition of a complete multimodal set of high-resolution images faces constraints associated with scanning costs, scanner availability, scanning time, and patient comfort. In addition, long-term longitudinal studies such as ADNI [24] imply that changes exist in the scanner or acquisition protocol over time. In these situations, it is not uncommon to have images of the same subject but obtained from different sources, or to be confronted with missing or corrupted data from earlier time points. In addition, high-resolution (HR) 3D medical imaging usually requires long breath-hold and repetition times, which lead to long-term scanning times that are challenging or unfeasible in clinical routine. Acquiring low-resolution (LR) images and/or skipping some imaging modalities altogether from the acquisition are then not uncommon. In all such scenarios, it is highly desirable to be able to generate HR data from the desired target modality from the given LR modality data.\nThe relevant literature in this area can be divided into either super-resolution (SR) reconstruction from single/multiple image modalities or cross-modality (image) synthesis (CMS). On the one hand, SR is typically concerned with achieving improved visual quality or overcoming the resolution limits of the acquired image data. Such a problem is generally under-determined and ill-posed, hence, the solution is not unique. To mitigate this fact, the solution space needs to be constrained by incorporating strong priors. Prior information comes in the form of smoothness assumptions as in, for example, interpolationbased SR [20, 28] . State-of-the-art methods mostly adopt either external data or internal data to guide the learning algorithms [25, 30] . On the other hand, due to variations in optimal image representations across modalities, the learned image model from one modality data may not be the optimal model for a different modality. How to reveal the relationship between different representations of the underlying image information is a major research issue to be explored. In order to synthesize one modality from another, recent methods in CMS proposed utilizing non-parametric methods like nearest neighbor (NN) search [8] , nonlinear regression forests [19] , coupled dictionary learning [26] , and convolutional neural network (CNN) [10] , to name a few. Although these algorithms achieve remarkable results, most of them suffer from the fundamental limitations associated with supervised learning and/or patch-based synthesis. Supervised approaches require a large number of training image pairs, which is impractical in many medical imaging applications. Patch-based synthesis suffers from inconsistencies introduced during the fusion process that takes place in areas where patches overlap.\nIn this paper, we propose a weakly-supervised convolutional sparse coding method with an application to neuroimaging that utilizes a small set of registered multimodal image pairs and solves the SR and CMS problems simultaneously. Rather than factorizing each patch into a linear combination of patches drawn from a dictionary built under sparsity constraints (sparse coding), or requiring a training set with fully registered multimodal image pairs, or requiring the same sparse code to be used for both modalities involved, we generate a unified learning model that automatically learns a joint representation for heterogeneous data (e.g., different resolutions, modalities and relative poses). This representation is learned in a common feature space that preserves the local consistency of the images. Specifically, we utilize the co-occurrence of texture features across both domains. A manifold ranking method picks features of the target domain from the most similar subjects in the source domain. Once the correspondence between images in different domains is established, we directly work on a whole image representation that intrinsically respects local neighborhoods. Furthermore, a mapping function is learned that links the representations between the two modalities involved. We call the proposed method WEakly-supErvised joiNt convolutIonal sparsE coding (WEENIE), and perform extensive experiments to verify its performance.\nThe main contributions of this paper are as follows: 1) This is the first attempt to jointly solve the SR and CMS problems in 3D medical imaging using weakly-supervised joint convolutional sparse coding; 2) To exploit unpaired images from different domains during the learning phase, a hetero-domain image alignment term is proposed, which allows identifying correspondences across source and target domains and is invariant to pose transformations; 3) To map LR and HR cross-modality image pairs, joint learning based on convolutional sparse coding is proposed that includes a maximum mean discrepancy term; 4) Finally, extensive experimental results show that the proposed model yields better performance than state-of-the-art methods in both reconstruction error and visual quality assessment measures."}, {"section_title": "Related Work", "text": "With the goal to transfer the modality information from the source domain to the target domain, recent devel-opments in CMS, such as texture synthesis [6, 10, 13] , face photo-sketch synthesis [9, 36] , and multi-modal retrieval [23, 29] , have shown promising results. In this paper, we focus on the problems of image super-resolution and cross-modality synthesis, so only review related methods on these two aspects.\nImage Super-Resolution: The purpose of image SR is to reconstruct an HR image from its LR counterpart. According to the image priors, image SR methods can be grouped into two main categories: interpolationbased, external or internal data driven learning methods. Interpolation-based SR works, including the classic bilinear [21] , bicubic [20] , and some follow-up methods [28, 41] , interpolate much denser HR grids by the weighted average of the local neighbors. Most modern image SR methods have shifted from interpolation to learning based. These methods focus on learning a compact dictionary or manifold space to relate LR/HR image pairs, and presume that the lost high-frequency (HF) details of LR images can be predicted by learning from either external datasets or internal self-similarity. The external data driven SR approaches [3, 7, 38] exploit a mapping relationship between LR and HR image pairs from a specified external dataset. In the pioneer work of Freeman et al. [7] , the NN of an LR patch is found, with the corresponding HR patch, and used for estimating HF details in a Markov network. Chang et al. [3] projected multiple NNs of the local geometry from the LR feature space onto the HR feature space to estimate the HR embedding. Furthermore, sparse coding-based methods [27, 38] were explored to generate a pair of dictionaries for LR and HR patch pairs to address the image SR problem. Wang et al. [35] and Huang et al. [14] further suggested modeling the relationship between LR and HR patches in the feature space to relax the strong constraint. Recently, an efficient CNN based approach was proposed in [5] , which directly learned an end-to-end mapping between LR and HR images to perform complex nonlinear regression tasks. For internal dataset driven SR methods, this can be built using the similarity searching [25] and/or scale-space pyramid of the given image itself [15] ."}, {"section_title": "Cross-Modality Synthesis:", "text": "In parallel, various CMS methods have been proposed for synthesizing unavailable modality data from available source images, especially in the medical imaging community [26, 33, 34] . One of the well-established modality transformation approaches is the example-based learning method generated by Freeman et al. [8] . Given a patch of a test image, several NNs with similar properties are picked from the source image space to reconstruct the target one using Markov random fields. Roy et al. [26] Figure 1 . Flowchart of the proposed method (WEENIE) for simultaneous SR and cross-modality synthesis.\nilar work was also used in [17] . In [1] , a canonical correlation analysis-based approach was proposed to yield a feature space that can get underlying common structures of co-registered data for better correlation of dictionary pairs. More recently, a location-sensitive deep network [33] has been put forward to explicitly utilize the voxel image coordinates by incorporating image intensities and spatial information into a deep network for synthesizing purposes.\nGatys et al. [10] introduced a CNN algorithm of artistic style, that new images can be generated by performing a pre-image search in high-level image content to match generic feature representations of example images. In addition to the aforementioned methods, most CMS algorithms rely on the strictly registered pairs to train models. As argued in [34] , it would be preferable to use an unsupervised approach to deal with input data instead of ensuring data to be coupled invariably."}, {"section_title": "Weakly-Supervised Joint Convolutional Sparse Coding", "text": ""}, {"section_title": "Preliminaries", "text": "Convolutional Sparse Coding (CSC) was introduced in the context of modeling receptive fields preciously, and later generalized to image processing, in which the representation of an entire image is computed by the sum of a set convolutions with dictionary filters. The goal of CSC is to remedy the shortcoming of conventional patch-based sparse coding methods by removing shift variations for consistent approximation of local neighbors on whole images. Concretely, given the vectorized image x, the problem of generating a set of vectorized filters for sparse feature maps is solved by minimizing the objective function that combines the squared reconstruction error and the l 1 -norm penalty on the representations:\nwhere x is an m \u00d7 n image in vector form, f k refers to the k-th d \u00d7 d filter in vector form, z k is the sparse feature map corresponding to f k with size\nto approximate x, \u03bb controls the l 1 penalty, and * denotes the 2D convolution operator.\nare K filters and feature maps stacked as the single column vector, respectively. Here, the inequality constraint on each column of vectorized f k prevents the filter from absorbing all the energy of the system. Similar to the original sparse coding problem, Zeiler et al. [39] proposed to solve the CSC in Eq. (1) through alternatively optimizing one variable while fixing the other one in the spatial domain. Advances in recent fast convolutional sparse coding (FCSC) [2] have shown that feature learning can be efficiently and explicitly solved by incorporating CSC within an alternating direction method of multipliers (ADMMs) framework in the Fourier domain."}, {"section_title": "Problem Formulation", "text": "The simultaneous SR and cross-modality synthesis problem can be formulated as: given a three-dimensional LR image X of modality M 1 , the task is to infer from X a target 3D image Y that is as similar as possible to the HR ground truth of desirable modality M 2 . Suppose that we are given a group of LR images of modality M 1 , i.e., X = [X 1 , ..., X P ] \u2208 R m\u00d7n\u00d7t\u00d7P , and a set of HR images of modality M 2 , i.e., Y = [Y 2 , ..., Y Q ] \u2208 R m\u00d7n\u00d7t\u00d7Q . P and Q are the numbers of samples in the training sets, and m, n denote the dimensions of axial view of each image, while t is the size of the image along the z-axis. Moreover, in both training sets, subjects of source modality M 1 are mostly different from target modality M 2 , that is, we are working with a small number of paired data while most of them are unpaired. Therefore, the difficulties of this problem vary with hetero-domain images, e.g., resolutions and modalities, and how well the two domains fit. To bridge image appearances across heterogeneous representations, we propose a method for automatically establishing a one-toone correlation between data in X and Y firstly, then employ the aligned data to jointly learn a pair of filters, while assuming that there exists a mapping function F (\u00b7) for associating and predicting cross-modality data in the projected common feature space. Particularly, we want to synthesize MRI of human brains in this paper. An overview of our proposed work is depicted in Fig. 1 .\nNotation: For simplicity, we denote matrices and 3D im-ages as upper-case bold (e.g., image X), vectors and vectorized 2D images as lower-case bold (e.g., filter f ), and scalars as lower-case (e.g., the number of filter k). Image with modality M 1 called source modality belongs to the source domain, and with modality M 2 called target modality belongs to the target domain."}, {"section_title": "Hetero-Domain Image Alignment", "text": "The design of an alignment A (\u00b7) from X to Y requires a combination of extracting common components from LR/HR images and some measures of correlation between both modalities. In SR literature, common components are usually accomplished by extracting high-frequency (HF) edges and texture features from LR/HR images, respectively [3, 38] . In this paper, we adopt first-and secondorder derivatives involving horizontal and vertical gradients as the features for LR images by X hf p = G * X p .\n, and each gradient G has the same length of z-axis as input image while\nTo define the heterodomain image alignment term A (\u00b7), we assume that the intrinsic structures of brain MRI of a subject across image modalities are also similar in the HF space since images of different modalities are more likely to be described differently by features. When HF features of both domains are obtained, it is possible to build a way for cross-modality data alignment (in particular, a unilateral cross-modality matching can be thought as a special case in [16] ). To this end, we define a subject-specific transformation matrix A as\nwhere K(X hf p , Y hf q ) is used for measuring the distances between each pair of HF data in X and Y computed by the Gaussian kernel as\nwhere \u03c3 determines the width of Gaussian kernel. In order to establish a one-to-one correspondence across different domains, for each element of X , the most relevant image with maximum K from Y is preserved while discarding the rest of the elements: 1, :) ) . . .\nwhere max (K (p, :)) denotes the maximum element of the p-th row of A. We further set max (K (p, :)) to 1, and all the blank elements to 0. Therefore, A is a binary matrix. Since A is calculated in a subject-specific manner, each subject of X can only be connected to one target of the most similar brain structures. Hence, images under a hetero-domain can be treated as being the registered pairs, i.e.,"}, {"section_title": "Objective Function", "text": "For image modality transformation, coupled sparse coding [18, 38] has important advantages, such as reliability of correspondence dictionary pair learning and less memory cost. However, the arbitrarily aligned bases related to the small part of images may lead to shifted versions of the same structures or inconsistent representations based on the overlapped patches. CSC [39] was then proposed to generate a global decomposition framework based on the whole image for solving the above problem. In spired by CSC and the benefits of coupled sparsity [18] , we introduce a joint convolutional sparse coding method in a weakly-supervised setting for hetero-domain images. The small number of originally registered pairs are used to carry the intrinsic relationship between X and Y while the majority of unpaired data are introduced to exploit and enhance the diversity of the original learning system.\nAssume that the aforementioned alignment approach leads to a perfect correspondence across X and Y, such that each aligned pair of images possesses approximately identical (or the same for co-registered data) information. Moreover, to facilitate image mappings in a joint manner, we require sparse feature maps of each pair of corresponding source and target images to be associated. That is, suppose that there exists a mapping function F (\u00b7), where the feature maps of LR M 1 modality images can be converted to their HR M 2 versions. Given X and Y, we propose to learn a pair of filters with corresponding feature maps and a mapping function together with the aligned term by arg min\nwhere Z x k and Z y k are the k-th sparse feature maps that estimate the aligned data terms X and Y when convolved with the k-th filters F x k and F y k of a fixed spatial support, \u2200k = {1, ..., K}. Concretely, X denotes the aligned image from P with LR and M 1 modality; Y denotes the aligned image from P containing HR and M 2 modality. A convolution operation is represented as * operator, and \u00b7 F denotes a Frobenius norm chosen to induce the convolutional least squares approximate solution. F x and F y are adopted to list all K filters, while Z x and Z y represent corresponding K feature maps for source and target domains, respectively. A (X , Y) is combined to enforce the correspondence for unpaired auxiliary subjects. The mapping function F (Z x k , W k ) = W k Z x k is modeled as a linear projection W k of Z x k and Z y k by solving a set of the least squares problem (i.e., min W\n). Parameters \u03bb, \u03b2 and \u03b3 balance sparsity, feature representation and association mapping.\nIt is worth noting that P i = {X i , Y i } may not be perfect since HF feature alignment in Eq. (4) is not good enough for very heterogeneous domain adaptation by matching the first-and second-order derivatives of X and means of Y, which leads to suboptimal filter pairs and inaccurate results. To overcome such a problem, we need additional constraints to ensure the correctness of registered image pairs produced by the alignment. Generally, when feature difference is substantially large, there always exists some subjects of the source domain that are not particularly related to target ones even in the HF subspace. Thus, a registered subject pairs' divergence assessment procedure should be cooperated with the aforementioned joint learning model to handle this difficult setting. Recent works [4, 22, 42] have performed instance/domain adaptation via measuring data distribution divergence using the maximum mean discrepancy (MMD) criterion. We follow such an idea and employ the empirical MMD as the nonparametric distribution measure to handle the hetero-domain image pair mismatch problem in the reproducing kernel Hilbert space (RKHS). This is done by minimizing the difference between distributions of aligned subjects while keeping dissimilar 'registered' pairs (i.e., discrepant distributions) apart in the sparse feature map space:\nwhere H indicates RKHS space, Z x k (i) and Z y k (i) are the paired sparse feature maps for P i = {X i , Y i } with i = 1, ...P , M i is the i-th element of M while M denotes the MMD matrix and can be computed as follows\nBy regularizing Eq. (5) with Eq. (6), filter pairs F x k and F y k are refined and the distributions of real aligned subject pairs are drawn close under the new feature maps. Putting the above together, we obtain the objective function:"}, {"section_title": "Optimization", "text": "We propose a three-step optimization strategy for efficiently tackling the objective function in Eq. (8) (termed (WEENIE), summarized in Algorithm 1) considering that such multi-variables and unified framework cannot be jointly convex to F, Z, and W. Instead, it is convex with respect to each of them while fixing the remaining variables."}, {"section_title": "Computing Convolutional Sparse Coding", "text": "Optimization involving only sparse feature maps Z x and Z y is solved by initialization of filters F x , F y and mapping function W (W is initialized as an identity matrix). Besides the original CSC formulation, we have additional terms associated with data alignment and divergence reducing in the common feature space. Eq. (8) is firstly converted to two regularized sub-CSC problems. Unfortunately, each of the problems constrained with an l 1 penalty term cannot be directly solved, which is not rotation invariant. Recent approaches [2, 12] have been proposed to work around this problem on the theoretical derivation by introducing two auxiliary variables U and S to enforce the constraint inherent in the splitting. To facilitate component-wise multiplications, we exploit the convolution subproblem [2] in the Fourier domain 2 derived within the ADMMs framework:\nwhere\u02c6applied to any symbol indicates the discrete Fourier transform (DFT), for exampleX \u2190 f (X), and f (\u00b7) denotes the Fourier transform operator. represents the Hadamard product (i.e., component-wise product), \u03a6 T is the inverse DFT matrix, and s projects a filter onto a small spatial support. By utilizing slack variables U x k , U y k and S x k , S y k , the loss function can be treated as the sum of multiple subproblems and with the addition of equality constraints."}, {"section_title": "Training Filters", "text": "Similar to theoretical CSC methods, we alternatively optimize the convolutional least squares term for the basis function pairs F x and F y followed by an l 1 -regularized least squares term for the corresponding sparse feature maps Z x and Z y . Like the subproblem of solving feature maps, filter pairs can be learned in a similar fashion. With\u1e90 x k ,\u1e90 y k and W k fixed, we can update the corresponding filter pairsF x k , andF y k as\nThe optimization with respect to Eq. (10) can be solved by a one-by-one update strategy [35] through an augmented Lagrangian method [2] ."}, {"section_title": "Learning Mapping Function", "text": "Finally, W k can be learned by fixing F x k , F y k , and Z x k , Z y k :\nwhere Eq. (11) is a ridge regression problem with a regularization term. We simplify the regularization term R(tr) = T r( "}, {"section_title": "Algorithm 1: WEENIE Algorithm", "text": "Input: Training data X and Y, parameters \u03bb, \u03b3, \u03c3.\nFix other variables, update\u1e90 x k+1 ,\u1e90 y k+1 and\u00db x k+1 , U y k+1 by (9) . 6 Fix other variables, updateF x k+1 ,F y k+1 and\u015c x k+1 , S y k+1 by (10) with\u1e90 x k+1 ,\u1e90 y k+1 ,\u00db x k+1 ,\u00db y k+1 and W k . 7 Fix other variables, update W k by (11) wit\u0125\nOutput: F x , F y , W."}, {"section_title": "Synthesis", "text": "Once the training stage is completed, generating a set of filter pairs F x , F y and the mapping W, for a given test image X t in domain X , we can synthesize its desirable HR version of style Y. This is done by computing the sparse feature maps Z t of X t with respect to a set of filters F x , and associating Z t to the expected feature maps\u1e90 t via W, i.e.,\u1e90 t \u2248 WZ t . Therefore, the desirable HR M 2 modality image is then obtained by the sum of K converted sparse feature maps\u1e90 t k convolved with desired filters F y k (termed (SRCMS) summarized in Algorithm 2):\nAlgorithm 2: SRCMS Input: Test image X t , filter pairs F x and F y , mapping W.\nUpdate Z t k+1 and\u1e90 t k+1 by (9) with Y t k , and W. 5 Update Y t k+1 \u2190 W\u1e90 t k+1 . 6 end 7 Synthesize Y t by (12) .\nOutput: Synthesized image Y t . "}, {"section_title": "Experimental Results", "text": "We conduct the experiments using two datasets, i.e., IXI 3 and NAMIC brain mutlimodality 4 datasets. Following [11, 35, 38] , LR counterparts are directly down-sampled from their HR ground truths with rate 1/2 by bicubic interpolation, boundaries are padded (with eight pixels) to avoid the boundary effect of Fourier domain implementation. The regularization parameters \u03c3, \u03bb, \u03b2, and \u03b3 are empirically set to be 1, 0.05, 0.1, 0.15, respectively. Optimization variables F, S, Z, and U are randomly initialized with Gaussian noise considering [2] . Generally, a larger number of filters leads to better results. To balance between computation complexity and result quality, we learn 800 filters following [11] . In our experiments, we perform a more challenging division by applying half of the dataset (processed to be weakly co-registered data) for training while the remaining for testing. To the best of our knowledge, there is no previous work specially designed for SR and cross-modality synthesis simultaneously by learning from the weakly-supervised data. Thus, we extend the range of existing works as the baselines for fair comparison, which can be divided into two categories as follows: (1) brain MRI SR; (2) SR and cross-modality synthesis (one-by-one strategy in comparison models). For the evaluation criteria, we adopt the widely used PSNR and SSIM [37] indices to objectively assess the quality of the synthesized images.\nExperimental Data: The IXI dataset consists of 578 256 \u00d7 256 \u00d7 n MR healthy subjects collected at three hospitals with different mechanisms (i.e., Philips 3T system, Philips 1.5T system, and GE 3T system). Here, we utilize 180 Proton Density-weighted (PD-w) MRI subjects for image SR, while applying both PD-w and registered T2weighted (T2-w) MRI scans of all subjects for major SR-CMS. Further, we conduct SRCMS experiments on the processed NAMIC dataset, which consists of 20 128\u00d7128\u00d7m subjects in both T1-weighted (T1-w) and T2-w modalities. As mentioned, we leave half of the dataset out for crossvalidation. We randomly select 30 registered subject pairs for IXI, and 3 registered subject pairs for NAMIC, respectively, from the half of the corresponding dataset for training purposes, and process the reminding training data to be unpaired. Particularly, all the existing methods with respect to cross-modality synthesis in brain imaging request a preprocessing, i.e., skull stripping and/or bias corrections, as done in [34, 26] . We follow such processes and further validate whether pre-processing (especially skull stripping) is always helpful for brain image synthesis."}, {"section_title": "Brain MRI Super-Resolution", "text": "For the problem of image SR, we focus on the PD-w subjects of the IXI dataset to compare the proposed WEENIE model with several state-of-the-art SR approaches: sparse coding-based SR method (ScSR) [38] , anchored neighborhood regression method (ANR) [31] , neighbor embedding + locally linear embedding method (NE+LLE) [3] , Zeyde's method [40] , convolutional sparse coding-based SR method (CSC-SR) [11] , and adjusted anchored neighborhood regression method (A+) [32] . We perform image SR with scaling factor 2, and show visual results on an example slice in Fig. 2 . The quantitative results for different methods are shown in Fig. 3 , and the average PSNR and SSIM for all 95 test subjects are listed in Table 1 . The proposed method, in the case of brain image SR, obtains the best PSNR and SSIM values. The improvements show that the MMD regularized joint learning property on CSC has more influence than the classic sparse coding-based methods as well as the state-of-the-arts. It states that using MMD combined with the joint CSC indeed improves the representation power of the learned filter pairs."}, {"section_title": "Simultaneous Super-Resolution and Cross-Modality Synthesis", "text": "To comprehensively test the robustness of the proposed WEENIE method, we perform SRCMS on both datasets involving six groups of experiments: (1) synthesizing SR T2-w image from LR PD-w acquisition and (2) vice versa;\n(3) generating SR T2-w image from LR PD-w input based on pre-processed data (i.e., skull strapping and bias correc- [34] and MR image exampled-based contrast synthesis (MIMECS) [26] approach. However, Vemulapalli's methods cannot be applied for our problem, because they only contain the cross-modality synthesis stage used in the NAMIC dataset. Original data (without degradation processing) are used in all Vemulapallis methods. MIMECS takes image SR into mind and adopts two independent steps (i.e. synthesis+SR) to solve the problem. We compare our results on only using registered image pairs denoted by WEENIE(reg) (that can directly substantiate the benefits of involving unpaired data) and the results using all training images with/without preprocessing for the proposed method against MIMECS, V-US and V-S in above six cases and demonstrate examples in Fig. 4 for visual inspection. The advantage of our method over the MIMECS shows, e.g., in white matter structures, as well as in the overall intensity profile. We show the quantitative results in Fig.  5 , and Fig. 6 , and summarize the averaged values in Table  2 , respectively. It can be seen that the performance of our algorithm is consistent across two whole datasets, reaching the best PSNR and SSIM for almost all subjects."}, {"section_title": "Conclusion", "text": "In this paper, we proposed a novel weakly-supervised joint convolutional sparse coding (WEENIE) method for simultaneous super-resolution and cross-modality synthesis (SRCMS) in 3D MRI. Different from conventional joint learning approaches based on sparse representation in supervised setting, WEENIE only requires a small set of registered image pairs and automatically aligns the correspondence for auxiliary unpaired images to span the diversities of the original learning system. By means of the designed hetero-domain alignment term, a set of filter pairs and the mapping function were jointly optimized in a common feature space. Furthermore, we integrated our model with a divergence minimization term to enhance robustness. With the benefit of consistency prior, WEENIE directly employs the whole image, which naturally captures the correlation between local neighborhoods. As a result, the proposed method can be applied to both brain image SR and SR-CMS problems. Extensive results showed that WEENIE can achieve superior performance against state-of-the-art methods."}]
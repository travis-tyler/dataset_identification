[{"section_title": "Abstract", "text": "Abstract. The recent challenge in diffusion imaging is to find acquisition schemes and analysis approaches that can represent non-gaussian diffusion profiles in a clinically feasible measurement time. In this work we investigate the effect of b-value and the number of gradient vector directions on Q-ball imaging and the Diffusion Orientation Transform (DOT) in a structured way using computational simulations, hardware crossing-fiber diffusion phantoms, and in-vivo brain scans. We observe that DOT is more robust to noise and independent of the b-value and number of gradients, whereas Q-ball dramatically improves the results for higher b-values and number of gradients and at recovering larger angles of crossing. We also show that Laplace-Beltrami regularization has wide applicability and generally improves the properties of DOT. Knowledge of optimal acquisition schemes for HARDI can improve the utility of diffusion weighted MR imaging in the clinical setting for the diagnosis of white matter diseases and presurgical planning."}, {"section_title": "Introduction", "text": "Diffusion-weighted Magnetic Resonance Imaging (DW-MRI) is a clinical medical imaging technique that provides a unique view on the structure of brain white matter in-vivo. White matter fiber-bundles are probed indirectly by measuring the directional specificity (anisotropy) of local water diffusion. Post-processing of diffusion weighted images is fundamentally aimed at calculating the probability distribution function (pdf) for the displacement of water molecules in each imaging voxel. In general, the task is to find the transform \u03a6 that takes the measurements S(g i ), for a finite set of 3D diffusion gradient vectors g i = {x i , y i , z i } i {1, . . . , N }, to the desired pdf P (r i ), as in P (r i ) = \u03a6[S(g i )](r i ). Here the pdf P (r i ) is a function of the 3D displacement vector r i , and we generally have measured signals S(g i ). In Diffusion Tensor Imaging (DTI) the pdf is assumed to be a 3D gaussian distribution represented as a rank-2 tensor and the effect of the diffusion gradients on the MR signal is assumed to be of an exponentially decaying form. However, the diffusion tensor cannot resolve more than a single fiber population per voxel, because partial volume effects will cause a non-gaussian diffusion profile with multiple maxima [1] .\nIt has been shown if we re-express our signal as E(q i ) = S(q i )/S 0 , that the sought relation is the Fourier Transform, where q i is the diffusion wavevector, defined as q i = (2\u03c0) \u22121 \u03b3\u03b4g i (where \u03b3 is the gyromagnetic ratio and \u03b4 is the duration of the diffusion gradients), and S 0 is the unweighted or zero-weighted baseline signal obtained without any applied diffusion gradients. However, directly calculating the Fourier Transform, as in Diffusion Spectrum Imaging (DSI) [2] , requires a very large number of gradients, thus ensuing long measurement times. In High Angular Resolution Diffusion Imaging (HARDI) a moderate amount (from about 60 to a few hundred) of diffusion gradients are scanned that together sample a sphere of given radius [3] . Among the analysis techniques that transform this data to certain probability function (Orientation Distribution Function, Fiber Orientation or Probability Function given a position, etc.) are Q-ball imaging [4] , Spherical Deconvolution (SD) [5] , Diffusion Orientation Transform (DOT) [6] and Persistent Angular Structure (PAS-MRI) [7] .\nIn this work we use computational simulations, hardware crossing-fiber diffusion phantoms, and in-vivo brain scans to investigate the effect of acquisition parameters on the ability to reconstruct non-gaussian diffusion profiles in crossing fiber regions. We quantify the angular resolution of two selected reconstruction methods Q-ball imaging, and the Diffusion Orientation Transform under different acquisition schemes. We vary b-value (defined as b = \u03b3 2 \u03b4 2 (\u2206 \u2212 \u03b4/3), where \u2206 is the time between the two complementary diffusion gradients) and number of gradients directions in a structured way to investigate their effects and interaction."}, {"section_title": "Methods", "text": ""}, {"section_title": "Ground Truth Synthetic Data", "text": "We generate synthetic data by simulating the diffusion-weighted MR signal attenuation from molecules, with free diffusion coefficient D 0 , restricted inside a cylinder of radius \u03c1 and length L as in [8] . Two fiber crossings were simulated under 40\n\u2022 , 45\n\u2022 and 90 \u2022 , with the following set of parameters (see [6] ): L = 5mm, \u03c1 = 5 \u00b5m, D 0 = 2.02 10 \u22123 mm 2 /s. All simulated imaging parameters were chosen to be the same as in our MRI acquisition protocol, described in section 2.3. Simulations were performed with and without noise. For the noise simulations, Gaussian noise was added to the real and complex part of the signal, with standard deviation according to the SNR calculated in our MRI acquisition protocol (Fig. 1) for the corresponding b-values. Mean and standard deviation were calculated over 100 noise realizations for each set of gradient directions, b-values and simulated angle. The angular error was taken as the mean of the individual absolute differences between the simulated and recovered angles."}, {"section_title": "Ground Truth Hardware Phantoms", "text": "Hardware phantoms were constructed using the method described earlier [9] . Two bundles, each composed of 25 sub-bundles of 400 fibers (KUAG Diolen, Germany; Each fiber consists of 22 filaments of \u2248 10\u00b5m) were positioned interdigitated to create artificial crossings. Three phantoms were constructed, with crossings at 30\n\u2022 , 50\n\u2022 and 65\n\u2022 respectively. The phantoms were placed in a container, filled with a 0.03 g/l MnCl 2 \u00b7 4 H 2 O solution (Siemens, Erlangen, Germany) to obtain T 2 relaxation of approximately 90ms, corresponding with human white matter T 2 . 2.4 g/l NaCl was added for resistive coil loading."}, {"section_title": "MRI Data Acquisition", "text": "Human: DW-MRI acquisition was performed on subject VP (25 yrs, female) using a twice refoccused spin-echo echo-planar imaging sequence on a Siemens Allegra 3T scanner (Siemens, Erlangen, Germany). Informed consent was obtained prior to the measurement. FOV 208 \u00d7 208 mm, voxel size 2.0 \u00d7 2.0 \u00d7 2.0mm. 10 horizontal slices were positioned through the body of the corpus callosum and centrum semiovale. Custom gradient direction schemes, created with the electrostatic repulsion algorithm [10] were used for DW-MRI. The diffusion-weighted volumes were interleaved with b 0 volumes every 12th scanned diffusion gradient directions. Data sets were acquired with #vols(#dirs): 132(120) 106(96), 80(72), 54(48) directions, each at b-values of 1000, 1500, 2000, 3000, 4000 s/mm 2 , using gradient timing \u03b4: gradient pulse duration, and \u2206: gradient spacing as given in Fig. 1 . In the same session, two anatomical data sets (192 slices, voxel size 1 \u00d7 1 \u00d7 1mm) were acquired using the ADNI protocol. Total scanning time was 75 minutes. Hardware phantom: The hardware phantom was scanned using exactly the same DW-MRI protocol as the human subject. The 54 direction scheme and ADNI were omitted from the protocol. Slices were positioned orthogonal to the legs of the phantom, through the crossing region."}, {"section_title": "Analysis", "text": "We implemented the analytical Q-ball imaging [11] and the parametric and nonparametric DOT [6] . Both of the implemented DOT techniques gave identical results. It is important to note that DOT has two extra tunable parameters: the effective diffusion time t, and the radius of a sphere R 0 that defines the probability function. As the results of DOT depend on these values, we experimentally found the optimal R 0 and extracted the effective diffusion time from the imaging parameters as t = \u2206 \u2212 \u03b4/3 (see Fig. 1 ). For finding the optimal R 0 , we varied the value of R 0 over a wide range of discrete values, and in our analysis we considered the ones that gave smallest angular error (e.g., in the simulation cases the \"good candidates\" were R 0 ={0.022, 0.024, 0.026, 0.028, 0.03}\u00b5m). We varied the order of the Spherical Harmonics , between 4 and 8.\nAs a preprocessing step for the noisy data sets, we included Laplace-Beltrami smoothing on the signal, for both of the methods with \u03bb = 0.006 as in [12] . We assume that the fiber directions are simply given by the local maxima of the normalized [0,1] ODF/probability profile where the function surpasses a certain threshold (here, we use 0.5). To ensure that the minimal expected error related to the sphere tessellation is less than 7.2\n, we use 4th order of tessellation of an icosahedron."}, {"section_title": "Results", "text": ""}, {"section_title": "Noiseless synthetic simulations", "text": "Results of the angular errors are shown on Fig. 2 for the different simulated direction tables and b-values. Both of the methods managed to recover most angles with identical angular error over a wide range of b and . Naturally as the angle of crossing increases the angular error decreases. Tables on Fig. 2b summarize the optimal b value and model order for Q-ball and DOT respectively, where as optimal, we consider the lowest combination of b and for which the angular error for each simulated angle is minimal. From the table we can conclude that DOT is able to recover the simulated angles with the same angular error as Q-ball, but with lower combination of b and order. Furthermore, DOT reconstructs the correct profiles, for each simulated angle, generally at lower values of than Q-ball.\nl=8;b=2000 l=6;b=3000 l=6;b=2000 l=4;b=2000 l=8;b=1500 l=8;b=1500 l=6;b=1000 l=8;b=1500 l=6;b=3000 l=4;b=2000 l=8;b=1500 l=6;b=1000 l=8;b=1500 l=6;b=4000 l=4;b=2000 l=8;b=1500 l=6;b=1000 l=8;b=1500 l=6;b=3000 l=4;b=2000 l=8;b=1500 l=6;b=1000 =6;b=1000 l=4;b=1000 106 l=6;b=1000 l=4;b=1000 l=6;b=1000 l=4;b=1000 54 l=6;b=1000 l=4;b=1000\nEstimated angle l=6;b=2000 l=6;b=2000 l=6;b=2000 132 80 l=4;b=2000 l=6;b=1000 l=4;b=2000 l=6;b=1000 l=4;b=2000 l=6;b=1000 l=4;b=2000 l=6;b=1000 36,7313\u00b047,5762\u00b052,5901\u00b052,5901\u00b060,5194\u00b089,3214\u00b05 4 l=6;b=1000 l=6;b=1000 80 l=6;b=1000 l=6;b=1000 106 l=6;b=1000 l=6;b=1000 l=4;b=1000 l=4;b=1000 l=4;b=1000 l=4;b=1000 90\u00b060\u00b050\u00b055\u00b0l =4;b=1000 l=4;b=1000 l=4;b=1000"}, {"section_title": "Estimated angle", "text": ""}, {"section_title": "Simulated angle Gradient directions", "text": "l=4;b=1000 l=4;b=1000"}, {"section_title": "132", "text": "l=6;b=1000 l=6;b=1000 l=4;b=1000 l=4;b=1000"}, {"section_title": "40\uf0b0 45\u00b0l", "text": "=4;b=1000 "}, {"section_title": "Noisy synthetic simulations and hardware phantom Data", "text": "In Fig. 3 , the angular error of the minimal recovered angle for the different acquisition schemes is shown. Our criteria for minimal detected angle is the smallest angle for which the angular error is no more than 20 \u2022 , given that the standard deviation (\u03c3) over the noise realizations is no more than 20\n\u2022 . It should be noted that a liberal threshold on \u03c3 was needed as it was generally very high over 100 realizations at the simulated low but realistic SNRs. If multiple angles are found within this criteria, we choose the one whose probability is highest. The results from Fig. 3 coincide with the conclusion from the noiseless data sets. DOT is more robust to noise, thus it manages to recover, in most of the cases, angles of 45\n\u2022 , whereas Q-ball is quite dependent on the b-value and the number of gradient directions in case of small angles of crossings. Furthermore for the same set of parameters, the angular error of the same recovered angle is smaller in DOT (e.g., In Fig. 3 , for 54 gradients and b = 1000s/mm 2 DOT found angle of 90\n\u2022 with smaller error than the reported one in Q-ball. Yet we report angle of 50\n\u2022 for DOT, since that is the minimal angle that was recovered with this parameter combination and within our criteria. In this concrete case Q-ball failed to accurately recover angles smaller than 90\n\u2022 ). In Fig. 4 the analysis of the phantom data is shown. Using the same criteria as above on 60 voxels located in the crossings, we show that DOT is able to recover even an angle with 30\n\u2022 of crossing, at a cost of very high order and number of gradient directions. Again we observe that DOT is more robust to noise and independent of the b-value and number of gradients, whereas Q-ball improves the results for higher b-value and number of gradients and at recovering larger angles of crossing. "}, {"section_title": "In-vivo human brain data", "text": "The centrum semiovale was used for the qualitative analysis of the Q-ball and DOT techniques. It is a challenging region for DW-MRI analysis techniques, since fibers of the corpus callosum, corona radiata, and superior longitudinal fasciculus form a three-fold crossing there. Region-of-interest (ROI) was defined on a coronal slice. Fig. 5 shows the normalized Q-ball and DOT glyph reconstructions of the DW-MRI datasets with 4 th order of Spherical Harmonics, for 54 and 132 gradient directions and b-values of 1000 and 4000 s/mm 2 . All the images are from similar region in the different datasets, but no registration was done, so the shown glyphs do not correspond exactly. In the background, the color coded FA map is visible, with the corpus callosum (CC) in red, going from lower right to upper left and corona radiata (CR) in blue, from lower left to upper right. The crossing region in the middle is shown in purple.\nBoth CC and CR structures can be clearly separated. Overall, the data shows an increase in quality when raising the number of gradient directions. When comparing the Q-ball images, the higher b-value (4000 s/mm 2 ) case shows more detail than the lower b-value (1000 s/mm 2 ) across all data sets. The DOT images do not show a decrease in quality when comparing both b-values and are rather invariant to the number of the sampled gradient directions. It's important to note that tuning the optimal R 0 parameter for the DOT, is not trivial in in-vivo data sets, and by simplicity and speed of calculations of the reconstructed ODFs, Q-ball has significant advantage."}, {"section_title": "Discussion & Conclusions", "text": "In the comparison between the two tested methods there seems to be a tendency for DOT to be more robust to noise and relatively independent of the b-value and number of gradients, whereas Q-ball improves the results for higher b-value and number of gradients and at recovering larger angles of crossing. DOT is able to recover the same (in the noiseless simulations) or even smaller angles (in the noisy simulations) as the used Q-ball implementation, with smaller b-values, and generally at a smaller . In the hardware phantom data DOT seems to be able to recover even an angle with 30\n\u2022 of crossing, at a high order and number of gradient directions. This makes DOT comparable to today's state-of-the art Spherical Deconvolution, and future work is addressed in finding the minimum angle at which DOT can still distinguish between two crossings. A few cautions are in place here. First, these results are specific to the implementations of the methods used here. Particularly, a spherical harmonic transform was used on the data as a first preprocessing step that served to smooth the data and regularize the fit of the models in a unified and standard way for both methods. Our results are thus dependent on choices for the SH order and Laplace-Beltrami regularization coefficient \u03bb, which we fixed to 0.006, as detailed in [12] . It is very interesting to see that this regularization approach originally constructed for fast and robust Q-ball imaging seems to have a more general utility, since the DOT also benefits from its smoothing properties. Future work should investigate in details the optimal values for Laplace-Beltrami regularization coefficient \u03bb for the DOT, or consider different regularization approaches that might improve DOT's properties. A second important aspect of implementation is the R 0 parameter for the DOT. The results of DOT are highly dependent on the choice of R 0 , which we tried to resolve by computing the DOT at several values of R 0 and then reporting the best result. Future work should be aimed at robustly finding the optimal R 0 under different acquisition protocols. Last aspect is on maxima detection. Current maxima detection approaches in HARDI are quite poor. Finding some more general and robust algorithms, can improve the accuracy of the HARDI methods, as well as help in developing better fibertracking techniques. This work shows that validation of HARDI methods in the ranges of noise present in actual clinical data sets is highly important. Here we compared only two of the many available (and clinically applicable) HARDI techniques. It would be very interesting if techniques as Spherical Deconvolution and PAS-MRI can be subject of similar comparison."}]
[{"section_title": "Abstract", "text": "Over the past decades, medical image analytics was greatly facilitated by the explosion of digital imaging techniques, where huge amounts of medical images were produced with ever-increasing quality and diversity. However, conventional methods for analyzing medical images have achieved limited success, as they are not capable to tackle the huge amount of image data. In this paper, we review state-ofthe-art approaches for large-scale medical image analysis, which are mainly based on recent advances in computer vision, machine learning and information retrieval. Specifically, we first present the general pipeline of large-scale retrieval, summarize the challenges/opportunities of medical image analytics on a large-scale. Then, we provide a comprehensive review of algorithms and techniques relevant to major processes in the pipeline, including feature representation, feature indexing, searching, etc. On the basis of existing work, we introduce the evaluation protocols and multiple applications of large-scale medical image retrieval, with a variety of exploratory and diagnostic scenarios. Finally, we discuss future directions of large-scale retrieval, which can further improve the performance of medical image analysis."}, {"section_title": "Introduction", "text": "Medical image analytics plays a central role in clinical diagnosis, image-guided surgery and pattern discovery. Many protocols and modalities of digital imaging techniques have been adopted to generate medical images, including magnetic resonance imaging (MRI) ( Slichter, 2013 ) , computed tomography (CT) ( Hsieh, 2009 ) , photon emission tomography (PET) ( Bailey et al., 2005 ) , ultrasound ( Szabo, 2004 ) , fluorescence microscopy ( Lichtman and Conchello, 2005 ) , X-ray ( Lewis, 2004 ) and others. Generally, these medical images reflect specific aspects (anatomy, function) of tissue types/organs that require an accurate interpretation and analysis from either domain experts or computer-aided decision support. In comparison with domain expert analysis that is labor intensive and time-consuming, computer-aided approaches are efficient and its accuracy has increased continuously with the rapid development of computer vision, machine learning and related fields ( May, 2010; Katouzian et al., 2012; Doi, 2014 ) . To support computer-aided medical image analytics, one important task is content-based image retrieval (CBIR) ( M\u00fcller et al., 2004; Lehmann et al., 2004; Akg\u00fcl et al., 2011 ) , i.e., indexing and mining im-such as vocabulary trees ( Nister and Stewenius, 2006 ) and hashing can efficiently tackle this problem, either through changing the indexing structure or compressing the original features.\nDespite the current large-scale methods having achieved many successes in generic image retrieval problems, how to best tackle the retrieval in large-scale medical image databases is still a very challenging topic ( Zhang and Metaxas, 2016 ) . On the one hand, the meaning of large-scale in the medical image field is somewhat different from large-scale in the generic image domain. Generally, each patient can generate hundreds to thousands of image slices using different protocols, modalities (e.g., CT, MRI, X-ray) and multiple dimensions (e.g., volumetric 3D, time series). These volumes are usually stored in many single images (as slices) in the DICOM (Digitla Imaging and Communications in Medicine) format ( Kahn et al., 2007 ) . Besides this, the size of some medical images can be extremely large. For example, the whole-slide histopathological images can include more than 10 0, 0 0 0 \u00d7 10 0, 0 0 0 pixels and thus each is usually split into millions of small patches for processing. On the other hand, medical images are usually more difficult to analyze compared to generic images. The complex imaging parameters (contrast agents, machine settings), anatomic difference and interactions between different diseases result in a more complex analysis compared with natural images, where broad object categories are recognized and used for similarity calculations. The relevant changes of some medical images can be very subtle, which require more fine-grained and detailed analysis. Therefore, directly employing traditional CBIR methods may not suitable for the large-scale medical image retrieval problem. In recent years, many effort s have been made to achieve large-scale medical image analytics, aiming to improve the efficiency and accuracy of image retrieval."}, {"section_title": "Related work", "text": "There have been multiple reviews focusing on content-based medical image retrieval. The first review in the field was Tang et al. (1999) but the text only contained few systems with a limited scope. M\u00fcller et al. (2004) presented a first complete review that concentrates on image retrieval in the medical domain, where the techniques used in medical image retrieval, including visual feature extraction, image comparison, system evaluation, etc. are summarized. Subsequently, Long et al. (2009) introduced four medical CBIR systems, i.e., CervigramFinder ( Xue et al., 20 08 ) , SPIRS ( Hsu et al., 20 07 ) , IRMA ( IRMA, 2016 ) , SPIRS-IRMA . The authors also discussed future directions of medical image retrieval. Akg\u00fcl et al. (2011) presented a comprehensive review about recent techniques of content-based image retrieval in radiology until 2011, including image features/descriptors, similarity measures and state-of-the-art systems. Additionally, they discussed challenges and future directions for the coming decade. Hwang et al. (2012) reviewed both text-based and content-based medical image retrieval systems, drawing a conclusion that the image retrieval service will be more effective if CBIR and semantic systems are combined. In 2013, Kumar et al. (2013) surveyed several applications and approaches to medical CBIR that focus on clinical imaging data that are multidimensional or acquired using multiple modalities such as combined PET-CT images.\nBesides the above mentioned survey articles, the image retrieval task of the Conference and Labs of the Evaluation Forum, named ImageCLEF ( ImageCLEF, 2016; , has held several medical image retrieval tasks from 2004 to 2014. ImageCLEF provides a platform for research groups submitting results and competing on the performance of their medical image retrieval methods. After each ImageCLEF medical image retrieval task, an overview is provided to summarize the methods and results of each competition groups ( Kalpathy-Cramer et al., 2015; de Herrera et al., 2013; M\u00fcller et al., 2012; Kalpathy-Cramer et al., 2011 ) , which demonstrates the state-of-the-art in the medical image retrieval field. A benchmark for case-based retrieval including full volumetric images of more than 300 patients was run as part of the VISCERAL benchmark ( Jimenez-del-Toro et al., 2015 ) ."}, {"section_title": "Contributions and organization of this article", "text": "This survey provides a structured and extensive overview of large-scale retrieval for medical image analytics. Despite existing reviews having summarized varieties of medical retrieval systems and methods, none of them focused on the retrieval techniques for large-scale medical data, which is currently the main challenge in the field of medical analytics. This survey offers a focused overview of the retrieval approaches for the large-scale medical image data by expanding multidisciplinary components that involve a nexus of the idea from machine learning, computer vision, information retrieval, and bioinformatics. It explains the entire process from scratch and presents a comprehensive pipeline that discusses every processing step from feature extraction to knowledge discovery and decision support. Fig. 1 illustrates a general pipeline of large-scale medical image retrieval. Given a set of medical images (e.g., MRI, CT, microscopy, etc.), feature extraction methods are employed to represent each image. Unlike traditional medical retrieval methods that directly compare the image similarity via original feature vectors, large-scale approaches often first train a retrieval model, e.g., organizing and transforming image features that can improve the performance of feature indexing. In the query phase, the query image is compared only to similar images based on the well-designed retrieval model rather than an exhaustive search of the whole database. The retrieval results can be provided to users for further analysis. According to Fig. 1 , retrieval with large-scale medical image databases is different compared with classical CBIR systems. In recent years, many researchers in the medical domain have moved their attention to the analytical questions of largescale image analysis ( Zhang and Metaxas, 2016 ) . Therefore, in this era of big data, it is necessary to present a comprehensive review of recent advances in large-scale medical image analytics.\nIn this paper, we organize the survey into five parts: challenges/opportunities, methodology review, evaluation protocols, applications, and future directions. In Section 2 , challenges and opportunities related to big data in medical image analytics are provided. Section 3 and 4 discuss the methodology details relevant to the large-scale medical image retrieval, which mainly includes two parts, i.e., feature representation, feature indexing and search. Following Section 5 introduces evaluation protocols in medical image retrieval. Based on the existing approaches, Section 6 reviews several applications of large-scale medical image retrieval. Finally, Section 7 explores potential directions for future work on largescale medical retrieval."}, {"section_title": "Challenges and opportunities", "text": "The challenges of large-scale medical image retrieval can be summarized as a good trade-off between efficiency and accuracy. Despite traditional methods having already achieved good performance in many very specific medical scenarios, keeping efficiency and accuracy in large-scale approaches still faces many problems. Additionally, in the era of big data, large-scale medical image analysis provides many opportunities for both academia and industry."}, {"section_title": "Challenges", "text": "One major concern in the big data era is system efficiency. Fig. 1 . A general pipeline of large-scale medical image retrieval. represent and search in an efficient way still has many challenges. Counting the data from The Cancer Imaging Archive ( TCIA, 2016 ), a large-scale medical image repository, Fig. 2 illustrates the number of images with the six most common anatomical sites. According to Fig. 2 , these data sets have hundreds of thousands to millions of medical images, which are hard to analyze in real-time. For medical image retrieval, each image is usually represented by a feature vector with often thousands of dimensions. An exhaustive search of millions of images with large feature vectors is very time-consuming . In clinical applications, for a single patient tens to hundreds/thousands of images are collected (large MRI studies can easily contains tens of thousand of single image slices for a single patient) and an efficient retrieval of these images is required for computer-assisted diagnosis. Accordingly, to achieve medical retrieval with massive amounts of images, two aspects need to be explored for improvement , i.e., 1) reducing the dimension of the feature vectors (or creating very sparse spaces), 2) improving the strategy of similarity search or data indexing. Both challenges are hard to tackle using conventional methods."}, {"section_title": "Retrieved Images", "text": "Another concern of medical retrieval is system accuracy. In the information retrieval field, precision is one of the most important criteria for performance evaluation, which is defined as the fraction of retrieved images that are relevant to the query image ( Powers, 2011 ) . For a query image, higher retrieval precision indicates more reliable analysis and exploration results, since most of the retrieved images share (hopefully) similar semantic content with the query image. Retrieval precision plays a critical role in medical analytics, where clinical diagnoses can depend on decision support that is based on the retrieved images. However, achieving high precision in medical retrieval is not an easy task, especially with the large amount of volumetric image data, where most parts of the images/volumes are not important for similarity calculations but small, local anomalies are. Fig. 3 illustrates a common problem in the classification of histopathological images, which are obtained from intraductal breast lesions in this case. The two images to the left (with the blue bounding box) belong to the same category, i.e., both are actionable (indicating the cells/tumors are pathogenic). However, they have quite different expressions. On the other side, for the bottom two images (with the red bounding box), despite the visual similarity, they belong to different categories (the right image is benign, indicating the cell's/tumor's lack of the ability to invade neighboring tissue and create metastasis). This problem can be summarized as large intraclass variation and small inter-class variation . Not only in histopathological image analysis, most medical image analytics tasks encounter similar problems. More critically, when dealing with massive medical data, this problem becomes more challenging since more noisy images are included and influence the retrieval performance.\nIn addition to measuring efficiency and accuracy, the detailed evaluation protocol is also a challenging question in large-scale medical image retrieval. Most of the traditional methods simply use class labels to evaluate the retrieval performance, which is not suitable for large-scale medical image databases, as they are most often not fully labeled and there can be different relevance expectations depending on the query images. Besides this, the data storage, access, organization, and computing techniques may also influence the retrieval performance of large-scale medical images. In this article, we review relevant methods and techniques that can tackle large-scale medical image retrieval."}, {"section_title": "Opportunities", "text": "Leaving aside the above challenges, large-scale image data brings unprecedented opportunities to the medical field. In 2014, Siemens released a report saying that the market for medical imaging systems will grow from 32.3 billion in 2014 to 49 billion in 2020 ( Siemens, 2016 ) . Without doubt, in the era of big data the development of large-scale medical analytics will accelerate this process. In a medical retrieval system, massive image data generally provides more samples for similarity search, which can improve the accuracy and reliability of the system . More importantly, it also facilitates the research of knowledge discovery and pattern exploration in biomedical informatics. We illustrate two major opportunities that benefit from large-scale medical retrieval, i.e., computer-aided diagnosis and visual pattern exploration:\n1. computer-aided diagnostics (CAD): CBIR methods have been proposed as an effective technology for CAD systems, which have the capacity of relieving the workload of doctors and to offer more reliable and consist analysis of medical images ( Akg\u00fcl et al., 2011; Depeursinge et al., 2011 ) . Despite most retrieval systems are not routinely used, CBIR based CAD are rather research prototypes for medical image analytics. Given an image database with diagnosis information, CBIR methods aim to retrieve and visualize images with morphological profiles most relevant to and consistent with the query image. This can provide decision support, for example for pathologists ( M\u00fcller et al., 2004; Kumar et al., 2013 ) . When the CBIRbased CAD systems meet large-scale image databases, this benefit is enlarged by searching more relevant images with finegrained content and morphologies. Retrieval results from largescale databases can help pathologists to have accurate and deep understanding of query images, when they are unsure about specific patterns. 2. visual pattern exploration: medical images contain a wealth of structures and patterns that may convey information about underlying mechanisms in biology ( Schindelin et al., 2012; Peng et al., 2010 ) . Generally, individuals with similar structures, shapes, morphologies will also express similar functions and properties, such as neurons, tissue cells, etc. ( Li et al., 2017a; Xing and Yang, 2016 ) . By establishing large medical databases of visual data, CBIR systems can be used to identify and explore unknown individuals based on the retrieval results. Massive image data are the basic requirement for such a medical exploration. As individuals usually have complex shapes and varieties in the images, large-scale databases can provide more reliable results for pattern exploration, as it is more likely that similar patients exist of which images were taken with similar protocols.\nLarge-scale image databases bring new opportunities to innovate the traditional medical retrieval systems, and some of the large-scale medical systems have already achieved good performance in clinical practice. In Section 6 , we review relevant applications of large-scale medical retrieval."}, {"section_title": "Feature representation", "text": "To achieve medical analytics from large-scale image databases, the first step is visual feature extraction, i.e., using feature vectors to represent each digital image. Generally, feature vectors are representing the low-level image content and can be linked to highlevel perceptions of the images. A good feature representation is the prerequisite to achieve good performance in medical image retrieval. In recent years, a variety of feature representations have been developed based on computer vision and machine learning. This section reviews recent advances in feature vectors in medical images. Specifically, the feature representation is classified into two categories, i.e., hand-crafted and learned features. This is mainly based on whether the features are obtained through domain expert knowledge (model-driven) or a purely data-driven procedures."}, {"section_title": "Hand-crafted features", "text": "Generally, hand-crafted features are sequentially extracted from each image according to algorithms based generally on expert knowledge. ( Antipov et al., 2015 ) , where each feature models a specific information such as color, texture or shape. Before the strong use of deep learning, hand-crafted methods dominated the feature extraction field for several decades. Most current medical retrieval systems still employ hand-crafted methods for feature representation. In this subsection, we review typical hand-crafted features that have been used in medical image retrieval.\nThe most widely used hand-crafted features for image retrieval are based on the Scale-Invariant Feature Transform (SIFT) ( Lowe, 2004 ) . SIFT detects scale-invariant key points by finding local extrema in the difference-of-Gaussian (DoG) space. It describes each key point by a 128-dimensional gradient orientation histogram. Subsequently, all SIFT descriptors are modeled/quantized using a bag-of-words (BoW) ( Sivic and Zisserman, 2003 ) . The feature vector of each image is computed by counting the frequency of the generated visual words in the image. SIFT is a local texture feature that has achieved success in medical image retrieval (e.g., it was the most popular feature in the ImageCLEF medical image retrieval task ). Besides SIFT descriptors, many local descriptors can use the BoWs to generate local features for medical images, such as SURF (Speeded Up Robust Features) ( Bay et al., 2008 ) , LBP (Local Binary Patterns) ( Ojala et al., 1996 ) and others. In contrast to features extracted locally, holistic features are also widely adopted in medical image retrieval. These kinds of features can directly represent the global information of the entire image. For example, GIST ( Oliva and Torralba, 2001 ) is a holistic feature which is based on a low dimensional representation of the scene that does not require any form of segmentation, and it includes a set of perceptual dimensions (naturalness, openness, roughness, expansion, ruggedness) that represent the dominant spatial structure of a scene ( Douze et al., 2009 ) . GIST has been applied in many medical image retrieval problems ( KalpathyCramer and Hersh, 2008; Liu et al., 2014a ) . Other holistic features such as HOG (Histogram of Gaussians) ( Dalal and Triggs, 2005 ) , color histograms ( Siggelkow, 2002 ) are also frequently used in medical image retrieval ( M\u00fcller and Deserno, 2010; Yu et al., 2013 ) . Table 1 lists some of the most commonly used hand-crafted features and their corresponding applications in medical image retrieval.\nIn addition to the common features mentioned above that can be used for the retrieval of both natural and medical images, there are many other hand-crafted features that are designed specifically for medical image data. In histopathology image analysis, the shape and texture information play an important role in the representation of cell/nuclei. Basavanhally et al. ( Basavanhally et al., 2010 ) designed three graph-based features, i.e., Voronoi diagram, Table 1 Commonly used hand-crafted features and their applications in medical image retrieval."}, {"section_title": "Method", "text": "Category Application SIFT ( Lowe, 2004 ) Local, texture Breast cancer , Basal-cell carcinoma ( Wang et al., 2011a ) , etc SURF ( Bay et al., 2008 ) Local, texture Lung CTs ( Haas et al., 2011 ) , Body portion ( Feulner et al., 2011 ) , etc LBP ( Ojala et al., 1996 ) Local, texture 2D-HeLa ( Nanni et al., 2010 ) , Brain MR ( Murala et al., 2012 ) , etc GIST ( Oliva and Torralba, 2001 ) Holistic, shape Mammogram ( Liu et al., 2014a ) , Breast-tissue ( Jiang et al., 2016a ) , etc. HOG ( Dalal and Triggs, 2005 ) Holistic, texture Cortical ( Unay and Ekin, 2011 ) , Lung ( Song et al., 2012 ) , etc Color Histogram ( Siggelkow, 2002 ) Holistic, color Organ ( Caicedo et al., 2007 ) , Dermatology ( Bunte et al., 2011 ) , etc. Moments ( Stricker and Orengo, 1995 ) Holostic, shape Multi-modalities ( Rahman et al., 2007 ) , Liver CT ( Gletsos et al., 2003 ) , etc. Gabor filters ( Manjunath and Ma, 1996 ) Local, texture Multi-modalities ( Lim and Chevallet, 2005 ) , Prostate Histopathology ( Doyle et al., 2007 ) , etc. Tamura ( Tamura et al., 1978 ) Local, texture Mammogram , Multi-modalities ( G\u00fcld et al., 2005 ) , etc. 3D Riesz ( Chenouard and Unser, 2011 ) Local, texture Epileptogenic Lesion ( del Toro et al., 2013 ) , 3D Multi-modalities ( Jim\u00e9nez-del , etc\nDelaunay triangulation, and minimum spanning tree, to describe the arrangement of the lymphocytes. Filipczuk et al. (2013) employed 25 kinds of features to represent cytological images, including the size of the nuclei, the texture features based on graylevel pixels, and the distribution of nuclei in the image. In general, these specific features are more discriminative than the general hand-crafted features. They achieved good performance in the detection, retrieval and analysis of cells and nuclei ( Xing and Yang, 2016 ) . Besides the histopathological images, specific features are also widely used for the representation of 3D medical image data, such as 3D brain tumors, neuronal morphology. For example, Cai et al. (2010) developed PCM-based volumetric texture features for 3D neurological image retrieval, and Wan et al. (2015) employed quantitative measurements and geometrical moments as features to represent the 3D neuron morphological data. Both achieved good performance in the retrieval task. A more general system that creates many quantitative measurements of the brain including shape features is FreeSurfer ( Fischl, 2012 ) . In order to achieve better retrieval performance, many researchers employ multiple hand-crafted features and combine them to represent each image. For example, Song et al. (2012) employed HOG and LBP features for retrieval and to recognize lung lesions. In general, combining multiple features (e.g., local and holistic features, common and specific features) obtains better performance compared with single feature systems ( Lisin et al., 2005; Zhang et al., 2016a ) . Many groups in the ImageCLEF medical retrieval tasks have adopted this strategy ( Simpson et al., 2012 ) . However, when dealing with massive amounts of medical images, the combined features are often too large for scalable retrieval and may adversely affect the retrieval efficiency. Although a variety of features has been discussed above, for the medical retrieval problem, there are no universal features that are suitable for all kinds of medical images. This is the case, as medical images are generated by different imaging techniques and tissues/organs usually have specific colors, textures and shapes. Even for the same tissue/organ, features may visually differ under multiple dimensions and modalities ( Kumar et al., 2013 ) . Therefore, employing suitable hand-crafted features for a given kind of image data is an important and challenging step during medical retrieval. Feature selection can also be a step to create a subset of the features for a specific task.\nDespite hand-crafted features having achieved many good results in medical image retrieval, they have shortcomings when tackling large-scale medical data:\n1. Hand-crafted features need expert knowledge but expert knowledge usually does not work well when the dataset is large as there may be outliers and cases not covered by standardized rules;\n2. Feature extraction using hand-crafted methods is timeconsuming and computationally expensive, especially when dealing with massive amounts of images; 3. Many hand-crafted methods are only designed for specific medical data and can not be extended to other domains.\nAccordingly, more automatic, efficient and extensible feature representation methods are required for the large-scale medical retrieval.\nTaxonomy Application PCA Hashing ( Gong and Lazebnik, 2011; Yu et al., 2013 ) Unsupervised Linear Multi-modality images ( Yu et al., 2013 ) Kernelized Hashing Supervised Nonlinear Brest histopathology Cell-level histopathology ( Zhang et al., 2015d ) Composite Hashing ( Liu et al., 2011; Gong et al., 2013 ) Unsupervised Nonlinear Digital mammogram ( Liu et al., 2016b ) Hashing Forest ( Conjeti et al., 2016a ) Unsupervised Linear Neuron morphology ( Mesbah et al., 2015; Yu and Yuan, 2014 ) MIPS Binary Coding Unsupervised Nonlinear Neuron morphology ( Li et al., 2017a ) Deep Autoencoder ( Vincent et al., 2010; Sze-To et al., 2016 ) Unsupervised Nonlinear X-ray images ( Sze-To et al., 2016 ) i.e., linear and nonlinear. Linear hashing functions separate and map the original feature space with simple projections (as shown in Fig. 7 , { h 1 , h 2 , . . . , h K } ). They are computationally efficient and easy to optimize ( Gong et al., 2012; Trzcinski and Lepetit, 2012; He et al., 2012 ) . However, linear hashing functions can not handle the situation when the difference among image data are subtle and linearly inseparable. Thus, nonlinear hashing was developed to override such limitations. Such methods learn hashing functions based on kernel matrixes or manifold structures and can embed the intrinsic structure in a high-dimensional space and nonlinearly map feature vectors into binary codes ( Kulis and Grauman, 2012; Liu et al., 2012; Shen et al., 2015c ) . Table 2 summarizes the existing hashing-based medical retrieval methods, as well as their corresponding taxonomies and applications. According to Table 2 , both supervised and unsupervised, linear and nonlinear hashing methods have been developed for medical retrieval. In this subsection, we briefly review the above hashing methods and also discuss their advantages and drawbacks."}, {"section_title": "Learned features", "text": "In recent years, deep learning has become a hot topic and has achieved very good results in feature representation, image classification, retrieval, detection and other related fields. Compared with hand-crafted methods using domain expert knowledge, deep learning requires only a set of training data that allows to discover the feature representations in a self-taught manner ( Bengio, 2009; LeCun et al., 2015 ) . For the learned feature representation, a variety of deep neural networks are designed nonlinearly and hierarchically, i.e., mapping features from fine to abstract with multiple layers of neural networks (e.g., tens to hundreds) and a large number of parameters (e.g., thousands to millions) . In general, the prevalence of deep learning mainly benefits from the availability of large training data sets that make it possible to optimize the parameters. Accordingly, due to the availability of current large-scale medical image databases, deep learning can also be adopted to solve analytics tasks of medical images. Specifically, both supervised and unsupervised deep neural networks have been explored for creating feature representations of medical images. Fig. 4 illustrates a general framework of a supervised deep neural network, i.e., a Convolutional Neural Network (CNN) ( LeCun et al., 1998 ) . The input images with fixed size are convolved with multiple learned kernels using shared weights. Then, the pooling layers down-sample the input representation nonlinearly and preserve the feature information in each sub-region. Afterwards, the extracted features are weighted and combined in the fully-connected layer, and these features are sent to a predefined classifier for prediction. Finally, by comparing the output class with the image label, the CNN parameters (e.g., kernels, weights, bias) are updated in each iteration. Recent results, as on the ImageNet Large Scale Visual Recognition Challenge (ILSVRC) Russakovsky et al. (2015) have shown the excellent performance of very deep neural networks, where more convolution, pooling and fully connected layers are employed than before, and more complicated network structures are developed, e.g., AlexNet ( Krizhevsky et al., 2012 ) , GoogLeNet ( Szegedy et al., 2015 ) , VGG Net ( Simonyan and Zisserman, 2015 ) and ResNets ( He et al., 2016 ) .\nSupervised deep neural networks require a large amount of labeled images to train the parameters in each layer. However, in the medical field, the amount of labeled images is typically limited. Simply training deep neural networks from scratch using smallsized labeled data can easily result in overfitting ( Srivastava et al., 2014 ) . Thus, researchers have proposed several methods to accommodate medical image analysis with deep neural networks. For example, Bar et al. (2015) learned features for chest pathology detection using a Decaf pre-trained CNN model ( Donahue et al., 2014 ) , and the parameters are trained from non-medical datasets such as ImageNet ( Deng et al., 2009 ) . In ImageCLEFmed 2016, NovaSearch adopted CNN models that are trained from scratch using only the provided medical data ( Semedo and Magalh\u00e3es, 2016 ) . They employed several techniques (e.g., Dropout ( Srivastava et al., 2014 ) , data augmentation) to deal with the unbalanced and small data sets. According to Shin et al. (2016) , there are three major techniques that can successfully learn feature representation of medical images through CNNs:\n1. Pre-training the CNN model on natural images and fine-tuning on medical target images; this technique has been used for lung images ( Schlegl et al., 2014; Hofmanninger and Langs, 2015; Li et al., 2014a ), brain MRI ( Li et al., 2014b ) , etc.; 2. Training the CNN model from scratch using only medical images, and employing several measures to avoid overfitting; this technique has been used in cardiac CT ( Wolterink et al., 2015 ) , on lung nodules ( Shen et al., 2015d ) , etc.; 3. Using a pre-trained CNN model to extract features, employing these features as complementary information and combining them with hand-crafted features; these combined features have been used on chest X-rays ( Bar et al., 2015 ) , pulmonary perifissural nodules ( Ciompi et al., 2015 ) , etc.\nAlthough supervised deep neural networks have demonstrated excellent performance in feature representation, they require a large amount of manually labeled training data. However, unlike the annotation of natural images that is easy to achieve, the labels of many medical images can only be annotated by physicians or domain experts, which is expensive. In many cases, the ground truth labels are simply unavailable, as the exact patterns of some abnormalities are still unidentified or very subjective in nature (e.g., neuron images, precise tumor regions). To overcome the limitations of supervised feature learning, multiple unsupervised deep neural networks have been proposed for feature representation ( Bengio et al., 2012 ) . Fig. 5 illustrates a typical unsupervised neural network, i.e. an Auto-Encoder ( Bourlard and Kamp, 1988 ) . Given the input images X m , it learns the feature representations h (2) by minimizing the reconstruction error between the input and the output, i.e., Y m \u2248 X m , which indicates the decoder results should approximate the input. Despite the single layer auto-encoder being too shallow to learn features, the representation power improves significantly when several auto-encoders are stacked to form deep stacked auto-encoders (SAEs). selection method using a convolutional stacked auto-encoder to identify intrinsic deep feature representations in image patches. The method is demonstrated on 7.0-tesla brain MR images, validating that unsupervised feature learning is effective for brain MR registration. Besides this, Shin et al. (2013) employed stacked autoencoders for unsupervised feature learning and organ identification in magnetic resonance images, where visual and temporal hierarchical features are learned to categorize object classes from an unlabeled multimodal DCE-MRI data set ( Collins and Padhani, 2004 ) .\nIn addition to auto-encoders, restricted Boltzmann machines (RBM) Smolensky (1986) can also construct unsupervised deep neural networks, e.g. deep belief networks ( Hinton and Salakhutdinov, 2006 ) and deep Boltzmann machines ( Salakhutdinov, 2015 ) . These deep neural networks are also the common choice to tackle medical feature representations and other medical analytics tasks. For example, Brosch et al. (2013) performed manifold learning by reducing the dimensionality of brain images using a deep belief network that can discover patterns of similarity in groups of images. Cao et al. (2014) developed a multimodal approach for medical image retrieval that is based on deep Boltzmann machines. Experimental results demonstrate that the new deep Boltzmann machine-based multimodal learning model is a promising solution for next-generation medical image indexing and retrieval systems.\nFor large-scale medical image analytics, learned feature representations are a clear trend, since more and more images are available to train the deep neural networks. However, the usage of deep learning for medical image retrieval is not frequent. One reason is that previously most medical image retrieval tasks only had to tackle small-sized data sets (e.g., hundreds to thousands of images at the most), which does not allow the training of deep neural networks. The other reason is that for some specific medical images the hand-crafted features designed by domain experts can achieve very good performance when the data sets are not too large (e.g., the holistic features of histopathological images"}, {"section_title": "Training Images", "text": "Hierarchical Clustering Vocabulary Tree ..."}, {"section_title": "Score Ranking Retrieval Results", "text": ""}, {"section_title": "Query Image", "text": "Training Phase Query Phase Fig. 6 . A framework for vocabulary tree based image retrieval. ( Basavanhally et al., 2010 ) ). Due to the multi-modality, complexity (e.g., diverse medical imaging techniques, complex structures and morphology of tissues/organs) and also quickly changing image acquisition devices, the specified hand-crafted features are still useful in many medical image retrieval scenarios. Additionally, the deeplearning based methods are capable to learn different types of features compared with hand-crafted methods. Thus the learned features also play a critical role in the feature representation of medical images, particularly when the data sets are large. In the Image-CLEF Challenges ( Garc\u00eda Seco de Herrera et al., 2016 ), many groups employed both learned features and hand-crafted features to represent medical images. Then, these features are fused for more accurate retrieval and classification results."}, {"section_title": "Feature indexing and search", "text": "After feature extraction, each image is represented by a feature vector. The medical image retrieval problem can now be treated as a nearest-neighbor search among these feature vectors, i.e., computing and ranking the distance between the query image(s) or volume(s) and all images in the databases. However, when handling large-scale databases, exhaustive search among long feature vectors is time-consuming. Sequentially computing the distance of millions of high-dimensional feature vectors is unfeasible. In this section, we review recent advances that can efficiently and accurately tackle feature indexing in large-scale medical retrieval."}, {"section_title": "Vocabulary tree", "text": "The vocabulary tree was first proposed by Nist\u00e9r and Stew\u00e9nius ( Nister and Stewenius, 2006 ) . It is widely used for scalable image retrieval ( Wang et al., 2011b; Zhang et al., 2015b ) . It builds a tree-structure to accelerate similarity indexing. Compared with traditional methods based on exhaustive search of image features, vocabulary tree based methods employ a hierarchical tree and inverted files that can significantly improve the retrieval efficiency. Fig. 6 presents the framework of vocabulary tree based image retrieval. The framework can be divided into two phases, i.e., the training phase (offline) and the query phase (online). The training phase builds the indexing model (hierarchical tree-structure) from given image sets and the query phase returns images that are similar to the query image.\nTraining Phase : For a set of training data, vocabulary tree methods first detect key points in each image (denoted as the cyan circles in Fig. 6 ). The key points can be defined as corners with scale and rotation invariance, as well as interest points specified by domain experts. Subsequently, these key points are represented by local feature vectors (e.g., SIFT ( Lowe, 2004 ) ), and the descriptors from all training images are collected for hierarchical k -means clustering. Specifically, instead of defining k as the final number of clusters, k is defined as the number of children centers in each cluster. After L recursive clustering, a tree-structure of depth L and branch factor k is built, where each tree node (also referred to as the visual word) corresponds to a cluster center. Each leaf node includes several key points that are close to each other visually. Accordingly, all images in the database are added to inverted files attached to the leaf nodes with respect to their corresponding key points. Afterwards, the vocabulary tree-structure and the inverted file are used for the indexing of the images.\nQuery Phase : Given a query image q , its key points are extracted and set as the input in the vocabulary tree. By comparing with nodes in each hierarchy, each key point can reach a leaf node attached to an inverted file. As each inverted file records images relevant to the leaf node, the similarity scores can be computed between q and the images in corresponding inverted files. Normally, the term frequency-inverse document frequency (TF-IDF) Salton and Buckley (1988) is adopted as the similarity score to balance the importance of a visual word to an image in a collection. By ranking all the similarity scores in descending order, the top ranked images can be considered as the retrieval results. Unlike previous methods simply comparing the similarity of all the key points between two images, vocabulary tree methods construct the hierarchical tree-structure and index similar images using the inverted files. For each key point vector, only a total of kL dot products are needed, which is very efficient if k is not large. More importantly, the inverted file strategy can significantly improve the indexing process since it does not need to traverse the whole image database.\nVocabulary trees and its variants have been applied for largescale medical image retrieval. They do not only improve the computational efficiency but are also often more accurate compared with traditional retrieval methods. For example, Jiang et al. (2015a Jiang et al. ( , 2015c proposed an adaptive weighting strategy in the vocabulary tree based framework to tackle mammogram image retrieval. As the features with high frequencies in a mammogram are less informative than those with low frequencies, to avoid overcounting, they incorporate mammogram-specific node frequencies into the IDF scheme to down-weight the high-frequency features. The adaptive weighting technique is very effective to retrieve these specific images, i.e., mammographic masses. Wang et al. (2015) designed a discriminative and generative vocabulary tree for the authentication and recognition of finger vein images. This method considers both the discriminative appearance of local image patches and their generative spatial layout. The training process remains the same as building a conventional vocabulary tree, while the prediction process uses a proposed point set matching method to support non-parametric patch layout matching. This joint discriminative and generative model can achieve good performance in finger vein images, since the employed vocabulary tree model can retain the efficiency for the whole system. More importantly, the point set matching strategy considers the geometrical layout of local image patches, which is more accurate compared with previous vocabulary tree based methods that only consider the description of local key points.\nBy changing the similarity indexing strategy, vocabulary tree based methods have achieved efficient retrieval in large-scale databases. As these kinds of methods directly employ local feature descriptors instead of the global features, it can be applied to most medical images, including both 2D and 3D images where local key points can be detected and described. However, vocabulary tree based methods also have several limitations. For example, simply using local features is not enough to represent and discriminate some specific medical types of images, e.g., for some lung images, the global shape should be considered during retrieval. In addition, the training phase in building the hierarchical vocabulary tree is usually time-consuming, especially when tackling very large image databases (search on a database with millions of images). In practical applications, to achieve good results, vocabulary tree based methods also rely heavily on parameter tuning, i.e., the number of each cluster center k , total levels of the hierarchical tree L . Thus, more efficient and accurate methods need to be developed for large-scale medical image retrieval."}, {"section_title": "Hashing", "text": "In recent years, hashing methods have been intensively investigated in the machine learning and computer vision fields for indexing big data . Instead of directly searching nearest neighbors from an original data set, hashing methods first compress the original data into short binary codes (e.g., tens to hundreds of bits) based on the defined hashing functions. Then, the nearest-neighbor search is more efficient by computing the similarity distances in binary Hamming space rather than in the high-dimensional feature space. Fig. 7 presents the framework of hashing-based image retrieval. Assuming we have n medical images in the database, after feature representation these n images are represented by d dimensional feature vectors, i.e., X = { x 1 , x 2 , . . . , x n } \u2282 R d\u00d7n (denoted as the blue points in Fig. 7 ). For the image x i \u2282 R d\u00d71 , its feature space can be split by a set of hashing functions"}, {"section_title": "Hashing frameworks", "text": "R d\u00d7K , and each hashing function encodes x i into one bit of binary code h k ( x i ). Therefore, the corresponding K bits of binary code of x i can be denoted as:\nIn practice, for computational convenience, the above hashing functions are usually substituted by the projected matrix w \u2282 R d\u00d7K and the intercept vector b \u2282 R K\u00d71 :\nwhere f ( \u00b7 ) is a pre-specified function that can be linear or nonlinear. Then, all images in the database are represented by the mapped binary codes. The query image x q (denoted as the red point in Fig. 7 ) can also be mapped into binary codes through Eq. (2) . Subsequently, the similarity search between the query and each image in the database is transformed as the Hamming distance ranking of their corresponding binary codes, which is very fast. The key question of hashing methods is how to obtain good hashing functions that can not only split the feature space via binary encoding but also keep similarities and diversity among the original data."}, {"section_title": "Categories of hashing methods", "text": "The methods to compute hashing functions can be roughly divided into two categories, i.e., data-independent and datadependent. Data-independent methods usually design generalized hashing functions that can compact any given data set into binary codes. Locality-Sensitive Hashing (LSH) and its variants are the most popular data-independent methods ( Gionis et al., 1999; Kulis et al., 2009; Raginsky and Lazebnik, 2009 ) . LSH-based methods compute hashing functions via maximizing the probability of collision for similar items, which can keep the originally nearby data points mapping into the same bit with high probability. However, this type of method often needs long binary codes and many hashing functions to ensure the desired retrieval precision, which dramatically increases the storage costs and the query time. More importantly, as these hashing functions are designed independently from the training data sets, it is hard to ensure the retrieval performance for any given data set.\nAnother category are the data-dependent methods (also called learning to hash methods) that learn the hashing functions from a given training data set. In general, compared with dataindependent methods, data-dependent methods can achieve comparable or even better retrieval accuracy with shorter binary codes. Currently, many learning-based hashing methods have been applied for large-scale medical image retrieval, including but not limited to, Iterative Quantization (ITQ) ( Gong et al., 2013 ) , KernelBased Supervised Hashing (KSH) , Anchor Graph Hashing (AGH) ( Liu et al., 2011 ) , Asymmetric Inner-product Binary Coding (AIBC) and others. Accordingly, the taxonomy of data-dependent hashing methods can be defined in multiple viewpoints. For example, based on whether the training data sets have labels or not, hashing methods can be divided into supervised, unsupervised and semi-supervised methods. Supervised methods employ advanced machine learning techniques such as kernel learning, metric learning, and deep learning to compute the hashing functions from labeled training data. Many supervised hashing methods have achieved good performance since they can shorten the semantic gap between the compacted binary codes and the image labels ( Gordo et al., 2014; Norouzi et al., 2012; Fan, 2013; Shen et al., 2015b ) . Without label information, unsupervised methods explore the properties of training data sets such as distributions and manifold structures to design effective hashing functions. Representative methods include spectral hashing ( Weiss et al., 2009 ) , graph hashing ( Liu et al., 2014b ) , manifold hashing , etc. Additionally, semi-supervised methods design hashing functions using both labeled and unlabeled data. These kinds of methods can improve the binary encoding performance by leveraging semantic similarity with limited image labels while remaining robust to overfitting ; Jain et al., 20 08; 20 09 ). Another taxonomy of datadependent methods is based on the form of the hashing functions, Table 2 Existing hashing based large-scale medical image retrieval methods with their taxonomies and applications."}, {"section_title": "Methodology review", "text": "PCA Hashing ( Yu et al., 2013 ) : it first linearly projects raw image features into uncorrelated dimensions via Principal Component Analysis (PCA), where each new feature dimension is orthogonal to each other. Then, it learns the hashing function (i.e. a rotation matrix) by minimizing the binarization error between the new feature matrix and the corresponding binarized feature matrix ( Gong and Lazebnik, 2011 ) . PCA Hashing demonstrates high computational efficiency and comparable retrieval precision compared with traditional feature-based nearest-neighbor search. However, since both PCA projection and hashing function optimization are linear, PCA hashing cannot achieve good performance when tackling medical images that are complex (e.g., image differences are subtle, the feature space is not linearly separable).\nKernelized Hashing : for most medical images, linear inseparability is a critical constraint that needs to be taken into account during large-scale retrieval. To tackle this challenge, Kernelized Hashing considers the hashing function with kernels, since kernel methods can map the feature vectors into a highdimensional space and make the linearly inseparable images easy to differentiate. Accordingly, the learned binary codes from kernelized hashing are also able to differentiate com plex medical images. In addition, Kernelized Hashing designs a supervised framework by collaborating kernel functions with medical labels (e.g., labeling the histopathological image with benign or malignant). The supervised information significantly boosts the retrieval performance since it can bridge the semantic gap between low-level features and high-level clinical analytics.\nComposite Hashing ( Liu et al., 2016b ) : this algorithm can generate more effective hash codes by integrating global features (e.g. GIST ( Oliva and Torralba, 2001 ) ) and local features (e.g. SIFT ( Lowe, 2004 ) ) with different distance metrics. In general, single types of features can not comprehensively represent a medical image. On the other side, simply combining multiple features may also fail to achieve accurate image retrieval, since each type of feature has its specific meaning and representation. Thus, Composite Hashing improves the Anchor Graph with multiple features and fuses them by distance metric and local manifold. Then, it learns the hashing function using iterative quantization.\nHashing Forests ( Conjeti et al., 2016a ) : this approach learns binary codes by training independent hashing trees. For the internal node in each tree, locality preserving projections are employed to project data into a latent subspace, where separability between dissimilar points is enhanced. For each input image, each trained tree generates several bits of binary codes, and the combination of these binary codes in the forest is used to represent the input image. Additionally, it employs an inverse-lookup search scheme to improve the efficiency of similarity comparisons. Hashing Forests can generate any given length of binary codes, which is particularly suitable for low-dimensional image features.\nMIPS Binary Coding ( Li et al., 2017a ) : as demonstrated in , the Hamming distance and the inner code product have a one-to-one correspondence. Thus, unlike the above methods based on the Hamming distance metric, MIPS (Maximum Inner Product Search) Binary Coding introduces a new objective based on the inner code product, which is more likely to learn non-linear hashing functions. Specifically, by adopting an alternative iteration strategy, it learns two asymmetric hashing functions for the image database and the query image, respectively. This strategy can make the inner product based objective easy to optimize. It also promotes the hashing functions to map binary codes into a high-dimensional non-linear space.\nDeep Autoencoders ( Sze-To et al., 2016 ): this algorithm employs deep architectures to hash medical images into binary codes without class labels. Specifically, it uses a specific unsupervised deep architecture, namely deep de-noising autoencoders (DDA) ( Vincent et al., 2010 ) to enhance feature learning and binary coding with four steps: image pre-processing, unsupervised layer-bylayer training, unsupervised fine-tuning with dropout, and decoder removal. Finally, a threshold ( > 0.5) is applied on the real-valued feature vectors to obtain binary codes. Deep Autoencoders learn binary codes without using any supervised information, which is suitable for medical images where labels are hard to obtain. When using hashing methods to tackle large-scale medical image retrieval problems, we should not only focus on the hashing methods itself but also need to consider their possible adaptations for different medical image data sets. When the annotation of all medical images in data sets are available, supervised hashing methods are more suitable and are generally more accurate than unsupervised and semi-supervised hashing. For example, Kernel-Based Supervised Hashing (KSH) , Supervised Discrete Hashing (SDH) ( Shen et al., 2015b ) , Deep Supervised Hashing (DSH) ( Liu et al., 2016a ) can achieve excellent performance in many public data sets. However, in many cases when the medical image annotations are not easy to acquire, semi-supervised/unsupervised hashing is a more reasonable choice (e.g., Discrete Graph Hashing (DGH) ( Liu et al., 2014b ), MIPS , Semi-Supervised Hashing (SSH) ). In addition, for some medical images that are not easy to differentiate, non-linear hashing methods can usually achieve much better retrieval performance, such as Inductive Manifold-Hashing (IMH) , AGH ( Liu et al., 2011 ) , despite training non-linear hashing functions being more timeconsuming than training linear hashing functions."}, {"section_title": "Other methods", "text": "Besides the vocabulary tree and hashing, there are many other methods that have been designed to tackle the feature indexing of large-scale medical image databases. These methods can be either accelerating the similarity search or improving the retrieval accuracy. We briefly introduce and discuss these methods."}, {"section_title": "Feature compression", "text": "Indexing in large medical databases is usually very timeconsuming, especially when the images are represented by high dimensional features. To accelerate the indexing process, one kind of methods is feature compression, which can compress long image features into a smaller size. Hashing belongs to the category of feature compression that is discussed above. In addition to hashing, many other compression methods have been employed for efficient medical image retrieval.\nPrincipal components analysis (PCA) is one of the most popular method for feature compression. After feature extraction, medical images can be represented by single or multiple feature vectors that have high dimension. Many medical image retrieval methods have employed PCA to reduce the feature dimensionality. For example, Tian et al. (2008) first presented a global and local texture feature combination for the description of medical images. Then, they adopted PCA to reduce the dimension of the combined features. In the analytics of histopathological images, Sertel et al. (2009) introduced a novel color-texture analysis approach that combines a model-based intermediate representation with low level texture features. Then, PCA and LDA (linear discriminant analysis ( Fukunaga, 2013 ) ) are employed for feature dimensionality reduction. PCA-based medical image retrieval can significantly reduce the feature dimensionality and usually demonstrates comparable performance with the methods using the original features.\nIn addition to PCA, multiple methods have been proposed for medical feature compression in recent years. In FoncubiertaRodr\u00edguez et al. (2013) , presented a medical image retrieval method using a bag of meaningful visual words. As visual vocabularies are often redundant, over-complete and noisy, they presented a pruning technique based on probabilistic latent semantic analysis (PLSA) ( Hofmann, 2001 ) . The PLAS pruning can enormously reduce the feature dimension when describing a medical image data set with no significant effect on accuracy. More recently, Lan and Zhou (2016) proposed a simple yet discriminant feature, called histogram of compressed scattering coefficients (HCSCs) for medical image retrieval. They first performed a particular variation of deep convolutional networks, i.e., the scattering transform, to yield high dimensional features. Then a compression operation is carried out on the obtained coefficients for a dimensionality reduction."}, {"section_title": "Re-ranking", "text": "After the similarity indexing through feature compression and other large-scale methods, a set of top ranked medical images can be efficiently computed based on a distance measure. However, these retrieved images may not always correspond to what a human would want and the retrieval precision can vary strongly using different features. Therefore, re-ranking of the coarse results is expected to further improve the retrieval performance for more accurate retrieval. Particularly, re-ranking methods can reorder the initially retrieved images to move the most relevant images to the top or optimise diversity in the top results.\nIn recent years, multiple methods have been proposed for reranking in different image retrieval applications. In the medical domain, based on the information employed for re-ranking, the reranking methods can be roughly divided into three categories, i.e., textual-visual based, multi-feature based and user-feedback based. In the following, we briefly review relevant articles about the three categories respectively:\n1. Textual-visual based: these kinds of methods first retrieve relevant medical images through textual indexing, then the initial results are re-ranked by considering the visual similarity.\nTextual-visual based re-ranking was adopted by many groups in the ImageCLEF medical image retrieval tasks. For example, introduced their work at Image-CLEF 2009. They first leveraged textual data to search relevant images in three domain dimensions, anatomy, pathology and modality. Then, they employ the visual data to re-rank the document lists based on the extracted features, including a color and intensity histogram, gray-level co-occurrence matrices and other features. Besides this, Depeursinge and M\u00fcller (2010) described several fusion techniques for combining textual and visual information that were used in ImageCLEF. 2. Multi-feature based: this kind of method first computes the retrieval results from multiple kinds of features, then the final results are obtained by fusing and re-ranking the above retrieved images. Recently, Zhang et al. (2016a) presented a method for histopathology image analysis by re-ranking the results from multiple features. Specifically, after obtaining several top ranked relevant images from multiple kinds of features, they employed a graph-based query-specific fusion approach where multiple retrieval results are integrated and re-ordered based on a fused graph . In general, such re-ranking methods can significantly improve the retrieval performance since they consider the image similarity and discrimination from several viewpoints using multiple features, e.g., local and holistic features. 3. User-feedback based: after receiving the initial results, this kind of method re-ranks the retrieved images based on relevance feedback from users. The relevance feedback can specify which image is relevant/irrelevant. Agarwal and Mostafa (2011) employed the user-feedback based re-ranking for the Alzheimer's disease detection. They first described a content-based image retrieval system, i.e., ViewFinder Medicine (vfM), to combine visual and textual features for initial indexing. Then the retrieval system employed the user-provided feedback to perform re-ranking, including inter-session and intra-session re-ranking. This re-ranking process improved the system precision from 0.8 to 0.89. The importance of negative feedback in this process is highlighted in ( Muller et al., 20 0 0 ) .\nIn most cases, re-ranking methods are only required to consider the top ranked initial retrieval results, e.g., most truly relevant images are included in the top-K results, and K is much smaller than the number of images in the whole database. Therefore, re-ranking can be very efficient as it only needs to process a few images. More importantly, by considering and comparing the similarity using multiple information sources, the retrieval precision can be improved for further exploration and analysis."}, {"section_title": "High-performance computing", "text": "In addition to the above large-scale methods which belong to the fields of image processing, computer vision and machine learning, High-performance Computing (HPC) also plays an important role in medical image analytics. HPC is the use of parallel processing techniques to execute programs efficiently, reliably and quickly. The HPC techniques include parallel computing, distributed computing, cloud computing, etc. that are useful for tackling large databases. Particularly in the medical field, some large databases are usually stored in different locations and they are essential to be processed based on parallel systems.\nRecently, HPC techniques have been widely employed for the large-scale medical retrieval. Foran et al. (2011) proposed a software system based on parallel and distributed computing, namely ImageMiner, to efficiently retrieve and analyze the expression patterns of tissue microarrays (TMAs). The ImageMiner system embedded a data analysis component for efficient retrieval, i.e., DataCutter ( Kumar et al., 2006 ) , which the data processing pipeline can be composed as a network of interacting components. Images received by ImageMiner were distributed and processed by the computation cluster using a master-slave parallelization scheme. Subsequently, Qi et al. (2014) investigated large-scale histopathological image retrieval using the CometCloud ( Kim et al., 2011 ) , an automatic cloud framework that allows dynamic, on-demand federation of distributed infrastructures. They first formulated the histopathological image retrieval problem as a set of heterogeneous and independent tasks. Then these tasks can be parallelized and solved using the aggregated computational power of distributed resources. More recently, Markonis et al. (2012) proposed solutions for the large-scale medical image analysis based on parallel computing and algorithm optimization. Specifically, a MapReduce framework is employed to speed up the medical image analysis in three tasks, i.e., lung texture segmentation using support vector machines, content-based medical image indexing and 3D directional wavelet analysis for solid texture classification.\nHigh-performance computing can well be used to handle largescale retrieval tasks, especially for clinical systems, where the parallelized processing can achieve similarity retrieval in real-time. More importantly, as presented in Fig. 1 , high-performance computing can be adopted in both the feature extraction/indexing and retrieval, which can dramatically improve the retrieval efficiency in these time-consuming steps."}, {"section_title": "Evaluation", "text": "After receiving similar samples from medical image retrieval systems, evaluating the retrieval performance and the whole retrieval system are also critical tasks. Especially for large-scale medical image sets, simply using class labels is usually not adequate to evaluate the retrieval performance in fine-grained levels. In the past decades, challenges and tasks such as ImageCLEF, VISCERAL, etc. have made great effort s f or the evaluation of medical image retrieval ( Kalpathy-Cramer et al., 2015; Langs et al., 2012 ) . This section reviews related work of evaluation protocols which are relevant to medical image retrieval, including evaluation measures, criteria, and public medical image data sets."}, {"section_title": "Evaluation measures", "text": "We first introduce the evaluation measures for medical image retrieval that can provide a quantitative analysis, comparison, and validation of different retrieval methods. In general, the evaluation measures in large-scale medical image retrieval are similar with the measures in generic information retrieval, i.e., evaluating the precision, recall, efficiency and several other measures.\nPrecision: retrieval precision is the main indicator for performance evaluation, which can be denoted as the fraction of the images retrieved that are relevant to the query image:\nIn information retrieval, precision can evaluate the capability of a method for searching similar or relevant samples. It has also been widely used for the evaluation of medical image retrieval methods, especially for some medical analytical tasks where the image used as query can be better interpreted with similar/relevant images ( Li et al., 2017b; Zhang et al., 2015d; . This is similar to asking a colleague for help or searching similar images/patterns in books. Besides precision, mean average precision (MAP) is most commonly used for the evaluation of retrieval methods and for the comparison of search in large-scale medical image sets. MAP is relatively stable and include aspects of precision and recall, as it averages over positions of all relevant items. It is defined as the mean of the average precision scores of all relevant items of a query averaged over all queries. The MAP can be formulated as:\nwhere M is the number of query images (i.e., testing data), K indicates the top-K ranked relevant images for each query image, and Q m, k denotes the top-k retrieval precision of the m th query image. For large-scale retrieval methods, the MAP can evaluate their performance with massive testing data (e.g., hundreds to thousands of query images), and thus alleviate the bias during precision evaluation. Recall: in image retrieval, recall is the fraction of relevant retrieved images with all relevant images in databases, i.e.:\nRecall reflects the sensitivity of a retrieval system, i.e., whether it can completely find all relevant samples in top-K ranked results, keeping K as small as possible. Thus, for medical retrieval tasks that need to find all relevant samples for analysis (such as a systematic review), recall is a critical evaluation criterion. Normally, recall is associated with precision, i.e., precision-recall curve, for the evaluation and comparison of different retrieval methods with a global view on the performance ( M\u00fcller et al., 2001; Davis and Goadrich, 2006 ) . Efficiency: as directly indexing massive images with high dimensional features are usually very time-consuming, one important evaluation indicator for large-scale retrieval is efficiency. Currently, in most large-scale retrieval cases, efficiency is denoted as the time for the feature indexing phase, i.e., given a query image (or its features), the time for returning a set of relevant images after searching in large-scale databases. For medical image retrieval with many testing images, their accumulated and average run time are the commonly used efficiency measures, where the average run time can be formulated as\nt m, K indicates the time cost of retrieving K relevant images for the m th query image. The average/accumulated run time has been widely adopted for the evaluation, comparison and validation of large-scale medical image retrieval ( Jiang et al., 2015c; Zhang et al., 2015d; Jiang et al., 2016a ) . Still, run times need to be put in relationship to hardware resources available and are thus not always easy to interpret. Sometimes the run time for the offline parts (data indexation) and the online parts (interactive search) are separately compared. Additionally, there are several other commonly employed measures for medical image retrieval evaluation. For example, the precision after the first N R images are retrieved (i.e., P ( N R )), recall at 0.5 precision, rank first relevant, etc.). These measures were discussed in previous articles ( M\u00fcller et al., 2001; Muller et al., 2004 ) ."}, {"section_title": "Evaluation criteria", "text": "In addition to evaluation measures, the criteria of deciding similarity/relevance are also important and challenging tasks in largescale medical image retrieval. Here, we introduce two kinds of evaluation criteria: annotation-based and user-based, which are the commonly employed criteria in medical image retrieval.\nAnnotation-based Criteria: when class labels of medical images are available, their annotations are a commonly used evaluation criterion. As the class labels of all medical images in the database are provided, the similar or relevant images can be determined quickly by comparing their class labels. Thus, given testing images, the retrieval precision and recall can be measured by sequentially comparing the labels between each test image and the retrieved images. Currently, several large-scale medical image retrieval cases adopted annotation-based criteria for performance evaluation. For example, Zhang et al. (2015d) evaluated the large-scale histopathological image retrieval through the class label of two type lung cancers (i.e., adenocarcinoma and squamous carcinoma) for each image. The annotation-based evaluation criteria are only suitable for the cases that image classes are identified and the similarity of images are simply determined by class labels.\nUser-based Criteria: despite the annotation-based criteria being a simple way for retrieval evaluation, it may not suitable in many practical cases of large-scale medical image retrieval. One reason is that the annotation of medical images is usually hard to obtain. Some medical images are still classified and do not have unified classification rules. Moreover, annotating every medical image in large databases is extremely labor expensive,time-consuming, and sometimes impossible. Another reason is the similarity/relevance measure. In large-scale medical image retrieval, one query image may have thousands of images with the same label. For some analytical tasks, simply using class labels is not adequate to identify relevant images.\nCompared with annotation-based criteria, users or domain experts can provide more fine-grained retrieval evaluations in the form of relevance judgements for specific tasks. Many medical image retrieval systems have employed users for the performance evaluation. In general, users can observe the retrieved images and assign them with different relevance levels during evaluation. For example, the medical ImageCLEF challenges used three levels of relevance, i.e., relevant, partly-relevant, and non-relevant Kalpathy-Cramer et al., 2011; M\u00fcller et al., 2009 ). These relevance judgments were employed for the retrieval performance evaluation of the database with 30 0,0 0 0 medical images. Besides ImageCLEF challenges, considering neurons is usually hard to classify and identify, Wan et al. (2015) asked two users for the visual comparison of morphological neuron retrieval results. In medical image retrieval, user-based criteria rely on user's domain knowledge and may be partly subjective based on the user's background. Thus, the retrieval results are usually judged by two or more users for more reliable evaluation.\nThe evaluation of system design also plays an important role in medical image retrieval, especially for the retrieval systems where users are interactively involved. Markonis et al. (2015) reported the user-orientied evaluation of a text-and content-based medical image retrieval system. In total, 16 radiologists participated in the user tests with a working image retrieval system in an iterative manner. Such analyses in clinical practice are really needed to advance the practical use of image retrieval in hospitals"}, {"section_title": "Public datasets", "text": "With the increasing availability of digital imaging techniques, a large number of medical images are generated and well organized in many repositories. Some of the repositories are publicly available for users and researchers. The medical image repositories usually include thousands to millions of images. Images are collected for different purposes, such as cancer grading/staging and treatment planning. We briefly introduce some of the public data sets that are widely used for medical image retrieval:\n\u2022 ImageCLEF (2016) : ImageCLEF provides an evaluation forum for the cross-language annotation and retrieval of images. ImageCLEF has held 14 years of medical image retrieval challenges, with the number of images in the dataset having increased from 6,0 0 0 to 30 0,0 0 0 ( Kalpathy-Cramer et al., 2015 ) . The datasets in ImageCLEF include multiple modalities of medical images, e.g., radiology, microscopy and also general photography.\n\u2022 DDSM of South Florida U. (2016) (2016) : MedPix is a fully web-enabled cross-platform database, integrating images and text information. This medical image database includes over 53,0 0 0 indexed and curated images, from more than 13,0 0 0 patients. The merit of this database is that it records detailed descriptions of patients and their corresponding diagnosis.\n\u2022 TCGA ( Institute, 2016 ) : The Cancer Genome Atlas (TCGA) collects a huge amount of cancer images (currently around 10,0 0 0,0 0 0 images and increasing quickly) from multiple projects funded by National Cancer Institute. It records many types of cancer images, including but not limited to, brain, esophageal, lung, thyroid and rectum. All TCGA data reside in the Genomic Data Commons ( Institute, 2016 (2016) : VISCERAL is the abbreviation for Visual Concept Extraction Challenge in Radiology, which provides a benchmark for the retrieval in the medical domain. This dataset consists 2,311 medical 3D volumes originating from various modalities (CT, MRT1, MRT2 with and without contrast agent) and each volume consists 200 \u2212 2000 images (slices). The VISCERAL project has organized several challenges, workshops and provided multiple benchmarks related to large-scale data in medical image analysis and retrieval ( Langs et al., 2012; M\u00fcller et al., 2014 ) .\nIn addition to the above data sets, Table 3 presents a summary of publicly available data sets with many medical images, including number of images, size and categories if available. Due to the fast growth of medical images, we only provide a small subset of commonly used data sets in Table 3 ."}, {"section_title": "Applications", "text": "After reviewing the above large-scale techniques, we introduce their applications for medical image analytics in this section. Large-scale retrieval methods have demonstrated impressive improvement on many medical image types, including CT, MRI, X-ray, microscopy and others. In the following, we illustrate their applications in clinical diagnosis, cancer grading, and neuron exploration. Medicine, 2016 ) 53,0 0 0 Multi-modalities TCGA ( Institute, 2016 ) 470 TB Cancer Images, Multi-modalities TCIA ( TCIA, 2016 ) 10,0 0 0,0 0 0, 3 TB Cancer Images, Multi-modalities Retinopathy ( EyePACS, 2016 ) 35,0 0 0, 82 GB Retinal Photographs DREAM ( Bionetworks, 2016 ) 640,0 0 0 Screening Mammograms VISCERAL ( VISCERAL, 2016 ) 2300 3D CT, MRI volume LIDC-IDRI ( Armato III et al., 2011 ) 240,0 0 0, 124 GB Lung CT, DX, and CR ADNI ( of Southern California, 2016 ) Over 150TB Alzheimer's MR, PET, etc NBIA ( NBIA, 2016 ) 76,0 0 0 Cancer Images, Multi-modalities CAMELYON 17 ( DIAG ) 1,0 0 0, 2 TB Whole-slide Histopathological Images PubMed Center ( NCBI, 2017 ) 4,0 0 0,0 0 0 Multi-modalities NLST ( Institute, 2017 ) 76,0 0 0 Lung CT, Pathology Images"}, {"section_title": "Mammographic retrieval and segmentation", "text": "Breast cancer remains the second leading cause of cancerrelated death among women ( Society, 2013 ) . Early diagnosis based on mammography is a widely adopted approach to improving the chances of recovery, which is recognized as a gold standard for breast cancer detection by the American Cancer Society ( Society, 2013 ) . However, the detection of masses in a mammogram is a challenging task, as masses have a large variation in shape, margin, and size. They are often indistinguishable from surrounding tissue ( Cheng et al., 2006; Oliver et al., 2010 ) . For an undetected mammogram, computer-aided diagnosis (CAD) with content-based image retrieval (CBIR) is an effective solution by returning a limited number of the most similar mammograms in the pre-built image database, where the retrieved mammograms were already annotated with the class labels of mass and normal. Nevertheless, with the ever increasing number of mammograms generated and added to the pre-built database, scalable CBIR techniques have become one of the important problems for mammogram based breast cancer diagnosis ( Langs et al., 2012 ) . Jiang et al. (2015c) successfully solved the scalable mammogram retrieval problem based on a vocabulary tree with adaptive weighting. For a query with a mammographic region of interest (ROI), it can achieve efficient retrieval in a dataset with 11,553 ROIs. Specifically, in the experiment, this method reported an 88.4% retrieval precision with 50 0 mass ROIs and 50 0 normal ROIs as queries. This demonstrates good accuracy compared with other methods including NMI ( Tourassi et al., 2007 ) , BoW ( Andr\u00e9 et al., 2012 ) , and VocTree ( Nister and Stewenius, 2006 ) . The method also achieved highest classification accuracy (90.8%) for whether the query ROIs are masses or normal. Additionally, this method is 3 to 10 times faster than other methods and the advantage is larger when the size of image database increases. Jiang et al. (2016b) propose to learn online shape and appearance priors via image retrieval, i.e., setting an input mass as the query, its visually similar training masses can be obtained by image retrieval. Then, the query mass can be segmented using the retrieval priors and graph cuts. Extensive experiments on a mammography database demonstrate that the method can improve the segmentation accuracy and outperform several widely used mass segmentation methods."}, {"section_title": "Cell-level histopathological image analysis", "text": "Histopathological image analysis is widely used for cancer grading. Compared to mammography, CT and others, histopathology slides provide more comprehensive information for diagnosis and the diseases are analyzed by detecting tissue and cells in lesions ). On the other hand an invasive biopsy is necessary, which is often tried to be avoided. CBIR systems are commonly employed to analyze histopathological images ( Doyle et al., 2007; Caicedo et al., 2011; . In CBIR systems, the returned visually similar images can be used to identify and classify the query images (e.g., classifying them as benign or malignant), and further assist pathologists to describe the tissue samples.\nHashing methods were first employed by Zhang et al. (2014) ; to tackle large histopathological image databases for CBIR. They designed a comprehensive CBIR framework to analyze histopathological images by leveraging high-dimensional texture features and kernelized hashing with supervised information. In the experiment, this hashing method demonstrated significant improvement in histopathological image classification and retrieval tasks. Compared to methods such as SVM ( Caicedo et al., 2009 ), Adaboost ( Doyle et al., 2012 ) , KNN ( Tabesh et al., 2007 ) , and Graph Embedding ( Basavanhally et al., 2010 ) , its accuracy was 5 to 10 percent higher. The method achieved histopathological retrieval for 700 \u2212 900 images within 0.01 seconds (3121 images in the database), which is 10 0 0 times faster than the given baseline. Fig. 8 illustrates four queries (two benign images, two malignant images) and their corresponding top five retrieval results based on this hashing-based CBIR framework. Despite the difference between benign and malignant images being subtle, the proposed method is effective to retrieve images in the same category. The authors extended the CBIR system for more accurate diagnosis by examining the cells in histopathology images ( Zhang et al., 2015d ) . As each histopathology image usually includes thousands of cells, examining every cell by traditional retrieval methods is almost impossible when the image databases are large. Thus, a hashing-based framework is proposed that enables cell-level analysis in real-time with high accuracy, i.e., indexing 96, 0 0 0 cells within 1.68 seconds (the whole database includes 484,136 cells), and achieving 87.3% accuracy for the classification of histopathology lung images (i.e., two types of lung cancers, adenocarcinoma or squamous carcinoma).\nIn histopathological image analysis, it is a common practice to employ multiple features to improve performance. To embed multiple features in a hashing framework, Jiang et al. (2015b ; employed joint kernel-based supervised hashing (JKSH) for scalable histopathological image analysis, where multiple features are linearly combined by individual kernels ( Liu et al., 2014c ) . Experiments on breast cancer histopathology images demonstrate the effectiveness in both retrieval and classification."}, {"section_title": "Exploration of a neuron databases", "text": "Analyzing single neuron properties, such as cell types, brain regions, functions and development stages is usually a fundamen- tal task to understand the nervous system and brain mechanisms. In general, neuron morphology plays a major role in determining the neuron's functional and physiological properties. Recent approaches in neuroscience (e.g., BigNeuron a. (2016) ) have facilitated the research in neuron morphology. An increasing number of neurons are reconstructed and added to the public repositories ( NeuroMorpho, 2016; b., 2016 ) . Therefore, given an unknown neuron, it is reasonable to explore its properties through the morphological retrieval in neuron databases. Mesbah et al. (2015) ; Conjeti et al. (2016b) developed an advanced tool for morphological search and retrieval in large-scale neuroscientific image databases, namely Neuron-Miner. NeuronMiner first employs quantitative measurements as neuron features, such as soma surface, the number of branches and the neuron's total length. Then, it adopts a novel hashing method, i.e., hashing forests, to compact the features into binary codes. In the experiment, Neuron-Miner demonstrates the effectiveness in morphological retrieval with a database including 31,266 neurons. Given a query, this tool is able to return several visually similar neurons from the database. The ground truth (using normalized Euclidean distance) shows that returned neurons are relevant to the query.\nMore recently, Li et al. (2016 ; 2017a ) explored large-scale morphological neuron databases based on a novel search strategy, the maximum inner product search (MIPS). Based on MIPS, nonlinear hashing functions are learned by embedding the inner code product rather than the conventional Hamming distance. The nonlinear hashing functions are particularly suitable for the morphological neuron retrieval problem, since the neurons' tree-topological structure makes them hard to be discriminative in low-dimensional linear space. Fig. 9 demonstrates that the MIPS-based method is able to retrieve morphologically similar neurons in the large-scale database. To evaluate the retrieval precision, it employed projection neurons in the olfactory bulb as queries. The retrieval results validated that most returned neurons have the same properties as the queries (with a reported 90.48% average precision in the top-5 relevant neurons). Additionally, the authors demonstrated the application of morphological retrieval in neuron exploration. By collecting properties of the top-K relevant neurons (e.g., a neurons' brain regions, cell types, transmitters). Properties of the query neuron can be inferred in real-time based on this MIPS hashing framework."}, {"section_title": "Future directions", "text": "After reviewing the above methods and applications of largescale medical image analytics, we discuss possible future directions in this section. Despite varieties of advanced large-scale techniques being employed for retrieval, there are still many directions to explore and improve the retrieval performance.\nMulti-features : in general, only employing a single kind of feature is not enough to represent and discriminate medical images. Especially when a database is large, the difference with some irrelevant images can be subtle. One intuitive solution is using multiple features to represent each image, e.g., local, holistic, and texture features. These features can be fused and embedded in a large-scale retrieval framework. According to existing work, multi-feature fusion can be conducted on three levels during retrieval, i.e., feature level ( Atrey et al., 2010 ) , training level ( Liu et al., 2014c ) , and decision level ( Zhang et al., 2012 ) . Jiang et al. ( Jiang et al., 2016a ) fuse three types of features (SIFT ( Lowe, 2004 ) , HOG ( Dalal and Triggs, 2005 ) , and GIST ( Oliva and Torralba, 2001 ) ) in the training level when learning hashing functions; Zhang et al. (2016a) employ a graph-based query-specific fusion approach to integrating local and holistic features at the decision level. Despite the two methods having achieved good performance, these are far from enough for large-scale medical image retrieval. With the ever-increasing techniques in feature representation, employing more features to retrieve complex medical images is a clear trend (e.g. the ImageCLEF medical image retrieval tasks in recent years). However, as diverse features have different meanings and representations, deciding on the importance of each feature is a challenging task. User specified feature importance is usually not reliable, and automatically computing each feature's importance is time-consuming, especially when dealing with many features in a large database. Thus, successfully handling multi-feature fusion in a large-scale database further improves the accuracy and efficiency of medical image retrieval.\nOnline updating: as more medical images are being generated, the size of the corresponding databases are continuously increasing. For example, the aforementioned ImageCLEF database increased the number of images from 600 to 30 0,0 0 0, and the NeuroMorpho database usually releases 10 0 0 to 20 0 0 reconstructed neuron cells in each update. The newly added images should be Fig. 9 . Results of morphological neuron retrieval shown in ( Li et al., 2017a ) . For each neuron on the left (red), the top-5 retrieved neurons on the right (blue) are shown. This illustrates the morphological similarity between query neurons and retrieved neurons. (For interpretation of the references to color in this figure legend, the reader is refered to the web version of this article.) considered to train new models for retrieval, since employing more training data can accordingly improve the retrieval accuracy. However, if we re-train a large-scale model every time from scratch, using both the original and the newly added images, it is timeconsuming and adversely affects the efficiency of medical retrieval. On the other side, when the medical image databases are extremely large (e.g., including millions of images), current storage techniques are not able to arrange and process all the images within one batch. More importantly, both the vocabulary tree and hashing based methods cannot efficiently train models for the huge amount of images at a given time, e.g., building a hierarchical tree or learning hashing functions with millions of feature vectors. To tackle these problems, one possible solution is to divide huge databases into several batches, and then develop an online updating strategy to train the retrieval model with one-by-one image batches in a streaming manner. The newly added images can also be treated as a batch to update the retrieval model. Currently, several online hashing methods have been developed for computer vision tasks ( Huang et al., 2013; Leng et al., 2015; Cakir and Sclaroff, 2015 ) . In medical image analytics, the merit of the online updating strategy is beneficial in the future with a continuously increasing number of images and extremely large databases.\nBringing humans in the loop : for the retrieval of large-scale medical image databases, lacking label information is the main limitation to achieve good retrieval results. As medical images usually have different modalities and appearances, their intra-class variations can be large, and their inter-class variations can be small. The image labels are useful to handle this problem, since it can embed supervised information in retrieval models and bridge the lowlevel features with high-level image semantics. However, labeling images is not an easy task. Especially for some medical images, assigning their labels requires domain experts with proper training. Crowdsoucing can be used when very precisely defined tasks allow for quick training times ( Foncubierta Rodr\u00edguez and M\u00fcller, 2012 ) . Deciding whether a histopathology image contains benign or malignant lesions is complex and time-consuming, for example. Moreover, large-scale databases make this task even harder. To tackle these problems, one feasible solution is to bring humans in the retrieval loop. They can interactively give feedback to improve the retrieval performance ( Rui et al., 1998; Feng et al., 2013 ) . After acquiring a set of similar images from unsupervised retrieval, users/domain experts can specify images relevant to the query and those that are not. Such feedback can be returned to the retrieval system to improve the final results ( Bulo et al., 2011; Sahbi et al., 2007 ) . The feedback can be treated as supervised information but it is more efficient than labeling all medical images. Theoretically, such an interactive strategy can achieve two goals: (1) it presents retrieval results to users/domain experts to help them analyze medical images; (2) it receives and uses the interactive feedback to improve the retrieval system."}, {"section_title": "Conclusions", "text": "In this review, we summarize recent advances of large-scale retrieval for medical image analytics. By introducing the pipeline of large-scale retrieval, we presented a comprehensive review of relevant techniques that can improve the efficiency and accuracy of medical image analysis, including feature representation, feature indexing and searching. We also reviewed clinical applications and discussed the future directions of large-scale medical analytics. With the ever-increasing amount of newly generated medical images, we believe that the algorithms and methods of large-scale medical image analytics will lead to new ideas for knowledge discovery and decision support.\nCurrently, only few systems have been exposed to detailed user testing ( Markonis et al., 2015 ) and such user tests are clearly needed for very large scale systems. Many currently CBIR systems only use small databases and not update mechanisms and this is required for real application including an integration of the systems into the standard clinical workflow, which is often neglected. Many technical approaches are now available for large-scale applications but more work is needed to actually integrate the tools for clinical impact, an this includes the use of deep learning and explaining these results to physicians."}]
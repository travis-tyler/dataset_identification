[{"section_title": "Abstract", "text": "Accurate and efficient segmentation of the hippocampus from brain images is a challenging issue. Although experienced anatomic tracers can be reliable, manual segmentation is a time consuming process and may not be feasible for large-scale neuroimaging studies. In this paper, we compare an automated method, FreeSurfer (V4), with a published manual protocol on the determination of hippocampal boundaries from MRI scans, using data from an existing MCI/AD cohort. To perform the comparison, we develop an enhanced spherical harmonic processing framework to model and register these hippocampal traces. The framework treats the two hippocampi as a single geometric configuration and extracts the positional, orientation and shape variables in a multi-object setting. We apply this framework to register manual tracing and\nFreeSurfer results together and the two methods show stronger agreement on position and orientation than shape measures. Work is in progress to examine a refined FreeSurfer segmentation strategy and an improved agreement on shape features is expected."}, {"section_title": "INTRODUCTION", "text": "The hippocampus has been extensively studied with neuroimaging techniques given its importance in learning and memory and its potential as a biomarker for brain disorders such as Alzheimer's disease (Csernansky et al., 2005; Saykin et al., 2006; Thompson et al., 2004; Wang et al., 2007) , epilepsy (Hogan et al., 2006) and schizophrenia (Csernansky et al., 2002; Gerig et al., 2001; Shenton et al., 2002) . While some groups used automated methods for quantification of the size and shape of the hippocampus (Csernansky et al., 2002; Csernansky et al., 2005; Hogan et al., 2006; Shen et al., 2002; Wang et al., 2007) , in many studies (Gerig et al., 2001; 3 McHugh et al., 2007; Saykin et al., 2006; Shenton et al., 2002; Thompson et al., 2004; Yushkevich et al., 2007) , hippocampal segmentation from magnetic resonance imaging (MRI) scans was done manually by anatomic tracers using software tools that were either in-home made or publicly available (e.g., BRAINS (Iowa Mental Health Clinical Research Center, 2008) , 3D\nSlicer (NAMIC, 2008) , ITK-SNAP (Yushkevich et al., 2006) ). Many of these tools provide manual tracing capabilities and semi-automatic approaches involving less human interaction.\nAccurate and efficient segmentation of the hippocampus from brain images is still a challenging issue. Although experienced anatomic tracers can be reliable, manual segmentation is a time consuming process and may not be feasible for large-scale neuroimaging studies. For example, the Alzheimer's Disease Neuroimaging Initiative (ADNI) (Mueller et al., 2005 ) collects 1.5T structural MRI for over 800 subjects every 6 or 12 months for 2-3 years. Manual segmentation is apparently not an ideal method for handling such a study involving thousands of MRI scans. A feasible strategy for hippocampal segmentation in large-scale studies should be able to minimize human intervention in the processing pipeline. Diffeomorphic mapping is a notable method for automatic segmentation and has been used by Csernansky and colleagues in many hippocampal studies (Csernansky et al., 2002; Csernansky et al., 2005; Hogan et al., 2006; Wang et al., 2007) .\nFreeSurfer Fischl et al., 2002; Fischl et al., 1999) is an automatic software tool for whole brain segmentation and cortical parcellation. Since FreeSurfer is freely available on the web, it has been widely used in the neuroimaging field. Two recent studies reported similar results on comparing hippocampal volumes measured using their own manual method and a specific version of FreeSurfer (V4 in (Shen et al., 2008) , V3.04 in (Tae et al., 2008) ): the intraclass correlation coefficients were both between 0.8 and 0.85, showing good agreement."}, {"section_title": "4", "text": "In this paper, we focus on comparing hippocampal morphometric features beyond the volume determined by the two methods in order to evaluate the reliability of FreeSurfer on extracting these features. We develop an enhanced spherical harmonic (SPHARM) processing framework to model and register the hippocampal traces. The framework treats the two hippocampi as a single configuration and extracts the positional, orientation and shape variables in a multi-object setting. The proposed registration algorithm operates directly on the SPHARM coefficients and thus is not only effective but also efficient. We apply this framework to register all the hippocampal data together and to decouple the position, orientation, and shape for comparing the manual and FreeSurfer results. The proposed shape modeling and registration framework can also be used as a general purpose tool for other shape comparison and analysis applications."}, {"section_title": "MATERIALS AND METHODS", "text": "In this work, we use a data cohort for studying memory circuitry in mild cognitive impairment (MCI) and early Alzheimer's disease (AD). In this MCI/AD cohort, there are hippocampal data available for 123 subjects total, in four categories: 39 healthy older adults (HC), 38 euthymic older adults with cognitive complaints (CC) but intact neuropsychological performance, 36 older adults with amnestic MCI, and 10 adults with AD. Volumetric structural MRI data were acquired on a 1.5 Tesla GE LX Horizon scanner using a T1-weighted SPGR coronal series with 1.5mm slice thickness. Further details about this data set are available in (Saykin et al., 2006) .\nHippocampal and intracranial boundaries were obtained using (1) a manual protocol reported in (McHugh et al., 2007) using the BRAINS software package (Iowa Mental Health Clinical Research Center, 2008) , and (2) a fully automated method using the FreeSurfer V4 package Fischl et al., 2002; Fischl et al., 1999) . For manual segmentation, images were reformatted into isotropic 1-mm voxels and resampled into the plane perpendicular to the long axis of the hippocampus using BRAINS. Manual traces were performed in the coronal plane using markings placed in the axial and sagittal views to guide boundary determination. A 3D binary image was reconstructed from each set of 2D traces. Further details about this manual protocol are available in (McHugh et al., 2007) . For automated segmentation, FreeSurfer was employed to automatically label subcortical tissue classes using an atlas-based Bayesian segmentation procedure (Fischl et al., 2002) . We ran the complete FreeSurfer pipeline without any manual intervention on an IBM HS21 Bladeserver cluster running Red Hat Linux. Each slice of segmentation label map was inspected by a technician and passed a basic test of quality control. From each label map, we extracted the left and right hippocampi as two 3D binary images. Fig. 1 shows sample manual and Freesurfer results. For convenience, we use MT to indicate the manual tracing method and FS to indicate the FreeSurfer method.\nWe recently compared hippocampal volume determined by the MT and FS methods (Shen et al., 2008) . Since regional differences in shape are more likely to reveal clues to pathophysiology than volume, it is critical to examine differences in extracted shape features using various methods. This paper is focused on examining these morphometric features. We employ the spherical harmonic (SPHARM) description (Brechbuhler et al., 1995) to model the hippocampal surfaces and develop an enhanced SPHARM registration algorithm to facilitate the comparison between the MT and FS data. This method is designed for comparing segmentation methods performed in two different image spaces (e.g., in our MT and FS cases) without knowing their 6 spatial relationship. If this relationship is known, these two spaces can be easily registered together and direct 3D volume comparison as proposed in (Fischl et al., 2002) can be applied.\nSPHARM (Brechbuhler et al., 1995) is a highly promising surface modeling method that has been successfully applied to numerous applications in brain imaging. SPHARM is used in this study for modeling all the hippocampal surfaces. Its first step is to create a continuous and uniform mapping from the object surface to the surface of a unit sphere. The result is a bijective mapping between each point v on a surface and a pair of spherical coordinates \u03b8 and \uf066: c can be estimated up to a user-desired degree by solving a set of linear equations. The object surface can be reconstructed using these coefficients, and using more coefficients leads to a more detailed reconstruction (Fig. 2) . The degree one reconstruction is always an ellipsoid. We call it the first order ellipsoid (FOE).\nSurface registration aims to register all the models into a common reference system to facilitate shape comparison. It creates a normalized geometric representation to describe the shape after normalizing the size, position and orientation measures (i.e., excluding scaling, translation, and rotation). Since the relative position and orientation between the two hippocampi (or the pose of the hippocampal pair) are of our interest, we treat the two hippocampi as a single configuration and study SPHARM registration in a multi-object setting. Scaling invariance can be achieved by multiplying the coefficients by a scaling factor to normalize a certain volume. We normalize the 7 intracranial volume (ICV) to account for the brain size variation: (1) the mean ICV (= 1421.2 cm 3 ) of the MT data is calculated, and (2) each hippocampal pair in both MT and FS data is scaled proportionally along with the corresponding ICV so that the ICV is normalized to 1421.2 cm 3 . While ignoring the degree zero coefficient results in translation invariance for a single SPHARM model, in our multi-object setting, new methods need to be developed to preserve the relative position among objects while removing the global translation effect. The surface registration methods described below aim to remove the effects of global translation and global rotation for aligning two multi-object complexes together.\nThe correspondence between SPHARM models is implied by the underlying parameterization:\ntwo points with the same parameter pair (\u03b8,\uf066) on two surfaces are defined to be a corresponding pair. To register multi-object complexes, traditional methods (Shen et al., 2004; Styner et al., 2006) rotate the parameter net of each individual model to a canonical position on its FOE for establishing the surface correspondence (Fig. 3) , and then use the rigid-body Procrustes method to align reconstructed surface samples. These methods work well only if the FOE is a real ellipsoid (e.g., hippocampal case) but not an ellipsoid of revolution or a sphere. To remove this restriction, we developed a registration method by minimizing the root mean squared distance (RMSD) between two SPHARM models instead of aligning the FOEs . Here, we extend this work to handle multi-object complexes.\nOur approach shares a similar idea with the iterative closest point (ICP) method (Besl and McKay, 1992) . We start with an initial alignment and alternately run the following two steps to refine the alignment until it converges: (1) object space registration for aligning corresponding surface parts, and (2) parameter space registration for refining the surface correspondence."}, {"section_title": "8", "text": "Suppose that we want to register a multi-object complex X to an atlas A. To create an initial alignment, we can first align X to A in the object space and then rotate the parameter net of each SPHARM model in X to best match its counterpart in A. In hippocampal cases, the initial alignment can be established by applying the FOE method. In cases where the FOE method does not apply, we can use ICP for initial alignment (see ).\nIn object space registration, we aim to improve the alignment in the object space. Since an initial surface correspondence has been created, we can simply create corresponding surface samples between X and A and then align two corresponding point sets in a least squares sense (Besl and McKay, 1992) . We call this method as CPS (i.e., aligning corresponding point sets). Let T be the vector that translates the X center to the A center, and R be the rotation matrix returned by CPS.\nWe use the following approach to apply T and R to each SPHARM model X and derive a new SPHARM representation that matches A. Let In parameter space registration, we aim to improve the surface correspondence between SPHARM models that are roughly aligned in the object space. Since the underlying parameterization defines the correspondence between different SPHARM surfaces, our task is to rotate the parameterization of one model to best match the other's. The goodness of the match is measured by the root mean squared distance (RMSD) between two models. RMSD can be calculated directly from SPHARM coefficients. Let S 1 and S 2 be two SPHARM surfaces, where their SPHARM coefficients are formed by . We employ a sampling-based strategy that fixes one parameterization and rotates the other to optimize the surface correspondence by minimizing the RMSD. The rotation space can be sampled nearly uniformly using icosahedron subdivisions. A naive solution for rotating the parameterization of a SPHARM model is to recalculate the coefficients using the rotated parameterization. However, it requires solving three linear systems and is time-consuming. To accelerate the process, we use a rotational property in the harmonic theory and rotate SPHARM coefficients without recalculating the expansion. Details are available in .\nWhile traditional registration methods (Shen et al., 2004; Styner et al., 2006) derive sampled point distribution models as results, our algorithm operates directly on the SPHARM coefficients and so the results are still SPHARM models. This leads to a better potential of enhancing the registration results in addition to having a capability of performing subsequent analyses in both spatial and frequency domains. Fig. 4 shows a sample registration procedure, and we can see that our algorithm can further improve the FOE registration result with a reduced RMSD."}, {"section_title": "RESULTS", "text": "We compared hippocampal volume between the MT and FS data in (Shen et al., 2008) . In this work, we aim to examine additional morphometric features. Thus, we first exclude volume from all the MT and FS data: Each hippocampal pair is scaled proportionally along with the corresponding ICV so that the ICV is normalized to 1421.2 cm 3 (i.e., the mean ICV of the MT data). The subsequent analyses are performed on the data after this scaling normalization."}, {"section_title": "Atlas Generation and Data Registration", "text": "We first use all the healthy controls (n=39) in the MT data to create an atlas that represents an average hippocampal pair. Our method is as follows: (1) let the atlas be the first hippocampal pair; (2) register each pair to the atlas; (3) let the atlas be the mean of all the data; (4) repeat (2) and (3) until the atlas converges. The left side of the atlas is shown in Fig. 4(a) .\nOur overall strategy for aligning the MT and FS data together is as follows: (1) register all the MT data to the atlas; and (2) register each hippocampal pair in the FS data to its counterpart in the MT data. We consider two types of registration: a global one and a local one (Styner et al., 2006) . In global registration, we directly apply the algorithm proposed in the Methods Section for aligning multi-object complexes. This rigid-body algorithm excludes only global translation and rotation and so the spatial relation between the two hippocampi or the pose of the hippocampal pair is preserved. In local registration, each individual hippocampus is allowed to match its template separately. This method expects to derive a better RMSD by allowing local translation and rotation and may account for possible non-rigid-body transformation effects.\nWe use RMSD to measure the registration error between an individual and its template. Fig. 5 shows sample global and local registration results for the MT and FS hippocampal traces of a same subject. While both methods can derive good registration results, the local method does generate better RMSDs. Table 1 shows a comparison of applying various registration methods on the MT and FS data, where each entry records (mean\u00b1std) of the registration errors for all subjects in a particular data set by a certain method. For either of global and local strategies, we compare three methods: (1) FOE-PRM: rotating parameterization to a canonical position using FOEs, (2) FOE-OBJ: one run of object space registration after FOE-PRM, and (3) OUR-ALG: our algorithm proposed above. Although the traditional SPHARM registration methods work well on hippocampal data (see the FOE-OBJ columns for their results), our algorithm is able to further improve these results (see the OUR-ALG columns)."}, {"section_title": "Position, Orientation and Shape", "text": "While global registration excludes global effects on translation and rotation, the spatial relationship between the two hippocampi is preserved. We use the globally registered FOE model to define this local pose information, including the position and orientation of each hippocampus. Let h be a hippocampus, SP h be its SPHARM model that is registered in the atlas space, P h be the FOE center of SP h , and N h be the FOE north pole of SP h (see Fig. 3 for sample\nFOEs on which north poles are shown as yellow dots). We define P h to be the position measure"}, {"section_title": "of h and O h = (N h -P h ) / |N h -P h | to be the orientation measure of h.", "text": "We report our work on comparing the position and orientation measures determined by the MT and FS methods. We use the position measure of the left hippocampus as an example to show our approach. Let S be our subject set. Given x\uf0ceS, we use M x l to denote its left hippocampus determined by the M method, where M\uf0ce{MT, FS}. We start with a simple examination of three sets of position distances: (1) intra-subject distances between the MT and FS methods: x,y\uf0ceS, x\u2260y}; and (3) inter-subject distances within the FS data:\nSimilar calculations are applied to the right hippocampus and the orientation measures. The orientation distance is measured by the angle between two directions. Finally we examine the shape measures. Since we have established surface correspondence among SPHARM models, given any two models, we can calculate a distance map showing the model difference on each surface location. Similar to the position and orientation cases, we calculate three sets of distance maps: (1) intra-subject distances between MT and FS methods, (2) inter-subject distances within the MT data, and (3) inter-subject distances within the FS data.\nSince it is hard to visualize the distance distribution for all the surface locations, we only show the mean and standard deviation of these distance maps in Fig. 7 . For global registration, compared with the inter-subject distances within a method (MT or FS, see middle or bottom row), the intra-subject distances between two methods (top row) are relatively small. This indicates some degree of agreement, but it might be related only to position and orientation factors, since globally registered models contain not only shape but also position and orientation information. In local registration, the position and orientation information is excluded, and the 13 intra-subject distances between the methods (top row) and the inter-subject distances within the method (middle and bottom rows) become at a similar level. To make the two methods agree more on shape, it appears there is still room for improvement. In particular, the tail region shows a notable systematic difference. By a visual inspection of the raw data (Fig. 1) , we notice that the FS results tend to have a fatter tail and some noisy spikes on the surface."}, {"section_title": "DISCUSSION", "text": "We have compared FreeSurfer (V4) with a published manual protocol on the determination of hippocampal boundaries from MRI scans, using data from an existing MCI/AD cohort. This comparison is enabled by an improved SPHARM modeling and registration procedure. We use a global registration process to extract relative position and orientation measures of the two hippocampi, and the manual and FreeSurfer methods show good agreement on these measures.\nWe use a local registration process to account for possible non-rigid-body transformation effects and extract fine-scale surface shape measures, and the two methods show less agreement on these measures. Visual inspection of raw data shows the FreeSurfer results tend to have a fatter tail and some noisy spikes on the surface. We plan to examine a refined FreeSurfer segmentation strategy and expect an improved agreement on shape features. Other interesting future topics include: (1) Can the results be greatly improved by involving minimal human intervention? (2) Are the discriminative powers to detect disease similar between the manual and FreeSurfer data? intra-subject distances between the MT and FS methods, in the middle row inter-subject distances within the MT data, and in the bottom row inter-subject distances within the FS data. Fig. 7 . Statistical maps of intra-subject and inter-subject surface distances after (a) global registration or (b) local registration. In each of (a) and (b), the left column shows the mean map, and the right column shows the standard deviation map. Shown in the top row are intra-subject distances between the MT and FS methods, in the middle row inter-subject distances within the MT data, and in the bottom row inter-subject distances within the FS data. All the mean and standard deviation maps are color-coded and superimposed onto the hippocampal atlas. intra-subject distances between the MT and FS methods, in the middle row inter-subject distances within the MT data, and in the bottom row inter-subject distances within the FS data. Fig. 7 . Statistical maps of intra-subject and inter-subject surface distances after (a) global registration or (b) local registration. In each of (a) and (b), the left column shows the mean map, and the right column shows the standard deviation map. Shown in the top row are intra-subject distances between the MT and FS methods, in the middle row inter-subject distances within the MT data, and in the bottom row inter-subject distances within the FS data. All the mean and standard deviation maps are color-coded and superimposed onto the hippocampal atlas."}]
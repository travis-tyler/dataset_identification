[{"section_title": "Abstract", "text": "Many neuroimaging studies collect functional magnetic resonance imaging (fMRI) data in a longitudinal manner. However, the current fMRI literature lacks a general framework for analyzing functional connectivity (FC) networks in fMRI data obtained from a longitudinal study. In this work, we build a novel longitudinal FC model using a variance components approach. First, for all subjects' visits, we account for the autocorrelation inherent in the fMRI time series data using a non-parametric technique. Second, we use a generalized least squares approach to estimate 1) the within-subject variance component shared across the population, 2) the baseline FC strength, and 3) the FC's longitudinal trend. Our novel method for longitudinal FC networks seeks to account for the withinsubject dependence across multiple visits, the variability due to the subjects being sampled from a population, and the autocorrelation present in fMRI time series data, while restricting the number of parameters in order to make the method computationally feasible and stable. We develop a permutation testing procedure to draw valid inference on group differences in the baseline FC network and change in FC over longitudinal time between a set of patients and a comparable set of controls. To examine performance, we run a series of simulations and apply the model to longitudinal fMRI data collected from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database. Overall, we found no difference in the global FC network between Alzheimer's disease patients and healthy controls, but did find differing local aging patterns in the FC between the left hippocampus and the posterior cingulate cortex.\nResting-state functional magnetic resonance imaging (fMRI) captures a series of images of the brain in subjects who are not given a particular task to perform while in the scanner. The scanner repeatedly captures blood oxygenation level dependent (BOLD) signals at hundreds of thousands of locations within the brain, creating a time series of images of the brain. By capturing the BOLD signal of the resting brain, restingstate fMRI provides an opportunity for researchers to examine the functional connectivity (FC) within a set of regions not tied to a particular task. We define FC as the temporal dependence, measured through crosscorrelations, in the BOLD signals between brain regions (Friston et al., 1993) . Identifying group differences in FC can help better understand the underlying neurological process of a disease and its progression.\nObserved group differences can also potentially form biomarkers to be used for early detection and treatment of neurological disorders (Fox and Raichle, 2007) .\nPrevious works have demonstrated the utility of FC analysis. For example, past research has identified altered FC between healthy aging patients and those with Alzheimer's disease (AD). Even among cognitively normal (CN) individuals, FC demonstrates aging effects that are heterogeneous between different brain regions . Chase (2014) and Hafkemeijer et al. (2012) E-mail addresses: hartx204@umn.edu (B. Hart), cribben@ualberta.ca (I. Cribben), mfiecas@umn.edu (M. Fiecas). 1 Data used in preparation of this article were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at:"}, {"section_title": "Introduction", "text": "Resting-state functional magnetic resonance imaging (fMRI) captures a series of images of the brain in subjects who are not given a particular task to perform while in the scanner. The scanner repeatedly captures blood oxygenation level dependent (BOLD) signals at hundreds of thousands of locations within the brain, creating a time series of images of the brain. By capturing the BOLD signal of the resting brain, restingstate fMRI provides an opportunity for researchers to examine the functional connectivity (FC) within a set of regions not tied to a particular task. We define FC as the temporal dependence, measured through crosscorrelations, in the BOLD signals between brain regions (Friston et al., 1993) . Identifying group differences in FC can help better understand the underlying neurological process of a disease and its progression.\nObserved group differences can also potentially form biomarkers to be used for early detection and treatment of neurological disorders (Fox and Raichle, 2007) .\nPrevious works have demonstrated the utility of FC analysis. For example, past research has identified altered FC between healthy aging patients and those with Alzheimer's disease (AD). Even among cognitively normal (CN) individuals, FC demonstrates aging effects that are heterogeneous between different brain regions . Chase (2014) and Hafkemeijer et al. (2012) showed altered FC patterns beyond healthy aging in patients with dementia and AD. Other works, including Wang et al. (2007) have noted abnormal FC in various stages of AD. Wang et al. (2012) even demonstrated the impact of family history of AD on FC. In addition, Xiang et al. (2013) showed decreased FC from CN patients to mild cognitively impaired (MCI) patients to AD patients, and Li et al. (2015) found decreased FC for CN patients who progressed to MCI over the following 24 months compared to non-progressers. These previous works, however, used cross-sectional models, which only consider data from a single time point. Ren et al. (2016) , using longitudinal data, showed abnormal FC in various stages of AD and Staffaroni et al. (2018) analyzed default mode network (DMN) connectivity longitudinally in patients with AD, but summarized to a single connectivity strength metric of the network instead of considering all pair-wise comparisons.\nOf the studies mentioned above, only Ren et al. (2016) and Staffaroni et al. (2018) used truly longitudinal fMRI data. Aging effects are often measured by comparing young and elderly groups rather than following one group of subjects over time. A comprehensive longitudinal model that tests for differences in baseline and trend is needed to verify and expand on the previous results. Zhu et al. (2015) performed a longitudinal FC analysis for concussion patients, but their method was ad hoc and specific to their unique dataset. Finn and Constable (2016) demonstrated that CN patients have distinct brain signatures in fMRI images, implying that separate scans from a single individual exhibit dependence, and Ge et al. (2017) demonstrated the heritability of fMRI FC in a longitudinal study. These findings can be leveraged in a longitudinal framework to better model aging effects.\nMethods for both longitudinal imaging data and cross-sectional fMRI FC exist, but, to our knowledge, no modeling framework exists for fMRI FC collected in a longitudinal manner. Recent work by Fiecas et al. (2017) developed a model to carry out hypothesis tests on the difference between FC networks, but this method was developed for a cross-sectional study. Taking another approach, Simpson et al. (2013) provided an overview of graphical network analysis techniques for fMRI connectivity. The methods described in this overview measure graphical network traits such as small-worldness and graph centrality, but also fail to account for any longitudinal dependence present in the data. There have been other methods developed for analyzing longitudinal data from other modalities, though these methods are not appropriate for modeling longitudinal FC networks. For instance, Gertheiss et al. (2013) used longitudinal diffusion tensor imaging (DTI) data to model health outcomes. Unfortunately, the differing nature of DTI and fMRI data (i.e. fMRI data consists of a time series for each visit) make the direct application of this method impossible. Guillaume et al. (2014) also proposed a massive univariate longitudinal model for neuroimaging data, but it also was not designed to account for the autocorrelation present in fMRI time series.\nA wealth of literature exists on methods for longitudinal data analysis to account for the dependence between two visits from a single participant (Laird, 2004) , but these methods have not yet been integrated with current fMRI FC models. In this paper, we fill this large gap in the literature by proposing a novel longitudinal fMRI FC network model and inference procedure that considers the set of all possible pairwise groupings of the chosen ROI in resting-state fMRI data. Our longitudinal variance components FC network model accounts for within-subject dependence across multiple visits, variability due to subjects being sampled from a population, and any autocorrelation present in individual fMRI time series. We also propose an efficient permutation-based inference procedure that allows for valid hypothesis testing of group differences in baseline FC and FC aging effects. We show that our method is superior to the mass univariate linear mixed effects (LME) model commonly used for longitudinal neuroimaging data. Our work will build off of previous results on the clinical utility of FC as a potential biomarker for AD. It should be noted that in this paper we use the terms FC and FC network interchangeably, but note that a distinction is sometimes drawn between the two. In particular, our model focuses on inference on the strength of the edges in the network and not on the trends in the topological properties of the overall network such as the methods of Simpson and Laurienti (2015) and Simpson and Laurienti (2016) . We adopt the FC network term for our method to emphasize our ability to perform valid inference on the set of all pairwise connections in a pre-defined network instead of simply performing marginal inference on each ROI pair.\nOur contributions to the field in this article are 1) a novel general framework for longitudinal analysis of fMRI FC networks, and 2) a novel application of the permutation testing procedure of Ter Braak (1992) to fMRI FC analysis to allow for valid inference at the local and global level. The remainder of the paper is organized as follows. Section 2 formally introduces the model, including the estimation and inference procedures. It also explains the design of the simulation study and describes the application of our model to data from the Alheimer's Disease Neuroimaging Initiative (ADNI). Section 3 presents the results of the simulation study and ADNI data analysis. We close with a discussion of the simulation study and ADNI data analysis results along with proposals for future work in Section 4 and a conclusion in Section 5. R code for the methods proposed in this paper may be found at https://github.com/ mfiecas/longitudinalFC."}, {"section_title": "Materials and methods", "text": ""}, {"section_title": "Model specification", "text": "Suppose we have a cohort of N individuals and let P denote the number of ROI selected for a FC network analysis. We collect a P-variate, fMRI time series of length T from the preprocessed fMRI images of each of the N subjects at each visit. Let the subscripts i and j denote subject and visit, respectively. Subject i returns for J i total visits, and the cohort has a total of J \u00bc P N i\u00bc1 J i visits. Let y i represent the vector of sample correlation coefficients for subject i of length QJ i , where Q \u00bc P\u00f0P \u00c0 1\u00de=2 is the number of ROI pairs. Within y i , the Q correlations from the first visit, y i1 , are followed by the Q correlations from the second visit, y i2 , and so on until the J i -th visit. The full response vector y is formed by stacking the N different y i vectors and is, thus, of length QJ. Our longitudinal model for FC is a linear model with baseline effect \u03b2 0 and longitudinal trend \u03b2 1 , where each of these model parameters are vectors of length Q. We denote the time at visit j for subject i as v ij . The vector v i is formed by stacking the J i distinct v ij 1 Q vectors for subject i, where 1 Q is a vector of ones of length Q and is the Kronecker product. Likewise v is formed by stacking the N distinct v i vectors. Depending on the nature of the data and the research questions at hand, v ij can be set to the visit number, the time since baseline, or the patient's age. Then, denoting element-wise multiplication with \u00c3, our model has the following linear form:\n(1)\nThe key element in our longitudinal linear model is the variance structure of the error term. We separate the error variance into two components, \u03a3 and \u03a8, each of dimension QJ \u00c2 QJ. \u03a3 accounts for the within-visit variance and the temporal autocorrelation in the fMRI time series, and \u03a8 accounts for the variability and covariability arising from the heterogeneity across subjects and the within-subject covariation coming from the longitudinal design. \u03a3 is block diagonal where each Q \u00c2 Q block, \u03a3 ij , accounts for the within-visit variance present in visit j for subject i for the Q pairs of ROI. \u03a8 is also block diagonal with a QJ i \u00c2 QJ i block for participant i. These diagonal blocks do not differ between subjects except through their dimensions, which depend on the number of visits for each subject. Let \u03a8 diag be an arbitrary diagonal block of \u03a8. We then further break \u03a8 diag into two components, \u03a8 0 and \u03a8 1 . \u03a8 0 is a Q \u00c2 Q block that is repeated along the diagonal of each \u03a8 diag . This term models the within-visit covariability not captured by \u03a3. \u03a8 1 is a Q \u00c2 Q block that populates the off diagonal blocks of \u03a8 diag , modeling the within-subject, across-visit covariability coming from the longitudinal design.\nWe write Equation (1) in the form of a linear model with a vector response, allowing us to use existing methods for estimating the parameters and for statistical inference. To this end, our model can also be written in the standard linear model form with a design matrix X. Let X ij \u00bc \u00bd1 v ij I Q , where I Q is the Q \u00c2 Q identity matrix. To form X i , the portion of the design matrix specific to subject i, we stack the J i individual X ij . Likewise, to form X we stack the N individual X i . If we define \u03b2 as a vector of length 2Q where the first Q elements are \u03b2 0 and the last Q elements are \u03b2 1 , then Equation (1) can be written as y \u00bc X\u03b2 \u00fe \u03b5. Fig. 1 shows a diagram of the model layout for a single subject."}, {"section_title": "Estimating within visit covariance", "text": "We start by estimating the sample correlation coefficient for all ROI pairs for all visits and their corresponding variances and covariances. Let \u00f0w 1t ; \u2026; w Pt \u00de' for t 2 f1; 2; \u2026; Tg be the time series of preprocessed BOLD signals from P ROI for a single visit, so that w pt indicates the t-th time point from the p-th ROI. Then for the p-th and q-th ROI,\n. We now address how to estimate the variance (or standard error) of sample correlations and the covariation between pairs of sample correlations, whenever these sample correlations are obtained from data that exhibit some degree of autocorrelation. To this end, we follow the approach described by Roy (1989) and Melard et al. (1991 can obtain an estimate of the variance and covariance using the following formula: where setting p \u00bc p' and q \u00bc q' gives us the variance of the sample correlation between the p-th and q-th ROI time series. We use Equation (2) to populate each \u03a3 ij block to get our estimates b \u03a3 ij . Roy (1989) derived the large sample covariance of two correlation coefficients from autocorrelated time series, and Melard et al. (1991) showed that Equation (2) consistently estimates this large sample variance.\nEstimating between subject covariance, \u03a8, and \u03b2 Using a generalized least squares (GLS) approach, we now proceed with the estimation of the between subject covariance \u03a8 and the regression coefficients \u03b2, conditional on the previously estimated withinvisit covariances, b \u03a3 ij . We use consistent estimators from the work of Laird (2004) . Although the framework allows for many different structures for \u03a8, we assume a block compound symmetry structure so that all diagonal blocks, \u03a8 0 , are equal and all off diagonal blocks, \u03a8 1 , are equal. The block compound symmetry assumption keeps the parameter space to a reasonable size, but note that one could easily consider other forms of \u03a8, such as an autoregressive structure, with minimal modification to the estimation procedure. We use the ordinary least squares estimator b \u03b2 \u00bc \u00f0X'X\u00de \u00c01 X'y to provide a stable initial estimate of \u03b2. We then update the two components of \u03a8 using method of moments style estimators. These estimators resemble the empirical variance estimates. To estimate \u03a8 0 we find the sum of squared errors for each visit and subtract the previously estimated b \u03a3 ij for each visit. We then sum all of these terms and divide the remaining covariance matrix by the total number of visits. This estimator is then an empirical estimate of the variance remaining after accounting for the already calculated \u03a3 ij terms averaged across all visits for all subjects. We estimate \u03a8 1 in a similar fashion, but here we no longer have to subtract any \u03a3 terms since \u03a3 is set to zero for the off diagonal blocks which \u03a8 1 occupies. \u03a8 1 then empirically estimates the average covariance between any two visits from a single participant. Exact formulas for \u03a8 0 and \u03a8 1 are shown below:\nTo increase model parsimony, different structures can be considered for \u03a3 ij , \u03a8 0 , and \u03a8 1 . For example, to enforce a diagonal structure, set all offdiagonal elements to 0, or to enforce a compound symmetry structure, set all diagonal elements to the average of the diagonal elements and likewise for the off-diagonal elements (Laird, 2004) . Changing the form of \u03a3 ij , \u03a8 0 , and \u03a8 1 allows the model to be fit with flexible variance assumptions as is often done in traditional generalized least squares linear models. We recommend selection of a parsimonious structure for the variance components to stabalize estimation and allow ROI pairs to borrow information from each other in the estimation of their variance terms.\nWith an estimate of \u03a8 obtained using Equations (3) and (4), we can now use the standard GLS formula to update the regression coefficients as\nAt this point we have two choices: iteratively update b \u03a8 and b \u03b2 until convergence (full convergence), or accept the estimates (one-step) and proceed with the inferential procedure. As we will see later, we will use a permutation test for inference, making it vital that we have a computationally efficient way to estimate the effects \u03b2 and variance component \u03a8. The one-step estimator provides a significant advantage in computing time as b \u03a8 and b \u03b2 must be estimated for each permutation of the inference procedure (Ganjgahi et al., 2015) . One-step GLS estimators are not new and have many desirable statistical properties, including maintaining consistency (Amemiya, 1977) .\nWe estimate b \u03b2; b \u03a8; and b \u03a3 for each group (CN and AD for ADNI) separately using this estimation procedure. Superscripts on the parameter estimates denote the group (e.g. b \u03b2 G1 ; b \u03a8"}, {"section_title": "G1", "text": ", and b \u03a3 G1 are the estimates for group 1)."}, {"section_title": "Inference", "text": "We consider two general hypothesis tests in our longitudinal FC model: the group difference in the baseline FC, and the group difference in the longitudinal trend in FC; other tests are possible with slight modifications to the procedure that we describe below. For each hypothesis, we would like to test for the significance of the group difference in both the global FC network of pre-defined ROI and the local ROI pair FC. We refer to the vector wide test of a difference in the parameter vector \u03b2 0 or \u03b2 1 as a global test and refer to a test of a group difference in a single element of \u03b2 0 or \u03b2 1 as a local test. To accomplish our hypothesis testing objectives, we use the Wald statistic,\nand adjust the contrast matrix, C, depending on the hypothesis of interest. For instance, to test for a global difference in \u03b2 0 , we replace all \u03b2 terms with the \u03b2 0 vector for the proper group and set the contrast matrix, C, to the Q \u00c2 Q identity matrix.\nWe estimate the variance of each group's regression coefficients using\n. Because the standard \u03c7 2 statistical leads to very high type I error levels when more than 3 ROI are selected, we resort to the following permutation testing procedure:\n1 Calculate residuals from the fitted model for each subject:\n2 Permute group assignments of e i . 3 Add the nuisance signal back to e i based on new permuted group assignments G \u00c3 . For the main effect (intercept) tests we add in the longitudinal trends by setting e\n4 Refit the model on e \u00c3 , the permuted, adjusted, and stacked residuals from step 3.\n5 Calculate a new Wald statistic for the fitted values of b \u03b2\nWe repeat steps 2 through 5 a large number of times to create a permutation distribution to be used as a reference distribution of the originally calculated test statistic. Although not immediately evident, step 3 in this permutation procedure is essential for valid inference. If we are testing for a difference in baseline FC, we must add in the longitudinal trend of the new permuted group assignment and, likewise, must add in the permuted group baseline FC when testing for differences in longitudinal trend. This step ensures that we are controlling for potential group differences in \u03b2 0 when testing for difference in \u03b2 1 and vice versa. The number of permutations determines the precision of the p-value and should be chosen to be large enough to offer sufficient precision after any multiple comparisons adjustment. In our particular data example using ADNI data with 10 ROI we chose to run 10,000 permutations. Because the obtained p-values are estimated discrete values, we additionally use a permutation p-value correction procedure, the necessity of which was shown by Phipson et al. (2010) . To account for the fact that 2Q local hypotheses are tested simultaneously, we then apply the false discovery rate (FDR) controlling procedure of Benjamini and Hochberg (1995) to the corrected p-values from the local tests. The permutation p-value correction helps avoid unadjusted p-values with value 0 which may improperly maintain significance after a multiple comparisons correction. Chung and Romano (2013) showed that studentized test statistics, such as the proposed Wald statistic, allow for valid inference in many permutation test settings. A recent comparison of the performance of different permutation strategies by Winkler et al. (2014) showed that the Ter Braak permutation testing procedure we use maintains nominal Type I error and is fairly robust (Ter Braak, 1992) . This method offers the additional advantage that the data only needs to be permuted once and the model only fit twice at each iteration of the permutation test to test all local and global hypotheses. Testing all hypotheses under a single permutation schedule greatly reduces the computational burden of the testing procedure. Fig. 2 shows a workflow chart of the previously described procedures used to estimate the model parameters and test hypotheses."}, {"section_title": "Simulation study setup", "text": "A series of simulations were designed with different data generating mechanisms to assess model performance. In all scenarios each time series contained 120 time points and had an autocorrelation structure that followed a first-order autoregressive process with an AR parameter of 0.3. A multivariate time series was simulated for each subject at three visits. For each visit, the Q correlations were simulated from a multivariate normal distribution where the mean and variance varied by group based on the simulation setting. For group 1, the mean vector was always assumed to be 0 and the covariance matrix was the same across all simulation settings. The simulations used P of either 3, 5, or 10 as the dimension of the multivariate normal distribution. For the 3 and 5 dimension settings only the first element of the group 2 mean vector was allowed to vary by simulation setting, while the other elements were set to match group 1. For the 10 dimension settings the first 5 elements of the group 2 mean vector varied by simulation setting and the other elements were again set to match group 1. 1000 Monte Carlo simulations were run for all simulation settings with 3 and 5 dimensions, and 500 simulations were run for the 10 dimensional simulation settings. Group sizes of 15 and 30 were considered. The true variance of the correlations was either equal for the two groups or the group 2 variance was double the group 1 variance. 500 permutations were used for the permutation test for all settings. Although more than 500 permutations would likely be desired in practice, the average effect across all simulations will remain the same with a reduced number of permutations with the advantage of a significant savings in computing time. The group size, number of visits, and time series length were selected to reflect values found in typical fMRI studies. The effect size of 0.1 is realistic for fMRI longitudinal scenarios. In the ADNI data an effect size of 0.1 or larger was observed for 20% of the baseline effects and a third of the trend effects over the range of ages under study. Considering a smaller effect size would lead to very similar conclusions with slight decreases in power across all the models. A summary of the simulation settings used can be found in Table 1 .\nWe chose to fit three versions of our model with different variance assumptions and estimation methods so they can be compared to each other. The first model considered was a full convergence model which iterated between b \u03a8 and b \u03b2 until convergence. It assumed an unstructured \u03a3 ij and compound symmetry for \u03a8 0 and \u03a8 1 . This model is referred to as the full convergence full variance model. The second was a one-step model which stops after one iteration of solving for b \u03a8 and b \u03b2. It also assumed an unstructured \u03a3 ij and compound symmetry for \u03a8 0 and \u03a8 1 and is referred to as the one-step convergence full variance model. The third model was a one-step model which assumed a diagonal structure for \u03a3 ij and scaled identity structures for \u03a8 0 and \u03a8 1 . This model is referred to as the one-step convergence reduced variance model. For a comparison to common practice, we also consider a massive univariate linear mixed effects (LME) model on the correlation coefficients with a random intercept per subject. Unfortunately, because the LME is a massive univariate approach, we can only run local hypothesis tests on ROI pair effects. For a comparison of global hypothesis tests results, we also fit a multivariate analysis of covariance (MANCOVA) model (Johnson and Wichern (2002) .)"}, {"section_title": "ADNI data", "text": "Data used in the preparation of this article were obtained from the ADNI database (http://adni.loni.usc.edu). ADNI was launched in 2003 as a public-private partnership, led by Principal Investigator Michael W. Weiner, MD. The primary goal of ADNI has been to test whether serial magnetic resonance imaging, positron emission tomography, other biological markers, and clinical and neuropsychological assessment can be combined to measure the progression of MCI and early AD. For up-todate information, see www.adni-info.org.\nWe preprocessed the ADNI data using both FSL (version 5.0.9, https://fsl.fmrib.ox.ac.uk/) and AFNI (version AFNI_17.0.15, https:// afni.nimh.nih.gov/). The preprocessing steps were as follows. We 1) applied motion correction to the images using FSL's mcflirt (rigid body transform; cost function normalized correlation; reference volume the middle volume) and then 2) normalized the images into the Montreal Neurological Institute space using FSL's flirt (affine transform; cost function correlation ratio). We used FSL's fast to 3) obtain a probabilistic segmentation of the brain to obtain white matter and cerebrospinal fluid (CSF) probabilistic maps, thresholded at 0.75. Using FSL's fslmaths, we 4) spatially smoothed the volumes using a Gaussian kernel with FWHM \u00bc 5 mm. We used AFNI's 3dDetrend to 5) remove nuisance signals, namely the six motion parameters, white matter and CSF signals, and the global signal. Finally, 6) the linear trend was removed from each time series using linear regression and a 4th order Butterworth low-pass filter with a 0.1 Hertz cutoff was applied to each fMRI time series.\nA subset of the ADNI data was used to demonstrate a practical application of our model. The data consists of longitudinal resting-state fMRI images collected at baseline, 3 months from baseline, 6 months from baseline, 12 months from baseline, and annually thereafter. There are two groups of interest, the CN group and the AD group. We focused our attention on late-onset AD and included only patients who were 65 years of age or older at baseline (van der Flier et al., 2011; Holland et al., 2012) . To better separate the AD and CN groups, only patients who remained in one group for the entirety of the follow-up were considered in our analysis. The remaining CN group consists of 111 visits from 30 patients (17 females and 13 males) with each patient having between 1 and 6 visits. The AD group consists of 79 visits from 26 patients (11 females and 15 males) with each patient having between 1 and 5 visits. The average age was 75.9 for the CN group with a range of 65.2-95.7, while the AD group average age was 76.7 with a range of 66.5-88.6.\nOur new method analyzes fMRI data at the region of interest (ROI) level. Thus, before fitting the model, the investigator must select a number of ROI to include in the FC network analysis. We used the Automated Anatomical Label (AAL) atlas to subdivide the brain into 116 anatomical regions (Tzourio-Mazoyer et al., 2002 ). We define the ROI level time series for a given region as the average of the time series from each voxel (3D location) within that region of the brain. We then selected P \u00bc 10 ROI for analysis of the ADNI data based on previous literature which has shown differences in FC between AD and CN patients in the DMN and hippocampi (Supekar et al., 2008; Greicius et al., 2004; Sorg et al., 2007) . The ten regions we selected were the left and right hippocampus (HC), parahippocampus (PHC), posterior cingulate (PCC), precuneus (PQ), and prefrontal cortex (PFC). In all results that follow an l suffix for an ROI denotes the left side of the brain and an r suffix denotes the right side. Because a full brain analysis of all 116 regions is not currently feasible using our method, investigators should select a set of ROI for their particular dataset and research question based on expert knowledge and literature review. Four models were fit to the ADNI data with differing assumptions. Model 1 is a one-step estimation model which assumes compound symmetry structure for \u03a8 0 and \u03a8 1 and unstructured \u03a3 ij . Model 2 makes the same assumptions for \u03a8 0 , \u03a8 1 , and \u03a3 ij but uses the full convergence estimator. Model 3 is a one-step estimation model assuming scaled identity structures for \u03a8 0 and \u03a8 1 and a diagonal structure for \u03a3 ij . Finally, Model 4 uses one-step estimation, assumes a diagonal structure for \u03a8 0 , sets all elements of \u03a8 1 to 0, and assumes a diagonal structure for \u03a3 ij . This final model is similar to a massive univariate approach which ignores the within-subject dependence. 10,000 permutations were run for all models fit to the ADNI data. The intercept of each model represents the FC strength of each group at age 65. Due to failure to control Type I error rates in the simulation study, we did not fit the LME/MANCOVA method to the ADNI data. Tables 2 and 3 show the simulation study results. Table 2 shows the global and local Type I error for the main effect (difference in baseline FC) and interaction (difference in change in FC across longitudinal time) across all simulations. The reported global test results are the average global Type I errors across 500 or 1000 Monte Carlo runs. The local test results are the average Type I errors of the unadjusted p-values for all null hypotheses across the 500 or 1000 Monte Carlo runs. While the local pvalues would be adjusted in practice, the numbers in the table provide easy reference to a nominal Type I error of 0.05. Table 3 shows the average global power and average local power using false discovery rate adjusted p-values. All permutation p-values were corrected in accordance with Phipson et al. (2010) . Additional simulation study results can be found in Table 6 in the Appendix. Table 4 shows the simulation results from fitting the one-step convergence full variance model to the 10 ROI simulated data. The final section of each of these tables shows the results for the LME/MANCOVA approach. In these sections, all local test results come from LME model and all global test results come from the MAN-COVA model. Table 2 shows roughly nominal Type I error rates for all three specifications of our model. The LME model also controls Type I error at a nominal level. The MANCOVA global tests show highly inflated Type I error for the main effect test and deflated Type I error rates for the interaction test. While there was some slight inflation in all three specifications of our model, especially for the 10 ROI simulations, the inflation was attenuated by the increase in sample size from 15 to 30 per group. Table 3 demonstrates adequate power, both locally and globally for all three specifications of our model. The LME model showed decreased power for local tests, especially when considering the 5 ROI scenario. This reduced power for the 5 ROI scenarios shows the LME model's decreased performance in higher dimensional scenarios. The MANCOVA Table 3 The power calculations for the simulation study. Power results for the main effect (group difference in intercepts) and interaction effect (group difference in longitudinal slopes) are reported both globally and locally. The global power results are averaged across all simulations. The local power results reported are FDR adjusted. In the LME Local, MANCOVA Global columns all local test results come from LME model and all global test results come from the MANCOVA model. global test had very high power in the main effect tests where it failed to control Type I error and relatively poor power in the interaction test where it demonstrated deflated Type I error. As expected, across all models power increased with larger group size and decreased with a larger true group 2 variance. Overall, for balancing Type I error and power, our models outperform the LME at the local level and the MAN-COVA at the global level."}, {"section_title": "Results", "text": ""}, {"section_title": "Simulation study", "text": "\nAll three specifications of our model out-performed the LME/MAN-COVA model. The LME model controlled Type I error rates at a nominal level, but saw decreased power, particularly as the dimension of the data increased. The MANCOVA global tests performed very poorly, failing to control Type I error at a 0.05 level. Our models improved performance in comparison to the LME/MANCOVA approach shows the utility of our method for both local and global hypothesis testing.\nSome interesting results also arise from comparison of the three specifications of our model. The two full variance settings match the true model of the simulated data, yet the reduced variance model did not suffer in comparison, even winning in certain scenarios. The reduced variance model may have offered similar performance because the smaller parameter space allowed for improved estimation. The reduced variance model did not capture the full true variance, but it still performed well by allowing the FC for each ROI pair to be correlated across multiple visits for a given subject. Performance may also change if stronger within-subject correlation was assumed for the simulations.\nFor the chosen simulation settings, the full convergence, full variance model showed a moderate increase in power for local hypothesis tests compared to the one-step, full variance model. The slight advantage for full convergence was less evident in the 3 ROI setting and did not translate to either global hypothesis test. Another primary difference in the three models was the computational time. The full convergence model took, on average, over 2.5 times longer to run. For reference, using a 3.7 GHz Quad-Core Intel Xeon with 16 GB ram, the average times to fit the one-step full variance model with 30 subjects per group for 3, 5, and 10 ROI were 3.8 s, 54.9 s, and 87.2 min, respectively. These results show that the time increases quickly with the dimension of the model. The computational time is largely driven by the permutation procedure. Thus, if a larger number of permutations is desired for the testing procedure, then the computational time will see a corresponding increase. The onestep model may serve as an adequate replacement for the fullconvergence model in certain computationally demanding scenarios."}, {"section_title": "ADNI results", "text": "We motivate the challenges of longitudinal FC analysis with a preliminary examination of the ADNI data. Fig. 3 shows spaghetti plots of the FC between the preprocessed fMRI time series obtained from two ROI pairs for the AD and CN groups. The clustering of points within each line shows the within-subject dependence. In addition, there is considerable Table 4 Type I error rates for the 10 ROI simulation scenarios for all globally null simulation settings for the one-step convergence full variance model. Type I errors for the main effect (group difference in intercepts) and interaction effect (group difference in longitudinal slopes) are reported both globally and locally. The global Type I errors are averaged across all simulations. The local Type I errors reported are unadjusted, averaged across all simulations and all null ROI pairs. Power results are reported both globally and locally. The global power results are averaged across all simulations. The local power results reported are FDR adjusted, averaged across all simulations and all non-null ROI pairs. The average and maximum standard error for the local tests were 0.014 and 0.016 for Type I error rates and 0.008 and 0.015 for power calculations. Fig. 3 . Spaghetti plots of the correlation between two ROI against age. Each point represents a visit, and each line represents a subject. The ROI represented in these plots are the left and right hippocampus (HCl and HCr), right precuneus (PQr), and right parahippocampus (PHCr).\nwithin-subject and within-group noise present in the estimates of FC. What is not evident from the figure is that the time series from which these correlations were obtained exhibit autocorrelation that contributes to the overall variability in FC. To add another level of complication, the figure depicts the marginal relationship between two ROI, but to properly model all of the selected ROI we need a joint model that considers the set of all possible pairwise groupings of the chosen ROI. Table 5 shows results from the global hypothesis tests and all local hypothesis tests that were significant before p-value adjustment for all four models. Neither the overall main effect or interaction term were found to be significant in the global tests for any of the four models considered. The only ROI pair level differences that remained significant after p-value adjustment and correction in any of the models were the differences in the CN and AD group longitudinal slopes in the FC between the left HC and the right and left PCC in Models 1 and 2. These models conclude that the FC between HCl and PCC declines at a significantly quicker rate in the AD population than in their CN counterparts. The estimated Model 1 and Model 4 group intercepts, group longitudinal trends, group differences in intercepts and longitudinal trends, and "}, {"section_title": "Discussion and conclusion", "text": ""}, {"section_title": "ADNI", "text": "The four models fit to the ADNI data present slightly different results. The difference between Model 1 and Model 2 is minimal. The nearly identical results show that the full and one-step convergence models can lead to very comparable results. With nearly identical resulting estimates and inference, the one-step estimator should be preferred in this case due to its significant computational advantage. Some more pronounced differences in results arise when Model 1 and 2 are compared with Models 3 and 4. All of the models produce similar estimates for \u03b2 0 and \u03b2 1 , but Model 4 saw a large reduction in power. When comparing Figs. 4 and 5 three of the four plots look very similar, yet the plots displaying \u00c0log 10 p-values demonstrate reduced power in Model 4. As mentioned earlier, Model 4 is essentially a univariate approach which does not account for the dependence within-visit between ROI pairs or the dependence between visits. Model 3 models the between visit dependence and gets a considerable boost in power compared to Model 4 in the analysis of the ADNI data. Although the results are somewhat mixed, Model 1 and Model 2 see a further slight boost in power over Model 3 for certain ROI pairs by accounting for the dependence between ROI pairs within a visit. The increased power of Model 1 and Model 2 to detect group differences over Model 4 exemplifies the utility of our novel longitudinal approach to fMRI FC network analysis.\nAlthough the output from Models 1 and 2 differs slightly from that of Model 3, they share some common patterns. In these models many of the local hypotheses that were significant prior to the FDR correction appear between the HC/PHC and the PCC. These group differences strengthen the one local hypothesis that is significant after FDR correction from Models 1 and 2, which shows a significantly larger decrease in FC between the HCl and PCCr in the AD group than in the CN group. While the significant results become marginal after FDR correction for Model 3, the fact that many other HC/PHC connections with the PCC show a similar pattern helps to indicate differing baseline and longitudinal trend effects in the FC of the two groups. This clustering of group differences can be seen in Fig. 4 with the smallest p-values (red and orange circles) appearing between the HC/PHC and PCC. Wang et al. (2006) , Sorg et al. (2007) , and Greicius et al. (2004) all noted decreased FC between the HC and PCC in patients with AD in analyses of cross-sectional data. Similar results from Supekar et al. (2008) showed decreased clustering coefficients for the HC. Our analysis confirms these results with the addition of a longitudinal component to the analysis. Our results not only conclude that AD and CN patients have differing FC between the HC and PCC, as the previous works have shown, but we also more clearly describe the group differences in FC across ages between these two regions."}, {"section_title": "Limitations and future work", "text": "Our familiar linear model framework allows for easy adoption and understanding of the model and its results. Additionally, the linear model framework offers many natural extensions. One could easily include terms for additional covariates such as scanner effect or sex. Different structures for the variance components could also be implemented to capture a wider range of possible correlation structures.\nOur current method has the advantage of allowing joint modeling of FC network between a set of ROI rather than taking a massive univariate approach. We see this joint modeling as a significant step forward, but complete brain analyses are still not yet feasible due to high computational demands of a model fit to many ROI and the limited sample size of many fMRI studies. Here we have fit models to 10 ROI, but many brain atlases include more than 100 regions. Our longitudinal FC model is likely only feasible for networks containing up to 15 ROI. In the future, dimension reduction techniques, such as regularization, could be introduced into the model to allow analysis of an entire brain atlas using sparse FC networks. The ability to run a full brain FC analysis would alleviate the issues arising from ROI selection but may also make interpretation more difficult as there would be thousands of pairwise connections to consider.\nThe selection of the proper structure for the variance components deserves more attention. While a block compound symmetry structure for \u03a8 has a natural interpretation similar to that of a random intercept, there are certainly other viable structures. Choosing between structures is not a trivial task. One way to alleviate the model selection dilemma is to introduce a more robust sandwich type estimator of d Var\u00f0 b \u03b2\u00de, in which case incorrect specification of the variance would lead to valid inference with only a reduction in power.\nFinally, GLS estimators such as ours typically require a missing completely at random (MCAR) assumption. While MCAR may not be reasonable for many datasets, our method relies less on this assumption because we opt for a permutation procedure. Our estimators maintain consistency in the missing at random scenario and our permutation testing procedure does not rely on distributional assumptions for the error terms required when using asymptotic results for inference (Laird, 2004) ."}, {"section_title": "Conclusion", "text": "We have introduced a novel variance components longitudinal model to estimate and draw inference on the group differences in FC networks using resting-state fMRI data. The model properly accounts for the correlation inherent in repeated measures data and the autocorrelation present in fMRI time series from which we construct the FC networks. For statistical inference for global and local tests about FC, we used a computationally efficient permutation testing procedure which outperforms the massive univariate LME/MANCOVA approach. The linear model framework and use of generalized least squares estimators offers great simplicity and a large number of natural extensions. This work fills a current gap in the literature by providing a general framework for estimation and hypothesis testing of longitudinal FC data. As a practical example, we applied the method to resting-state fMRI data from the ADNI database. Our analysis found a faster decline in FC between the HCl and the PCC in AD patients compared to the CN controls. This finding confirms the results of previous studies and helps solidify the central roles of the hippocampus and DMN in AD."}, {"section_title": "Table 6", "text": "Type I error rates for simulation study. Type I errors for the main effect (group difference in intercepts) and interaction effect (group difference in slopes) are reported both globally and locally. The global Type I errors are averaged across all models. The local Type I errors reported are unadjusted and averaged across all simulations and all null ROI pairs. "}]
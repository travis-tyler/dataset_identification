[{"section_title": "Landscape of MHC ligands in SARS-CoV-2 ::: Introduction", "text": "To determine the landscape of potential HLA ligands in SARS-CoV-2 (Figure 1, black), we first identified candidate MHC ligands by performing HLA-I binding prediction using NetMHCpan 4.0 (both EL and BA mode)18 and MHCflurry19 (8\u201311mers), and HLA-II binding prediction using NetMHCIIpan 3.220 and 4.021 (15mers), using alleles with >5% genetic frequency in the United States22,23 (full predicted sets: Table S1, S2). To assess the accuracy of these peptide/MHC binding prediction tools on viral peptides, we tested their performance on IEDB MHC affinity assay data values for viral peptides. Of the predictive models evaluated, NetMHCpan 4.0 (BA) and NetMHCIIpan 3.2 demonstrated the highest correlation of binding affinity predictions for Class I and Class II MHC, respectively (Figure S1A\u2013B). Therefore, these two predictors were for predicting MHC ligands. A measured peptide/MHC binding affinity of 500 nM or less is commonly used to identify MHC-binding peptides which are more likely to be T cell epitopes24. To account for the inaccuracy inherent to prediction (as opposed to measurement) of peptide-MHC affinity, we derived slightly stricter cutoffs. In order to achieve 90% specificity in IEDB binding affinity data, we use predicted binding affinity thresholds of 393.4 nM and 220.0 nM for Class I and Class II MHC, respectively, (Supplementary Figure 1C\u2013D). This filter was applied to NetMHCpan 4.0 and NetMHCIIpan 3.2 SARS-CoV-2 MHC binding predictions, which removed the majority of viral protein sub-sequences (Figure 2A\u2013B).\nWith the goal of finding epitope regions capable of inducing both CD4+ and CD8+ T cell responses, we analyzed our MHC ligand predictions for the set of overlapping HLA-I and HLA-II ligand combinations, referred to here as nested HLA ligands. To generate these nested HLA ligands, each predicted HLA-I ligand was paired with an HLA-II ligand with full sequence overlap, selecting for the HLA-II ligand(s) with highest population coverage (Figure 2C,D, n = 7344 pairs consisting of 2486 unique HLA-I ligand and 3138 unique HLA-II ligands). Predicted MHC ligands were not evenly distributed across the proteome, with local peaks and troughs observed that correlated between HLA-I and -II ligands (Figure 2C, bottom; Pearson correlation of HLA-I/II LOESS (span = 0.1): r = 0.703, p < 0.001). Notably, while SARS-CoV-1 T cell epitopes previously described in the literature were primarily located in the surface glycoprotein (S) and nucleocapsid protein (N) (Table S3)9,25\u201350, we observed a paucity of predicted MHC ligands in the nucleocapsid protein (N). Of 113 unique T cell epitopes described in the literature that were also found in the SARS-CoV-2 proteome, we observed only two HLA-I peptide sequences in our predicted nested HLA ligand set. Numbers of predicted nested MHC ligands were associated with protein length (Figure 2E, left), with orf1ab having the greatest count; however, normalizing by protein length demonstrated greater equality of distribution, with the three largest viral proteins (orf1ab, S, and N) being among the lowest ranked (Figure 2E, right).\nAs murine models for SARS-CoV-2 would be a powerful tool in understanding viral immunobiology, we determined which predicted HLA ligands were also predicted to bind murine H2-b/d MHC. NetMHCpan and NetMHCIIpan were run using the SARS-CoV-2 proteome against the H2-b and H2-d haplotypes, filtering by MHC-I ligands top 2nd percentile (n = 3053) and MHC-II ligands in the top 10th percentile (n = 1648). From this set, we observed an overlap of 887 peptides in MHC-I and 1571 peptides in MHC-II between murine and human sets (Figure 2F). For the nested HLA ligand set, we observed 825 and 848 overlapping murine MHC-I and -II ligands, respectively, with 846 HLA ligands containing both murine MHC-I and -II coverage.\nThe majority of HLA ligand sequences were predicted to bind to fewer than 50% of the U.S. population, particularly for HLA-I and nested ligands (Figure 2G). In accordance with higher population coverage distribution in HLA-II, predicted HLA-II ligands also demonstrated more binding alleles on average (mean alleles per peptide: HLA-I = 1.35, HLA-II = 2.80). Among the most common alleles were HLA-A*02:01 (n = 784), HLA-A*11:01 (n = 643), and HLA-A*03:01 (n = 383) for predicted HLA-I binding peptides and HLA-DRB1*01:01 (n = 5401), HLA-DRB1*07:01 (n = 3225), and HLA-DRB1*13:01 (n = 3022) for predicted HLA-II binding peptides."}, {"section_title": "CD8+ and CD4+ T cell epitope prediction ::: Introduction", "text": "Peptide/MHC binding is necessary but not sufficient for peptide epitopes to elicit T cell responses. We sought to identify a set of epitopes that would serve as good targets for a SARS-CoV-2 T cell vaccine. From the total pool of HLA-I, HLA-II, and nested MHC ligands, we sought to prioritize sequences which are predicted to be immunogenic from highly conserved regions of abundant viral proteins (Figure 3\nmiddle).\nTo predict the immunogenicity of MHC ligands, we fit a forward stepwise multivariable logistic regression model using peptide/HLA tetramer flow cytometry data curated from viral entries of the Immune Epitope Database (IEDB)17. Tetramer data was selected for the response variable because it provides unambiguous association between a peptide and its bound MHC, and additionally tests which specific peptide/MHC is capable of eliciting a T cell response. Each unique peptide-MHC was encoded with features derived from epitope prediction tools as well as features relating to amino acid content (See Methods: Immunogenicity modeling). Model performance in 5-fold cross validation demonstrated AUC values of approximately 0.7 and 0.9 for HLA-I and -II, respectively, in both training and test sets (Figure S2A\u2013B). Models demonstrated cleaner separation of tetramer positive and negative groups for CD4+ epitopes compared to HLA-I (Figure S2C\u2013D). To determine a cause for this difference in model performance, we examined predicted binding affinity scores between tetramer positive and negative epitopes, which demonstrated significantly better separation for CD4+ epitopes than CD8+ epitopes (Figure S2E\u2013F). In accordance with this difference in binding affinity distribution, the HLA-II model showed strong association between lower binding affinity and lower predicted tetramer positivity, while the HLA-I model showed a weaker inverse association (Figure S3). Due to these binding affinity distribution differences between IEDB HLA-I and HLA-II tetramer sets, a performance-based cutoff did not allow for equal filtering of CD4+ and CD8+ epitopes. Therefore, we filtered by GLM scores above the median in each HLA-I/II SARS-CoV-2 epitope group, which provided balanced selection while removing predicted low-immunogenicity epitopes (Figure S4).\nNext, we sought to prioritize epitopes derived from regions of low sequence variation across viral strains. A position-based entropy filter was applied to all epitopes (Figure S5), keeping those with an entropy score \u2264 0.1 (approximately 98% sequence identity) in all amino acid positions across MSA-aligned SARS-CoV-2 genomes within the Nextstrain database51,52. High entropy was observed in the well-described spike protein D614G polymorphic site (Figure S5A, red dot). Other areas of high entropy included positions 3606, 4715, 5828, and 5865 of orf1ab, and position 84 of ORF8 (all with entropy > 0.4). The majority of positions demonstrated >95% sequence identity, suggesting high homology between different SARS-CoV-2 viral genomes (Figure S4B). Lastly, as the likelihood of MHC presentation is correlated with protein expression53, we filtered epitopes to those derived from the three highest expressed SARS-CoV-2 proteins normalized by protein length (Figure S6)54. Protein abundance was determined from both semi-quantitative mass spectrometry and RNA-seq data54,55. After all these filtering steps, 292 CD8+, 616 CD4+ and 423 nested T cell epitopes were predicted. Relative proportions of HLA alleles were conserved throughout filtering (Figure 3, middle). Full peptide sets with all filtering criteria are listed in Tables S1 (HLA-I) and S2 (HLA-II)."}, {"section_title": "B cell epitope prediction ::: Introduction", "text": "In addition to identifying SARS-CoV-2 T cell epitopes, we sought to identify a set of linear B cell epitopes on the Spike protein which would serve as good targets for stimulating neutralizing antibody responses (Figure 1). Epitope candidates were derived from four published preprint mapping/array studies56\u201359 and one as-of-yet unpublished PEPperCHIP\u00ae peptide array study (for study details see Methods: Antibody epitope curation). Starting with an initial candidate pool of 58 linear epitopes with data to support in vivo generation in humans (Figure 4A, Table S4), we applied a set of filtering criteria to narrow our target space (Figure 4B):\nContiguous subsequences of the spike protein with high accessibilityExclude glycosylation sitesExclude regions with significant polymorphism between SARS-CoV-2 strainsKeep candidate epitopes within or adjacent to functional domains with evidence of antibody-mediated viral neutralization (RBD, FP, HR1, and HR2)Exclude any candidates shorter than four amino acids\nWe used SARS-CoV-2 S protein accessibility data from Grant et. al60, which resulted in 19 remaining regions after filtering for contiguous stretches with mean accessibility of 35%, minimum accessibility of 15%, requiring at least one residue to have accessibility greater than 50%, and the ends of a region to have at least 25% accessibility. Since many epitopes occur in multiple sources, we combined overlapping epitope candidates into 14 unique sequences. After filtering out epitopes containing glycosites, which may alter antibody binding characteristics61,62, 11 non-glycosylated regions remained. Two additional regions were removed because they contained polymorphic sites, defined by mutation frequency > 0.1% from Nextstain SARS-CoV-2 viral sequences. Of the remaining 9 regions, only 4 were close to functional domains which in the closely related virus SARS have evidence of antibody-mediated viral neutralization: the receptor binding domain (RBD), fusion protein (FP), and heptad repeat 1 and 2 (HR1/HR2)63\u201368. Adjacency to a functional region was defined as within 15 aa of either side of FP, HR1, and HR2, and within 50 aa of the RBD. A broader window was used for the receptor binding domain due to the known presence of neutralizing antibody epitopes in S1 of SARS outside of the RBD69. This filtering resulted in four remaining regions, of which our final criteria removed one which had length less than four residues (Figure 4B). This filtering criteria precluded the vast majority of total spike protein regions (Figure 4C), with three predicted antibody binding regions (residue lengths 18, 4, and 4) remaining (Figure 4D). All three epitope candidate regions were present on solvent-exposed surfaces of the S protein trimer 3D structure (Figure 4E). It is worth noting that the largest region, residues 456\u2013473 within the receptor binding motif (RBM) loop is only accessible when the RBD is in the \u201copen\u201d conformation."}, {"section_title": "Selection of human and murine SARS-CoV-2 vaccine peptides ::: Introduction", "text": "With the above filters applied to predicted T and B cell epitope candidates, we sought to derive a collection of minimal recommended peptide sets for all combinations of the following vaccine criteria: optimization for CD4+ responses, CD8+ responses, and coverage of predicted B cell epitopes. We derived 27mer sequences for these vaccine peptide sets, determining peptide combinations which maximized population coverage of T cell epitopes, with or without additional coverage for murine H2-b, H2-d, or both haplotypes (Figure 5A\u2013B). If population coverage was identical for multiple candidates, peptides were also optimized based on a manufacturability difficulty scoring system (Figure S7). Optimizing for CD4+ epitope population coverage demonstrated 88.5% population frequency encompassed by three 27mer peptides (Figure 5B: 1, 9, and 15), while CD8+ epitope optimization provided 95.8% population frequency coverage by three 27mer peptides (Figure 5B: 1, 4, and 14). CD4+/CD8+ co-optimization provided the best overall population coverage at 81.6% population frequency with four 27mer peptides (Figure 5B: 1, 6, 9, 13). While B cell epitope optimization provided CD8+ coverage above 85%, CD4+ coverage was only 52.8%, suggesting the design of a combination B cell/CD4+ T cell vaccine requires use of non-spatially overlapping sequences. Overall, selection of peptides which also provided both H2-b and H2-d epitope coverage did not greatly impact population coverage, suggesting these murine-encompassing sets may allow for vaccine studies in animal models whilst preserving human relevance. Across the different selection criteria for minimal vaccine peptide sets there was significant redundancy. Collapsing the set of vaccine peptides by unique sequences results in a final set of 22 27mer vaccine peptides (Figure 5B). In addition to 27mer peptides, all individual T/B cell epitopes (S, M, and N: Table S5; all proteins: Table S6) as well as 15mer (Figure S8) and 21mer (Figure S9) optimized peptide sets are also available."}, {"section_title": "Discussion", "text": "We report here a survey of the SARS-CoV-2 epitope landscape along with a strategy for prioritizing both T cell and B cell epitopes for vaccine development. Major vaccine efforts targeting coronaviruses have focused on generation of neutralizing antibody responses70\u201378. This is likely critical for vaccine efficacy; however, vaccines against SARS-CoV-2 may also generate non-neutralizing antibodies that facilitate viral entry into cells that express Fc receptor, a phenomenon known as antibody-dependent enhancement (ADE). It is possible that vaccines that elicit a vigorous cytotoxic T cell response will drive early killing of infected cells and mitigate the toxicity associated with ADE. In addition, CD4+ T cells provide help to B cells to support class switching, maturation, and antibody production, as well as promoting CD8+ T cell activation, maturation, and effector function. In light of this, we searched for vaccine peptide sequences which include both B cell epitopes as well MHC ligands predicted to drive CD4+ and CD8+ T cell responses at high population frequencies. Our current efforts are focused on testing the immunogenicity of these peptides in murine models, comparing those which contain overlapping and non-overlapping T and B cell epitopes. Results from such preclinical testing will inform an envisioned phase I clinical trial using a condensed peptide set targeting B cell epitopes with known viral neutralization plus optimal T cell epitopes.\nPrior work has surveyed the epitope space of SARS-CoV-2 using analysis of sequence homology with SARS-CoV-1 epitopes, prediction of linear B cell epitopes, and prediction of T cell epitopes using IEDB tools. Grifoni et al. reported predicted T and B cell epitopes based on cross-referencing of known SARS epitopes with sequence homology to SARS-CoV-2 against SARS-CoV-2-specific parallel computational prediction79. However, this study did not consider epitope mapping of SARS-CoV-2 convalescent antibody repertoires, which may be important to achieve high specificity of B cell epitope predictions. Ahmed et al. reported a set of predicted T and B cell SARS-CoV-2 epitopes with associated assay confirmation within the NIAID ViPR database. However, these predicted epitopes were largely limited to those with sequence homology between SARS-CoV-1 and SARS-CoV-2, given the paucity of available SARS-CoV-2 assay data. Several studies have identified l inear B cell epitopes on the SARS-CoV-2 surface glycoprotein from sera of viral exposed patients using peptide arrays56\u201358 as well as phage immunoprecipitation sequencing (PhIP-Seq)59. These studies are an important source of information but their results may include many epitopes from degraded proteins and thus would not be able to promote viral neutralization in vivo due to a lack of surface exposure. Our work adds to this important emerging field by analyzing the SARS-CoV-2 HLA ligand l andscape through binding affinity filters derived from validated IEDB HLA ligands, as well as deriving T and B cell vaccine candidates through rational filtering criteria grounded in SARS-CoV-2 biology, including predicted immunogenicity, epitope location, glycosylation sites, and polymorphic sites. No other study to date has considered all such features in their epitope selection process. Additionally, inclusion of corresponding murine epitopes allows for future studies to be performed in animal models of SARS-CoV-2. We expect the application of these filters will improve specificity of antiviral response. As such, future studies testing the immunogenicity and efficacy of these filtered vaccine candidates in murine models will provide information critical in the design of a rationally optimized human SARS-CoV-2 vaccine.\nAnother unique aspect of our epitope selection process is the prioritization of overlapping CD4+, CD8+, and B cell epitopes. As the role of T cell epitope vaccines has not yet been clearly studied in SARS-CoV-2, we furthermore cross-referenced human and murine T cell epitopes to allow for murine vaccine studies using human-relevant peptides in H2-b and H2-d haplotypes. We hypothesize that inclusion of CD8+ epitopes may allow for clearance of SARS-CoV-2 from infected cells, and the inclusion of CD4+ epitopes may allow for greater activation of both cytotoxic and humoral antiviral responses. While overlapping CD4+ and CD8+ epitopes allowed for selection of peptide candidates covering a large proportion of the population, B/T cell overlapping epitope regions were more sparse due to the paucity of predicted B cell candidates. Thus, we expect the inclusion of overlapping CD4+/CD8+ optimized peptides alongside B cell optimized peptides to provide the most robust and broad antiviral adaptive immune coverage.\nIn addition to epitope selection, optional adjuvant choice for a SARS-CoV-2 vaccine is currently unclear. Current evidence suggests a Th2 dominant response to be associated with worse outcomes9 - thus, adjuvant selection may play an important role in skewing the helper arm toward a Th1 phenotype. Studies testing these questions are currently underway in murine models. Additionally, preliminary analysis of scRNA-seq dataset in ACE2 expressing cells of the respiratory80\u201384 and gastrointestinal82,85,86 tracts demonstrated increased expression of non-traditional checkpoint inhibitors (VISTA, Galectin 9, VTCN1), suggesting these as potential pathways to target for vaccine co-therapy (Figure S10). It remains unclear at this time if any of these above pathways are exploited by SARS-CoV-2 for innate or adaptive immune evasion.\nOne limitation of our study is that, while we use epitope mapping data with direct biological evidence for B cell epitopes in SARS-CoV-2, the T cell epitopes we report were all derived from computational prediction. In an effort to partially overcome this weakness, we applied binding affinity and immunogenicity prediction filters grounded in validated IEDB binding and tetramer studies. Reassuringly, the two extant studies examining T cell responses in COVID-19 patients have identified recurrent T cell epitopes which overlap with the vaccine peptides presented here. Le Bert et al. looked for T cell epitopes within the nucleocapsid (N), NSP-7 and NSP-13 proteins in PBMCs of recovered COVID-19 patients using an IFN-\u03b3 ELISpot assay87. They identified two recurrent epitope regions (N101\u2013120, N321\u2013340) which overlap with multiple 27mer vaccine peptides in this paper (Figure 5B, peptides 4\u20138). Shomuradova et al. also identified COVID-19 patient T cell epitopes, but using A*02:01 tetramers loaded with 13 distinct peptides from the surface glycoprotein (S)88. Two of these 13 peptides showed recurrent reactivity across 14 A*02:01 positive patients (S269\u2013277 and S1000\u20131008). Both of these epitopes are also included in multiple 27mer vaccine peptides (Figure 5B, peptides 11 and 15).\nAnother potential l imitation of this study is the insensitivity of our experiments to the total potential space of SARS-CoV-2 antibody epitopes. Our B cell epitope analyses start with only 58 identified linear antibody epitopes on the surface glycoprotein of SARS-CoV-2, while it is likely that many other epitopes are possible. Second, these linear epitope mappings do not allow for identification of antibodies which bind tertiary/quaternary protein structures. Lastly, identification of epitopes via array studies depended on differences in antibody binding to potential linear epitopes between uninfected and infected persons. There may be some cross-reactivity between antibodies generated against other coronaviruses and SARS-CoV-2, which if present might show reactivity in our screening assay. If true, our strategy would not identify these epitopes as specific for SARS-CoV-2. Similarly, we excluded viral regions with significant polymorphism across the viral population. As polymorphic regions may be under selection pressure, at least some of which may be due to antiviral immunity, these regions may prove to be better epitope targets in patients infected by the relevant viral strains. We have avoided these in the current study, however, as we have focused here on conserved regions of SARS-CoV-2 to identify epitopes that would be most broadly targetable in the human population. For these reasons, we do not present our antibody data as describing the complete set of SARS-CoV-2 epitopes.\nA peptide vaccine targeting B cells, CD4+ T cells, and CD8+ T cells in parallel may prove an important part of a multifaceted response to the COVID-19 pandemic, as such an approach has a potentially favorable development timeline and the potential to avoid ADE by precisely directing the antibody response toward functional (neutralizing) regions. However, we emphasize that epitope selection is only one aspect of the problem, and a key question is whether a peptide vaccine can be sufficiently immunogenic. Adjuvant selection, conjugation to carriers such as KLH89 or rTTHC90, and prime/boost approaches using orthogonal platforms are all potential avenues to explore. We anticipate that the sets of vaccine peptides reported here may be valuable in the preclinical development of these approaches."}, {"section_title": "Antibody epitope curation ::: Methods", "text": "Linear B cell epitopes on the SARS-CoV-2 surface glycoprotein were curated from four published studies56\u201359. Three of these studies screened polyclonal sera of convalescent COVID-19 patients using either peptide arrays56,58 or phage immuno-precipation sequencing (PhIP-Seq)59. One study characterized the epitopes of monoclonal neutralizing antibodies57. Additionally, we were provided as-of-yet unpublished results from a study of sera from six SARS-CoV-2-naive patient sera and nine SARS-CoV-2-infected patient sera using PEPperCHIP\u00ae SARS-CoV-2 Proteome Microarrays. The peptides included in these proteome-wide epitope mapping analyses were limited to those which demonstrated either IgG or IgA fluorescence intensity > 1000U in at least two infected patient samples and in none of the naive patient samples. In addition, two peptides were also included (QGQTVTKKSAAEASK, QTVTKKSAAEASKKP) which demonstrated IgG fluorescence intensity > 1000U in only one naive patient sample each, but in four and five infected patient samples, respectively."}, {"section_title": "HLA ligand prediction ::: Methods", "text": "The SARS-CoV-2 protein sequence FASTA was retrieved from the NCBI reference database (https://www.ncbi.nlm.nih.gov/nuccore/MT072688). Haplotypes included in this analysis were derived from those with > 5% expression within the United States populations based on the National Marrow Donor Program\u2019s HaploStats tool22:\nHLA-A: A*11:01, A*02:01, A*01:01, A*03:01, A*24:02HLA-B: B*44:03, B*07:02, B*08:01, B*44:02, B*44:03, B*35:01HLA-C: C*03:04, C*04:01, C*05:01, C*06:02,C*07:01, C*07:02HLA-DR: DRB1*01:01, DRB1*03:01, DRB1*04:01, DRB1*07:01, DRB1*11:01, DRB1*13:01, DRB1*15:01\nAdditionally, HLA-DQ alpha/beta pairs were chosen based on prevalence in previous studies23:\nHLA-DQ: DQA1*01:02/DQB1*06:02, DQA1*05:01/DQB1*02:01, DQA1*02:01/DQB1*02:02, DQA1*05:05/DQB1*03:01, DQA1*01:01/DQB1*05:01, DQA1*03:01/DQB1*03:02, DQA1*03:03/DQB1*03:01, DQA1*01:03/DQB1*06:03\nFor HLA-I, 8\u201311mer epitopes were predicted using netMHCpan 4.018 and MHCflurry 1.6.019. For HLA-II caling, 15mers were predicted using NetMHCIIpan 3.220 and NetMHCIIpan 4.021. For optimization of epitope predictions, individual features from each HLA-I and HLA-II prediction tool was compared against IEDB binding affinities using Spearman correlation (Figure S1). Cutpoints for the best performing HLA-I and HLA-II feature were set using 90% specificity of predicting for peptides with < 500nM binding affinity in the IEDB set. The proportion of the total U.S. population containing at least one haplotype capable of binding each peptide was calculated assuming no genetic linkage:\n1\u2212\u220fi1\u2212fi2"}, {"section_title": "Immunogenicity modeling ::: Methods", "text": "IEDB HLA-I and HLA-II viral tetramer data were used to generate a generalized linear model (GLM, family = binary) with tetramer-positivity as a binary outcome. Independent variables for HLA-I included NetMHCpan 4.0 binding affinity and elution score, MHCflurry binding affinity, presentation score, processing score, and percentage of aromatic (F, Y, W), acidic (D, E), basic (K, R H), small (A, G, S, T, P), cyclic (P), and thiol (C, M) amino acid residues. Independent variables for HLA-II included NetMHCIIpan 4.0 binding affinity and elution scores, and percentage of aromatic, acidic, basic, small, cyclic, and thiol amino acid residues. All independent variables were normalized to 0\u20131 to keep coefficients comparable (binding affinities divided by 50,000). GLM model performance was derived using 5-fold cross validation, balancing for HLA alleles. The final HLA-I and HLA-II models were generated using each full IEDB set, then applied to SARS-CoV-2 predicted HLA ligands to derive a GLM score. For immunogenicity filtering, predicted epitopes above the median GLM score were kept."}, {"section_title": "SARS-CoV-2 entropy calculations ::: Methods", "text": "8,008 SARS-CoV-2 genome sequences were downloaded from GISAID (https://www.gisaid.org/)51. A preprocessing step removed 127 sequences that were shorter than 25,000 bases. The sequences were split into 79 smaller files and aligned using augur52 with MT072688.191 as the reference genome. The reference genome was downloaded from NCBI GenBank92. The 79 resulting alignment files were concatenated into a single alignment file with the duplicate reference genome alignments removed. The multiple sequence alignment was translated to protein space using the R packages seqinr93 and msa94. Entropy for each position was calculated using the following formula, where n is the number of possible outcomes (i.e. total unique identifiable amino acid residues at each location) and pi is the probability of each outcome (i.e. probability of each possible amino acid residues at each location):\n\u2212\u2211i=1npi\u22c5logpi"}, {"section_title": "Immunomodulatory molecule co-expression analysis ::: Methods", "text": "Single cell RNA sequencing data was collected from six respiratory datasets80\u201384 and three gastrointestinal datasets82, 85,86. ACE2+ cells were subsetted as cells with an expression of ACE2 greater than zero. The proportion of ACE2+ cells expressing the immunomodulatory genes were plotted with the circlize package95. Coexpression of the immunomodulatory genes that were expressed in greater than five percent of the ACE2+ cells were plotted as links."}, {"section_title": "Graphical and statistical analysis ::: Methods", "text": "Plots and analyses were generated using the following R packages: scales96, data.table97, ggrepel98, ggplot299, viridis100, ggnewscale101, seqinr93, DESeq2102, GenomicRanges103, gplots104, ggbeeswarm105, ggallin106, stringr107, gridExtra108, pROC109, caret110, RColorBrewer111, dplyr112, cowplot113, ggpubr114, doMC115, venneuler116, ComplexHeatmap117, and circlize95 packages. Figures 4C, 4D, and 5 were generated using the following Python packages: NumPy118, pandas119, Matplotlib120, and Jupyter121."}, {"section_title": "Code and Data availability ::: Methods", "text": "Data and analyses presented in this manuscript are available at: https://github.com/Benjamin-Vincent-Lab/Landscape-and-Selection-of-Vaccine-Epitopes-in-SARS-CoV-2\nSeveral data files larger than 100Mb and supplemental tables are available at: https://data.mendeley.com/datasets/c6pdfrwxgj/2"}]
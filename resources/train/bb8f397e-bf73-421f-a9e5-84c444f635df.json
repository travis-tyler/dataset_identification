[{"section_title": "Abstract", "text": "S u m m a r y :\nS u m m a r y :\nWe report VCPA, our SNP/Indel Variant Calling Pipeline and data management tool used for analysis of whole genome and exome sequencing (WGS/WES) for the Alzheimer's Disease Sequencing Project. VCPA consists of two independent but linkable components: pipeline and tracking database. The pipeline is coded in Workflow Description Language and is fully optimized for the Amazon elastic compute cloud environment. This includes steps for processing raw sequence reads including read alignment, and all the way up to variant calling using GATK. The tracking database allows users to dynamically view the statuses of jobs running and the quality metrics reported by the pipeline. Users can thus monitor the production process and diagnose if any problem arises during the procedure. All quality metrics (>100 collected per processed genome) are stored in the database, thus facilitating users to compare, share and visualize the results. To summarize, VCPA is functional equivalent to the CCDG/TOPMed pipeline. Together with the dockerized database (also available as Amazon Machine Image), users can easily process any WGS/WES data on Amazon cloud with minimal installation.\nVCPA is released under the MIT license and is available for academic and nonprofit use for free. The pipeline source code and step-by-step instructions are available from the National Institute on Aging Genetics of Alzheimer's Disease Data Storage Site (http://www.niagads.org/VCPA ). "}, {"section_title": "Introduction", "text": "The Alzheimer's Disease Sequencing Project (ADSP) is an integral component of the National Alzheimer's Project Act (NAPA) towards a cure of Alzheimer's Disease. ADSP will eventually analyze whole-genome sequencing (WGS) and whole-exome sequencing (WES) data from more than 20,000 late-onset Alzheimer's Disease (AD) patients and cognitively normal elderly to finding new genetic variants associated with disease risk.\nTo ensure all sequencing data are processed following the best practices with consistency and efficiency, a common workflow was developed by the Genome Center for Alzheimer's Disease (GCAD) in collabo-ration with ADSP. The workflow \"Variant Calling Pipeline and data management tool\" (VCPA), is used to process all the ADSP sequencing data. VCPA 1) is optimized for large-scale production of WGS and WES data, 2) includes a tracking database with web frontend for the user to track production process and review quality metrics; 3) is implemented using the Workflow Description Language (WDL) for easier deployment and maintenance, 4) designed for the latest human reference genome build (GRCh38/hg38, version GRCh38DH) and follows best practices for WGS analysis with input from TOPMed (Trans-Omics for Precision Medicine) and CCDG (Centers for Common Disease Genomics), two other large sequencing programs supported by National Institutes of Health (NIH).\nVCPA is composed of two independent but interoperable components: a tracking database ( Figure 1A ) with a web frontend ( Figure 1B ) and a SNP/indel calling pipeline ( Figure 1C ). The pipeline (available as an Amazon Machine Images (AMI): ami-82aa60f8) was optimized for automatic processing WGS/WES data in various file formats, from mapping sequence reads to the latest human reference genome (GRCh38/hg38) and variant calling. The tracking database (available as AMI: ami-acc840d3) was designed for monitoring the job status and recording quality metrics for each processed sample ( Figure 1B ). With a dynamic web interface of the database, researchers can easily compare, share and visualize all these individual level quality metrics."}, {"section_title": "SNP/INDEL CALLING PIPELINE", "text": "The variant calling pipeline for the WGS (stages 1 and 2a) was developed in coordination with CCDG/TOPMed functional equivalent pipelines [2] and follows best practices of Germline Single Nucleotide Polymorphisms (SNPs) & Insertion/deletion (indel) Discovery for Genomic Analysis Toolkit (GATK) v3.7 [3] . VCPA pipeline is unique, as it accepts WGS or WES pair-end reads in FASTQ, BAM (binary sequence alignment map format), or CRAM (compressed BAM) formats with flow cell information and genomic regions for exome sequencing enrichment/capture kits. The processing workflow is modularized and consists of four stages ( Figure 1C ). If needed, the workflow can be configured to skip specific stages to reduce time and cost.\n(1) Stage 0 includes preparation steps for read mapping. For samples already mapped previously, PICARD [8] is used to roll back BAM files to uBAM (unaligned BAM) files. For each project, the user starts by preparing a manifest file of sa IDs and sequencing read file locations. The manifest file is then up ed into the tracking database at a head node server (the databas track multiple projects), and the user can submit processing jobs fo samples individually or by batches by command line from the head Job dependency and error checking are implemented in the work Whenever multi-threading is supported by the third-party programs are run in parallel to expedite the process. A complete run of the pip produces ~200 files including analysis-ready quality scored binned alignment BAM/CRAM files, annotated gVCF files, and more than log files with data quality metrics and run information."}, {"section_title": "TRACKING DATABASE", "text": "The tracking database enables the user to monitor production ( Figure 1B) and review sequencing quality such as mapping percen depth coverage, and quality of called variants. The quality metrics are defined by projects and pipeline stages. All 113 quality metric collected during the pipeline execution and imported into the data and are viewable through an interactive web frontend display.\nThe tracking database is built on a LAMP (Linux, Apache H MySQL and PHP) application stack using the SLIM-PHP framew The application has a small memory and storage footprint, provi RESTful API interface to the MySQL back-end, and supports pass protection to restrict access. The tracking database is dockerized an be installed on-site (off the cloud) if preferred."}, {"section_title": "USING VCPA ON AMAZON EC2", "text": "We evaluated our pipeline using the NA12878 sample from the Ge In A Bottle project using the hg38 high confident set [15] . The g from running VCPA on GIAB sample were compared against the G truth variant calls using hap.py [16] . Sensitivity/precision of VCPA were 0.999/0.994 for SNPs and 0.985/0.987 for indels respectively comparable to TOPMed/CCDG workflows [2] . Using Amazon instance type r3.8xlarge (244.0 GiB, 32 vCPUs), we benchmarked ning time on WGS data of 9 ADSP Discovery and Discovery Exte phase samples (average 78 million reads) with different paired length and file types: 1) three BAMs of 100 bp reads; 2) three BAM 150bp reads and 3) three CRAMs of 150bp reads. Average proce time per genome was 26.43, 22.68 and 21.20 core-hours respective the three configurations/file-types. A  n  n  i  v  e  r  s  a  r  y  F  u  n  d  ,  p  r  o  j  e  c  t  1  5  4  3  5  .  A  R  I  C  r  e  s  e  a  r  c  h  i  s  c  a  r  r  i  e  d  o  u  t  a  s  a  c  o  l  l  a  b  o  r  a  t  i  v  e  s  t  u  d  y  s  u  p  p  o  r  t  e  d  b  y  N  H  L  B  I  c  o  n  t  r  a  c  t  s  (  H  H  S  N  2  6  8  2  0  1  1  0  0  0  0  5  C  ,  H  H  S  N  2  6  8  2  0  1  1  0  0  0  0  6  C  ,  H  H  S  N  2  6  8  2  0  1  1  0  0  0  0  7  C  ,  H  H  S  N  2  6  8  2  0  1  1  0  0  0  0  8  C  ,  H  H  S  N  2  6  8  2  0  1  1  0  0  0  0 "}]
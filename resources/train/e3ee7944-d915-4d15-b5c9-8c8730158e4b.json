[{"section_title": "Abstract", "text": "In this paper we develop a new approach to measuring the gains from economic integration based on a generalization of the Ricardian model in which heterogeneous factors of production are allocated to multiple sectors in multiple local markets based on comparative advantage. We implement this approach using data on crop markets in approximately 2,600 U.S. counties from 1880 to 1997. Central to our empirical analysis is the use of a novel agronomic data source on predicted output by crop for small spatial units. Crucially, this dataset contains information about the productivity of all units for all crops, not just those that are actually being grown-an essential input for measuring the gains from trade. Using this new approach we find substantial longrun gains from economic integration among US agricultural markets, benefits that are similar in magnitude to those due to productivity improvements over that same period. * We thank numerous colleagues, discussants, and seminar participants for helpful suggestions."}, {"section_title": "Introduction", "text": "How large are the gains from economic integration? Since researchers never observe markets that are both closed and open at the same time, the fundamental challenge in answering this question lies in predicting how local markets, either countries or regions, would behave under counterfactual scenarios in which they suddenly become more or less integrated with the rest of the world.\nThe standard approach in the international trade literature consists of estimating or calibrating fully specified models of how countries behave under any trading regime. Eaton and Kortum (2002) is the most influential application of this approach. A core ingredient of such models is that there exists a set of technologies that a country would have no choice but to use if trade were restricted, but which the country can choose not to use when it is able to trade. Estimates of the gains from economic integration, however defined, thereby require the researcher to compare \"factual\" technologies that are currently being used to inferior, \"counterfactual\" technologies that are deliberately not being used and are therefore unobservable to the researcher. Since information on these counterfactual technologies is not observed, this comparison is typically made through the use of untestable functional form assumptions that allow an extrapolation from observed technologies to unobserved ones.\nThe goal of this paper is to develop a new approach to the study of economic integration that is less dependent on extrapolation by functional form assumptions in order to obtain knowledge of counterfactual scenarios. Our basic idea is to focus on agriculture, a sector of the economy in which scientific knowledge of how essential inputs such as water, soil and climatic conditions map into outputs is uniquely well understood. As a consequence of this knowledge, agronomists are able to predict-typically with great success-how productive a given parcel of land would be were it to be used to grow any one of a set of crops. In short, both factual and counterfactual technologies are known in this particular context.\nOur theoretical framework is a multi-factor generalization of the Ricardian model of international trade, as in Costinot (2009). We focus on an economy featuring multiple local markets in which heterogeneous factors of production, which we refer to as \"fields,\" are allocated to multiple crops based on comparative advantage under perfect competition. The distinctive feature of our approach is that instead of making specific functional form assumptions about the pattern of comparative advantage across crops and fields, we use detailed micro-level data from the Food and Agriculture Organization's (FAO) Global Agro-Ecological Zones (GAEZ) project to construct the production possibil-ity frontiers (PPFs) associated with each local market, and in turn, conduct counterfactual experiments.\nWe implement our approach in the context of U.S. agricultural markets from 1880 to 1997. This setting offers an uncommonly long stretch of high-quality, comparable microdata from an important agricultural economy plausibly experiencing large changes in transportation costs. Our dataset consists of approximately 2,600 U.S. counties which we treat as separate local markets that may be segmented by barriers to trade-analogous to countries in a standard trade model. Each county is endowed with many \"fields\" of arable land-the median U.S. county contains 26 fields-and can produce up to 16 distinct crops. Figure 1 presents a sample of the GAEZ predictions about the pattern of comparative advantage across crops and fields in 2011. Throughout our empirical analysis, we assume that, within each county, the pattern of comparative advantage predicted by the GAEZ data is stable over time. That is, if agronomists from the FAO predict that a field is 10% more productive at producing wheat than cotton in 2011 compared to another field in the same county, then we assume that it is 10% more productive in all prior years, though productivity levels are free to vary across crops, across counties, and over time because of technological innovations or weather shocks. For instance, our empirical analysis allows the development and adoption of hybrid corn to raise corn productivity differentially across counties at different points in time; it merely rules out that this technological innovation may have a differential effect on corn productivity across fields from the same county at a given point in time. Given that counties are relatively small spatial units, we find this assumption plausible. And it receives some empirical support (within the GAEZ model), as we discuss below.\nIn order to quantify the gains from economic integration, we focus on the following counterfactual question: \"For any pair of years, t and t , what would the total value of crops produced in year t have been if trade costs were those of year t rather than year t?\" To answer this question we first need estimates of trade costs at different points in time. We proceed as follows. Under the assumption that the pattern of comparative advantage across crops and fields is stable over time, we show how to combine modern GAEZ data and historical Census data to identify the spatial distribution of crop prices and crop-specific productivity shocks across U.S. counties over time. The basic idea is to find the vector of crop-specific productivity shocks such that the predictions of our perfectly competitive model exactly match total output per crop as well as the total acres of land allocated to each crop in each county. Using classical results in general equilibrium theory, we first provide mild sufficient conditions-which we can test in the data-under Figure 1 : An example of relative productivity differences. Notes: Ratio of productivity in wheat (in tonnes/ha) relative to productivity in cotton (in tonnes/ha). Source: Authors' calculations based on data from the FAO GAEZ project.\nwhich such a vector of shocks is unique. Having identified productivity shocks, we then back out the vector of crop prices that, according to the model, must have supported this allocation as a competitive equilibrium. The difference between local crop prices, estimated from the model at the county level, and prices in a \"wholesale\" market, observed in historical data, finally give us a measure of trade costs faced by each U.S. county from 1880 to 1997.\nOnce changes in trade costs have been computed, addressing our main counterfactual question reduces to solving a simple linear programming problem, namely finding the vector of output on the PPF of each local market that would be produced given the counterfactual prices. Our results point towards substantial gains from economic integration. For example, our estimates imply that the gains from integration that were realized between 1880 and 1920 on the supply-side of the US agricultural sector (which we obtain by setting t = 1880 and t = 1920 in the counterfactual question posed above) were equivalent to 1.5% growth in real output per year throughout that 40-year period, or by 79% in total. Similarly, from 1954-1997 the gains amounted to 1.0% growth per year.\nAlthough our model of U.S. agricultural markets is admittedly stylized, it is rich enough to fit perfectly historical data on output and land allocation for each crop, each county, and each year in our dataset. In contrast, there is a priori no reason for the crop prices estimated using our model to fit those observed in the data. As described above, when inferring local prices, we do not use any direct information on prices: our estimates are only based on data on historical quantities and modern technology. To explore the validity of our model, we can therefore compare our estimates of county-level prices to historical state-level prices, which are the most disaggregated price data available over the long time period that we are interested in. 1 Reassuringly, the fit of our model along this key dimension is good. Despite the fact that we do not use any direct information on prices in our estimation, we find a robust, positive correlation between our price estimates and those observed in the data.\nAn attractive feature of our approach is that it allows us to estimate simultaneously trade costs and productivity shocks. Thus we can compare-using the same theoretical framework and the same data sources-how the gains from economic integration compare to productivity gains in agriculture (i.e., changes in the agricultural PPFs of each county) over that same period. Formally, we ask: \"What would the total value of crops produced in year t have been if productivity shocks were those of period t rather than period t?\" Answering this question again boils down to solving a simple linear programming problem. Our main finding is that the gains from trade cost reductions are similar in magnitude to those of pure agricultural productivity improvements. Put differently, our results imply that the impressive growth of U.S. agriculture from 1880-1997 appears to have been driven in roughly equal parts by improvements in agricultural technology within locations and by economic integration across locations.\nThe last part of our paper discusses the sensitivity of this result to a number of strong assumptions imposed in our baseline analysis. Specifically, we demonstrate that our estimates appear to be largely unaffected when: (i) we allow for a production technology that uses (equipped) labor as well as land, with the labor intensity and local labor price free to vary across locations and time; and (ii) when we use alternative methods for handling corner solutions where a crop is not produced in a county at all. And we find smaller, but still substantial, gains from economic integration when using an extremely conservative interpretation of price gaps as pure distortions (rather than transportation costs).\nIn the existing trade literature, most structural work aimed at quantifying the gains from international market integration is based on the seminal work of Eaton and Kortum (2002) . The standard approach can be sketched as follows. First, combine data on bilateral imports and trade costs between countries to estimate the elasticity of import demand (most often through a simple gravity equation). Second, use functional forms in the model together with elasticity of import demand to predict changes in real consumption associated with a counterfactual change in trade costs; see Costinot and Rodr\u00edguez-Clare (2013) for an overview. A series of recent papers on economic geography have used a similar approach to study the implications of domestic market integration; see e.g. Allen and Arkolakis (2014), Caliendo et al. (2016) , Ramondo et al. (2016), and Redding (2016) .\nOur approach, by contrast, focuses entirely on the supply-side of the economy. First we combine data on output and productivity to estimate producer prices, and in turn, trade costs. Second we use the exact same data to predict the value of output associated with a counterfactual change in trade costs. As emphasized above, the main benefit of our approach is that it weakens the need for extrapolation by functional form assumptions. The main cost of our approach-in addition to the fact that it applies only to agriculture-is that it does not allow us to talk about welfare. In order to estimate welfare gains from trade, we would also need consumption data, which is not available at the county-level in the United States over the extended time period that we consider. Our gains from economic integration instead correspond to production efficiency gains, i.e. to outward shifts in the aggregate PPF of the United States holding local PPFs fixed at the county-level.\nOur paper is related more broadly to work on the economic history of domestic market integration. A first strand of this literature uses market-level price data to estimate the magnitude of deviations from perfect market integration; see e.g. Slaughter (2001) , Shiue (2005) , and Keller and Shiue (2008) . Our approach, by contrast, first estimates marketlevel prices (and hence can be applied in settings, like ours, where local price data is not available), and then goes beyond the previous literature by estimating the magnitude of the production efficiency gains that would occur if market integration improved.\nAnother strand of the literature focuses on estimating the impact of past, large infrastructure investments such as railroads and highways; see e.g. Fogel (1964 ), Fishlow (1965 ), Michaels (2008 , Duranton and Turner (2012) , Herrendorf et al. (2012 ), Fajgelbaum and Redding (2014 ), Faber (2014 , Asturias et al. (2016 ), Alder (2016 , Donaldson (2016), and Donaldson and Hornbeck (2016) . Here, we remain agnostic about the various potential sources of market integration and develop instead a procedure for measuring the total gains from such integration by combining information about the observed choices of farmers at different locations as well as the technologies they have access to.\nFinally, we note that the GAEZ database has been used previously by Nunn and Qian (2011) to obtain predictions about the potential productivity of European regions in producing potatoes, in order to estimate the effect of the discovery of the potato on population growth in Europe. In subsequent work, we have also used the GAEZ database to test the predictions of the Ricardian model (Costinot and Donaldson, 2012) and to evaluate the consequences of climate change (Costinot, Donaldson and Smith, 2016) . In another follow-up paper, Sotelo (2016) also uses the GAEZ database to quantify the contribution of trade frictions to the low agricultural productivity of Peru. In addition to the fact that these papers focus on different countries and time periods, none of them uses theory and data to infer measures of trade costs and productivity shocks, nor is their focus on inferring realized gains from economic integration over time. As mentioned above, this is the core of the approach developed here.\nThe rest of this paper is organized as follows. Section 2 introduces our theoretical framework, describes how to measure local prices and, in turn, how to measure the gains from economic integration. Section 3 describes the data that feed into our analysis. Section 4 presents our main empirical results. Section 6 offers some concluding remarks. All formal proofs can be found in the Appendix."}, {"section_title": "Theoretical Framework", "text": ""}, {"section_title": "Basic Environment", "text": "Time is discrete and indexed by t. In our empirical analysis, t goes from 1880 to 1997. At any date t, we consider a static economy with multiple local markets indexed by i \u2208 I \u2261 {1, ..., I}, in which production occurs. Each local market is connected to a unique wholesale market, in which goods are sold. In our empirical analysis, local markets will be U.S. counties, whereas the unique wholesale market will be New York city. In each local market, the only factors of production are different types of equipped land or fields indexed by f \u2208 F i \u2261 {1, ..., F i }. All fields are of the same size, which we normalize to one. Fields can be used to produce multiple goods indexed by k \u2208 K \u2261 {1, ..., K + 1}. In our empirical analysis, goods 1, ..., K will be crops, of which there are 16 in our sample, whereas good K + 1 will be an outside good. We think of the outside good as manufacturing, forestry, residences, or any agricultural activity (such as livestock production) that uses land but does not correspond to the crops included in our dataset.\nFields are perfect substitutes in the production of each good, but vary in their exogenous productivity, A f k it > 0. Total output of good k in market i at date t is given by\nwhere L f k it \u2265 0 denotes the endogenous share of field f allocated to good k in market i at date t. Note that A f k it may vary both with f and k. Thus, although fields are perfect substitutes in the production of each good, some fields may have a comparative as well as an absolute advantage in producing particular goods.\nAll goods are produced by a large number of price-taking farms and shipped to a wholesale market. The profits of a representative farm producing good k in a local market i at date t are given by\nwhere p k it is the farm-gate price of good k in market i at date t. Shipments from the local markets to its wholesale market are subject to iceberg trade costs. In order to sell 1 unit of good k in the wholesale market, farmers must ship 1 + \u03c4 k it units with \u03c4 k it \u2265 0. Thus, non-arbitrage requires farm-gate prices, p k it , and prices of goods in the wholesale market,\nProfit maximization by farms further requires\nFinally, factor market clearing in each local market requires\nWe leave goods market clearing conditions unspecified, thereby treating prices in the wholesale market,p t \u2261 (p k t ) k\u2208K , as exogenously given. In the remainder of this paper we denote by p it \u2261 p k it k\u2208K the vector of farm gate prices, r it \u2261 (r f it ) f \u2208F the vector of field prices, and L it \u2261 (L f k it ) k\u2208K, f \u2208F the allocation of fields to goods in local market i. Armed with this notation, we formally define a competitive equilibrium as follows."}, {"section_title": "Definition 1.", "text": "A competitive equilibrium in a local market i at date t is a field allocation, L it , and a price system, (p it , r it ), such that conditions (1)-(3) hold."}, {"section_title": "Identification of Farm-Gate Prices and Productivity Shocks", "text": "In this section, we describe how we use theory and data to infer measures of local prices and productivity across time and space. We separate this description into two parts. The first part focuses on crops for which we observe production in a given location at a particular point in time, which we refer to as \"non-zero crops,\" while the second part deals with crops for which we do not observe production, which we refer to as \"zero crops.\"\nNon-zero crops. Our dataset contains, for each local market i \u2208 I, year t, and crop k = K + 1, historical measures of each of the following variables: (i) total farms' sales, S it , (ii) total output per crop,Q k it , as well as (iii) total amount of land allocated to each crop,L k it . Throughout our empirical analysis, we assume that none of these variables is subject to measurement error-that is, that these variables in the model (written without hats) equal their equivalents in the data (written with hats)."}, {"section_title": "A1.", "text": "In all local markets i \u2208 I and at all dates t, we assume that\nBy contrast, we do not have access to historical productivity measures. Instead we have access to measures of productivity,\u00c2 f k i2011 , for each field in each market if that field were to be allocated to the production of crop k in 2011-the agronomists who have assembled the GAEZ project data in 2011 aim for it to be relevant to contemporaneous farmers, not those in the distant past. Since we only have access to these measures at one point in time, we assume that the true productivity A f k it is equal to measured productivity, A f k i2011 , times some crop-and-market-and-year specific productivity shock, \u03b1 k it . A2. In all local markets i \u2208 I and at all dates t, we assume that\nThe key restriction imposed by equation (7) on the structure of local productivity shocks is that they do not affect the pattern of comparative advantage across fields within the same market. If field f 1 is deemed to be relatively more productive than field f 2 at producing crop k 1 than k 2 in 2011,\u00c2\n, then we assume that it must have been relatively more productive in all earlier periods, A\nThere is of course no available direct test of Assumption A2, since A f k it is unobserved. But the GAEZ project provides calculations of\u00c2 f k i2011 under a range of technology scenarios, some of which may be more relevant early in our 1880-1997 period, and it is reassuring to note (as detailed in footnote 7) that the differences in GAEZ model output across such scenarios are captured well by Assumption A2.\nIn addition, since we do not have any productivity data in the outside sector, we assume that in all local markets i \u2208 I and at all dates t, all fields have a common productivity in the outside sector, A f K+1 it = \u03b1 K+1 it for all f \u2208 F i . For notational convenience, we use the convention\u00c2 f K+1 i2011 \u2261 1 so that equation (7) also holds for the outside sector, though it should be clear that we do not have any productivity data related to this sector.\nFrom now on we refer to\nas an observation for market i at date t and to X as the set of observations such that Assumptions A1 and A2 hold. Given an observation X it \u2208 X , the first goal of our paper is to characterize the vectors of unobservable productivity shocks and good prices (\u03b1 it , p it ) that are consistent with perfect competition, as formalized in Definition 1. Let K + it \u2261 {k \u2208 K :Q k it > 0 or k = K + 1} denote the set of non-zero crops, i.e. crops with strictly positive output in local market i at date t, plus the outside good. In turn, let A\nit } denote the set of productivity shocks and prices, respectively, that are non-zero for all these goods k. We define admissible vectors of productivity shocks and prices as follows.\nDefinition 2. Given X it \u2208 X , a vector of productivity shocks and good prices (\u03b1 it , p it ) \u2208 A + it \u00d7 P + it is admissible if and only if there exists a field allocation, L it , and a vector of field prices, r it , such that (L it , p it , r it ) is a competitive equilibrium consistent with X it .\nTo characterize the set of admissible vectors of productivity shocks and good prices, we build on the First and Second Welfare Theorems. Namely, we start from the observation that for an allocation to be profit-maximizing, it must be efficient (First Welfare Theorem) and conversely, that any efficient allocation must be profit-maximizing for some non-zero price vectors (Second Welfare Theorem). Formally, for any X it \u2208 X and any\nit ) denote the set of solutions of the following planning problem:\nSince constraint (8) must be binding at the solution of the previous linear programming problem, L (\u03b1 it , X it ) characterizes the set of efficient allocations that, conditional on a vector of productivity shocks \u03b1 it , are consistent with output levels observed in the data.\nUsing the previous notation, the next theorem characterizes the set of admissible vectors of productivity shocks and good prices.\nTheorem 1 shows that the problem of solving for admissible productivity shocks and prices reduces to solving linear programs. According to equation (10), admissible vectors of productivity shocks correspond to vectors of productivity shocks such that the associated solution of (P)-which is necessarily consistent with output levels observed in the data, as mentioned above-is consistent with the total amount of land allocated to each crop in the data. 2 Conditional on the vector of productivity shocks and the solutions of the linear programming problem (P), admissible prices are then jointly determined by the zero-profit conditions (1) and (2)-which restricts relative prices through condition (12)-and the total sales observed in the data-which restricts the overall level of prices through equation (11).\nSince our dataset includes approximately 2,600 counties over 12 decades, having only to solve linear programs is very appealing from a computational standpoint. In spite of the high-dimensionality of the problem that we are interested in-we have 16 crops and the median U.S. county in our dataset features 26 fields-it is therefore possible to characterize the set of unknowns, i.e. \u03b1 it and p it for all i and t, in a short period of time using standard software packages.\nTheorem 1 characterizes the set of admissible vectors of productivity shocks and good prices, but leaves open the possibility that, for arbitrary observations, this set may not be a singleton. The next theorem provides sufficient conditions under which admissible vectors of productivity shocks and crop prices are uniquely determined for all non-zero 2 At a solution L of the planning problem (P), if a crop has zero output,Q k = 0, then the acres of land allocated to that crop are necessarily equal to zero, \u2211 f \u2208F i L f k it = 0. Thus when matching the land allocation across crops, we can restrict ourselves to non-zero crops, k \u2208 K\ncrops."}, {"section_title": "Theorem 2.", "text": "Suppose that an observation X it \u2208 X , an admissible vector (\u03b1 it , p it ) \u2208 A + it \u00d7 P + it , and the associated competitive allocation L it \u2208 L (\u03b1 it , X it ) satisfy two restrictions: R1. for any N \u2265 2, there does not exist {k n } n=1,...,N+1 \u2208 K\ni2011 } for all n; (ii) k 1 = k N+1 and k n = k n for all n = n, n = 1, n = 1; (iii) f 1 = f N and f n = f n+1 for all n; and (iv) measured productivity in local market i satisfies\u00c2\nis uniquely determined by equation (11) and\nBroadly speaking, there are two reasons why there may be more than one admissible vector of productivity shocks and prices for non-zero crops. First, the pattern of comparative advantage across goods may be \"weak.\" Second, the output vector associated with the equilibrium allocation may be collinear to a vertex of the PPF, i.e. we could be at a \"kink.\" The proof of Theorem 2 rules out the first possibility by imposing Restriction R1 and the second by imposing Restriction R2. Away from these two knife-edge cases, establishing the uniqueness of an admissible vector of productivity shocks and prices is akin to the problem of proving the uniqueness of a vector of competitive prices in an endowment economy (with productivity shocks playing the role of prices, the field allocation playing the role of demand, and the observed allocationL k it playing the role of the exogenous endowments). Since a version of the Gross-Substitute Property holds in our environment, we can do so using standard arguments. 3 Specifically, for N = 2, Restriction R1 states that there does not exist a pair of crops, k 1 and k 2 , and a pair of fields, f 1 and f 2 , with the same relative measured productivity, A\n. If such a pair of crops and fields existed, then there would be infinitely many productivity shocks for which an efficient allocation can match both the observed output levels,Q\nit , as well as the total amount of land allocated to each crop,L\nit . Starting from a given field allocation, one could reallocate some acres of field f 1 from crop k 1 to crop k 2 , reallocate the same number of acres of field f 2 from crop k 2 to crop k 1 , and readjust crop productivity, \u03b1\nit , to maintain output levels unchanged. By construction, the new productivity levels would be admissible as well. Restriction R1 extends that basic idea to larger chains of crops and fields within which such reallocations would be possible.\nIn contrast, Restriction R2 focuses on cases where productivity shocks are uniquely determined, but prices are not. At a kink, there is at least one pair of non-zero crops for which no field is simultaneously producing both crops. For that particular pair of crops, condition (12) merely puts bounds on admissible relative prices. To deal with such non-uniqueness issues, Restriction R2 requires that for all pair of non-zero crops, there exists a \"marginal\" field producing both crops. Under this restriction, condition (12) implies the stronger prediction that relative prices are uniquely determined by the relative productivity of the marginal field, as stated at the end of Theorem 2.\nWhile Restrictions R1 and R2 may be important in other contexts, in our particular context we find that R2 is always satisfied and R1 is violated only extremely rarely-in less than 0.1% of the county-year observations in our dataset. Our analysis below drops these counties from all ensuing calculations and estimates. Figure 2 illustrates graphically how we use aggregate data to infer unobserved farmgate prices and shocks to farmers' productivity. We consider a hypothetical county with three fields, and where the county is producingQ W units of wheat andQ C units of cotton (and so the relevant two-dimensional component of the PPF is illustrated). For expositional purposes, we decompose our procedure into three steps. Figure 2a represents how we would estimate prices under the assumption that productivity shocks are Hicksneutral. In this case, the shape of the PPF (solid line) is the same as in the GAEZ data (dashed line). So, we would only need to use output data to locate the point on the PPF such that the ratio of output is equal to the ratio observed in the data; the relative price of cotton would then be given by the slope of the PPF at that point (red line); and the absolute price would be such that total sales at that point are equal to those in the data, as per equation (11). Figure 2b maintains the assumption that productivity shocks are Hicks-neutral, but allows for an outside good. Thus not all land is allocated to cotton and wheat, hence the change in the shape of the PPF. In this case, we use information on the total amount of land allocated to crops to solve for the endogenous set of fields producing cotton and wheat. Finally, Figure 2c also allows for non-Hicks-neutral productivity shocks (common across all fields), as we do in Theorems 1 and 2. In this case, we take advantage of all the information in our dataset by using output as well as land allocation data for each crop, not just the aggregate amount of land allocated to all crops. Intuitively, knowing both total output and total acres of land allocated to each crop, we have then just enough information to identify crop-specific productivity shocks. Zero crops. Theorems 1 and 2 only provide information about crops that are produced in a local market at a given date. This is intuitive. For k / \u2208 K + it , we know that output is zero, but since the amount of resources allocated to these crops is also zero, we do not know whether this outcome reflects low prices or low productivity levels. For our counterfactual exercises, however, we will need to take a stand on what productivity shocks and prices were for zero crops, i.e. crops that were not produced. To fill this gap between theory and data, we make the following assumptions (and return to these in Section 5.3). First, we assume that whenever a crop is not produced in a given countyyear, the productivity shock is equal to the national average of observed productivity shocks for that crop, i.e. the average of shocks for counties where that crop is actually produced in that year."}, {"section_title": "A3.", "text": "In all local markets i \u2208 I and at all dates t, we assume that\nwhere n k t is the number of markets with positive output of crop k in period t. Second we use the fact that conditional on \u03b1 k it , condition (12) in Theorem 1 provides an upper-bound on the relative price of crops with zero output. If k / \u2208 K + it , then an admissible price p k it must be bounded from above by min k \u2208K\n. In our baseline counterfactual exercises, we assume that this upper-bound is binding."}, {"section_title": "A4.", "text": "In all local markets i \u2208 I and at all dates t, we assume that\nwhere \u03b1 k it is given by equation (13). Assumptions A3 and A4 highlight that our approach is not free of assumptions about \"counterfactual\" technologies, as lack of information about zero crops still requires us to make untestable assumptions about the productivity (and prices) such crops. It should be clear, however, that this requirement is fairly mild in the sense that Assumptions A3 and A4 do not need to be invoked whenever a field does not produce a crop, they merely need to be invoked when all fields in a local market do not produce a crop.\nthe price and productivity of crops under Restrictions R1 and R2, the lack of output data for the outside good does not allow us to separately identify productivity and prices for that good. Variations in the total amount of land allocated to crops only allow us to identify the value of the marginal product of land in the outside sector, that this \u03b1\nit . This implies, in particular, that we will not be able to measure trade costs in that sector, a point that we come back to in Section 2.3."}, {"section_title": "Counterfactual Analysis", "text": "The goal of Section 2.2 above was to infer the unknown farm-gate prices (p k it ) and productivity shocks (\u03b1 k it ) that prevailed in each local market i, year t, and crop k in our dataset. We have described a procedure by which these unknowns can be identified from aggregate, i.e. county-wide, data on farmers' choices about what to grow using how much land. We now turn to the second stage of our analysis, in which we aim to measure the gains from a counterfactual rise in economic integration and compare them to counterfactual productivity gains in agriculture.\nGains from economic integration. In order to measure gains from economic integration, we first need to estimate trade costs and how they vary over time. For any crop k = K + 1, either Theorem 2 or Assumption A4 provides a measure of p k it . Thus we can estimate trade costs by rearranging the non-arbitrage condition between farm-gate prices and prices in wholesale markets:\nGiven measures of \u03c4 k it , we then estimate gains (or losses) from changes in the degree of economic integration across markets between two years t and t by answering the following counterfactual question: \"What would the total value of crops produced in year t have been if trade costs were those of year t rather than year t?\"\nTo construct this first set of counterfactual equilibria, we proceed as follows. For each crop, we assume that farmers in market i at date t maximize profits facing the counterfactual prices,\nwhere trade costs at dates t and t are computed using equation (15) . In addition, we assume the land allocation to the outside good in the counterfactual equilibrium, L f K+1 i T , to be equal to its allocation in the initial equilibrium, L f K+1 it . 5 Formally, the field allocation and the supporting field prices in the counterfactual equilibrium, L T i and r T i are thus\ngiven by the solution of:\nHaving solved for the field allocation in the counterfactual equilibrium using conditions (16)- (18), we can compute the counterfactual output level of crop k in market i at date t\nWe then measure the gains (or losses) from changes in the degree of economic integration between two periods t and t as:\nBy construction, \u2206W T tt measures by how much the total value of output across crops between years t and t increased (or decreased) because of the change in trade costs between these two years. It is important to note that in equation (19), we use local prices to evaluate output both in the original and the counterfactual equilibrium. This is consistent with the view that differences in local crop prices reflect \"true\" technological considerations: farmers face the \"right\" prices, but local prices are lower because of transportation costs. One can therefore think of \u2206W T tt as a measure of aggregate productivity gains in the transportation sector, broadly defined, between t and t . 6 We discuss alternative interpretations of price gaps in Section 5.1.\nProductivity gains in agriculture. We follow the same approach to estimate the gains (or losses) from productivity changes in agriculture. Namely, for any pair of years t and t , we ask: \"What would the total value of crops produced in year t have been if productivity shocks were those of period t rather than period t?\" The answer to this question provides an aggregate measure of productivity changes in agriculture between these two periods.\nTo construct this second set of counterfactual equilibria, we assume that productivity shocks in year t are given by \u03b1 k i A = \u03b1 k it rather than the inferred productivity shocks \u03b1 k it . In line with the previous counterfactual exercise, we also assume that the land allocation to the outside good is the same as in the initial equilibrium. Thus the new field allocation and the supporting field prices, L A i and r A i , are now given by the solution of:\n, for all f \u2208 F i .\nIn turn, the new counterfactual output level of crop k in market i at date t is given by\n. Using this notation, we measure the gains (or losses) from productivity changes in agriculture between two periods t and t as:\nThe rest of our analysis implements the approach described in this section in the context of U.S. agricultural markets from 1880 to 1997."}, {"section_title": "Data", "text": "Our analysis draws on three main sources of data: modern data on predicted productivity by field and crop from the FAO-GAEZ project; historical county-level data from the US Agricultural Census on output by crop, cultivated area by crop, and total sales of all crops; and historical data on prices. We describe these here in turn."}, {"section_title": "Modern Productivity Data", "text": "The first and most novel data source that we make use of provides measures of productivity,\u00c2 f k i2011 , by crop k, county i, and field f in 2011. These measures come from the Global Agro-Ecological Zones (GAEZ) project run by the Food and Agriculture Organization (FAO). The GAEZ aims to provide a resource that farmers and government agencies can use (along with knowledge of prices) to make decisions about the optimal crop choice in a given location that draw on the best available agronomic knowledge of how crops grow under different conditions.\nThe core ingredient of the GAEZ predictions is a set of inputs that are known with extremely high spatial resolution. This resolution governs the resolution of the final grid cells in the GAEZ database and, equally, the resolution of the \"fields\" in our analysis.\nThere are a total of 114,071 fields in the U.S. counties that comprise our empirical analysis, with 26 fields in the median county.\nThe inputs to the GAEZ database are data on an eight-dimensional vector of soil types and conditions, the elevation, the average land gradient, and climatic variables (based on rainfall, temperature, humidity, sun exposure), in each field. These inputs are then fed into an agronomic model-one for each crop-that predicts how these inputs affect the \"microfoundations\" of the plant growth process and thereby map into crop yields. Naturally, farmers' decisions about how to grow their crops and what complementary inputs (such as irrigation, fertilizers, machinery and labor) to use affect crop yields in addition to those inputs (such as sun exposure and soil types) over which farmers have very little control. For this reason the GAEZ project constructs different sets of productivity predictions for different scenarios of farmer inputs. Throughout we use the scenario that relates to a high level of such inputs (including irrigation). 7 Finally it is important to emphasize that while the GAEZ project has devoted a great deal of attention to testing their predictions on knowledge of actual growing conditions (e.g. under controlled experiments at agricultural research stations) the GAEZ project does not form its predictions by estimating any sort of statistical relationship between observed inputs around the world and observed outputs around the world. Indeed, the model outlined above illustrates how inference from such relationships could be misleading; the average productivity among fields that produce a crop in any given market and time period is endogenous and conditioned on the set of fields who choose to produce that crop at prevailing prices."}, {"section_title": "Historical Output, Area and Sales Data", "text": "The second set of data on which we draw contains records of actual output by crop, Q k it , area of land harvested under each crop,L k it , and the nominal value of total sales of all crops taken together,\u015c it , in each U.S. county from 1880-1997. 8 These measures 7 Since we allow for crop-and-market-and-year specific productivity shocks, different GAEZ scenarios may only affect our estimates of changes in prices and productivity over time if they predict different relative productivity across fields within the same county. To get a sense of the sensitivity of our results to the choice of alternative GAEZ scenarios, we can therefore regress the predicted productivity of field f for crop k in county i under each available alternative scenario on a crop-county-scenario fixed effect. If the R-squared of that regression was 1, then choosing different GAEZ scenarios would have no effect on our empirical results. We find that the R-squared ranges from 0.78 to 0.82. This suggests that using alternative GAEZ scenarios is unlikely to have quantitatively important effects on our measure of the gains from economic integration. 8 We refer to the years in our dataset by the years in which the corresponding Census was published (e.g. 1880) rather than the year in which farmers were enumerated (1879).\ncome from the Census of Agriculture that began in 1840 and has been digitized in Haines (2005) . 9 The Census was conducted decadally until 1950 and then roughly once every five years thereafter; however, the 1930 and 1940 data are not available in digital form (for all counties in our sample), and the 1950 data do not contain all of the information required for comparison with later years. Although the total output of each crop in each decade in each county is known, such measures are not available for spatial units smaller than the county (such as the field, the resolution at which the GAEZ data are available).\nAn important consideration when using the data on total crop sales to construct\u015c i is that farmers from 1880-1920 were asked to report the total value of crops produced, whereas from 1954 onwards farmers were asked to report the value of crops actually sold. For this reason in our use of the data here we simply avoid making comparisons across the 1920-1954 period in which the two proxies for\u015c i differ.\nThroughout, we use only the regions spanning the 2,636 counties that reported agricultural output data in 1880; see Figure 3 . 10 Finally, we work with 16 major crop categories that can be tracked across the entire 1880-1997 period (and for which output, area and total sales data are available in each sample year). These crops are listed in Table 1 below."}, {"section_title": "Historical Price Data", "text": "In our empirical analysis, we assume that all of the counties in our sample (of Eastern U.S. counties) were trading at least some of their output with one major agricultural wholesale market, that in New York City. This implies that the New York City price can be used as the reference price (since free arbitrage would ensure that, under this assumption, p k it = p k t / 1 + \u03c4 k it always holds). We further assume that trade costs within New York state were small (relative to the costs of trading at longer distances) such that we can obtain an estimate of the reference price, the New York City wholesale market price, from the New York state farm-gate price.\nWe obtain New York state farm-gate prices from two data sources. First, we use the Agricultural Time Series-Cross Section Dataset (ATICS) from Cooley et al. (1977) , which 9 While the Agricultural Census began in 1840, it was not until 1880 that the question on value of total crop sales was added. For this reason we begin our analysis in 1880. 10 The exact set of counties changed across Census years (rising to 2,993 by 1997) due to redefinitions of county borders. None of our analysis requires the ability to track specific counties across time so we work with this unbalanced panel of counties. When mapping a county in year t to the same county in year t we use the county whose geographic centroid in year t is closest to the centroid of the county in question from year t. covers the period from 1866 (at the earliest) to 1970 (at the latest). 11 Second, we have extracted all of the post-1970 price data available on the USDA (NASS) website so as to create a price series that extends from 1880 to 1997.\nWe use the same data sources to obtain historical crop prices in all other states. While such data is not necessary for our counterfactual analysis, below we assess the goodness of fit of our model by comparing farm-gate prices observed at the state-level to the withinstate average of county-level prices predicted by our model. 12"}, {"section_title": "Empirical Results", "text": "Our empirical analysis uses Theorems 1 and 2 to estimate the local prices and productivity shocks for each of our 16 crops in each of our approximately 2,600 counties, in each of our sample years from 1880 to 1997. In Sections 4.1 and 4.2, we start by presenting summary statistics of these estimates and explore their plausibility. We then go on, in Section 4.3, to use these estimates to compute the gains from economic integration and productivity gains within U.S. crop agriculture from 1880 to 1997. Notes: Values of p k it /p k t for the indicated years t, crops k, averaged (and standard deviation) across all sample U.S. counties i. Entries indicated by \"-\" are those for which the crop was not reported as produced in any county. Table 1 reports the national average and standard deviation of the farm-gate prices estimated using Theorems 1 and 2 for our 16 crops in 1880, 1920, 1950, and 1997 . All prices are reported relative to the New York price. Two broad trends are evident. First, the farmgate price (relative to the New York price) is rising over time, which is consistent with a broad reduction in trade barriers. And second, the standard deviation (within crops, across counties) appears to also be falling over time-consistent again with reductions in trade barriers and market integration. 13 Analogously to Table 1 , our estimates of productivity shocks \u03b1 k it are reported in Table  2 . Naturally, the general trend here is of technological progress throughout the history of US Agricultural Census data from 1880-1997, as the reported estimates of \u03b1 k it are rising almost uniformly over time from . And reassuringly, the magnitude of \u03b1 k it for Notes: Values of \u03b1 k it for the indicated years t, crops k, averaged (and standard deviation) across all sample U.S. counties i. Entries indicated by \"-\" are those for which the crop was not reported as produced in any county."}, {"section_title": "Estimates of Farm-Gate Prices and Productivity Shocks", "text": "most crops appears to be converging to a level that is relatively close to 1 by 1997. This is consistent with the notion that GAEZ's estimates of agricultural productivity (i.e.\u00c2 f k i2011 ), which are designed to be relevant in 2011, are on average not far off the magnitudes required for our model to rationalize the data in 1997."}, {"section_title": "Model Fit", "text": "By construction, our model perfectly fits data on (i) total farms' sales,\u015c it , (ii) total output per crop,Q k it , as well as (iii) total amount of land allocated to each crop,L k it , in all counties at all points in time. To evaluate the goodness of fit of our model, we therefore propose to compare our estimates of local prices-estimates that have been computed without using any direct information on prices-to the prices that are actually observed in the data. 14 14 One could also imagine comparing the productivity shocks inferred form our model to those observed in the data. It is less clear, however, how to define \"observed productivity\" and how to interpret differences between our estimates of productivity shocks, \u03b1 k it , and \"observed productivity.\" Suppose, for instance, that we were to useQ k it /L k it as observed productivity in county i for crop k at date t. Seen through the lens of our model, differences between \u03b1 k it andQ k it /L k it can always be interpreted as a measure of the importance of the endogenous sorting of heterogeneous fields across crops. This implies that these differences cannot shed light on whether inferred productivity shocks are plausible or not. Notes: Columns (1) and (5) report uncentered R-squared values. Columns (1)- (4) report regressions of our estimates of farm-gate prices, p k it , (averaged across all counties i in a state) on state-level farm-gate price data. Columns (5)-(8) do the same but with both variables in logs. Robust standard errors, clustered at the state-level, are reported in parentheses. *** indicates statistically significant at 0.1% level.\nAs mentioned before, the best available farm-gate price data available are at the statelevel, whereas our price estimates are free to vary at the county-level. In order to compare our price estimates to the state-level price data we therefore simply compute averages across all counties within each state, for each crop and year. 15 We then simply regress our price estimates on the equivalent prices in the data, pooling across crops, states, and years. Table 3 contains the results of these simple regressions in logs or levels, with or without constant, with or without crop and year fixed effects. In all cases we find a positive and statistically significant correlation between the two price series, with a coefficient that varies between 0.69 and 1.05 depending on the specification. 16 While most of the coefficient estimates are below one (the result that would obtain if price estimates agreed perfectly with price data) this is unsurprising given that the regressor, actual price data, is potentially mis-measured from our perspective because it constitutes a state-level average of underlying price observations whose sampling procedure is unknown. Since our procedure for estimating local prices had nothing to do with price data at all-its key inputs were data on quantities and technology-we view the robust correlation between our price estimates and price estimates in real data as reassuring."}, {"section_title": "Gains from Economic Integration", "text": "We now turn to our estimates of the gains from economic integration. As discussed in Section 2.3 above, we estimate these gains between any dates t and t by answering the following counterfactual question: \"What would the total value of crops produced in year t have been if trade costs were those of year t rather than year t?\" Armed with estimates of local farm-gate prices, we then compute these gains or losses using equations (15)-(19).\nWe focus on two groups of counterfactual scenarios that correspond to the periods 1880-1920 and 1954-1997 . As mentioned in Section 3.2, the sales data (used to construct S i ) cannot be used to draw comparisons between years prior to 1920 and years after 1954.\nIn the first group of counterfactual scenarios, t corresponds to 1920 and t corresponds to years from 1880 to 1920. In the second one, t corresponds to 1997 and t corresponds to years from 1954 to 1997.\nOur results are presented in Figure 4a (for 1880-1920) and Figure 4b (for 1954-1997) . In each case, the blue line plots our estimates of \u2206W T t,t , for the comparisons of t to t referred to above, but where-to ease comparisons between comparisons of different lengths in time-\u2206W T t,t is expressed as an annualized growth rate between year t and year t . 17 For example, the gains from 1880 to 1920 revealed here are equal to 1.46% of annual growth in real output over each of the 40 years from 1880 to 1920-equivalent to 79.3% growth in total over the 40-year time period. 18 And the estimated gains from 1954 to 1997 are equivalent to 1.02% annual growth per year for 43 years (i.e. 55.0% growth in total). These estimates imply that substantial inter-spatial price differences have existed within the United States, but that these differences have become smaller over time (both before and after the second World War).\nTo put these estimates in context we compare them, in Figures 4a and 4b , to the growth of productivity within the agricultural sector; that is, we plot (in green) the counterfactual change in real output that value of output, \u2206W A tt , that would have occurred purely due to the change in agricultural productivity between t and t (again expressed in terms of annualized effects). If we consider instead this counterfactual scenario in which year t technology is replaced with year t technology (holding trade costs and hence prices fixed at their year t levels) we again find large per annum gains-for example, of 0.82% per year from 1880 to 1920 or 1.22% per year from 1954 to 1997. That is, gains from economic integration (shown in red) are in most years similar in magnitude to the gains from pure 17 Specifically, Figure 4 presents values of annual growth rates g T tt that satisfy \u2206W T t,t = exp g T tt (t \u2212 t) \u2212 1, and analogously for \u2206W A t,t . 18 As is clear from equation (19), and evident in Figure 4 , \u2206W T tt = 0 if t = t , and the same is true for all of our reported gains estimates, \u2206W tt . agricultural productivity growth (shown in green)."}, {"section_title": "Sensitivity Analysis", "text": "To measure the gains from economic integration and compare them to productivity gains in agriculture, we have made a number of strong assumptions. First, we have interpreted the price gaps inferred from our model as transportation costs between local and wholesale markets. Second, we have assumed that equipped land was the only factor of production. Third, we have assumed that for all zero-crops, productivity shocks were equal to their national average and prices were equal to their upper-bounds. We now discuss the sensitivity of our estimates of the gains from economic integration to these assumptions."}, {"section_title": "Alternative Interpretations of Price Gaps", "text": "In our baseline analysis, we have interpreted price gaps, \u03c4 k it = p k t /p k it \u2212 1, inferred from our model as transportation costs. Under this interpretation, the prices used to estimate the value of output should be local prices, as in equation (19) . In the same spirit as the work of Hsieh and Klenow (2009) on misallocations, we now propose to interpret price gaps as \"wedges,\" i.e. taxes, that may vary across crops over space at different points in time. The basic idea is that in order to maximize total agricultural revenue in the United States, local farmers should be maximizing profits taking the reference pricesp k\nIn practice, such distortions may reflect location-specific quotas on certain agricultural commodities, as described by Bridgman et al. (2015) , or commodity-specific exemptions from transportation regulations, as discussed in Black (1955) . 19 Under this alternative interpretation of price gaps, the gains from economic integration can be measured as:\nLike in Section 5, Q k i T denotes the counterfactual output level of crop k in market i at date t when crop producers in market i at date t maximize profits facing the counterfactual prices,\nThe only difference between equations (19) and (24) is that equation (24) evaluates the output bundle using prices in the wholesale market rather than (distorted) local prices. This implies that under the interpretation of price gaps as distortions, the absolute level of prices in the counterfactual equilibrium, p k i T , is irrelevant. Only relative prices matter through their effect on the output decision in the counterfactual equilibrium, Q k i T . Under the interpretation of price gaps as transportation costs, in contrast, the absolute level of prices has a direct effect on the gains from economic integration; see equation (19) . 20 Figure 5 displays our estimates of the gains from economic integration in US agricultural markets from 1880-1997 under the alternative, and more conservative, interpretation of price gaps described above. Analogously to Figure 4 , we plot (in Figure 5a ) the value of \u2206W D tt (in red), expressed in terms of percentage changes per year from t to t , for the case where t = 1920 and t is each available Census year from 1880-1920; the equivalent is shown for the 1954-1997 in Figure 5b . We similarly plot \u2206W A tt , the gains from pure productivity improvements, in green for the sake of comparison between gains from integration and gains from movements in county PPFs. It is clear that, as expected, an interpretation of price gaps as pure transportation costs that consume resources in shipping (\u2206W T tt , from Figure 4 ) leads to larger estimated gains than an interpretation of these price gaps as pure policy distortions that redistribute revenue lump-sum (\u2206W D tt , from Figure 5 ). But 19 We thank Jim Schmitz for bringing these policies to our attention. 20 Another way to relate the gains from economic integration given by equations (19) and (24) is to rearrange equation (19) as\nBoth formulas therefore implicitly use prices in the wholesale market to compute the total value of output, but if price gaps reflect trade costs, the output levels at the wholesale market should be scaled down by the extent of the trade costs. even the pure policy distortions interpretation of price gaps suggests that the gains from economic integration have been significant-0.48% per year from 1880 to 1920 and 1.24% per year from 1954 to 1997. These results imply that even under the conservative interpretation of price gaps as pure wedges, with no direct resource cost, the homogenization of agricultural prices within the U.S. from 1880-1997 has led to sizable gains."}, {"section_title": "Multiple factors of production", "text": "The baseline results in Section 4 implicitly rely on the assumption that each crop is produced using land and other factors of production in a similar Leontief fashion over time. Namely, we assume that productivity in the GAEZ data,\u00c2 f k i2011 , can be interpreted as the productivity of \"equipped\" land and that the time variation in land \"equipment\" does not violate Assumption A2.\nIn this subsection, we generalize our approach to allow for some substitution between factors of production and for factor intensity to vary over time and space. Formally, we assume the production for each crop k in a local market i at date t is now given by\nwhere \u03b2 it \u2208 [0, 1] measures the land intensity of any crop k in county i and year t, and N f k it \u2265 0 denotes the number of workers producing crop k using field f . In the same way that land was interpreted as equipped land in our baseline model, labor should now be interpreted as equipped labor. Without loss of generality, we normalize the total endowment of labor in each market to one, N it \u2261 1. 21 Let w it denote the wage in county i at date t. The profits of a farm producing crop k in a local market i and selling it to the wholesale market are now given by\nCompared to Section 2.1, cost minimization by farms implies\nSubstituting for the optimal input mix in equation (26), we obtain\nline with Section 2.1, profit maximization by farms therefore requires\nFinally, factor market clearing in market i now requires\nDefinition 1 generalizes to this new environment in a straightforward manner.\nIn order to implement our estimation approach in this new environment, we use historical data on an additional variable, also available from the U.S. Census of Agriculture: \u03b2 it , the average labor intensity in county i at date t computed as the ratio of total farm 21 Formally, if N it = 1, then we can change units of account for workers such that the the new number of workers allocated to each field and crop, in efficiency units, is equal to\u00d1\nUnder this convention, the production function in (25) simply becomes\n. In other words, changes in labor endowments are isomorphic to Hicks-neutral productivity shocks, which will be inferred from the data. sales to total farm labor expenditure. In line with Section 2.2, we assume that this variable is not subject to measurement error: \u03b2 it =\u03b2 it . Given this new information, and without any risk of confusion, we now refer to an observation for market i at date t as\n. Similarly, without any risk of confusion, we now denote by L (\u03b1 it , X it ) the set of allocations that are a solution of\nGiven this change of notation, Theorem 1 still holds in this richer environment. Accordingly, we can estimate trade costs and the gains from economic integration in the exact same way as we did in Section 2.3. Table 4 reports the estimated gains from economic integration using this alternative procedure with multiple factors of production. For purposes comparison, the first row summarizes the gains reported in Figures 4 and 5 above-the gains from integration under two extreme alternative interpretations of price gaps (\u2206W T tt in columns 1 and 4, \u2206W T tt in columns 3 and 6) and the gains from pure agricultural productivity improvements (\u2206W A tt in columns 2 and 5). We focus on the early and late long-difference changes: from t = 1880 to t = 1920 (columns 1-3), and from t = 1954 to t = 1997 (columns 4-6). The second row of Table 4 then reports on an alternative set of estimates calculated using the multi-factor production function in equation (25). Evidently, our baseline estimates (in the first row) are not particularly sensitive to our earlier assumption that all counties and and time periods used equipped land as the only factor of production in agriculture (the restriction that \u03b2 it = 0 for all counties i and years t). For example, we estimate in the second row that the gains from economic integration between 1880 and 1920 were 1.43% per year, rather than 1.46% per year as in our baseline (first row). And the effect of this alternative modeling assumption on the estimated gains in the later period appears similarly slight. So while the price of labor relative to land will have differed greatly over space and time throughout our 1880-1997 sample period, these developments do not appear to have large effects on our estimates of the gains from economic integration. (19), (23), and (24), respectively, and then the numbers reported are converted into annualized changes beween the two relevant years."}, {"section_title": "Alternative Treatment of Zero-Crops", "text": "Whenever a county does not produce a crop, we have much less information about the price and productivity in that county. In Section 2.2, we have dealt with this issue by assuming that: (i) the productivity of zero-crops is equal to their national average (Assumption A3) and (ii) the local price of zero-crops is such that farmers are indifferent between producing this crop and other crops (Assumption A4). The previous strategy implicitly gives the \"extensive margin\" an important role in our counterfactual exercises: whenever the counterfactual productivity or price of a zero-crop goes up relative to other crops, it should start being produced.\nTo assess the sensitivity of our results to this treatment of zero crops, we focus here instead on the polar case in which the \"extensive margin\" is not in operation. Formally, we assume that if a county i does not produce crop k at date t, then its productivity is equal to zero:\nUnder this assumption, whenever a crop has zero output in a county, its output must remain equal to zero in all counterfactual scenarios. The last row of Table 4 presents our counterfactual results under this alternative treatment of zero crops. We again see that none of our estimates (for W T tt , W A tt or W D tt , and for early or late pairs of years t and t ) changes a great deal in response to the alternative treatment of zero-crops introduced here. The estimated gains from economic integration that emerge from our procedure continue to be substantial-for example, ranging from 1.06% to 0.31% per year annually between 1954 and 1997, depending on the interpretation of price gaps used."}, {"section_title": "Concluding Remarks", "text": "We live in a global world. Markets are probably more integrated today than at any point in the past. What if they were not? What would an economy like the United States look like in a counterfactual world without market integration? How much poorer would that hypothetical economy be?\nAnswers to such questions typically rely on strong and untestable functional form assumptions-the production-side gains from trade hinge, unavoidably, on what happens when producers reallocate from the technologies that are observable to the econometrician (because they are being used by producers) to ones that are simply unknown from the econometrician's perspective.\nIn this paper, we have proposed a new approach, applicable to the agriculture, whose main goal is to weaken the reliance on functional form assumptions and, in turn, increase the credibility of the answers building upon them. Central to our approach is the use of a novel agronomic data source on predicted output by crop for small spatial units. Crucially, this dataset contains information about the productivity of all spatial units for all crops, not just the endogenously selected crop that farmers at each spatial have chosen to grow in some equilibrium. Using this new approach we have estimated (i) the spatial distribution of price wedges across U.S. counties in 1880 and 1997 and (ii) the gains associated with changes in the level of these wedges over time. Our estimates imply that the gains from integration amount US counties from 1880 to 1997 have been substantial-similar in magnitude to the considerable productivity gains over that period.\nA similar approach could be used to study how agricultural trade policies set in developed economies affect households in developing countries. Since trade policies distort relative prices and lead farmers to grow crops conditioned on these distorted prices, the central challenge involved when studying proposed changes to these policies lies in predicting farmers' productivities in crops that they are not currently growing (and hence cannot be observed). We believe the GAEZ data offer a particularly credible way to solve this identification problem, just as it did in the historical U.S. context, and hence could be used to provide plausible answers to questions concerning the impact of proposed agricultural trade policy adjustments, such as those discussed during the World Trade Organization's Doha Round, on food prices, trade flows, nutrition, poverty, and welfare. "}, {"section_title": "A Proof of Theorem 1", "text": "For notational convenience, and without any risk of confusion, we drop all market and time indices, i and t, from the proof of Theorem 1 and all subsequent proofs.\nProof of Theorem 1. We proceed in two steps.\nStep 1: For any X \u2208 X , if (\u03b1, p) \u2208 A + \u00d7 P + are such that there exists L \u2208 L (\u03b1, X) satisfying conditions (10)- (12), then it is admissible.\nBy Definitions 1 and 2, we want to show that one can construct a vector of field prices, r, and an allocation of fields, L, such that conditions (1)- (6) hold. A natural candidate for the allocation is L \u2208 L (\u03b1, X) such that equations (10)- (12) hold. The fact that equations (3) and (5) hold for allocation L is immediate from the fact that L \u2208 L (\u03b1, X). The fact that equations (4) and (6) hold as well derive from equations (10) and (11), together with the fact that if k / \u2208 K + , then\nLet us now construct the vector of field prices, r, such that r f = max k\u2208K p k \u03b1 k\u00c2 f k for all f \u2208 F . By Assumption A2, we can rearrange the previous expression as r f = max k\u2208K p k A f k . This immediately implies inequality (1) . To conclude, note that by condition (12), together with Assumption A2, we must have\nStep 2: For any X \u2208 X, if (\u03b1, p) \u2208 A + \u00d7 P + is admissible then there exists L \u2208 L (\u03b1, X) such that conditions (10)-(12) hold.\nBy Definitions 1 and 2, if (\u03b1, p) \u2208 A + \u00d7 P + is admissible given X \u2208 X , then there exist r and L such that conditions (1)- (7) hold. Equation (6) immediately implies equation (10). Conditions (1) and (2)-together with Assumption A2-imply condition (12). Finally, equations (4) and (5) imply equation (11). To conclude, note that by conditions (1)-(3), L is a feasible allocation that maximizes total profits. Thus By the First Welfare Theorem (Mas-Colell, Whinston and Green (1995) Proposition 5.F.1), we must have L \u2208 L (\u03b1, X)."}, {"section_title": "B Proof of Theorem 2 B.1 Preliminary Results", "text": "Before establishing the proof of Theorem 2, it is useful to establish a number of preliminary results.\nLetL(\u03b1, X) denote the set of solutions of\nFor future reference note that for any X \u2208 X and \u03b1 \u2208 A + , we can writeL(\u03b1, X) in a more compact form asL(\u03b1, X) = arg max L\u2208L min\nF is the set of feasible allocations. The rest of this subsection establishes properties ofL(\u03b1, X) that we will use to establish Theorem 2 in the next subsection. We first use a version of the second welfare theorem to show that any allocation inL(\u03b1, X) is associated with a competitive equilibrium."}, {"section_title": "Lemma 1.", "text": "For any \u03b1 \u2208 A + and any X \u2208 X , if L \u2208L(\u03b1, X), then there exist p \u2208 P + and r \u2208 R F + such that (L, p, r) is a competitive equilibrium.\nProof. Let Q \u2261 Q k k\u2208K denote the production vector associated with L \u2208L(\u03b1, X). By definition ofL(\u03b1, X), Q is efficient. To see this, note that if there were Q \u2265 Q with Q = Q, then by Assumption A2, we would have\nwith strict inequality for some k 0 \u2208 K. Thus starting from the allocation L associated with Q , we could reallocate a small amount of at least one field from k 0 to all other goods in K + . By construction, the new allocation L would be such that min\nSince Q is efficient and production functions are linear-which implies that the production set is convex-Proposition 5.F.2 in Mas-Colell, Whinston and Green (1995) implies the existence of non-zero price vectors p \u2208 R K+1 + and r \u2208 R F + such that conditions (1) and (2) are satisfied. Furthermore, p must be such that p k > 0 for all k \u2208 K + . To see this note that if there exists k 0 \u2208 K + such that p k 0 = 0, then equation (2) implies r f = 0 for some f ; in turn, condition (1) implies p k = 0 for all k \u2208 K; and finally, equation (2) implies r f = 0 for all f , contradicting the fact that (p, r) is non-zero. Finally, since L \u2208L(\u03b1, X), equation (3) is satisfied as well, which concludes our proof.\nThe next Lemma establishes joint properties of any pair of competitive equilibria. Lemma 2. Consider \u03b1, \u03b1 \u2208 A + and X \u2208 X such that (L, p, r) is a competitive equilibrium conditional on \u03b1 and X and (L , p , r ) is a competitive equilibrium conditional on \u03b1 and\nProof. Suppose that (L, p, r) is a competitive equilibrium conditional on \u03b1 and X and that (L , p , r ) is a competitive equilibrium conditional on \u03b1 and X. Let us introduce the following notation. First let K 0 =K 0 = K + and for n \u2265 1, let K n andK n be such that\nBy construction, there exists n \u2265 1 such that {K 1 , ..., K n } is a partition of K + . Second for any\nThird let F n and F n denote the subset of fields such that L f K n > 0 and L f K n > 0, respectively. We will first show by iteration that for all\n=V f and F n = F n = F . Now suppose that this it is true for n \u2265 0 and let us show that is true for n + 1.\nWe proceed in two steps.\nStep 1:\nThus the above inequality holds. Now consider f \u2208 F n . We proceed by contradiction.\nTogether with conditions (1) and (2), the previous series of inequalities implies\nStep 2:\nThus the two previous equations hold. Now consider f \u2208 F n . Suppose that there exists\nWe are now ready to establish Properties (i) and (ii) . Consider f 0 \u2208 F and k 0 \u2208 K + such that L f 0 k 0 > 0. Let n 0 be such that k 0 \u2208 K n 0 . By the previous result we know that if\nFor all k \u2208 K n 0 , we also know that p k = \u03b8 p k , where \u03b8 \u2261 min k\u2208K n 0 \u22121 \u03b1 k p k /\u03b1 k p k . Dividing both sides of the previous expression by \u03b8, we therefore obtain \n, which concludes the proof of Lemma 2.\nLet us now introduce the following stronger version of Restriction R1.\nR1'. For any N \u2265 2, there does not exist a sequence {k n } n=1,...,N+1 \u2208 K + it and a sequence { f n } n=1,...,N \u2208 F i such that (i) k 1 = k N+1 and k n = k n for all n = n, n = 1, n = 1; (ii) f 1 = f N and f n = f n+1 for all n; and (iii) measured productivity in local market i satisfies\u00c2\nUsing Lemma 2, the next lemma establishes that under Restriction R1', all elements ofL(\u03b1, X) lead to the same aggregate land allocation across crops.\nLemma 3. For any \u03b1 \u2208 A + and any X \u2208 X satisfying Restriction R1', if L, L \u2208L(\u03b1, X), then\nProof. We proceed by contradiction. Suppose that there exist L, L \u2208L(\u03b1, X) such that \u2211 f \u2208F L f k = \u2211 f \u2208F L f k for some k \u2208 K + . By Lemma 1, we know that there exist vectors of prices, (p, r) and (p , r ), such that (L, p, r) and (L , p , r ) are competitive equilibria. Let \u2206L \u2261 L \u2212 L . It must satisfy the two following properties."}, {"section_title": "Property 1:", "text": "If there exist f \u2208 F and k \u2208 K + such that \u2206L f k = 0, then there exists k = k \u2208 K + such that \u2206L f k = 0.\nProperty 1 derives from the fact that if L, L \u2208L(\u03b1, X), then we must have \u2211 k\u2208K + L f k = \u2211 k\u2208K + L f k =V f for all f \u2208 F . Property 2: If there exist f \u2208 F and k \u2208 K + such that \u2206L f k = 0, then there exists f = f in F such that \u2206L f k = 0.\nProperty 2 derives from the fact that if L, L \u2208L(\u03b1, X), then we must have\nThe rest of the proof of Lemma 3 proceeds as follows. Since L = L , there exist k 1 \u2208 K + and f 1 \u2208 F such that \u2206L f 1 k 1 = 0. This further implies the existence of k 2 = k 1 such that \u2206L f 1 k 2 = 0, by Property 1, and the existence of f 2 = f 1 such that and \u2206L f 2 k 2 = 0, by Property 2. By iteration, we can therefore construct an infinite sequence of goods {k n } n\u22651 and an infinite sequence of fields { f n } n\u22651 such that k n+1 = k n and f n+1 = f n . Since the number of goods in K + is finite, there must be M < N such that k n = k n for all n = n , n,n \u2208 {M, ..., N} but k M = k N+1 . By construction, this subsequence is such that \u2206L f n k n = 0 and \u2206L f n k n+1 = 0 for all n \u2208 {M, ..., N}. Since L, L \u2208L(\u03b1, X), we must have \u2211 f \u2208F \u03b1 k\u00c2 f k L f k = \u2211 f \u2208F \u03b1 k\u00c2 f k L f k and, in turn, \u2211 f \u2208F L f k = \u2211 f \u2208F L f k for all k \u2208 K + . Thus Property (ii) \nwhere the second equality comes from the fact that k M = k N+1 . By Assumption A2 (using the convention A f K+1 = \u03b1 K+1\u00c2 f K+1 ), we also know that\nBy equations (31) and (32), we have therefore constructed a sequence of goods and fields {k M , ..., k N+1 } and { f M , ..., f N } such that (i) k M = k N+1 and k n = k n for all n = n, n = M, n = M; (ii) f n = f n+1 for all n; and (iii) measured productivity satisfies\nThere are two possible cases.\nCase 1: There exists n 0 \u2208 {M, ..., N \u2212 1} such that\u00c2 f n 0 k n 0 +1 =\u00c2 f n 0 +1 k n 0 +1 .\nIn this case we can rearrange equation ( \nwhere the second equality uses\u00c2 f n k n+1 =\u00c2 f n+1 k n+1 for all n \u2208 {M, ..., N \u2212 1}. Since L 2 satisfies Constraints (29) and (30), equation (35) implies L 2 \u2208L(\u03b1, X).\nStarting from L 2 , we can therefore follow the same procedure as above to create a new sequence of goods and fields satisfying conditions (i) and (ii) as well as equation (33) . Either the new sequence falls into Case 1, which violates R1', or it falls into Case 2, in which case we can construct L 3 \u2208L(\u03b1, X) satisfying equation (34) in the exact same way we have just constructed L 2 . We can iterate the following process. Since after each iteration j \u2265 1, there is one less fieldgood pair ( f , k) such that L \u2212 L j = 0, there must be a sequence that falls into Case 1 after a finite number of iterations. Otherwise, given the finite number of fields and goods, there would be an allocation L j satisfying equation (34) such that L j = L, which contradicts \u2211 f \u2208F L f k = \u2211 f \u2208F L f k for some k \u2208 K + . Thus R1' must be violated, which concludes the proof of Lemma 3.\nFor all \u03b1 \u2208 A + , all X \u2208 X satisfying Restriction R1', and all k \u2208 K + , letL k (\u03b1, X) \u2261 \u2211 f \u2208F L f k for all L \u2208L(\u03b1, X). By Lemma 3L k (\u03b1, X) is well-defined. The next lemma shows that (L k (\u00b7, X)) k\u2208K +construction of \u03b5 k construction, we have \u2211 f \u2208FL f k n > \u2211 f \u2208F L f k for all k \u2208 K + , k = k 0 . Thus we have established that if n is large enough, then \u2211 f \u2208F L f k n > \u2211 f \u2208F L f k for all k = k 0 in K + . Now take \u03b1, \u03b1 \u2208 A + such that \u03b1 k 0 > \u03b1 k 0 for some k 0 \u2208 K + and \u03b1 k = \u03b1 k for all k = k 0 in K + . The previous result implies that if \u03b1 k 0 \u2212 \u03b1 k 0 is small enough, then for any L \u2208L(\u03b1 , X) and L \u2208L(\u03b1, X), we must have \u2211 f \u2208F L f k > \u2211 f \u2208F L f k for all k = k 0 in K + . To see this note that if this were not the case, we could construct a sequence (\u03b1 n ) n\u22650 satisfying \u03b1 k 0 n > \u03b1 k 0 for some k 0 \u2208 K + , \u03b1 k n = \u03b1 k for all k = k 0 in K + , and lim n\u2192\u221e \u03b1 k 0 n = \u03b1 k 0 and a subsequence of the land allocations (L n ) n\u22650 satisfying L n \u2208L(\u03b1 n , X) that converges to L \u2208L(\u03b1, X) such that for all n, there exists some k = k 0 in K + such that\nBy Lemma 3 we know that \u2211 f \u2208F L f k = \u2211 f \u2208F L f k for all k \u2208 K + since L, L \u2208L(\u03b1, X). Thus inequality (46) implies \u2211 f \u2208F L f k n \u2264 \u2211 f \u2208F L f k , which contradicts our previous result. Thus LemmaL k 0 (\u03b1, X) <L k 0 (\u03b1 , X), which contradicts property (i)."}, {"section_title": "B.2 Proof of Theorem 2", "text": "We are now ready to establish Theorem 2, which is restated below for expositional purposes.\nTheorem 2. Suppose that an observation X \u2208 X , an admissible vector (\u03b1, p) \u2208 A + \u00d7 P + , and the associated competitive allocation L \u2208 L (\u03b1, X) satisfy the two following restrictions."}, {"section_title": "R1.", "text": "For any N \u2265 2, there does not exist {k n } n=1,...,N+1 \u2208 K + and { f n } n=1,...,N \u2208 F such that (i) k n , k n+1 \u2208 arg max k\u2208K + p k \u03b1 k\u00c2 f n k for all n; (ii) k 1 = k N+1 and k n = k n for all n = n, n = 1, n = 1; (iii) f 1 = f N and f n = f n+1 for all n; and (iv) measured productivity in local market i satisfie\u015d A f 1 k 1 =\u00c2 f N k 1 and \u220f N n=1 \u00c2 f n k n /\u00c2 f n k n+1 = 1."}, {"section_title": "R2.", "text": "For all k, k \u2208 K + , there exists f \u2208 F such that L f k , L f k > 0.\nThen any admissible vector (\u03b1 , p ) \u2208 A + \u00d7 P + satisfies \u03b1 k , p k = \u03b1 k , p k for all k \u2208 K + / {K + 1}. Furthermore, p k"}]
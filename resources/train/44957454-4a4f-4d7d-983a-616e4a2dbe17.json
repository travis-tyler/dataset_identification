[{"section_title": "Abstract", "text": "Brain imaging genetics is an emergent research field where the association between genetic variations such as single nucleotide polymorphisms (SNPs) and neuroimaging quantitative traits (QTs) is evaluated. Sparse canonical correlation analysis (SCCA) is a bi-multivariate analysis method that has the potential to reveal complex multi-SNP-multi-QT associations. Most existing SCCA algorithms are designed using the soft threshold strategy, which assumes that the features in the data are independent from each other. This independence assumption usually does not hold in imaging genetic data, and thus inevitably limits the capability of yielding optimal solutions. We propose a novel structure-aware SCCA (denoted as S2CCA) algorithm to not only eliminate the independence assumption for the input data, but also incorporate group-like structure in the model. Empirical comparison with a widely used SCCA implementation, on both simulated and real imaging genetic data, demonstrated that S2CCA could yield improved prediction performance and biologically meaningful findings."}, {"section_title": "Introduction", "text": "Brain imaging genetics is an emerging research field aiming to identify associations between genetic factors such as single nucleotide polymorphisms (SNPs) and quantitative traits (QTs) extracted from neuroimaging data. While univariate analyses [9] have been widely used to discover single-SNP-single-QT associations, recent studies have also started to perform regression analyses [5] to examine the joint effect of multiple SNPs on one or a few QTs, and bi-multivariate analyses [4, 6, 10, 12] to examine complex multi-SNP-multi-QT associations.\nSparse canonical correlation analysis (SCCA) [7, 14] is a bi-multivariate analysis method that has been applied to both real [6] and simulated [4] imaging genetics data, as well as other omics data sets [2, 3, 7, 14] . Most existing SCCA algorithms use the soft threshold strategy for solving the Lasso [7, 14] or group Lasso [4, 6] regularization terms. However, the soft threshold approach requires the input data X to have an orthonormal design X T X = I (see Section 10 in [11] ), meaning that the features in the data should be independent from each other. However, for neuroimaging and genetics data, correlation usually exists among regions of interest (ROIs) in the brain and among linkage disequilibirum (LD) blocks in the genome. Simply treating the covariance of the input data as an identity or diagonal matrix will inevitably limit the capability of identifying meaningful imaging genetic associations.\nOne possible solution to address this issue is to orthogonalize the input data by performing principal component analysis (PCA) before running SCCA. However, we aim to identify relevant imaging and genetic markers, and thus prefer a sparse model. The combined PCA and SCCA strategy cannot achieve this goal, since PCA loadings on the original imaging and genetic markers are non-sparse.\nTo overcome this limitation, in this paper, we propose a novel structure-aware SCCA (denoted as S2CCA) algorithm for brain imaging genetics applications to achieve the following two goals: (1) our algorithm is not based on the soft threshold framework and eliminates the independence assumption for the input data; (2) our model can incorporate group-like structure (e.g., voxels in an ROI, or SNPs in an LD block) to yield more stable and biologically more meaningful results than conventional SCCA model. We perform an empirical comparison between the proposed S2CCA algorithm and a widely used SCCA implementation in the PMD software package (http://cran.r-project.org/web/packages/ PMA/) [14] using both simulated and real imaging genetic data. The empirical results demonstrate that the proposed S2CCA algorithm can yield improved prediction performance and biologically meaningful findings."}, {"section_title": "Structure-aware SCCA (S2CCA)", "text": "We denote vectors as boldface lowercase letters and matrices as boldface upper-case ones. For a given matrix M = (m ij ), we denote its i -th row and j -th column to m i and m j respectively. Let X = {x 1 , \u2026, x n } T \u2286 \u211c p be the SNP data and Y = {y 1 , \u2026, y n } T \u2286 \u211c q be the imaging QT data, where n is the number of participants, p and q are the numbers of SNPs and QTs, respectively. Canonical correlation analysis (CCA) seeks linear combinations of variables in X and Y which maximize the correlation between Xu and Yv: (1) where u and v are canonical vectors or weights. Two major weaknesses of CCA are that it requires the number of observations n to exceed the combined dimension of X and Y and that it produces nonsparse u and v which are difficult to interpret. The sparse CCA (SCCA) method removes these weaknesses by maximizing the correlation between Xu and Yv subject to the weight vector constraints P 1 (u) \u2264 c 1 and P 2 (v) \u2264 c 2 . The penalized matrix decomposition (PMD) toolkit [14] provided a widely used SCCA implementation, where the L 1 penalty was used for both P 1 and P 2 . As mentioned earlier, similar to most SCCA methods, PMD employed the soft threshold strategy for solving the L1 penalty term, which required the input data to have an orthonormal design X T X = I and Y T Y = I (see Section 10 in [11] ). This independence assumption usually does not hold in imaging genetic data (e.g., correlated voxels in an ROI, correlated SNPs in an LD block), and thus inevitably limits the capability of identifying meaningful imaging genetic associations.\nTo overcome this limitation, we propose a novel structure-aware SCCA (denoted as S2CCA) algorithm to not only eliminate the independence assumption for the input data, but also incorporate group-like structure in the model. Instead of using L 1 , we define a group L 1 constraint on P 1 and P 2 as follows: (2) In Eq. (2), SNPs are partitioned into K 1 groups , such that , and m k 1 is the number of SNPs in \u03c0 k 1 ; and imaging QTs are partitioned into K 2 groups , such that , and m k 2 is the number of QTs in \u03c0 k 2 . || \u00b7 || G is the constraint for the group structure. In this work, we partition voxels using AAL ROIs and SNPs using LD blocks.\nNow the S2CCA objective function can be formally written as follows: (3) Using Lagrange multipliers, Eq. (3) can be transformed as follows: (4) Taking the derivative about u and v and setting them to zero, we have\nwhere D 1 is the block diagonal matrix of the k 1 -th diagonal block as , and D 2 is the block diagonal matrix of the k 2 -th diagonal block as ."}, {"section_title": "Algorithm 1", "text": "Structure-aware SCCA (S2CCA)\nRequire.\nCanonical vectors u and v.\n2: while not converged do"}, {"section_title": "3:", "text": "Calculate the block diagonal matrix D 1 t , where the k 1 -th diagonal is ;\n4:\nCalculate the block diagonal matrix D 2 t , where the k 2 -th diagonal is ;\n6:\nScale v t+1 so that ; 7: t = t + 1."}, {"section_title": "8: end while", "text": "With v fixed, we can use an approach similar to G-SMuRFS [13] to solve for u. With u fixed, we can do the same to solve for v. We propose Algorithm 1 to alternatively compute u and v until the result converges. We use max{|\u03b4| | \u03b4 \u2208 (u t+1 \u2212 u t )} < 10 \u22125 and max{|\u03b4| | \u03b4 \u2208 (v t+1 \u2212 v t )} < 10 \u22125 as stopping criterion, and nested cross-validation to automatically tune parameters \u03b3 1 , \u03b3 2 , \u03b2 1 and \u03b2 2 ."}, {"section_title": "Experimental Results", "text": ""}, {"section_title": "Results on Simulation Data", "text": "We first performed a comparative study between S2CCA and PMD using simulated data. We used the following procedure to generate two sets of synthetic data X and Y, both with n = 1000 and p = q = 50: 1) We created a random positive definite non-overlapping group structured covariance matrix M. 2) Data set Y with covariance structure M was calculated through Cholesky decomposition. 3) We repeated the above two steps to generate another data set X. 4) Canonical loadings u and v were set based on the group structures of X and Y respectively, where all the variables within the group share the same weights. In this initial study, for simplicity, we selected only one group in Y to be associated with 4 groups in X. 5)\nThe portion of the specified group in Y were replaced based on the u, v, X and the assigned correlation. We generated 7 pairs of X and Y with correlations ranging from 0.45 to 0.99. The canonical loadings and group structure remained the same across all the synthetic data sets.\nWe applied S2CCA and PMD to all seven data sets. The regularization parameters were optimally tuned using a grid search from 10 \u22125 to 10 5 through nested 5-fold cross-validation. The true and estimated u and v values are shown in Fig. 1 . Due to different normalization strategies, the weights yielded through S2CCA and PMD showed different scales. Yet the overall profile of the estimated u and v values from S2CCA remained consistent with the ground truth across the entire range of tested correlation strengths (from 0.45 to 0.99), while PMD only identified an incomplete portion of all the signals. Furthermore, we also examined the correlation in the test set computed using the learned CCA models from the training data for both methods. The left part of Table 1 demonstrates that S2CCA outperformed PMD consistently and significantly, and it could accurately reveal the embedded true correlation even in the test data. The right part of Table 1 demonstrates the sensitivity and specificity performance using area under ROC (AUC), where S2CCA also significantly outperformed PMD no matter whether the correlation was weak or strong. From the above results, it can also be observed that S2CCA could identify the correlations and signal locations not only more accurately but also more stably."}, {"section_title": "Results on Real Neuroimaging Genetics Data", "text": "S2CCA and PMD were also compared using real neuroimaging and SNP data. The magnetic resonance imaging (MRI) and SNP data were downloaded from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database. One goal of ADNI has been to test whether serial MRI, positron emission tomography, other biological markers, and clinical and neuropsychological assessment can be combined to measure the progression of mild cognitive impairment (MCI) and early AD. For up-to-date information, see www.adniinfo.org.\nThis ADNI study included 176 AD, 363 MCI and 304 healthy control (HC) non-Hispanic Caucasian participants (Table 2) . Structural MRI scans were processed with voxel-based morphometry (VBM) in SPM8 [1, 8] . Briefly, scans were aligned to a T1-weighted template image, segmented into gray matter (GM), white matter (WM) and cerebrospinal fluid (CSF) maps, normalized to MNI space, and smoothed with an 8mm FWHM kernel. Rather than using ROI summary statistics, in this study we subsampled the whole brain and examined correlations between the voxels (GM density measures) and SNPs. Totally 465 voxels spanning all brain ROIs were extracted. All SNPs within LD block of APOE e4 were extracted from an imputed genetic data set containing only SNPs in Illumina 610Q and/or OmniExpress arrays after basic quality control. As a result, four SNPs (rs429358, rs439401, rs445925, rs534007) from this LD block were included in this study. Using the regression weights derived from the healthy control participants, VBM and genetic measures were preadjusted for removing the effects of the baseline age, gender, education, and handedness.\nBoth S2CCA and PMD were performed on the normalized VBM and SNP measurements. Similar to the previous analysis, 5-fold nested cross-validation was applied to optimally tune the parameters. Table 3 shows 5-fold cross-validation canonical correlation results, indicating that S2CCA significantly and consistently outperformed PMD in terms of identifying high correlations from the training data and replicating those in the testing data. Shown in Fig. 2(a) are the canonical loadings trained from 5-fold cross-validation, suggesting relevant imaging and genetic markers. Although the S2CCA model did not explicitly impose sparsity on individual voxels, it was still able to discover a very small number of relevant ROIs for easy interpretation due to the imposed group sparsity. The strongest imaging signals came from the right hippocampus, which were inversely correlated with APOE e4 allele rs429358. In contrast, despite the flat sparsity design, PMD identified many more ROIs than S2CCA (Fig. 2(ab) ), making results hard to interpret. In addition, comparing the results from 5 cross-validation trials, S2CCA yielded a more stable and consistent pattern than PMD. It is reassuring that S2CCA identified a well-known correlation between hippocampal morphometry and APOE in an AD cohort, which shows the promise of S2CCA to correctly identify biologically meaningful imaging genetic associations."}, {"section_title": "Conclusions", "text": "Most existing SCCA algorithms (e.g., [4, 6, 7, 12, 14] ) are designed using the soft threshold strategy, which assumes that the features in the data are independent from each other. This independence assumption usually does not hold in imaging genetic data, and thus limits the capability of yielding optimal results. We have proposed a novel structure-aware sparse canonical correlation analysis (S2CCA) algorithm, which not only removes the above independence assumption, but also takes into consideration group-like structure in the data.\nWe have compared S2CCA with PMD (a widely used SCCA implementation) on both synthetic data and real imaging genetic data. The promising empirical results demonstrate that S2CCA significantly outperformed PMD in both cases. In addition, S2CCA accurately recovered the true signals from the synthetic data and yielded improved canonical correlation performance and biologically meaningful findings from real data. This study is an initial attempt to remove the feature independence assumption many existing SCCA methods have. Since joint multivariate modeling of imaging genetic data is computationally and statistically challenging, we downsampled our data via a targeted APOE analysis to reduce computational burden and overfitting risk. The S2CCA sparsity was designed to reduce model complexity and further overcome overfitting. Future directions include evaluating S2CCA using more realistic settings and expanding S2CCA to address efficiency and scalability. Table 1 Five-fold cross-validation performance on synthetic data: mean\u00b1std is shown for estimated correlation coefficients and AUC of the test data using the trained model. P-value of paired t-test between S2CCA and PMD results is also shown. Table 3 Five-fold cross validation canonical correlation results on real data: the CCA models learned from the training data were used to estimate the correlation coefficients between canonical components for both training and testing sets. P-values of paired t-tests were obtained for comparing S2CCA and PMD results. "}]
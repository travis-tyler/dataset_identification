[{"section_title": "Introduction", "text": "Arterial spin-labelling magnetic resonance imaging (ASL-MRI) is a non-invasive blood flow imaging modality that can improve the diagnosis of Alzheimer's disease (AD) by providing estimates of cerebral blood flow (CBF) and identifying regions of chronic cerebral hypoperfusion in individuals. However, ASL-MRI is still not part of clinical routine; many research databases used to train dementia classifiers, such as ADNI (Alzheimer's Disease Neuroimaging Initiative), do not include ASL-MRI as part of their data collection protocol.\nImage synthesis refers to the simulation of missing image modalities with machine learning algorithms using image modalities that are available. Synthetic image modalities can in some cases provide additional predictive value beyond the original data used for synthesis [7] . We use kernel partial least squares regression (kPLSR) for synthesising ASL-MRI -based CBF maps using structural MRI (sMRI) features and carotid ultrasound flow measurements as regressors. Using partial volumes of cortical and sub-cortical regions as features allows the relation between cerebral volume loss and reduction in CBF in dementia patients to be learned by the model. The synthetic CBF maps are used to generate CBF maps of patients for whom no ASL-MRI images are available (CBF imputation).\nThe challenge of building models using multi-modal data is that multiple cohorts may be required to achieve enough coverage and some cohorts will have some modalities missing. We refer to this as the heterogeneous data problem. To address it, we modify the NIPALS algorithm for training the kPLSR model to work on heterogeneous data, where some features are missing in part of the input data X, and some of the output data Y are also missing. The synthetic CBF maps are utilised as classification features in discriminating mild cognitive impairment -patients (MCIs) from cognitively healthy controls (CHCs).\nThe MCI vs. CHC -problem is less studied than the AD vs. CHC -problem (see e.g. the review [1] ) because sMRI-derived partial volume -features are less informative in the prodromal stage of AD. We apply a simultaneous feature selection and classification strategy based on: (i) use of regional CBF values averaged over anatomical subregions (instead of voxelwise values), and (ii) elastic net regression. The proposed classifiers are compared to MCI vs. CHC -classifiers from literature using different imaging modalities as features."}, {"section_title": "Methods", "text": ""}, {"section_title": "Acquisition and pre-processing of imaging data", "text": "Data from two clinical centres and three different cohorts were included to increase the number of cases available for training models ( Table 1 ). The combined data set was heterogeneous with respect to operator, MR field strength, and modalities available for each case. Three different sets of features were used. sMRI features: T1-weighted sMRI were acquired and volumes of 141 cortical and sub-cortical regions were computed by propagating anatomical labels with the geodesic information flows -algorithm [2] . These features encapsulated grey matter (GM) atrophy but did not contain direct information about CBF. Carotid flow features: Carotid ultrasound measurements were performed in two of the cohorts. Flow velocity signals were extracted from DICOM images and used to compute the mean flow rate and flow pulsatility indices (for both ICA-L and ICA-R separately), for a total of four features. These features encapsulated the baseline total CBF, but did not contain region-specific effects. ASL features: Pseudo-continuous ASL-MRI parameters were: TR/TE, 4,000 ms/14 ms; flip angle, 40; FOV, 240 mm x 240 mm; matrix size, 80x80; 17 slices; thickness, 7 mm; labelling duration, 1.65 s; post-labelling delay, 1.525 s; and labelling gap, 20 mm. The ASL-MRI CBF maps were registered against the sMRI using SPM12 and equipped with maximum probability tissue labels defined on the MNI152 atlas, provided by Neuromorphometrics, Inc. from data collected in the OASIS project (http://www.oasis-brains.org/), and CBF was estimated in 144 anatomical regions. Regional CBF values were normalised for age and sex by using the w-scores method of [3] to obtain the final ASL features: where CBF = \u03b2 0 + gender \u00b7 \u03b2 1 + age \u00b7 \u03b2 2 + \u03b5 is a linear model trained separately for all anatomical regions on the sub-population of cognitively healthy controls. "}, {"section_title": "Feature synthesis of the regional CBF maps", "text": "Given a matrix of inputs X \u2208 R n\u00d7p and a matrix of outputs Y \u2208 R n\u00d7m , partial least squares -regression (PLSR) attempts to find a lower-dimensional representation of the input-output map using only \u2113 \u226a p latent variables. This is achieved by simultaneous approximate decomposition of the two matrices as:\nwhere T, U \u2208 R n\u00d7\u2113 are the loading matrices for X and Y respectively, and the scores P \u2208 R p\u00d7\u2113 , Q \u2208 R m\u00d7\u2113 maximise the covariance Cov(T T X, U T Y ).\nThe feature space for synthesising ASL-MRI maps consisted of 3 demographic features (age, weight, height), 141 sMRI features, and 4 carotid flow -features. Thus the maximum number of input features was p = 148. A total of n = 249 cases were available for learning a model to predict the m = 137 CBF features.\nAs the relation between CBF and partial volumes of cortical sub-regions in the brain was likely nonlinear, the kernel version of PLSR [6] was used. In this approach, the feature samples X are mapped using a nonlinear map, \u03a8 (X), and then the standard linear PLSR is performed in the mapped feature space (\u03a8 (X), Y ). The NIPALS algorithm [8] can be formulated in such a way that only inner products of the type \u03a8 (x i ) T \u03a8 (x j ), for i, j = 1, . . . , n are required. These can then be obtained using the kernel trick as:\nT \u03a8 (x j ). In the case of partially missing input data, we divided the features into two parts X = [X 1 X 2 ], where X 1 contained the features that are present for all samples, and X 2 = \u2205 whenever the remaining features were missing in the sample X. We then defined the modified kernel function:\ni.e. in the case of partially missing features the kernel function operated only on the subset of available features. Similarly, we divided the output matrix as \nwhere\n] was the combined feature vector. Fig. 1 represents the workflow for extracting features, training a kPLSR model for CBF feature synthesis, and training a MCI vs. CHC binary classifier."}, {"section_title": "Simultaneous classification and feature selection", "text": "As the amount of available training data was modest and pre-selected anatomical regions were used instead of voxelwise CBF values, standard elastic net regression (ENR) -classifier techniques were used to train three different classifier: (i) In Model A, the sMRI features X sMRI were used to train an ENR-model:\nwith the elastic net regularisation term defined as R(\u03b2; \u03b1) := while \u2206u \u2113 > tol do 6:\nsMRI features, \u03b2 0 is the model intercept, and \u03b2 are the regression weights. The continuous model prediction Y A = \u03b2 0 + X sMRI \u03b2 was thresholded to a binary prediction to obtain the standard ROC-curve. The hyperparameters \u03bb > 0 and \u03b1 \u2208 (0, 1] were chosen to maximise the area under the ROC-curve.\n(ii) In Model B, the synthesised CBF-features were used to train the model:\nwhere X CBF n is the kPLSR estimator (5). In order to measure the effect of using synthetic vs. ASL-MRI -derived CBF values, Model B was trained using two different sets of data. In one case, when CBF features were missing we simply used synthetic CBF features in their place (MRI + synthetic). In another case, only the synthetic CBF features were used even if ASL-MRI was available (synthetic only). Again the continuous probability was thresholded to a binary prediction. (iii) In Model C, the feature selection was performed simultaneously on both sMRI and CBF features:\n(iv) In Model D, we combined Models A and B by using the maximum probability rule,\nThe rationale for this was that a combination of two diagnostic tests with high specificity but lower sensitivity (typical for AD classifiers) may provide more sensitive diagnostic tests while avoiding the problem that simultaneous feature selection favours one set of features over the other. Models C and D were likewise trained using both synthetic CBF features alone and by combining ASL-MRI and synthetic CBF features."}, {"section_title": "Experiments", "text": ""}, {"section_title": "Synthetic CBF vs. ASL-MRI reconstructed CBF", "text": "The Gaussian kernel, K(x 1 , x 2 ) = exp(\u2212 x 1 \u2212 x 2 2 2 /d), was used in the kPLSR model. This resulted in two model hyperparameters, the kernel width d and the number of latent variables \u2113, that had to be tuned using leave-one-out crossvalidation. Only cases where the sMRI features were available (n = 156) were used in model training and cross-validation. Out of these, carotid ultrasound and ASL-MRI features were present in 100 and 55 cases, respectively. Hyperparameter values optimising the R 2 -statistic were found to be d = 35 and \u2113 = 2. Possible bias and standard deviation of the synthesised CBF from ground truth w-score values were measured using a Bland-Altman -plot of w-scores averaged across all regions, separately for the white matter (WM) and gray matter (GM), see Fig. 2 . The mean bias was \u2206w = 0.20 (p < 0.001). The w-score is normalised so that its standard deviation in the normal population equals 1. The kPLS regressor slightly overestimated CBF in both the WM and GM. "}, {"section_title": "Utility of synthetic ASL in the CBF imputation problem", "text": "The MCI classifiers using Models A, B, C, and D were trained with four-fold cross-validation (4-FCV) in a training set of n = 123 cases. An additional randomly selected validation set of n = 20 cases not included in the training was used to evaluate the balanced accuracy (ACC), sensitivity (SENS), and specificity (SPEC) of each classifier using hyperparameters and cut-offs obtained in 4-FCV. A heat map of the 46 features chosen by Model B is shown in Fig. 3 . We compared our MCI classification accuracy to results reviewed in [1] with the following selection criteria: (i) the MCI vs. CHC classification problem was addressed, (ii) the feature set consisted of sMRI, ASL, or PET features, (iii) the cohort size was at least 100, and (iv) studies that used CSF biomarkers or neurocognitive test scores as features were excluded. The study with the best reported accuracy for each feature set was chosen as representative.\nResults of the comparison are given in Table 2 . Models A and B alone produced similar results in terms of accuracy, although Model B achieved better accuracy than was reported for ASL-MRI features in [3] . Model C improved the results slightly when MRI+synthetic CBF features were used, but the best results were obtained with Model D regardless or whether MRI+synthetic or synthetic only CBF features were used. "}, {"section_title": "Discussion", "text": "Kernel PLS regression on heterogeneous data was used for the robust synthesis of regional CBF values in cases where no ASL-MRI images were available. As was reported in [3] , CBF features alone were not particularly informative in MCI classification, but a multi-modal classifier using synthetic CBF features outperformed pure sMRI-based classifiers in a validation test. Best classifier performance (balanced accuracy 92%, sensitivity 100%, specificity 80%) was achieved when a maximum probability -rule was used to combine classifiers using different feature sets. The benefit of our proposed method is that only basic sMRI features (partial volumes of subregions) were used and, as a result, synthetic CBF features can, therefore, be generated in large-scale brain imaging databases, such as ADNI, without the need for extensive feature computation. It is possible that more informative sMRI features, e.g. ventricular and/or hippocampal shape morphometrics, could increase the accuracy of the resultant classifiers. Provided more ASL-MRI data were available, the use of convolutional neural networks on voxelwise CBF values should also be investigated to eliminate the need for pre-selecting anatomical regions for analysis."}]
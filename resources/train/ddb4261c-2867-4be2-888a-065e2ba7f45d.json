[{"section_title": "Abstract", "text": "Abstract. Group-wise analysis of time series of images requires to compare observed longitudinal evolutions. In medical imaging, longitudinal anatomical changes can be modeled by using deformations resulting from the non-rigid registration of follow-up images. The comparison of longitudinal trajectories is therefore the transport of longitudinal deformations in a common reference frame. We previously showed that the Schild's Ladder is an ecient and simple method for the parallel transport of diffeomorphic deformations parameterized by tangent velocity elds. The Schild's Ladder is based on the construction of a geodesic parallelogram. The base vertices of the parallelogram are the pairs of follow-up images and another vertex is the reference frame. By building the geodesic diagonals of the parallelogram, Schild's Ladder computes the missing vertex which corresponds to the transported follow-up image. However, Schild's Ladder may be inecient in case of time series of multiple time points, in which the computation of the geodesic diagonals is required several times. In this paper we propose a new algorithm, the Pole Ladder, in which one diagonal of the parallelogram is the baseline-to-reference frame geodesic. This way we have to compute only one diagonal for each time point along the curve. In this work we show that the transport of the Pole ladder and the Schild's Ladder are equivalent. Moreover, we show how the Pole ladder can be succesfully applied to the clinical problem of the measurement of the longitudinal atrophy progression in the brain for a group of patients aected by Alzheimer's disease."}, {"section_title": "Introduction", "text": "Group-wise analysis of time series of images requires to compare observed longitudinal evolutions. Non-rigid registration is one of the main instruments for modeling anatomical dierences from images. The aim of non-rigid registration Data used in preparation of this article were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (www.loni.ucla.edu/ADNI). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at:www.loni.ucla.edu/ADNI/Collaboration/ADNI_Authorship_list.pdf This work was partially funded by the European Research Council (ERC advanced Grant MedYMA), ANR blanc Karametria and the EU project Care4Me.\nis to encode the observed structural changes as deformation elds densely represented in the image space.\nWe can identify two distinct settings for the application of non-rigid registration: longitudinal and cross-sectional. In the former, non-rigid registration estimates the deformation eld which explains the intra-subject longitudinal anatomical changes. In the latter, the deformation eld accounts for the anatomical dierences between dierent subjects (inter-subject), in order to match homologous anatomical regions. These two settings deeply dier, since the deformations of the cross-sectional setting are often a scale of magnitude higher than the ones characterizing the subtle variations of the longitudinal setting.\nIn case of group-wise analysis of longitudinal deformations, longitudinal and cross-sectional settings must be integrated in a consistent manner. More precisely, we want to normalize the baseline to follow-up deformation in a common reference frame, by means of inter-subject registration. This way, group-wise analysis of longitudinal deformations can be performed in the reference space.\nParallel Transport in Dieomorphic Registration. Among the dierent normalization methods, the parallel transport of longitudinal deformations is a powerful and promising tool which can be used within the dieomorphic registration setting. Mathematically, parallel transporting a vector X along a curve \u03b3(t) consists in translating it across the tangent spaces to the curve by preserving its parallelism, according to a given derivative operation called (ane)\nconnection, and indicated with \u2207 \u03b3(t) (X).\nTwo main approaches are currently pursued for dieomorphic registration.\nIn the former, called Large Deformation Dieomorphic Metric Mapping (LD-DMM) [11, 2] the deformation is the endpoint of a Riemannian geodesic parameterized by time-varying velocity elds. We recall the Riemannian geodesics are dened with respect to the Levi-Civita connection, which is the unique torsionfree connection which preserves the metric 1 . In the latter, called Stationary Velocity Field setting [1] , the deformation is the endpoint of the one-parameter subgroup parameterized by a stationary velocity eld (SVF). One parameters soubgroups are non-metric geodescis with respect to the Cartan-Shouten connections [10] . Within the dieomorphic registration, the transport of longitudinal deformations can therefore be naturally formulated as the parallel transport of tangent vectors along geodesics according to the underlying connection.\nSchild's Ladder for the Parallel Transport of Longitudinal Trajectories. The Schild's Ladder is a method for innitesimally transporting a vector along a given curve through the construction of geodesic parallelograms, and provides a straightforward method to compute a rst order approximation of the parallel transport of a vector along a curve using geodesics only [9, 5] . In [7] we The Schild's Ladder. Let M a manifold and C a curve parametrized by the parameter \u03c4 with \u2202C \u2202\u03c4 | T0 = u, and A \u2208 T P0 M , a tangent vector on the curve at the point P 0 = C(0). Let P 1 be a point on the curve relatively close to P 0 , i.e. separated by a suciently small parameter value \u03c4 . The Schild's Ladder computes the parallel transport of A along the curve C as follows (Figure 1 ):\n1. Dene a curve on the manifold parametrized by a parameter \u03c3 passing through the point P 0 with tangent vector \u2202 \u2202\u03c3 | P0 = A. Chose a point P 2 on the curve separated by P 0 by the value of the parameters \u03c3. The values of the parameters \u03c3 and \u03c4 should be chosen in order to construct the Schild's Ladder within a single coordinate neighborhood.\n2. Let l be the geodesic connecting P 2 = l(0) and P 1 = l(\u03bb), we chose the middle point P 3 = l(\u03bb/2). Now, let us dene the geodesic r connecting the starting point P 0 and P 3 parametrized by \u03c1 such that P 3 = r(\u03c1). Extending the geodesic at the parameter 2\u03c1 we reach the point P 4 . We can now pick a curve connecting P 1 and P 4 . The vector A tangent to the curve at the point P 1 is the parallel translation of A along C. 3. If the distance between the points P 0 and P 1 is large, the above construction can be iterated for a sucient number of small steps.\nhal-00819898, version 1 -21 Oct 2013 The Pole Ladder. We propose here a dierent construction for the parallel transport of vectors based on geodesics parallelograms. If the curve C is geodesic then it can be itself one of the diagonals, and the Schild's ladder can therefore be adapted by requiring the computation of only one new diagonal of the parallelogram. We dene in this way a dierent ladder scheme, that we name the Pole Ladder ( Figure (2A) ).\nWe now prove that the Pole ladder is actually realizing the parallel transport.\nIn the diagram of Figure (2A) , the parallel transport of the tangent vector v =\u010a to the geodesic C is specied by the geodesic equationv + \u0393 k ij v i v j = 0. In a suciently small neighborhood the relationships can be linearized to give\nand by integrating:\nBy renormalizing the length of the vector v so that C(\u22121) = P 0 , C(0) = M and C(1) = Q 0 (and denoting \u0393 k ij = \u0393 k ij (M )), we obtain the relations:"}, {"section_title": "hal-00819898, version 1 -21 Oct 2013", "text": "Similarly, we have along the second geodesic:\nNow, to compute the geodesics joining P 0 to P 1 and Q 0 to Q 1 , we have to used a Taylor expansion of the Christoel symbols \u0393 k ij around the point M .\nIn the following, we indicate the coordinate according to which the quantity is derived by the index after a comma:\nHowever, the Christoel symbols are multiplied by a term of order O( A 2 ), so that only the rst term will be quadratic and all others will be of order 3 with respect to A and v M . Thus, the geodesics joining P 0 to P 1 and Q 0 to Q 1 have equations:\nEquating P k 1 in the previous equations gives\nSolving for u as a second order polynomial in v M and A gives\nNow equating Q k 1 in the previous equations gives\nSolving for B k as a second order polynomial in v M and A gives:\nTo verify that this is the correct formula for the parallel transport of A, let us observe that the eld A(x) is parallel in the direction of\nshows that the Pole ladder is realizing the parallel transport for a length = 2\n(remember that our initial geodesic was dened from -1 to 1) if the connection\nWe have thus demonstrated that the vector \u2212B of Figure (2A) is the transport of A and, due to the locally linear construction, it corresponds necessarily to the one transported by the Schild's Ladder.\nhal-00819898, version 1 -21 Oct 2013 Fig. 2: A) The Pole ladder parallel transports the vector A along the geodesic C. Dierently from the Schild's ladder it requires to compute only one diagonal geodesic from P 1 to Q 1 . B) Geometrical schemes of the Schild's ladder and of the Pole ladder. By using the curve C as diagonal, the Pole ladder requires the computation of half times of the geodesics (blue) required by the Schild's ladder (red)."}, {"section_title": "Application to Images", "text": "Let I i (i = 1 . . . n) be a time series of images, and let \u03d5 i = exp(v i ) the progression of longitudinal deformations from baseline to follow-up such that I i = \u03d5 i * I 0 . Given a reference template T 0 , let u i is the inter-subject SVF such that T 0 = exp(u i ) * I i . In [7] we showed that the Schild's Ladder for the transport of v i from I 0 to T 0 can be computed in closed form by the following formula:\nIn case of time series of images over multiple time points, the Schild's ladder therefore requires the estimation of the series of inter-subject SVFs u i . In addition to the computational problem of estimating several deformations through non-rigid registration, in this case the transport of the time series v i is not computed consistently with respect to the same inter-subject SVF. For this reason the resulting transported \u03a0(v i ) might be more biased by registration approximations.\nThe Pole ladder is similar to the Schild's one, with the dierence of explicitly using as a diagonal the geodesic C = exp(u 0 ) which connects I 0 and T 0 . This is an interesting property since, given C, the transport of time series of several images is based on the same baseline-to-reference SVF (Figure (2B) ). Let u 0 the baseline-to-reference SVF, the Pole ladder is therefore computed in closed form in the following way:\nhal-00819898, version 1 -21 Oct 2013 Experiment: Modeling One-Year Brain Changes in Alzheimer's Disease\nImages corresponding to the baseline I 0 and the one-year follow-up I 1 scans were selected for 135 subjects aected by Alzheimer's disease from the ADNI database. For each subject i, the pairs of scans were rigidly aligned, and the longitudinal changes were measured by non-rigid registration using the LCCDemons algorithm [6, 8] .\nThe resulting deformation elds \u03d5 i = exp(v i ) were transported with the Pole Ladder (BCH scheme) in the template reference along the subject-to-template deformation. The group-wise longitudinal progression was modeled as the mean of the transported SVFs v i . The areas of signicant longitudinal changes were investigated by one-sample t-test on the group of log-Jacobian scalar maps of the transported deformations. For the sake of comparison, the one sample tstatistic was tested on the subject specic longitudinal log-Jacobian scalar maps transported into the template space along the subject-to-template deformation. "}]
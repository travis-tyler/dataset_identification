[{"section_title": "Abstract", "text": "Traditional neuroimage analysis pipelines involve computationally intensive, time-consuming optimization steps, and thus, do not scale well to large cohort studies with thousands or tens of thousands of individuals. In this work we propose a fast and accurate deep learning based neuroimaging pipeline for the automated processing of structural human brain MRI scans, including surface reconstruction and cortical parcellation. To this end, we introduce an advanced deep learning architecture capable of whole brain segmentation into 95 classes in under 1 minute, mimicking FreeSurfer's anatomical segmentation and cortical parcellation. The network architecture incorporates local and global competition via competitive dense blocks and competitive skip pathways, as well as multi-slice information aggregation that specifically tailor network performance towards accurate segmentation of both cortical and sub-cortical structures. Further, we perform fast cortical surface reconstruction and thickness analysis by introducing a spectral spherical embedding and by directly mapping the cortical labels from the image to the surface. This approach provides a full FreeSurfer alternative for volumetric analysis (within 1 minute) and surface-based thickness analysis (within only around 1h run time). For sustainability of this approach we perform extensive validation: we assert high segmentation accuracy on several unseen datasets, measure generalizability and demonstrate increased test-retest reliability, and increased sensitivity to disease effects relative to traditional FreeSurfer."}, {"section_title": "Introduction", "text": "The rapid emergence of standardized robust noninvasive imaging methods and infrastructure for big data analysis over the years has promoted the advent of a variety of large-scale neuroimaging studies. Different initiatives aim to understand the variability, development and anatomical layout of the human brain in e.g. neurodegeneration (ADNI [1] , OASIS [2, 3] ), psychiatric diseases (LA5c [4] ), neurodevelopmental disorders (ABIDE [5] , MIRIAD [6] ) or within populations (Rotterdam Study [7] , Human Connectome Project [8] , UKBiobank [9] , Rhineland Study [10] ). A core challenge within all neuroimaging studies is the need to process and analyze the continuing stream of data in a timely manner. As Magnetic Resonance Imaging (MRI) is one versatile imaging modality and integral * Data used in preparation of this article were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report.\nA complete listing of ADNI investigators can be found at:http://adni.loni.usc.edu/wpcontent/uploads/how to apply/ADNI Acknowledgement List.pdf * * Correspondence to: Martin Reuter (martin.reuter@dzne.de).\npart of all these studies, developing efficient tools to identify clinically-relevant imaging biomarkers with MRI are in high demand. In this work we, therefore, develop a fast method for volumetric segmentation, reconstruction of cortical geometry, and morphometric estimation of brain structures including cortical thickness. It is the first work that aims at integrating a novel deep learning method for image segmentation into a complete processing pipeline that includes cortical surface reconstruction and segmentation."}, {"section_title": "Neuroimage Analysis", "text": "To date, a few well maintained neuroimage processing pipelines such as FreeSurfer [11] , BrainSuite [12] , SPM [13] , ANTs [14] , or FSL [15] are the only means available to process and evaluate the incoming flow of data. These pipelines usually employ multiple image transformation steps, some of which require careful fine-tuning of parameters such as convergence thresholds, smoothing levels, or iteration numbers. Furthermore, due to extensive numerical optimization, e.g. non-linear registration or Bayesian segmentation, these approaches are computationally expensive and suffer from long run-times. Hence, several hours are required to process a single volume, significantly limiting scalability to large cohort studies with thousands 2. surface recon Supervised deep learning approaches are an attractive alternative to replace time-intensive steps within these pipelines such as whole-brain segmentation because of their 2-3 orders of magnitude lower run-time (seconds rather than hours). Fully convolutional neural networks (F-CNN), for example, are able to learn the correct feature representations in an end-to-end fashion from the image itself without requiring lengthy pre-processing steps. These methods can be effectively parallelized on graphical processing units (GPU) resulting in an enormous speedup. Additionally, these networks often outperform traditional approaches with respect to accuracy and have become increasingly popular for pixel or voxel-wise semantic segmentation tasks in computer vision and biomedical imaging [16, 17, 18, 19, 20, 21] . In this work we propose a neuroimaging pipeline based on a novel neural network architecture for whole brain segmentation that induces local and global competition in the dense block and skipconnections."}, {"section_title": "FastSurferCNN", "text": ""}, {"section_title": "Deep Learning for Whole Brain Segmentation", "text": "The task of whole-brain segmentation in particular is challenging due to the complex 3D architecture and spatial dependency between slices, the large number of labels, the size of the scanning volumes (memory requirements), and variability across scanners and subjects. While several deep learning based approaches have been proposed for specific tasks, such as tumor segmentation [22, 23, 24, 25, 26, 27] , brain lesion segmentation [28, 29, 30, 31, 32] , MR image reconstruction [33, 34, 35, 36, 37, 38] or prediction of brain related diseases and their progression [39, 40, 41, 42, 43] full brain segmentation into more than 25 classes has -so far -only been achieved by a few groups [44, 45, 46, 47, 48] . Early networks for the task of whole brain segmentation like DeepNAT [45] relied on 3D patches instead of 2D slices and were capable of segmenting an MRI brain scan in around 60 min [45, 49] . The SkipDeconv-Net (SD-Net [46] ) is a whole-brain segmentation F-CNN based on a classic encoder-decoder architecture reminiscent of the U-net [17] . In this work, a novel loss-function was introduced that addressed the inherent class imbalance problem and alleviated segmentation errors along anatomical boundaries. Subsequently, the network architecture was extended into an F-CNN called Quick segmentation of Neuroanatomy (QuickNAT [47] ), which allows segmentation of a whole 3D brain volume into 27 structures. In this architecture, short-range skip connections were employed within each encoder-decoder block -these dense blocks were introduced in [50] for classification tasks.\nHere, we propose FastSurferCNN a deep learning architecture capable of segmenting a whole brain into 95 classes in merely 1 minute on the GPU (and 14 minutes sequential processing on the CPU). The basic architecture is inspired by QuickNAT, with three 2D F-CNNs operating on coronal, axial and sagittal views followed by a view aggregation step to infer the final segmentation [47] . Each F-CNN has the same encoder/decoder-based architecture with skip connections [17] , enhanced with unpooling layers [18] and dense connections [50] within each block. The main methodological innovations of FastSurferCNN are the introduction of competition within each block (competitive dense blocks) by replacing concatenation with maxout operations [51] , as well as the inclusion of a wider image context within each 2D F-CNN (spatial information aggregation).\nNote, that voxel-based image segmentation, on its own, is limited with regard to neuroimage analysis and biomarker extraction. Especially surface-based analysis has proven pivotal for e.g. correct estimation of thickness -an issue which has so far not been addressed in comparative publications on deep learning. Existing traditional pipelines go far beyond image segmentation and provide utilities such as creation of cortical surface models, estimation of thickness, construction of fiber tracts or functional connectivity graphs, and tools for group comparison, such as registration and statistical frameworks. A major focus of this work is to fill this gap by integrating the developed deep learning framework (FastSurferCNN) into a complete, self-contained imaging pipeline called Fast-Surfer.\nStarting from the accurate 3D whole brain segmentation, provided by our deep learning framework, we perform cortical surface reconstruction and fast spherical mapping via a novel spectral approach that quickly maps the cortex using Laplace eigenfunctions. Furthermore, we map cortical labels and include traditional point-wise and ROI thickness analysis, resulting in a full FreeSurfer alternative with approximately 60 min run-time (depending on image quality and process parallelization) of which only 1 min is attributed to the whole brain segmentation. Hence, Fast-Surfer combines the speed of supervised deep learning approaches and the convenience of the broad spectrum of surfaced-based features and analysis methodologies provided by traditional neuroimaging pipelines.\nWe extensively validate the quality of our deep learning based neuroimaging pipeline through assessment of segmentation accuracy, generalizability to unseen datasets and acquisition parameters, test-retest reliability, and sensitivity to group level differences in imaging cohorts in a number of publicly available datasets. In fact, this is the first work within deep learning approaches with such an exhaustive validation. We demonstrate that despite being orders of magnitude faster than traditional approaches, FastSurfer increases reliability and sensitivity to disease effects making it a dependable tool for future largescale population analysis tasks. The source code of Fast-Surfer is available on Github: https://github.com/reuterlab/FastSurfer. 1 "}, {"section_title": "Methodology", "text": ""}, {"section_title": "Datasets", "text": "The following 8 publicly available MRI datasets were selected for training, testing, and for extensive validation of the FastSurfer pipeline (see Table A .2 for usage summary). 1 Will be made public upon acceptance."}, {"section_title": "ABIDE II:", "text": "The Autism Brain Imaging Data Exchange II [5] contains cross-sectional data and focuses on autism spectrum disorders covering a wide age rage (5-64 years of age). The dataset contains 1044 MRI scans from 19 different institutions. The 3D magnetization prepared rapid gradient echo (MP-RAGE) sequence, or a vendor specific variant, was used to acquire all data. The corresponding sequence parameters vary depending on the site (see Table 2 of the corresponding paper for details [5] ). With the exception of a single collection (IP 1, 1.5 Tesla, Philips Achieva), all MRI data were acquired using 3 Tesla scanners (1 Ingenia and 4 Achieva (Philips), 2 MR750 (GE), 7 TriTim (Siemens), 3 Allegra (Siemens) and 1 Skyra (Siemens)) at voxel resolutions varying from 1.30 mm to 0.7 mm (majority at 1.0 mm) and is available at:\nhttp://fcon 1000.projects.nitrc.org/indi/abide/abide II.html. 20 cases from the ABIDE-II were used for training."}, {"section_title": "ADNI:", "text": "The Alzheimer's Disease Neuroimaging Initiative [1] was launched in 2003 as a public-private partnership, led by principal investigator Michael W. Weiner, MD. The dataset contains 1.5T and 3T-MRI scans acquired at a resolution of 1.0x1.0x1.2 mm with scanners from the three largest MRI vendors (GE, Philips and Siemens) and includes Alzheimer's disease patients, mild cognitive impaired subjects, and elderly controls. Data were acquired with a MP-RAGE sequence whose parameters are optimized for the different vendors (see [52] for details). The ADNI database has > 2000 participants and is available at: http://adni.loni.usc.edu. 40 cases from ADNI where used for training. 180 different cases were used for assessing accuracy and generalizability across disease groups and scanners.\nLA5c: The UCLA Consortium for Neuropsychiatric Phenomics LA5c Study [4] is a cross-sectional study and includes 142 participants diagnosed with a neuropsychiatric or neurodevelopmental disorder (schizophrenia, bipolar disorder, ADHD) and 130 normal controls (ages . T1-weighted MP-RAGE images were acquired on a 3T Siemens Trio at a single-center with field of view of 250, 256x256 matrix, and 176 1.0 mm sagittal partitions. An Inversion time (TI) of 1.1 s, echo time (TE) of 3.5-3.3 ms, repetition time (TR) of 2.53 s and flip angle of 7 \u2022 was used for all scans. This data was obtained from the OpenfMRI database (https://openfmri.org/dataset/ds000030/). Its accession number is ds000030. 20 cases from LA5c were used for training."}, {"section_title": "MIRIAD:", "text": "The Minimal Interval Resonance Imaging in Alzheimer's Disease [6] dataset includes longitudinal scans from 46 elderly individuals (ages 55+) diagnosed with Alzheimer's disease and 23 elderly normal controls. The 3D MR images were acquired at a single center with a 1.5T Signa MRI scanner (GE Medical systems), using an IR-FSPGR (inversion recovery prepared fast spoiled gradient recalled) sequence, field of view of 24 cm, 256x256 matrix, 124 1.5 mm coronal partitions (voxel size 0.9x0.9x1.5), TR 15 ms, TE 5.4 ms, flip angle 15 \u2022 , and TI 650 ms. The data is available at: https://www.ucl.ac.uk/drc/research/methods/minimalinterval-resonance-imaging-alzheimers-disease-miriad . 20 cases from MIRIAD were used for validation. 49 different cases were used to assess accuracy and generalizability to a different T1-weighted acquisition sequences (IR-FSGPR) and scanner (GE).\nOasis-1 [2] and Oasis-2 [3] : The Open Access Series of Imaging Studies 1 and 2, both contain scans from a 1.5-T Vision scanner and a TIM Trio 3T MRI scanner (both Siemens) acquired in a single-center from nondemented and demented individuals diagnosed with very mild to moderate Alzheimer's disease. All subjects were scanned in sagittal orientation with a voxel resolution of 1.0x1.0x1.25 mm and a MP-RAGE sequence with the following parameters: TR 9.7 ms, TE 4.0 ms, flip angle 10 \u2022 , and TI 20 ms. The Oasis-1 set is cross-sectional and contains 416 subject aged 18 to 96. In addition, it contains a test-retest component consisting of 20 subjects that were scanned no more than 90 days apart (all except 5 less than 30 days). The Oasis-2 set focuses on older adults (age 60+) and contains longitudinal scans from 150 subjects. Both dataset are available at: https://www.oasis-brains.org/ . 40 cases from Oasis-1 and 20 from Oasis-2 were used for training. 20 different cases from Oasis-1 where used to assess test-retest reliability and 370 cases for quantifying sensitivity to group effects."}, {"section_title": "HCP: The Human Connectome Projects Young", "text": "Adult [8] is a cross-sectional dataset and contains 1200 healthy participants from ages 22 to 35. The 3T MR images were acquired with a single scanner (customized Connectome Skyra, Siemens) using a MP-RAGE sequence with TR 2.4 s, TE 2.14 ms, TI 1 s, and flip angle 8 \u2022 . Images are 0.7 mm isotropic with a field of view of 224x224, and are de-faced. Data is available at: https://www.humanconnectome.org/study/hcpyoung-adult . 45 cases from HCP were used for assessing accuracy and generalizability to inputs with pre-processing (de-facing, downsampling)."}, {"section_title": "MMND:", "text": "This multi-subject, multi-model neuroimaging dataset was acquired with multiple functional and structural neuroimaging modalities (structural MRI + functional MRI + MEG + EEG) on the same 16 healthy volunteers [53] . Here, we only use the structural data which include T1-weighted MPRAGE and Multi-Echo Fast Low Angle Shot (MEF) sequences. The data was collected from a Siemens 3T TIM TRIO with a standard 1 mm isotropic resolution. For each participant, a T1weighted image was acquired using an MPRAGE sequence (TR 2,250 ms, TE 2.98 ms, TI 900 ms, 190 Hz/pixel; flip angle 9 \u2022 ) as well as two bandwidth-matched MEF sequences (651 Hz/pixel; TR 20 ms) at both 5 \u2022 and 30 \u2022 flip angles for each of 7 echo-times (TE 1.85 ms; 4.15 ms; 6.45 ms; 8.75 ms; 11.05 ms; 13.35 ms; 15.65 ms). This data was obtained from the OpenNeuro database. Its accession number is ds000117 . All MMND cases were used to assess generalizability to MEF sequences."}, {"section_title": "THP:", "text": "The Traveling Human Phantom [54] is a dataset collected for assessing multi-site neuroimaging reliability. The THP includes 3D MP-RAGE MRI scans at 1.0 mm isotropic voxel resolution from 5 healthy subjects acquired at 8 different imaging centers. The sites involved in this study had either a Siemens 3T TIM Trio scanner (five sites: IOWA, UMN, UCL, MGH, CCF) or a Philips 3T Achieva scanner (three sites: JHU, DART, UW). The data is available at: https://openneuro.org/datasets/ds000206 . All THP cases were used to quantify accuracy and generalizability across sites and scanners.\nParticipants of the individual studies gave informed consent in accordance with the Institutional Review Board at each of the participating sites. Complete ethic statements are available at the respective study webpages.\nAll datasets were processed using FreeSurfer v6.0.\nFreeSurfer is an open source neuroimage analysis suite [11, 55] (http://surfer.nmr.mgh.harvard.edu/). Freesurfer morphometric procedures have been demonstrated to show good test-retest reliability across scanner manufacturers and across field strengths [56, 57] . In this work FreeSurfer parcellation following the \"Desikan-Killiany-Tourville\" (DKT) protocol atlas [58, 59] is used for training and evaluation. In order to limit the number of segmentation labels, cortical regions touching each other across the hemispheres, are lateralized while all others are combined thus reducing the total number of labels from 95 (DKT without corpus callosum segmentations which are added later) to 78 during network training. The affiliation to the left or right hemisphere are restored in the final prediction by estimating the closest white matter centroid (left or right hemisphere) to each label cluster. A list of all segmentation labels is provided in the appendix (see Table A.1). In accordance with FreeSurfer, all MRI brain volumes are conformed to standard slice orientation and resolution (1 mm isotropic) before feeding them to the different deep learning networks. No further image processing is required afterwards (e.g. no skull stripping or intensity normalization)."}, {"section_title": "FastSurfer CNN", "text": "Here, we introduce the network architecture (Fast-SurferCNN) for whole brain segmentation into 95 classes (excluding background) in under 1 minute on the GPU (and approximately 14 minutes on the CPU). FastSurfer-CNN is composed of three F-CNNs operating on coronal, axial and sagittal 2D slices and a final view aggregation stage. The basic architecture of all three F-CNNs follows that of [47] , namely a sequence of 4 dense encoder and decoder blocks separated by a bottleneck layer as illustrated in Figure 2 . Within the FastSurferCNN, we now propose novel architectural elements -competitive dense blocks and spatial information aggregation -targeted to improve information recovery and increase network connectivity. In the following sections, each of these elements will be explained in detail. "}, {"section_title": "Competitive Dense Block", "text": "With the exception of our preliminary work in [60] , dense connections within convolutional blocks have been implemented via concatenation of feature maps (see Quick-NAT [47] ) -effectively doubling the numbers of learnable parameters (Figure 3 top) within each encoder and decoder block and thus considerably increasing memory requirements. Here, we employ competitive dense blocks in which concatenations are replaced with maxout acti-vations [51] . The maxout activations induce competition between feature maps and significantly reduce the number of parameters compared to the classical dense blocks, thus creating a lightweight model (Figure 3 bottom). Instead of stacking the output of previous layers on top of each other, only the maximum value at a given position is retained. Assuming L inputs, denoted as X = x l L l=1 , with each\n, where H is height, W is width and C are number of channels for a particular feature map(x l ), the maxout(X) output is given by:\nThe difference between dense blocks and competitive dense blocks can thus be described as:\nHere, H l j represents a composite function of three consecutive operations: parametric rectified linear unit (PReLU) followed by convolution and batch normalization (BN) with exception of the very first encoder block.\nIn the first block, the raw inputs are passed through BN, convolution and another BN before following the previously described architecture (see Figure 2 , CDBi vs. CDB block). The sequence of operations in H l j guarantees normalized inputs to the maxout activation thereby improving convergence [61] and increasing the exploratory span of the created sub-networks [62] simultaneously. Furthermore, filter co-adaptation is implicitly discouraged by the short-range skip-connections within the dense blocks [62] .\nIn addition to the competitive dense blocks we also implement competition across long-range skip connections. Instead of concatenating the unpooled information from the decoder arm with the corresponding feature maps from the encoder arm, we perform a maxout operation before further feeding the inputs to the competitive dense decoder blocks. All our competitive dense blocks are designed such that the inputs to this operation are already normalized (unpooling and skip transfer after BN; see Figure 2 )."}, {"section_title": "Spatial information aggregation", "text": "Due to memory constrains it is currently not possible to train a 3D deep neural segmentation network with whole brain MRI volumes. Thus, previous brain segmentation networks were trained on extracted 3D patches [45] or 2D slices [47] . However, both approaches loose spatial information critical for correct classification of a given structure. In order to recover as much information as possible, we propose a spatial information aggregation step. Here, instead of feeding only one 2D slice to the network we pass a 7-channel image by stacking the three preceding, the current, and the three succeeding slices for segmenting only the middle slice. Fundamentally, this spatial information aggregation combines the advantages of 3D patches (local neighbourhood) and 2D slices (global view)."}, {"section_title": "View Aggregation", "text": "In order to account for the inherent 3D geometry of the brain, one F-CNN per anatomical plane is trained and their outputs combined in a final view aggregation step. Depending on the orientation of the 2D slices, each network therefore learns the anatomical representation of the brain structures within the coronal, axial or sagittal view. The final segmentation is generated by aggregating the probability maps of each model through a weighted average. Combination of the three principal views can boost accuracy for cortical folds and subcortical structures, some of which are better represented in one of the individual planes. In addition, view aggregation acts as a regularizer to reduce erroneous predictions. As it is not possible to differentiate between the left and right hemispheres in the sagittal view, we merge lateral labels, effectively reducing the number of classes from 78 to 50 in the sagittal network. The probability maps of these lateralized classes are finally restored by copying the softmax output of the combined label to both left and right hemispheres. To account for this remapping step, the weight with which the sagittal predictions influence the final segmentation is reduced by one half compared to the other two views."}, {"section_title": "Model Learning", "text": "Training Dataset: 140 representative subjects from ABIDE-II, ADNI, LA5C, and OASIS (see section 2.1) were selected for training the F-CNN models and 20 subjects from MIRIAD were used for validation. Empty slices were filtered from the volumes, leaving on average 145 single view planes per subject and a total training size of above 20k images per network. In addition, we use data augmentation (random translation of maximally 16 mm) to artificially increase the training set size further.\nThe training set is balanced with regard to gender, age, diagnosis, and spans various other parameters (i.e. scanners, field strength, and acquisition parameters); the distribution of the subset is presented in Table 1 . Sufficient anatomical and acquisition variety in training images can be expected to improve network robustness, generalizability, and ultimately segmentation accuracy on most unseen scans without the need to fine-tune model weights. We will analyze generalizability to unseen datasets below. F-CNN Implementation: Independent models for coronal, axial, and sagittal plane are implemented in Py-Torch [63] and trained for 30 epochs using two NVIDIA Titan Xp GPU with 12 GB RAM and the following parameters: batch size of 16, constant weight decay of 10 \u221204 , and an initial learning rate of 0.01 decreased by 95 % every 5 epochs. The networks are trained with Adam optimizer [64] and a composite loss function of median frequency balanced logistic loss and Dice loss [46] . This loss function encourages correct segmentation of tissue boundaries and counters class imbalances by up-weighting less frequent classes."}, {"section_title": "FastSurfer Pipeline", "text": "Based on FreeSurfer methods and novel contributions, we also introduce a surface processing pipeline, that integrates our neural network architecture at its core to provide FreeSurfer volume and surface results, including cortical surfaces, thickness maps, and summary statistics in cortical regions following the DKT protocol atlas [58, 59] .\nTraditionally, surfaces are generated via a pipeline of several time-consuming processing steps: First, based on a white matter segmentation, which is patched to remove holes and ensure connectivity, initial surface triangle meshes are created for each hemisphere [65, 66] . Meshes are smoothed, mapped to a sphere to localize topological defects (i.e. holes or handles should not exist as each hemisphere should be topologically equivalent to the sphere) [67, 68] . Once all defects are fixed, surface placement along the white matter is fine-tuned and a second expanded surface (pial surface) is placed at the outer gray matter (GM) boundary, also providing thickness estimates at every point on the cortex [65, 69] . Then, surfaces are carefully mapped to the sphere a second time (minimizing metric distortions), registered to a spherical atlas [70] , and segmented into cortical parcellations (DKT atlas) [59, 71, 58] .\nBased on the DKT volume segmentation available from the FastSurferCNN we modify the above FreeSurfer pipeline to yield surface results of FreeSurfer (including thickness and cortical ROI measures). A significant speedup compared to FreeSurfer can be achieved by omitting several steps that have become obsolete, such as skull stripping and non-linear atlas registration, given that a highquality full brain segmentation has already been achieved. Furthermore, we innovate some traditional approaches by developing novel modules based on spectral mesh processing. Specifically:\n1. We use the full DKT brain volume segmentation to create a brainmask by closure, i.e. dilation and erosion, of the labels (including the ventricle label). This mask covers all labeled areas. Cortical regions are padded by one voxel layer to allow the pial surface to find its final position in some partial volume voxel between GM and CSF. Exceptions are the lateral orbital frontal and pars orbitalis to avoid capture of the optic nerve.\n2. We retrospectively construct a quick bias field corrected brain image and a linear Talairach registration as these results are needed later for some relevant statistics (e.g. intracranial vault volume for head size estimation [72] ). Here we follow FreeSurfer, except that we can initialize the NU correct [73] with the already existing brainmask.\n3. We generate initial surfaces by using a marching cube [74] algorithm rather than the traditional approach aiming at higher mesh quality at a slightly reduced number of vertices.\n4. We develop a fast mapping to the sphere using the eigenfunctions of the Laplace operator to perform a spectral embedding of the original white matter surfaces quickly (for the topology fixer). Precisely, we solve the Laplace-Beltrami Eigenvalue problem \u2206f = \u2212\u03bbf [75, 76] on the original cortical surface mesh to obtain the first three non-constant Eigenfunctions with smallest Eigenvalues. After correcting sign flips and swaps, these functions parametrize the surface smoothly in anterior-posterior, superior-inferior and lateral-medial directions. The spherical map can then be quickly obtained by projecting the 3D spectral embedding to the sphere, i.e. by scaling the 3D Eigenfunction vector to unit length for each vertex."}, {"section_title": "5.", "text": "After topology fixing and GM surface creation, we map the DKT GM segmentations from the image onto the surface and compute surface ROI statistics, such as mean thickness and curvature averages per regionmimicking FreeSurfer's surface segmentation pipeline without requiring the non-linear spherical atlas registration and segmentation. Spherical atlas registration can, however, be included if cross-subject correspondence is required, e.g. for local surface-based thickness analysis.\nOverall, this yields a fast alternative to the FreeSurfer pipeline. We will evaluate the speed-up, reliability, and sensitivity of the full FastSurfer pipeline below."}, {"section_title": "Statistics", "text": "We will thoroughly validate the novel FastSurfer pipeline in terms of accuracy, generalizability, reliability and sensitivity using, Dice overlap, intraclass correlation and group analyses on volume and thickness ROI's, as well as thickness maps. In the following sections we explain these statistical methods in detail."}, {"section_title": "Dice score", "text": "The Dice similarity coefficient (DSC) is a metric to evaluate the segmentation performance of the deep learning networks and can mathematically be expressed as\nwith binary label maps of ground truth G and prediction P (pixels of the given class indicated with 1, all others with 0). Here, the DSC is used two fold: first, to directly compare the performance of different network architectures against each other, and second, to estimate similarity of the predictions achieved with FastSurferCNN and ground truth (FreeSurfer v6.0) for a number of previously unseen datasets (generalizability). The DSC will be calculated separately for each cortical and sub-cortical structure. Note, that neural networks tend to smooth results, e.g., removing segmentation noise such as incorrect protrusions that are encountered in only a few training images and usually in random locations. While this kind of smoothing can improve segmentation accuracy, it can decrease the DSC which is partially affected by noise in the ground truth data. This is one reason why it is essential to perform additional validations (such as reliability or sensitivity analysis)."}, {"section_title": "Intraclass correlation coefficient", "text": "The intraclass correlation coefficient (ICC) is a widely used metric to assess both, the degree of correlation and agreement between measurements. Thus, it is an ideal metric to judge the reliability of a given method. The ICC ranges from 0 to 1, with values close to 1 representing high reliability. Here, we use the degree of absolute agreement among measurements also known as criterion-referenced reliability [77] to compare the FastSurfer pipeline (deep learning segmentation + post-processing) to FreeSurfer. To this end, we calculate the agreement between cortical thickness and subcortical volumes in consecutive scans using the OASIS1 test-retest set. Prior to ICC calculations, volume and thickness estimates of the subcortical and cortical structures are extracted from the segmented brains. After averaging across hemispheres, the ICC as well as the upper and lower bound with \u03b1 = 0.05 level of significance are calculated for each region using the method described in [77] . Additionally, cortical thickness maps are mapped to a common space (fsaverage) and smoothed at 15 FWHM before calculating the ICC separately for each hemisphere. The resulting overlay maps are visualized on the semi-inflated fsaverage surfaces."}, {"section_title": "Group analysis", "text": "A segmentation method can potentially reach high ICC while being insensitive to actual effects in the data. Therefore, it is important to validate the sensitivity of a given method with respect to its capability to detect known significant variations in brain morphology between diagnostic groups. Here, we measure the degree to which Fast-Surfer and FreeSurfer are sensitive to differences in cortical thickness (derived from surfaces based on the deep learning segmentations) of cognitive normal controls (CN) and subjects diagnosed with Alzheimer's disease (AD) or mild cognitive impairment (MCI). In FreeSurfer, cortical thickness is calculated as the minimal distance between the white matter and pial surface [69] . Prior to statistical analysis, thickness estimates of each subject were mapped to a common space (fsaverage) and smoothed at 15 FWHM. Using FreeSurfer's generalized linear model fit mri glmfit, we analyze the relation between the vertex-wise cortical thickness and the dementia status while correcting for gender, age and in case of the volume-based calculations for head size. Significance cut-off is set to p < 0.05 without correction for multiple comparison as we are only interested in the relative differences between the two methods (FastSurfer and FreeSurfer). The p-value maps are then displayed on the semi-inflated fsaverage surfaces. Furthermore, we calculate and report the p-values of all cortical and sub-cortical structures with p < 10 \u22125 . Here, we average the thickness and volume estimates across hemispheres prior to the statistical analysis."}, {"section_title": "Results", "text": ""}, {"section_title": "Accuracy", "text": "First we evaluate segmentation performance by comparing FastSurfer segmentations with \"ground truth\" FreeSurfer results. FreeSurfer has been selected to provide ground truth for the following reasons: 1. manual segmentations are extremely labor intensive. 2. Comparability to FreeSurfer should be maintained (training on different segmentation protocols will void any direct comparison). 3. Complex 3D structures such as cortical folds are difficult to segment manually when viewing 2D slices while automated placement of 3D surface models has the potential to outperform manual raters. To evaluate segmentation accuracy, we compute the DSC of each candidate method with FreeSurfer labels on five testsets (ADNI, OASIS1, HCP, MIRIAD and THP). Here, scans from subjects used for network training and validation (i.e. 40 subjects each from OASIS and ADNI, 20 from MIRIAD) are excluded. No subjects from HCP and THP have been included in the training set at any point. Five subjects from OASIS1 were further excluded from the testset due to heavy white matter lesion load and resulting topological surface defects in FreeSurfer and FastSurfer.\nWe benchmark our proposed network against traditional whole-brain segmentation F-CNNs namely SDNet [46] and QuickNAT [47] . Additionally, we incrementally test the importance of our network modifications. First, we evaluate the effects of competition within the dense blocks and across the long-range skip connections (CDB, see section 2.2.1). Second, we increase the information input to the network by passing the stacked 7-channel image to the network (spatial information aggregation (SPI), see section 2.2.2). Both architecture changes together comprise our final proposed FastSurferCNN. To permit a fair comparison, all benchmark networks were trained on the same data and follow the same architectural design of 4 encoder and decoder blocks separated by a bottleneck block. Each block contains the same convolutional layer architecture as illustrated in Figure 2 . The baseline architectures were further suitably adopted by modifying the final classification layer to predict 78 classes as the original implementations do not target cortical parcellations and hence comprise a much lower number of output labels (27 for QuickNAT [47] and 26 for SDNet [46] ). Furthermore, all comparative models were implemented with the above-mentioned view aggregation (see section 2.2.3). Care was taken to confirm that the adaptations are acceptable to the first author of the original papers.\nIn Figure 4 , we report the DSC against 649 previously unseen scans from ADNI (180 subjects), OASIS1 (370 subjects), HCP (45 subjects), MIRIAD (49 subjects) and THP (5 subjects). We calculate the average DSC on 33 subcortical structures and 62 cortical regions (31 per hemisphere after remapping). For a complete list of structures the reader is referred to Appendix Table A.1. Each successive network modification results in an increase of the DSC for all five datasets. Introduction of competition within the network (blue, CDB) already outperforms QuickNAT [47] (green) and SDNet [46] tively. Note, that this improvement is achieved while simultaneously reducing the number of trainable parameters by one half (from approx. 3.6 * 10 6 to 1.8 * 10 6 )! The final FastSurferCNN (dark blue) further increases segmentation accuracy on average by 0.6 % on the subcortical and 1.9 % on the cortical structures compared to Quick-NAT (final DSC of 89.08 and 85.88). Therefore, increasing the local information content provided to the network via the spatial information aggregation is particularly useful for recognizing cortical folding patterns. The same trend can be observed when analyzing the worst instead of the average DSC (data not shown). Statistical testing further confirmed a highly significant increase in DSC for both improvements (competition and information aggregation) compared to QuickNAT (Wilcoxon signed-rank test, p < 10 \u221220 after Bonferroni correction for multiple testing).\nFastSurferCNN also outperforms all other models on the challenging THP dataset. This data source contains scans from eight different sites and scanning conditions with strong variations in data quality (e.g. motion artifacts). FastSurferCNN, however, maintains high accuracy for all eight sites (average DSC 89.00 (QuickNAT: 88.37) for subcortical and 86.16 (QuickNAT: 84.43) for cortical structures). Interestingly, MRI data acquired on Philips Scanner (DART, JHU and UW) are segmented quite accurately even though the training set predominantly included Siemens scans. Additionally, the difference in accuracy between the imaging sites is far lower for FastSurferCNN than QuickNAT on the cortical structures (40 % less difference between best (JHU) and worst (IOWA) site). Notably, the algorithm also generalizes well to defaced and downsampled input images (HCP dataset) even though such examples are absent from the training set (DSC of 85.21 for the cortical and 87.36 for the subcortical structures). Inherently, FreeSurfer segments cortical parcels directly on the surface which specifically considers the curvature, e.g. to locate region boundaries inside the sulcii. Thus, cortical segmentation errors may not be accurately reflected in a volume based DSC comparison. We, therefore, also calculate the surface-based DSC for OASIS1. To this end, the volumetric segmentation of FastSurferCNN are projected onto the FreeSurfer-generated surface (considered as ground truth). The area-related DSC mapped regions is then directly calculated on the surface. As visible in Figure 5 , surface segmentation is indeed quite similar to FreeSurfer with an average surface DSC of 92.38 on the right and 92.60 on the left hemisphere. Further, all structures achieve a DSC of above 85.5."}, {"section_title": "Surface Dice Similarity Coefficient", "text": ""}, {"section_title": "Generalizability", "text": "High generalizability will ensure that the proposed method can be applied across different sites, vendors, field strengths, and for large multi-center studies. Figure 4 indicates that networks generalize well across these parameters and respective image qualities, as the DSC remains quite stable. For example, the HCP dataset consists of 0.7 mm isotropic images, downsampled to 1 mm and de-faced, which were never encountered during training. MIRIAD is a IR-FSPGR sequence on a GE scanner. Furthermore, in the THP dataset DSC scores vary only around 1 or 2 % across the 8 sites spanning Siemens and Philips scanners. The five subjects of THP, however, might not be representative, which is why in this section we quantify generalizability by computing the agreement of FastSurferCNN with FreeSurfer across different scanner types (Siemens, Philips and GE) as well as disease states (CN, MCI and AD patients) in a larger dataset. For this purpose we employ an independent testset consisting of 180 scans from ADNI balanced with regard to vendor, disease group, gender and age. In the upper part of Figure 6 the DSC across different disease states is shown. Scans from subjects with laterstage dementia are more difficult to segment, potentially due to increased motion and lower gray-white contrast. Specifically, the increase in ventricle volume, subsequent shrinkage of GM and/or increased white matter lesion load can have a profound effect and are frequently difficult to segment with traditional neuroimaging pipelines such as FreeSurfer. A small decrease in segmentation DSC (i.e. increased deviation from FreeSurfer) can be observed with disease progression (CN to AD) in our proposed method (cortical structures: DSC decreases from 86.8 to 85.8, subcortical structures: DSC decreases from 90.3 to 89.6). However, with FastSurferCNN DSC scores do not decrease more than 1.11 % between diseased (MCI, AD) and control state (CN) for cortical and 0.77 % for subcortical structures. A similar trend is observed with regard to generalizability across vendors (lower part of Figure 6 ). Even though FastSurferCNN was predominantly trained on MRI scans acquired on Siemens scanners, the segmentations of Philips and GE scans are comparable to FreeSurfer with only a minor decrease in DSC of 1.6 % for the cortical structures (see Figure 6 ). Here, GE and Philips scans can be segmented similarly well (DSC of 85.50 and 85.57, respectively). Segmentation of subcortical regions is equally consistent on Siemens and GE scans (DSC of 90.30 and 90.23, respectively). Philips scans show more variation with a difference similar to the one observed for the cortical structures (1.6 % difference compared to Siemens; DSC of 88.85). These findings in combination with the high DSC scores achieved on MIRIAD (1.5T GE Scanner) and HCP (downsampled and defaced 0.7 mm 3T Siemens), see Figure 4 , show that FastSurferCNN is capable of generalizing stably across disease stages, field strength, vendors and pre-processing.\nWhile very few GE scans were used in training (only 3 cases of ADNI), still the network has at least seen some images spanning the above parameters which might explain its good generalizability. All datasets so far acquire some kind of MPRAGE sequence, except for MIRIAD with IR-FSPGR (note, MIRIAD was not used in training, only for validation). We now test generalizability across sequences to an unseen MEF sequence (MMND dataset, see Section 2.1). This datasets provides 16 subjects each with MEF and MPRAGE scans. We first confirm, see Figure 7 (orange column), that FastSurferCNN obtains a high DSC in comparison to FreeSurfer on the MPRAGE images, again corroborating good generalizability to Philips scanners. A 6.7 % point drop in DSC can be observed when comparing both segmentation methods on the MEF images (red column). Reduced agreement on MEF images can, of course, be explained by a deviation of either (or both) methods from ground truth. In the absence of real ground truth, we set FreeSurfer's MPRAGE segmentation as the standard. To test how well FreeSurfer generalizes to MEF, we compare FreeSurfer's own segmentations across MEF and MPRAGE after robust rigid registration [78] and observe a significantly reduced DSC (82.37 on subcortical and 75.70 on cortical structures) (Figure 7 dark blue) . In comparison FastSurferCNN's MEF segmentation (using the same registrations) slightly outperforms FreeSurfer's generalizability as it is actually closer to ground truth (FreeSurfer MPRAGE) than FreeSurfer itself for subcortical structures (DSC of 83.17) and similar for the cortex (DSC of 75.67) (Figure 7 bright blue) . These results highlight an excellent generalizability of FastSurfer to the unseen T1-weighted MEF sequence. All above DSC comparisons with FreeSurfer assume accurate performance of FreeSurfer. This is of course not certain, as FreeSurfer's segmentation quality can degrade across scanners, sequences, or advanced neurodegeneration. Whenever \"ground truth\" cannot be trusted, it is difficult to quantify performance with direct comparisons, as a small DSC can also indicate noisy or erroneous ground truth. Therefore, we also perform validations in the next sections that are independent of ground truth labels but rather rely on the assumptions, that (i) anatomy does not change much in small time frames (test-retest reliability) and that (ii) known disease effects should be detected with statistical power by the new method (sensitivity). For these comparisons we run the full FastSurfer pipeline, extending the FastSurferCNN with subsequent surface processing."}, {"section_title": "Multi-Echo FLASH vs. MPRAGE", "text": ""}, {"section_title": "Reliability", "text": "Test-retest reliability is assessed as the agreement between the evaluations of two scans in a short time frame. We calculate the intraclass correlation coefficient [77] on the OASIS1 test-retest dataset with 20 participants. Note, that the acquisition source of variation (motion, noise etc.) will be identical for different image processing methods. Higher agreement can therefore be taken as an index of method stability and consistency of results. Figure 8 shows the ICC value for each structure separately including the upper and lower bound at significance level \u03b1=0.05 (black error bar) for FastSurfer (dark blue bars) and FreeSurfer (light blue bars). A higher ICC indicates a better reliability with the maximum being 1. The ICC values for the volume of subcortical structures are higher for FastSurfer on all 13 structures (0.99 on average versus 0.97 with FreeSurfer). On six structures (including Hippocampus, Putamen, Caudate and Thalamus) the agreement between scans is above 0.99. Furthermore, all confidence intervals (lower to upper bound) are smaller for FastSurfer indicating better segmentation consistency across the 20 participants. The ICC values for the thickness of cortical regions show a similar pattern, with Fast-Surfer achieving higher ICC on both hemispheres in 30 out of 31 regions. On average, an ICC of 0.92 is achieved with FastSurfer (0.87 with FreeSurfer) and 24 structures show a correlation of above 0.9. No cortical structure has an ICC below 0.78 (0.73 for FreeSurfer). Correspondingly, visualization of the ICC directly on the surface (see Figure 9 ) demonstrates that FastSurfer segmentations yield larger regions on the cortex with high ICC values (light blue) compared to FreeSurfer. Here, it is further apparent that the majority of the cortex reaches ICC values of more than 0.8 (blue areas)."}, {"section_title": "Sensitivity to Disease Effects", "text": "Sensitivity to disease effects is an essential component of our evaluation. While the accuracy of our approach (as quantified by the DSC) has already been established, we now determine to what extent our results are relevant and useful in an applied research setting. To this end, we analyze whether our proposed method is capable of reproducing well-known empirical results, in particular the effects of AD on brain structure. The sensitivity of the proposed methods to real effects is determined by evaluating their ability to separate diagnostic groups (here: AD versus CN), as indicated by the p-value, a composite measure of the size of an effect and the accuracy of its estimation. The OASIS1 dataset presents a suitable test set for this purpose and was used for the ensuing group analysis. In Figure 10 structures with p-values below 10 \u22125 are shown (based on both FreeSurfer and FastSurfer). The signed pvalues presented in the figure indicate the direction of the effect (below zero represent atrophy and above zero volume increase). Consequently, one can directly observe that the ventricle volume (lateral ventricles, inferior lateral ventricles) increases while all other structures atrophy for both, FreeSurfer and FastSurfer. In the subcortical domain, a volume reduction is specifically detected for the hippocampus, the amygdala and the thalamus, which is congruent with other research results on AD [79, 80, 81, 82, 83, 84] . FastSurfer reaches lower p-values for all three structures indicating a higher sensitivity to differences between the groups. FastSurfer and FreeSurfer are further capable of detecting significant differences in areas related to disease progression in the cortex (e.g. bilateral frontal, temporal and parietal lobe; [85, 86, 87, 88, 82] ). Specifically, parts of the temporal (superiortemporal, middletemporal, inferiortemporal, entorhinal) and parietal lobes (inferiorparietal, supramarginal) are significantly thinner (p < 10 \u221211 detected with FastSurfer for all areas). The overall thickness also correlates with disease progression (MeanThickness p < 10 \u221212 for FastSurfer). Figure 11 depicts the detected differences of cortical thinning in patients with AD compared to CN subjects with the original FreeSurfer stream (left) and our proposed FastSurfer pipeline (right) directly on the surface. The visualization complements the results of Figure 10 , clearly indicating the ability of FreeSurfer and FastSurfer to detect thinning effects across hemispheres. Again, the differences between groups are more pronounced with the FastSurfer pipeline (uncorrected p-value smaller, larger yellow regions). The Figure 9 : Visualization of the intraclass correlation coefficient on the Test-Retest OASIS1 dataset for FreeSurfer (left) and FastSurfer (right). ICC ranges from 0.8 (dark blue) to 1.0 (light blue) are shown."}, {"section_title": "FreeSurfer FastSurfer", "text": "proposed pipeline is thus not only able to separate groups effectively, but is more sensitive to disease effects than the baseline FreeSurfer pipeline and thus holds great promise for future analysis tasks."}, {"section_title": "Pipeline Innovations", "text": "As described in Section 2.3, FastSurfer is a full surface reconstruction pipeline based on FreeSurfer. Additionally to skipping/replacing some steps the two main modifications are (i) reconstructing surfaces with the marching cube algorithm and (ii) implementing a novel, fast spectral mapping to the sphere. Here we compare these two changes with a pipeline that uses the original FreeSurfer modules (mri tessellate and mris sphere) in these two steps and is otherwise identical to FastSurfer. We quantify a) the number of topological surface defects, b) the overall processing time for the surfaces, and c) the average quality of the surface triangle meshes, which is defined for each triangle as Q = 4 \u221a 3 A/(e 2 1 + e 2 2 + e 2 3 ) where A is the triangle area and e i the edges. Q is 1 for the equilateral triangle and close to zero for degenerated triangles.\nTo evaluate the two new modules, the following statistics are based on the OASIS1 dataset. The average number of defects in the pipeline with FreeSurfer modules (27.2 defects per hemisphere) decreased by 12 % (24.0 defects) when constructing the surfaces with marching cube, and 15.3 % (23.1 defects) when the proposed pipeline (Fast-Surfer: marching cube + spectral spherical projection) was used. Also the average surface processing time decreased significantly by 15 minutes per hemisphere with FastSurfer. Finally the triangle mesh quality index of FastSurfer (Q=0.902) was significantly higher than for the pipeline with the traditional modules (Q=0.888), due to the marching cube algorithm. Additionally, construction of surfaces with marching cube instead of mri tessellate slightly reduces the number of vertices on average by 120 per hemisphere (133154 versus 1333034 for tessellate and marching cube, respectively). All three tests (defects, time, quality) of the final FastSurfer pipeline with respect FreeSurfer FastSurfer Figure 11 : Group Analysis of cortical thickness variations in Alzheimer's disease compared to controls based on the OASIS1 dataset for FreeSurfer (left) and FastSurfer (right). The colorcoded uncorrected p-value map ranges from 0.05 (red) to 10 \u22127 (yellow). Differences in cortical thinning are more pronounced in the FastSurfer analysis stream.\nto the one with original modules are highly significant: the Wilcoxon signed-rank test reports a p-value below machine precision (p < 10 \u221216 ).\nOverall, in addition to these methodological innovations, our pipeline saves time by replacing many FreeSurfer steps, such as skull stripping, spherical segmentation etc., since we can directly build on the high-quality image segmentations provided by the deep neural network. Here, we compare run-times of three approaches: (i) complete regular FreeSurfer processing, (ii) FastSurfer pipeline without spherical registration, (iii) and complete FastSurfer with spherical registration. Note, while spherical registration is not needed to obtain surface segmentations and ROI thickness measures in FastSurfer, it is required to construct cross-subject correspondence, e.g., when performing vertex-wise surface thickness analyses. All pipelines are evaluated on identical subjects (10 representative subjects from OASIS1, balanced with regard to gender (5 male, 5 female), age range (21 to 86 years), and diagnosis (4 AD, 6 CN)) and identical hardware (CPU: Intel Xeon Gold 6154 @ 3 Ghz) using both, sequential processing and parallel processing (4 threads and simultaneous processing of the two hemispheres).\nIn our test a complete FreeSurfer run takes approximately 7h (4h parallel) on the CPU, which can vary depending on image quality, disease severity etc. The proposed FastSurfer pipeline achieves the volumetric segmentation in only 1 minute (on the GPU, 14 min on the CPU), surface processing including cortical ROI thickness measures in 1.7h (0.9h parallel), or complete processing including the spherical registration in 3.7h (1.6h parallel) on the CPU."}, {"section_title": "Discussion", "text": "In this work we introduce a novel semantic segmentation neural network architecture and a fast pipeline for the processing of neuroanatomical surfaces that outperforms FreeSurfer with respect to runtime, reliability and sensitivity. We contribute a novel deep learning architecture (FastSurferCNN) by introducing competition into the network (within dense blocks and long-range skip connections) and increasing the initial information content provided to the network via spatial information aggregation. Competition significantly reduces the number of network weights resulting in a slimmer architecture with lower memory requirements. We demonstrate its superior performance for the fast and detailed (close to 100 structures) segmentation of whole brain MRI compared to existing deep learning approaches. FastSurferCNN outperforms QuickNAT as well as SDNet in terms of accuracy by a significant margin. Across five different datasets our network achieves the highest DSC on the subcortical as well as cortical structures (89.08 and 85.87 on average). The lower DSC for cortical structures compared to subcortical structures can probably be attributed to the highly folded geometry of the cortex, as well as missing intensity gradients across neighboring cortical regions (GM intensity is relatively uniform). Overall, the processing time for segmenting a 3D 1mm isotropic MRI brain scan is kept below one minute. Fast MRI segmentation opens up multiple avenues of potential applications, ranging from direct feedback or field-of-view localization during image acquisition, fast clinical decision support by quantitative personalized measurements, and scalability to very large cohort data sets. Many such applications require no surface models and can terminate after the 1 minute image segmentation step, allowing rapid processing of the incoming data.\nOne frequently quoted limitation of learning-based approaches is the uncertain generalizability beyond image types encountered during training. This limitation is valid and it remains unclear how far networks generalize, e.g., to different sequences, disease or age groups. Various domain-adaptation approaches have been introduced to accommodate fine-tuning a network to a new type of data, and should be considered when network performance degrades. In this work, we put an emphasis on evaluating generalizability of our method. We first demonstrate good generalizability to different sites, vendors, field strength, scanner types, and across disease groups. Analysis on HCP further highlights generalizability to down-sampled and de-faced high-res images, which were never encountered during training. Furthermore, we were able to demonstrate good generalizability to a completely unseen multiecho FLASH sequence, even outperforming FreeSurfer. These results are very promising, yet, we recommend users to visually inspect images to ensure good quality for their acquisition setting as good generalizability to any T1weighted sequence is certainly not guaranteed.\nExtending the image segmentation network, our full FastSurfer pipeline permits the fast analysis of cortical thickness (vertex-wise and region-wise) following the DKT atlas. This is achieved by both optimizing and replacing multiple steps of the FreeSurfer pipeline, e.g. by mapping segmentation results from the image to the surfaces. Processing of a single MRI volume with parallelization can thus be achieved in below 1h including thickness ROI analysis, and 1.6h including surface registration for crosssubject correspondence -a fraction of the time a whole FreeSurfer run needs to complete (4h with parallelization). Some of this speed-up can also be attributed to the reduced number of detected topological defects. Marching cube seems to be reducing the number of defects on the initial surfaces already, but also the new spectral spherical mapping helps further reduce detected defects, potentially due to the smooth embedding of the eigenfunctions and resulting reduction of self-folds. Future work will focus on increasing processing speed further, e.g., by including deep-learning based registration procedures. Also note, that ongoing activities to parallelize and speed-up traditional FreeSurfer code will directly impact multiple components of the FastSurfer pipeline (such as the topology fixer, surface reconstruction, cross subject registration etc.).\nOur extensive validation of FastSurfer further includes test-retest reliability and sensitivity studies. Fast-Surfer exhibits improved test-retest reliability relative to FreeSurfer. This is reflected in higher ICC values across both hemispheres for FastSurfer (on average 0.92 for all cortical and 0.99 for all subcortical structures). Given that increased reliability can be bought by extensive smoothing, potentially at the cost of sensitivity, we evaluate Fast-Surfer's sensitivity do known disease effects in AD. Here, we can replicate group differences between CN and AD patients with high sensitivity. Specifically, AD-related significant volume reductions in amygdala and hippocampus, increased ventricle volume, as well as cortical thinning in the temporal and parietal lobes were detected with both FastSurfer and FreeSurfer.\nInterestingly -and in spite of using FreeSurfer for training -FastSurfer outperforms FreeSurfer with respect to statistical power in these discrimination tasks, most likely due to its implicit noise reduction: While consistent errors in FreeSurfer segmentations will be learned, random segmentation noise such as local inaccuracies or protrusions are averaged out and might allow the network to achieve superior results. The inherent training paradigm of Fast-SurferCNN can be considered another contributing factor. During training, the network has been exposed to various pathological scans with high anatomical and acquisition variability in contrast to the limited number of cases (40) within the FreeSurfer atlas. The larger corpus likely improves the resulting segmentations and derived volume and thickness estimates. In fact, it is remarkable that the 140 training cases (plus augmentation) are sufficient to provide these excellent results. This is put into perspective by considering that in fact 20k 2D images (some of them highly correlated -of course) are used for training each view. Still it can be expected that training with more cases will improve accuracy and generalizability further, leaving space for future exploration.\nFinally, one of the major advantages of supervised learning over traditional pipelines is that consistent errors can be removed by manually fixing existing or adding new training cases. This is in stark contrast to model based pipelines, where updates or fixes to the algorithm can only be introduced by a handful of experts and often have unintended consequences. Future work can thus explore training on very large and heterogeneous datasets, as well as the inclusion of manual labels or manually corrected automated labels to improve segmentation quality even further.\nOverall we introduce a fast, stable, reliable and sensitive pipeline for automated neuroimage analysis that scales well to large datasets and enables various new applications where segmentation speed is essential, for example: to localize structures during image acquisition, to provide quantitative measures in clinical workflows, or to process large cohort studies efficiently."}, {"section_title": "Acknowledgment", "text": "Support for this research was provided in part by NIH R01NS083534, R01LM012719, and by an NVIDIA Hardware Award as well as the BRAIN Initiative Cell Census Network grant U01MH117023, the National Institute for Biomedical Imaging and Bioengineering (P41EB015896, 1R01EB023281, R01EB006758, R21EB018907, R01EB019956), the National Institute on Aging (1R56AG064027, 5R01AG008122, R01AG016495), the National Institute of Mental Health the National Institute of Diabetes and Digestive and Kidney Diseases (1-R21-DK-108277-01), the National Institute for Neurological Disorders and Stroke (R01NS0525851, R21NS072652, R01NS070963, R01NS083534, 5U01NS086625,5U24NS10059103, R01NS105820), and was made possible by the resources provided by Shared Instrumentation Grants 1S10RR023401, 1S10RR019307, and 1S10RR023043. Additional support was provided by the NIH Blueprint for Neuroscience Research (5U01-MH093765), part of the multi-institutional Human Connectome Project. In addition, BF has a financial interest in CorticoMetrics, a company whose medical pursuits focus on brain imaging and measurement technologies.\nBF's interests were reviewed and are managed by Massachusetts General Hospital and Partners HealthCare in accordance with their conflict of interest policies. Data used in the preparation of this article were obtained in part by the OASIS Cross-Sectional with principal investigators D. Marcus, R, Buckner, J, Csernansky J. Morris; P50 AG05681, P01 AG03991, P01 AG026276, R01 AG021910, P20 MH071616, U24 RR021382, and OASIS: Longitudinal: Principal Investigators: D. Marcus, R, Buckner, J. Csernansky, J. Morris; P50 AG05681, P01 AG03991, P01 AG026276, R01 AG021910, P20 MH071616, U24 RR021382. Further, data used in the preparation of this article were obtained from the MIRIAD database. The MIRIAD investigators did not participate in analysis or writing of this report. The MIRIAD dataset is made available through the support of the UK Alzheimer's Society (Grant RF116). The original data collection was funded through an unrestricted educational grant from Glaxo-SmithKline (Grant 6GKC). Data collection and sharing for this project was funded by the Alzheimer's Disease Neuroimaging Initiative (ADNI) (National Institutes of Health Grant U01 AG024904) and DOD ADNI (Department of Defense award number W81XWH-12-2-0012). ADNI is funded by the National Institute on Aging, the National Institute of Biomedical Imaging and Bioengineering, and through generous contributions from the following: AbbVie, Alzheimer's Association; Alzheimer's Drug Discovery Foundation; Araclon Biotech; BioClinica, Inc.; Biogen; Bristol-Myers Squibb Company; CereSpir, "}]
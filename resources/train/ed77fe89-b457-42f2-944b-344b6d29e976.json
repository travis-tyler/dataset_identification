[{"section_title": "Introduction", "text": "Numerous sensor types have been used to measure water level in marine and nonmarine environments. Those presently in use within the U.S. National Water Level Observation Network (NWLON) of over 200 stations maintained and operated by the National Oceanic and Atmospheric Administration (NOAA)'s Center for Operational Oceanographic Products and Services (CO-OPS) include shaft angle encoders, pressure, bubbler, and acoustic sensors. More recently, microwave radar has emerged as a promising technology for water-level measurements (Barjenbruch et al. 2002;Woodworth and Smith 2003;Boon and Brubaker 2008;Boon et al. 2009;Heitsenrether and Davis 2011;Heitsenrether et al. 2011;Boon et al. 2012). A pulse radar device, the model H-3611i WaterLog microwave (MW) water-level sensor by Design Analysis Associates, Inc., has been evaluated by CO-OPS for operational service as a water-level sensor, one that differs from previous sensors in having no components in contact with the water, a feature that significantly lowers both installation and maintenance costs. Other advantages attributed to noncontact MW water-level sensors include high accuracy (60.003 m for the H-3611i, as stated in the owner manual) partly due to high operating frequencies (;26 GHz) and, in contrast to acoustic sensors, MW water-level sensors are insensitive to changes in temperature, barometric pressure, and humidity. However, unlike contact systems, these sensors typically lack external components capable of ''filtering'' surface motion at wind-wave frequencies, either by physical device (e.g., a stilling well with a restrictive bottom orifice or a conduit to open water at depth) or by hydrodynamic means (frequency-dependent attenuation of wave-orbital motion and pressure variation at depth in the case of a pressure sensor). Consequently, irregularities sensed within the radar beam ''footprint'' at the airwater interface introduce additional variance into the return signal at wind-wave frequencies. The added variability represents higher-frequency information of limited use in conventional water-level applications (tidal analysis and tidal predictions, sea level trends, storm surge, water-level extremes) while adding significantly to the uncertainty associated with a processed waterlevel measurement derived as an average over several minutes. Following the suggestion by Boon and Brubaker (2008) that a digital filter is needed to achieve better measurement precision for MW water-level sensors deployed in estuaries, a multisensor experiment was later carried out to evaluate the effect of filtering on measurement error in an ocean environment. The results address situations where measurement bias may occur, as well as loss of measurement precision expected as a function of in situ wave height. A key finding is that optimum filter selection depends on several factors, including the sampling rate, nominal sample size, sensor firmware, and processing methods in use. Factors specific to MW water-level sensors deployed during the experiment are discussed along with CO-OPS operational requirements in the following section."}, {"section_title": "Multisensor measurements from an ocean pier, Duck, North Carolina", "text": "New estimates of uncertainty associated with MW water-level measurements were derived by the author from field observations collected by CO-OPS personnel from mid-June to mid-November 2011, at the U.S. Army Corps of Engineers Field Research Facility (USACE FRF) at Duck. Four MW water-level sensors collocated on a leveled mounting plate (Fig. 1) were installed approximately 30 m from the end of the 550-m research pier adjacent to a USACE FRF nondirectional recording wave gauge (Baylor wave staff) on the south side of the pier. Time series of zero-moment (Hm 0 ) wave height were available over the deployment period until mid-November (see wave archives at http://www.frf. usace.army.mil/), when the Baylor wave gauge became inoperative. The Hm 0 wave heights recorded during this period are shown in Fig. 2. a. Water-level sampling rate, vertical reference The standard sampling rate for CO-OPS water-level sensors is one sample per second (1 Hz). The 1-Hz output from each MW sensor (DA1, DA2, DA3, DA4 in Fig. 1) was recorded by a Sutron Xpert datalogger/ controller as range (m) from the sensor transducer to the air-water interface. The raw data were subsequently converted to heights (m) above NOAA station datum (STND) by subtracting range from the datum offset, a fixed value arbitrarily assigned by CO-OPS as the vertical distance between the sensor leveling point and STND. The leveling point used for the H-3611i is the bottom of the mounting flange, a surface that coincides with the top of the leveled mounting plate. A separate adjustment was then applied for the sensor offset, a calibration value determined prior to deployment for each sensor individually as the difference between measured and indicated range from the sensor leveling point to a fixed target in the laboratory."}, {"section_title": "b. Sensor version, operating mode", "text": "The WaterLog model H-3611i sensor is supplied with several range options. NOAA CO-OPS evaluated two separate versions: 1) a short-range (0-20 m) version with blue housing and 2) a long-range (0-40 m) version with white housing. Along with greater range, the latter version has greater signal strength compared to the shortrange version. In the present experiment, one short-range sensor (DA4) and three long-range sensors (DA1, DA2, and DA3) were available for deployment in the configuration shown in Fig. 1. The model H-3611i sensor firmware offers a choice of processing modes, allowing the user to set the level of internal filtering performed on raw ''time of flight'' signals over 1 s, a setting that affects the 1-Hz measurement response time. Two of the available settings were tested by CO-OPS: 1) a standard mode performing a higher level of internal filtering and 2) a fast mode performing minimal internal filtering. Sensors DA1 and DA4 were operated in standard mode with sensors DA2 and DA3 operating in fast mode during the 2011 deployment at USACE FRF in Duck. c. CO-OPS data quality assurance processing of 1-Hz water level CO-OPS standard operating procedures for data quality assurance processing of water levels presently include an automated method for the detection and elimination of outliers by the datalogger in the field (Gill and Schultz 2001). The method specifies a standard sample size (presently 181 s but expected to increase to 360 s for the new radar sensor) for use in computing a sample average every 6 min. Values lying more than three standard deviations (3s) from the sample mean are considered outliers and are removed from the sample prior to recalculation of the sample mean and standard deviation. Recalculated means are available at NWLON stations as unverified 6-min water levels reported on the hour and tenth of the hour at the CO-OPS data products website (http://tidesandcurrents.noaa. gov/), or using the CO-OPS data access gateway http:// opendap.co-ops.nos.noaa.gov/). The CO-OPS method for rejecting outliers may be referred to as Gaussian elimination, as it assumes the sampled data are normally distributed wherein 0.3% or fractionally less than one in 181 sample items belonging to the distribution will deviate more than three standard deviations from the mean. However, MW water-level observations frequently show skewed (non-Gaussian) sample distributions, suggesting a need for closer scrutiny of the ''3s'' criterion for outlier elimination. Skewness introduced by surface gravity waves has the potential to introduce measurement bias if the values eliminated are not true outliers but properly belong within the longer tail of the water-level distribution. Here ''properly'' raises the question of whether wind-wave motion should be part of a water-level measurement at all. If not, then a low-pass filter with an appropriate cutoff frequency should be used to remove it before addressing possible outliers."}, {"section_title": "Wind-wave effects and filter design", "text": "The 2011 season provided a typical example of the wind-wave climate during summer and fall at Duck beginning with a series of high waves (Hm 0 5 2.9-3.5 m) generated by Hurricane Irene in late August (Fig. 2). Temporal variability in MW water-level observations during this event can be better understood by comparing a time series of 6-min water levels (360-s average) computed on the hour and tenth of the hour with a time series of 6-min moving averages computed at 1-s intervals. Figure 3 provides an example using data from sensor DA2 during Hurricane Irene on 27 August 2011 (Julian day 239). At most operational CO-OPS tide stations, raw 1-Hz water levels are not stored and only a 360-s data window is available to the Sutron Xpert logger/controller for processing and recording. Special arrangements were made during the Duck experiment to collect a continuous series of 1-Hz measurements; a Butterworth low-pass filter with 360-s cutoff applied to this series produced a smoothed curve or ''basis signal,'' providing a model of water-level change with windwave and surf beat signals removed. Figure 4 compares the results for sensor DA2 over a 3-day period during Hurricane Irene and shows that individual 6-min water levels may deviate by as much as 6 cm from the model in either direction, although the RMS difference for the full period is 61.06 cm and individual values were only a fraction of this amount during the relatively calm conditions before and after Irene."}, {"section_title": "a. MW water-level asymmetry", "text": "Previous studies conducted at Duck USACE FRF have noted the uncertainty that appears in MW waterlevel measurements in the presence of surface gravity waves and the positive correlation between measurement error and wave height (Boon et al. 2009(Boon et al. , 2012. Wave height has also been identified in the present study as a significant contributor to water-level asymmetry observed in 1-Hz sample distributions. This is not accidental, as the H-3611i sensor operating in fast mode without subsequent filtering behaves to some extent as a wave gauge wherein surface elevations tend to follow a Rayleigh distribution in the presence of high waves. Figure 5 illustrates a distribution of this type observed during Hurricane Irene in which the asymmetry can be clearly seen favoring the positive side toward higher water levels: nine 1-Hz values exceed 3s in the positive direction and none exceeds 3s (or even 2s) in the negative direction. While the sample distribution shown in Fig. 5 is atypical of everyday conditions, outlier asymmetry is not. A time series of 3s outlier counts over the 3-day period 26-28 August 2011 (Julian days 238-240) reveals more positive than negative outliers (Fig. 6). Eliminating all of them prior to any subsequent treatment of the data will introduce a small but consistent FIG. 3. Microwave water levels from sensor DA2 on 27 Aug 2011 (Julian day 239) during Hurricane Irene. Dots are 6-min averages recorded on the hour and tenth of the hour. Thin black line indicates 6-min moving average values computed at 1-s intervals; the heavy black line is the basis signal derived from 1-Hz moving averages using a third-order, zero-phase Butterworth filter with a 360-s cutoff period; 3s outlier elimination not applied. FIG. 4. Deviations between basis signal and 6-min water levels from sensor DA2 recorded on the hour and tenth of the hour, 26-28 Aug 2011 (Julian days 238-240); 3s outlier elimination not applied. bias in 6-min water-level averages in the direction of lower water level. It will be shown (section 4) that a prefilter is needed to avoid the introduction of bias from this source in recalculated means."}, {"section_title": "b. Least squares filter design", "text": "It has long been the practice at NOAA tide gauge installations to use a float well (stilling well) to ''dampen wind waves while freely admitting the tide'' (Hicks 1975, p. 8). As electronic data systems became available to collect data at a higher rate and damping of highfrequency waves became less important, a protective well was introduced with a relatively large bottom orifice admitting wind waves of higher frequency, as well as tides (Gill and Schultz 2001). The response characteristics of physical devices such as these in filtering waves are nonlinear and not easily expressed. In contrast, a low-pass numerical filter can be designed with the desired transfer function after specifying a cutoff frequency and filter width. FIG. 6. Time series of the number of outliers more than 3s above (diamonds) and below (circles) the sample mean as measured by sensor DA2, 26-28 Aug 2011 (Julian days 238-240). If 3s outlier elimination were applied, then a greater number of ''positive'' than ''negative'' outliers would be eliminated (e.g., nine positive and no negative outliers for the sample in Fig. 5). A finite impulse response (FIR) filter has been tested as a prefilter applied to raw MW water-level samples collected at Duck USACE FRF. A detailed description of this low-pass digital filter is given by Bloomfield (2000), including systematic filter design methods based on least squares approximation to an ideal filter with transfer function for positive frequencies not exceeding f 5 0.5 Hz and cutoff frequency f c 5 T c 21 , where T c 5 cutoff period (s). The approximation yields an optimal set of filter weights g u (u 5 0, . . . , k) as the Fourier coefficients with index u: which are multiplied by a convergence factor (Bloomfield 2000, p. 112) to obtain the final set of weights as with g k,0 5 g 0 5 2f c . In Eq. (3) k is the filter width and 2k 1 1 is the filter span; the filter is symmetric and thus g k,2u 5 g k,u . Application of convergence factors reduces overshoot and sidelobes present in the least squaresdesigned (LSD) filter with response function Figures 7 and 8 contain examples of the response function and weights, respectively, for an LSD filter with cutoff period T c 5 60 s and width k 5 179. In general, the transition band between zero and full response becomes narrower with increasing filter width, a desirable characteristic allowing a more precise statement of the frequency content of a standard oceanographic product such as the 6-min water level. Given a 360-s sample, the maximum filter width is k 5 179. Implementation of the LSD filter described above requires only a predetermined set of filter weights fg k,2u , g k,2u11 , . . . , g 0 , . . . , g k,u21 , g k,u g derived with Eqs. (2) and (3) for a given cutoff period and filter width. For a discrete time series, h t , t 5 0, 1, . . . , n 2 1, the filtered series, z t , is derived as c. Application of LSD filter to MW water levels When applying Eq. (5), n 2 2k filtered values are computed with k values omitted at either end of an input series of length n. With a long series of continuous 1-Hz data available, the loss is of little consequence in exploratory analysis where the filter span is relatively small; that is, (2k 1 1) n. Regarding the operational objective-the design of a prefilter to be applied at the level of the data collection platform in the fieldthe derivation of end values is not necessary. Only the central value in a nominal series with n # 360 s is required as a filtered data point with its weighted mean replacing the simple arithmetic mean as the logged 6-min water level. For this particular application, it is desirable to choose a filter span that approximates the 1-Hz water-level sample size; that is, 2k 1 1 # 359 or k # 179. the number of 1-Hz data points logged every 6 min is sometimes less than 360 due to missing data and hence filter width k 5 179 used in Figs. 7 and 8 is a reasonable choice as a standard. Indexed filter weights at either end of the set in Fig. 8 are near zero, implying very little change if not all weights are used given a reduced sample size of, say, n 5 355 s (k 5 177). In the event of an even-numbered sample size, the data can be separated into two overlapping series with an odd number of points and an average taken of the resulting pair of filtered means."}, {"section_title": "d. Water-level power spectra", "text": "In addition to ease of application to MW water-level measurements in situ, the LSD filter allows for precise control of the spectral content of those same measurements as illustrated in Fig. 9. Using the Welch spectral estimation method (Welch 1967), power spectra were derived from the 1-Hz record obtained by sensor DA2 over 26-27 August 2011 (Julian days 238-239). Other periods and other test sensors have produced similar spectra with relatively uniform power levels at frequencies from 0.001 Hz (period 10 3 s) up to about 0.02 Hz (period 50 s) using standard mode (e.g., sensor DA1) or to about 0.1 Hz (period 10 s) using the fast mode (e.g., sensor DA2) followed by an irregular power drop-off to the Nyquist frequency (Fig. 10). In place of the variable transition across the wind-wave frequency band, an LSD filter can be used to construct a more consistent terminus admitting variance up to a welldefined frequency limit by choosing 20 # T c # 60 s as shown in Fig. 9."}, {"section_title": "Measurement error: Bootstrap standard error and bias estimates", "text": "Using classical statistics, the sample mean and sample standard error for a measured variable x are calculated as and To apply the LSD filter, it is necessary to use Eq. (5) with n # 360 and k # 0.5(n 2 1) in place of Eq. (6) for the derivation of a 6-min water level from 1-Hz data. Equation 7does not apply in this case, but an alternate method of estimating measurement precision (measurement error) is readily available. It is convenient here to adopt a nonparametric method, the bootstrap, leading to both estimates. Bootstrap resampling with replacement (Efron and Tibshirani 1993; Mudelsee 2010) can be applied to a dataset ordered in time, to obtain a bootstrap sample of n items drawn at random from X to form a new set, Each bootstrap sample item (with X subscript index selected by a random number generator) can appear once, more than once, or not at all in X 0 under the replacement rule. A new statistic, the bootstrap sample mean b can then be calculated for this set. Repeating the process N times, a set of N independent replicate means is found, Set B in Eq. (10) is a sample of a population of normally distributed means. Using the 1-Hz water-level data that form the highly skewed distribution appearing in Fig. 5, the corresponding frequency distribution of the bootstrap replicate means shown in Fig. 11 has Gaussian symmetry. Here the average replicate mean, or simply the bootstrap mean, is given the symbol B and the standard deviation about this mean, denoted as S B , is equivalent to the sample standard error S x in Eq. 7. In the present work with n # 360, bootstrap analyses of the Duck water-level data have been conducted with N 5 1500, a larger number that reduces class-interval width and improves the histogram resolution (as seen in Figs.  11 and 12). Note that values for B and S B reported in the caption for Fig. 11 are the same as the mean and standard error, respectively, in Fig. 5. In Fig. 11, however, the tails of the distribution are symmetrical and only a very small fraction of the 1500 means fall outside the range B 6 3S B . There is little in Fig. 11 to suggest the need to remove outliers."}, {"section_title": "a. MW sensor bias and standard error", "text": "The introduction of systematic error or bias into any process involving a calculated result is a serious concern but especially so for a standard data product such as the CO-OPS 6-min water level and its derivatives, the hourly heights, and monthly-mean water levels recorded for NOAA's NWLON stations. As a measure of longterm consistency, monthly water-level averages were compiled from 6-min data for the MW test sensors deployed at Duck using 3s outlier elimination without prefiltering ( Table 1). The averages are each within 1 cm of the four-sensor group mean for the month shown with the exception of sensor DA4, whose averages fall 1.7 cm below the group mean for September and November 2011. Although monthly averaging yields results that are reasonably consistent, the same is not true at other time scales. Referring once more to the 360-s unfiltered water-level sample from sensor DA2 shown in Fig. 5, this highly asymmetric distribution would lose a total of nine data points if subject to 3s outlier elimination without prefiltering, all of them taken from the high side of the distribution. Removing these values causes the bootstrap mean to change from 6.496 to 6.446 m (0.05-m decrease) and the bootstrap standard error to change from 0.029 to 0.025 m (0.004-m decrease) as illustrated in Figs. 11 and 12. The small reduction in standard error in this example is greatly outweighed by the 5-cm reduction in mean value, a bias introduced through outlier FIG. 11. Distribution of 1500 replicate means for unfiltered 360-s water-level sample from sensor DA2 collected at 1442 UTC 27 Aug 2011 (Julian day 239.6122). Bootstrap mean and standard error are 6.496 and 0.029 m, respectively; 3s outlier elimination procedure not applied. elimination applied to skewed, unfiltered data from a single 6-min sample. However, applying a prefilter with T c $ 20 s not only eliminates the bias in this example but achieves a substantial reduction in standard error as shown in Table 2. A further example is provided in Table 3 containing water-level averages over a 24-h period of high wave activity (Hm 0 5 3.1 m) recorded at Duck on 5 November 2011 (Julian day 309). This example shows that the negative bias, represented by the change in sample average B over one day, can exceed 1 cm for sensors DA2 and DA3 operating in fast mode without prefiltering. As also noted in Table 3, bias for sensors DA1 and DA4 operating in standard mode experience some reduction in bias even without prefiltering, but bias is effectively eliminated in both modes by prefiltering at the highest cutoff, T c 5 60 s."}, {"section_title": "b. MW sensor standard error versus wave height", "text": "The 2011 data available at USACE FRF include nearcontinuous measurements of Hm 0 wave height suitable for comparison with simultaneous measurements of MW water-level standard error determined as S B using the bootstrap method. Wave heights recorded by the Baylor wave staff described in section 2 were scanned from mid-June to mid-November 2011, when the wave staff became inoperative. The values for Hm 0 were averaged over selected 6-h periods with the aim of obtaining a wide range of wave height means during intervals of reasonably stationary sea state. The resulting Hm 0 means matched with corresponding 6-h averages of S B are displayed in Fig. 13 for the four MW sensors, with and without prefiltering, and without 3s outlier elimination. The six graphs in Fig. 13 reveal contrasting levels of sensor performance in the presence of wind waves. Without prefiltering, sensors DA2 and DA3 operating in fast mode (Fig. 13a) display the highest rate of error increase with increasing wave height, along with greatest divergence of data points about their degree-two polynomial curves of best fit. Sensors DA1 and DA4 operating in standard mode (Fig. 13b) are better fitted by their respective polynomials, which show more positiveupward curvature; however, the curve for DA4, a shortrange sensor, has the higher rate of the two and almost the same standard error maximum (;3.0 cm) as fast-mode sensors DA2 and DA3. However, when prefiltering is applied, there is a dramatic reduction in the rate of standard error increase for sensors DA2 and DA3 that is  not seen in the corresponding curves for sensors DA1 and DA4. Applying an LSD prefilter with T c 5 20 s reduces standard error and improves curve fit to the data points across all wave heights for sensors DA2 and DA3 ( Fig. 13c) but produces almost no change for sensors DA1 and DA4 (Fig. 13d). Further reductions are seen for sensors DA2 and DA3 after prefiltering with T c 5 60 s (Fig. 13e), while only modest change occurs for standard mode sensors DA1 and DA4 (Fig. 13f). Once again, the comparisons illustrated in Fig. 13 are derived from 1-Hz MW water-level data processed without 3s outlier elimination. As shown in section 4a, outlier elimination without prefiltering of 1-Hz data introduces a bias in the mean water-level estimate that is also likely to vary with wave height and would thus reduce the value of the comparisons in Fig. 13. Additional tests applying 3s outlier elimination after prefiltering had little or no effect on standard error values."}, {"section_title": "Conclusions", "text": ""}, {"section_title": "a. Measurement precision", "text": "The present study of in situ MW water-level measurements from an open-ocean site, the USACE Field Research Facility in Duck, finds that the model H-3611i operating as an air-gap sensor responds to water-level change across a broad range of frequencies, including a significant contribution appearing at wind-wave frequencies (0.05 Hz and higher). Traditionally, water levels recorded at ''tide stations'' in the United States have included minimal variance from this source, either because the station is located in a quiescent environment (e.g., a harbor) or the variance has been removed by a physical device (e.g., a tide gauge stilling well). With deployment of the microwave sensor now pending, a low-pass numerical filter will be required if this tradition is to remain uniform across stations in varying wave regimes. Otherwise, the cost of full-spectrum information is likely to be greater uncertainty associated with NOAA's standard 6-min water level at stations routinely exposed to moderately high waves (Hm 0 $ 1 m). An LSD filter configured for simple application in the field allows the uppermost frequency limit on MW waterlevel spectral content to be precisely set. Under high wave conditions (Hm 0 ; 3 m), reductions in 6-min water-level standard error from about 63 to about 62 cm can be expected after applying an LSD filter with a 20-s cutoff period, further reduced to 61 cm after applying one with a 60-s cutoff period. The uncertainty associated with NOAA's standard oceanographic product-the unverified 6-min water level-could thus be limited to 61 cm over a wide range of expected wave heights as shown in this study."}, {"section_title": "b. Measurement accuracy", "text": "In addition to affecting measurement precision as represented by the bootstrap standard error on MW 6-min water-level averages, wind waves not removed from 1-Hz water-level records have the potential to introduce a systematic bias affecting their accuracy. The potential is realized when data outliers, as defined by the 3s criterion, are removed and the average recomputed without correcting for wave-induced asymmetry when present in sample distributions of 1-Hz water level. The 2011 MW data obtained at Duck USACE FRF show that a negative bias of up to 5 cm in the direction of lower water levels can occur in a recomputed 6-min water-level average under high wave conditions (Hm 0 ; 3 m), with negative bias of more than 1 cm noted in recomputed means averaged over a 24-h period under the same conditions. Prefiltering of the 1-Hz MW water level (360-s samples) with the proposed LSD filter both removes the potential for bias and lessens the need for outlier elimination at the 3s level.  c. Data quality Applying the LSD filter to microwave water levels will have no adverse effect on data quality assurance in terms of preventing bad data from entering NOAA water-level archives; the same or perhaps greater assurance can be achieved by choosing another, more restrictive criterion for initially removing true outside values or data ''blunders.'' Conversely, operating the H-3611i microwave sensor without prefiltering where wind waves are present even part of the time risks compromising this assurance more broadly through increased data uncertainty. Among the present sensor operation and data processing options, perhaps the most FIG. 13. Measurement standard error as a function of zero-moment (Hm 0 ) wave height for sensor DA1 (gray diamonds), DA2 (black squares), DA3 (gray triangles), and DA4 (black circles) operating in (a) fast mode, no filter; (b) standard mode, no filter; (c) fast mode, 20-s filter; (d) standard mode, 20-s filter; (e) fast mode, 60-s filter; and (f) standard mode, 60-s filter. Data fitted with degree-two polynomial curves; 3s outlier elimination procedure not applied. desirable combination would be fast-mode operation applying a 60-s prefilter without 3s outlier elimination. Fast-mode operation with 3s outlier elimination but without prefiltering is least desirable."}]
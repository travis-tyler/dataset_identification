[{"section_title": "Abstract", "text": "Abstract-Magnetic resonance imaging (MRI) has become an important imaging technique for quantifying the spatial location and magnitude/direction of longitudinal cartilage morphology changes in patients with osteoarthritis (OA). Although several analytical methods, such as subregion-based analysis, have been developed to refine and improve quantitative cartilage analyses, they can be suboptimal due to two major issues: the lack of spatial correspondence across subjects and time and the spatial heterogeneity of cartilage progression across subjects. The aim of this paper is to present a statistical method for longitudinal cartilage quantification in OA patients, while addressing these two issues. The 3D knee image data is preprocessed to establish spatial correspondence across subjects and/or time. Then, a Gaussian hidden Markov model (GHMM) is proposed to deal with the spatial heterogeneity of cartilage progression across both time and OA subjects. To estimate unknown parameters in GHMM, we employ a pseudo-likelihood function and optimize it by using an expectation-maximization (EM) algorithm. The proposed model can effectively detect diseased regions in each OA subject and present a localized analysis of longitudinal cartilage thickness within each latent subpopulation. Our GHMM integrates the strengths of two standard statistical methods including the local subregion-based analysis and the ordered value approach. We use simulation studies and the Pfizer longitudinal knee MRI dataset to evaluate the finite sample performance of GHMM in the quantification of longitudinal cartilage morphology changes. Our results indicate that GHMM significantly outperforms several standard analytical methods.\nIndex Terms-Diseased regions detection, EM algorithm, Gaussian hidden Markov model, longitudinal cartilage thickness, pseudo-likelihood method."}, {"section_title": "I. INTRODUCTION", "text": "O STEOARTHRITIS (OA) known as degenerative arthritis represents a group of mechanical abnormalities involving degradation of joints, including articular cartilage and subchondral bone. Symptoms include swelling, pain, discomfort, locking, and other problems in mobility and are often characterized by the progressive loss of joint cartilage [1] . Bone may be exposed and damaged without the protection of cartilage. Fig. 1 shows the anatomy of the human knee and illustrates the cartilage loss. OA is the most common form of arthritis and a major cause of chronic disability in the United States [2] . It is estimated that more than 16% of all adults 45 years or older suffer from symptomatic OA of the knee [1] . Cartilage loss [3] is believed to be the dominating factor in OA. Studying cartilage morphological changes can help to understand OA progression and drug development.\nIn recent years, magnetic resonance imaging (MRI) has increasingly been used in OA diagnosis [4] , [5] , since MRI offers the distinct advantage of detecting signal and morphologic changes in articular cartilage in 3D. MRI is the most sensitive and accurate test for evaluating the articular cartilage noninvasively [6] . Particularly, MRI can demonstrate reactive bone edema or soft tissue swelling as well as small cartilage or bone fragments in the joint. However, little is known about the development of such cartilage lesions and their natural progression.\nRecently, several large MRI databases have been acquired for OA research in order to help understand the progression of cartilage loss across OA subjects and to identify risk factors (such as genetics, dietary intake, and muscle weakness) associated with such loss [7] - [10] . For example, the Pfizer A9001140 is a longitudinal study, including baseline, 3-month, 6-month, 1-year and 2-year follow-up images of a single knee from 155 subjects [7] , [8] ; the Osteoarthritis Initiative (OAI) is another longitudinal cohort study of risk factors for incidence and progression of OA, where 4796 subjects with or at high risk of knee OA were recruited and image data was collected annually during 4 years of follow-up [9] , [10] . Moreover, analyzing such large MRI datasets is necessary to establish knowledge about the expected pace of progression in knees with different exposure to risk factors for structural progression (e.g., radiographic joint space narrowing [JSN]). Such knowledge can then be used for the design of interventional trials.\nStatistical analysis of cartilage thickness changes faces two major challenges. The first one is the lack of spatial correspondence across subjects and/or time. Observational studies have shown that cartilage loss in OA may not be uniform throughout the cartilage [11] , and advanced statistical analysis methods are necessary to understand localized cartilage thinning. However, the localized analysis requires establishing spatial correspondence across time and subjects, and such analysis is challenging due to the small volume of cartilage in relation to the rest of the knee. The second challenge is the spatial heterogeneity of cartilage progression across subjects. Cartilage thinning may happen at different locations in different subjects, which is usually caused by biomechanical factors [12] or local risk factors [13] . Cartilage thinning at a particular location may only be consistent for a subset of the full subject population. Thus, treating all OA subjects equally and using all of them for standard statistical methods (such as voxel-wise analysis and region-of-interest analysis) would be problematic. In clinical practice, some non-surgical treatments for OA in the knee (e.g., corticosteroid injections) are most likely administered via injection and act globally [14] since the exact locations of lesions are unknown. Therefore, it is of great interest to propose some methods to detect such locations and refine these treatments.\nSubregion-based analysis and the ordered value approach are two major statistical methods for quantifying cartilage thickness changes. Subregion-based analysis is one of the most popular approaches. Here, average thickness changes in defined anatomic subregions of the femorotibial joint are studied. In [15] , the tibial cartilage was divided into a central area of the total subchondral bone area, and anterior, posterior, internal, and external subregions surrounding it. However, this approach is problematic due to the spatial heterogeneity of cartilage progression discussed above. In another region-wise statistical analysis method [16] , a region partitioning process is performed by using a supervised machine learning framework on anatomically aligned medial tibial and medial femoral cartilage thickness maps, and then a point distribution model is used to establish spatial correspondence and a common coordinate system. However, their machine learning procedures are only implemented on the thickness maps at baseline. Buck et al. [17] proposed an ordered value approach by sorting subregional changes within each knee by ascending order to focus on the magnitude of the thickness irregardless of the location, in which subregion the change occurs in each subject. The ordered value approach was demonstrated to provide improved discrimination between healthy subjects and OA participants longitudinally [17] . The key advantage of the ordered value approach is to remove the link between the spatial location and the magnitude/direction of the change in cartilage thickness. But the ordered value approach still relies on subdivisions of the cartilage and the average thickness within each subregion. The subdivisions of the cartilage are purely geometric, and small local changes (that happen to a smaller region than the size of a subregion) can be difficult to recover, since they may be weakened by averaging over a large subregion. Therefore, to fully understand the spatial pattern of OA progression, it is necessary to pinpoint localized cartilage thickness changes.\nThe paper is organized as follows. Section II summaries the image preprocessing pipeline and the key contributions in this paper. Section III introduces a novel Gaussian hidden Markov model (GHMM) and its related EM algorithm. In Section IV, simulation studies are performed to show the advantages of our proposed model in diseased regions detection. Section V applies GHMM to the 2D thickness maps derived from the 3D MRI data of the Pfizer Longitudinal Study (PLS-A9001140)."}, {"section_title": "II. IMAGE PREPROCESSING AND MAIN CONTRIBUTIONS", "text": "In this paper, the 3D knee MR images are preprocessed via a set of four image analysis steps including (I.1) segmentation, (I.2) 3D thickness map computation, (I.3) registration, and (I.4) thickness map projection. These four methods summarized in Fig. 2 can successfully establish spatial correspondence across subjects and/or time and therefore address the first challenge in statistical analysis of cartilage thickness changes.\nThe main contributions of this paper include (i) a statistical method based on GHMM to appropriately address the spatial heterogeneity of cartilage progression across OA subjects and quantify their longitudinal cartilage morphology changes and (ii) a systematic evaluation of our analysis method by using simulations and real data analysis. Moreover, we have developed companion software for GHMM and will release it to the public through http://www.nitrc.org/ and http://www.bios.unc.edu/research/bias.\nThe path diagrams of GHMM are presented in Fig. 3 . Specifically, a novel hidden Markov random field (HMRF) [18] - [27] is proposed to specifically discover the diseased regions for each extracting the joint region and obtaining the cartilage segmentation; computing the 3D cartilage thickness map; registering all thickness maps to a common atlas space; and projecting 3D thickness map onto a 2D plane. . The change of the map thickness at pixel site includes three parts in the proposed model, i.e., (i) the common dynamic change in both normal controls and OA subjects, (ii) the change caused by random effects and measurement errors, and (iii) the change caused by different diseased regions (moderately diseased region (yellow) and severely diseased region (red)). (b) Path diagram of GHMM for one subject at two neighboring pixel sites across time. Following the convention of path diagrams, observed variables are framed with rectangles whereas latent variables are framed with ellipses. Regression associations are depicted as (solid) one-headed arrows (parent=predictor, child=response); correlations between diagnosis result, the diseased region label and the observed thickness are described as (dotted-dashed) one-headed arrows; and the correlation of diseased region labels in the Potts model is shown as (solid) double-headed arrow. For easier interpretation, the following color-codes are used: exogenous variables (light red), endogenous variables (purple), continuous latent variables (blue), discrete latent variables (green), and measurement errors (yellow).\nOA subject and to integrate cartilage progression in different diseased regions with different change magnitudes/directions across OA subjects. Moreover, based on the correspondence established in the preprocessing step, our GHMM allows us to carry out a localized analysis of longitudinal cartilage thickness at each voxel. Therefore, GHMM integrates the strengths of both the local subregion-based analysis and the ordered value approach in a single framework."}, {"section_title": "III. BACKGROUND AND METHODS", "text": ""}, {"section_title": "A. Cartilage Segmentation", "text": "Cartilage segmentation in the knee has been investigated for several decades. Many segmentation approaches have been proposed, e.g., region growing methods [28] , [29] , watershed methods [30] , live wire methods [31] , active contour methods [32] , [33] , and graph cut methods [34] . However, all the aforementioned methods are semi-automatic, which precludes their applications to large image databases. Recently, several automatic methods have been proposed for cartilage segmentation, including pattern recognition methods [35] , model-based segmentation method [36] , and graph-based method [37] . However, the spatial interactions between neighboring pixels are neglected in [35] ; the model-based segmentation method [36] is prone to local minima in the fitting process; the graph-based method [37] generally suffers from grid bias, also known as metrication errors.\nHere we applied the automatic cartilage segmentation method [38] , which is an extension of the multi-atlas segmentation approach initially proposed by us for cartilage segmentation in [39] . The main difference in these two cartilage segmentation approaches is how label-fusion is achieved once multiple segmentation candidates (from the multiple atlases) are available. In [39] , a simple locally weighted label-fusion strategy was used, whereas in [38] the locally weighted label-fusion was compared to the baseline majority-voting approach and a more advanced non-local patch-based label fusion approach was also investigated. The latter approach turned out to be superior to the other two label-fusion strategies. In general, the segmentation method [38] has the following advantages. First, the method is fully automatic and requires no user interaction (besides quality control). Secondly, the method is robust as it benefits from multi-atlas-based strategies. Thirdly, both spatial and local appearance information are utilized in the segmentation. Local tissue classification is probabilistic (unlike [35] ) and combined with the spatial prior to generate the final segmentation within a segmentation model. Furthermore, the segmentation model is convex and thus allows for the computation of global optimal solutions which cannot be guaranteed by active contour models, active shape models or active appearance models. The segmentation model also allows for the incorporation of spatial and temporal regularization.\nThe approach that we use for segmenting cartilage and to compute local thicknesses works in a three-dimensional (3D) space. Specifically, our segmentation produces a 3D label map for femoral and tibial cartilage. Given a segmentation, we compute thickness using a Laplace-equation approach [40] through which we define a top and a bottom of the structure and correspondence lines between them. Each point on such a correspondence line is then assigned the thickness value (distance between beginning and end of this line) resulting in a 3D distance map. It should be noted that, all the segmentations are performed for each subject independently and in their own untransformed coordinate systems to avoid any bias introduced by resampling the image. For the same reason, the thickness maps are computed in the native image spaces obtained from cartilage segmentations.\nOnce these measures have been computed, population comparisons require a common coordinate system for the statistical analysis across time-points and subjects, which requires an additional registration step to this common space. Note that this may cause slight local distortions (depending on the quality of the registration), but it will not change the actual thickness measures as they are computed in the native image spaces. Here, we have used an affine transformation followed by a B-Spline transform based on the bone segmentations for each cartilage thickness volume. Since we are dealing with sheet-like structures, which we have approximately axis-aligned in atlas space, we simply compute the local median values of this 3D thickness map in the axial directions, where thicknesses are approximately constant."}, {"section_title": "B. Gaussian Hidden Markov Model", "text": "We consider a longitudinal thickness map dataset with thickness data measured at time for and , where is the total number of subjects, is the set of pixels in a common template, denoted by , and is the total number of time points for the -th subject. Let represent disease status of OA for each subject such that and 1, respectively, represent normal control and patient with OA.\nWe introduce a latent partition of for each subject. Specifically, it is assumed that for the th subject, can be decomposed into the union of normal region , moderately diseased region , and severely diseased region , that is\nHere we also assume that normal controls are expected to be perfectly healthy, i.e., to not have any cartilage loss or lesions. Then, both and should be the empty set for normal controls. For OA patients, the size and location of and may vary across subjects and play a critical role in establishing spatial correspondences of diseased regions at different locations across subjects. Statistically, we introduce an unobserved random effect to label , , and at each pixel of for the th subject. Thus, s are label configurations of three nonoverlapping regions . It is also possible to extend GHMM to the scenarios with more than two types of diseased regions.\nOur Gaussian hidden Markov model consists of a spatial random effect model and a Potts model [20] , [21] , [23] . Spatial random effects models (SREM), also called hidden Markov models, are very useful for image segmentation and restoration in image analysis [18] , [19] , [22] , [24] - [27] .\nWe first propose SREM to model the conditional distribution of the observed thickness maps given two sets of random effects including and , where will be defined below. We present the path diagrams of SREM in Fig. 3 . Given and , we propose a general spatial random effect model as (1) where is a 1 vector of covariates (e.g., time, gender, or genetic marker) that usually includes an intercept 1, but is independent of disease status. Moreover, and are both vectors of regression coefficients. It should be noted that, if only comprises an intercept 1 and time, represents both the average thickness at baseline and average thickness change rate at time point , while the two components in indicate the individual thickness difference relative to the average thickness at baseline and the individual difference of the thickness change rate relative to the average thickness change rate at time point respectively. The is defined as , , where is the Kronecker function and is a 1 vector of coefficients, in which and respectively characterizes the dynamic thickness differences in the diseased regions and in addition to the dynamic thickness changes at pixel in normal regions. Thus, equals zero for all pixels for normal controls and the pixels with for OA patients. For OA patients, pixels in different diseased regions may have different dynamic thickness changes. Throughout the paper, we assume , and set for simplicity. Generally, the time measurement in the first two terms of model (1) is not required to be the same as the one in the last item of model (1). In principle, age is used as in the first two terms of (1) to capture the average thickness changes across age, whereas time to diagnosis is used in the last term of (1) to character the relative thickness changes in the diseased regions caused by OA. However, neither the age nor time to diagnosis are available in this dataset. Instead, the scan date is the only time measurement in this dataset. Since the range of thickness changes is small compared to the thickness at baseline and the time range (2 years) is also small relative to the age of each subject (all subjects are middle aged [41] ), it is reasonable to use the scan date as throughout the model (1). In this paper, for each subject, the fist scan date was set to 0 and the following scan dates were calculated in years, e.g., 0.5 means six months. Therefore, it is straightforward to consider some basis functions (such as spline or wavelet) for . Moreover, s are independent measurement errors across subjects, time, and pixels, following . Second, we model the random effects and as follows. First, it is assumed that and are mutually independent. Moreover, are assumed to be mutually independent across pixels and follows at pixel . It is assumed that s are independent across subjects and each follows a Potts model [20] , [21] , [23] , whose Gibbs form is given by (2) where and is introduced to encourage spatial smoothness in homogeneous regions. Moreover, is the partition function such that is a probability function. The notation \" \" means that is a neighbor of and each neighboring pair enters the summation only once. Throughout the paper, we only consider the closest 4 neighbors of each pixel.\nTo illustrate the key ideas of GHMM, we present two path-diagrams of GHMM in Fig. 3(a) and (b) . Model (1) has two key novelties compared with the subregion-based analysis and the ordered value approach. As shown in the subcomponents (i) and (ii) of Fig. 3(a) , the first novelty is that allows us to utilize information in all normal regions across all normal subjects and OA patients and then carry out a localized (or pixel-wise) analysis of longitudinal cartilage thickness at each pixel. As shown in the subcomponent (iii) of Fig. 3(a) , the second novelty is that the use of and allows us to integrate information in all diseased regions across all subjects together and then carry out a joint analysis in the union of all moderately diseased regions (or all severely diseased regions ) across all OA patients."}, {"section_title": "C. Estimation Procedure", "text": "Our next problem of interest is to estimate all unknown parameters, denoted as , and random effects. Here is a vector of all unknown parameters consisting of , and the covariance matrices for . We decompose the parameter into two parts: , and all others, denoted as . The maximum likelihood estimate (MLE) of can be calculated by using the expectation-maximization (EM) algorithm [42] , whereas can be estimated by using a pseudo-likelihood method [43] since the MLE of is generally difficult to compute due to the normalizing part of the probability function in (2) .\nTo derive the EM algorithm, we need the complete-data log-likelihood function of GHMM as follows. Let , ,\n, where is identity matrix. Thus, the distribution of conditional on random effects is given by , where is given by Thus, the complete-data loglikelihood function is given by (3) where denotes the number of OA patients. Given the current estimate at iteration , the value is obtained via maximizing the following -function with respect to :\nWe consider the E-step and M-step of the EM algorithm as follows."}, {"section_title": "1) E-Step:", "text": "In the E-step, we need to calculate four conditional expectations: , , , and . In order to calculate these conditional probabilities, the class labels should be estimated first. Here we consider the maximum a posteriori on Markov random field (MRF-MAP) estimation, which is efficient and adopted in many existing papers, e.g., [23] , [44] , [45] . First, the conditional probability density function of given and is derived as (5) where and .\nAccording to the MAP criterion, is defined as\nTo obtain the optimal solution to (6), in this paper, we adopt the iterated conditional modes (ICM) algorithm [20] , which uses a greedy iterative strategy for minimization. Convergence is achieved after only a few iterations. As a result, the conditional expectation can be calculated as (7) where (8) Here is the set of sites neighboring . Given and , is normally distributed as Then, given , and , we have Finally, the desired expectations can be estimated as (9) 2) M-Step: Taking derivatives of (4) with respect to and equating them to zeros, we find the updates of as follows. For and , we have (10) and (11) For the covariance matrix , we have\nFor in , . Diseased region detection for subjects from three groups: (a) subject with 5 time points in group 1; (b) subject with 3 time points in group 2; (c) subject with 4 time point in group 3. This is the simulated result and hence we have an imposed ground truth, which is shown in Fig. 4 . In each group, the image with green background indicates the detection result, i.e., normal region (blue); moderately diseased region (light blue); severely diseased region (orange), the remaining ones are the observations for the time points, where the color bar for all the observations is presented on the right side of the fist raw in (a)-(c).\nSince in model (2) is not the primary parameter of interest, we use an approximate, but computationally efficient method based on a pseudo-likelihood function. A key advantage of using the pseudo-likelihood function is its computational simplicity, since it does not involve the intractable partition function. The pseudo-likelihood at the -th step is a simple product of the conditional likelihood (14) where denotes the set of points at the boundaries of , and is given by Thus, the MPL estimate can be obtained by solving\nThe E-step and M-step are repeated until the difference between and is smaller than a desired value (e.g., )."}, {"section_title": "D. Inference Procedure", "text": "After all the parameters are estimated, we carry out formal statistical inference consisting of three different statistical tools below. First, we calculate the standard errors of computed MLEs, , at each voxel and in the moderately and severely diseased regions. As captures the information in all normal regions across all normal subjects and OA patients, we calculate the standard errors of via pixel-wise analysis of longitudinal cartilage thickness on all subjects with , in which model (1) is simplified as follows: (16) Thus, the estimated covariance matrix of can be approximated by (17) where is the number of subjects with at voxel . Then the standard errors can be estimated by the positive square root of the diagonal elements in (17) .\nOn the other hand, the standard error of is estimated based on data in the voxels of all diseased regions in all OA patients, since captures the information in all diseased regions across all subjects together. Since the information of these diseased regions has to be estimated from the data, the standard errors associated with are the standard errors conditional on the given diseased regions across subjects. Moreover, the pixel-wise analysis is not suitable here, and thus it is impossible to obtain explicit expressions of the estimated standard errors. In order to tackle this problem, a resampling approach, wild bootstrap [46] , is considered here. The idea of wild bootstrap is to leave the regressors at their sample value, but to resample the response variable based on the residuals values. This method proceeds as follows:\n1) Fit the model with the original data and retain the fitted values and the residuals for and ; 2) Create synthetic response variables , where is a random variable following standard normal distribution; 3) Refit the model using the synthetic response variables and retain the estimates ; 4) Repeat Steps 1 and 2 independently B times to give B independent realizations of , denoted by ; 5) The bootstrap covariance matrix of is estimated by (18) where for , 2. The standard error of can be estimated by the positive square root of the diagonal element of (18) . It has been shown that 50 to 100 bootstrap replications ( in this paper) are generally sufficient for standard error estimation [47] .\nSecond, several hypothesis testing problems are quite interesting in real applications. Specifically, we are interested in testing (i) whether there is any cartilage progression across time at each pixel site in normal regions; (ii) whether there is any difference of cartilage thickness at baseline between normal regions and moderately (or severely) diseased regions; and (iii) whether there is any difference of cartilage progression across (23) where is the component of , 2. A sequence of tests can be used here. The standard errors of estimates , and , 2 can be obtained as described above. The false discovery rate (FDR) adjustment method [48] is employed here to calculate the adjusted -values corrected for the multiple comparison problem (19) .\nThird, after obtaining the diseased region labels across all pixel sites for each OA subject, we calculate the empirical probabilities of both the moderately diseased region and severely diseased region at each pixel across all OA subjects. The related formula is listed below: (24) where denotes the number of the elements in set ."}, {"section_title": "IV. SIMULATION STUDIES", "text": "We examine the finite sample performance of GHMM for diseased region detection. We first fitted the model (1) to the femoral cartilage thickness data of all the normal controls derived from the 3D MRI data of the Pfizer Longitudinal Study (PLS-A9001140) and then we used the obtained parameter estimators of , and as their true values for simulations. Moreover, and were set "}, {"section_title": "and", "text": ", respectively. The covariate vector for each subject was generated according to the real data set analyzed in Section V. We generated 20 subjects from 3 groups of OA patients with 7 patients in group 1, 7 patients in group 2, and 6 patients in group 3. Without loss of generality, the location of all diseased regions is predetermined and does not vary for subjects in the same group, whereas it varies across groups. Fig. 4 presents different lesions that were manually designed and inserted into the thickness maps and the diseased regions associated with the three simulated groups.\nWe applied GHMM to detect the diseased regions in each subject. We randomly selected one subject from each group and presented its detection results in Fig. 5 . For all selected subjects, the diseased regions can be successfully detected with few misclassifications in the results. To show the average detection performance among subjects in each group, the Jaccard index [49] , Dice index [50] , Rand index [51] , and adjusted Rand index [52] were calculated to compare the detection results with the truth. Finally, we calculated the averages of all index values taken over all subjects in each subgroup. For all these indices, a higher index value indicates a more accurate detection result. Simulation results based on all the three groups are presented in Table I , where the related standard deviations are also shown in parentheses. For all these groups, the average of the four index values are all larger than 86 percent, and the related standard deviations are all less than 0.05. Fig. 5 and Table I indicate that GHMM performs very well in diseased region detection of cartilage MRI data."}, {"section_title": "V. REAL DATA ANALYSIS", "text": "We consider the MRI dataset from the Pfizer longitudinal non-treatment study on osteoarthritis (PLS-A9001140). This dataset contains T1-weighted (3D SPGR) images from 155 subjects imaged at baseline, 3, 6, 12, and 24 months at a resolution of 1.00 0.31 0. 31 . All the subjects are females. Some of them have missing scans and thus we have 706 MRIs in total. The Kellgren-Lawrence grades (KLG) 1 [53] were determined for all subjects from the baseline extended weight-bearing radiographs, classifying 81 subjects as normal control (KLG0), 1 subject as KLG1 (mild OA), 40 subjects as KLG2 (severe OA), and 33 subjects as KLG3 (severe OA). It seems that most of the OA patients in this dataset were selected to have predominantly medial OA.\nWe first computed the cartilage segmentations in the knee MRI data. We randomly chose two subjects with different KLG from the dataset, and presented the related 2D thickness maps for the chosen subjects at baseline in Fig. 6 .\nAfter extraction of the 2D thickness maps, we first applied the linear mixed model for voxel-based analysis to the thickness maps from the whole dataset and calculated the parameter estimation at each pixel site. The model is described as below (25) where , , and are all defined the same as those in (1). Compared with GHMM, the reduced model (25) cannot handle the spatial heterogeneity of cartilage progression across subjects, and thus it can only capture the diseased regions at population level instead of individual level. The estimates of across all the pixels in both femoral and tibial cartilages are presented in Fig. 7(a) and (d) . We carried out a sequence of tests on the hypotheses versus across all pixels to identify the regions with substantial differences between OA patients and normal controls. Fig. 7(b) and (e) present the FDR adjusted -value [48] at each pixel in both femoral and tibial cartilages. Based on the testing results, we are able to detect some significant subregions in the cartilage. Furthermore, for better visualization, we used the K-means clustering method [54] to cluster voxels into several sub-regions based on the FDR adjusted -map. We chose clustering -values, since the -value indicates the statistical significance of the effect sizes. The clustering results are also presented in Fig. 7(c) and (f), where four subregions are discovered for both femoral and tibial cartilage. The mean values of FDR adjusted -value for all the pixel sites in each cluster are also summarized in Table II. Table II reveals that the first three clusters are diseased regions, whereas the fourth one is a normal region. Such results are averages across all the subjects. Since the cartilage thinning happens at different locations for different subjects, the voxel-based analysis based on model (25) fails to capture the diseased regions for individual OA subjects.\n1 According to the definition of KLG [53] , the radiographic score is from 0-4, where KLG0 is healthy, KLG1 is considered borderline or mild OA, and KLG2-KLG4 are severe OA. -values for test (19) across all pixel sites in femoral cartilage; and (j) FDR adjusted -values for test (19) across all pixel sites in tibial cartilage.\nAs a comparison, we applied GHMM to the whole dataset. As an illustration, the estimates of across all the pixels in both femoral and tibial cartilages and their standard errors obtained via wild bootstrap are presented in Fig. 8(a)-(h) . From  Fig. 8(c)-(d) and (g)-(h) , coefficients of most pixels show the range of cartilage thickness changes in normal regions similar to those in [17] . However, coefficients of some pixels show progression in normal regions. One of the reasons for these progressions may be that some regions may undergo tissue swelling, diluting, or even masking cartilage loss in adjacent pixels [15] . The FDR adjusted -value for test (19) at each pixel is calculated in Fig. 8(i) and (j) . The inference results of , including estimation, standard error and -value for tests (20) - (23), are presented in Table III as well. Fig. 8 and Table III reveal that (i) there is significant cartilage progression across time on only a few pixel sites in normal regions; (ii) the difference of cartilage progression across time between normal regions and moderately (or severely) diseased regions is highly significant with respect to their cartilage thickness at baseline; and (iii) both the difference of cartilage thickness at baseline and difference of cartilage progression across time between normal regions and severely diseased regions are larger than those between normal regions and moderately diseased regions. Then we chose two pixel sites from the femoral and tibial cartilages, respectively, and presented them in Fig. 9(a) . Fig. 9(b)-(g) show the dynamic changes of cartilage thickness at two given pixel sites across time. We also included both the estimated curves and thickness changes of some chosen subjects. The estimated cartilage thicknesses at both two pixel sites follow a trend of decline across time for OA patients. Moreover, the estimated cartilage thickness in severely diseased regions decreases more quickly than that in moderately diseased regions. We randomly selected 3 subjects with different KLGs, i.e., 1 KLG1 subject, 1 KLG2 subject, and 1 KLG3 subject, and presented their diseased regions in Fig. 10. Fig. 11 presents the empirical probabilities of both moderately diseased region and severely diseased region. The locations of diseased regions change across subjects, and the detected diseased regions are more inclined to locate in some regions (e.g., center) of the cartilage. This indicates that the cartilage loss in OA may not be uniform throughout the cartilage, but OA may affect certain regions more frequently than others [11] .\nFurthermore, we investigate whether there are some subgroups among patients and delineate their associated diseased region pattern in each subgroup. To achieve this, we used a clustering method to cluster all estimated maps at the subject level. Since the number of informative pixels is much larger than the number of OA subjects, e.g., and\nfor tibial cartilage, we adopted a sparse k-means clustering method and its associated R package sparcl (http://www.icesi.edu.co/CRAN/web/packages/sparcl/) [55] , which combines a Lasso-type penalty with the K-means clustering method to cluster observations. We applied sparcl to the estimated maps . Two subgroups were detected for the femoral cartilage, whereas three subgroups were identified for the tibial cartilage. The KLG information of subjects in each Fig. 11 . Empirical probabilities of both moderately diseased region and severely diseased region based on estimated diseased region labels: (a) empirical probability of moderately diseased region in femoral cartilage; (b) empirical probability of severely diseased region in femoral cartilage; (c) empirical probability of moderately diseased region in tibial cartilage; and (d) empirical probability of severely diseased region in tibial cartilage. subgroup is presented in Table IV . Inspecting Table IV reveals that for the femoral cartilage case, the group membership of most patients is consistent with their KLG information. Specifically, most KLG2 subjects belong to Group 1, whereas most KLG3 subjects fall into Group 2. Similar to the procedures in voxel-based analysis, the diseased region pattern of each group in the average sense can also be calculated based on the detection results. For every group, the diseased-region detection results of two randomly chosen subjects and their related pattern are presented in Fig. A1 , which can be found in Supplementary Materials. It reveals the spatial heterogeneity of cartilage progression across OA subjects."}, {"section_title": "VI. CONCLUSION", "text": "We have developed a GHMM for longitudinal cartilage quantification in OA patients, while addressing these two issues: the lack of spatial correspondence across subjects and time and the spatial heterogeneity of cartilage progression across subjects. Our GHMM is designed to efficiently account for the spatial heterogeneity of cartilage progression across subjects. We have developed an efficient algorithm to estimate unknown parameters in the GHMM. The proposed model can effectively detect diseased regions in each OA subject and present a localized analysis of longitudinal cartilage thickness within each latent subpopulation. Our GHMM integrates the strengths of two standard statistical methods: the local subregion-based analysis and the ordered value approach. Simulation studies and real data analysis have demonstrated that GHMM can effectively detect diseased regions in localizing longitudinal cartilage thickness.\nSeveral important issues need to be addressed in our future research. First, it is assumed that the disease effect is an ordinal variable at each location and follows a Potts model. However, if the disease effect is strongly associated with the continuous loss of cartilage thickness, then it may be more reasonable to treat them as continuous variables. In this case, computational and theoretical challenges may arise. For example, we may need to introduce another hidden Markov model for continuous disease effects, and thus both the estimation and inference procedures have to be rederived. Second, we plan to apply GHMM to other knee MRI datasets, such as OAI, to investigate other clinical questions of interest. Third, it is interesting to extend GHMM to the group analysis of various neuroimaging data sets, such as the Alzheimer's Disease Neuroimaging Initiative (ADNI) database [56] . Most group analysis methods (e.g., Statistical Parametric Mapping (SPM)) assume the spatial homogeneity and spatial correspondence of effect regions across subjects, which may not be valid for many neuroimaging studies. For instance, in Alzheimer's disease (AD) studies, quantifying patterns of structural change during early stages of AD is a major challenge. Brain atrophy in the early stages of AD may be relatively subtle and spatially distributed over different brain regions, and the patterns of atrophy have been found spatially heterogeneous [57] . Moreover, the error associated with structural measurements can vary throughout the brain and across subjects and time points. In this case, our GHMM can be used to capture complex morphological characteristics that distinguish AD from normal controls, furthermore to determine which patterns are most informative from a diagnostic perspective."}]
[{"section_title": "", "text": "The virus has serious consequences as its serial interval is 5 to 7.5 days, and the rate of reproduction is 2 to 3 [1] people. The coronavirus infection can incite SARS (Severe Acute Respiratory Syndrome), which might unfold serious health impacts.\nIt is estimated that many people are healthy carriers of a virus, and they are the reason for about 5% to 10% of acute respiratory infections [2] . A critical step to fight against the COVID-19 is to identify the infected people so that they get immediate treatment and isolate them to control the multiplying of the spread of the infection.\nThe COVID-19 panic has increased due to the unavailability of fast and accurate diagnosis systems to test the infected people. According to the World Health Organization (WHO), the diagnosis of COVID-19 cases must be confirmed by molecular assay, such as the reverse transcription polymerase chain reaction (RT-PCR) pathological test using throat swab samples [3] . While RT-PCR has become a standard tool for confirmation of COVID-19, but it is a very time consuming, laborious, and manual process, and there is a limitation of availability of diagnostic kits and sample collection. The availability of COVID-19 testing kits is limited as compared to the increasing amount of infected people; hence there is a need to rely on different diagnosis methodologies.\nThe coronavirus targets the epithelial cells that affect patients respiratory tract, which can be analyzed by the radiological images of a patients lungs.\nSome early studies also show that patients present anomalies in chest x-ray images, which are the typical characteristics of COVID-19 infected patients [4, 5] .\nHence, the development of the computer-aided diagnosis system for the automatic analysis of radiological images can be very helpful in identifying infected patients at a faster rate. Some the advantage of the using X-ray images for COVID-19 screening as follows:\n\u2022 Enable fast screening and rapid triaging of patients suspected of COVID-19.\n\u2022 Making use of readily available and accessible radiological images.\n\u2022 Portable and easy to setup, these systems can be setup in the isolation room, which significantly minimizes the risk of transmission."}, {"section_title": "Recent advancements in deep learning specifically in Convolution Neural", "text": "Network (CNN) motivated us to develop a highly reliable computer-aided diagnosis (CAD) systems for the rapid detection of the COVID-19 using chest X-ray images. It will enable and enhance the automation in the screening phase, which is the crucial part of the COVID-19 pandemic. In this study, we design a new stacked convolutional neural network for automatic diagnosis of COVID-19 disease from the chest X-ray images. To train the proposed model, we generated chest X-ray images dataset, with the combination and modification of three publicly available datasets [6, 7, 8] , which we will refer to as COVID19CXr.\nThe organization of this paper as follows: Section 2 presents the related work. Section 3 describes the proposed stacked CNN model for the classification of COVID-19, Normal, and Pneumonia X-ray images. Section 4 describes the COVID19CXr dataset generation process and details the experimental results, performance comparison. Finally, the conclusion is drawn in Section 5."}, {"section_title": "RELATED WORK", "text": "Over the past 40 years, many computer-aided systems have been developed for the diagnosis of lung disease [9] and achieved promising results for automatic detecting lung abnormality from the radiological images [10, 11, 12] .\nRecently, automatic CAD of COVID-19 using radiological images has drawn a lot of attention of researchers and as a result several approaches have been introduced in literature. They have published a series of research articles [13, 14] demonstrating the CAD systems for the detection of COVID-19 using radiological images. Butt at el. [15] Similarly, Narin et al. [17] have applied ResNet50, InceptionV3 and Inception-ResNetV2 using transfer learning for classification of the X-ray images into normal and COVID-19 class. This method achieved good performance with an accuracy of 98 % with ResNet50. However, the number of X-ray images are only 100 and the number of images was very less. Wang et al. [18] have proposed an open-source COVID-Net model based on the projection-expansion-projection design pattern for COVID-19 cases detection from the X-ray images. In this study, the authors reported an accuracy of 92.6 %. Oh et al. [19] have proposed patch-based CNN approach, to train ResNet18 model using image patches that have been extracted from the chest x-ray images. For decision making, they used the majority voting strategy, which resulted in an accuracy of 88.9 %.\nAn objected detection based DarkCovidNet model has been proposed by Ozturk et al. [20] for automatic detection of COVID-19 cases from the Xray images. They have reported accuracy of 98.08 % for binary classification of X-ray images into COVID-19 and no-findings, and also this approach has achieves an accuracy of 87.02 % for multi-class classification of X-ray images into COVID-19, no-findings and pneumonia. Pereira et al. [21] have proposed a hierarchical classification approach, in which they extracted deep features by InceptionV3 and tested texture descriptors. They investigated early and late fusion techniques for combining the strength of descriptor and classifiers. Their hierarchical classification approach achieved F1-Score of 0.89 for the COVID-19 identification in the X-ray images.\nAttention-based deep 3D multiple instance learning approach has been proposed by the Han et al. [22] for automatic screening of COVID-19 from the CT images. Their algorithm achieved an accuracy of 97.9%. Wang et al. [23] developed a weakly supervised deep learning framework, in which lung region was segmented by UNet from the CT images and 3D deep neural network is applied on the segmented region for predicting probability of COVID-19 infections.\nAuthors reported an accuracy of 90.10%.\nUcar et al. [24] proposed a SqueezeNet CNN model with Bayesian optimization for diagnosis of the COVID-19 from X-ray images. They reported an accuracy of 98.26 %. Afshar et al. [25] developed a capsule network-based framework for the classification of the X-ray images into Normal, bacterial, Non-COVID, and COVID-19 cases. The authors reported an accuracy of 95.7 % and a sensitivity of 90 %. Sethy et al. [26] extracted deep features of X-ray images from the pre-trained CNN, and support vector machine (SVM) has been applied on the extracted feature to classify x-ray images. The authors achieved an accuracy of 95.38% using ResNet50 with the SVM classifier."}, {"section_title": "METHODOLOGY", "text": "The Convolution Neural Network is the driving concept of deep learning algorithms in computer vision, which led to outstanding performance in most of the pattern recognition tasks such as image classification [27, 28, 29] , object localization, segmentation and detection [30, 31, 32] . It has also shown its superiority in the medical image analysis for image classification, and segmentation problem [33, 34, 35, 36] , especially in lung-related diseases such as lung nodule detection [37] , pneumonia detection [38] , and pulmonary tuberculosis [39] . CNN automatically learns a low to the high level of useful feature representations and integrates feature extraction and classification stages in a single pipeline, which is trainable in an end-to-end manner without requiring any manual design and expert human intervention.\nIn this work, we have developed a deep learning-based stacked convolutional neural network for the rapid screening of COVID-19 patients using X-ray images.\nThe proposed COVID-19 detection method includes three modules as shown in the Figure 1 . In the first module, a new 30-layered CNN model is built and trained on the chest X-ray images from scratch, which will be referred to as CovNet30 (Covid-19 Network of 30-layers). In the second module, a pretrained VGG19 model [27] is fine-tuned on X-ray images for the diagnosis of COVID-19 disease. Finally, in the last module, five CNN's sub-models are obtained, during the training of CovNet30 and VGG19 models. The output of CNN's sub-models are stacked together by applying logistic regression [40] "}, {"section_title": "CovNet30 Architecture and Training", "text": "The CovNet30 is a task-specific, 30-layered convolutional neural network for X-ray images classification. It learns the non-linear, discriminative features directly from the chest X-ray images at multiple levels of abstraction. A detailed layer configuration of the CovNet30 network is shown in Table 1 . CovNet30 is sequential network, in which Convolutional layer with ReLU activation, pooling layer, Batch Normalization layer and dropout layer are added repetitively. Every layer of CovNet30 produce a volume of activation to the next layer through a differentiable function. Description of layers are given as follows:\n\u2022 Convolution Layer extracts features from the input volume by performing convolution operation. In the convolution operation, the dot product is computed between the kernels and connected local regions of the input volume of activation.\n\u2022 ReLU activation function is an elementwise activation function. If x is input of ReLU then it produce max(0, x) (non-negative value) in the output.\n\u2022 Pooling layer down sampling feature maps and reduces the computation in the network.\n\u2022 Batch Normalization layer speed up the learning process and improves network stability by minimizing the internal covariate shift.\n\u2022 Dropout is a regularization method, which prevents the network from the overfitting by dropping out units in the network.\nCovNet30 has been trained on the X-ray images in a supervised manner.\nCross-entropy loss function is used to calculate the training error and which is minimize using the ADAM optimizer [41] . Cross-entropy loss function is mathematical represented in equation (1).\nWhere t i and p i are the target value and predicted probability for each class i in C.\nIn the experiment, the values of hyper-parameter are set as follows: learning rate to 0.001, the batch size to 16, and dropout probability to 0.15. we experimentally find that these are the best suitable values of hyper-parameters for network training."}, {"section_title": "Fine-Tuning of VGG19", "text": "The VGG19 is a pre-trained network that is trained on the ImageNet dataset, which achieved state-of-the-art performance on ILSVRC Challenge 2014. It also achieves outstanding performance on the other image recognition datasets.\nHence, we have also used VGG19 along with CovNet30 for generating submodels.\nTo fine-tune the VGG19 on X-ray images, the top layers (Fully-connected layer, and Softmax layer) of the VGG19 network are removed. We added new layers such as two Convolutional layers with ReLU activation, a Global Average\nPooling layer, a Fully-connected layer, and a Softmax layer, at the top of the VGG19 network. Hyper parameters for the fine-tuning of VGG19 are same as the CovNet30."}, {"section_title": "Stacked Convolutional Neural network", "text": "Stacked generalization [42] is an ensemble approach in which a new model learns how to incorporate the best predictions of multiple existing models. The proposed approach hypothesized that different CNN's sub-models learn nonlinear discriminative features and semantic image representation from the images at different levels. Thus a stacked ensemble CNN model will be generalized and highly accurate. This section describes the proposed stacked convolutional neural network.\nThe pseudo-code of sub-models generation process is given in Algorithm 1. The hypothesis representation of logistic regression model is as shown below:\nWhere H i \u03b8 (x) is estimated probability p(y = i/x; \u03b8) for each class i (where i \u2208 {0 : COV ID \u2212 19, 1 : N ormal, 2 : P neumonia}) of a image x.\nNext, we train a logistic regression model H i \u03b8 (x) using a one-vs-rest scheme [43] for each class i. For its training, we prepared dataset by providing X-ray images from the validation set to each of the sub-models and collects predictions.\nIn this case, every sub-model j predicts three probabilities (P 1 ji , P 2 ji , P 3 ji )\nfor each X-ray image i of that a given image i belongs to each of the COVID-19, Normal, and Pneumonia classes. Let's say M X-ray images in the validation set, and we concatenate the output probabilities of these five sub-models that become our feature vector P M \u00d715 for the training of the logistic regression model.\nAfter training of the stacked model, on new input image x from the test set, to make a prediction, pick the class i that maximizes max i (H i \u03b8 (x))."}, {"section_title": "EXPERIMENTS", "text": "This section presents the details of the dataset, evaluation metrics, experiments results and performance comparison."}, {"section_title": "Covid19CXr Dataset Generation", "text": "In order to train and evaluate the performance of the proposed model, we generated X-ray images dataset, with the combination and modification of three publicly available datasets [6, 7, 8] , which are referred as COVID19CXr. The [6] and 2) \"COVID-19 Image Data Collection\" [7] . Pneumonia and Normal cases images are included from the \"Mendeley data 2\" [8] . Figure 2 shows the sample chest X-ray images of COVID-19, Normal and Pneumonia classes from the COVID19CXr dataset.\nFor the performance assessment of the proposed method, we have used 5fold cross-validation approach, in which the dataset is divided into 5-folds at the patient level. Table 2 gives details of the distribution of images in the training set, validation set, and test set corresponding to each fold. The training set and validation set are used while training the network, and an hold-out test set is used for the performance assessment of the proposed model."}, {"section_title": "Evaluation Metrics", "text": "To assess the performance of proposed method we have used sensitivity, \nSpecif icity = T N (T N + F P ) (8)\nWhere true positive (TP), true negative (TN), false positive (FP), and false negative (FN) are the parameters of confusion matrix. The present study deals with a multi-class problem; therefore, to get the overall metric score of the method, we calculated the mean of each metric."}, {"section_title": "Results and discussion", "text": "In order to evaluate the performance of our proposed stacked convolutional neural network, we conduct a set of experiments. In the first experiment, data augmentation techniques such as flip, rotation, shear, zoom, and shift have been applied on a training set. Thereafter, the augmented training set is utilized for the training of CovNet30 model and fine-tuning VGG19 model. In the second experiment, the stacked CNN model is trained on the validation set.\nFinally, evaluation results are produced on the test set. We repeat the same \"Err \u00b1 CI\": classification error (Err) with 95% confidence interval (CI).\n\"AUC \u00b1 CI\": area under the curve (AUC) with 95% confidence interval (CI).\nset of experiments five times for each fold. The following sections represent the experimental results and performance comparison.\n4.3.1. Discrimination power of stacked CNN model: Table 3 presents the diagnostic performance of stacked CNN and it shows good discrimination ability for the diagnosis of the COVID-19 from the chest\n(e) Fold5 dition, the confidence interval for the classification error and AUC is calculated at the 95% confidence level. As shown in Table 3 the classification error of the proposed model is 7.26% \u00b1 2.16% at the 95% confidence level. In terms of sensitivity, specificity, and PPV, proposed model also shows sig- Table 6 . It can be observed from Table 6 that for the multiclass classification task, the proposed approach shows the superiority over the methods in [18, 19, 20, 21] , except the method in [24] , which has higher accuracy."}, {"section_title": "Performance comparison:", "text": "However, sensitivity is higher for our approach.\nSome of the salient features of stacked CNN can be summarized as: \u2022 The proposed method is based on the stacked generalization of CNN's sub-models, which minimizes the variance of predictions and reduces generalization error. As of the result, stacked CNN yields high diagnosis accuracy in the X-ray images.\n\u2022 The proposed stacked CNN model produces very less false positive (type 1) and false negative (type 2) error, which confirms that the stacked CNN is reliable for clinical uses.\n\u2022 The proposed model is developed based on a less complex network, which computationally efficient and shows its stability on a small dataset."}, {"section_title": "CONCLUSION", "text": "In this paper, we introduced a new stacked convolutional neural network for the automatic diagnosis of the COVID19 from the Chest X-ray images. In the proposed method, CNN's sub-models have obtained from our developed "}]
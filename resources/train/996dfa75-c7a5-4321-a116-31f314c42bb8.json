[{"section_title": "Abstract", "text": "Whole brain segmentation (with comprehensive cortical and subcortical labels) and cortical surface reconstruction are two essential techniques for investigating the human brain. The two tasks are typically conducted independently, however, which leads to spatial inconsistencies and hinders further integrated cortical analyses. To obtain self-consistent whole brain segmentations and surfaces, FreeSurfer segregates the subcortical and cortical segmentations before and after the cortical surface reconstruction. However, this \"segmentation to surface to parcellation\" strategy has shown limitations in various situations. In this work, we propose a novel \"multi-atlas segmentation to surface\" method called Multi-atlas CRUISE (MaCRUISE), which achieves self-consistent whole brain segmentations and cortical surfaces by combining multi-atlas segmentation with the cortical reconstruction method CRUISE. To our knowledge, this is the first work that achieves the reliability of state-of-the-art multi-atlas segmentation and labeling methods together with accurate and consistent cortical surface reconstruction. Compared with previous methods, MaCRUISE has three features: (1) MaCRUISE obtains 132 cortical/subcortical labels simultaneously from a single multi-atlas segmentation before reconstructing volume consistent surfaces; (2) Fuzzy tissue memberships are combined with multi-atlas segmentations to address partial volume effects; (3) MaCRUISE reconstructs topologically consistent cortical surfaces by using the sulci locations from multi-atlas segmentation. Two data sets, one consisting of five subjects with expertly traced landmarks and the other consisting of 100 volumes from elderly subjects are used for validation. Compared with CRUISE, MaCRUISE achieves self-consistent whole brain segmentation and cortical reconstruction without compromising on surface accuracy. MaCRUISE is comparably accurate to FreeSurfer while achieving greater robustness across an elderly population."}, {"section_title": "INTRODUCTION", "text": "Accurate whole brain segmentation and cortical reconstruction for magnetic resonance imaging (MRI) play an essential role in clinical investigation and neurology research. Morphometric measurements, such as volume size, shape variation, cortical thickness, and surface area are obtained from these techniques. Typically, the whole brain segmentations that contain comprehensive cortical and subcortical labels are conducted by state-of-the-art multi-atlas segmentation methods [1] [2] [3] while the cortical surfaces are reconstructed by popular tools such as FreeSurfer [4] and CRUISE [5] . Since the steps are conducted independently, the volume segmentations and cortical surfaces may be inconsistent, which prevents integrated analyses. FreeSurfer is a very well-known method for whole brain segmentation and cortical reconstruction. FreeSurfer first automatically labels whole brain as gray matter (GM), white matter (WM), cerebrospinal fluid (CSF) and subcortical regions by combining the Markov random field (MRF) and probabilistic atlases into a Bayesian framework [6, 7] . Then, an outer (or pial) surface is reconstructed based on the GM/CSF boundaries while an inner surface is reconstructed based on the GM/WM interface [4] . Finally, the cortical GM regions are labeled based on a surface parcellation which forces the cortical segmentations to be consistent with the surfaces [8, 9] . However, since the latter steps strongly rely on the previous steps in this \"segmentation to surface reconstruction to parcellation\" strategy, the cortical parcellation fails when the surfaces are reconstructed incorrectly. As a result, a manual inspection and correction step is typically necessary. In this paper, we propose a novel \"multi-atlas segmentation to surface\" method called Multi-atlas Cortical Reconstruction Using Implicit Surface Evolution (MaCRUISE) which simultaneously obtains 132 cortical/subcortical labels from a single multi-atlas segmentation and then achieves volume consistent and robust cortical surfaces based on the same segmentation. Specifically, MaCRUISE achieves robust and self-consistent whole brain segmentations and cortical surfaces by combining the state-of-the-art Non-local Spatial Staple (NLSS) multi-atlas framework [1] with the well validated surface reconstruction method CRUISE [5, 10] . Because of bias in the manual segmentation protocol and errors caused by the partial volume effect (PVE), direct NLSS surface reconstruction and independent application of CRUISE after NLSS do not yield a consistent segmentation and labeling. However, our new approach shows that incorporation of both NLSS and CRUISE together (as MaCRUISE) yields an accurate and consistent result. Figure 1 shows one example of NLSS multi-atlas segmentation and the inaccurate surfaces from directly combining NLSS with CRUISE (NLSS+CRUISE). In the right hand panel of Figure 1D , the inner and outer surfaces from NLSS+CRUISE (solid lines) are inaccurate; however, these are improved by the proposed MaCRUISE method (dashed lines)."}, {"section_title": "METHODS", "text": "MaCRUISE consists of five major steps as shown in Figure 2: (1) one of 133 labels is assigned to every voxel by stateof-the-art multi-atlas segmentation method; (2) The fuzzy membership of GM, WM, and CSF for each voxel are obtained by TOplogypreserving Anatomical Segmentation (TOADS) [11] ; (3) The multi-atlas segmentations and the TOADS memberships are fused together to form new robust segmentations; (4) The volume consistent cortical surfaces are reconstructed based on the new segmentations and a new speed function [5] ; (5) The consistency of segmentations and surfaces is further improved by label correction. The five steps are introduced sequentially in this section."}, {"section_title": "Multi-atlas Segmentation", "text": "In NLSS multi-atlas segmentation framework, each target image is first affinely registered [12] to the MNI305 atlas [13] . Then, atlases (manually labeled example images) are non-rigidly registered to the target image [14] and non-local weighted statistical fusion [1] is used to combine the labels from each atlas to the target image. After multi-atlas labeling, each voxel in the brain is assigned to one of the 133 labels (132 brain regions and 1 background) by the BrainCOLOR protocol [15] . Then, all cortical GM labels are combined into one GM segmentation . while all WM labels and several subcortical labels (nucleus accumbens, amygdala, lateral ventricle, pallidum, putamen, thalamus, and ventral diencephalon) are combined to another WM segmentation . These subcortical labels in are selected based on their spatial relationships to WM which is similar as the \"Autofill\" procedure in CRUISE [5] . Finally, , , and the remaining subcortical labels (hippocampus, amygdala, basal forebrain and inferior lateral ventricle) are grouped together to form a cerebrum segmentation . Since the atlases are manually labeled based on the expert defined protocol in multi-atlas segmentation, objective bias occurs. To address the bias and PVE, fuzzy memberships are used by MaCRUISE. First, whole brain tissue volumes are extracted after preprocessing including field correction, skull-stripping and dura-stripping [10, 16] . Then, three memberships GM, WM, and CSF for each voxel . are obtained by a fuzzy segmentation. Finally, TOADS achieves robust memberships for the three classes ( , and ) by using topological and statistical atlases [11] ."}, {"section_title": "Combine Multi-atlas Segmentation with TOADS Memberships", "text": "In this step, the multi-atlas hard segmentations are combined with the TOADS memberships to obtain refined GM, WM and CSF memberships ( , and ) for each voxel. The combination consists of four stages.\nStage I assigns TOADS membership values within multi-atlas cerebrum segmentations.\nStage II eliminates all the memberships outside the multi-atlas cerebrum segmentations.\nThis step not only restricts outer boundaries of brain tissues by cleaning up the remaining dura and skull but also removes the cerebellum and brain stem by multi-atlas segmentations, improving the robustness of the cerebellum and brain stem removal obtained by TOADS.\nStage III fills in the WM using the multi-atlas WM segmentation, which serves as an approximation of the inner cortical volume.\nStage IV corrects the inaccurate skull-stripping for the voxels whose are extremely small within . "}, {"section_title": "Memberships from TOADS Segmentation", "text": "= 0 , = 1 and = 0 if == 1 and < 0.001 (4)"}, {"section_title": "Introduce Multi-atlas Cortical Regional Boundaries to Surface Reconstruction", "text": "To achieve volume consistent surfaces, we modify the speed function ( ) in the Anatomically Consistent Enhancement (ACE) step of CRUISE to a new form:\nwhere ( ) is the CSF fuzzy membership function and ( ) is the multi-atlas segmentation boundary function for which ( ) = 1 when is within one voxel distance from the cortical regional boundaries of the original multi-atlas segmentation; otherwise ( ) = 0 . This new speed function not only forces the reconstructed surfaces to be consistent with the multi-atlas segmentation but also detects more sulci that are not able to be detected by original ACE.\nThen, WM topology correction is conducted by the Graph-based Topology Correction Algorithm (GTCA) [17, 18] . Finally, cortical surfaces are reconstructed by a nested cortical surface reconstruction algorithm that uses the Topologypreserving geometric deformable surface model (TGDM) (which is the same strategy used by CRUISE) [19] ."}, {"section_title": "Label Correction", "text": "A label correction step is conducted to refine the whole brain multi-atlas segmentations based on the cortical surfaces. We define the distance thresholds and to correct cortical labels to WM and background. The cortical labels are corrected to WM labels when their signed distance values to inner surface's zero level set are smaller than . Meanwhile, the cortical labels are corrected to background label when their signed distance values to outer surface's zero level set are greater than . The parameter is empirically set to 0.5 mm while is empirically set to 0.5 mm. This step further forces the segmentations to be consistent with the reconstructed cortical surfaces."}, {"section_title": "RESULTS", "text": ""}, {"section_title": "Landmark Based Validation", "text": "A publically available dataset that consists of five healthy subjects (age range: 30-49) from the \"Multi-Modal MRI Reproducibility Resource\" are used in the first experiment [20] . For each subject, two raters (Rater A and B) placed 420 landmarks on both outer and inner surfaces [10] . Thus, a total of 2100 landmarks for each surface were used to evaluate the performance of NLSS+CRUISE, MaCRUISE compared with two benchmarks: CRUISE and FreeSurfer. Table 1 shows that the absolute surface errors (distance from surfaces to landmarks) of NLSS+CRUISE is much larger than FreeSurfer and CRUISE. However, the surface errors of MaCRUISE are comparable to those of both FreeSurfer and CRUISE. Table 2 statistically evaluates the differences in Table 1 by conducting paired t-tests and effect size analyses. From the p values, most differences are significant. However, since the paired t-tests are conducted on a large sample size, a small p-value might not yield a large effect. Thus, the effect size measurement based on Cohen's d value [21] is employed to evaluate the effectiveness of the differences. Comprehensively considering p values and d values, NLSS+CRUISE's surface errors are significantly larger than the FreeSurfer and CRUISE (outer surface) since its p values are smaller than 0.001 and its d values are \"medium effect\" or \"large effect\". In contrast, even if statistically significant in the paired t-test, the differences between MaCRUISE and CRUISE are \"trivial\" (d<0.1). Meanwhile, the Figure 3A shows the reconstructed inner and outer surfaces from one subject in the first experiment. It shows that FreeSurfer reconstructs accurate surfaces and that NLSS+CRUISE has the worst performance. Meanwhile, we find that the MaCRUISE surfaces are more accurate than CRUISE in the red rectangles that are not reflected by landmark analyses. More importantly, Figure 3B demonstrates that MaCRUISE provides self-consistent whole brain \"trivial\" (d<0.2) ,\"small effect\" (0.2\u2264d<0.5), \"medium effect\" (0.5\u2264d<0.8), \"large effect\" (d\u22650.8). The bold d value numbers indicates the \"medium\" or \"large\" effect. Double underline indicates the significantly systematic superior methods (p<0.001 and d\u22650.5), while the dotted underline means there are no systematic differences (p>0.05 or d<0.5) between methods. Underline indicates the significantly superior methods (p<0.001 and d\u22650.5) from at least one rater on certain surface.\nsegmentations and cortical surfaces after label correction.\nIn summary, MaCRUISE obtained significant improvements on surface accuracy as compared to NLSS+CRUISE by addressing the bias in BrainCOLOR protocol and PVE. MaCRUISE achieves self-consistent whole brain segmentations and cortical surfaces that CRUISE does not. MaCRUISE also achieves comparable accurate cortical reconstruction in comparison to the FreeSurfer benchmark."}, {"section_title": "Whole Brain Analyses", "text": "A second experiment using 100 3D MPRAGE images from Baltimore Longitudinal Study of Aging (BLSA) study [22] was conducted to evaluate the robustness of MaCRUISE, CRUISE, and FreeSurfer. The number of global failures is used as a robustness metric.\nFirst, we calculate the surface distances between MaCRUISE and the benchmarks (CRUISE and FreeSurfer) to evaluate their global performance. Notice that the surface regions that separate two hemispheres in FreeSurfer are excluded from the surface distance measurement since MaCRUISE and CRUISE do not have such surfaces. The histograms show the mean surface distances between MaCRUISE and benchmarks on 100 volumes ( Figure 4A) . Most of the mean surface distances are around or smaller than 0.5 mm, which shows that the performance of MaCRUISE is consistent with benchmarks in most cases. However, we do find three images (marked 1 to 3) that are located outside of two standard deviations. The huge surface distances indicate that failures are occurring in these images.\nSecond, the segmentations of the lateral ventricles, where inaccuracies are often found, are used to find more failures. We plot the lateral ventricle size from MaCRUISE and FreeSurfer segmentations in a correlation form ( Figure 4B) . A strong linear correlation is found except in five outlier volumes (marked 3 to 7). We also marked three outliers (marked 1 to 3) from the surface distance analyses.\nFrom the above approach, a total of seven failed volumes were automatically detected. The segmentations and surfaces of the failures are shown in Figure 5 . We find that global failures (in the red rectangles) happen in all seven volumes for FreeSurfer and in one volume (volume 3) for CRUISE. Meanwhile, local failures (in the blue rectangles) are found around the lateral ventricles for CRUISE. In contrast, we do not find any global failures from MaCRUISE. For a complete analysis, we also visually checked the surfaces for the remaining 93 volumes and did not find global failures for either MaCRUISE or the benchmark algorithms.\nIn summary, the second experiment demonstrates that MaCRUISE obtains more robust surfaces than CRUISE while uniquely achieving self-consistent whole brain segmentation and cortical reconstruction. When both generating selfconsistent whole brain segmentations and cortical surfaces, MaCRUISE is more robust than FreeSurfer benchmark as all seven global failures were from the latter method."}, {"section_title": "CONCLUSION", "text": "To conclude, MaCRUISE addresses the challenging issue of obtaining self-consistent whole brain segmentation and cortical surface reconstruction from a new \"multi-atlas segmentation to surface\" perspective. The proposed method uniquely achieves the reliability of multi-atlas methods, while finding topologically consistent and volumetric accurate cortical surfaces. The landmark based validation shows that MaCRUISE derives the self-consistent segmentations and surfaces without compromising on the surface accuracy. The whole brain validation demonstrates that MaCRUISE is the most robust method when compared with two benchmarks on 100 BLSA volumes."}, {"section_title": "ACKNOWLEDGEMENTS", "text": "This research was supported by NSF CAREER 1452485, NIH 5R21EY024036, NIH 1R21NS064534, NIH 2R01EB006136, NIH 1R03EB012461, NIH R01EB006193, NIH 5R01NS056307, 5R21NS082891, and also supported by the Intramural Research Program, National Institute on Aging, NIH and in part using the resources of the Advanced Computing Center for Research and Education (ACCRE) at Vanderbilt University, Nashville, TN. This project was supported in part by ViSE/VICTR VR3029 and the National Center for Research Resources, Grant UL1 RR024975-01, and is now at the National Center for Advancing Translational Sciences, Grant 2 UL1 TR000445-06. The content is solely the responsibility of the authors and does not necessarily represent the official views of the NIH or the NSF. "}]
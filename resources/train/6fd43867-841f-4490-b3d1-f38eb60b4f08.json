[{"section_title": "Abstract", "text": "Fixed-and random-effects models for longitudinal data are common in sociology. Their primary advantage is that they control for time-invariant omitted variables. However, analysts face several issues when they employ these models. One is the choice of which to apply; another is that FEM and REM models as usually implemented might be insufficiently flexible. For example, the effects of variables, including the latent time-invariant variable, might change over time. The latent time-invariant variable might correlate with some variables and not others. Lagged endogenous variables might be necessary. Alternatives that move beyond the classic FEM and REM models are known, but they involve estimators and software that make these extended models difficult to implement and to compare. This article presents a general panel model that includes the standard FEM and REM as special cases. In addition, it provides a sequence of nested models that provide a richer range of models that researchers can easily compare with likelihood ratio tests and fit statistics. Furthermore, researchers can implement our general panel model and its special cases in widely available structural equation models software."}, {"section_title": "Introduction", "text": "The relative advantages of longitudinal data compared to cross-sectional are well-known (Baltagi 2005; Halaby 2004) , and panel data permit more sophisticated analyses. The National Longitudinal Study of Youth, National Longitudinal Study of Adolescent Health, Panel Study of Income Dynamics and National Education Longitudinal Study are just a few of the more frequently analyzed datasets in sociology.\nIn sociology two common models for longitudinal data are the random-effects and fixed-effects models (Allison 1994; Guo and Hipp 2004) . Indeed, a num1994; Alderson 1999; Alderson and Nielsen 1999; Conley and Bennet 2000; Mouw 2000; VanLaningham, Johnson and Amato 2001; Budig and England 2001; Wheaton and Clarke 2003; Teachman 2004; Yakubovich 2005; Beckfield 2006; Brand 2006; Matsueda, Kreager and Huizinga 2006; Shauman and Noonan 2007) . A major attraction of these models is that they provide a way to control for all time-invariant unmeasured (or latent) variables that influence the dependent variable whether these variables are known or unknown. The REM assumes that omitted time-invariant variables are uncorrelated with the time-varying covariates, while the FEM allows these variables to freely correlate (Mundlak 1978) . The REM has the advantage of greater efficiency relative to the FEM leading to smaller standard errors of coefficients and higher statistical power to detect effects (Hsiao 2003) . A Hausman (1978) test enables researchers to distinguish between the REM and FEM. Statistical software for REM and FEM is readily available (e.g., xtreg in Stata and Proc GLM, Proc Mixed in SAS).\nDespite these desirable features, REM and FEM are limited by the way sociologists typically use them. First, there appears to be confusion over when to use the REM vs. FEM. Halaby (2004:520) concludes that many studies \"ignore the issue of unobserved unit effects altogether, or they recognize such effects but fail to assess and take steps to deal with their correlation with measured covariates.\" Researchers sometimes take false comfort in REM because it includes a latent time-invariant variable (individual heterogeneity) without realizing that biased coefficients might result if the observed covariates are associated with the latent time-invariant variable. Second, there are restrictions imposed in the usual estimation of FEM and REM that may not make sense in sociological applications. For example, the usually implemented FEM and REM assume that coefficients of the same covariate remain equal and the error variances of equations are equal across all waves of data.\n1 If individuals pass through major life course transitions during the time period of the study (e.g., actively employed to retired or adolescence to adulthood), these assumptions of stable effects could be invalid.\nAnother constraint in the standard models is that latent time-invariant variables either freely correlate with all time-varying covariates as in the FEM or they must be uncorrelated with all covariates as in the REM. Even with strong prior evidence that only some correlations are zero, the usual models result in just two choices, freely correlated or all uncorrelated. Incorrectly assuming that the latent time-invariant variable is uncorrelated with the observed covariates is likely to bias estimates. Unnecessarily estimating zero correlations as in the usual FEM uses up degrees of freedom and can increase asymptotic standard errors.\nYet another implicit constraint in the usual models is that the lagged dependent variables have no effects. In some areas, prior values of the dependent variable influence current values. Last year's income, for example, might influence this year's income net of control variables, so it would be helpful to include lagged income as an explanatory variable. Furthermore, in the usual FEM and REM, the observed covariates in the models are not permitted to influence the latent time-invariant variable.\nThere is a vast literature in econometrics that suggests models and estimators to overcome many but not all of these limitations (for reviews see Baltagi and Raj 1992; Wooldridge 2002; Hsiao 2003; Halaby 2004; Baltagi 2005) . For example, interaction terms of the time period with a covariate permits the observed timeinvariant or time-varying variables' effects to differ by wave (Chamberlain 1984) . While lagged values of time-varying covariates are straightforward, inclusion of lagged dependent (endogenous) variables raises other complications in the FEM and REM that can lead to biased estimates with several authors suggesting solutions (e.g., Arellano and Bond 1991; Arellano and Bover 1995) . Hausman and Taylor (1981) proposed a method by which observed time-invariant variables such as sex and race can be included in FEMs. In the political science literature, Beck (2001) and Wilson and Butler (2007) review panel methods that work well when the number of waves of data are large relative to the number of cases.\nA variety of estimators for these alternative models is proposed. This raises two issues. One is that the use of different models and estimators complicates the ability to compare the relative fit of alternative models to the same data. This makes it hard to determine what improvements to the model are necessary. Further, not all of these extensions are readily accessible in software packages. Indeed, Halaby's (2004) review of the sociological literature suggests that most panel analyses are limited to the standard FEM or REM with little consideration of alternatives.\nAnother limitation of the usual application of FEM and REM is that researchers make limited assessments of the fit of their model to the data. The Hausman (1978) is the most typical test, though the test might lend support to one of these models even if the selected model is inadequate. Additional tests to provide evidence of model adequacy are available.\nThese tasks are facilitated by having a general panel model that encompasses not only the usual FEM and REM, but also a variety of extensions. Furthermore, having a common estimator that permits comparisons of nested models and assesses the plausibility of the overidentifying constraints is an asset. Our purpose is to present a general panel model that includes the usual FEM and REM as well as a variety of other nonstandard models as special cases.\nA few prior papers have drawn connections between SEMs and random-or fixed-effects panel models. An unpublished convention paper by Allison and Bollen (1997) and a SAS publication by Allison (2005) discuss SEM set-ups of the standard FEM and REM. Teachman, Duncan, Yeung and Levy (2001) look at the FEM in SEM, but concentrate their discussion and example on cross-sectional data with clusters of families rather than panel data. Ejrnaes and Holm (2006) look at different types of fixed-effects estimators in panel data models, but do not cover the REM, lagged dependent variable models, or some of the other variants. None of these articles presents our general panel model, they do not discuss testing the equality of parameters over time or treat supplemental fit indices, and they do not provide justification for the maximum likelihood estimator for models with lagged dependent variables."}, {"section_title": "General Panel Model", "text": "We present a general panel model that includes individual heterogeneity (latent time-invariant variables) as in the usual FEM and REM, but permits additional structures for comparison. There are two versions of this model, one with a lagged dependent variable as a covariate and another without. We present the latter first and show how we can derive the well-known random effects, fixed effects and alternative models by imposing restrictions on this general panel model. We later introduce lagged endogenous variables into this general panel model. Consider the following equation:\nwhere y it is the value of the dependent variable for the ith case in the sample at the tth time period; x it is the vector of time-varying covariates for the ith case at the tth time period; B yxt is the row vector of coefficients that give the impact of x it on y it at time t; z i is the vector of observed time-invariant covariates for the ith case with B yzt a row vector of coefficients at time t that give the impact of z i on y it . The \u03b7 i is a scalar of all other latent time-invariant variables that influence y it ; and \u03bb t is the coefficient of the latent time-invariant variable (\u03b7 i ) at time t; and at least one of these \u03bb t is set to one to provide the units in which the latent variable is measured (e.g., set \u03bb 1 = 1). The \u03b5 it is the random disturbance for the ith case at the tth time period with E(\u03b5 it ) = 0 and E(\u03b5 . It also is assumed that e it is uncorrelated with x it , z i , and \u03b7 i and that COV(\u03b5 it , \u03b5 is ) = 0 for t \u2260 s. As an example, y it might be the infant mortality rate in county i at time t; x it might consist of time-varying variables such as unemployment rate, physicians per capita, medical expenditures per capita, etc. all for county i at time t; z i might be time-invariant variables such as region and founding date of county; and \u03b7 i would contain all other time-invariant variables that influence infant mortality, but that are not explicitly measured in the model. The \u03b7 i represents individual heterogeneity that affects the outcome variable. 2 We assume that \u03b7 i is uncorrelated with z i if both are included in the same model.\nNote that i always indexes the cases in the sample, while t indexes the wave or time period. If either subscript is missing from a variable or coefficient, then the variable or coefficient does not change either over individuals or over time. For example, z i and h i have no t subscript, but do have an i subscript. This means that these variables vary across individuals, but do not change over time for that individual.\n3 In a similar fashion, the absence of an i subscript means that the coefficients in the model do not change over individuals. If a time period or wave of data were distinct, then we could include a dummy variable, say D t , that is the same value across all individuals but could differ over time."}, {"section_title": "General Panel Model and Restrictive Forms", "text": "The general panel model in Equation 1 incorporates the usual REM and FEM as special cases and goes beyond these options. For example, suppose researchers are studying conservatism among individuals. Assume that the relationships between authoritarian personality and other latent time-invariant variables and conservatism (y it ) increases over time. Allowing \u03bb t to increase rather than always being equal to one would permit us to accommodate the changing relations. Or the effects of education, race and income on conservatism might vary with age and these differences in coefficients for the same variable over time are permitted in the general panel model. On the other hand, if the coefficients for the same variable are erratic and without discernable patterns at different waves, this raises questions about the specification of the model. In brief, the general panel model enables us to vary the coefficients of any of the observed or latent variables while also serving as a sensitivity test of the model specification.\nGiven our general panel model (y it = B yxt x it + B yzt z i + \u03bb t \u03b7 i + \u03b5 it ), we need a method to select more restrictive models to which we can compare its fit. If a researcher is in the fortunate situation to have prior studies or theories suggest a formulation, then this hypothesized model is a desirable starting point. More commonly knowledge in an area is insufficiently developed to provide such specific guidance. A \"forward model\" search strategy begins with a model much more restrictive than the general panel model and lifts restrictions until the researcher judges the model fit to be adequate. So the standard random effects model could be the starting point and if its fit is not good, the researcher could test whether it significantly improves by, say, allowing the error variances to differ over time. If the model fit is still lacking, then the researcher could try a hybrid model that lets x it and \u03b7 i correlate. This process could continue until the model fit is acceptable. The modeling process moves from more restrictive to less restrictive models and stops when the fit passes some standard.\nA \"backwards model\" search strategy begins by fitting the general panel model of y it = B yxt x it + B yzt z i + \u03bb t \u03b7 i + \u03b5 it . To identify this model we constrain the correlations of z i and \u03b7 to zero 4 and set one of the \u03bb t s to one (e.g., \u03bb 1 = 1). This is the least restrictive model. If it does not fit, it is doubtful that more restrictive forms of the general panel model will. If it does fit, then we could impose further restrictions until we judge that the fit to the data is inadequate. Table 1 outlines a general strategy of fitting models from less to more restrictive when prior knowledge is lacking.\nIf the general panel model at the top of Table 1 fits the data, then researchers can turn to a model that constrains the effects of the latent time-invariant variable (\u03b7 i ) to be equal over time as shown in option (1) in Table 1 . Option (1) is nested in the general panel model , so as we explain in the section on Model Fit, we can test whether there is a statistically significant decline in fit by imposing the restriction of \u03bb t = 1 for all waves. If option (1) has an adequate fit, then researchers can impose an additional restriction that the coefficient for the impact of each observed time-invariant variable is equal over time (option (2) in Table 1 ). With this restriction, we have both the latent and observed time-invariant variables having stable influences over each wave of data. If option (2) proves to be a good fit, then we can introduce the additional constraint that the coefficients for the time-varying variables maintain the same values over time (B yxt = B yx ) (option (3) in Table 1 ).\nIf the model represented by option (3) in Table 1 fits, then we introduce different types of restrictions in the other options. Option (4) keeps coefficients equal over time, but also constrains the correlations of the time-varying variables (x it ) with the latent time-invariant variable (\u03b7 i ) set to zero. Table 1 points to two different options depending on the fit of the model represented in option (4). If we fail to reject option (4), then option (5)(a) introduces the additional constraint of the error variances being equal for all waves of data. If we do reject option (4), then option (5)(b) returns to the model in option (3) where the time-varying and latent time-invariant variables correlate and constrains the error variances to be equal over time. Table 1 does not show all possible options; it is meant more as an illustration rather than the only way to proceed. For instance, if the restriction of \u03bb t = 1 for all waves does not hold we could remove this restriction but still check whether B yxt = B yx holds. In such a series of specifications, we would not recover the standard REM and SEM. We encourage readers to view Table 1 as providing guidelines rather than a rigid sequence of steps. \nWe can estimate a general panel model that enables us to consider individual heterogeneity (latent time-invariant variables) as in the usual FEM and REM, but also permits time-differing coefficients and additional structures for comparison. In these models, we can also include time-invariant observed variables, and thus we include indicators for race (with one indicator for black, one for Hispanic, and where the omitted category is non-black, non-Hispanic). This addition provides estimates for the time-invariant variables. As we do not have prior knowledge as to a single, specific model, we adopt the strategy of fitting models outlined in Table 1. Table  5 contains the fit statistics for the models we estimate, beginning with the general panel model and followed by the more restrictive forms as described in Table 1 .\nAs we see from Table 5 , the general panel model fits quite well. Constraining the latent time-invariant effect to be invariant over time significantly reduces model fit from the general panel model, and indeed in all the specifications that follow we find deterioration in model fit when we do not allow this effect to vary over time. Substantively, this implies that the latent time-invariant factors, such as stable personality traits, impact wages differently over a woman's life course. Conversely, constraining the effect of race to be constant over time improves model fit, as we see from specification 2b. Figure 4 plots the effects of number of children on log wages for several alternative specifications, including specification 2b. The x-axis indicates year and the y-axis indicates the child effect on women's wages. The y-axis is in reverse order such that higher values indicate a larger wage penalty for motherhood.\nSpecification 2b allows the coefficients to vary over time, and we observe a generally increasing effect of number of children over time. This result suggests a form of cumulative disadvantage associated with motherhood on women's wages. Constraining all the time-varying variables to be constant over time (specification 3) does not significantly change the fit indices. If we had specific hypotheses concerning which variables are the most likely to vary over time, then we could estimate the model freeing only those coefficients and compare the fit of this new model to the fixed and random effects versions of the same model where the coefficients are set equal over time. In our case, we do not have specific hypotheses on which variable's coefficients might differ over time. Therefore, we constrain all the coefficients of the time-varying variables to be fixed over time. The IFI, RNI and RMSEA suggest only slight differences between models that do and do not allow the coefficients to vary over time. We report the results for specification 3b in Table 6 .\nOur specifications that set the covariance between the time-varying variables and the latent time-invariant variables to zero also improve model fit, and we report the results from specification 4b in Table 6 . This is again not surprising, as most of the covariances of the latent time-invariant variable with the observed covariates are substantively near zero. The effect of number of children on wages for specification 4b is the smallest of those we have estimated, -.028. Given the high level of model fit for specification 4b, we try some slight modifications at this point, allowing the child coefficient to vary over time (4b*) and constraining some of the covariances of the observed time-varying and latent time-invariant variables to be zero (4b**). The fit is comparable between 4b and 4b*/4b**, except according to the BIC which favors 4b. We report the results of the child coefficients for 4b* in Figure 4 , where we again see a generally increasing negative effect of number of children over time suggesting a form of cumulative disadvantage. We next allow the error variances to vary over time (specification 5). The chi-square difference tests are statistically significant supporting the models where the error variances are allowed to differ, while the IFI, RNI and RMSEA suggest only slight differences between models that do and do not allow the error variances to vary over time. The BIC comparisons support the conclusion that we prefer the models that do not allow the coefficients and error variances to change over time. If we continue to follow our series of specifications outlined in Table 1 , we next estimate the classic REM (specification 6) and FEM (specification 7). The fit indices do not support these as preferred models. The weight of evidence tends to favor the models with a latent time-invariant variable whose effects vary over time, observed time-invariant and time-varying effects that are constrained to be equal over time (although perhaps the child coefficient is best left to vary over time), and error variances that are constrained to be equal over time."}, {"section_title": "Random Effects Model", "text": "The REM is one of the most popular models for panel data. \nwhich is the usual REM. Comparing this to the general panel model we can see that the REM assumes that all explanatory variables (i.e., x it , z i , \u03b7 i ) have effects on y it that are the same over all time periods. Furthermore, the REM allows the time-varying observed variables in x it and the time-invariant observed variables in z i to correlate, but none of these observed variables is permitted to correlate with the latent time-invariant variable, \u03b7 i . Figure 1 is a path diagram representation of a REM that is kept simple with a single time-varying variable (x) for four waves of data and a single time-invariant variable (z 1 ). A path diagram is a graph that represents a multi-equation system and its assumptions. By convention, boxes represent observed variables, ovals represent latent variables, single-headed straight arrows represent the direct effect of the variable at the base of the arrow on the variable at the head of the arrow, and two-headed arrows such as those connecting the xs and z 1 stand for possible associations between the connected variables where that association is taken account of, but not explained within the model. 5 To simplify the notation the i subscript is excluded for the variables. It is noteworthy that the latent time-invariant variable (\u03b7) is part of the model, but it is shown to be uncorrelated with the time-varying variables (x t ) and the time-invariant variable (z 1 ) since there are no two-headed arrows linking it to the observed variables. The direct impact of the latent timeinvariant variable (\u03b7) on the repeated measures (ys) is equal to 1 as is implicit in the equation for the REM."}, {"section_title": "Fixed Effects Model", "text": "Returning to the general panel model in Equation 1, suppose that we keep the coefficients for the time-varying variables equal for all waves (B yxt = B yx , and \u03bb t = 1), we drop B yzt z i , we allow the latent time-invariant variables (\u03b7 i ) to correlate with x it , and we set the equation error variances equal (\u03c3 ). This is option (7) in Table 1 and leads Equation 1 to become:\nwhich is the equation for the usual FEM. The most obvious difference between the FEM and the REM is the absence of B yz z i . These are the time-invariant observed variables and their coefficients.\nThe usual FEM does not explicitly include these variables, but rather folds them into \u03b7 i , the latent time-invariant variable. The reason is that the FEM allows \u03b7 i to correlate with x it and if we were also to include time-invariant observed variables (z i ), these would be perfectly collinear with \u03b7 i and we could not get separate estimates of the effects of \u03b7 i and z i . Hence, we allow \u03b7 i to include z i as well as latent time-invariant variables. Though losing the ability to estimate the impact of time-invariant variables such as race, sex, etc. is a disadvantage, we still are controlling for their effects by including \u03b7 i in the model. In addition, we have a potentially more realistic assumption that allows the \u03b7 i variable to correlate with the time-varying covariates in x it . In the hypothetical example of infant mortality rates in counties presented above, we could not include the time-invariant variables of region and founding date explicitly in the model. But these and all other time-invariant variables would be part of \u03b7 i and hence controlled. In addition, we allow these time-invariant variables to correlate with the time-varying variables such as unemployment, physicians per capita, and so on. Figure 2 is a path diagram of a FEM with a single time-varying variable. We drop z i given its perfect collinearity with \u03b7 i . Easily visible within the diagram is the covariance of the time-varying x 1t and \u03b7 that is part of the FEM specification. But one difference from the usual implementation of FEM is that the covariances of the time-varying variables with \u03b7 are an explicit part of the model. This can provide the researcher a better sense of the properties of these latent time-invariant variables and their pattern of associations in that a researcher can estimate the correlation with observed covariates. The equality of the coefficients from x 1t to y t is shown by using the same coefficient for each path as is the coefficient of 1 from \u03b7 to y t . Below we will present an empirical application where the repeated measure (y t ) is wages, the number of children is a time-varying covariate (x 1t ), and all omitted time-invariant variables (e.g., intelligence, motivation, other stable personality traits) are combined in h with this latent variable permitted to correlate with x 1t . Note that if the REM does not include z i , then the REM and FEM are nested and only differ in that the FEM allows x it and \u03b7 i to freely correlate where the REM restricts them to be uncorrelated. If the REM does include z i and the FEM does not, then the models are not nested. But if we include z i in the FEM while keeping it uncorrelated with \u03b7 i , we are led to the Model 5 (b) which is nested in the REM 5 (a). These two differ only in that the REM assumes that the covariances of the time-varying x it and \u03b7 i are zero whereas Model 5 (b) does not. 6 From the perspective of the general panel model in Equation 1 the REM and FEM are rather specialized models whose restrictions should be tested rather than assumed."}, {"section_title": "General Panel Model with Lagged Effects", "text": "Researchers can add lagged values of the time-varying covariates to the vector, x it . The cost of doing so is the loss of the first wave of data since the first wave lagged value of the time-varying covariate is not available. Lagged endogenous variables for autoregressive effects are also straightforward to include. We modify \nwhere the new symbol is the autoregressive coefficient r t of the effect of y it-1 on y it . We can get to more familiar models by introducing restrictions. A modified version of the FEM with equal autoregressive parameters would be:\nThe first wave y i1 should be treated as predetermined and correlated with the time-varying (x it ) and latent time-invariant variables (\u03b7 i ). Figure 3 is a modified version of Figure 2 that includes the lagged endogenous variable. Allison (2005: 135) mentions a similar, simpler FEM with a single x variable, but states that it has not been investigated analytically. The Appendix of this paper presents a general version of this model and treats its formulation and estimation.\nAn added complication to check with lagged endogenous variables is whether there is an autoregressive disturbance. This is particularly problematic if present with a lagged dependent variable since it creates a correlation between the disturbance and explanatory variable. We can treat this by adding an autoregressive relation between the disturbance terms. It is also possible to include additional lagged values of the covariates or the endogenous variable. Furthermore, we could create a variety of special cases of Equation 4 in an analogous way to what we did in Table 1 but adding the autoregressive term r t . To conserve space we do not present these extensions, but instead turn to the estimation and assessment of model fit using tools from structural equation models."}, {"section_title": "Estimation", "text": "Equation 1 is the general panel model that incorporates the standard FEM, REM, and other models that we have presented except for those with the lagged endogenous variables which is in Equation 4. The literature on panel methods has proposed a variety of estimators for different special cases of this model. For example, the Least Squares Dummy Variable estimator is popular for the usual FEM in Equation 3 and generalized least squares is a common choice for the usual REM in Equation 2. To enhance the comparison of models we will use the same maximum likelihood estimator for both of these models as well as the model extensions proposed (see appendix).\nSEM software is well-suited to estimate these models with its variety of estimators and its allowance of latent variables such as \u03b7 i . The default estimator for continuous dependent variables in SEM is the maximum likelihood estimator. The MLE is derived under the assumption that y it , conditional on x it and z i , [y it |x it , z i ] comes from a multivariate normal distribution (J\u00f6reskog 1973; Bollen 1989) . Under these conditions, the coefficients and parameter estimates of the model have the desirable properties of MLE. 7 The appendix gives a more formal pre-sentation of the model and MLE fitting function for SEMs. There is much work in the SEM literature that examines the robustness of the ML estimator to the normality assumption and it finds conditions where it is not required for accurate significance tests (e.g., Satorra 1990). Furthermore, there are other readily available estimators for SEMs that either do not require normal disturbances or that correct for nonnormality (e.g., Bollen and Stine 1990, 1992; Satorra and Bentler 1994) . This means that when required we have alternative estimators that permit disturbances from non-normal distributions."}, {"section_title": "8", "text": "A practical matter in using the SEM software is preparing the data set. Panel data commonly appears in one of two forms. One is the long form where observations of the same individual are stacked on top of each other. Each row of the data set in a sample of individuals over several years is a \"person-year.\" In the wide form of data, by contrast, each row refers to a different individual. The variables give the variable values for a particular individual in a particular wave of the data. The wide form is most suitable for the SEM approach. Statistical software have routines that enable easy movement between the long and wide form of panel data (e.g., in Stata, reshape)."}, {"section_title": "Missing Data", "text": "Attrition or other sources of missing values on variables in panel analysis is common. In panel data \"balanced\" and \"unbalanced\" data are terms that capture the possibility that a different number of waves of data are available for different cases. The unbalanced design implies missing data. In a SEM there are two options for treating data that are Missing Completely at Random or Missing at Random (Little and Rubin 1987; Schafer 2000) . One is the direct MLE approach that allows the variables available for a case to differ across individuals and that estimates the parameters with all of the non-missing variable information (Arbuckle 1996). The second option is multiple imputation where multiple data sets are imputed, estimated, and their estimates combined. We apply the direct MLE in our application. Direct MLE forms the likelihood for each case in the sample using all variables that are not missing for that case. No data are imputed. Rather the contribution of a case to the total likelihood will depend on the number of observed variables with complete information for a case (Arbuckle 1996; Wothke 2000) . Most SEM software now have the direct MLE capability to handle missing data. 9 Either of these approaches requires the analysis of the raw data rather than the covariance matrix of the observed variables."}, {"section_title": "Tests of Model Fit", "text": "Borrowing from the SEM literature, we can form tests of overall model fit for our panel data models. If a model is exactly correct, the null hypotheses (H 0 ) of:\nare true where \u03bc and \u03a3 are the means and covariance matrix of the observed variables and \u03bc(\u03b8) and \u03a3(\u03b8) are the model-implied means and covariance matrix of the observed variables. The \u03b8 that is part of the model-implied means and covariance consists of the free parameters (e.g., coefficients, error variances, etc.) of a model. Each model implies a particular form of \u03bc(\u03b8) and \u03a3(\u03b8) that predicts the means and covariance matrix. See the Appendix for these implied moment matrices for our models. In light of this, the null hypothesis in Equation 6 is a test of the validity of the model. Rejection suggests that the model is incorrect while failure to reject suggests consistency of the model with the data. The MLE provides a readily available test statistic, say T, that is a likelihood ratio test that asymptotically follows a chi-square distribution with degrees of freedom of df = (1/2)P(P+3) -t where P is the number of observed variables and t is the number of free parameters estimated in the model. The (1/2)P(P+3) is the number of variances, covariances, and means of the observed variables that provide information on the model parameters. Comparing T to a chi-square distribution with df at a given Type I error rate leads us to reject or fail to reject H 0 .\nThe LR test of H 0 : \u03bc(\u03b8) and \u03a3(\u03b8) can have considerable statistical power when the sample is large. Even minor misspecifications in the model can lead to its rejection. In practice, this means that nearly all models will be rejected in a sufficiently large sample and this might be due to errors in specification that most would consider trivial. See Satorra and Saris (1985) or Matsueda and Bielby (1986) for methods to estimate the statistical power of the chi square test of Equation 6.\nAlternative measures of fit have emerged in the SEM literature. The literature on these fit indices is vast (e.g., Bollen and Long 1993; Hu and Bentler 1998 ) and we do not have the space to fully review these. However, Schwarz (1978) Bayesian Information Criterion is positive (see Raftery 1993 Raftery ,1995 , then the model is generally not acceptable. 10 In general it is good practice to report several fit indices along with the chi-square test statistic (T), degrees of freedom, and p-value. The Hausman Test provides another way to compare FEM and REM, when these are among the models estimated. Since these indices and tests measure model fit in different ways, they will not always lead to an unambiguous best model. This means that the researcher must take these fit statistics in conjunction with prior studies and knowledge of the substantive area, and perhaps further guided empirical exploration of the data in coming to an assessment of which model appears to best represent the social world."}, {"section_title": "Comparisons of Models", "text": "In our presentation we described a number of models as having relations where the parameters of one model were a restricted form of another. Table 1 provides a number of examples. We can use the LR test to compare such nested models by taking the difference in chi-squares and degrees of freedom of the most and less restricted models. A new LR chi-square test statistic and degrees of freedom results with a null hypothesis that the most restricted model fits as well as the less restricted model. A nonsignificant chi-square is evidence in support of the more restricted model whereas a significant chi-square supports the less restricted model. This LR chi-square difference test allows us to test such hypotheses as whether the error variances or the variable coefficients are the same over time.\nThe fit indices described above are also a tool to compare different model structures. We already have mentioned how the BIC with the lowest value indicates the best fit. Differences in the other fit indices might also provide useful information, though in our experience, the differences in these other fit indices can be more difficult to interpret than the BIC, because the differences in the former are small in magnitude."}, {"section_title": "Wage Penalty Empirical Example", "text": "We illustrate a variety of the preceding models by examining the wage penalty for motherhood using data from the National Longitudinal Survey of Youth. The NLSY is a national probability sample of 12,686 young men and women who were 14 to 22 years old when they were first interviewed in 1979; blacks and Hispanics are oversampled. These individuals were interviewed annually through 1994 and biannually thereafter. We begin by generally replicating the results from Budig and England (2001) , who examined data from the 1982-93 waves of the NLSY; we differ in that, for simplicity, we only analyze every other year, i.e. 1983, 1985, 1987, 1989, 1991, and 1993 . The coefficients are quite similar to those for all 12 years of data (not shown). Budig and England were interested in whether the relationship between number of children and women's earnings is spurious or causal, and used the FEM to address this question. Budig and England's study is an excellent empirical application of the usual FEM. Nevertheless, we will show how we gain new insights using our approach.\nWe limit our sample to women employed during at least two of the years from 1982-93 to replicate Budig and England's sample selection. Out of a total of 6,283, we have a final sample size of 5,285 women.\n11 The dependent variable is log hourly wages in the respondent's current job, where person-years whose hourly wages appear to be outliers (i.e., less than $1 or above $200 per hour) are eliminated. The main independent variable is the total number of children that a respondent reported by the interview date.\n12 Model 1 includes only number of children as a covariate. In Model 2, we control for marital status using dichotomous measures to indicate married and divorced (including separated and widowed), where never married is the reference category. In Model 3, we further control for measures of human capital including years of educational attainment, current school enrollment, years of full-time and part-time work experience, years of full-time and part-time job seniority, and the total number of breaks in employment. 13 For all their models, Budig and England conduct a Hausman test to assess whether REMs were adequate and find that the test supports the FEM. Therefore, they do not present the estimates for REM."}, {"section_title": "REM and FEM as SEMs", "text": "We first demonstrate how we can estimate the standard REM and FEM, as well as a hybrid of these models in a SEM framework. We use data in wide format and Notes: Numbers in parentheses are z-ratios. Number of individuals = 5285. *p \u2264 .05 **p \u2264 .01 ***p \u2264 .001 (two-tailed tests). The coefficients for Total Number of Children is constrained to be the same over time."}, {"section_title": "1", "text": "IFI and RNI were identical up to 3 significant digits, so we do not report them separately here.\nestimate all models using Mplus 4.0. We apply the direct MLE (Arbuckle 1996) that estimates the parameters with all of the nonmissing variable information. The first three columns of Table 3 correspond to the standard REM and next three columns to the standard FEM, but estimated in the SEM framework. We compared these estimates to those obtained in Stata and the estimates were virtually identical. Hence we can reproduce the usual REM and FEM using SEM. However, the SEM results provide additional information by way of the measures of model fit.\nIn Table 3 we report the model fit statistics listed in Table 2 . The chi-square LR test statistic that compares the hypothesized FEM or REM to the saturated model leads to a highly statistically significant result, suggesting that these hypothesized models do not exactly reproduce the means and covariance matrix of the observed variables. With more than 5,000 cases in this sample, the chi-square test has considerable statistical power to detect even small flaws of the model. When we do not include any observed time-invariant variables, the REM is a restricted form of the FEM where in the former, the latent time-invariant variables (h i ) are uncorrelated with all other covariates. Correlations are allowed in the FEM. Given this nesting, we can take the differences in the chi-squares and degrees of freedom of the REM and FEM which forms a new chi-square and degrees of freedom. A statistically significant chi-square is evidence that favors the FEM while an insignificant chi-square favors the REM. Performing these LR chi-square difference tests consistently leads to a statistically significant result lending support to the FEM versions of models 1-3 in Table 3 . These results are consistent with the Hausman test in favoring the FEM. However, the large sample size combined with the large degrees of freedom for these models complicates the result in that the statistical power of all these tests is high and does not tell us the magnitude of the differences. The RNI and IFI (i.e., the baseline fit indices) differ in the third decimal place and values as close as these are generally treated as essentially equivalent. The RMSEA has slightly larger differences in the pairwise comparisons with a tendency to favor the REM. The greatest separation in the pairwise comparisons occur for the BICs and the BICs favor the REM versions of the models.\nThese results imply that the REM and FEM are closer in fit than the Hausman test or the chi-square tests suggest. One reason is that the REM has considerably more degrees of freedom than the FEM since the REM is forcing to zero all of the covariances of the latent time-invariant variable with the time-varying observed covariates. The BIC gives considerable weight to the degrees of freedom of the model in large samples and the greater degrees of freedom contributes to making the BIC more favorable towards the REM. A second related reason for the REM appearing more competitive is that the magnitudes of the estimated covariances between the time-varying covariates and the latent variable are not always large in the FEM. Table 4 provides a sample of the estimated covariances between the full set of time-varying covariates and \u03b7 i in the FEM version of Model 3. We provide only three years of covariances and correlations for simplicity, but we actually estimate all six years of covariances. These results show that many of the covariances of the latent time-invariant variable (\u03b7 i ) and the time-varying xs are not statistically significantly different from zero. Interestingly, number of children, the key explanatory variable, is essentially uncorrelated with \u03b7 i as is marital status, part-time seniority and experience. The other statistically significant correlations are often modest in magnitude (e.g., currently in school and part-time experience correlates less than .01). Thus our results suggest a more nuanced picture of the association between h i and the xs than suggested by the REM or FEM. The latent time-invariant variable has a statistically significant association with some xs, but not with others. Even the statistically significant ones are modest in magnitude (e.g., \u2264 .2). 14 So the modest and sometimes not statistically significant covariances of \u03b7 i and the xs seem to be the reason that the REM and FEM have fits that are so close. The low correlation of \u03b7 i with our focal independent variable, number of children, likely explains why the coefficients for this variable do not differ even more between the REM and FEM.\nThese fit indices and the estimates of the covariances of the latent time-invariant variables and the observed time-varying covariates are not available with most random and fixed effects statistical routines; the Hausman test indicated that the FEMs are unambiguously superior to the REMs. Our results present a more subtle view of their relative fit.\nWhile Model 3 fits the data fairly well, the chi-square test suggests the potential for improvement in fit. One possibility is to estimate a FEM/REM hybrid model. In the final column of Table 3 , we present results from a hybrid model, where the latent time invariant variable (\u03b7 i ) is correlated only with the consistently significant covariances (i.e., educational attainment, currently in school, full-time experience and employment breaks) and is uncorrelated with the remaining covariates. When we compare the FEM/REM hybrid model to the REM and FEM, we find that the chi-square difference tests support the FEM. However, the differences in the IFI, RNI, and RMSEA are small. Finally, the BIC supports the REM. If a researcher judges the correlations between the time-varying covariates and the latent time-invariant variable to be small, then it seems reasonable that the BIC supports the REM. The coefficient estimate for number of children increases in absolute magnitude from -.034 to -.043 as we move from the REM to the FEM/ REM hybrid and FEM."}, {"section_title": "General Panel Model and Restrictive Forms with Lagged Effects", "text": "One possibility to further improve our models is having the lagged value of wages as a determinant of current wages. Substantively, including such an effect makes sense in that there is inertia in wages where last year's wages are likely to be a good predictor of this year's. As we described in section 2.4, lagged endogenous variables for autoregressive effects are straightforward to include. Our appendix provides a more formal presentation of the SEM setup and assumptions for estimating such a model. We lose one wave of data for each lag by specifying such a model; thus, our hypothesized models will be compared to different saturated and baseline models than those above. Table 5 provides fit statistics for the general panel model and restrictive forms with a lagged endogenous variable. We plot the values for the specifications where the child coefficient is freed in Figure 4 and report results from some of the better fitting specifications in Table 6 .\nThe overall fit statistics of the model in Table 5 enable us to compare the models. The large sample size and accompanying high statistical power lead all the LR chi-square tests to be statistically significant. We present fewer results than those above, generally omitting those specifications sequentially that do not improve model fit. We find once again that the equality con- 1 IFI and RNI were identical up to three significant digits, so we do not report them separately here. Social Forces 89(1) straint on the coefficients for the latent time-invariant variable is not supported. The RNI and IFI are consistently close to 1and the RMSEA is considerably lower than the usual cutoff of 0.05. The BIC always takes large negative values supporting the selection of any of these models over the saturated model. Specification 2b has particularly good fit according to IFI, RNI and RMSEA, and we report the time-varying child coefficient of this specification in Figure  4 . The child coefficients are quite similar to those in specification 4b* above. Specification 3b, which differs from 2b in that we constrain the observed timevarying effects to be constant over time is an improved fit according to BIC, but not according to the IFI, RNI or RMSEA. According to BIC, the best fitting specification is 5b2, and we report the results for this model in Table 6 . The coefficients are quite similar to specification 3b, and to the classic REM. We test a few alternative specifications to 5b2 (5b* and 5b**), and the fit is quite comparable. We report the time-varying child coefficient from specification 5b*, which is relatively flatter than the other specifications. Taken together we reach the following conclusions on overall fit of the models. First, we significantly improve model fit when the coefficient on the latent timeinvariant variable is allowed to vary over time. We are not aware of any other sociological applications of FEMs and REMs that permit these coefficients to vary. Second, the IFI, RNI, and RMSEA do not reveal large differences among the different versions of these models, but tend to favor a less restrictive model, where only observed time-varying effects are allowed to vary over time. Third, the lagged endogenous variable models have very good fit."}, {"section_title": "\u2022", "text": "15 These general panel model specifications and more restrictive forms suggest a smaller wage penalty for motherhood than the classic REM and FEM, and provide some additional substantive information. Moreover, models with lagged effects likewise suggest a smaller penalty for motherhood's direct effect, particularly in later years, than that suggested by REM and FEM without lagged endogenous variables. This useful distinction between direct, indirect, and total effects is well-known in the SEM literature (e.g., Sobel 1982; Bollen 1987) .\nSEM models have helped us to uncover evidence that the standard assumptions of fixed coefficients, fixed error variances, and no lagged endogenous variables were not always supported when tested in our empirical example. We present this series of specifications to demonstrate the flexibility of our approach. Still, we could have estimated various other alternatives, or combined many of the elements we present separately. The SEM formulation also allows investigation of indirect effects, as we mentioned above. Another realm that we have not explored, but which is easily implemented, is to include latent covariates with multiple indicators."}, {"section_title": "Conclusion", "text": "REM and FEM panel model applications are becoming more common in sociological research. However, too often researchers apply FEM or REM without careful consideration as to why they should prefer one model over another. We show that these models are a restrictive form of a more general panel model that permits a wider range of alternatives and that is estimable using widely available SEM software. With this general panel model, a researcher does not need to maintain these constraints but can test them and only impose those supported by the data. In addition, a wide variety of additional models and formulations are possible. For instance, a researcher can test whether a covariate's impact on the repeated measure stays the same across all waves of data; test whether the error variances should be allowed to vary over time; include lagged covariates or lagged dependent variables; free factor loadings on the latent time-invariant variable; include observed time-invariant variables in a FEM either as uncorrelated with the latent time-invariant variable or as a determinant of the latent variable; estimate Our empirical example of the impact of the number of children on women's wages illustrated some of the advantages that flow by casting FEM and REM panel models as part of this general panel model. For one thing, we had access to a more complete set of model fit statistics that revealed flaws in both the standard FEM and REM that were not evident in the usual approaches. Specifically, neither model fully reproduced the covariance matrix and means of the observed variables as they should if the models were correct. Furthermore, we found evidence that the REMs were more competitive than the Hausman test and LR test alone revealed. In fact, the Hausman and LR tests from the study upon which our example was based unambiguously supported the FEM over the REM. The primary distinction between the FEM and REM is whether the covariates correlate with the latent time-invariant variable. Using the SEM approach we saw that many of the correlations of the covariates with the latent time-invariant variable were close to zero -information unavailable with usual methods, and thus we fit a FEM/REM hybrid model in which only a subset of the covariates were correlated with the latent time-invariant variable. Furthermore, the SEM approach suggested that the impact of the latent time-invariant variable on wages was not the same across all years. Most applications of FEM and REM assume constant effects regardless of the year of the panel data. A further departure from the published models for these data was that we looked at whether lagged wages impacted current wages net of the other determinants. We found strong evidence that the lagged Notes: Numbers in parentheses are z-ratios. Number of individuals = 5285. *p \u2264 .05 **p \u2264 .01 ***p \u2264 .001 (two-tailed tests). The coefficients for Total Number of Children is constrained to be the same over time.\nendogenous variable models were superior to the models without them. Thus, the number of children has direct as well as indirect effects on mothers' wages. We also incorporated an observed time-invariant variable, race, to the FEM, providing the typically unavailable coefficients of a potential variable of interest. Still the empirical example did not exhaust the types of models for panel data that could be applied with our approach. For instance, it would be straightforward to develop a model that permits the dependent variable to be latent with several indicators and to have a fixed or random effects-like model for it. We could allow for measurement error in the time-varying or time-invariant covariates and include them in the model. In addition, latent curve models or Autoregressive Latent Trajectory models might be applied (Bollen and Curran 2006) . In brief, researchers can build a broader range of models than is commonly applied, some of which might better capture the theory that they wish to test.\nAlthough the SEM approach offers considerable flexibility, it does not adequately handle all situations that researchers might encounter. For instance, if the latent time-invariant variable has a different correlation with the covariates for different individuals, these models will not work. Ejrnaes and Holm (2006) show how a difference model or case mean deviation (fixed effects) model would work in this situation where our SEM approach would not unless difference scores were modeled. Similarly, the models we treat permit the covariate's effect on the repeated measure to differ over time, but assume that these coefficients are constant over individuals. It is possible to estimate models where these coefficients differ over individuals (e.g., Beck and Katz 2007) . Also there are some inherently nonlinear relationships between variables that might be difficult or impossible to capture with the classic FEM and REM or with SEM. Finally, models with numerous parameters, a great deal of missing data, and many waves might exceed the computational capabilities of some current desktops or SEM software. Nevertheless, our paper allows considerable flexibility in the variants of the FEM and REM that researchers can apply to panel data. By providing this SEM framework, researchers will be able to test a richer variety of theoretical models and explore flexible alternative models that could help test and shape new theories."}, {"section_title": "Notes", "text": "1. There are methods of handling time-specific coefficients for the time-varying covariates, but this issue is seldom examined in practice.\n2. Other SEM approaches use special cases of this model. Teachman, Duncan, Yeung and Levy (2001) and Ejrnaes and Holm (2006) focus on the fixed-effects model of y it = B yx x it + \u03b7 i + \u03b5 it . An unpublished paper by Allison and Bollen (1997) 3. Though we use the term \"individual\" to refer to a case, the cases do not have to be individual people. They could be groups, organizations, nations, etc.\n4. Attempting to estimate this correlation would lead to perfect collinearity between z i and \u03b7 i . This would make it impossible to estimate the effects of these variables.\n5. A possible source of confusion is that path analysis is sometimes used to refer to recursive or non-recursive models of only observed variables where measurement error and latent variables are not considered. This is an inaccurate restriction of the term. In fact, Sewall Wright, the inventor of path analysis, included latent variables as part of path analysis.\n6. A reviewer points out that a classic approach views the FEM as a within-unit estimator and views the REM as a weighted average of the within-and between-unit model. As we demonstrate in our empirical example, the ML estimator will give us the same estimates whether obtained via a classic FEM and REM in Stata or using SEM software. This suggests that the classic interpretations hold regardless of software used. However, as we depart from these classic procedures, this no longer will be true.\n7. MLEs are consistent, asymptotically unbiased, asymptotically normally distributed, asymptotically efficient among asymptotically unbiased estimators, and the inverse of the expected information matrix is available to estimate the asymptotic covariance matrix of the parameter estimator that we use for significance testing.\n8. A reviewer asked whether estimation with SEM requires any additional assumptions beyond the ones in classic FEM and REM. A variety of estimators are possible with the classic FEM and REM. However, given the variety of estimators and the generality of the models we present, the assumptions are less restrictive than the classic FEM and REM.\n9. Allison (2005) suggests that the SEM approach requires list-wise deletion, although given the context of his comments they probably refer to Proc Calis in SAS. However, direct MLE or multiple imputation are both options when using most other SEM software for panel data.\n10. These cutoffs are meant as rough guidelines. There are circumstances where different cutoffs might make sense. Nested and sometimes non-nested models are compared with these fit indices.\n11. Budig and England's (2001) analysis resulted in a final sample of 5,287 women.\n12. Budig and England also examined the wage penalty with three dichotomous measures indicating one child, two children, and three or more children. They find that the effects are monotonic, although not perfectly linear, and prefer the continuous indicator of number of children for all other analyses.\n13. We thank Michelle Budig for sharing with us the experience and seniority variables from the Budig and England (2001) analysis.\n14. A researcher could also use BIC tests on these covariances rather than conventional statistical significance tests. These would tend to be more conservative in finding noteworthy covariances. This approach nor ours takes into account the multiple tests of significance performed when examining each of these individual parameters. For this reason, the simultaneous tests of overall model fit reported in "}, {"section_title": "Appendix. Fixed and Random Effects Models as Structural Equation Models", "text": "Classic Fixed and Random Effects Models\nWe represent the standard FEM and REM in the following matrix equation:\nwhere \nThat is, we will exactly reproduce the means and covariance matrix of the observed variables by knowing the model parameter values and substituting them into \nwhere \u03a3 ww is the covariance matrix of the covariates in w and \u03a3 \u03b5\u03b5 is the covariance matrix of the disturbances (\u03b5).\nIn the usual FEM, we would drop z i from w i and the corresponding coefficients from \u0393, set B y 1 x 1 = B y 2 x 2 = ... = B y T x T , and make \u03a3 \u03b5\u03b5 a diagonal matrix with all elements of the main diagonal equal. The \u03a3 ww covariance matrix allows all covariates to correlate, including the latent time-invariant variable. For the usual REM, we can return z i to w i , but now we must constrain \u03a3 ww so that all covariances of h with x t and z are zero and we maintain the equality constraints on the coefficients so that B y 1 x 1 = B y 2 x 2 = ... = B y T x T and B y 1 z = B y 2 z = ... = B y T z . As explained in the text, we can easily test these restrictions in SEMs.\nThe Maximum Likelihood Estimator is the most widely used estimator in SEM software. The fitting function that incorporates the MLE is \nwhere S is the sample covariance matrix, \u014d is the vector of the sample means of the observed variables, p is the number of observed variables, \"ln\" is the natural log, |.| is the determinant, and tr is the trace of a matrix. The MLE estimator, \u03b8, is chosen so as to minimize F ML . Like all MLEs, \u03b8, has several desirable properties. It is consistent, asymptotically unbiased, asymptotically efficient, asymptotically normally distributed, and the asymptotic covariance matrix of \u03b8 is the inverse of the expected information matrix. The MLE estimator as implemented in F ML leads to a consistent estimator of all intercepts, means, coefficients, variances, and covariances in the model under a broad range of conditions. This means that in larger samples, the estimator will converge on the true parameters for valid models. However, if we wish to develop appropriate significance tests, then we need to make assumptions about the distributions of the observed variables. The usual assumption is that the observed variables come from a multivariate normal distribution. A slightly less restrictive distributional assumption that maintains the properties of the MLE and its significance tests is that the observed variables come from a multivariate distribution with no excess multivariate kurtosis (Browne 1984) . Multivariate skewness is permitted as long as the multivariate kurtosis does not differ from that of a normal distribution.\nFortunately, even when there is excess multivariate kurtosis there are a variety of alternative ways to obtain asymptotically accurate signficance tests including bootstrapping techniques (e.g., Bollen and Stine 1990, 1992) , corrected standard errors and chi-squares (e.g., Satorra and Bentler, 1994) , or arbitrary distribution estimators (e.g., Browne 1984) . See Bollen and Curran (2006) for further discussion and references. These options provide a broader range of choices than is true in the usual implementation of the standard FEM and REM."}, {"section_title": "Dynamic Fixed and Random Effects Models", "text": "In the econometric literature, \"dynamic\" models refers to the FEM and REM with lagged dependent variables included among the covariates. In the usual implementations, the lagged dependent variable model creates considerable difficulties and is the source of much discussion (see, e.g., Hsiao 2003) . Fortunately, these models are relatively straightforward in the SEM approach. A modification of equation (A1) permits lagged endogenous variables,\nwhere because of using a lagged dependent variable we need to redefine vectors to take account of treating the first time wave variable, y i1 , as predetermined and included among the other covariates and the presence of lagged y influences, so that In this model, y i1 is predetermined and uncorrelated with \u03b5 i as are the other covariates. However, there is a correlation between y i2 , \u2026, y iT and at least some elements of \u03b5 i (e.g., y i2 correlates with \u03b5 i2 ) so we need to consider all but the first wave (y i1 ) as endogenous.\nFor this model, the implied mean and covariance matrices become, \nFortunately, we can continue to use the ML fitting function in equation (A6) and the resulting estimator maintains the properties of an MLE under the precedingly described distributional assumptions and the corrected test statistics are also available when needed (see above). Autoregressive relations among the \u03b5 i disturbances combined with the autoregression of the y i s would complicate the situation, but are not discussed here."}]
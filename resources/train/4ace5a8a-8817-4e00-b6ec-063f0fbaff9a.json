[{"section_title": "Abstract", "text": "Abstract. Neurodegenerative diseases such as Alzheimer's disease present subtle anatomical brain changes before the appearance of clinical symptoms. Large longitudinal brain imaging datasets are now accessible to investigate these structural changes over time. However, manual structure segmentation is long and tedious and although automatic methods exist, they are often performed in a cross-sectional manner where each visit is analysed independently. With such analysis methods, bias, error and longitudinal noise may be introduced. Noise due to MR scanners and other physiological effects may also introduce variability in the measurement. We propose to use 4D non-linear registration with spatio-temporal regularization to correct for longitudinal inconsistency in the context of structure segmentation. The major contribution of this article is the individual template creation with spatio-temporal regularization of the deformation fields for each subject. We validate our method with different sets of real MRI data and demonstrate that spatially local temporal regularization yields more consistent rates of change of global structures resulting in better statistical power for detecting significant changes occurring between populations."}, {"section_title": "Introduction", "text": "MRI-based neuro-anatomical studies are often performed in a cross-sectional manner where each time-point is evaluated independently. Typically, brain morphometry comparison can be done by matching paired images (template-to-subject or subjectto-subject), where the deformation field is used for re-mapping atlas regions or for voxel-wise comparisons of anatomical changes such as deformation-based morphometry (DBM). However, in the context of longitudinal datasets, the robust estimation of anatomical changes is still challenging [6] . Indeed, if we assume that longitudinal changes are smoothly varying, spatially local, monotonic temporal processes, consideration of individual time-points independently can generate unneeded noisy longitudinal measurements due to the intrinsic noise associated with each visit. Different studies have shown the impact of MRI acquisition on structural measurements [7] and cortical thickness [8] . Therefore, methods, which integrate constraints from the temporal dimension (i.e., 4D methods), should produce more accurate, robust and stable measures of the longitudinal anatomical changes resulting in a more realistic estimation of temporal evolution.\nDifferent approaches have been proposed to overcome the complexity of anatomical 4D longitudinal data image analysis. In the context of clinical evaluation over a few years where anatomical changes are small and continuous, the use of 3D individual template targets have been proposed to perform non-linear registration [9] .\nMore sophisticated and mathematically proven approaches have been proposed in the context of larger anatomical changes over time (i.e. over the span of childhood). For example, a 4D population model creation using Gaussian kernel regression has been suggested by Davis et al. [10] where each image is registered independently to a moving average, avoiding creating explicit parameterized mode of the longitudinal changes. Kernel regression has also been used in the framework of the Large Deformation Diffeomorphic Metric Mapping (LDDMM) [11] [12] [13] , however, the complexity and computation burden for large datasets may limit their use. Regarding intra-subject 4D registration, Lorenzi et al. [14] have proposed 4D non-linear registration via a global 4D deformation optimization scheme in the Demons registration framework.\nTo compare anatomical differences, 3D population templates have proven their importance for different applications such as mapping (function, structure, vasculature, etc) [15] , volume estimation [16] and group comparisons [17] . While different techniques exist to create unbiased population templates for cross-sectional studies [18] [19] , few of these techniques have been developed for the creation of an individual subject 3D template. Reuter et al. created a 3D template for longitudinal analysis by computing the median of the linearly registered subject images [9] ..\nIn this article, a new method is proposed to analyze longitudinal MRI volumes by creating robust 3D individual templates for each subject through non-linear registration and local spatio-temporal regularization of 4D registration. We show that a local spatial constraint over time can have positive global effects to significantly reduce random noise in the measurement of structure volumes such as the lateral ventricles.\nhal-00740718, version 1 -10 Oct 2012"}, {"section_title": "2", "text": ""}, {"section_title": "Methods", "text": "In the following text, we consider all images to be in the same stereotaxic space (i.e., the space of an AD template [19] ) after going through the same standard preprocessing: non-uniformity correction [20], brain masking [21] , intensity normalization [22] and affine registration [23] . Similarly to a population template method, individual templates are obtained after averaging the co-registered scans in a hierarchical manner to a subject-specific minimum deformation template [24] , as described below and illustrated in Fig. 1 . The objective of the template creation algorithm is to find the non-linear transformations that minimize the anatomical shape differences between images to create the most representative average of the subject's anatomy. Therefore, to obtain an unbiased individual template, we need to optimize the non-linear transformation with respect to spatio-temporal constraints. While the spatial regularization accounts for smooth and diffeomorphic deformation between each time-point and the template, the temporal regularization enforces continuity in the time domain. In the following sections, the method and the notation for the template creation is inspired from Fonov et al. [19] , and the nomenclature is presented in Table 1 . Fig. 1 . Individual model template algorithm with spatial and temporal regularization. Nonlinear registration is computed pair-wise at each level between the MRI from each visit and the current average template. After convergence, the template is used as a registration target for the next level. Meanwhile, the temporal information of the subject visit allows for spatio-temporal regularization of the deformation fields.\nhal-00740718, version 1 -10 Oct 2012 "}, {"section_title": "Individual template creation", "text": "The implementation of the 4D non-linear registration is done in the framework of a 3D non-parametric vector field estimator, subject to certain regularity constraints. The non-linear deformation field is estimated in a hierarchical manner where the algorithm maximizes the local cross-correlation of the image intensity of the source images (i.e., the images ( ) \u03c8 is the non-linear transformation that maps the visit i at each voxel location v to current template. The nonlinear registration transformation is also spatially constrained with an elastic body model that minimizes the intensity difference of the paired images (i.e., between template and time point images). The elastic body constraints are justified in such intra-subject registration where large deformations are not expected. The parameters of the elastic regularizer are chosen to ensure that the transformation defined by the vectors is smooth, bijective and invertible.\nThe deformation constraint removes bias by minimizing the sum of all deformations for all time points:\nhal-00740718, version 1 -10 Oct 2012"}, {"section_title": "Spatio-temporal regularization", "text": "The final constraint for the nonlinear registration is performed in the spatio-temporal domain in order to obtain a smooth non-linear deformation over time, since we expect the anatomical changes to happen in a continuous fashion. Therefore, to create a smooth longitudinal deformation field, we perform a local linearization of the deformation fields in the local neighbourhood \u2126 v and linear regression in time of the zeroth order component ( Figure 2 provides a simplified diagram of the spatio-temporal regularization process. hal-00740718, version 1 -10 Oct 2012"}, {"section_title": "Optimization and convergence", "text": "The optimization is performed at 3 hierarchical levels, starting with deformations estimated every 8mm, then every 4mm and finally, every 2mm. At each level, the regularizations are performed consecutively in the order of equations 2 and 3. Also, the template and deformation fields estimated at one hierarchical level are used to initialize the procedure at the next successive hierarchical level. In previous studies, we found that 4 iterations are enough for the convergence of the iterative process at each hierarchical level [19] ."}, {"section_title": "Experiments", "text": "The proposed method, temporal bi-linear regularization with individual template (TWT), is compared to two more classical approaches using the same 3D nonlinear registration framework. The first approach, cross-sectional (CS), is a direct non-linear registration of each time point independently within the common stereotaxic space (AD template) without using any longitudinal information or constraints [16] . The second approach, cross-sectional with individual template (CSWT), creates a subjectspecific template from all time points, but no temporal regularization stage is performed. This will enable us to evaluate the contribution of temporal regularization. In order to evaluate the stability, regularity, continuity and bias of the proposed approach, we choose to perform ventricular segmentation for each subject at each time point. Ventricular enlargement is often used as a surrogate of brain atrophy, believed to represent the progression of neurodegenerative processes as in MS or AD [25] . In addition, ventricular segmentation is relatively straightforward due to the high contrast between brain tissue and CSF, and as such should not add unwanted variance to the analysis, as would be the case if more subtle structures such as the hippocampus or entorhinal cortex were used as a test structure.\nFor each method, the manually segmented lateral ventricles of the AD template are then propagated back to each 3D image for each time-point by concatenation of the required transforms to avoid blurring due to multiple interpolations. Better techniques, more accurate and sensitive to perform ventricular segmentation exist, as described by Apostolova et al. [26] , but our goal is to show the longitudinal performance and consistency of our approach."}, {"section_title": "Data", "text": "Two datasets were used to evaluate the proposed algorithm. First, to evaluate stability and potential bias, a scan-rescan database of 20 healthy subjects scanned 4 times within the same week (twice the first session and once during 2 different days). The subject was taken out from the scanner before getting back in for each rescan session.\nNo ventricular volume change is expected in this case. The T1-weighted MRI images were acquired on a 1.5T SIEMENS MRI scanner with a 3-D spoiled gradient echo (GRE) sequence (TR=22ms, TE=9.2ms, flip=30 o ).\nSecond, to evaluate the algorithm where change is expected, T1-weighted images from the ADNI study were used. The experiment was performed using all subjects that had 4 visits (0, 6, 12 and 24 months) yielding groups of 177 normal controls (NC), 200 mild cognitive impaired (MCI) and 108 AD patients. Figure 3 shows the temporal distribution of ventricular volume changes between the cross-sectional (CS, and CSWT) and the longitudinal technique (TWT) for the repeated sessions, and where the first session is used as a reference. As expected, the longitudinal regression reduces the variability of volume changes between successive acquisitions. The individual template created with the CSWT approach presents less variability than the segmentations produced with the CS technique. The comparisons of the variances (ANOVA) revealed significant differences between the different sessions only with the CS approach (p-value<0.05). Figure 4 shows the percentage of ventricular volume change for each group (NC, MCI and AD) where the first visit is used as a reference (i.e., percent change from baseline is plotted). While the trend of ventricular enlargement is similar between the methods, we can observe the net decrease of variability with the TWT method."}, {"section_title": "Results", "text": ""}, {"section_title": "Scan-rescan dataset", "text": ""}, {"section_title": "Longitudinal database from ADNI", "text": "Smaller longitudinal variability should improve the statistical power to detect group differences and thus reduce the number of subjects required for a clinical trial. For example, in order to detect at least a 25% reduction in the annualized rate of ventricular enlargement in the AD group, the TWT approach requires half as many subjects than the standard cross-sectional method (see Table 1 ). Table 2 . Sample size needed (for treated and placebo groups) to detect a 25% reduction in the annualized rate of ventricular growth in the AD group, with a one-sided test and \u03b1 = 0.05 at 80% and 90% power using the cross-sectional and the two longitudinal approaches. Note that the TWT method requires roughly half as many subjects when compared to the CS method. Figure 5 shows the TWT-segmented ventricles and the Jacobian determinant of the deformations estimated (from template to time-point, and not from time-point to baseline image) with the 3 methods for an AD patient over the 24-month period. Note that the average Jacobian determinant of the individual visits has been subtracted from the CS Jacobian map to remove the AD template-to-individual deformation and keep only the longitudinal deformation component for comparability with the CSWT and TWT Jacobian maps."}, {"section_title": "CS", "text": ""}, {"section_title": "Fig. 5.", "text": "Ventricle segmentations, templates and deformation fields. First row represents the ventricular segmentation performed by the TWT approach. The ventricle increases from 64cc to 70cc in the 24m period. The next row shows the AD template used as a stereotaxic space for CS. The following two rows shows the individual template computed with CSWT and TWT. At each visit, the determinant of the visit-to-template deformation's Jacobian (in blue (larger than template) -red (smaller than template)) is overlaid onto the subject T1W axial image (in grey).\nFirst, we can note that there are large local deformations near the cortex and in some regions of the parenchyma in the CS results, probably due to mismatch with the AD population template (left side) used by the CS method. Furthermore, there are multiple punctuate shrinking and enlarging regions within the ventricles that are not consistent with the notion of gradual ventricular growth. By using a subject-specific template in the CSWT and TWT methods (leftmost image, bottom two rows), there are no large local deformations in the parenchyma or cortex. The CSWT and TWT maps present globally smooth progressive Jacobian changes over time, with much less heterogeneity compared to the CS approach. Surprisingly, the CSWT Jacobians are quite consistent over time. However, there are non-null deformations recovered at the 12 month time point where the individual should be similar to the subject-specific average template."}, {"section_title": "Discussion and conclusion", "text": "In this article, we presented a new approach for the estimation of individual longitudinal changes using unbiased individual subject-specific templates and spatiotemporal regularization. The robust estimation of the deformations is obtained using an unbiased individual template approach, minimizing deformations between subject visits. Meanwhile, a local spatio-temporal regularization is achieved with bi-linear regression of the deformation field and its Jacobian matrices. The regression of the decomposition enables a temporal regularization at a voxel and local neighbourhood level.\nExperiments on real data reveal increased stability in estimating individual changes over time compared to standard cross-sectional approaches. The longitudinal regularization of the deformation at a local level reduces the longitudinal noise at the global/structural level, while the hierarchical iterative process produces a robust individual template that allows for better anatomical matching across time in an individual.\nIn this study, the small number of time points limits the use of more complex longitudinal regression models. In the future other models of temporal regularization regression will be investigated.\nAn important aspect of longitudinal clinical and research studies is the cost of recruiting and scanning subjects for multiple visits. Adapted longitudinal analysis techniques, such as the one proposed here, will allow for better power to detect differences between groups, and thus will lead to the reduction of the number of subjects required for research and for clinical trails. Conversely, such methods could also shorten the time needed to achieve significant results."}]
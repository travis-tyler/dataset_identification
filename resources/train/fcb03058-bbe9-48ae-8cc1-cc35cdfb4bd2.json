[{"section_title": "Abstract", "text": "Abstract. The purpose of this study is to characterize the neuroanatomical variations observed in neurological disorders such as dementia. We do a global statistical analysis of brain anatomy and identify the relevant shape deformation patterns that explain corresponding variations in clinical neuropsychological measures. The motivation is to model the inherent relation between anatomical shape and clinical measures and evaluate its statistical significance. We use Partial Least Squares for the multivariate statistical analysis of the deformation momenta under the Large Deformation Diffeomorphic framework. The statistical methodology extracts pertinent directions in the momenta space and the clinical response space in terms of latent variables. We report the results of this analysis on 313 subjects from the Mild Cognitive Impairment group in the Alzheimer's Disease Neuroimaging Initiative (ADNI)."}, {"section_title": "Introduction", "text": "In previous work, Large Deformation Diffeomorphic Metric Mapping (LDDMM) has been extensively used for the characterization of anatomical changes associated with various diseases [1] , including the analysis of changes in anatomy with normative aging [2] . Most of the earlier studies on characterization of neuroanatomical changes have focused on the statistical analysis of deformation maps either using the associated Jacobian of the transformations, as in the now ubiquitous deformation-based morphometry [3] , or directly by the analysis of the displacement maps. In this article we present a multivariate analysis of diffeomorphic transformations of the whole brain for relating complex anatomical changes observed in the population with neuropsychological responses, such as clinical measures of cognitive abilities, audio-verbal learning and logical memory. Contemporary studies using large deformation diffeomorphic transformations have focused on the characterization of group differences in the shape of specific substructures such as the hippocampus [4] .\nIn this paper we consider the Mild Cognitive Impairment (MCI) subjects as a continuous class rather than a discrete class. Using Partial Least Squares (PLS), we study the covariance of the anatomical structures in the entire brain volume without any segmentation or a priori regions of interest indentification. The purpose of this study is to extract and identify shape deformation patterns in brain anatomy that relate to observed clinical scores depicting cognitive abilities. We show in our results that anatomical measures, such as cortical thickness and hipocampal volume, used in previous studies of Alzheimer's and related dementia emerge naturally as the result of our analysis."}, {"section_title": "Technical Background", "text": "Fundamental to the study of the anatomical variation in a population is the construction of transformations, mapping one anatomical image to another, commonly referred to as registration maps. Conventionally, anatomical variation has been studied by generating transformation maps between each subject in the population using a pre-selected anatomical template. In contrast to this approach, we study anatomical variation by simultaneously generating transformations between the entire population and a common reference coordinate system. Several authors suggested this idea of nonlinear averaging of shapes for the construction of mean anatomical image or the \"atlas\" representing the entire population. Avants et. al [5] proposed an energy minimization algorithm employing the diffeomorphic constraints on the average transformation. Cootes et. al [6] emphasized the notion of dense correspondences across group of images using diffeomorphic functions to optimize a groupwise objective function. In this paper, we follow the unbiased atlas construction approach introduced by Joshi et. al [7] under the large deformation diffeomorphic setting. As the properties of large deformation diffeomorphic transformations and atlas construction are fundamental to our analysis we briefly review it here, for a detailed analysis we refer the reader to a comprehensive review by Younes et. al [8] and references therein."}, {"section_title": "Riemannian Metric, Atlas Construction, and Momenta Maps", "text": "Riemannian Metric. Diffeomorphic transformations of the underlying coordinate space \u03a9 are invertible transformations which are continuously differentiable with a differentiable inverse. This definition implies that the set of all diffeomorphisms of \u03a9 has a group structure. A convenient and natural machinery for generating diffeomorphic transformations is by the integration of ordinary differential equations (ODE) on \u03a9 defined via the smooth time indexed velocity vector fields v(t, y) :\ngiven by the solution of the ODE dy dt = v(t, y) with the initial condition y(0) = x defines a diffeomorphism of \u03a9. One defines a Riemannian metric on the space of diffeomorphisms by inducing an energy via a Sobolev norm with the partial differential operator L on these velocity fields. The distance between the identity transformation and a diffeomorphism \u03c8 is defined as the minimization\nThe distance between any two diffeomorphism is defined as\nAtlas Construction. This Riemannian metric defined on the space of diffeomorphisms can now be used to compute a deformation that matches two images. The deformation \u03c6 is defined as the 'optimal' time-varying velocity fieldv, based on the minimum energy criteria:\nwhere the second term allows inexact matching, and \u03c3 is a free parameter controlling the tradeoff between exactness of the match and smoothness of the velocity fields. Now, given a collection of anatomical images {I i , i = 1, \u00b7 \u00b7 \u00b7 , N}, the minimum mean squared energy atlas construction problem is that of jointly estimating an image\u00ce and N individual deformations:\nThe implementation details are described in greater detail in Section 3.\nMomenta Maps. The joint minimizer of the atlas construction problem (2) estimates an atlas image\u00ce while simultaneously solving the N LDDMM image matching problems. An important consequence of this is that the EulerLagrange equations associated with the LDDMM problem coincides with the Euler-Lagrange equations of geodesics on the group of diffeomorphisms. As shown in Younes et. al [8] the geodesic equations are completely determined via the initial momenta Lv 0 and furthermore it is in direction of the gradient of deforming image. This implies that for the atlas matching problem above, at the minimizer, for each of the N image matching problems the initial velocity is given by the equation\nThe quantity a i 0 (x)\u2207\u00ce(x) is referred to as the initial momenta. Each of the i = 1, \u00b7 \u00b7 \u00b7 , N geodesic equations evolve according to\nEquation (5) is the infinitesimal action of the velocity field v i on the image, while (4) is the conservation of momenta."}, {"section_title": "Multivariate Analysis with Partial Least Squares", "text": "Traditionally, Partial Least Squares (PLS) has been used to characterize pertinent directions between independent variable and dependent variable in a high dimensional multivariate regression setting. This approach to multivariate analysis using PLS was introduced in the neuroimaging community by Bookstein [9] with a detailed review by McIntosh et. al [10] and refrences therein. We now adapt the PLS methodology for the purpose of extracting and identifying deformation patterns in brain anatomy that relate to k observed clinical measures y i \u2208 R k depicting cognitive and neuropsychological responses of each of the i = 1, \u00b7 \u00b7 \u00b7 , N subjects. As described above, the anatomical variation in the collection of I i is captured by the initial scalar momenta maps (a i (x)) at the atla\u015d I. These momenta maps govern the deformation of the atlas along the geodesic in the group diffeomorphism towards the respective individual images I i . Analogous to the classical PLS, we find directions\u00e2 in the momenta space, defined at the atlas in terms of deformation momenta a i 's, and directions\u0177 in the clinical response space, defined by y i 's that explain their association in the sense of their common variance. We propose to extract these directions such that initial momenta when projected on to\u00e2 and the corresponding clinical responses when projected on to\u0177 have maximum covariance. We call these projections latent variables, l a and l y respectively.\nTo find the anatomical variation that covaries maximally with clinical responses, we perform PLS analysis between the scalar momenta fields a i and the response space y i . The PLS problem is given by:\nThe subsequent directions are found by removing the component extracted (deflating the data) both in momenta space and the clinical response space as:\nThe solution to the above maximization problem (6) is the Singular Value Decomposition (SVD) of the covariance matrix of the dependent and independent variables. The corresponding direction vectors\u00e2's and\u0177's are the respective left and right singular vectors. The successive latent variables l a 's and l y 's are computed once by a single SVD.\nStatistical Significance. The statistical significance of the directions extracted by PLS analysis can be assessed using the projected data (the latent variables) l a 's and l y 's. We use non-parametric permutation tests for calculating the significance of the regression of l y 's on l a 's and use the R 2 (the proportion of variance explained in l y 's by l a 's) as the test statistics. The distribution of the R 2 statistic under the null hypothesis is calculated by randomly reordering the momenta and clinical response association and then recalculating the new SVD and its associated R 2 each time. The significance of a particular latent variable is measured by the p-value from the empirical distribution."}, {"section_title": "Computational Framework", "text": "Two main challenges exist in implementing the LDDMM atlas building framework: the intensive computational cost and large memory requirements. Even with a very low-resolution time discretization, and efficient multithreaded implementation atlas generation for a set of 84 MRI brain images with a resolution of 144 \u00d7192 \u00d7160 takes approximately 10 hours on a high-end 32-core shared memory machine and uses approximately 50GB of memory. This makes parameter tuning and cross-validation schemes impractical, and limits the size of the population for which an atlas can reasonably be generated. The target of this study is the analysis of 313 MCI subjects from the ADNI data sets and on a single machine would require 200GB of memory and 40 hours of computation time for a single run.\nEquation (2) can be efficiently solved using a parallel alternating algorithm by interleaving the updates of the optimal deformations and the the estimate of the atlas image\u00ce. For a fixed atlas image\u00ce the N individual deformations are updated by performing a gradient step of (1) using the algorithm of Beg et. al [11] . These deformations are completely independent of each other, naturally yeilding to a distributed memory implementation. Further, the parallel nature of many of the image processing algorithms used in the deformation update process lends themselves to an efficient and massively parallel GPU-based implementation. An implementation of LDDMM atlas building for use on a GPU computing cluster was therefore developed based on MPI and the GPU image processing framework by Ha et. al [12] . Individual deformation calculations are distributed across computing nodes, and nodes further distribute deformation calculations among GPUs. In this manner the only inter-GPU and inter-node communication required is in the atlas update step. Inter-GPU atlas computation is done in host (node) shared memory, and inter-node atlas computation is efficiently done by a parallel-reduce summation MPI call.\nThe GPU cluster used consists of 64 8-core computing nodes and 32 NVIDIA Tesla s1070 computing servers, each containing four GPUs. Each node controls two of the four GPUs contained in a s1070. Communication from the host to the GPU is via external x16 PCIe bus, and inter-node communication is through a 20Gbit/s 4x DDR infiniband interconnect. Using 42 nodes of the GPU cluster, the resulting implementation generated the atlas of the population of 313 brain images in under 40 minutes. This represents a speed up of an order of magnitude."}, {"section_title": "Results", "text": "313 patients with mild cognitive impairment (MCI) were selected from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database. The T1 weighted, bias field corrected and N3 scaled structural Magnetic Resonance Images (MRI) and the selected neuropsychological data were downloaded from ADNI. Two global cognitive and functional assessment test were used. The first was the Clinical Dementia Rating scale, Sum of Boxes (cdr.sb). The second test was the modified Alzheimer's Disease Assessment Scale modified cognitive battery (adas-cog), which includes delayed word recall and number cancellation. Episodic memory was assessed using the Rey Auditory Verbal Learning Test (AVLT) and the Logical Memory test of the Wechsler Memory Scale-Revised. Both memory tests had immediate recall (avlt.imm, logic.imm) and 30 minute delayed recall (avlt.del, logic.del). Note the AVLT used the immediate recall after the 5th learning trial. Preprocessing the MRI involved skull stripping and registration to talairach coordinates using freesurfer [13] . Tissue-wise intensity normalization for white matter, gray matter and cerebrospinal fluid was performed using the expectation maximization (EM) based segmentation followed by the piecewise polynomial histogram matching algorithm.\nData Processing Details. The atlas was constructed with the 313 MCI subjects on the GPU cluster and the associated initial momenta fields a i were computed. Each p dimensional a i (i = 1, \u00b7 \u00b7 \u00b7 , 313 , p = 144\u00d7192\u00d7160) represents a row of a large 313 \u00d7 p matrix X of momenta maps. The corresponding k dimensional clinical outcome y i (i = 1, \u00b7 \u00b7 \u00b7 , 313 and k = 6) populates the rows of the 313 \u00d7 6 matrix Y of clinical outcomes. The PLS was then performed on X and Y data matrices. The significance tests for the extracted momenta direction and the clinical response directions was performed using 100,000 permutations. Visualization of geodesic shooting. In our initial study we found that latent variables 1 and 6 (LV1 and LV6) had the lowest p-values with latent variable 6 being highly significant (p-value=0.005). We analyzed the extracted deformation directions for LV1 and LV6, owing to their low p-value, by evolving the atlas image\u00ce along the geodesic in the corresponding projected momenta directions (\u00e2) and interpreting the association with the directions extracted in their clinical response counterparts (\u0177). The initial momenta direction was scaled to the maximum of the projections of all the momenta over the population of 313 images (along LV1 and LV6). The log Jacobians of the deformation, overlayed on atlas image\u00ce, resulting from shooting\u00ce along the geodesic with this momenta are shown in Fig. 1 and Fig. 2 respectively. The selected slices from this 3D overlay shown here capture relevant regions of the neuro-anatomical structures, such as hippocampus and ventricles, pertinent to cognitive impairment in Alzheimer's and related dementia. Fig. 3 displays the axial and sagittal slices of the 3D MRI deforming brain from the atlas along the geodesic for the equal intervals, t, both in the positive and the negative LV1 direction (t = 0 correspond to the atlas image,\u00ce). "}, {"section_title": "Discussion", "text": "The major contribution of this article is that the shape deformation patterns in anatomical structures show up evidently as a result of the PLS analysis of the momenta."}, {"section_title": "LV1:", "text": "We notice the expansion of lateral ventricles and CSF, together with the shrinkage of cortical surface along LV1 ( Fig. 1 and Fig. 3 ). The corresponding neuropsychological clinical response direction is that of increasing adas-cog and cdr.sb (measures of increasing cognitive degeneration) and decreasing AVLT and logical scores (measures of audio verbal learning and logical memory). Another critical observation is the clearly evident shrinkage of the hippocampus and cortical and sub-cortical gray matter along these directions. Such patterns of atrophy are well known to characterize the disease progression in AD and related dementia."}, {"section_title": "LV6:", "text": "The highly statistically significant LV6 explains an altogether independent set of anatomical deformation patterns that relate to corresponding patterns in audio-verbal learning scores and memory scores (immediate and delayed recall). The LV6 mainly explains deformations for learning and memory, owing to high absolute weights for AVLT and logic scores but very low weights to adas.cog and cdr.sb. The deformation patterns in anatomy Fig. (2) show almost invarying hippocampal region well know to be important to memory formation. This observation has to our knowledge, never been reported before and we are studying further the medical importance of this finding."}]
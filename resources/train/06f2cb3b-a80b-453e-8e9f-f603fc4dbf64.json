[{"section_title": "Abstract", "text": "The establishment of image correspondence through robust image registration is critical to many clinical tasks such as image fusion, organ atlas creation, and tumor growth monitoring and is a very challenging problem. Since the beginning of the recent deep learning renaissance, the medical imaging research community has developed deep learning-based approaches and achieved the state-of-the-art in many applications, including image registration. The rapid adoption of deep learning for image registration applications over the past few years necessitates a comprehensive summary and outlook, which is the main scope of this survey. This requires placing a focus on the different research areas as well as highlighting challenges that practitioners face. This survey, therefore, outlines the evolution of deep learning-based medical image registration in the context of both research challenges and relevant innovations in the past few years. Further, this survey highlights future research directions to show how this field may be possibly moved forward to the next level."}, {"section_title": "Introduction", "text": "Image registration is the process of transforming different image datasets into one coordinate system with matched imaging contents, which has significant applications in medicine. Registration may be necessary when analyzing a pair of images that were acquired from different viewpoints, at different times, or using different sensors/modalities [41, 122] . Until recently, image registration was mostly performed manually by clinicians. However, many registration tasks can be quite challenging and the quality of manual alignments is highly dependent upon the expertise of the user, which can be clinically disadvantageous. To address the potential shortcomings of manual registration, automatic registration has been developed. Although other methods for automatic image registration have been extensively explored prior to ( [4] . Ever since the success of AlexNet in the Ima-geNet challenge of 2012 [3] , deep learning has allowed for state-of-the-art performance in many computer vision tasks including, but not limited to: object detection [84] , feature extraction [37] , segmentation [87] , image classification [3] , image denoising [112] , and image reconstruction [115] .\nInitially, deep learning was successfully used to augment the performance of iterative, intensity-based registration [18, 36, 96] . Soon after this initial application, several groups investigated the intuitive application of reinforcement learning to registration [62, 71, 76] . Further, demand for faster registration methods later motivated the development of deep learning-based one-step transformation estimation techniques and challenges associated with procuring/generating ground truth data have recently motivated many groups to develop unsupervised frameworks for onestep transformation estimation [23, 61] . One of the hurdles associated with this framework is the familiar challenge of image similarity quantification [38, 106] . Recent efforts that use information theory-based similarity metrics [23] , segmentations of anatomical structures [44] , and generative adversarial network-like frameworks [30] to address this challenge have shown promising results. Figure 1 shows the various categorizations of different deep learning-based registration methods. On the other hand, Fig. 2 shows the observed growing interest in deep Figs. 1 and 2 suggest, this field is moving very quickly to surmount the hurdles associated with deep learningbased medical image registration and several groups have already enjoyed significant successes for their applications [44, 65, 96] . Therefore, the purpose of this article is to comprehensively survey the field of deep learning-based medical image registration, highlight common challenges that practitioners face, and discuss future research directions that may address these challenges. Deep learning belongs to a class of machine learning that uses neural networks with a large number of layers to learn representations of data [34, 91] . When discussing neural networks, it is important to provide insight into the different types of neural networks that can be used for various applications, the notable architectures that were recently invented to tackle engineering problems, and the variety of strategies that are used for training neural networks. Therefore, this deep learning introduction section is divided into three sections: neural network types, network architectures, and training paradigms and strategies. Note that there are many publicly available libraries that can be used to build the networks described in the section, for example Tensor-Flow [1] , MXNet [16] , Keras [20] , Caffe [49] , and PyTorch [82] . Detailed discussion of deep learning-based medical image analysis and various deep learning research directions is outside of the scope of this article. Comprehensive [59, 63] , reinforcement learning [51] , and the application of GANs to medical image analysis [52] are recommended to the interested readers. In this article, the surveyed methods were divided into the following three categories: Deep Iterative Registration, Supervised Transformation Estimation, and Unsupervised Transformation Estimation. Following a discussion of the methods that belong to each of the aforementioned categories, future research directions and current trends are discussed in Sect. 6."}, {"section_title": "Deep iterative registration", "text": "Automatic intensity-based image registration requires both a metric that quantifies the similarity between a moving image and a fixed image and an optimization algorithm that updates the transformation parameters such that the similarity between the images is maximized. Prior to the deep learning renaissance, several manually crafted metrics were frequently used for such registration applications, including: sum of squared differences (SSD), cross-correlation (CC), mutual information (MI) [72, 106] , normalized crosscorrelation (NCC), and normalized mutual information (NMI). Early applications of deep learning to medical image registration are direct extensions of the intensity-based registration framework [96, 109, 110] . Several groups later used a reinforcement learning paradigm to iteratively estimate a transformation [55, 62, 71, 76] because this application is more consistent with how practitioners perform registration. A description of both types of methods is given in Table 1 . We will survey earlier methods that used deep similaritybased registration in Sect. 2.1 and then some more recently developed methods that use deep reinforcement learningbased registration in Sect. 2.2."}, {"section_title": "Deep similarity-based registration", "text": "In this section, methods that use deep learning to learn a similarity metric are surveyed. This similarity metric is inserted into a classical intensity-based registration framework with a defined interpolation strategy, transformation model, and optimization algorithm. A visualization of this overall framework is given in Fig. 3 . The solid lines represent data flows that are required during training and testing, while the dashed lines represent data flows that are required only during training. Note that this is the case for the remainder of the figures in this article as well."}, {"section_title": "Overview of works", "text": "Although manually crafted similarity metrics perform reasonably well in the unimodal registration case, deep learning has been used to learn superior metrics. This section will first discuss approaches that use deep learning to augment the performance of unimodal intensity-based registration pipelines before multimodal registration. Wu et al. [109, 110] were the first to use deep learning to obtain an application-specific similarity metric for registration. They extracted the features that are used for unimodal, deformable registration of 3D brain MR volumes using a convolutional-stacked autoencoder (CAE). They subsequently performed the registration using gradient descent to optimize the NCC of the two sets of features. This method outperformed diffeomorphic demons [104] and HAMMER [94] -based registration techniques.\nSeveral registration application requires deformable transformation models that often prohibit the use of traditional convolutional neural networks because of the computational expense associated with using FC-layers to make predictions in highly dimensional solution spaces [55] . Because the networks that are used to predict deformation fields are fully convolutional, the dimensionality of the solution space associated with a deformation field does not introduce additional computational constraints [114] . This section will first discuss approaches that use a rigid transformation model and then discuss approaches that use a deformable transformation model.\nFirst, this section will discuss methods that use dual supervised and then will discuss methods that use weak supervision. Recently, Fan et al. [31] used hierarchical, dualsupervised learning to predict the deformation field for 3D brain MR registration. They amend the traditional U-Net architecture [87] by using \"gap-filling\" (i.e., inserting convolutional layers after the U-type ends or the architecture) and coarse-to-fine guidance. This approach leveraged both the similarity between the predicted and ground truth transformations, and the similarity between the warped and fixed images to train the network. The architecture detailed in this method outperformed the traditional U-Net architecture, and the dual supervision strategy is verified by ablating the image similarity loss function term. A visualization of dual-supervised transformation estimation is given in Fig. 6 . On the other hand, Yan et al. [111] used a framework that is inspired by the GAN [35] to perform the rigid registration of 3D MR and TRUS volumes. In this work, the generator was trained to estimate a rigid transformation. While, the discriminator was trained to discern between images that were aligned using the ground truth transformations and images that were aligned using the predicted transformations. Both Euclidean distance to ground truth and an adversarial loss term are used to construct the loss function in this method. Note that the adversarial supervision strategy that was used in this approach is similar to the ones that are used in a number of unsupervised works that will be described in the next sec- Fig. 7 .\nUnlike the above methods that used dual supervision, Hu et al. [43, 44] recently used label similarity to train their network to perform MR-TRUS registration. In their initial work, they used two neural networks: local-net and globalnet to estimate the global affine transformation with 12 degrees of freedom and the local dense deformation field, respectively [43] . The local-net uses the concatenation of the transformation of the moving image given by the globalnet and the fixed image as its input. However, in their later work [44] , they combine these networks in an end-to-end framework. This method outperformed NMI-optimizationbased and NCC-based registration. A visualization of weakly supervised transformation estimation is given in Fig. 8 . In another work, Hu et al. [42] simultaneously maximized label similarity and minimized an adversarial loss term to predict the deformation for MR-TRUS registration. This regularization term forces the predicted transformation to result in the generation of a realistic image. Using the adversarial loss as a regularization term is likely to successfully force the transformation to be realistic given proper hyper parameter selection. The performance of this registration framework was inferior to the performance of their previous registration framework described above. However, they showed that adversarial regularization is superior to standard bending energy-based regularization. Similar to the above method, Hering et al. [40] built upon the progress made with respect to both dual and weak supervision by introducing a label and similarity metric-based loss function for cardiac motion tracking via the deformable registration of 2D cine-MR images. Both segmentation overlap and edge-based normalized gradient fields distance were used to construct the loss function in this approach. Their method outperformed a multilevel registration approach similar to the one proposed in [88] ."}, {"section_title": "Unimodal registration", "text": "Recently, Eppenhof et al. [29] estimated registration error for the deformable registration of 3D thoracic CT scans (inhale-exhale) in an end-to-end capacity. They used a 3D CNN to estimate the error map for inputted inhale-exhale \nYoo et al. [117] used an STN to register serial-section electron microscopy images (ssEMs). An autoencoder is trained to reconstruct fixed images and the L2 distance between reconstructed fixed images and corresponding warped moving images is used along with several regularization terms to construct the loss function. This approach outperforms the bUnwarpJ registration technique [5] and the Elastic registration technique [89] . In the same year, Liu et al. [67] proposed a tensor-based MIND method using a principle component analysis-based network (PCANet) [14] for both unimodal and multimodal registration. Both inhale-exhale pairs of thoracic CT volumes and multimodal pairs of brain MR images are used for experimental validation of this approach. MI-and residual complexity (RC)-based [79] , and the original MIND-based [38] registration techniques were outperformed by the proposed method.\nKrebs et al. [56, 57] performed the registration of 2D brain and cardiac MRs and bypassed the need for spatial regularization using a stochastic latent space learning approach. A conditional variational autoencoder [25] is used to ensure that the parameter space follows a prescribed probability distribution. The negative log likelihood of the fixed image given the latent representation and the warped volume and KL divergence of the latent distribution from a prior distribution is used to define the loss function. This method outperforms the Demons technique [69] and the deep learning method described in [8] ."}, {"section_title": "Moving Image", "text": "Image Resampler pairs of thoracic CT scans. Like the above method, only learned features were used in this work.\nInstead, Blendowski et al. [10] proposed the combined use of both CNN-based descriptors and manually crafted MRFbased self-similarity descriptors for lung CT registration. Although the manually crafted descriptors outperformed the CNN-based descriptors, optimal performance was achieved using both sets of descriptors. This indicates that, in the unimodal registration case, deep learning may not outperform manually crafted methods. However, it can be used to obtain complementary information."}, {"section_title": "Multimodal registration", "text": "The advantages of the application of deep learning to intensity-based registration are more obvious in the multimodal case, where manually crafted similarity metrics have had very little success.\nCheng et al. [17, 18] recently used a stacked denoising autoencoder to learn a similarity metric that assesses the quality of the rigid alignment of CT and MR images. They showed that their metric outperformed NMI-optimizationbased and local cross-correlation (LCC)-optimization-based for their application.\nIn an effort to explicitly estimate image similarity in the multimodal case, Simonovsky et al. [96] used a CNN to learn the dissimilarity between aligned 3D T1 and T2 weighted brain MR volumes. Given this similarity metric, gradient descent was used in order to iteratively update the parameters that define a deformation field. This method was able to outperform MI-optimization-based registration and set the stage for deep intensity-based multimodal registration.\nAdditionally, Sedghi et al. [92] performed the rigid registration of 3D US/MR (modalities with an even greater appearance difference than MR/CT) abdominal scans by using a 5-layer neural network to learn a similarity metric that is then optimized by Powell's method. This approach also outperformed MI-optimization-based registration.\nHaskins et al. [36] learned a similarity metric for multimodal rigid registration of MR and transrectal US (TRUS) volumes by using a CNN to predict target registration error (TRE). Instead of using a traditional optimizer like the above methods, they used an evolutionary algorithm to explore the solution space prior to using a traditional optimization algo-rithm because of the learned metric's lack of convexity. This registration framework outperformed MIND-optimizationbased [38] and MI-optimization-based registration.\nIn stark contrast to the above methods, Wright et al. [75] used LSTM spatial co-transformer networks to iteratively register MR and US volumes group-wise. The recurrent spatial co-transformation occurred in three steps: image warping, residual parameter prediction, parameter composition. They demonstrated that their method is more capable of quantifying image similarity than a previous multimodal image similarity quantification method that uses self-similarity context descriptors [39] .\nUnlike all of the other methods described in this section, Kori et al. perform feature extraction and affine transformation parameter regression for the multimodal registration of 2D T1 and T2 weighted brain MRs in an unsupervised capacity using pre-trained networks [54] . The images are binarized, and then, the Dice score between the moving and the fixed images is used as the cost function. As the appearance difference between these two modalities is not significant, the use of these pre-trained models can be reasonably effective."}, {"section_title": "Discussion and assessment", "text": "Recent works have confirmed the ability of neural networks to assess image similarity in multimodal medical image registration. The results achieved by the approaches described in this section demonstrate that deep learning can be successfully applied to challenging registration tasks. However, the findings from [10] suggest that learned image similarity metrics may be best suited to complement existing similarity metrics in the unimodal case. Further, it is difficult to use these iterative techniques for real-time registration.\nSupervised transformation estimation has allowed for realtime, robust registration across applications. However, such works are not without their limitations. Firstly, the quality of the registrations using this framework is dependent on the quality of the ground truth registrations. The quality of these labels is, of course, dependent upon the expertise of the practitioner. Furthermore, these labels are fairly difficult to obtain because there are relatively few individuals with the expertise necessary to perform such registrations. Transformations of training data and the generation of synthetic ground truth data can address such limitations. However, it is important to ensure that simulated data is sufficiently similar to clinical data. These challenges motivated the development of partially supervised/unsupervised approaches, which will be discussed next.\nDirect transformation estimation marked a major breakthrough for deep learning-based image registration. With full supervision, promising results have been obtained. However, at the same time, those techniques require a large amount of detailed annotated images for training. Partially/weakly supervised transformation estimation methods alleviated the limitations associated with the trustworthiness and expense of ground truth labels. However, they still require manually annotated data (e.g., ground truth and/or segmentations). On the other hand, weak supervision allows for similarity quantification in the multimodal case. Further, partial supervision allows for the aggregation of methods that can be used to assess the quality of a predicted registration. As a result, there is growing interest in these research areas.\nImage similarity-based unsupervised image registration has received a lot of attention from the research community recently because it bypasses the need for expert labels of any kind. This means that the performance of the model will not depend on the expertise of the practitioner. Further, extensions of the original similarity metric-based method that introduce more sophisticated similarity metrics (e.g., the discriminator of a GAN) and/or regularization strategies have yielded promising results. However, it is still difficult to quantify image similarity for multimodal registration applications. As a result, the scope of unsupervised, image similarity-based works is largely confined to the unimodal case. Given that multimodal registration is often needed in many clinical applications, we expect to see more papers in the near future that will tackle this challenging problem.\nPerforming multimodal image registration in an unsupervised capacity is significantly more difficult than performing unimodal image registration because of the difficulty associated with using manually crafted similarity metrics to quantify the similarity between the two images, and generally using the unsupervised techniques described above to establish/detect voxel-to-voxel correspondence. The use of unsupervised learning to learn feature representations to determine an optimal transformation has generated significant interest from the research community recently. Along with the previously discussed unsupervised image registration method, we expect feature-based unsupervised registration to continue to generate significant interest from the research community. Further, extension to the multimodal case (especially for applications that use image with significant appearance differences) is likely to be a prominent research focus in the next few years."}, {"section_title": "Reinforcement learning-based registration", "text": "In this section, methods that use reinforcement learning for their registration applications are surveyed. Here, a trained agent is used to perform the registration as opposed to a pre-defined optimization algorithm. A visualization of this framework is given in Fig. 4 . Reinforcement learning-based registration typically involves a rigid transformation model. However, it is possible to use a deformable transformation model.\nLiao et al. [62] were the first to use reinforcement learning-based registration to perform the rigid registration of cardiac and abdominal 3D CT images and cone-beam CT (CBCT) images. They used a greedy supervised approach for end-to-end training with an attention-driven hierarchical strategy. Their method outperformed MI-based registration and semantic registration using probability maps. Shortly after, Kai et al. [71] used a reinforcement learning approach to perform the rigid registration of MR/CT chest volumes. This approach is derived from Q-learning and leverages contextual information to determine the depth of the projected images. The network used in this method is derived from the dueling network architecture [108] . Notably, this work also differentiates between terminal and non-terminal rewards. This method outperforms registration methods that are based on iterative closest points (ICP), landmarks, Hausdorff distance, Deep Q Networks, and the Dueling Network [108] .\nInstead of training a single agent like the above methods, Miao et al. [76] used a multi-agent system in a reinforcement learning paradigm to rigidly register X-ray and CT images of the spine. They used an auto-attention mechanism to observe multiple regions and demonstrate the efficacy of a multiagent system. They were able to significantly outperform registration approaches that used a state-of-the-art similarity metric given by [22] .\nAs opposed to the above rigid registration-based works, Krebs et al. [55] used a reinforcement learning-based approach to perform the deformable registration of 2D and 3D prostate MR volumes. They used a low-resolution deformation model for the registration and fuzzy action control to influence the stochastic action selection. The low-resolution deformation model is necessary to restrict the dimensionality of the action space. This approach outperformed registration performed using the Elastix toolbox [53] and LCC Demons [69] -based registration techniques.\nThe use of reinforcement learning is intuitive for medical image registration applications. One of the principle challenges for reinforcement learning-based registration is the ability to handle high-resolution deformation fields. There are no such challenges for rigid registration. Because of the intuitive nature and recency of these methods, we expect that such approaches will receive more attention from the research community in the next few years.\nWe also project that reinforcement learning will also be more commonly used for medical image registration in the next few years because it is very intuitive and can mimic the manner in which physicians perform registration. It should be noted that there are some unique challenges associated with deep learning-based medical image registration: including the dimensionality of the action space in the deformable registration case. However, we believe that such limitations are surmountable because there is already one proposed method that uses reinforcement learning-based registration with a deformable transformation model [55] ."}, {"section_title": "Supervised transformation estimation", "text": "Despite the early success of the previously described approaches, the transformation estimation in these methods is iterative, which can lead to slow registration. [36] . This is especially true in the deformable registration case where the solution space is high dimensional [59] . This motivated the development of networks that could estimate the transformation that corresponds to optimal similarity in one step. However, fully supervised transformation estimation (the exclusive use of ground truth data to define the loss function) has several challenges that are highlighted in this section.\nA visualization of supervised transformation estimation is given in Fig. 5 , and a description of notable works is given in Table 2 . This section first discusses methods that use fully supervised approaches in Sect. 3.1 and then discusses methods that use dual/weakly supervised approaches in Sect. 3.2."}, {"section_title": "Fully supervised transformation estimation", "text": "In this section, methods that used full supervision for singlestep registration are surveyed. Using a neural network to perform registration as opposed to an iterative optimizer significantly speeds up the registration process."}, {"section_title": "Rigid registration", "text": "Miao et al. [77, 78] were the first to use deep learning to predict rigid transformation parameters. They used a CNN to predict the transformation matrix associated with the rigid registration of 2D/3D X-ray attenuation maps and 2D X-ray images. Hierarchical regression is proposed in which the six transformation parameters are partitioned into three groups. Ground truth data were synthesized in this approach by transforming aligned data. This is the case for the next three approaches that are described as well. This approach outperformed MI, CC, and gradient correlation (GC)-optimization-based registration approaches with respect to both accuracy and computational efficiency. The improved computational efficiency is due to the use of a forward pass through a neural network instead of an optimization algorithm to perform the registration.\nRecently, Chee et al. [15] used a CNN to predict the transformation parameters used to rigidly register 3D brain MR volumes. In their framework, affine image registration network (AIRNet), the MSE between the predicted and ground truth affine transforms is used to train the network. They were able to outperform MI-optimization-based registration for both the unimodal and multimodal cases.\nThat same year, Salehi et al. [90] used a deep residual regression network, a correction network, and a bivariant geodesic distance-based loss function to rigidly register T1 and T2 weighted 3D fetal brain MRs for atlas construction. The use of the residual network to initially register the image volumes prior to the forward pass through the correction network allowed for an enhancement of the capture range of the registration. This approach was evaluated for both sliceto-volume registration and volume-to-volume registration. They validated the efficacy of their geodesic loss term and outperformed NCC-optimization-based registration.\nAdditionally, Zheng et al. [119] proposed the integration of a pairwise domain adaptation module (PDA) into a pre-trained CNN that performs the rigid registration of preoperative 3D X-ray images and intraoperative 2D X-ray images using a limited amount of training data. Domain adaptation was used to address the discrepancy between synthetic data that was used to train the deep model and real data.\nSloan et al. [97] used a CNN that is used to regress the rigid transformation parameters for the registration of T1 and T2 weighted brain MRs. Both unimodal and multimodal registration were investigated in this work. The parameters that constitute the convolutional layers that were used to extract low-level features in each image were only shared in the unimodal case. In the multimodal case, these parameters were learned separately. This approach also outperformed MI-optimization-based image registration."}, {"section_title": "Deformable registration", "text": "Unlike the previous section, methods that use both real and synthesized ground truth labels will be discussed. Methods that use clinical/publicly available ground truth labels for training are discussed first. This ordering is reflective of the fact that simulating realistic deformable transformations is more difficult than simulating realistic rigid transformations.\nFirst, Yang et al. [114] predicted the deformation field with an FCN that is used to register 2D/3D intersubject brain MR volumes in a single step. A U-net-like architecture [87] was used in this approach. Further, they used large diffeomorphic metric mapping to provide a basis, used the initial momentum values of the pixels of the image volumes as the network input, and evolved these values to obtain the predicted deformation field. This method outperformed semi-coupled dictionary learning-based registration [11] .\nThe following year, Rohe et al. [86] also used a U-net [87] inspired network to estimate the deformation field used to register 3D cardiac MR volumes. Mesh segmentations are used to compute the reference transformation for a given image pair, and SSD between the prediction and ground truth is used as the loss function. This method outperformed LCC Demons-based registration [69] .\nThat same year, Cao et al. [13] used a CNN to map input image patches of a pair of 3D brain MR volumes to their respective displacement vector. The totality of these displacement vectors for a given image constitutes the deformation field that is used to perform the registration. Additionally, they used the similarity between inputted image patches to guide the learning process. Further, they used equalized active-point-guided sampling strategy that makes it so that patches with higher gradient magnitudes and displacement values are more likely to be sampled for training. This method outperforms SyN [6] and Demons [104] -based registration methods.\nRecently, Jun et al. [70] used a CNN to perform the deformable registration of abdominal MR images to compensate for the deformation that is caused by respiration. This approach achieved registration results that are superior to those obtained using non-motion corrected registrations and local affine registration. Recently, unlike many of the other approaches discussed in this paper, Yang et al. [113] quantified the uncertainty associated with the deformable registration of 3D T1 and T2 weighted brain MRs using a low-rank Hessian approximation of the variational Gaussian distribution of the transformation parameters. This method was evaluated on both real and synthetic data.\nJust as deep learning practitioners use random transformations to enhance the diversity of their dataset, Sokooti et al. [99] used random DVFs to augment their dataset. They used a multi-scale CNN to predict a deformation field. This deformation is used to perform intra-subject registration of 3D chest CT images. This method used late fusion as opposed to early fusion, in which the patches are concatenated and used as the input to the network. The performance of their method is competitive with B-Spline-based registration [99] .\nSuch approaches have notable, but also limited ability to enhance the size and diversity of datasets. These limitations motivated the development of more sophisticated ground truth generation. The rest of the approaches described in this section use simulated ground truth data for their applications.\nFor example, Eppenhof et al. [28] used a 3D CNN to perform the deformable registration of inhale-exhale 3D lung CT image volumes. A series of multi-scale, random transformations of aligned image pairs eliminate the need for manually annotated ground truth data while also maintaining realistic image appearance. Further, as is the case with other methods that generate ground truth data, the CNN can be trained using relatively few medical images in a supervised capacity.\nUnlike the above works, Uzunova et al. [103] generated ground truth data using statistical appearance models (SAMs). They used a CNN to estimate the deformation field for the registration of 2D brain MRs and 2D cardiac MRs and adapt FlowNet [26] for their application. They demonstrated that training FlowNet using SAM-generated ground truth data resulted in superior performance to CNNs trained using either randomly generated ground truth data or ground truth data obtained using the registration method described in [27] .\nUnlike the other methods in this section that use random transformations or manually crafted methods to generate ground truth data, Ito et al. [47] used a CNN to learn plausible deformations for ground truth data generation. They evaluated their approach on the 3D brain MR volumes in the ADNI dataset and outperformed the MI-optimization-based approach proposed in [45] . "}, {"section_title": "Dual/weakly supervised transformation estimation", "text": "Dual supervision refers to the use of both ground truth data and some metric that quantifies image similarity to train a model. On the other hand, weak supervision refers to using the overlap of segmentations of corresponding anatomical structures to design the loss function. This section will discuss the contributions of such works in Sect. 3.2.1 and then discuss the overall state of this research direction in Sect. 3.2.2."}, {"section_title": "Unsupervised transformation estimation", "text": "Despite the success of the methods described in the previous sections, the difficult nature of the acquisition of reliable ground truth remains a significant hindrance [103] . This has motivated a number of different groups to explore unsupervised approaches [24, 61] . One key innovation that has been useful to these works is the spatial transformer network (STN) [48] . Several methods use an STN to perform the deformations associated with their registration applications [32, 58] . This section discusses unsupervised methods that utilize image similarity metrics (Sect. 4.1) and feature representations of image data (Sect. 4.2) to train their networks. A description of notable works is given in Table 3 ."}, {"section_title": "Similarity metric-based unsupervised transformation estimation", "text": ""}, {"section_title": "Standard methods", "text": "This section begins by discussing approaches that use a common similarity metric with common regularization strategies to define their loss functions. Later in the section, approaches that use more complex similarity metric-based strategies are discussed. A visualization of standard similarity metricbased transformation estimation is given in Fig. 9 .\nInspired to overcome the difficulty associated with obtaining ground truth data, Li et al. [60, 61] trained an FCN to perform deformable intersubject registration of 3D brain MR volumes using \"self-supervision.\" NCC between the warped and fixed images and several common regularization terms (e.g., smoothing constraints) constitute the loss function in this method. Although many manually defined similarity metrics fail in the multimodal case (with the occasional exception of MI), they are often suitable for the unimodal case. The method detailed in this work outperforms Advanced Neuroimaging Tools (ANTs)-based registration [7] and the deep learning methods proposed by Sokooti et al. [99] (discussed previously) and Yoo et al. [117] (discussed in the next section).\nFurther, de Vos et al. [24] used NCC to train an FCN to perform the deformable registration of 4D cardiac cine-MR volumes. A DVF is used in this method to deform the moving volume. Their method outperforms registration that is performed using the Elastix toolbox [53] .\nIn another work, de Vos et al. [23] use a multistage, multiscale approach to perform unimodal registration on several datasets. NCC and a bending-energy regularization term are used to train the networks that predict an affine transformation and subsequent coarse-to-fine deformations using a B-Spline transformation model. In addition to validating their multistage approach, they show that their method outperforms registration that is performed using the Elastix toolbox [53] with and without bending energy.\nThe unsupervised deformable registration framework used by Ghosal et al. [33] minimizes the upper bound of the SSD (UB SSD) between the warped and fixed 3D brain MR images. The design of their network was inspired by the SKIP architecture [68] . This method outperforms logdemons-based registration.\nShu et al. [95] used a coarse-to-fine, unsupervised deformable registration approach to register images of neurons that are acquired using a scanning electron microscope (SEM). The mean squared error (MSE) between the warped and fixed volumes is used as the loss function here. Their approach is competitive with and faster than the sift flow framework [64] .\nSheikhjafari et al. [93] used learned latent representations to perform the deformable registration of 2D cardiac cine-MR volumes. Deformation fields are thus obtained by embedding. This latent representation is used as the input to a network that is composed of eight fully connected layers to obtain the transformation. The sum of absolute errors (SAE) is used as the loss function. Here, the registration performance was seen to be influenced by the B-Spline grid spacings. This method outperforms a moving mesh correspondence-based method described in [83] .\nStergios et al. [100] used a CNN to both linearly and locally register inhale-exhale pairs of lung MR volumes. Therefore, both the affine transformation and the deformation are jointly estimated. The loss function is composed of an MSE term and regularization terms. Their method outperforms several state-of-the-art methods that do not utilized ground truth data, including Demons [69] , SyN [6] , and a deep learning-based method that uses an MSE loss term. Further, the inclusion of the regularization terms is validated by an ablation study.\nThe successes of deep similarity metric-based unsupervised registration motivated Neylon et al. [81] to use a neural network to learn the relationship between image similarity metric values and TRE when registering CT image volumes. This is done in order to robustly assess registration performance. The network was able to achieve subvoxel accuracy in 95% of cases. Similarly inspired, Balakrishnan et al. [8, 9] proposed a general framework for unsupervised image registration, which can be either unimodal or multimodal theoretically. The neural networks are trained using a selected, manually defined image similarity metric (e.g., NCC, NMI, etc.).\nIn a follow-up paper, Dalca et al. [21] casted deformation prediction as variational inference. Diffeomorphic integration is combined with a transformer layer to obtain a velocity field. Squaring and rescaling layers are used to integrate the velocity field to obtain the predicted deformation. MSE is used as the similarity metric that, along with a regularization term, defines the loss function. Their method outperforms ANT-based registration [7] and the deep learning-based method described in [8] .\nShortly after, Kuang et al. [58] used a CNN and STN inspired framework to perform the deformable registration of T1-weighted brain MR volumes. The loss function is composed of a NCC term and a regularization term. This method uses Inception modules, a low capacity model, and residual connections instead of skip connections. They compare their method with VoxelMorph (the method proposed by Balakrishnan et al., described above) [9] and uTIlzReg GeoShoot [105] using the LBPA40 and Mindboggle 101 datasets and demonstrate superior performance with respect to both.\nBuilding upon the progress made by the previously described metric-based approaches, Ferrante et al. [32] used a transfer learning-based approach to perform unimodal registration of both X-ray and cardiac cine images. In this work, the network is trained on data from a source domain using NCC as the primary loss function term and tested in a target domain. They used a U-net like architecture [87] and an STN [48] to perform the feature extraction and transformation estimation, respectively. They demonstrated that transfer learning using either domain as the source or the target domain produces effective results. This method outperformed registration obtained using the Elastix toolbox [53] with parameters determined using grid search.\nAlthough applying similarity metric-based approaches to the multimodal case is difficult, Sun et al. [101] proposed an unsupervised method for 3D MR/US brain registration that uses a 3D CNN that consists of a feature extractor and a deformation field generator. This network is trained using a similarity metric that incorporates both pixel intensity and gradient information. Further, both image intensity and gradient information are used as inputs into the CNN."}, {"section_title": "Extensions", "text": "Cao et al. [12] also applied similarity metric-based training to the multimodal case. Specifically, they used intra-modality image similarity to supervise the multimodal deformable registration of 3D pelvic CT/MR volumes. The NCC between the moving image that is warped using the ground truth transformation and the moving image that is warped using the predicted transformation is used as the loss function. This work utilizes \"dual\" supervision (i.e., the intra-modality supervision previously described is used for both the CT and the MR images). This is not to be confused with the dual supervision strategies described earlier.\nInspired by the limiting nature of the asymmetric transformations that typical unsupervised methods estimate, Zhang et al. [118] used their network inverse-consistent deep network (ICNet) to learn the symmetric diffeomorphic transformations for each of the brain MR volumes that are aligned into the same space. Different from other works that use standard regularization strategies, this work introduces an inverse-consistent regularization term and an anti-folding regularization term to ensure that a highly weighted smoothness constraint does not result in folding. Finally, the MSD between the two images allows this network to be trained in an unsupervised manner. This method outperformed SyNbased registration [6] , Demons-based registration [69] , and several deep learning-based approaches. The next three approaches described in this section used a GAN for their applications. Unlike the GAN-based approaches described previously, these methods use neither ground truth data nor manually crafted segmentations. Mahapatra et al. [73] used a GAN to implicitly learn the density function that represents the range of plausible deformations of cardiac cine images and multimodal retinal images (retinal color fundus images and fluorescein angiography (FA) images). In addition to NMI, structural similarity index measure (SSIM), and a feature perceptual loss term (determined by the SSD between VGG outputs), the loss function is comprised of conditional and cyclic constraints, which are based on recent advances involving the implementation of adversarial frameworks. Their approach outperforms registration that is performed using the Elastix toolbox [53] and the method proposed by de Vos et al. [24] .\nFurther, Fan et al. [30] used a GAN to perform unsupervised deformable image registration of 3D brain MR volumes. Unlike most other unsupervised works that use a manually crafted similarity metric to determine the loss function and unlike the previous approach that used a GAN to ensure that the predicted deformation is realistic, this approach uses a discriminator to assess the quality of the alignment. This approach outperforms diffeomorphic demons and SyN registration on every dataset except for MGH10. Further, the use of the discriminator for supervision of the registration network is superior to the use of ground truth data, SSD, and CC on all datasets. Different from the hitherto previously described works (not just the GAN-based ones), Mahapatra et al. [74] proposed simultaneous segmentation and registration of chest X-rays using a GAN framework. The network takes three inputs: reference image, floating image, and the segmentation mask of the reference image and outputs the segmentation mask of the transformed image, and the deformation field. Three discriminators are used to assess the quality of the generated outputs (deformation field, warped image, and segmentation) using cycle consistency and a dice metric. The generator is additionally trained using NMI, SSIM, and a feature perceptual loss term.\nFinally, instead of predicting a deformation field given a fixed parameterization as the other methods in this section do, Jiang et al. [50] used a CNN to learn an optimal parameterization of an image deformation using a multi-grid B-Spline method and L1-norm regularization. They use this approach to parameterize the deformable registration of 4D CT thoracic image volumes. Here, SSD is used as the similarity metric and L-BFGS-B is used as the optimizer. The convergence rate using the parameterized deformation model obtained using the proposed method is faster than the one obtained using a traditional L1-norm regularized multi-grid parameterization."}, {"section_title": "Feature-based unsupervised transformation estimation", "text": "In this section, methods that use learned feature representations to train neural networks are surveyed. Like the methods surveyed in the previous section, the methods surveyed in this section do not require ground truth data. In this section, approaches that create unimodal registration pipelines are presented first. Then, an approach that tackles multimodal image registration is discussed. A visualization of featuredbased transformation estimation is given in Fig. 10 ."}, {"section_title": "Research trends and future directions", "text": "In this section, we summarize the current research trends and future directions of deep learning in medical image registration. As we can see from Fig. 2 , some research trends have emerged. First, deep learning-based medical image registration seems to be following the observed trend for the general application of deep learning to medical image analysis. Second, unsupervised transformation estimation methods have been garnering more attention recently from the research community. Further, deep learning-based methods consistently outperform traditional optimization-based techniques [80] . Based on the observed research trends, we speculate that the following research directions will receive more attention in the research community."}, {"section_title": "Deep adversarial image registration", "text": "We further speculate that GANs will be used more frequently in deep learning-based image registration in the next few years. As described above, GANs can serve several different purposes in deep learning-based medical image registration: using a discriminator as a learned similarity metric, ensuring that predicted transformations are realistic, and using a GAN to perform image translation to transform a multimodal registration problem into a unimodal registration problem.\nGAN-like frameworks have been used in several works to directly train transformation predicting neural networks. Several recent works [30, 111] use a discriminator to discern between aligned and misaligned image pairs. Although the training paradigm borrows from an unsupervised training strategy, the discriminator requires pre-aligned image pairs. Therefore, it will have limited success in multimodal or challenging unimodal applications where it is difficult to register images. Because discriminators are trained to assign all misaligned image pairs the same label, they will likely be unable to model a spectrum of misalignments. Despite this limitation, the application of GANs to medical image registration is still quite promising and will be described below.\nUnconstrained deformation field prediction can result in warped moving images with unrealistic organ appearances. A common approach is to add the L2 norm of the predicted deformation field, its gradient, or its Laplacian to the loss function. However, the use of such regularization terms may limit the magnitude of the deformations that neural networks are able to predict. Therefore, Hu et al. [42] explored the use of a GAN-like framework to produce realistic deformations. Constraining the deformation prediction using a discriminator results in superior performance relative to the use of L2 norm regularization in that work.\nLastly, GANs can be used to map medical images in a source domain (e.g., MR) to a target domain (e.g., CT) [19, 46, 66, 116] , regardless of whether or not paired training data are available [121] . This image appearance reduction technique would be advantageous because many unimodal unsupervised registration methods use similarity metrics that often fail in the multimodal case. If image translation is performed as a preprocessing step, then commonly used similarity metrics could be used to define the loss function of transformation predicting networks."}, {"section_title": "Raw imaging domain registration", "text": "This article has focused on surveying methods performing registration using reconstructed images. However, we speculate that it is possible to incorporate reconstruction into an end-to-end deep learning-based registration pipeline. In 2016, Wang [107] postulated that deep neural networks could be used to perform image reconstruction. Further, several works [85, 98, 115, 120] recently demonstrated the ability of deep learning to map data points in the raw data domain to the reconstructed image domain. Therefore, it is reasonable to expect that registration pipelines that take raw data as input and output registered, reconstructed images can be developed within the next few years."}, {"section_title": "Conclusion", "text": "In this article, the recent works that use deep learning to perform medical image registration have been examined. As each application has its own unique challenges, the creation of the deep learning-based frameworks must be carefully designed. Many deep learning-based medical image registration applications share similar challenges including the lack of a robust similarity metric for multimodal applications, in which there are significant image appearance differences and/or different fields of view (e.g., MR-TRUS registration) [36] , the lack of availability of large datasets, the challenge associated with obtaining segmentations and ground truth registrations, and quantifying the uncertainty of a model's prediction. Application-specific similarity metrics, patchwise frameworks, unsupervised approaches, and variational autoencoder inspired registration frameworks are examples of popular solutions to these challenges. Furthermore, despite the sophistication of many of the methods discussed in this survey, resampling and interpolation are often not among the components of registration that are learned by the neural network. While researchers started to pay attention to this aspect [2] , we expect more works to incorporate these components into their deep learning-based methods as the field continues to mature. Recent successes have demonstrated the impact of the application of deep learning to medical image registration. This trend can be observed across medical imaging applications. Many future exciting works are sure to build on the recent progress that has been outlined in this paper."}]
[{"section_title": "Abstract", "text": "Abstract-Brain imaging genetics studies the genetic basis of brain structures and functions via integrating both genotypic data such as single nucleotide polymorphism (SNP) and imaging quantitative traits (QTs). In this area, both multi-task learning (MTL) and sparse canonical correlation analysis (SCCA) methods are widely used since they are superior to those independent and pairwise univariate analyses. MTL methods generally incorporate a few QTs and are not designed for feature selection from a large number of QTs; while existing SCCA methods typically employ only one modality of QTs to study its association with SNPs. Both MTL and SCCA encounter computational challenges as the number of SNPs increases. In this paper, combining the merits of MTL and SCCA, we propose a novel multi-task SCCA (MTSCCA) learning framework to identify bi-multivariate associations between SNPs and multi-modal imaging QTs. MTSCCA could make use of the complementary information carried by different imaging modalities. Using the G2,1-norm regularization, MTSCCA treats all SNPs in the same group together to enforce sparsity at the group level. The 2,1 -norm penalty is used to jointly select features across multiple tasks for SNPs, and across multiple modalities for QTs. A fast optimization algorithm is proposed using the grouping information of SNPs. Compared with conventional SCCA methods, MTSCCA obtains improved performance regarding both correlation coefficients and canonical weights patterns. In addition, our method runs very fast and is easy-to-implement, and thus could provide a powerful tool for genome-wide brain-wide imaging genetic studies."}, {"section_title": "I. INTRODUCTION", "text": "In brain science, imaging genetics is an emerging and important topic which integrates both the genetic factors and neuroimaging phenotypic measurements. This integration strategy of combining diverse imaging and omics data is expected to uncover the genetic basis of brain structures and functions [1] - [3] . Modern neuroimaging techniques, such as magnetic resonance imaging (MRI) and positron-emission tomography (PET), image the structure and metabolic processes of the brain based on different techniques. These multi-modal imaging data provide complementary information for a more comprehensive understandings of brain structure, function and abnormality [4] . In biomedical studies, we usually face a large number of genotyping biomarkers such as the single nucleotide polymorphisms (SNPs). Therefore, developing fast and efficient imaging genetics methods which integrates multimodal imaging data simultaneously is quite important.\nThe multivariate learning methods are very popular in brain imaging genetics since both imaging data and genetic data are multidimensional. The multi-task learning (MTL), especially MTL regression, are of this kind and widely used in brain imaging genetics [5] , [6] . Generally, MTL methods treat a few important imaging QTs as dependent variables and SNPs as independent variables. Then joint effect of multi-locus genotype variables on a few phenotypes is studied. This paradigm can select SNPs that are simultaneously relevant to candidate brain phenotypes, but may ignore important information carried by cerebral components which are not included. Although a brain-wide MTL model can be used, they are still insufficient since they cannot select relevant phenotypes from multiple brain cerebral components. Therefore, bi-multivariate methods become more and more popular recently. Sparse canonical correlation analysis (SCCA) identifies the relationship between two views of data with sparse output induced by different penalties [7] - [12] . These SCCA methods have limited power since they only utilize QTs from one single imaging modality. Given multi-modal imaging data, incorporating them together would be beneficial to uncover interesting findings that using one modality cannot. Therefore, jointly analyzing the relationship between all the imaging phenotypes from different modalities and genetic factors via one single integral SCCA model is desirable and of great interest. This integration model would be helpful to elucidate the shared mechanism of genetic factors on the brain. Though the multi-view SCCA modelling could address this issue [12] , it learns only one single canonical weight for genetic loci which is overstrict.\nIn this paper, we propose a Multi-Task learning based SCCA (MTSCCA) framework which can study bi-multivariate associations between phenotypes of multiple modalities and genotypes simultaneously. MTSCCA treats each SNP or QT as a feature, and then models the association between each imaging modality and SNPs as a learning task. Different from those conventional SCCA, MTSCCA learns one canonical weight matrix for SNPs, in which each column vector corresponds to one canonical weight of one SCCA task. In contrast, only one canonical weight vector is associated with each imaging modality. We take into consideration the group structure such as the linkage disequilibrium (LD) [13] in human genome via the group 2,1 -norm (G 2,1 -norm) [6] . The jointly individual feature selection is also taken into consideration via a 2,1 -norm. In addition, we propose a fast and efficient optimization algorithm to solve the MTSCCA problem. We apply MTSCCA to a large real neuroimaging genetic data set of the Alzheimer's disease neuroimaging initiative (ADNI) [14] cohort with SNPs from chromosome 19 and three different modalities of imaging QTs included. Experimental results show that, compared with conventional SCCA methods, MTSCCA yields both better canonical correlation coefficients and canonical weights. It also reports a compact set of SNPs and imaging QTs known to be associated with AD. Moreover, MTSCCA runs very fast and could be a powerful tool to genome-wide brain-wide bimultivariate association analysis."}, {"section_title": "II. THE MULTI-TASK SCCA LEARNING METHOD", "text": "We denote scalars as italic letters, column vectors as boldface lowercase letters, and matrices as boldface capitals. For X = (x ij ), its i-th row is denoted as x i and j-th column is x j , and X i denotes the i-th matrix. x 2 denotes the Euclidean norm, and X F = i j x 2 ij denotes the Frobenius norm."}, {"section_title": "A. The MTSCCA Method", "text": "We use X \u2208 R n\u00d7p to represent the genetic data with n participants and p SNPs, and Y j \u2208 R n\u00d7q (j = 1, \u00b7 \u00b7 \u00b7 , c) to represent the phenotype data with q imaging measurements, where c is the number of imaging modalities (tasks). Let U \u2208 R p\u00d7c be the canonical weight matrix associated with X and V \u2208 R q\u00d7c be that associated with imaging QTs with each v j corresponding to Y j , we propose the novel multi-task based SCCA (MTSCCA) model as follows\nObviously, our model is distinct from those mCCA models. First, MTSCCA employs the multi-task framework which learns a series of related SCCA tasks together. This simultaneous learning has been shown to improve performance dramatically compared with learning each task independently [15] , [16] . Second, our model learns a canonical weight matrix U for SNPs, in which each column u j corresponds to an individual SCCA task. This is helpful since it does not require a unique canonical weight of SNPs to be associated with all modalities of imaging QTs at the same time. Third, MTSCCA learns one canonical weight corresponding to each imaging modality separately, indicating that we do not need to calculate multiple canonical weights for a specific imaging modality. This helps the model focus on the identification of markers from the genetic data, indicating it is quite suitable for imaging genetics analysis. Finally, our model is well scalable in terms of both modeling and computation. According to Eq. (1), the number of tasks of MTSCCA is equal to the number of imaging modalities, which means the computation burden increases linearly.\n1) Group-sparsity for Genetic Association and Joint Individual Feature Selection for SNPs: It is known that numerous SNPs inherently exhibit group structure in the genome. Thus we use the G 2,1 -norm function [6] for regularization. Suppose the SNPs are partitioned into K non-overlapping groups\n, then the G 2,1 -norm function is formulated as\nU k is a submatrix of U with rows in U indexed by g k . This regularization penalizes the SNPs in the same group, i.e. {u i } i\u2208g k , as a whole and expects to estimate equal or similar coefficients for them.\nGenerally, within a specific group, an individual SNP could be relevant to the QTs and those remaining ones could be irrelevant. Therefore, we model this via the 2,1 -norm regularization which is usually used in multi-task models,\nUsing both G 2,1 -norm and 2,1 -norm regularization, MTSC-CA can not only select features at the group level in accordance with the biological knowledge, but also jointly select features at the individual level across all SCCA tasks."}, {"section_title": "2) Joint Individual Feature Selection across Different Imaging Modalities:", "text": "Identifying imaging biomarkers is also of great interest in out study. Since MTSCCA learns only one canonical weight for each imaging modality, the sparsityinducing term 2,1 -norm is imposed across different imaging modalities, viz\nThe motivation of using this penalty is as follows. Despite being collected based on different imaging technologies, all modalities of imaging data are measured from the same brain space and have been mapped onto the same brain atlas via the segmentation and registration. Therefore, it is reasonable to assume equal or similar coefficients for those imaging features associated with the same brain area but attributed to different modalities."}, {"section_title": "B. The Optimization Algorithm", "text": "Now we can write the MTSCCA with penalties explicitly exhibited, i.e.\nTo solve Eq. (5), we first modify the loss function to\nwhich is equivalent to the original one since \u2200j, Xu j 2 = 1 and Y j v j 2 = 1. Then we write its Lagrangian as\nwhere \u03b2, \u03bb 1 , \u03bb 2 , \u03b3 * 1 and \u03b3 * 2 are tuning parameters, and \u03b2, \u03bb 1 and \u03bb 2 are positive values which control the model sparsity.\nThis problem is difficult to solve since it is non-convex in loss function and non-smooth in penalty functions. Fortunately, it is convex in U with V fixed. Moreover, this objective is convex in v j with those remaining v k (k = j) and U fixed. On this account, we can solve this problem via the alternating optimization which is a standard procedure to solve the SCCA model."}, {"section_title": "1) Updating U:", "text": "We first solve U with V fixed. Since all u j 's are associated with X, they can be jointly calculated via a multi-task framework. Taking the derivative of L(U, V) with respect to U and letting the derivative be zero, we arrive at\nwhere 2DU is the subgradient of U G2,1 and 2D 1 U is that of U 2,1 ;D is a diagonal matrix with the k-th diagonal block being\n, and I k is an identity matrix of size equaling to the k-th group; D 1 is also a diagonal matrix with the i-th entry being\nThen we can easily have\nAccording to [6] , this linear system in terms of U can be efficiently solved via an iterative algorithm by alternatively updatingD and D 1 , and U.\nHowever, if the number of SNPs becomes larger and larger, this iterative algorithm is still computationally expensive. To accelerate the algorithm, we introduce the following theorem (proof is omitted and a similar proof can be found in [17] ).\nTheorem 1: If X X is a block diagonal matrix, Eq. (9) can be solved by [18] . (2) Benefiting from the computation effort reduction, the memory requirement is also saved a lot because storing X X is very memory expensive than storing several x g k x g k . (3) Eq. (10) is easy to implement, demonstrating it is very promising in big imaging genetic analysis.\n2) Updating v j : Note that each v j is associated with each Y j respectively. This means that these v j 's are not coupled (as compared to u j 's) and should be tackled with separately. Next we will show how to solve v j with v k (k = j) and U being fixed. Based on Eq. (7), we take the derivative with respect to v j and set it to zero\nwhich yields\nwhere D 2 is a diagonal matrix which is loaded by\non the diagonal; and \u03b3 2 = \u03b3 * 2 + 1. Therefore, each v j can also be solved alternatively through an iterative algorithm.\nNow that the building blocks regarding updating U and each individual v j are created, we present the pseudocode in Algorithm 1."}, {"section_title": "Algorithm 1 Algorithm to solve Eq. (7)", "text": "Require:\nCanonical weights U and V."}, {"section_title": "1: Initialize", "text": "2: while not convergence do 3:\nUpdateD g k and D1 g k ;"}, {"section_title": "4:", "text": "Solve U according to Eq. (10), and normalize uj to Xuj "}, {"section_title": "III. RESULTS", "text": ""}, {"section_title": "A. Experimental Setup", "text": "A nested 5-fold cross-validation strategy was used in this work. Specifically, those tuning parameters was determined in the inner loop where a group of them generating the highest canonical coefficients will be chosen as the optimal parameters. Empirically, we fine tuned the \u03b2, \u03bb 1 and \u03bb 2 from {0.01, 0.1, 1, 10, 100} which usually yielded good results in this study. For the remaining \u03b3 1 and \u03b3 2 , we simply set them to 1 as they have been shown to be insensitive to the learned results [8] . In the outer loop, the 5-fold training and testing results were calculated and presented.\nTo the best of our knowledge, this is the first multi-task SCCA method, and thus no previous work can be used to compare with. On this account, we choose the conventional SCCA, including both two-view SCCA and mSCCA [12] as benchmarks. This could help show the effectiveness of MTSCCA. Another issue is that these conventional methods suffer from heavy computational and memory requirement issues because they cannot handle the large covariance matrix calculation. To make the comparison feasible, based on Theorem 1, we implement the fast SCCA and the fast mSCCA. This yields the two benchmark methods in this study."}, {"section_title": "B. Data Sources", "text": "The genotying and brain imaging data used in this article were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). One primary goal of ADNI has been to test whether serial magnetic resonance imaging (MRI), positron emission tomography (PET), other biological markers, and clinical and neuropsychological assessment can be combined to measure the progression of mild cognitive impairment (MCI) and early Alzheimer's disease (AD). For up-to-date information, see www.adni-info.org.\nThe neuroimaging data were from 755 non-Hispanic Caucasian subjects, including 281 AD, 292 MCI and 182 healthy control (HC) participants. The data contained multiple modalities including 18-F florbetapir PET (AV45) scans, fluorodeoxyglucose PET (FDG) scans, and structural MRI scans. These data were downloaded from the ADNI database (adni.loni.usc.edu). These multi-modality imaging data were aligned to each other for each participant. The structural MRI scans were processed with voxel-based morphometry (VBM) via SPM [19] . Generally, all scans had been aligned to a T1-weighted template image, segmented into gray matter (GM), white matter (WM) and cerebrospinal fluid (CSF) maps, normalized to the standard Montreal Neurological Institute (MNI) space as 2\u00d72\u00d72 mm 3 voxels, and had been smoothed with an 8mm FWHM kernel. The FDG-PET and AV45-PET scans were also registered into the same MNI space by SPM. We then subsampled the whole brain and generated 116 regions of interest (ROI) level measurements based on the MarsBaR automated anatomical labeling (AAL) atlas. The studied measures include the mean gray matter densities for structural MRI, amyloid values for AV45 scans and glucose utilization for FDG scans. Using the regression weights derived from the healthy control participants, these imaging measures were pre-adjusted for removing the effects of the baseline age, gender, education, and handedness.\nThe genotyping data of the same population were also downloaded from the ADNI website. The data were generated using the Human 610-Quad or OmniExpress Array (Illumina, Inc., San Diego, CA, USA), and preprocessed using the standard quality control (QC) and imputation steps. Among all human chromosomes, chromosome 19 contains the largest number of genes, in which the gene density is more than double the genome-wide average [20] . In addition, this chromosome also includes the well-known AD risk genes such as APOE, APOC1 and TOMM40. Therefore, a bi-multivariate association study between this chromosome and whole brain imaging markers could be of great interest, and has potential to yield interesting AD risk factors. As a result, all the SNPs from chromosome 19 were included, i.e., 152,787 SNPs were involved in this study. Among these SNPs, most of them might be irrelevant to AD, while only few of them could be relevant via influencing the intermediate brain imaging measurements. The aim of this study is to identify this small subset of SNPs in chromosome 19 that are related to brain imaging markers."}, {"section_title": "C. Experimental Results", "text": "We first use the canonical correlation coefficient (CCC) as an evaluation criteria. There will be three pairs of associations, and we denote them as SNP-AV45, SNP-FDG and SNP-VBM for the sake of description. For the three SCCA tasks, MTSCCA learns them together and generates a canonical weight matrix U for SNP data and one canonical weight vector v j for AV45, FDG and VBM data. We then calculate CCCs in terms of SNP-AV45, SNP-FDG and SNP-VBM separately. The two-view SCCA naturally yields three CCCs for these three tasks. Although the mSCCA only learns one canonical weight vector for SNP data, we use it three times to generate three CCCs with respect to the three tasks. Fig . 1 shows the CCCs of the SNP data with each type of imaging QT data, where CCCs of SNP-AV45, SNP-FDG and SNP-VBM are separately shown. In this figure, both the training CCCs and testing CCCs, as well as their standard deviations (SDs) are presented. By changing the number of selected features (10, 20, \u00b7 \u00b7 \u00b7 , 100 in this work) for both SNP and imaging QT data, the CCCs can be generated and then these curves are plotted. It is clear that the proposed MTSCCA obtains higher CCCs on both training and testing sets across all imaging modalities except for training results of SNP-VBM. After investigation, this could be attributed to that the two-view SCCA runs into overfitting since it holds high training CCCs and quite low CCCs simultaneously. We also observe that mSCCA always obtains the lowest CCCs on both training and testing sets across three tasks in this data. This is very interesting because it seems counter-intuitive because more data (three different imaging modalities here) ought to provide more information. The reason might attribute to the modelling strategy of mSCCA. Demanding one set of features (SNPs) being associated with three sets of features (imaging QTs) simultaneously could be overstrict and thus harm the performance. In addition, we calculate the p-values between MTSCCA and two competing methods and show them in Table I . The p-values all reach the significance level which means that our method is significantly better than both competing methods. These results in terms of CCCs indicate that the proposed joint bi-multivariate learning method indeed has better association identification capability than those SCCA methods, including both two-view and multiple-view ones. MTSCCA  rs429358  rs138339429  rs429358  rs10414043  rs141300647  rs56131196  rs147711004  rs58501143  rs12721051  rs146291812  rs17363184  rs4420638  rs623264  rs623264  rs111789331  rs7256200  rs11881833  rs66626994  rs186235601  rs7253576  rs146275714  rs73052335  rs1749316  rs41289512  rs66626994  rs139402102  rs147711004  rs415966  rs4605289  rs10119 Apart from the CCCs, the selected features in terms of SNPs are a major concern. We show the top ten selected SNPs according to the canonical weight values of each individual method in Table II . In order to make the selection results stable, we average the canonical weight matrix into a vector and then choose the top ten SNPs based on their absolute values for MTSCCA. The top ten markers of two-view SCCA method are calculated via averaging the three separate canonical weights. Owning to the joint learning paradigm, MTSCCA yields a surprisingly meaningful result with respect to selected features (SNPs). As expected, the notable AD risk markers rs429358 gains the highest weight value, and all of the remaining nine SNPs of MTSCCA, i.e. rs429358 (APOE), rs56131196 (APOC1), rs12721051 (APOC1), rs4420638 (APOC1), rs111789331 (4.5 kb of APOC1), rs66626994 (5.6 kb of APOC1), rs146275714 (PVRL2), rs147711004 (71 kb of APOE) and rs10119 (TOM-M40), have been reported to show increasing risk of AD in previous studies. This indicates the ability of MTSC-CA in identifying meaningful SNPs from massive genetic markers. The two-view SCCA identifies rs429358 and five other AD related SNPs (rs10414043, rs147711004, rs7256200, rs73052335 and rs66626994). But it identifies four SNPs that are not reported by now and thus further investigation is warranted. The mSCCA performs inadequately since it does not find out the most important locus rs429358. Moreover, except the marker rs623264, the remaining nine identified SNPs of mSCCA have not been reported yet. This reveals that MTSCCA could be a suitable tool in discovering meaningful genetic markers in a very large scenario. Fig. 2 presents the canonical weights on each imaging modality (AV45, FDG and VBM) across the five trials. We observe that those imaging markers with nonzero coefficients generated by MTSCCA are all associated with AD. We also show the top ten selected QTs of each imaging modal data of MTSCCA in Table III . There are five markers (the right angular gyrus, the left posterior cingulum cortex, the left hippocampus, the left olfactory cortex and the vermis 8) reported in all three modalities owning to the joint feature selection. Most importantly, these markers are all have been documented to be related to AD or MCI [21] - [25] . These results indicate that MTSCCA could identify meaningful imaging markers that are associated with the status of dementia. The mSCCA also identifies a few of AD related markers such as the hippocampus. The two-view method is rambling and thus is not a good option in this scenario. To summarize, the top ten selected SNPs and imaging QTs are highly correlated with each other, and with AD, demonstrating that MTSCCA could be a very promising method in brain imaging genetics."}, {"section_title": "IV. CONCLUSION", "text": "In this paper, we have proposed a novel multi-task based SCCA (MTSCCA) method and applied it to imaging genetic problem with multi-modal brain imaging QTs. Different from existing SCCA methods, MTSCCA incorporates multiple sets of imaging modalities into a single integral model. MTSCCA has better modeling capability than both conventional SCCA and MTL regression. A fast optimization algorithm is proposed which avoids calculating the large covariance during solution.\nWe compared MTSCCA with the conventional two-view and multi-view SCCA on an ADNI cohort. Our method obtained better performance than the benchmarks with higher correlation coefficients and clearer canonical weight patterns. a large number of genetic markers from chromosome 19. It is worth noting that all top ten selected SNPs of MTSCCA were known AD risk factors. In addition, the canonical weight patterns of imaging QTs were also of great importance. The identified imaging QTs were highly correlated to AD or MCI. These results demonstrated that the proposed multi-task SCCA could be a powerful tool in big data mining in brain imaging genetics. We plan to extend MTSCCA to genome-wide brainwide imaging analysis in the future work."}]
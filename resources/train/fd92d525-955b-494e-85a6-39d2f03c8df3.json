[{"section_title": "Abstract", "text": "Abstract. We introduce a mixed-effects model to learn spatiotemporal patterns on a network by considering longitudinal measures distributed on a fixed graph. The data come from repeated observations of subjects at different time points which take the form of measurement maps distributed on a graph such as an image or a mesh. The model learns a typical group-average trajectory characterizing the propagation of measurement changes across the graph nodes. The subjectspecific trajectories are defined via spatial and temporal transformations of the group-average scenario, thus estimating the variability of spatiotemporal patterns within the group. To estimate population and individual model parameters, we adapted a stochastic version of the Expectation-Maximization algorithm, the MCMC-SAEM. The model is used to describe the propagation of cortical atrophy during the course of Alzheimer's Disease. Model parameters show the variability of this average pattern of atrophy in terms of trajectories across brain regions, age at disease onset and pace of propagation. We show that the personalization of this model yields accurate prediction of maps of cortical thickness in patients."}, {"section_title": "Introduction", "text": "There is a great need to understand the progression of Alzheimer's Disease (AD) especially before the clinical symptoms to better target therapeutic interventions [8] . During this silent phase, neuroimaging reveals the disease effects on brain structure and function, such as the atrophy of the cortex due to neuronal loss. However, the precise dynamics of the lesions in the brain are not so clear at the group level and even less at the individual level. Personalized models of lesion propagation would enable to relate structural or metabolic alterations to the clinical signs, offering ways to estimate stage of the disease progression in the pre-symptomatic phase. Numerical models have been introduced to describe the temporal and the spatial evolution of these alterations, defining a spatiotemporal trajectory of the disease, i.e. a description of the changes in the brain over time, such as lesion progressions, tissue deformation and atrophy propagation.\nStatistical models are well suited to estimate distributions of spatiotemporal patterns of propagation out of series of short-term longitudinal observations [3, 6] . However, the absence of time correspondence between patients is a clear obstacle for these types of approaches. Using data series of several individuals requires to re-align the series of observations in a common time-line and to adjust to a standardized pace of progression. Current models either consider a sequential propagation [16] , without taking into account the continuous dynamics of changes, or develop average scenarios [7, 9] . Recently, a generic approach to align patients has been proposed for a set of biomarkers in [15] : the temporal inter-subject variability results from individual variations of a common time-line granting each patient a unique age at onset and pace of progression. On top of the time-alignment of the observations, there exists a spatial variability of the signal propagation that characterizes a distribution of trajectories.\nIn order to exhibit a spatial representation of the alterations, we study medical images or image-derived features taking the form of a signal discretized at the vertices of a mesh, for instance the cortical thickness distributed on the mesh of the pial surface or Standardized Uptake Value Ratio (SUVR) distributed on the regular voxel grid of a PET scan. The spatial distribution of the signal is encoded in a distance matrix, giving the physical distance between the graph nodes. A sensible prior to include in the model is to enforce smooth variations of the temporal profile of signal changes across neighbouring nodes, highlighting a propagation pattern across the network as in [13] . Extending directly the model in [15] may lead to an explosion of the number of parameters proportional to the mesh resolution. At infinite resolution, the parameters take the form of a smooth continuous map defined on the image domain. In this paper, we propose to constrain these maps to belong to a finite-dimensional Hilbert Space, penalizing high frequency variations. In practice, these maps are generated by the convolution of parameter values at a sparse set of control nodes on the network with a smoothing kernel. The number of control nodes, whose distribution is determined by the bandwidth of the kernel, controls the complexity of the model regardless of the mesh resolution. Furthermore, the propagation of nonnormalized signal could not adequately be modeled by the same curve shifted in time as in [15] . We introduce new parameters to account for smooth changes in the profiles of changes at neighbouring spatial locations.\nWe introduce a mixed-effect generative model that learns a distribution of spatiotemporal trajectory from series of repeated observations. The model evaluates individual parameters (time reparametrization and spatial shifts) that enables the reconstruction of individual disease propagation through time. This non-linear problem is tackled by a stochastic version of the EM algorithm, the MCMC-SAEM [1, 11] in a high-dimensional setting. It considers fixed-effects describing a group-average trajectory and random effects characterizing individual trajectories as adjustment of the mean scenario. It is used to detect the cortical thickness variations in MRI data of MCI converters from the ADNI database. "}, {"section_title": "Manifold-valued networks", "text": "In the following, we consider a longitudinal dataset y = (y i,j ) 1\u2264i\u2264p, 1\u2264j\u2264ki of p individuals, such that the ith individual is observed at k i repeated time points t i,1 < . . . < t i,ki . We assume that each observation y ij takes the form of N v \u2208 N * scalar measures (y i,j ) 1 , ..., (y i,j ) Nv referred to as a measurement map.\nManifold-valued measurements distributed on a fixed graph Let G = (V, E) be a non-oriented graph where V = (x 1 , ..., x Nv ) is a set of vertices of a mesh in R 3 and E is a subset of pairs of vertices defining the graph edges. We assume that G is a common fixed graph such that the kth coordinate of each measurement map y ij corresponds to the vertex x k \u2208 V. As the graph corresponds to measurements spatially distributed on a mesh, the edges embed a spatial configuration. Therefore, any edge (x i , x j ) is valued with d, a geodesic distance on the graph, defining a distance matrix D such that for all i, j \u2208 {1, ..,\ne. a fixed graph with one-dimensional values associated to each vertex and with distances associated to each edge.\nWe consider that the measurements of the patients at each node k corresponds to observations of a signal function t \u2192 \u03b3 k (t) at particular time points. Thus, the function t \u2192 \u03b3(t) = (\u03b3 1 (t), ..., \u03b3 Nv (t)) describes the evolution of the signal over the whole network. We assume that each signal function is continuous and that measurement map y i,j \u2208 y lies in a space defined by smooth constraints, as expected for bounded or normalized observations (eg. volume ratios, thickness measures, SUVR). Therefore, the space of measurements is best described as a Riemannian manifold [5, 12] , leading to consider each function t \u2192 \u03b3 k (t) as a one-dimensional geodesically complete Riemannian manifold (M, g M ) such that all spatial observation y i,j is a point in the product manifold M Nv . It follows that for each i, j, (G, D, y i,j ) is a manifold-valued network."}, {"section_title": "Spatial smoothness of the propagation", "text": "Besides the temporal smoothness of the propagation, we expect the signal to be similar for neighbour nodes. We consider that each node is described by N p parameters that parametrize the signal trajectory. In order to ensure smooth variations of the parameters values at neighbouring nodes, we assume that they result from the interpolation of the parameter values at a sparse subset of uniformly distributed nodes V C = (x d1 , ...,\nThis convolution guarantees the spatial regularity of the signal propagation. Moreover this smooth spatial constraint enables a reduction of the number of parameters, reducing the dimensional complexity from N p independent parameters at each node, to N p parameters only at the control nodes."}, {"section_title": "The statistical model", "text": "A propagation model Given a set of manifold-valued networks (G, D, y), the model describes a groupaverage trajectory in the space of measurements, defined by a geodesic \u03b3 that allows to estimate a typical scenario of progression. Individual trajectories derive from the group-average scenario through spatiotemporal transformations: the exp-parallelization and the time reparametrization.\nFirst, to describe disease pace and onset specific to each subject, we introduced a temporal transformation, called the time-warp, that is defined, for the subject i, by \u03c8 i (t) = \u03b1 i (t i,j \u2212 \u03c4 i \u2212 t 0 ) + t 0 where t 0 is the reference time-point in the space of measurements. The parameter \u03c4 i corresponds to the time-shift between the mean and the individual age at onset and \u03b1 i is the acceleration factor that describes the pace of an individual, being faster or slower than the average. This time reparametrization allows to reposition the dynamics of the average scenario in the real time-line of the ith individual.\nThe exp-parallelization allows to translation the observations in the space of measurements, from the mean scenario to individual trajectories, encoding a variation in the trajectory of changes across the nodes of the graph. This exp-parallelization is handled by a family of individual vectors (w i ) 1\u2264i\u2264p , called space-shifts. As shown on Figure 1 (left) , the orange dots refer to individual observations in the space of measurements. The group-average trajectory estimated from the longitudinal measurements corresponds to the blue line. The space shifts characterize a spatial shift perpendicular to v 0 that describes the velocity of the mean scenario.\nFinally, the parameters (\u03b1 i , \u03c4 i , w i ) allow the reconstruction of the individual trajectories from the mean scenario of propagation.\nGiven a noise \u03b5 i,j\n\u223c N (0, \u03c3 2 Id Nv ), the mixed-effect model writes, for a arbitrary vertex function \u03b3 k (t):\nParameters estimation with the MCMC-SAEM algorithm To reconstruct the long-term scenario of the disease propagation, we estimate the parameters of the group-average trajectory \u03b8 = ((\u03b2 i param ) 1\u2264i\u2264Nc,1\u2264j\u2264Np , \u03c3) using a maximum likelihood estimator. The random-effects z = (z i ) 1\u2264i\u2264p = (w i , \u03b1 i , \u03c4 i ) 1\u2264i\u2264p are considered as latent variables, whose distributions characterize the variability of the individual trajectories. Due to the non-linearity in Eq.\n(1), we use a Stochastic Approximation Expectation Maximization [4] coupled with a Monte-Carlo Markov Chain sampler (MCMC-SAEM) [10] . Let \u03b8 (k) be the current estimation of the parameters and z (k) the current iterate of the Markov chain of the latent variables. The algorithm alternates between a simulation step, a stochastic approximation step and a maximization step, until convergence [1] . The simulation uses an adaptive version [2] of the Hasting Metropolis within Gibbs sampler to draw z (k+1) from (z (k) , y, \u03b8 (k) ). This algorithm was chosen as it handles non-linear mixed effects models [11] with proven convergence and consistent estimations in practice."}, {"section_title": "Model instantiation", "text": "As many measurements correspond to positive values (eg. the cortical thickness, volume ratios), we consider in the following the open interval M =]0, +\u221e[ as a one-dimensional Riemannian manifold equipped with a Riemannian metric g such that for all p \u2208 M and for all (u, v) \u2208 T p M , g p (u, v) = uv/p 2 . With this metric and given k \u2208 {1, . . . , N v }, M is a geodesically complete Riemannian manifold whose geodesics are of the form t \u2192 \u03b3 k (t) = p k exp(\nThese parameters are represented on Figure 1 (right) at two nodes where the decrease of the signal varies spatially. For identifiability reasons, we choose to fix the parameters t k among the nodes, leading to a shared parameter t 0 such that for all k \u2208 {1, . . . , N v } t k = t 0 . As t 0 can be arbitrarily chosen in R, we fix t 0 = t 0 defined in Section 3. Considering the interpolation functions introduced in Section 2 and the fact that the parameters (p\nFinally, the model defined in (1) rewrites: "}, {"section_title": "Experimental results", "text": ""}, {"section_title": "Data", "text": "We used this model to highlight typical spatiotemporal patterns of cortical atrophy during the course of Alzheimer's Disease from longitudinal MRI of 154 MCI converters from the ADNI database, which amounts for 787 observations, each subject being observed 5 times on average. We aligned the measures on a common atlas with FreeSurfer [14] so that the measurement maps are distributed on the same common fixed-graph G which is constituted of 1827 nodes that map the surface of the left pial surface. Out of the vertices, we selected 258 control nodes uniformly distributed over the surface. They encode the spatial interpolation of the propagation. The distance matrix D is defined by a geodesic distance on G.\nCortical thickness measurements We used the model instantiation defined in Section 3 to characterize the cortical thickness decrease. Multiple runs of 30.000 iterations (\u223c4hours) of this MCMC-SAEM lead to a noise standard deviation \u03c3 0.27mm with 90% of the data included in [1.5, 3.6] mm. The mean spatiotemporal propagation, described on the first three rows of the Figure 2 as the cortical thickness at respectively 65, 68, 71 and 74 years old shows that the primarily affected area is the medial-temporal lobe, followed by the temporal neocortex. The parietal association cortex and the frontal lobe are also figure 3a shows the real cortical thickness of a subject and the reconstruction predicted by the model. The relative error and its histogram are represented on Figure 3b . The reconstruction is coherent to the real observation, the remaining error represents essentially an unstructured noise that we precisely try to smooth out."}, {"section_title": "Discussion and perspectives", "text": "We proposed a mixed-effect model which is able to evaluate a group-average spatiotemporal propagation of a signal at the nodes of a mesh thanks to longitudinal neuroimaging data distributed on a common network. The network vertices describe the evolution of the signal whereas its edges encode a distance between the nodes via a distance matrix. The high dimensionality of the problem is tackled by the introduction of control nodes: they allow to evaluate a smaller number of parameters while ensuring the smoothness of the signal propagation through neighbour nodes. Moreover, individual parameters characterize personalized patterns of propagation as variations of the mean scenario. The evaluation of this non-linear high dimensional model is made with the MCMC-SAEM algorithm that leads to convincing results as we were able to highlight areas affected by considerable neuronal loss: the medial-temporal lobe or the temporal neocortex. The distance matrix, which encodes here the geodesic distance on the cortical mesh, may be changed to account for the structural or functional connectivity information. In this case, signal changes may propagate not only across neighbouring locations, but also at nodes far apart in space but close to each other in the connectome. The model can be used with multimodal data, such as PET scans, introducing numerical models of neurodegenerative diseases that could inform about the disease evolution at a population level while being customizable to fit individual data, predicting stage of the disease or time to symptom onset.\nThis work has been partly funded by ERC grant N o 678304, H2020 EU grant N o 666992, and ANR grant ANR-10-IAIHU-06."}]
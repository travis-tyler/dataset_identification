[{"section_title": "Abstract", "text": ", \"Deformation-based atrophy computation by surface propagation and its application to Alzheimer's disease,\" J. Med. Imag. Abstract. Obtaining regional volume changes from a deformation field is more precise when using simplex counting (SC) compared with Jacobian integration (JI) due to the numerics involved in the latter. Although SC has been proposed before, numerical properties underpinning the method and a thorough evaluation of the method against JI is missing in the literature. The contributions of this paper are: (a) we propose surface propagation (SP)-a simplification to SC that significantly reduces its computational complexity; (b) we will derive the orders of approximation of SP which can also be extended to SC. In the experiments, we will begin by empirically showing that SP is indeed nearly identical to SC, and that both methods are more stable than JI in presence of moderate to large deformation noise. Since SC and SP are identical, we consider SP as a representative of both the methods for a practical evaluation against JI. In a real application on Alzheimer's disease neuroimaging initiative data, we show the following: (a) SP produces whole brain and medial temporal lobe atrophy numbers that are significantly better than JI at separating between normal controls and Alzheimer's disease patients; (b) SP produces disease group atrophy differences comparable to or better than those obtained using FreeSurfer, demonstrating the validity of the obtained clinical results. Finally, in a reproducibility study, we show that the voxel-wise application of SP yields significantly lower variance when compared to JI."}, {"section_title": "", "text": "Deformation-based atrophy computation by surface propagation and its application to Alzheimer's disease Akshay "}, {"section_title": "Introduction", "text": "Alzheimer's disease is known to manifest itself through the degeneration of certain nerve cells. 1 This degeneration may be captured through structural magnetic resonance imaging (MRI) as \"atrophy.\" [2] [3] [4] [5] Using deformation-based computational anatomy tools, two kinds of atrophy estimates can be derived from structural MRI scans: (a) regional atrophy-atrophy in diseaserelevant brain regions and (b) voxel-wise atrophy-per voxel volume change. The latter has a wider scope since not only can it be used to compute (a), but also to perform voxel-wise statistics on populations to observe general atrophy trends in the disease. Additionally, deformation-based atrophy estimation methods are appealing due to its less reliance on accurate delineations of regions of interest which allows for computing atrophy in regions that are difficult to segment both manually and automatically, for instance amygdala.\nEstimating deformation-based atrophy involves using image registration to derive deformation fields that describe spatial transformation needed to match brain structures. Since the deformation field encodes relative positioning of each voxel in the brain, their gradients encode information such as the volume change via the Jacobian matrix. The determinant of this matrix yields local volume change information that can be later integrated to obtain regional atrophy measures. This method is popularly termed as Jacobian integration (JI). [6] [7] [8] [9] The numerical precision of JI relies on the smoothness of the deformation with respect to the discretization grid (See Sec. 5.1). As an alternate to JI, atrophy can also be computed using volumetric meshing (VM). [10] [11] [12] [13] [14] Here, each voxel is subdivided into simplices (with closed form expressions for their volume), and the volume of each of these simplices are summed after propagation of their vertices through the deformation field. Due to the completeness in the representation of a deformed voxel, this method is more precise than JI. We will refer to this method as simplex counting (SC). Figure 1 refers to the classes of deformation-based atrophy estimation methods considered in this paper. While SC has been proposed previously in the literature, 10, [11] [12] [13] [14] the mathematical properties that underpins its improvement over JI and a thorough evaluation against JI is missing in the literature. In lieu, this paper primarily deals with assessing both JI and geometric methods in the context of atrophy estimation. To this end, we particularly focus on the following:\n\u2022 We propose surface propagation (SP)-an improvement in the manner of SC meshing that significantly reduces its computational complexity.\n\u2022 We derive the orders of approximation of JI (using midpoint, trapezoidal, and Simpsons rule) and SP/SC.\n\u2022 We inspect the influence of using SP/SC for atrophy estimation in Alzheimer's disease (AD).\nSP is a time-discrete, surface flux-based method that estimates the volume of an object (a cubic voxel or a segmentation) from the surface of the object only. The essence of SP is the same as SC, i.e., dividing the volume into simplicies. However, SP is constructed in such a way that the interior volumes cancel out and the contribution to the volume is only from the surface. This is because each voxel is meshed only on the exterior in the first place unlike SC where subdividing the interior of a voxel is paramount. One may derive similarities to the Gauss divergence theorem where SP relates to the surface integral and SC to the volume integral. Except for the empirical experiment, SP is considered as the representative of the general volumetric meshing methods, i.e., observations derived from the head-to-head comparison with JI can be extended to SC too.\nSP is compared head-to-head with JI in three experiments: (1) robustness to noise in an artificial dataset; (2) performance in separating diagnostic groups in a standardize dataset from the Alzheimer's disease neuroimaging initiative (ADNI); (3) scanrescan performance in a small, in-house dataset (voxel-wise SP is used in this case). In addition, we compare the obtained results in (2) to those from FreeSurfer, in order to check the clinical validity of the combination of the registration methodology and SP. Preliminary applications of voxel-wise SP can be found in Refs. 15 and 16."}, {"section_title": "Related Work", "text": "Deformation fields used to extract voxel-wise atrophy information can either be obtained from a displacement-based 17, 18 or a flow-based [19] [20] [21] [22] registration scheme. Given a registration scheme, the Jacobian matrix relevant for computing voxel-wise atrophy can be analytically computed if the transformation model is parametric, for instance B-spline-based freeform deformation schemes. For methods that encode transformation in each voxel (like Demons), the Jacobian needs to be approximated using an appropriate finite differencing scheme. The geometric atrophy estimation method (SP/SC) is attractive because it only relies on the final position of voxels after the deformation. Hence, atrophy can be estimated in a consistent fashion regardless of the underlying deformation model.\nRegional atrophy can be obtained by integrating the Jacobian determinant values over an ROI. However, there are specialized methods available to compute region specific atrophy. Although such methods are not a focus of this paper, we will briefly discuss them.\nOne of the most popular automated way of computing atrophy is using the boundary shift integral (BSI). 23 In this method, atrophy is captured as a difference in intensities (residing in an intensity window) resulting from a shift in the boundaries of the structure of interest. There is an implicit assumption of robust intensity normalization to this method. The available implementation of BSI computes whole brain and hippocampal atrophy. BSI is a global measure as opposed to a voxel-wise measure from deformation fields. In addition, BSI depends on hard segmentation whereas soft segmentations can be used to obtain regional atrophy from deformation fields.\nRegional atrophy may also be computed by computing the difference in the number of voxels residing in the segmentation of a region in successive MRI scans. Some of the popular methods in this category are FreeSurfer 24, 25 and SIENA(X). 26, 27 Recent studies 28, 29 have shown that voxel-wise JI produced atrophy estimates with less variance and increased statistical power when compared to the popular segmentation methods. A more thorough overview of existing atrophy estimation methods can be found in Ref. 30 .\nAnother class of registration-based atrophy estimation method is flux based. 21 This method has been published in conjunction with stationary velocity field-based registration methods. Figure 2 shows an overview of obtaining volume change information from different classes of transformation models. In case the transformation model is flow based, i.e., velocity fields (v) integrated to obtain deformation (\u03d5), then one can either estimate the flux first (through surface integration, SI) and then exponentiate the same or exponentiate the deformation and then use SP to obtain volume change. However, if one has access to only the deformation then in order to compute the volume change via the flux, one needs to first compute the logarithm of the deformation to get the velocity field and then compute the flux and volume change. Computing the Log is an additional step that may lead to numerical imprecision. We do not explore flux estimation from the velocity field in this study because in case of SP, regardless of the way a deformation is obtained, the volume change information can be obtained in a single step as shown in Fig. 2. "}, {"section_title": "Outline", "text": "We will begin by introducing the registration scheme used in the paper in Sec. 4. Following this, in Secs. 5.1 and 5.1.1, we will discuss JI and the orders of approximation of JI. In Sec. 5.2, we will introduce the contribution of this paper-surface propagation and in Sec. 5.2.1, we will derive the order of approximation of SP, which applies to SC too. Further, in Sec. 6, we will present the experiments conducted to illustrate the use of SP in atrophy estimation and compare it with JI. Finally, in Secs. 7 and 8, we will discuss the observations from the experiments and provide concluding remarks."}, {"section_title": "Registration", "text": "In this section, we present a brief overview of the registration methodology used to estimate the deformation field. The registration is formulated as a multiscale (image smoothing) rigid transformation followed by a multiscale (image smoothing), multiresolution (control point resolution) nonrigid transformation. In the registration pipeline, the cost functions for both the rigid and nonrigid registrations are on the form E Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 0 1 ; 6 3 ; 7 3 0 F R \u00bc M\u00f0I \u2218 \u03d5; R\u00de \u00fe \u03bbS;\n(1)\nwhere the similarity measure M is normalized mutual information (NMI), 31 I is the moving image, R is the reference or baseline image, \u03bb \u2265 0 is a user defined regularization constant, S is the regularization term and \u03d5\u00f0x; y; z\u00de\u2236R 3 \u21a6 R 3 is a deformation field that maps a location \u00f0x; y; z\u00de in the reference image to the moving image.\nIn the rigid registration, \u03bb \u00bc 0 and \u03d5 ri is a linear transformation with six degrees of freedom. In the non-rigid registration, \u03bb > 0 and \u03d5 nr is a free-form deformation based on cubic b-splines 17 E Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 0 2 ; 6 3 ; 5 8 9 \u03d5 nr \u00f0x; y; z\u00de \u00bc\nwhere\nthe spacing between the control points, p l;m;n are b-spline control point coefficients at l, m, n, and B i , B j , B k are the onedimensional cubic b-spline tensors. The nonrigid registration is driven by the cost function (1) with a regularization based on the discrete Laplacian in the spline's control points (p l;m;n ), given by E Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 0 3 ; 6 3 ; 4 5 0 S \u00bc\nThe reason for using this regularization is twofold: (1) It penalizes oscillations in displacements leading to a smoother deformation field and (2) using a second-order term makes the regularization unbiased in first order transformations (affine image deformations) and thereby globally unbiased w.r.t. atrophy. This setting ensures the smoothness of the Jacobian and in practice often nonfolding. A composition of multiple transformations is used, \u03d5\u00f0x;y;z\u00de \u00bc \u00f0\u03d5 n \u2218 \u03d5 n\u22121 \u00b7\u00b7\u00b7 \u03d5 1 \u00de\u00f0x;y;z\u00de, because this enables modeling larger deformations without self intersections. A limited memory Broyden-Fletcher-Goldfarb-Shanno 33 scheme is used for optimization. The optimization was performed in MATLAB using the min-Func package. 34 To reduce memory consumption, only a subset of the image voxels are considered in evaluating the similarity measure M. At the finest grid of the multiscale, multiresolution deformation, we chose a denser sampling of the evaluation points in a band region around the cerebral boundaries and the ventricular boundaries. The band is generated by the following mathematical morphology operations: \u00f0I s \u00c8 E\u00de \u2212 \u00f0I s \u2296 E\u00de, where E is the structuring element [three-dimensional (3-D) sphere of radius 6 mm], \u00c8 is dilation, \u2296 is erosion, and I s is the binary image consisting of the brain segmentations (minus ventricles, cerebrospinal fluid, and brain stem). In addition, dense evaluation points in a box (five voxels beyond the boundary) containing the hippocampus is included in the finest grid. Note that the registration method is not an out-of-box freeform deformation 17 implementation. The difference is in how multiscale resolution of control points is handled. While Ref. 17 uses knot-splitting, we use a composition of warps approach."}, {"section_title": "Atrophy Computation", "text": "Given a deformation field \u03d5, the volume change can be computed in order to quantify the amount of atrophy. Here, we present two methods for atrophy computation from the deformation field, the widely used JI (for different integration schemes), and SP, the alternative we propose."}, {"section_title": "Jacobian Integration", "text": "Given an ROI \u03a9 and its volume vol\u00f0\u03a9\u00de, the volume of the transformed region \u03d5 nr \u00f0\u03a9\u00de is given as E Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 0 4 ; 3 2 6 ; 6 3 0\nwhere J\u00f0x; y; z\u00de \u00bc \u2207\u03d5 nr \u00f0x; y; z\u00de is the Jacobian of the transformation field, and j \u00b7 j denotes the determinant. In this work, we use a warp of a warp approach. Each intermediate warp (n) may be defined as follows E Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 0 5 ; 3 2 6 ; 5 4 3 \u00f0x n ; y n ; z n \u00de \u00bc \u00f0x n\u22121 ; y n\u22121 ; z n\u22121 \u00de \u00fe f n\u22121 \u00f0x n\u22121 ; y n\u22121 ; z n\u22121 ; p n\u22121 \u00de;\nwhere f n and p n are the B-Spline and its parameter of the n'th warp of \u03d5 nr . The integral of the determinant of Jacobian of such a transformation may be written as E Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 0 6 ; 3 2 6 ; 4 5 9\nHere, n represents also the intermediate warps (lower n have coarser resolution of control points and higher n have finer resolution). Note that each warp is parameterized separately. Hence, the partial derivatives can be analytically evaluated at the sampling points. It is possible to analytically evaluate the integral for a single warp, 35 however, the analytical integral for a composition of warps is nontrivial: If \u03d5 is a third-order spline, then its Jacobian is a matrix of second-order polynomials, its determinant is a sixth-order polynomial, and the product of n determinants is a 6 n polynomial. Hence, JI is usually approximated as a Riemannian sum of the left-hand-side of Eq. (6):\nE Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 0 7 ; 3 2 6 ; 2 5 2 vol\u00f0\u03d5 nr \u00f0\u03a9\u00de\u00de \u00bc\n\u00f0ih;jh;kh\u00de\u2208\u03a9 jJ\u00f0ih; jh; kh\u00dej;\nwhere x, y, z are coordinates that are followed through the composition of warps, h is the sampling distance and i, j, k \u2208 Z 3 ."}, {"section_title": "Errors of approximation for Jacobian integration", "text": "The integral of Jacobian determinants in a composition of warps setting is not trivial to compute, hence the Jacobian determinant values at the voxel center are summed to obtain an approximation. Alternatively, it can be computed using the Lagrange's linear and quadratic spline interpolants in the form of trapezoidal or for left point, midpoint, trapezoidal and Simpson's rule, where h is the sampling distance. For detailed discussion on truncation errors, we direct the readers to Ref. 36."}, {"section_title": "Surface Propagation", "text": "SP is a modified SC approach, where each face of a voxel is divided into two triangles, such that neighboring voxels share triangles. Unlike SC, the interior of the voxels is not subdivided. Since the interior is not subdivided, the contributions from adjacent voxel faces cancel out and the contribution to the volume is from the triangles on the surface of the voxel. We will illustrate the theory behind surface propagation by considering a single voxel as an object. If one desires voxel-wise change maps similar to JI and SC, such a representation is useful. The key element in SP is the Gauss' divergence theorem, which relates surface integrals to the volume of an object. Consider a smooth (C 1 ) surface S \u00bc \u2202\u03a9 as the boundary of a ROI, \u03a9, and a smooth deformation \u03d5\u2236R 3 \u21a6 R 3 , then Gauss' divergence theorem relates the closed surface integral to the volume integral E Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 0 8 ; 6 3 ; 5 2 4\nwhere dv \u00bc dxdydz is the unit volume element, da is the unit surface area element, n \u00bc \u00f0n x ; n y ; n z \u00de is the (outward) surface unit normal, and \u2207 \u00b7 \u03d5 is the divergence of \u03d5. Now consider an axis-aligned flow such that\u03c6 \u00bc \u00f0x; 0;0\u00de, \u2207 \u00b7\u03c6 \u00bc 1 and\u03c6 \u00b7 n \u00bc xn x . Now Eq. (8) can be rewritten as E Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 0 9 ; 6 3 ; 4 2 6\nConsider a subdivision of \u03a9 into a set of nonoverlapping volumes \u03c9 such that E Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 1 0 ; 6 3 ; 3 6 1 vol\u00f0\u03a9\u00de \u00bc\nwhere \u03c9 has the shape of deformed voxel, and each side is triangulated such that triangle i has area A i . Considering one subvolume,\u03c9 i , if we define the x coordinate of the barycenter of each surface triangle as x i \u00bc \u222b A i xda\u2215jAj and the unit normal along the x-axis as n i x then the discrete volume form over \u03c9, is E Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 1 1 ; 6 3 ; 2 6 2 vol\u00f0\u03c9 i \u00de \u00bc\nwhere \u2202\u03c9 is the surface of the sub-volume, N is the number of triangles and A i x \u00bc n i x A i is the area of the I'th triangle projected down to the y-z plane. Since the normals of triangles on faces of adjacent voxels cancel each other out, the only triangles that contribute to the volume are outermost faces of the outermost voxels. Therefore, Eq. (11) will boil down to E Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 1 2 ; 6 3 ; 1 4 7 vol\u00f0\u03d5 nr \u00f0\u03a9\u00de\u00de \u00bc\nwhere N s is the number of triangles on the outermost faces of the the outermost voxels.\nGiven all the surface triangles are planar, substitution of the integral by a sum in Eq. (12) is exact. However, in a nonrigid framework this is not the case, as the planar surface triangles are nonlinearly deformed with nonplanar shapes as shown in Fig. 3 . Hence, the triangular model after deformation is only an approximation, the order of which will be derived in Sec. 5.2.1.\nAn illustration of the method for one voxel as an object can be seen in Fig. 4 . In the figure, the surfaces of a voxel are represented by N triangles that undergo a transformation. The total volume change of the transformed voxel is the sum of the volume under each of the N transformed triangles. The volume under a transformed triangle is computed by multiplying the projected area, A i x (on y-z plane in the illustration), of the I'th triangle by the x-component of the transformed centroid of the triangle \u03d5 nr \u00f0x i \u00de. For instance, if \u00f0x 1 ; y 1 ; z 1 \u00de; \u00f0x 2 ; y 2 ; z 2 \u00de; \u00f0x 3 ; y 3 ; z 3 \u00de are three points at one face of the p'th voxel forming a triangle, \u03d5 nr \u00f0x 1 ; y 1 ; z 1 \u00de; \u03d5 nr \u00f0x 2 ; y 2 ; z 2 \u00de; \u03d5 nr \u00f0x 3 ; y 3 ; z 3 \u00de is their new position. Once the new position of these three points is known, the x coordinate of the centroid of triangle formed by these points is multiplied with the projected area of this triangle onto the y-z plane. For regional measures, SP is applied where the vertices of the triangles on the surface are propagated through the deformation and the volume under each of the deformed triangles are summed (the interior triangles do not contribute to the volume). \nIn SP and SC, the error of approximations are nearly the same and only different by a constant factor. For all practical purposes, this difference is negligible. In a voxel deformed by a transformation function \u03d5 nr and triangulated as described in Sec. 5.2, the error of approximation will be limited to the surface, i.e., the volume between the actual surface and the linear approximation of it in the form of a set of triangles. The surface error on an interior volume element is canceled by the same surface element of the neighboring volume element, thus leaving only errors on the surface of an object. We will now describe the order of approximation of SP.\nConsider Fig. 3 . The local Cartesian coordinates \u00f0x 0 ; y 0 \u00de of an arbitrary point v inside the triangle may be expressed in terms of barycentric coordinates as follows, E Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 1 3 ; 6 3 ; 4 7 8\nE Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 1 4 ; 6 3 ;\nE Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 1 5 ; 6 3 ; 3 8 8\nwhere A \u00bc \u00f01\u22152\u00dehk sin\u00f0\u03b8\u00de is the area of the triangle with \u03b8 as the angle between the sides of lengths h, k and db 1 \u00bc dx 0 \u2215h, db 2 \u00bc dy 0 \u2215k. This integral allows us to compute the volume constrained by the sides of the triangle, where the height at each point, v, is given by the function f\u00f0v\u00de. The interesting part is that we can express the integral in terms of the vertices of the triangle and barycentric coordinates only. Accordingly, the integral in\u03c6's coordinate system will be E Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 1 6 ; 6 3 ; 2 6 0 2A\nThe function f\u00f0x 0 ; y 0 \u00de can be expressed using a Taylor series as follows \nThus, assuming O\u00f0h\u00de \u00bc O\u00f0k\u00de, then the error of approximation of a surface by triangulation is O\u00f0h 4 \u00de."}, {"section_title": "Experiments and Results", "text": ""}, {"section_title": "Synthetic Noise Experiment", "text": "In order to inspect the robustness of SP and JI, we test the precision of each of the methods in estimating the true volume change in the presence of noise. We consider a deformation of a grid in 3-D space using a field proportional to the gradient of the Gaussian plus random noise. The deformation is given as E Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 1 9 ; 3 2 6 ; 3 6 9\u03c6 i \u00bc i \nwhere\u03c6 i is the displacements, \u03b7 > 0 is a parameter used to control the magnitude of the noise component, \u03c3 is the Gaussian width, f is a frequency picked from a uniform discrete distribution 1 to 10 Hz, and \u03c7 is a random phase also picked from a uniform distribution \u00bd\u2212\u03c0; \u03c0. \u03c3 \u00bc 0.9 mm is the width of the Gaussian. The parameter \u03b7 was varied from 0 to 0.01. This deformation and noise model is simplistic and only serves the purpose of investigating the deterioration of the various integration schemes when the signal to noise ratio is varied. The difference in the true volume and the mean approximated volume is measured as a function of \u03b7. Jacobian determinant values were computed at every deformed grid point, and the integral was approximated using left point, midpoint, trapezoidal, and Simpson's rules. For each \u03b7, the experiment was repeated 100 times, and the mean of the approximated volume was recorded. The test involved keeping the grid size constant to 9 mm 3 . The actual deformation variation recorded on real scan-rescan data (the data used in the experiment in Sec. 6.3) in various substructures spatially scaled to the size of this experiment achieve a noise level of 2 \u00d7 10 \u22123 for ventricles to 9 \u00d7 10\nfor the hippocampus. From Fig. 5 , we observe the following: (a) as we begin with no noise in the deformation field, i.e., the beginning of the horizontal axis, JI using Simpson's rule expectedly has the highest order of precision among the integration schemes considered, (b) as the noise increases, i.e., as we move to the right on the horizontal axis, the accuracy in Simpson's, trapezoidal and midpoint decreases. As expected, SP and SC are identical, and they are more stable in the presence of noise. Hence, the choice of the integration scheme depends on the signal to noise ratio in the deformation field. Due the similarity, SP will be considered as a representative of VM."}, {"section_title": "Application on a Standardized Alzheimer's Disease Neuroimaging Initiative Dataset", "text": "In this section, we will test the various integrations schemes on a standardized ADNI subset for the diagnostic power of the atrophy computation. We apply SP to data from ADNI in order to inspect estimated atrophy scores in normal controls (NC) and AD patients, and to evaluate the diagnostic performance compared to JI. The clinical validity of the obtained atrophy scores is also checked by comparing the scores qualitatively to those from FreeSurfer."}, {"section_title": "Data", "text": "Data used in the preparation of this article were obtained from the ADNI database. 37 The ADNI was launched in 2003 by the National Institute on Aging, the National Institute of Biomedical Imaging and Bioengineering (NIBIB), the Food and Drug Administration, private pharmaceutical companies and nonprofit organizations, as a $60 million, 5-year public-private partnership. The primary goal of ADNI has been to test whether serial magnetic resonance imaging, positron emission tomography, other biological markers, together with clinical data and neuropsychological assessments can be combined to measure the progression of mild cognitive impairment and early Alzheimers disease. Determination of sensitive and specific markers of very early AD progression is intended to aid researchers and clinicians to develop new treatments and monitor their effectiveness, as well as lessen the time and cost of clinical trials, see Ref. 38 . The description of the ADNI standardized dataset used here can be found in Ref. 39 .\nWe analyzed baseline and 12-month follow-up 1.5 T1 weighted MRI volumes (169 AD and 101 NC). The demographics of the subjects can be found in Table 1 . The raw DICOM images were preprocessed using FreeSurfer's intensity correction method following which, the images were resampled as isotropic voxels of dimension 256 3 with each voxel of size 1 mm 3 . Segmentations used to define the ROIs (whole brain, ventricles, medial temporal lobe, and hippocampus) for quantification of atrophy were also obtained using cross-sectional FreeSurfer. 40 "}, {"section_title": "Experimental setup", "text": "For each subject in the ADNI dataset, the baseline and month 12 follow-up scans were registered using the parameters in Table 2 . The number of transformation levels, and thereby number of compositions, was three and five in the rigid and nonrigid registration, respectively. The volume change was computed from the resulting deformation field using SP and JI. JI was computed using both the left point rule, the midpoint rule, the trapezoidal rule, and Simpson's rule. Note that the ROIs are defined at baseline and the same exact ROIs were used for both the methods."}, {"section_title": "Metrics for evaluation", "text": "To characterize the performance of the various integration schemes, we recorded the mean and standard deviation of atrophy in the diagnostic groups as well as computed the diagnostic capability in terms of effect size measured as the Cohen's D and the area under the receiver operator characteristic curve (AUC). Cohen's D-disease specific effect size were computed as E Q -T A R G E T ; t e m p : i n t r a l i n k -; s e c 6 . where m 1 , s 1 and m 2 , s 2 are the means and standard deviations of NC and AD subjects respectively. To compute the p-value for the pairwise method comparison, we carried out a two-tailed t-test for the null hypothesis of equal measures N 1 \u2212 N 2 \u00bc 0, where N 1 and N 2 are independent random measures. We computed a probability distribution for the difference between the Cohen's D for the two measures and computed p as\n. 41 The p-values for comparing the AUCs were computed using the DeLong test. 42 Contrary to some previous studies, we do not exclude any potential outliers when computing statistics."}, {"section_title": "Detailed comparison of surface propagation and Jacobian integration (left point)", "text": "A detailed comparison between SP and JI computed using the left point rule is performed because this is the most widely used version of JI. In addition, we observe that none of the other integration schemes yield significantly better results, when compared to the left point rule, see Sec. 6.2.5. Only diagnostic group separation capabilities according to Cohen's D of the other schemes are tested against SP. As seen in Table 3 , JI generally exhibits higher mean and standard deviation than SP in both AD and NC. Both AUC and Cohen's D are generally higher for SP over JI. In a head-to-head pairwise comparison, SP shows significant improvement over JI (p < 0.01) in separating NC and AD based on whole brain and hippocampal atrophy, both according to Cohen's D and AUC. The numbers are similar or higher, however not significantly different, in ventricles and medial temporal lobe. After Bonferroni correcting the p-value threshold across ROIs (p < 0.05\u22154), SP still remained significant over JI in both hippocampus and whole brain. Further, after Bonferroni correcting the p-value threshold across ROIs and statistical measures (p < 0.05\u22158), SP remained significant over JI in whole brain."}, {"section_title": "6.2.5", "text": "Comparison of surface propagation and Jacobian integration using higher order integration schemes Using higher order integration schemes to compute JI do not yield any improvement, which is reflected in the Cohen's D values in Table 4 . As was the case when using the left point rule to compute JI, SP yields a significantly better separation between the diagnostic groups when atrophy is computed in the whole brain and in the hippocampus. The numbers a similar or slightly higher in medial temporal lobe and ventricles, yet not significantly different. Note, in order to perform a fair comparison between SP and JI using Simpson's rule, we subdivided each voxel into 3 3 \u00bc 27 smaller voxels effectively adapting Simpson's rule to a single voxel. Since the analytical expression of the transformation is available, the deformations are simply read out at subvoxel corners and centers."}, {"section_title": "Scan-Rescan Test Using In-House Data", "text": "To asses the variability of JI using the left point rule and of SP in measuring volume changes, we apply the same registration framework on an in-house dataset comprising nine pairs of scans from a coffee-table experiment and compute atrophy in the ROIs. We use the voxel-wise version of SP in assessing variance of the estimated volume changes. The motivation of this experiment is that we expect no structural changes to be seen when scanning a subject within a very small interval using the same scanning protocol.\nBoth JI and SP gave nonsignificant atrophies in the considered ROIs. The uncertainties in atrophy measurements were <1% in all the structures. If we zoom in and compare the variance in atrophy over 1000 random regions of each image, each sized 20 3 voxels, they differed. SP had a lower atrophy standard deviation of 0.79% than JI, which had a 0.97% standard deviation. Further, in a two-sample f-test to test the equality in the variances, SP was significantly different from JI (p < 0.01). The mean atrophy over these random regions were negligible and nonsignificant (atrophy \u00bc 0)."}, {"section_title": "Application on Deformation Fields from Localized Cross Correlation-Demons", "text": "In order to test how SP and JI compare when using deformation fields from a widely known and freely available registration method, we also applied SP and JI (left point) to deformation fields computed using localized cross correlation (LCC)-Demons 43 on the ADNI data used above (Table 3) . Note, since the deformation field is not available in analytical form, JI is computed using finite differencing and the deformation field is linearly interpolated to the corners of the cube in SP. We conducted experiments using the recommended intrasubject parameters 43 (\u03c3 laplacian \u00bc 1.0 and regularization/data term ratio 0.15), and with a less regularized setting (\u03c3 laplacian \u00bc 0.5 and regularization/data term ratio 0.05), were the latter was optimised for class-separation in the hippocampus. Here, we report the highest class-separation in terms of AUC (SP / JI): whole Brain (WB) 0.642 / 0.635, hip 0.59 / 0.58 Vent 0.78 / 0.78, medial temporal lobe (MTL) 0.65 / 0.66. For WB, Vent, and MTL these were achieved used the recommended regularization while the less regularised run gave highest separation for the hippocampus. The only significant (Delong and Delong) difference was achieved for WB, where SP is slightly more separating than JI. Notice that all AUCs are below those reported using deformation fields from the registration method in Sec. 4 (see Table 3 )."}, {"section_title": "Clinical Validity by Comparison to FreeSurfer", "text": "In addition to all the above experiments, we also present atrophy numbers from another popular segmentation software, Freesurfer, in order to inspect the validity of the obtained results (see Table 3 ). The mean atrophies of SP (and of JI) over different brain regions are close to those obtained by both cross-sectional 40 and longitudinal FreeSurfer, 25 albiet slightly on the lower side. The separation between AD and NC appears to be better than FreeSurfer. We do not perform any pairwise comparison to FreeSurfer, since FreeSurfer does not involve estimating atrophy from a deformation field which is the purpose of this paper."}, {"section_title": "Discussion", "text": "We propose SP as a method to estimate atrophy from a deformation field. In SP, the volume of a deformed object is obtained by summing the x coordinate of the surface triangle centroids weighted by the projected areas. We tested both SP and JI using deformations arising from a freeform deformation scheme, which uses NMI as a similarity measure. With SP, the surface-only simplification is not available with SC schemes, since the interior of the voxels need to be subdivided. The numerical properties of SC and SP are identical as validated by the synthetic experiment. For all practical applications, SP was used as a representative of VM methods for comparisons with JI. The main findings of this paper are that (1) synthetic experiments demonstrated that SP/SC is more robust than JI in the presence of moderate to severe noise; (2) SP produced whole brain and medial temporal lobe atrophy numbers that were significantly better than JI at separating between NC and Alzheimer's disease patients in a standardized dataset from the ADNI; (3) SP displayed significantly less variance at a local patch level when compared to JI using a small, in-house scanrescan dataset; (4) SP produced disease group atrophy differences comparable to or larger than those obtained using FreeSurfer in the standardized ADNI dataset, demonstrating the validity of the obtained clinical results. JI is usually obtained by summing the transformations' Jacobian determinant evaluated at voxel centers (left point rule). Higher order integration schemes like the midpoint, trapezoidal, and Simpson's rule can also be used to approximate the integral. Since a parametric registration scheme is used, the analytical expression of the transformation is available, analytical derivatives can be directly obtained at the sampling points. However, in the context of nonparametric registration schemes, the partial derivatives in JI need to be approximated with schemes like finite differencing in addition to the approximation in the integral. In case of SP and SC, the volume change information can be directly computed, since only the displacements are required. The synthetic experiments demonstrated that SP and SC are more stable and precise in the presence of noise as compared to JI using various integration schemes. We have derived the order of approximation of SP to be O\u00f0h 3 \u00de, where h is the maximum edge length of a surface triangle. This results is applicable for all methods using mesh-propagation for volume change computation, and is the same as the order of approximation of JI using the Trapezoidal integration scheme. Using Simpson's rule, the order of approximation for JI may become higher, but the synthetic example demonstrates that only in regimes with very low noise are these more accurate than meshpropagation.\nOne of the key features of SP is the manner of meshing. Only the surface of a cube is triangulated to estimate the volume. Since the normal of triangles on the interface between two voxels are in opposite directions, they cancel out leaving only the triangles on the outermost faces of voxels on the boundary contributing to the volume of the object. This property is not available with SC because the interior of the voxel needs to be subdivided too. Utilizing only the surface to estimate volume has applications beyond just gain in computational time. For instance, when regularization terms such as penalizing the determinant of Jacobian is used to preserve volume, rigidity is enforced on each voxel of the image. This may prevent larger deformations from being achieved. If the surface version of CP is used, regularity is enforced only on the global volume of a region allowing points inside the region to move more freely.\nIn the experiment on ADNI data, baseline and 12-month follow-up images were registered using the registration scheme described in Sec. 4. Regional volume change was then computed from the resulting deformation field using SP and JI formulated using the various integration schemes. Pairwise headto-head comparison with SP was performed with JI and its variations. SP-based measures present a significant improvement over JI-based measures in both hippocampus and whole brain. Figure 6 shows two outliers from Jacobian measures. After we discount for these two outliers, there is a marginal increase in Cohen's D to 0.64. However, SP was still significantly better than JI. Among the outlier's seen in Fig. 6 , we inspected them to find the reason for an exaggerated estimation of atrophy. We observed a differential bias (i.e., residual bias between the N3 bias corrected baseline and followup) in the images which lead to such an unrealistic atrophy estimation. Despite this, SP appears to measure atrophy closer to the NC mean, whereas the Jacobian measure is implausibly high.\nIn the brain regions with the most spatially varying deformation field (i.e., the hippocampus and whole brain), JI-based methods suffered the most. Whereas in region with the lowest variance, (i.e., the ventricles), the statistics were nearly identical. This could be explained as follows: (a) Since the registration is a composition of warps, the determinant of Jacobian is a very high-degree polynomial. Involvement of higher order terms tend to amplify any noise in the data with a relatively high variance thus truncating any gain from the use of the higher order terms. This may be one of the reasons why using higher order integration schemes did not yield any statistically significant improvements in the measurements over the traditional left point JI. (b) Homogeneity in the deformation field diminish the contributions from higher order terms making the integration schemes, regardless of their order, perform similar. It can be hypothesized that high regularity in the method and subsequently in the deformation field results in a similar performance of both JI and SP. This is reflected in the near identical results based on ventricular measures, where the deformation field varied the least. Similarly, the two methods give very similar results when based on the Gaussian smoothed deformation fields obtained with LCC-Demons, even though SP is slightly more (and significantly so) separating than JI in the whole brain measurements.\nWe choose dense sampling of evaluation points, since we intend to have high precision in clinically relevant regions such as hippocampus and cerbral cortex. The other relatively uniform regions were sparsely sampled. This type of sampling can introduce skewed distribution estimates for both the images potentially influencing NMI. It would be possible to compensate for such an effect by applying appropriate weights in the histogram and its gradients, and this is a topic for future work."}, {"section_title": "Conclusion", "text": "Much work has gone into improving various aspects of image registration such as image normalization, regularization, similarity measures. However, there has been very little effort in assessing the precision of integration methods that estimate volume changes from the resulting deformation field. Therefore, this study was mainly aimed at comparing JI-based methods to VM-based methods. In the process, we presented surface propagation-a modification of simplex counting with similar numerical properties but less computational complexity. For noisy deformation fields, we saw that JI-based schemes lose precision due to an incomplete representation of volume. In the scan rescan experiments, voxel-wise SP displayed significantly lower variability in measuring no-change than JI in randomly sampled regions. The improvements presented by SP over JI in separating diagnostic groups may also be extrapolated to SC, since SP and SC have the same numerical properties. In addition, the registration-based method together with SP presented in this study, enables a precise quantification of whole brain and regional atrophy based on successive structural MRI scans. The generalization of deformation-based morphometry to include other measures than volume change by the Jacobian determinant is interesting for several applications, e.g., Ref. 44 . This is a natural next step for cube-propagation."}]
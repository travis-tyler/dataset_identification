[{"section_title": "Abstract", "text": "Abstract-A method for automated segmentation of major cortical sulci on the outer brain boundary is presented, with emphasis on automatically determining point correspondence and on labeling cortical regions. The method is formulated in a general optimization framework defined on the unit sphere, which serves as parametric domain for convoluted surfaces of spherical topology. A statistical shape model, which includes a network of deformable curves on the unit sphere, seeks geometric features such as high curvature regions and labels such features via a deformation process that is confined within a spherical map of the outer brain boundary. The limitations of the customary spherical coordinate system, which include discontinuities at the poles and nonuniform sampling, are overcome by defining the statistical prior of shape variation in terms of projections of landmark points onto corresponding tangent planes of the sphere. The method is tested against and shown to be as accurate as manually defined segmentations."}, {"section_title": "I. INTRODUCTION", "text": "T HE cortex of the human brain is a thin convoluted sheet comprised of gyri and sulci, which are folds oriented outwards and inwards, respectively. It is believed that many cortical sulci are linked to the underlying cytoarchitectonic and functional organization of the brain, although this relationship varies throughout the cortex and is not well understood at present. Recently, there has been great interest within the brain imaging community in developing image analysis methods for characterizing sulcal shapes. Such methods would have several applications. First, sulci are natural pathways to deeper brain structures in certain neurosurgical procedures. Therefore, having better understanding of their structure is important in neurosurgical planning [1] . Second, it has been suggested that sulcal shapes are related to the underlying connectivity of the brain, since they are influenced by forces exerted by connecting fibers [2] . Therefore, shape analysis of the sulci is important in understanding normal variability, as well as in studying developmental disorders or effects of aging.\nThe third application of sulcal shape analysis is the primary focus of the work described in this paper. Specifically, sulci and gyri can serve as features for use in spatial normalization algorithms [3] - [5] . Spatial normalization is frequently used to map data to a stereotaxic coordinate system, by removing intersubject morphological differences, thereby allowing for group analysis to be carried out. The three-dimensional (3-D) Talairach coordinate system has been extensively used in the brain mapping literature, but surface-based coordinate systems have also been proposed for studying the cortex, which has a spherical topology when the hemispheres are artificially connected across the midline [6] - [8] .\nIn this paper, we describe steps toward building a statistical shape model of several major cortical sulci [ Fig. 1(a) ], by using the unit sphere as a stereotaxic space. Sulci are projected onto the unit sphere via a nearly homothetic mapping procedure [9] . Our model captures intersubject variability of the shape of the sulci and of the mean curvature along the sulcal curves. The statistical shape model for the sulcal curves is intended for use in automatic labeling and spatial normalization of cortical surfaces extracted from magnetic resonance images.\nPrevious attempts to build statistical models of the sulci have relied on graphs constructed from 3-D point-sets [1] , [10] , on ribbons used to model the space between opposite sides of a sulcus [11] - [14] , or on curves located on the outer cortical surface [3] . Related is the work in [7] and [15] , in which sulci are not explicitly modeled, but they are spatially normalized via a curvature matching procedure that stretches individual surfaces into conformation with an average curvature map. In [16] , 3-D points located over the sulcal fissures were modeled and an active shape model (ASM) search was used to locate and label anatomical features in brain images. In [17] , manually extracted sulcal points, located on the outer cortical surface, were spatially normalized via a robust point matching algorithm. Finally, there is also related work in [8] , where manually outlined fissures and sulci were matched in a spherical parameter space and a metric tensor field is used to overcome the location-dependent distortion and contraction of the spherical maps of the cortical surfaces.\nAs indicated in Fig. 1(b) , our sulcal model is comprised of curve representations of sulci, which are treated as parameterized curves defined on the unit sphere. The unit sphere plays the role of a stereotaxic coordinate space onto which the cortex is mapped via a distortion minimizing unfolding procedure. Our hypothesis is that by parameterizing the sulcal curves on the unit sphere, instead of treating them as curves embedded in three dimensions, we make their segmentation and labeling by an automated algorithm easier, since variability related to the embedding of the cortex in three dimensions is eliminated by spherical mapping. We note that the map from the unit sphere to the cortex readily provides segmentation and labeling of the sulci in three dimensions, which is our ultimate goal. We use a projection of each sulcal point onto a respective plane tangent to the sphere, thus overcoming limitations of the customary spherical coordinates, which include nonuniform sampling and discontinuities at the poles. The sulcal model on the unit sphere is applied to find and label sulcal curves on the spherical maps of datasets outside the training set, referred to as \"unseen\" datasets, using a fully automated hierarchical deformation scheme. Sulcal curves on the outer cortex are extracted via an inverse spherical mapping procedure. The hierarchical deformation scheme provides accurate registration results and is robust to suboptimal solutions. We note that since our model is constructed and applied on the unit sphere, it requires surface extraction and spherical mapping as preprocessing steps. These two steps are currently fully automated.\nAlthough the main focus of this paper is the cortex, our framework is described more generally in Section II, since it has potential application in a variety of problems involving finding point correspondence between surfaces embedded in three dimensions. In particular, our approach can be applied to most anatomical boundaries that have spherical topology. In Section II, we describe the general method for building a statistical shape model of curves on the unit sphere. In Section III, we apply the method to build a statistical shape model of sulcal curves of the human cortex. In Section IV, we describe how the model is used to automatically label sulcal curves on a dataset outside the training set. Experimental results and validation are provided in Section V; and finally in Section VI, we discuss these results, limitations of the method and plans for the future."}, {"section_title": "II. STATISTICAL SHAPE MODEL FOR CURVES ON", "text": "THE UNIT SPHERE A statistical shape model (SSM) is a statistical representation of a shape obtained from training data. One of the most popular SSMs is the ASM [18] , which consists of a mean shape, which is the average of the training data and a number of eigenmodes, which characterize the range of variation of the shape (c) When corresponding points on the two surfaces are compared directly in the embedding space, the resulting variability is the composite of the intrinsic variability and the variability introduced by the embedding of the surfaces. The variability introduced by the embedding of the surfaces is not of interest in the context of this paper. (d) When the surfaces are unfolded and mapped to the unit sphere, we can measure the intrinsic variability by comparing two shapes on the unit sphere, which serves as the canonical space on which the shapes lie and the shape variation is computed. Automatic segmentation and labeling is, thus, easier in (d) than in (c).\nfrom its mean. Intensity information is sometimes incorporated into the model to form an active appearance model [19] . SSMs have been applied to image segmentation with great success, especially in medical image applications, where boundaries between regions are weak in images and expert knowledge is necessary.\nTypically, a shape is represented as an ordered set of landmark points in Euclidean space. In this paper, we restrict our attention to space curves that reside on a surface embedded in three dimensions. We could view a set of space curves as a 3-D shape. However, in that case, the total variability of a space curve would be a composite of its own intrinsic variability, i.e., its position on the surface and of the variability caused by the embedding of the surface in three dimensions. The latter variability component can be eliminated by unfolding the surface and mapping its points to points on the unit sphere. This is demonstrated in Fig. 2 . We have chosen the unit sphere as the domain in which sulcal curves are defined in order to make our analysis independent of the embedding of the cortical surface. This makes automated labeling easier.\nIn this section, we describe a methodology for building a SSM for curves on the unit sphere, which serves as the canonical reference space. The SSM consists of two parts: a point distribution model that encodes shape variability and a statistical representation of the features sought by the SSM."}, {"section_title": "A. Procrustes Fit on the Unit Sphere", "text": "The first step toward constructing our statistical shape model is to apply a Procrustes fit [20] , which eliminates the variability introduced by translation, scaling and rotation of the shapes. The standard Procrustes fit for shapes on a two-dimensional (2-D) plane is as follows [18] , [20] : first, translate each shape so that its centroid coincides with the origin of the 2-D plane; second, scale each translated shape so that the coordinate vector of the shape has unit norm; and finally, rotate each shape to minimize its distance from the mean shape. We extend this approach to shapes defined on the unit sphere. As in the planar case, we need four parameters to specify the location, size and pose of a shape on the unit sphere. We use and for \"translation,\"\nfor size and for pose. 1 Suppose that we have training sample shapes, , , lying on the unit sphere in . Each shape is represented by a list of landmark points, , . The coordinates ( , , ) satisfy 1. The Procrustes fit on the unit sphere proceeds as follows: First, each shape is rotated so that its centroid is on the axis. This step is equivalent to the translation step in the planar case. Second, one shape is arbitrarily selected to be an initial estimate of the mean shape. Third, for each shape, the spherical patch containing the curves is scaled and rotated around the axis to minimize the misalignment with respect to the estimated mean shape. Fourth, the mean shape estimate is recalculated using the aligned shapes obtained from the third step. The third and the fourth steps are repeated until a satisfactory result is achieved. This procedure results in a mean shape and four parameters, , , , and , which align each shape with the mean shape. In this paper, we use to denote this transformation and to denote the transformed shape of that is aligned with the mean shape. Also, , , and , ."}, {"section_title": "B. Constructing a Local Coordinate System", "text": "On the unit sphere, there exists a natural coordinate system, namely the spherical coordinate system. However, we cannot use the spherical coordinates ( , ) of our landmark points to calculate the shape variation directly, for three reasons. First, the and coordinates of a given landmark point in a collection of training samples do not generally follow a normal distribution. This makes it inaccurate to approximate the shape distribution using mean and covariance. Second, because the sphere is not homeomorphic to , the coordinate has a discontinuity at the poles. The discontinuity in the coordinate system makes it impossible to find a smooth mapping to warp the model to the data. Third, points close to poles display an artificially high variation in and coordinates, simply because the and iso-parametric curves are very dense near the poles.\nIn order to address the above problems, we have designed a SSM for curves on the unit sphere in the following way. Let be the average position of the th landmark point, which has spherical coordinates (1, , ) , and . The mean shape can be represented as a vector . For the th landmark point, we construct a tangent plane to the unit sphere through [see Fig. 3 (a)]. The tangent plane can be written as (Note that is a unit vector and is also the normal vector of the tangent plane.) On the tangent plane , we define an orthogonal coordinate system with being the origin. There are infinitely many ways to do this and we have chosen a specific coordinate system that is consistent for all landmark points. We first rotate the original coordinate bases , and around the axis by \nIn order to compute the eigenvariations of the shape, we project the th landmark point of all training samples, , , onto the tangent plane and compute their coordinates in the , coordinate system. In this paper, we use a radial projection as shown in Fig. 4 . For the th landmark, the coordinates of the radial projection on the tangent plane in the , coordinate system are ( ), where\nWe note that after the Procrustes alignment, the range of variation of any landmark is typically small enough for the tangent plane to form a reasonable approximation of the respective spherical patch."}, {"section_title": "C. Statistical Shape Model", "text": "Now we can form a coordinate vector for the th training sample as follows:\n, . The covariance matrix can then be estimated as (5) By applying principal component analysis (PCA), we get the largest eigenvalues of the covariance matrix and the corresponding eigenvectors, which correspond to the most significant eigenmodes. Let the eigenvalues be , the corresponding eigenvectors be and be the matrix containing the eigenvectors (6) The eigenmodes, together with the mean shape, can be used to approximate any new example through the following procedure: 1) Project each landmark point of a new example to the corresponding tangent plane and calculate the coordinates in the coordinate system defined in (1) and (2). 2) Form a vector of coordinates . 3) Project to the subspace spanned by eigenvectors to get (7) 4) Reconstruct the shape using and the mean shape . The coordinates of the th landmark point in the reconstructed shape are given by (8) In addition to the global shape properties reflected by , we also compute the statistics of local properties at each landmark point. In particular, we compute the mean and the variance of the mean curvature at each landmark point on the surface. Let , , , be the mean curvatures at landmark points for training samples. The mean and the variance of the mean curvature at each landmark point are computed as (9) (10) The statistics on mean curvature, together with , are then used for deformable registration of the statistical shape model to the spherical map of a new subject. As we will discuss in Section VI, the local properties that can be incorporated in the statistical shape model are not limited to the mean curvature, but can be described by a vector of attributes [21] - [23] . When the attribute vector is rich enough, it can be used to distinguish different features with little confusion. For example, in [23] we showed that geodesic depth can help distinguish among cortical sulci that superficially might look similar. In this paper, we use the mean curvature alone because it proved to be sufficient for the particular application of Section III."}, {"section_title": "III. BUILDING A SSM FOR SULCAL CURVES ON THE OUTER CORTEX", "text": "In this section, we describe the steps involved in constructing our statistical model of a number of major sulci and fissures. First, parameterized curves running along the major cortical sulci are manually extracted during the training stage. These curves are then transformed to the unit sphere and are aligned as described in Section II, resulting in a number of parameterized curves serving as training examples. From these curves, we build a sulcal model as described in Section II."}, {"section_title": "A. Definition and Representation of Sulcal Curves", "text": "The superficial edges of sulci are curves lying on the outer cortex [3] , [23] . They are the curves modeled in this paper [see Fig. 1(a) ]. The outer cortex is obtained using a deformable surface model [9] , which \"shrink-wraps\" around the outer brain boundary. During the deformation procedure, we also obtain a spherical map of each outer cortical surface. This is because the sphere surrounding the brain tissue used to initialize the deformable surface is a parameterized surface. When it deforms to the outer cortex, each point on the sphere moves to a point on the cortex. Conversely, each point on the outer cortex is mapped to a point on the sphere. Because of the internal forces imposed during the deformation procedure, the spherical map obtained is nearly homothetic, which keeps the distortion small. This nearly-homothetic spherical map reduces the dependency of our method on the parameterization of the cortical surfaces and is used later to map sulcal curves on the outer cortex to the sphere so that the unit sphere can be used as a canonical space on which the statistics are computed and the automatic labeling is carried out.\nSulcal curves representing major sulci and fissures are extracted manually by a trained rater on the outer cortical surfaces of the training samples. The sulci and fissures being modeled are the following: interhemisphere fissure, central sulcus, precentral sulcus, postcentral sulcus, superior frontal sulcus, inferior frontal sulcus, Sylvian fissure, and superior temporal sulcus in both hemispheres [see Fig. 1(a) ]. These sulci and fissures mainly distribute on the lateral surface of frontal and temporal lobes. In order for the rater to extract those curves consistently, we designed a set of rules for defining the curves according to brain atlases [24] , [25] .\nSulci are well known to present variable topology across individuals. In particular, sometimes they are continuous curves and sometimes they can be interrupted and composed of two or more pieces. Moreover, they can have branches sprouting off the main curve. We have adopted a simplified model, which is justified by our main motivation, the deformable registration. Specifically, we use a single curve to represent a sulcus. When the sulcus is interrupted, this single curve bridges over the interruption. This is shown schematically in Fig. 5 . We do not attempt to follow side branches of a sulcus, as those are highly variable and do not lend themselves to procedures for defining point correspondences.\nDuring the procedure for extracting sulcal curves, the rater always refers to one labeled template brain. The rater designates the starting and ending points for each sulcus as well as a number of other anatomical landmark points corresponding to points where two or more sulci meet. Sulcal curves between anatomical landmark points are parameterized with a constant speed parameterization and a predetermined number of points are placed between landmark points. This results in a large number of quasi-landmarks, automatically generated. This is different from the automatic landmark generation method proposed in [26] , where landmarks are generated by using a polygon-based nonrigid correspondence procedure. In this paper, by picking the anatomical landmarks and then generating the quasi-landmarks, we immediately establish the point correspondences between different shapes (see Fig. 6 ).\nThe network of the sulcal curves on one brain cortex is represented by a list of anatomical landmark and quasi-landmark points lying on the outer cortical surface. Let , , be training samples, each with landmark points. By using the spherical mapping described above, we can map each onto the unit sphere and get . Shapes , are used to build the statistical shape model of the sulcal curves on the unit sphere."}, {"section_title": "B. SSM of Sulcal Curves on the Unit Sphere", "text": "The training samples , , are shapes lying on the unit sphere, each with landmark points , , . First, the shapes are aligned in order to exclude the variation introduced by translation, scaling and rotation. The Procrustes fit for the network of sulcal curves on the unit sphere is done by using the procedure described in Section II-A. During the Procrustes fit procedure, for each shape we obtained the four parameters , , , and that align the transformed shapes , . The means and the variances of these pose parameters are also computed. We denote these parameters by , , , , and , , , , respectively.\nAfter the shapes are brought into alignment, the statistics of the shapes are readily computed using the method described in Section II-B. The resulting statistical model consists of a mean shape and a number of eigenmodes arranged in the matrix [ (6)]. With this model, any new shape can be approximated by its projection onto the model space. In addition to the eigenvalue and eigenvectors, we also calculate the statistics of the mean curvature at each landmark point using (9) and (10) . The mean curvature at each landmark point for a dataset is computed from the 3-D cortical surface by fitting a quadratic surface patch locally to the cortical surface around the landmark point.\nSo far, we have obtained the statistical shape model for sulcal curves on the outer cortex. The model includes the following: the mean and variance of the location of the shape on the unit sphere , , , and ; the mean and the variance of the size of the shape and ; the mean and the variance of the pose of the shape and ; the mean shape and the coordinate bases and for the tangent plane passing through the th landmark point, ; the eigenvalues and corresponding eigenvectors of the training samples; and statistics, and , of the mean curvature at each landmark point ."}, {"section_title": "IV. AUTOMATIC EXTRACTION OF SULCAL CURVES", "text": "The model built using the algorithm described above can now be used to search for and label sulcal curves in a brain image outside the training set, whose outer cortex and spherical map of the outer cortex are obtained using a deformable surface model [9] . To do this, we have developed a registration procedure comprising two steps: initialization and deformable registration. In the initialization step, the mean shape is placed onto the spherical map of the brain image outside the training set. Then by searching for the best values for , , , and in the intervals obtained from the training stage, the best estimation for the sulcal curves in the unseen image is found and deformable registration can be performed thereafter using a hierarchical scheme."}, {"section_title": "A. Initialization", "text": "In the initialization stage, the mean shape obtained from the training samples, , is scaled and rotated. The mean curvature of the unseen dataset at the position of each landmark point on the rotated and scaled mean shape is compared with the mean curvature statistics collected during the training stage in order to find the best pose for . During the process of building the statistical shape model, we observe that some of the sulci, such as interhemisphere fissure and central sulcus, have relatively smaller shape variation and mean curvature variance than other sulci. Therefore, we are relatively more confident about the location and the attributes of these sulcal curves. This fact enables us to focus more on a small number of curves in order to get a good estimation of the pose of the shape in the new data set without excessive computation.\nWe define the following cost function: (11) where is the weight for each landmark point in the model and is the distance between and the point in its neighborhood which has the most similar mean curvature as the th landmark point in the model has. The searching region, , , , and , is divided into octrees and optimal solution for the cost function defined above is obtained by searching the leaf nodes of the octrees. In the worst case where the cost function is constant in the searching region, this octree search becomes exhaustive search.\nThe weighting parameter depends on the shape variation and mean curvature variance at th landmark point. In this paper, is defined as: , where is the standard deviation of the mean curvature for the th landmark point; and are the standard deviations of the landmark point in the directions of two bases of the corresponding tangent plane (see Fig. 3 ). For points with small shape variation and small mean curvature variance, is assigned to be large. Then a large penalty will be added to the cost function if such a point has a very different mean curvature from the model. On the contrary, for points with large shape variation and large mean curvature variance, we let be small to avoid sub-optimal solutions. The result of this step, , is then used as an initialization for the deformable registration stage."}, {"section_title": "B. Deformable Registration", "text": "In this stage, the shape obtained from initialization, , is deformed according to the statistical shape model to find and label the sulci in a new spherical map. The deformation is performed using a hierarchical scheme similar to the one described in [22] . During the deformation, some curves, referred to as active curves, are deformed first. Other curves, referred to as passive curves, follow according to the statistics of the shape. In the beginning of the deformation, we choose curves with small shape variation and small mean curvature variance to be active and other curves to be passive. Because the statistical shape model is relatively more restrictive to the curves with small shape variation than to the curves with large shape variation, there is less chance for the initial active curves to be deformed to wrong locations. As the deformation proceeds, more and more passive curves join the deformation and finally all curves are active. This hierarchical deformation scheme can help achieve a robust and accurate registration result. At each iteration , the deformable shape has a configuration . The algorithm is as follows.\nStep 1) Deform according to the information of the respective spherical map. This information currently includes mean curvature. i) For each active landmark point on , we first search in its neighborhood on the unit sphere with a given radius to find a number of candidate points , , which have similar mean curvature [ Fig. 7(a) ]. ii) For each candidate point we tentatively displace the point and propagate the deformation to the neighboring landmark points with an exponential decaying function to get a tentative shape [ Fig. 7(b) ]. The coordinates of the th landmark point in the tentative shape is given by (12) where is the radius of influence of the deformation of the th landmark point on its neighboring landmarks and is the distance between th and th landmark points along the sphere. iii) Pick the candidate point that minimizes the following cost function: (13) where is the index set of landmark points being affected by the deformation described in ii) and is the mean curvature evaluated at . The cost function defined above is the square of the Mahalanobis distance with cross correlation terms ignored. After this deformation process is applied to all active landmark points, we get a deformed shape . Effectively, this procedure deforms pieces of the model, not just individual points. The tentative deformations are examined via integration of the energy function along the whole piece. This guarantees a smooth deformation and also helps avoid local minima.\nStep 2) Use statistics of the shape to approximate :.\ni) Transfer using transformation with proper parameters , , and to bring it into alignment with the mean shape ; ii) Project each point on to the corresponding tangent plane and compute its coordinate with respect to the orthonormal basis of the plane using (3) and (4). iii) Approximate the shape with the statistical shape model by using (7) and (8) to get ; iv) Use transformation on to get an approximation of : .\nStep 3) Finally, we introduce an inertia to the system, in order to further encourage smooth and gradual deformations, as follows:\nThis procedure is repeated until convergence, which is achieved when the difference between the results of two successive iterations is small enough. At each iteration of the deformation, there are three parameters: , , and , whose values must be selected. controls the size of the neighborhood of each model point in which we search for the candidates; controls the radius of influence of an active landmark on segment; and is the weight assigned to the approximation of the shape by the model. During the deformation, we change the parameters in order to achieve a robust and accurate result. In the beginning of the deformation, is set to be large, so that each model point searches in a large neighborhood for a good match. Large is necessary in this stage, in order to assure that the true match is reached.\nis also set to be large so that a large piece of curve segment tends to deform together according to exponential decaying function. Because is large, the deformation can be large. Large can keep the curves smooth and prevent self intersections. In the mean time is close to one so that is close to . The parameters , and are determined empirically. From our experiments, we found that the algorithm is not very sensitive to those parameters; so, we used the same set of parameters for all the experiments reported in this paper. The parameters are initially set to be 0.15, 0.07 and 0.5. In the process of deformation, they are reduced so that the searching and the deformation are more local and deformation term from data becomes more dominant. Finally, these parameters are 0.05, 0.02 and 0.1. This deformation scheme with changing , and helps achieve a robust and accurate result. The deformable registration procedure described above is different from the standard ASM search [18] in the follow aspects. First, instead of moving individual landmark points, we deform an entire curve segment around a landmark point all at once and the energy function is evaluated over segments. This produces a smooth deformation field and tends to preserve the topology of the sulcal network. Hence, the deformation is less likely to be attracted to local minima. Second, in the process of deformation, we decrease the searching area and increase the weight of the deformation term in (14) . This strategy helps us to achieve a more accurate result because the deformed shape is more faithful to the image data when it is close to its true location."}, {"section_title": "V. RESULTS AND VALIDATION", "text": "In this section, we provide experimental results and quantitative validation for our automatic sulcal extraction method described in Section IV. All magnetic resonance imaging (MRI) data used in this paper were obtained from the Baltimore Longitudinal Study of Aging [27] ."}, {"section_title": "A. Statistical Shape Model", "text": "In the work presented here, we studied several major sulci and fissures on the outer cortical surfaces of human brains. The sulcal curves were manually extracted by a trained rater; 108 data sets were used to build the statistical shape model. Fig. 8 shows some of the examples in our training data. The top row shows the sulcal curves on the outer cortical surfaces and the bottom row shows the sulcal curves after being mapped to the unit sphere. The gray level indicates the thresholded mean curvature on the cortical surfaces. By performing the Procrustes fit described in Section II, we obtained the aligned shapes, whose 50 eigen-variations explain more than 98% of the variation presented by the training data. Fig. 9 shows the four most significant eigen-variations. In Fig. 9 , the thick gray curves in each figure show the mean shape. The thin black lines indicate how a point can vary around its mean to 3 in the directions of the first four eigenmodes."}, {"section_title": "B. Automatic Sulcal Labeling", "text": "In this experiment, we used the statistical shape model obtained from 108 training samples to automatically find the sulcal curves of 14 new datasets. The outer cortical surfaces and the respective spherical maps were first extracted from the MR brain images as described in Section III. The mean shape of the SSM was then placed on the top of the spherical representation of the outer cortical surfaces and linearly transformed to find the best match by using the method described in Section IV [see (11) ]. The results of the linear registration were then used as the initialization for the nonlinear registration. Fig. 10 shows four registration results. The top row in the figure shows the results of the initialization step, the middle row shows the results of deformable registration on the unit sphere and the bottom row shows the final results on the actual brain boundaries. It is observed that the registered shapes on the unit sphere (middle row) follow more closely the regions that have high mean curvature. These regions, of course, correspond to the sulci on the brain, as shown in the bottom row."}, {"section_title": "C. Validation", "text": "In order to validate our automatic sulcal extraction method, we measured two kinds of errors: correspondence error and labeling error."}, {"section_title": "1) Correspondence Error:", "text": "We first compared the sulcal curves extracted by two trained human raters using the same set of rules with the sulcal curves extracted by our automated algorithm. We decomposed the correspondence error into two components, the tangential and the normal, as shown in Fig. 11 . We do this because the tangential component reflects a sliding of corresponding points along the sulcal curve and is by nature less well defined because correspondence along the sulcal curves cannot be defined accurately. However, the normal component reflects direct failure of the algorithm to find the sulcal curves in the target image.\nSuppose that and are curves extracted using two different methods and let and be corresponding points on and , respectively. Also, let and be the unit tangent vectors of and at and (see Fig. 11 ). Then the tangential error and normal error between and are defined as (15) (16) where is the Euclidean norm. Note that, in general, . So we also define the symmetric error measures and . Table I shows the mean and the standard deviation of the symmetric tangential correspondence errors, , between algorithm and rater and between the two raters. Table II shows the mean and the standard deviation of the symmetric normal correspondence errors, , between algorithm and rater and between two raters. Algorithm-rater errors are measured between the curves extracted by algorithm and the average of the curves extracted by two raters. The errors shown in the tables are in millimeters, measured along the outer cortical surface after the curves are mapped back from their position on the unit sphere. Therefore, since the errors are fairly small, they roughly reflect the geodesic distance on the outer cortex. The tables show that the error between the results of the automatic method and the results from the human rater is comparable to the interrater error.\n2) Labeling Error: Although we have focused on sulcal extraction, since sulci are used as features that can drive a deformable registration algorithm, our ultimate goal is to accurately align and measure the gyri that we enclosed by the sulcal curves [see Fig. 1(a) ]. Therefore, we also measured a third kind of error, namely the gyral labeling error. For example, central sulcus, precentral sulcus, a part of Sylvian fissure, and a part of interhemispheric fissure together define the precentral gyrus. In order to find how good our automatic algorithm is at labeling precentral gyrus and postcentral gyrus, we measured the areas of four well-defined gyral regions, namely the precentral gyri and postcentral gyri on both hemispheres, defined by our algorithm and by human raters. We also measured the percent overlap of the gyral regions between human-rater-defined and automatic-algorithm-defined gyral regions. Table III shows the area difference and percent overlap of the gyral regions. From the table, we can see that the gyral regions defined by our automatic algorithm are comparable to those defined by the human raters. Fig. 12 shows the gyral regions defined by two methods. The left column shows the regions defined by our automated algorithm and the middle and the right columns show the regions defined by two human raters."}, {"section_title": "VI. DISCUSSION", "text": "We have proposed a method for building statistical shape model for curves lying on surfaces with spherical topology. The statistical shape model is then used to find curves with similar properties in datasets outside the training set using a deformable Table I ."}, {"section_title": "TABLE III LABELING ERROR OF FOUR GYRAL REGIONS", "text": "AR: algorithm-rater; RR: rater-rater. Gyral regions are: 1,2-precentral gyri on left and right hemispheres; and 3,4-postcentral gyri on left and right hemispheres. registration procedure. We applied the method to build the statistical shape model for some major sulcal curves on the outer cortex of the human brain and used the model to extract sulcal curves in new datasets using a hierarchical deformation scheme.\nThe novelties of the work lie on both the statistical shape model and the hierarchical deformation scheme. First, the statistical shape model is built on the unit sphere so that the \"intrinsic\" variation of the shapes is separated from the variation introduced by the 3-D embedding of the underlying surfaces. The shape variation is computed using the coordinates on the tangent planes of the unit sphere to avoid problems with spherical coordinate system such as nonuniform sampling and discontinuity at poles. Second, a hierarchical deformation scheme is used to extract sulcal curves in datasets outside the training set. During the deformation, certain sulci are initially used to drive the deformation and the energy function is evaluated over segments at a time, thus helping avoid local minima. Also, the values of various model parameters, such as the size of searching neighborhood and the inertia, are adapted during the deformation process to achieve accurate registration.\nOur experimental results showed that the result of our automated algorithm is comparable to the manual definition of the sulci, in that the algorithm-rater error is similar to the rater-rater error. In the absence of a gold standard, we cannot calculate at this point what the absolute accuracy of the algorithm is. However, we can conclude that it can be used to replace laborious manual definition [4] , [13] . Moreover, we expect that our method will result in more unbiased segmentation, since it is fully automated.\nIn this paper, we use the mean curvature on the outer cortex as the only attribute for each landmark point during the procedure of building the statistical shape model and deforming the model to find the sulcal curves. This gives good results for the sulcal curves on the outer cortex. However, the attributes can be much richer. As pointed out in [22] , as the attributes become richer, they are more descriptive and are more capable of distinguishing features that superficially might look similar. In [23] , we examined the geodesic depth along a few major sulci and concluded that by looking at the depth profile of a sulcus, we can often distinguish it from others since their depth profiles are very different. However, the attributes are not limited to curvature and depth; they can also include the geometric relationship of a landmark point with its neighbors [22] . We have found that the statistical priors of ASMs tend to significantly reduce the model's ability to capture finer shape details, particularly when relatively few training samples are available. An attribute vector like the one in [22] helps overcome this limitation by adding robustness to the deformation process and allowing us to reduce the influence of the statistical prior, thus capturing the fine details of a shape. When we project the cortical surface to the unit sphere, we lose all the 3-D information of the surface, such as 3-D surface position [8] and surface norm [16] . This information can also be helpful in distinguishing different sulci and could possibly be included in the attributes. Investigating various attributes will be a topic for future work.\nThe proposed method using a statistical shape model and a hierarchical deformation scheme gives robust and accurate results, which are comparable to the sulcal curves extracted manually by human raters. However, in some cases, the automated algorithm may give large errors for superior frontal sulcus (SFS) and superior temporal sulcus (STS), which have large shape variation and large variation in mean curvature along the curve. One typical example is shown in Fig. 13 . The middle part of the superior frontal sulcus on the left hemisphere is attracted to the wrong place. From the top row of Fig. 13 , we can see that the initial position of SFS is close to its true position. During the early stage of the deformation, large segments of curve tend to move together smoothly. This deformation strategy prevents curves from being attracted by details and, hence, makes the algorithm robust. In this stage, the SFS is moved toward interhemisphere fissure in order to achieve a better global match. Part of the SFS is moved into the region with high confusion (indicated in the top row by dashed circles). In the later stage of the deformation, the searching region is smaller and each landmark is influenced by fewer of its neighboring landmarks so that the middle part of the SFS does not have much chance to to be pulled back to where it should be. To improve the deformation strategy will be another topic for future work.\nThe general framework proposed in this paper can be extended to the application of building a statistical shape model for sulcal fundi and using the model to extract fundal curves on the full cortex. However, since the full cortex is a highly convoluted surface, a large distortion will be introduced during the procedure of mapping the full cortical surface to the unit sphere. Therefore, the curves on the unit sphere will display a very different variability from the true intrinsic variability (see Fig. 2 ) of the fundi on the actual cortical surface. In order to apply the method to build statistical shape model for sulcal fundi, we must take this distortion into account. This will be another important topic for future work."}]
[{"section_title": "Abstract", "text": "A semi-automated vertical feature terrain extraction algorithm is described and applied to a twodimensional, depth-integrated, shallow water equation inundation model. The extracted features describe what are commonly sub-mesh scale elevation details (ridge and valleys), which may be ignored in standard practice because adequate mesh resolution cannot be afforded. The extraction algorithm is semi-automated, requires minimal human intervention, and is reproducible. A lidar-derived digital elevation model (DEM) of coastal Mississippi and Alabama serves as the source data for the vertical feature extraction. Unstructured mesh nodes and element edges are aligned to the vertical features and an interpolation algorithm aimed at minimizing topographic elevation error assigns elevations to mesh nodes via the DEM. The end result is a mesh that accurately represents the bare earth surface as derived from lidar with element resolution in the floodplain ranging from 15 m to 200 m. To examine the influence of the inclusion of vertical features on overland flooding, two additional meshes were developed, one without crest elevations of the features and another with vertical features withheld. All three meshes were incorporated into a SWAN+ADCIRC model simulation of Hurricane Katrina. Each of the three models resulted in similar validation statistics when compared to observed time-series water levels at gages and post-storm collected high water marks. Simulated water level peaks yielded an R 2 of 0.97 and upper and lower 95% confidence interval of \u223c \u00b1 0.60 m. From the validation at the gages and HWM locations, it was not clear which of the three model experiments performed best in terms of accuracy. Examination of inundation extent among the three model results were compared to debris lines derived from NOAA post-event aerial imagery, and the mesh including vertical features showed higher accuracy. The comparison of model results to debris lines demonstrates that additional validation techniques are necessary for state-of-the-art flood inundation models. In addition, the semi-automated, unstructured mesh generation process presented herein increases the overall accuracy of simulated storm surge across the floodplain without reliance on hand digitization or sacrificing computational cost."}, {"section_title": "Introduction", "text": "Physics-based, two-dimensional, unstructured mesh flood inundation models governed by forms of the Navier-Stokes equations are used to study historic flooding events and assess future flooding scenarios. Enhanced knowledge of overland flow physics, improved data collection methods, and superior scientific computing technology have resulted in a transition from structured grids to unstructured mesh models [1] [2] [3] [4] [5] [6] . An unstructured triangular mesh is the medium for which a continuous domain (e.g., Earth's surface) can be are now being used to estimate potential flood risk under future global climate change scenarios and sea level rise (SLR) [14] [15] [16] [17] [18] as well as biological assessments of inter-tidal salt marshes [19] .\nThe overarching goal when designing an unstructured mesh is to accurately represent the natural system while maintaining a given computational cost [7] . The density and topology of computational points (mesh nodes) and the alignment of element faces across the floodplain must be critically examined. To reduce computer run times and increase the usability of the models, unstructured meshes are restricted to a minimum element size. This element size limitation induces numerous discretization errors such as the variances of the planar triangular elements from the true surface (mesh elevation error). If mesh node density is too coarse or nodes are not appropriately placed, important hydraulic terrain features may be smoothed-out, particularly in the floodplain, and lead to inaccurate model results [20] . The floodplain introduces a high order of non-linearity due to higher spatial variability in both topography and drag forces. This results in steeper solution gradients than those found in consistently wetted areas (i.e., ocean basins, rivers, lakes, etc.). Additionally, the floodplain may contain anthropogenic features that do not belong to the bare earth surface from which inundation model elevations are derived. However, these man-made features are included as part of the Earth's surface as they are (relatively) impervious with respect to inundation [20, 21] .\nIncreasing model resolution within the floodplain may permit an enhanced representation of the bare earth topography; however, submesh scale features (referred to as vertical features herein) exist that are not properly described by unstructured elements without additional treatment. Some of these features are obvious (e.g., levees and raised roadbeds) and are included in standard digitization practices. However, other features may escape visual recognition or are not included because they are too narrow to be discretized with adequate resolution (e.g., natural ridges, valleys, creeks, etc.). All such features can impact the path, pattern, duration, and magnitude of overland flooding, as well as modify flooding frequency [21, 22] .\nIt is crucial that vertical features be appropriately and accurately included in inundation models, especially in urban regions where flood risk can drastically change with minor differences in inundation extent [20] . Bates et al. [23] employed an 18 m lidar-derived digital elevation model (DEM) to simulate flooding in the River Severn using the LISFLOOD-FP raster-based two-dimensional inundation model. Key topographic features such as embankments and flood walls were found to be smoothed by the coarse DEM. These key features were identified from the UK Ordnance Survey Landline vector data and their elevation was sustained at the model scale. Purvis et al. [24] hand digitized significant terrain features from UK Ordnance Survey maps and their crest elevations obtained from lidar data were added back into a 50 m DEM for use in a LISFLOOD-FP inundation model along the UK coast in Somerset, South-West England. Schubert et al. [20] developed a semi-automated method to use MasterMap \u00ae geospatial data to guide unstructured mesh generation to model flooding in Glasgow, Scotland using the BreZo shallowwater flow model. The mesh generation software Triangle [25] was used to align mesh vertices and element edges to terrain features, keeping hydraulic connectivity within the mesh. Gallien et al. [26] aligned mesh nodes to topographic features prone to overtopping. Polylines of the terrain features that were used in mesh generation were obtained from real time kinematic (RTK) surveys and orthoimagery. Experiments were performed using the BreZo model for four different meshes with vertex elevations derived from the lidar DEM, RTK surveyed elevations in addition to the uncertainty in RTK and lidar elevations. It was shown that accurate flooding depths can be obtained if hydraulic features are accurately surveyed and included in the inundation model. Hurricane storm surge models of southeastern Louisiana using ADCIRC [27] have included levee systems, interstate and state highways, and railroads that are raised above the neighboring topography and are defined as weirs by their respective crown heights. However, the weir boundary condition in ADCIRC does not allow for wave overtopping and indirectly increases node count as each weir mesh node must have a neighboring pair [28, 29] . These studies highlight the necessity of including hydraulic connectivity in inundation models and methods for which to do so. However, the scales at which some state-of-the-art river reach and coastal inundation models are constructed, often spanning large geographic regions, discourage manual digitization of vertical features for inclusion in these models. Additionally, public or private data containing man-made hydraulic features are not always available, are outdated and require manual digitization, or require traditional land surveying [30] . This creates an opportunity for the development and application of an automated feature extraction algorithm to guide floodplain unstructured mesh generation, which is a major objective of this paper.\nMethods for extracting geomorphic features from DEMs is not a new problem (see Table 1 for a general summary). However, establishing automated methods is not straightforward [30] . Low-relief landscapes are particularly challenging due to their low topographic gradient and anthropogenically influenced landscape and channel networks [31] . There have been a number of attempts to extract river and channel networks from DEMs and high resolution lidar data, including flow direction and curvature based methods [31] [32] [33] [34] [35] [36] [37] . Passalacqua et al. [31] extended the ability of GeoNet to automate the extraction of channel heads and networks using dense lidar data in a flat and human-impacted region. Mason et al. [36] developed a semiautomated method to extract tidal channel networks from lidar data in Venice Lagoon that was superior to standard methods of river network extraction when applied to tidal channels.\nSimilarly, several methods have been proposed to extract ridge features from DEMs, and in general are concentrated on extracting breaklines and watershed boundaries. Early work in ridge feature extraction was done by comparing a point's elevation relative to its surrounding points or neighbors [32, [38] [39] [40] . Briese [41] and Brzank et al. [42] used shape fitting methods to extract breaklines from lidar data by using geometric objects with shapes that roughly match the desired terrain elements. Contour line methods mimic human methods of feature extraction by locating points of maximum curvature and connecting them as ridges or ravines [43] . However, these methods pose several issues when using contour lines derived from lidar. For example, they may miss features such as highways with flat tops or slight grade [44] . Watershed delineation techniques [45] [46] [47] are promising for ridge feature extraction because a watershed boundary satisfies the intuitive definition of a ridge; water on the ridge will fall downhill in opposite directions.\nAutomated techniques for detecting anthropogenic ridge features from lidar have been proposed, particularly for levee systems, dikes, and roadways [22, 48, 49] . Several studies have applied image analysis techniques for feature extraction that mainly focus on edge detection [44, [50] [51] [52] . However, these methods generally do not precisely detect ridges in a geomorphologic sense (i.e., declare ridges based on water flowing down-gradient).\nThese approaches are not focused on terrain extraction with respect to generating a well conforming unstructured finite element mesh to model shallow water hydrodynamics. Therefore, this work addresses a significant lack in published literature dealing with unstructured mesh generation across low-gradient landscapes. Since the primary concern is an accurate computation of inundation area, the overland portion of the mesh must accurately capture raised features such as road beds, topographic ridge lines and valleys that serve to limit and route overland flow. Additionally, the geographic placement of computational points must be accompanied by an accurate topographic elevation.\nIn this paper, we present a reproducible and novel semiautomated method to extract vertical features (ridges and valleys) from a lidar DEM for use in the development of flood inundation models. The semi-automated methods presented are not fully standalone and require data processing steps coupled with manual intervention. These enhancements improve the description of sub-grid scale features (horizontal and vertical alignment) and the overall accuracy of floodplain elevations in the model. We employ methods to describe the overland terrain as accurately as possible, with mesh building criteria based on local element size that aim to quantify and minimize topographic elevation error. The goal is to present a semi-automated mesh generation method that can be employed to generate topographically accurate unstructured meshes for shallow water hydrodynamics across any geographic region.\nWe begin with a description of the methods used to generate a lidar-derived DEM for the coastal Mississippi and Alabama floodplains ( Fig. 1) and continue with the presentation of the semiautomated vertical feature extraction algorithm. Next, the generation of three unstructured finite element meshes are discussed and each are employed in a Hurricane Katrina storm surge simulation. Results of each simulation are compared against time-series water levels and high water marks in addition to debris lines in post-storm aerial photography."}, {"section_title": "Materials and methods", "text": ""}, {"section_title": "Inundation model", "text": "Hydrodynamics are simulated using the SWAN+ADCIRC model framework. ADCIRC solves the 2D shallow-water equations for water levels and depth-integrated currents [27, 29, 53] . SWAN, a thirdgeneration wave model, solves for relative frequency and wave direction using the action balance equation for wave-current interactions [54, 55] . The SWAN and ADCIRC models are coupled to run on the same unstructured mesh, removing the need for interpolation between model grids [56, 57] . The ADCIRC timestep is 1 s and the SWAN timestep is 600 s. Every 600 s (in alignment with the SWAN timestep), ADCIRC passes water levels and currents to SWAN and SWAN passes wave radiation stress gradients back to ADCIRC. Wave frequencies in SWAN are discretized into 40 bins (log scale) spanning the frequency range of 0.031384 to 1.420416 Hz and wave directions are discretized into 36 equal interval bins of 10\u00b0 [1] . Parameters employed in SWAN include wave growth due to wind based on Komen et al. [58] and Cavaleri and Rizzoli [59] and the modified whitecapping formulation of Rogers et al. [60] . Depth-induced wave breaking in shallow water is computed via Battjes and Janssen [61] with the maximum wave height over depth (wave breaking index) \u03b3 = 0.73. Bottom friction is tightly coupled with ADCIRC, where Manning's n is applied via Madsen et al. [62] to compute roughness length at each mesh node for each time step. Convergence must be met at 95% of the grid points and the maximum number of iterations per SWAN time step is limited to 20. Also note that SWAN limits the spectral propagation velocities to deter false wave refraction in regions of inadequate mesh resolution [63] . These parameters are similar to those employed in recent SWAN+ADCIRC models of similar geographic scale and mesh resolution in Louisiana and Texas [1, 64] . "}, {"section_title": "Unstructured mesh generation", "text": "Generation of an unstructured finite element mesh includes several phases, beginning with a representation of the bare earth land elevation, the most important factor in gravity-driven hydrodynamics [65] (Fig. 2) . The lidar-derived digital elevation model (DEM) is the source dataset by which local node density is determined (mesh size distribution function) and drives the semi-automated vertical feature extraction. The outer model boundary coupled with internal constraints (vertical features) guide the unstructured mesh triangulation in the interior of the domain. Elevations for each mesh node are then interpolated from the original lidar-derived DEM. A detailed description of these methods are discussed in the following sections."}, {"section_title": "Digital elevation model", "text": "A lidar-derived DEM for Baldwin and Mobile Counties, Alabama, and Jackson, Harrison, and Hancock Counties, Mississippi from the shoreline (0 m elevation contour, NAVD88 [North American Vertical Datum of 1988]) to the 15 m (NAVD88) contour was developed to represent present-day conditions. In all, two DEMs were constructed (overland and water) and merged to create a seamless topographic/bathymetric (topobathy) DEM.\nThe Terrain Data Set (TDS) framework within ArcGIS 10.0 was utilized to generate the topographic DEM [66] . A TDS was created for each county using the most recent and available source data: lidar, hydrographic breaklines, and hand-digitized shorelines based on satellite aerial imagery. Specifics about the lidar sources can be found in Bilskie et al. [3, 67] . A 5 m DEM from each county's TDS was created using natural neighbor interpolation and then combined (mosaic). A 5 m DEM is sufficient when modeling the terrain in coastal Mississippi for hurricane storm surge applications [67] .\nA similar TDS framework was utilized for creating a bathymetric DEM. Sources of bathymetry are NOS (National Ocean Service) hydrographic surveys, USACE (U.S. Army Corps of Engineers) channel surveys, NOAA (National Oceanographic and Atmospheric Administration) nautical charts, and previous finite element meshes. The topographic and bathymetric DEMs were merged at the shoreline to create a seamless source elevation dataset."}, {"section_title": "Vertical feature extraction", "text": "Including significant terrain features in the mesh involves two main steps: locating the features and mapping the features to the finite element mesh in a manner that preserves element quality. The method described here for locating ridge or valley lines (ridges and valleys herein refer to natural or man-made features) begins by extracting watershed boundary lines in a manner that preserves element quality. Points along the watershed boundary lines are then examined relative to the surrounding terrain to determine what portions of the watershed lines represent significant features. Features chosen for inclusion are converted from high-resolution feature lines extracted at the DEM resolution to edges suitable for assembly in the mesh by redistributing vertices in the feature lines. The redistribution of vertices conforms to the element size available from a twodimensional size function that provides desired element size as a function of geographic position. Once included in the mesh, the crest of each feature is represented by one or more element edges whose nodes are assigned the crest elevations.\nFor a natural or man-made feature to merit purposeful inclusion in the model, it must possess three traits: (1) be long enough and (2) high enough to form a significant barrier to local surge propagation; (3) be narrow enough so that careless placement of triangular mesh elements would cause a significant elevation error. The final criterion is needed because of the inability of a discretized mesh to represent features with length scales smaller than the local element size. Such features are often described as sub-grid scale; a common example of a feature that in general meets these three metrics is a raised road bed. Road beds are often long enough and high enough to affect surge propagation, and, depending on the local element size, they are often narrow enough to permit a triangular finite element to overlay the feature with nodes positioned only on the surrounding lower terrain.\nThe methods for detecting and including raised features in an unstructured mesh generally follow and expand upon the procedures [68] and ideas from Roberts [69] . The pseudo-code for the main vertical feature extraction algorithm is presented in Fig. 3 and the minimum extraction parameters are shown in Table 2 . The algorithm and parameters used rely upon past experience employing the methods in large overland meshes. They have been well tested and adopted by FEMA along the entire Florida Panhandle and Alabama coasts for the development of digital flood insurance rate maps [11, 68, 70] . The feature extraction process is initialized by extracting boundary lines for very small area watersheds. The assumption is that significant barriers to surge propagation will be captured as watershed boundaries. A parameter driven examination of the watershed boundary lines and DEM is then completed, relating the elevation at each point in the boundary lines to the surrounding area in the DEM. The objective is to extract portions of the watershed boundaries that define vertical feature crests meeting the length (long enough), relative elevation (high enough), and steepness or vertical curvature (narrow enough) criteria discussed above. The subjective length, relative elevation, and vertical curvature criteria are converted to objective metrics by defining several measurable parameters and setting required minimum values. The process for evaluating each criterion will be discussed in the order in which they are considered during the extraction process: elevation, vertical curvature, and length."}, {"section_title": "Elevation parameters", "text": "Watershed boundaries were extracted from the DEM as discrete lines formed by the vertices in the DEM cells. Each watershed boundary line vertex was initially assigned a significant, continue, or insignificant attribute by comparing the elevation at its DEM location to elevations at locations generally perpendicular to the direction of the watershed line (Fig. 3) . The important parameters in this case were the perpendicular distances evaluated and the elevation differences required. Two perpendicular distances were used, an inner and outer range. The inner range was related to the local element size by the size function and will be discussed in the vertical curvature parameters section. The minimum elevation difference required at the inner range was 0.3 m. The outer range was fixed at 200 m throughout the mesh (Table 2) . If a point on the watershed boundary line was at least 0.3 m above the terrain perpendicular at the variable inner range on both sides of the watershed line, and at least 0.5 m above the terrain perpendicular at a distance of 200 m on at least one side of the watershed line, it was declared significant (Fig. 4a) . If a vertex was not declared significant, it was further evaluated to determine if its elevation was more than 0.1 m below the surrounding 20,000 square meters of terrain (a square region with side lengths of approximately 141 m) ( Table 2) . When the vertex met this criterion, it was declared insignificant. This evaluation generally prevents a feature line from being constructed across a flow path in a manner to block flow. Vertices that met neither of the criteria above were declared \"continue\" with the exception that the maximum length of consecutive continue points was not allowed to exceed 200 m (Fig. 3) . Further in the process, the ratio of \"significant\" vertices to total vertices in a line was considered and lines with a value lower than 0.35 were eliminated."}, {"section_title": "Vertical curvature parameters", "text": "The objective of the vertical curvature evaluation is to limit the maximum error due to sub-grid scale raised features by placing an upper bound on their elevation error. The curvature evaluation calculates the elevation difference between each point on the extracted feature line and points perpendicular on either side of the feature at a distance equal to half of the planned element size as determined by the mesh size function. This evaluation is similar to calculating the maximum elevation error between the feature and the surrounding element's node elevations if the element were placed in the worst possible configuration (Fig. 4b and c) . The elevation limit for this evaluation was 0.3 m ( Table 2 ). As described in the previous section, if the elevation difference between the point on the feature line and both perpendicular points exceeded 0.3 m, the vertical curvature criterion was met."}, {"section_title": "Length parameters", "text": "The length parameters are included to limit features to those long enough to influence flow. However, the practical purpose of the length parameters is to limit the number of disconnected line features that are included in the overall set. As the number of discrete features in a given area is increased, the quality of the mesh in the area decreases since adding a great number of features as element edges results in poorly shaped elements.\nIn the simplest form, an extracted line can be compared to a minimum line length parameter to decide if it should be included in the final line set. However, in practice the decision is more complicated because the initial extraction considering only the parameters listed in the above two sections generally results in a network of lines that intersect at several junctions. Each line is weighted by a normalized value of the average elevation difference between the ridge crest and the perpendicular elevation comparison locations. This weighting factor multiplied by the line length is used to determine the priority for joining lines. A graph search routine is employed to connect the features with the largest weighting factor to retain the highest features, which promotes appropriate triangulation during the meshing procedure (Fig. 3) . For joining lines at junctions, lines are joined first with the maximum possible weighting. These trunk lines were required to exceed 1000 meters to be included in the feature set (Fig. 3) . Additional lines that intersect trunk lines were retained if they exceeded 500 m (Table 2) ."}, {"section_title": "Vertex redistribution", "text": "The next step in preparing the lines for inclusion in the mesh is to redistribute the line vertices to approximate the desired local element size, as the lines will form the edges of elements when imported to the mesh. The process again uses the initial finite element mesh as the size function for determining the desired local element size."}, {"section_title": "Manual assessment", "text": "The final step in preparing the lines for inclusion in the mesh is a manual assessment. Although the process is generally automated, visual inspection of the features is necessary before they are included in the mesh. The vertical feature lines are scanned for distances between separate lines, duplicate lines, small line segment angles, and disconnects between upstream and downstream valley lines. If two vertical feature line segments are within 1.5 times the local element size, then they are trimmed. For example, if a vertical feature line follows a road that passes over a creek, then the line segments are trimmed to allow proper flow distribution through the creek. Downstream and upstream valley lines are connected if they are considerably close, and ends of line segments are trimmed if the angle is too sharp for the local element size to appropriately follow.\nThe final number of vertical features for the three coastal counties in Mississippi and Baldwin and Mobile Counties in Alabama exceeded 7100 features lines including 3786 ridge and 3407 valley lines (Fig. 5) . Each of the vertical features is an exact representation of the DEM at the vertices along the feature line. The next step is to incorporate the vertical features into an unstructured mesh."}, {"section_title": "Mesh generation", "text": "Herein, mesh development is specific to the nearshore and floodplain regions of Mississippi and Alabama (Fig. 1) and consists of two major steps; 1) node placement (i.e. meshing) and 2) interpolation of the elevation dataset to the mesh nodes. Offshore in the deep waters of the Gulf of Mexico and Atlantic Ocean, the mesh was based on recent models including the SL16, SL15, and earlier EC2001 tidal models [1, 29, 71] . The Louisiana floodplain, east of the Mississippi River is as described in the SL15/16 ADCIRC models and are included to allow the attenuation of storm surge that affects hydrodynamics along the Mississippi and Alabama coast.\nDuring the mesh generation process, three variations of unstructured meshes were developed for the Mississippi and Alabama floodplains; MSAL, MSAL_noVF_z, and MSAL_noVF. The MSAL mesh contains vertical features along with their crest elevation; MSAL_noVF_z contains the same node placement as MSAL barring the crest elevation of the vertical features. The MSAL_noVF mesh does not include vertical features, but is similar in node density as the MSAL and MSAL_noVF_z meshes."}, {"section_title": "Unstructured mesh node placement", "text": "Two unstructured meshes were generated using vertical features as interior constraints, MSAL and MSAL_noVF_z, and were constructed as follows. The final set of vertical features (ridges and valleys), along with the shoreline and domain boundary, serve as the template, or conceptual model, for the placement of mesh nodes and the orientation of element edges across the floodplain. As stated prior, the final form of the vertical feature lines are a suite of lines that have their vertices redistributed according to a size function mesh. The minimum node spacing (15 m) is determined based on a target time step (here, 1 s) and the maximum node spacing (here, 200 m) is estimated based on the maximum vertical elevation error. In regions of small meandering channels, large variation in topography or surface roughness, or areas of interest, element sizes are closer to the minimum, whereas regions near the inland boundary or areas outside the area of focus receive coarser node spacing. Additionally, spatially varying mesh resolution was determined from a rigorous topographic elevation error assessment presented in Bilskie and Hagen [3] . Since the vertices of the vertical feature lines have been appropriately redistributed along their length to match the local, spatiallyvarying mesh resolution, the lines can serve as the basis for the mesh generation.\nAquaveo SMS (Surface Water Modeling System) version 11.0 [72] was used to generate the unstructured mesh. SMS utilizes a scalar paving algorithm to place nodes and elements within a boundary. Element size within a polygon is based on the node vertex spacing of the boundary polygon, a size function dataset (scalar paving density), or both. The floodplain domain was decomposed and the mesh was generated from west to east, with internal mesh boundaries constructed from vertical feature lines. Once all of the internal meshes were complete, they were merged to form a single floodplain unstructured mesh. The third mesh, MSAL_noVF, was generated in a similar fashion; however, vertical features were not included. The outer floodplain and interior river and bay boundaries, as used for the MSAL and MSAL_noVF_z meshes, were the only constraints applied in mesh generation. This resulted in a mesh of similar nodal density across the floodplain, but mesh nodes and element faces were not aligned to vertical features.\nMesh resolution is appropriately 24 km in the deep Atlantic Ocean, 4 km in the Gulf of Mexico, and 500 m along the Mississippi/Alabama shelf. As shown in Fig. 6a , mesh resolution along the barrier islands and within Mississippi Sound is as low as 60 m along the dredged shipping channels to a maximum of 200 m elsewhere. Resolution at the shoreline is generally consistent at 100 m, but is as low as 15 m within narrow tidal creeks and canals. Overland mesh resolution ranges from 20 m to 100 m in the expected inundation zone, and coarsens to 200 m toward the mesh boundary along the highest elevations. The high resolution within Mississippi Sound and along the shoreline is necessary in order to capture the momentum transfer due to breaking waves."}, {"section_title": "Assignment (interpolation) of elevation", "text": "Mesh nodes are assigned elevations using two types of criteria. A node is deemed a vertical feature node if it lies along a vertical feature line; otherwise it is attributed as a normal floodplain node. Vertical feature nodes are assigned elevations, via the DEM, based on direct lookup. That is, the value of the DEM grid cell the node resides in is assigned to that node, regardless of where it falls within the grid cell. This is done to ensure that the highest high or lowest low elevation is included in the mesh, according to the feature type of ridge or valley. All nodes are treated as normal floodplain nodes in the MSAL_noVF_z and MSAL_noVF mesh. Normal floodplain mesh nodes obtain their elevations from the cell-area averaging (CAA) interpolation method [3] : \nThe CAA interpolation scheme aims to minimize the vertical elevation error at a mesh node by averaging CA number of DEM grid cell elevations about a given radius (N), measured in the number of DEM cells. The radius varies from node to node and is based on the local element size ( M ) and DEM grid cell size ( DEM ). In regions of high element resolution (dense node spacing) the radius is small and in regions of coarse elements the radius is large. Fig. 7 shows an example of the meshing and interpolation process for a site in Pascagoula, MS. For coastal Mississippi, errors between the unstructured mesh and source lidar range from about 11 cm to 70 cm with mesh elements ranging from 20 m to 160 m, respectively [3] .\nThe final MSAL and MSAL_noVF_z mesh contains 3,674,458 nodes and 7,318,668 elements; MSAL_noVF contains 3,743,067 nodes and 7,455,886 elements. Therefore, the computational cost among the three meshes are similar. Fig. 6b presents the MSAL ADCIRC model elevations (bathymetry and topography) for Mississippi and Alabama. Details in the elevations are evident in the shipping channels in Mississippi Sound, the variations of depths along the barrier islands, and rivers, including the Pascagoula and Mobile-Tensaw among the numerous regions of low-lying salt marsh and narrow tidal creeks."}, {"section_title": "Surface roughness parameters", "text": "ADCIRC includes three spatially variable measures of surface roughness: bottom friction (Mannings n coefficient), vertical shielding of wind due to dense canopies (surface canopy coefficient), and directional reduction of the wind (effective roughness length) based on the local landscape characteristics (i.e., skyscrapers, dense forest, or open water) [73] . In the floodplain, Manning's n is spatially varying and assigned based on LULC. In this study, we utilize the Coastal Change Analysis Program (C-CAP) post-Katrina LULC dataset (http: //www.csc.noaa.gov/digitalcoast/data/ccapregional/), other datasets such as the Mississippi Gap Analysis Program (MS-GAP) (http:// www.basic.ncsu.edu/segap/index.html) or the National Land Cover Database (NLCD) (http://www.mrlc.gov/). The advantage of C-CAP is it spans multiple states, therefore providing consistent coverage and classification types within the study domain. In addition, C-CAP is well suited for classification of inter-tidal zones, the areas that are more likely to be flooded during a hurricane event. Mannings n values for C-CAP LULC classifications are taken from Dietrich et al. [1] and listed in Table 3 . For water bodies, bottom friction on the continental shelf is based on the composition of bottom sediments, sand (0.022) or mud (0.012) [74] . In areas with depths less than 5 m, Mannings n is set to 0.025 along the shoreline and is interpolated based on depth to the local shelf value. In depths between 200 m and 5 m, Mannings n is set to the local shelf value, and depths greater than 200 m, Mannings n is set to 0.012. Narrow, shallow, meandering channels are assigned values of 0.03-0.035 [75, 76] .\nThe surface (or wind) canopy adjustment accounts for the ability of the wind to penetrate the canopy and transfer momentum to the water column. In densely forested canopies, there is negligible transfer of momentum due to the forest canopy shielding the water surface from the wind stress, ultimately creating a stratified two layer system [73, 77] . Canopy is interpolated onto the mesh nodes in a similar fashion as Mannings n. The C-CAP grid cell that lies on the ADCIRC mesh node is determined and the canopy value for the given land cover class is assigned to the node. The LULC classes are mapped and converted to their respective canopy coefficient, 1 (no canopy) or 0 (canopy) ( Table 3) .\nThe anisotropic z 0 value reduces wind speed at a location based on upwind conditions. This is especially important in the nearshore Table 3 shows z 0 values for C-CAP LULC classes. ADCIRC determines the correct z 0 value to apply based on the instantaneous local wind direction at runtime [73] ."}, {"section_title": "Vertical datum offset", "text": "The MSAL mesh elevations are referenced to NAVD88 (North American Vertical Datum of 1988), but the SWAN+ADCIRC model should be initiated with water surface elevations at zero mean sea level (MSL). To account for local differences between MSL and NAVD88, a vertical datum offset was established. To adjust the vertical datum from NAVD88 to MSL, an offset of 0.13 m is added to the model [29] . An additional offset must be added to account for the seasonal variation in the Gulf of Mexico due to thermal expansion of the upper stratum of the water column; the offset was 0.10 m, based on analysis of local NOAA tide gage stations. Therefore, the initial water level in the model was set to 0.23 m (0.13 m + 0.10 m)."}, {"section_title": "Meteorological and tidal forcing", "text": "The simulated flood event is Hurricane Katrina as it has been extensively studied and well validated in terms of its wind field and flooding [18, 29, [78] [79] [80] . Additionally, Katrina generated unprecedented water levels and inundation extent in coastal Mississippi, thereby putting sufficient stress on the developed overland meshing techniques for testing. Therefore, each mesh is included in a SWAN+ADCIRC simulation for Hurricane Katrina. The simulation begins from a cold start on 08/15/2005 12:00 UTC and forced with astronomic tides for 10 days, beginning with a 7 day hyperbolic ramp to establish a dynamic steady state. The astronomic tides (O 1 , K 1 , P 1 , Q 1 , M 2 , S 2 , N 2 , and K 2 ), derived from Oregon State's TPXO7.2 tidal atlas [81, 82] , are forced along the open ocean boundary (60\u00b0W meridian), in deep water, where tidal amplitudes and phases are well known. Wind forcing and wave radiation stresses are added on 08/25/2005 12:00 UTC for 5 days, yielding a total simulation length of 15 days. Simulated wind speed and direction, significant wave height, wave direction, mean and peak wave period, and water surface elevations will be compared to recorded data.\nWind and pressure fields for Katrina were developed using a blend of objectively analyzed measurements and modeled winds and pressures as described in Bunya et al. [29] . This study applies the same Katrina inputs as Bunya et al. [29] and Bilskie et al. [14] , which used H * Wind [79] analysis in the core of the system. The approach in developing the tropical wind and pressure fields has been documented and verified in numerous ocean response studies including Hope et al. [64] "}, {"section_title": "Design of experiment", "text": "Three experiments were performed to examine the influence of vertical features on mesh elevations and water levels due to hurricane storm surge. Each of the three meshes were included in a hydrodynamic simulation representation of Hurricane Katrina and model results were compared to measured time-series water levels, HWMs, and post-storm aerial images of debris lines."}, {"section_title": "Results and discussion", "text": ""}, {"section_title": "Time-series water levels comparison", "text": "Each of the unstructured meshes (MSAL, MSAL_noVF_z, MSAL_noVF) were included in an hydrodynamic simulation representative of Hurricane Katrina using the SWAN+ADCIRC code and model setup described above. For each simulation, simulated time-series of water surface elevations were compared to observed data. The observed water surface elevations were obtained from NOAA, USACE, and USGS gage stations throughout Mississippi and Alabama (Fig. 8) . Fig. 9 presents the time-series water levels for the observed and modeled data at a select number of stations within the nearshore region. At all locations, the simulated water surface elevations among the three simulations are similar; no substantial differences are observed. The modeled water levels match the amplitude and phase of the astronomic tide signal leading up to the main surge event, and the models match the rising water surface elevation, peak surge (if recorded in the observed data), and falling limb of the hydrograph. To quantify errors between simulated and observed time-series water levels, Scatter Index (SI) and bias metrics were computed [64, 84] :\nwhere N is the number of data points, E is the error between the model (M i ) and observed (Table 4 ). All 22 stations for which statistics were computed yielded a weighted average SI of 0.22 and bias of \u22120.02 (with respect to the number of stations). Using the traditional, point-based, time-series water surface elevation validation technique, all three model simulations produced accurate results. There was no discernible difference in the statistics among the simulated MSAL, MSAL_noVF_z, and MSAL_noVF water surface elevations when compared to the observed data at the gages. This is caused by the fact that the gages are located in open water, and the results are not sensitive to differences in inundation across the floodplain. The methods by which the floodplain is included in Fig. 8 . Location of the USACE storm tide elevation sensors (gray), USGS streamgages (black), and NOAA tide gages (red) with measured Hurricane Katrina time-series water levels along the Mississippi-Alabama coast. Hydrographs are shown of stations with labels. The ADCIRC model boundary is in black. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.) Table 5 Error summary for simulated vs. observed HWMs among the three model experiments. The number of HWMs refer to the final set after removing erroneous measurements and HWMs with errors outside the CI 95% band. MAE is mean absolute error and SD is standard deviation."}, {"section_title": "Model", "text": "No. HWM |Error| < \u00b10.5m the unstructured mesh did not alter the results at the gages, as long as the floodplain is included to allow storm surge attenuation [85] . With this, focus is turned to the assessment of each of the models performance within the floodplain and begins with a comparison of observed HWMs."}, {"section_title": "High water mark comparison", "text": "There are a total of 340 HWMs recorded by FEMA and the USACE throughout Mississippi and Alabama in the wake of Hurricane Katrina. A HWM model performance analysis was conducted in which all available measured HWMs were compared to the simulated maximum water level for each of the three simulations. The HWMs were plotted and the 95% confidence interval (CI) was computed:\nCI 95 =\u0112 \u00b1 1.96 \u00d7 \u03c3 (5) where\u0112 is the mean error and \u03c3 the standard deviation of the errors.\nCI 95 was used to determine outliers in the HWMs for closer inspection of error in the measurements or errors within the SWAN+ADCIRC model. HWMs were removed if they met one of the following conditions: 1) The HWM was suspected to be the result of surface runoff or flooding due to precipitation and not storm surge, 2) the field HWM was suspected to have errors, or 3) the HWM resided outside the computed 95% confidence interval. To determine if a HWM was caused by precipitation and not storm surge, the location of the point was considered along with peak surge values from neighboring HWMs. If the point was located near a stream and significantly upstream, and nearby HWMs included lower measurements, then the point was removed. In some instances, these HWMs were obtained from storm tide sensors which made it easy to determine if the peak was caused by surface runoff. Additionally, a HWM was removed if it was found on the upstream side of a culvert; this introduces numerous sources of error such as a clogged culvert pipe or backwater effects. For the second criteria, we examined field notes for the HWMs and removed them if key words in the field report such as \"poor debris line\" or \"clogged culvert\" were found. For the third criteria, HWMs that included error that lie outside the CI 95 were removed.\nThe upper and lower CI 95 for the full 340 Katrina HWMs were \u223c \u00b1 1 m, for each simulation. A majority of the HWMs that were removed resided along Little Lagoon, west of Fort Morgan Peninsula. ADCIRC under-predicted maximum water levels along this region which appeared to be caused by high water levels within the lagoon itself. Hurricanes Katrina and Ivan (2004) triggered the formation of an inlet west of the original, which would lead to an increase in flooding of the lagoon and across the peninsula [86] . In addition, since the MSAL model was constructed from the most recent lidar data available, per FEMA guidance, this region contained post-Katrina lidar. The current dune heights represented by the MSAL model are about 1 m higher than pre-Katrina dune heights, which prevented overtopping of the peninsula in the simulation, and therefore lower water levels within the lagoon.\nAfter the error analysis from the first two conditions, 19 HWMs were eliminated, and 321 remained for the comparison to simulated maximum water levels and analysis of the 95% confidence interval (Table 4 ). The MSAL resulted in further elimination of 19 HWMs based on the confidence interval analysis. Of the 302 HWMs, 274 (90.7%) were within \u00b1 0.5 m (Table 5) . Similarly, the CI analysis for the MSAL_noVF_z and MSAL_noVF resulted in elimination of 19 and 20 HWMs, and 273 (90.4%) and 270 (89.1%) were within \u00b1 0.5 m, respectively. The slope of the line of best-fit, for all experiments, is 1.0 with an R 2 of 0.97 (Fig. 10) . The mean absolute error (MAE), standard deviation (SD) and upper and lower 95% CI were similar (5).\nResults did not improve or diminish among the three experiments with respect to the HWM analysis, which was an unanticipated result of this work. Numerous HWMs were located in regions where vertical features influenced inundation extent; however, the simulated water surface elevation at the HWM locations were not altered by the vertical features, only the flooding extent. This is addressed in the following section, and it is shown that the inclusion of vertical features increases model accuracy with respect to inundation extent."}, {"section_title": "Post-Katrina aerial imagery comparison", "text": "Post-Katrina aerial photographs captured by NOAA revealed the wide spread damage caused by Hurricane Katrina (http://ngs. woc.noaa.gov/storms/katrina/). The imagery enables a qualitative model validation of inundation extent, particularly along local high elevation gradients, such as near vertical features. Turning focus to coastal Mississippi, specifically near Gulfport, similar flooding extent is observed between the MSAL and MSAL_noVF_z simulations, although there were some minor increases in inundation extent. On the other hand, the MSAL_noVF model estimated flooding further inland. Here, simulated inundation between the MSAL and MSAL_noVF_z were compared to the debris line found in the NOAA post-Katrina aerial imagery. The first image is located just west of Gulfport Harbor and between E. Beach Blvd. and E. Railroad St. Fig. 11a shows that inundation was blocked by E. Railroad St. in the MSAL model, but is not the case in the MSAL_noVF model result (Fig. 11b ). E. Railroad St. is included in the MSAL model as a vertical feature. In other words, surge propagated past E. Railroad St. as if it were not there (or had similar elevation to the surrounding land). Close inspection of the aerial image depicts a debris line between and along E. Railroad St. and 2nd St. From the image, there is no discernible debris north of Railroad St. caused by storm surge; however, some debris may be present, but was likely caused by wind than surge. Although there is debris along E. Railroad St., and it is likely that surge piled up along the roadway, the MSAL model is not able to inundate up to the roadway due to the limitation of the local element size (60-100 m in this location) and the wetting and drying algorithm. In order to simulate inundation closer to the roadway, without removing the vertical feature, would be to decrease the local element size sub-20 m. Additionally, the SWAN+ADCIRC model simulation does not include waveinduced runup. Regardless, the MSAL model appropriately simulates the inundation front and inhibits surge from incorrectly overtopping E. Railroad St. at this location.\nThe HWM at this location has a value of 7.59 m (NAVD88) and a simulated error of \u22120.25 m. The location of the HWM demonstrates the cause for the similar HWM errors among the three models. Since the models without correct vertical feature representation generally increased flooding extent, the location of the HWM were inundated in all three model simulations. The simulated maximum water surface elevation at this HWM location would not be expected to vary due to the overtopping of the ridge feature. The only plausible scenario in which the maximum water surface elevations were expected to be different is if the ridge feature had a drastically higher elevation than the surrounding terrain and surge accumulated, but never overtopped the roadway, yielding a large maximum water surface elevation. This water surface elevation would be higher than if the roadway was not described and surge was not able to pile up and inundate the region north of the roadway.\nMoving east along the coast, Fig. 11c and d depict a similar story. There is a tremendous amount of debris between E. Railroad St. and the shoreline, but not north. The MSAL correctly represents the storm surge inundation. However, the MSAL_noVF_z model result yields overtopping of E. Railroad St. This is incorrect when examining the debris line. The measured HWM in this region is 7.25 m (NAVD88), with a simulated error of \u22120.09 m. As previously described, the maximum storm surge is not expected to vary drastically as because both models simulated flooding this region. Similar findings would be obtained regardless of the number of HWMs collected. This indicates that state-of-the-art flood inundation models, and storm surge models in particular, are now becoming accurate enough that traditional point-based validation methods (e.g. gage based time-series and HWM comparison), which are acceptable in comparing total water levels, are limited in their ability to validate inundation extent ( [87] ).\nThe comparison of storm surge inundation extent against postevent imagery allows a semi-empirical validation beyond pointbased methods of maximum water levels. This enables a more rigorous validation and exhibits the necessity for having accurate terrain data in the flood inundation model, specifically vertical features. From this analysis, it is evident that the MSAL model better represents the extent of inundation and is therefore a more accurate surge model than the other two models, without reliance on hand digitization or sacrificing computational cost."}, {"section_title": "Flooding extent comparison", "text": "In order to determine the impact of the additional flooding extent from the MSAL_noVF_z and MSAL_noVF models, each were categorized into inundated regions with and without urban infrastructure. The 2006 post-Katrina CCAP LULC was sorted and binned into two land classifications, urban and rural within Mississippi and Alabama (open water was left out of this reclassification). For each of the two classes, the additional inundated area was computed from the MSAL_noVF_z and MSAL_noVF simulations. MSAL_noVF_z inundated an additional 1.5 km 2 and 9 km 2 for urban and rural area, and MSAL_noVF inundated an additional 10.3 km 2 and 44.8 km 2 , respectively. To expand these results further, the urban space is related to population density. The city of Gulfport, MS has a population density of 730.61 people per square km and contains 340.60 housing units per square km (http://www.gulfport-ms.gov/census.shtml). Extrapolating this population density across the Mississippi-Alabama coast may result in an additional 1096 people and 511 housing units affected in using the MSAL_noVF_z model and 7525 people and 3508 housing units with the MSAL_noVF model results. This result may be of critical importance when designing and operating a real time forecasting flood inundation model, especially when used to guide evacuation planning and the deployment of first responders.\nIn addition to modifying inundation extent, the inclusion of vertical features also altered the timing of the flood and recession wave. In using the MSAL_noVF model, some regions flooded several hours earlier than the MSAL model, especially along highways that are overtopped. Furthermore, not only did the inclusion of raised features limit overtopping during the incoming flood, but also inhibits the recession of the flood as it flows back to the ocean."}, {"section_title": "Summary and conclusions", "text": "To accurately represent overland flooding due to hurricane storm surge, it is imperative that the numerical model includes an accurate representation of the overland terrain. We employed a novel and largely reproducible framework to guide semi-automatic unstructured mesh generation across a coastal floodplain via the inclusion of vertical terrain features and accurate assignment of mesh nodes using a bare earth lidar-derived DEM. These methods administered the density and location of mesh nodes and alignment of element edges as guided by the landscape. Therefore, it is recommend that the DEM be developed before mesh generation begins so as to link the natural terrain to the unstructured mesh and ultimately to the flood inundation model. These semi-automated approaches were scaled and applied for the generation of a wind-wave hurricane storm surge model for the Mississippi and Alabama coast. The influence of vertical features on the model's portrayal of the floodplain elevations were examined in addition to the response of water levels and inundation extent among three unstructured meshes representative of the Mississippi-Alabama coastal floodplain. The MSAL mesh included vertical features, MSAL_noVF_z contained vertical features in the mesh topology, but crown elevations were withheld, and the MSAL_noVF mesh included similar mesh resolution as the other meshes, although no vertical features were included.\nThe three unstructured meshes were employed to simulate shallow water hydrodynamics for Hurricane Katrina (2005) using the coupled SWAN+ADCIRC model framework. The model was parameterized to represent natural geophysical conditions across the floodplain, thereby removing the need for model calibration. Simply put, the model was setup with the best known and scientifically defensible conditions and no calibration/tuning was performed herein. The methods presented are not limited to storm surge models, but can be utilized in river flood routing models that require spatial domain discretization.\nIt was shown that the state at which flood inundation models are currently being developed require additional validation techniques beyond point-based methods, and in particular, the validation of inundation extent. Each model was compared to time-series water surface elevations, post-event measured HWMs, and post-event aerial imagery. For each model, the time-series water levels matched the observed data well and captured the tides before landfall and the rising limb of the storm surge hydrograph. Katrina simulated water level peaks also compared well with an R 2 of 0.97 and upper and lower 95% confidence interval of \u223c \u00b1 0.60 m. From the point-based validation, it was not readily clear which of the three model experiments performed best in terms of accuracy. Examination of inundation extent among the three model results was compared to debris lines derived from post-event aerial imagery. From the aerial imagery comparison, the MSAL model produced the more accurate simulated inundation extent, followed by the MSAL_noVF_z, and MSAL_noVF model. This result was obtained without reliance on hand digitization or sacrificing computational cost as the mesh node count was similar among the three models.\nComparison of differences in total flooding area and inundation extent resulted in the MSAL model having the lesser amount of flooded area than the other two models. Relating the additional differences in inundation extent to population density along coastal Mississippi resulted in a possible affected population of 1096 people and 7525 people when using inundation results from the MSAL_noVF_z and MSAL_noVF model. Model results also indicated that vertical features have a role in the timing of the initial flood wave as well as the surge recession, which may be critical when using inundation models in a real time forecasting framework. Additionally, the methods presented herein may have an impact on transport models (including debris transport).\nAccurate results were computed in the MSAL due to the methods employed in generating the unstructured mesh, which describes the varying types of topography across the landscape. Areas that exhibited substandard model results are found in regions with coarse mesh resolution, unsatisfactory elevation or bathymetric data, narrow rivers and canals, and regions dominated by surface runoff and local flooding. Additionally, inclusion of event-scale coastal erosion, surface runoff generating mechanisms and overland flow, flow description through narrow channels and tidal creeks, better descriptions of salt marsh table elevations, and improved surface roughness characteristics can increase the accuracy of the model through the inclusion of these additional physical processes.\nAlthough narrowing, there remains a gap in the knowledge of relating the physics with numerical discretization of a continuous and natural surface. As this work is a step toward fully-automated mesh generation for shallow water hydrodynamics, future research should include an evaluation of the extraction algorithm parameters across difference landscapes, in addition to mesh resolution sensitivity coupled with vertical feature integration. The guidance and constraints presented here may promote coarser model resolution without sacrificing model accuracy, and in term will lead to a more ideal mesh."}]
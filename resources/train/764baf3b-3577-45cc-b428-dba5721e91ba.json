[{"section_title": "Abstract", "text": "Accurate registration plays a critical role in group-wise functional Magnetic Resonance Imaging (fMRI) image analysis, as spatial correspondence among different brain images is a prerequisite for inferring meaningful patterns. However, the problem is challenging and remains open, and more effort should be made to advance the state-of-the-art image registration methods for fMRI images. Inspired by the observation that common functional networks can be reconstructed from fMRI image across individuals, we propose a novel computational framework for simultaneous groupwise fMRI image registration by utilizing those common functional networks as references for spatial alignments. In this framework, firstly, individualized functional networks in each subject are inferred using Independent Component Analysis (ICA); secondly, congealing groupwise registration that takes entropy of stacked independent components (ICs) from all the subjects as objective function is applied to register individual functional maps for maximal matching. The proposed framework is evaluated by and applied to an Alzheimer's Disease (AD) fMRI dataset and shows reasonably good results."}, {"section_title": "INTRODUCTION", "text": "Recent advances in neuroimaging techniques, especially high-resolution functional magnetic resonance imaging (fMRI) of the brain such as the Human Connectome Project (HCP) [1] , [2] , made it possible for exploring functional human brain organization in unprecedented details. Due to the individual variability of human brain, registering individual's fMRI images to a common space for group-wise or population-scale analysis is a critical step for understanding the human brain structure and function and their relationships. Successes have been reported in many registration algorithms on structural MRI images [3] , including sophisticated pairwise registrations [4] , [5] , and image registration methods between different imaging modalities [6] , [7] . One common registration approach used in group-wise fMRI image analysis is to directly register fMRI images to a template defined by averaged structural MRI images using well-established linear registration algorithms originally designed for structural MRI data [8] . However, typical T2*-weighted volumes of Blood Oxygenation Level Dependent (BOLD) fMRI images are low-resolution and have poor anatomical contrast [9] . As a result, traditional intensity-based or feature-based structural image registration methods do not necessarily work well for fMRI images. These difficulties motivated us to explore new methods for fMRI image registration in this paper.\nFrom our perspective, the major reason that limits the development of registration methods for fMRI image is the lack of an accurate reference to assist the mapping from the target image and the source reference. In the literature, there have been explorations in utilizing meaningful functional information for brain image registration. For instance, in [10] , Orchard and Atkins proposed to use functional activation detection as a guidance for image registration. In [11] , Freire et al. trained a neural network to measure the similarity between fMRI data voxels as registration guidance. Despite these early efforts, there has been little effort in using functional brain networks as references for fMRI image registration, which is the focus on this work.\nInspired by the observation that multiple functional brain networks can be commonly and robustly identified across individuals based on the resting-state fMRI data, we propose a novel groupwise fMRI registration framework by using common functional networks as references, which can provide functionally meaningful boundaries and contrast that are missing in raw BOLD fMRI images. This is the major methodological novelty of our image registration framework. In addition, the proposed framework can significantly reduce the biases produced by pairwise registration [12] through utilizing groupwise registration methodology. To our best knowledge, this is among the earliest works utilizing functional networks information for groupwise fMRI image registration. This fully automated framework is evaluated by and applied to both the Alzheimer's Disease Neuroimaging Initiative (ADNI) resting-state fMRI data, and achieves promising results."}, {"section_title": "MATERIALS AND METHOD", "text": ""}, {"section_title": "Experimental Data and Preprocessing", "text": "Our experimental data were downloaded from publicly available Alzheimer's Disease Neuroimaging Initiative (ADNI) (adni.loni.usc.edu), which provides previously collected resting-state functional magnetic resonance imaging (rsfMRI) datasets from individuals with AD and healthy controls. Since we are aiming to evaluate groupwise registration framework results by exploring the potential functional abnormalities in the AD patients, only first rsfMRI scans (until Sep. 2013) of each of 40 NC subjects and 33 AD subjects are included in this paper. All rsfMRI datasets were acquired on 3.0 Tesla Philips scanners (varied models/systems) at multiple sites. The range for imaging resolution in slice dimension is from 2.29 to 3.31 mm and the slice thickness is 3.31 mm. TE (echo time) for all subjects is 30 msec and TR is from 2.2 to 3.1 sec. For each subject, there are 140 volumes (time points). Preprocessing steps of the rsfMRI data included brain skull removal, motion correction, spatial smoothing, temporal prewhitening, slice time correction, global drift removal, and band pass filtering (0.01-0.1 Hz) [13] ."}, {"section_title": "Traditional Registration Methods", "text": "In order to perform groupwise functional analysis across populations, functional images in a common standard space (for example, the MNI space) are required. For registering functional images from individual space to a common standard space, well-established pipelines [2] usually include two steps (Figure 1 These traditional registration methods might suffer from the difference between fMRI images (composed of BOLD signals) and the T1-weighted MRI data, EPI distortion of fMRI technique [14] , and errors in skull removal procedures. More importantly, functional correspondences between fMRI images are not utilized."}, {"section_title": "Functionally Intrinsic Connectivity Networks (ICNs) Guided Groupwise Registration", "text": "Inspired by the observation that multiple functional brain networks can be commonly identified across individuals via ICA methods [15] or dictionary learning algorithms [16] , [17] , common networks can be utilized to establish correspondence between fMRI images. In this paper, after preprocessing, functional ICNs are decomposed from each fMRI image and a set of z-score maps representing networks' 3D pattern are obtained by FSL MELODIC ICA software (http://fsl.fmrib.ox.ac.uk/fsl/fslwiki/melodic). Then, label map images of each subject are obtained by \"stacking\" all the ICNs from the same subject together by choosing the corresponding ICN index number as the new intensity value in the label map, as shown in Figure 2 . This label map \"stacking\" procedure can be summarized in (1).\nwhere is the label map intensity at voxel , and ( ) is the intensity value of at voxel . In general, the work flow of our proposed pipeline is summarized in Figure 3 , and the detailed explanations are described in the following paragraphs.\nSpecifically, this proposed framework is an iterative pipeline containing the following 6 steps: 1. Initialization: Rough registration from the subject space to the MNI template space using transformation matrix obtained by implementing a traditional fMRI registration strategy as shown in Figure 1 (A) . 2. Congealing groupwise registration: In this step, firstly, all the label map images of each subject are roughly warped into the MNI standard space using the transformation matrix obatined in Step 1; Then, an affine congealing groupwise registration [18] are performed on all the label map images to maximally align the common information of the individualized label maps. In the congealing method, voxels sampled from the same location of different images form a stack, and the sum of intensity entropies from various stacks forms the stack entropy. The stack entropy serves as the objective function and is minimized by a gradient-based optimizer. A multiresolution registration strategy is deployed in the congealing method to mitigate the influences of local minima and increase the robustness of registration. After this step, a refined transformation matrix \u2206 will be obtained for each subject. 3. fMRI warping: fMRI images are warped from the original space into the template space using the concatenated transformation matrix + \u2206 + \u22ef . Notably, in order to reduce interpolation-induced blurring, only one-time warping in each iteration from the original individual space to the refined template space is performed by concatenating all the previously obtained transformation matrices. 4. Group ICA: Since all the fMRI images are now in a common template space, group ICA is then performed. In order to extract common spatial patterns, or namely the common ICNs from the group [19] , temporal concatenation approach is applied by using FSL MELODIC software (http://www.fmrib.ox.ac.uk/fsl/). 5. Individualized common ICNs refinement for each subject: First, the common ICNs in the common template space will be transformed into an individual's space as the initialization for further individualization. Then, the representative time course is generated from the averaged time courses extracted from the top 5% zscore masked regions of each common ICN in the individual space, in order to achieve high SNR ratio representative time course. The following individualized ICN can be extracted using seed-based correlation analysis [20] based on the representative time courses for each common ICN. 6. Next iteration: The pipeline will then go back to Step 2 and continue iteratively until the group-mean of the transformation matrices obtained in Step 2 converges or the maximum iteration number reaches.\nAfter implementing the whole pipeline, the individualized ICNs decomposed using ICA can be mapped into a common space by utilizing the final transformation matrices + \u2206 + \u22ef. Groupwise consistent ICNs (e.g., 10 resting-state network (RSN) templates from [21] ) in the common space from each subject are averaged to be the final ICN templates. The correspondence between the resting-state template (denoted as in (2)) and the ICNs (denoted as in (2)) within each subject are established by calculating the overlap rate (similar to [22] ):\nwhere and are the corresponding voxels in the spatial map. The ICN with the highest overlap rate is taken as the correspondence to the template."}, {"section_title": "RESULTS", "text": ""}, {"section_title": "Comparisons between Our Method and Traditional Method", "text": "In general, in comparison with traditional method (Figure 1 ), improvements such as decreased noises, reduced false positive connectivity, and more concentrated average network patterns have been found in the derived ICNs by using our proposed method. As examples, the averaged ICN templates of three RSNs (indexed as RSNs 2, 3 and 4) using ICNs generated from 40 NC subjects from ADNI dataset after respective applications of our registration method and traditional method are shown in Figure 4 . As highlighted in the red circles in Figure 4 , the averaged ICNs in RSNs 2-4 by our method have more concentrated functional peaks of less areas, meaning that our image registration method can more accurately warp those 40 ICNs into better spatial alignments than the traditional method. In addition, for some ICN templates indicating AD group abnormalities, such as hippocampal connectivity ICN, AD group's ICN templates display clear changes after applying our proposed method, while NC group's ICN templates remain similar. As shown in the circles in Figure  5 , the ventricular regions display the decreased connectivity after applying our proposed method (red circles) for AD templates, while no significant differences (yellow circles) are seen for NC templates. These results suggest better accuracy of our proposed registration method. "}, {"section_title": "Functional Abnormality between NC and AD", "text": "Default mode network (DMN) activity is reported to be abnormal in AD [23] . In order to further explore the AD's functional connectivity alteration and simultaneously evaluate the ability of our proposed framework for subtle and accurate functional network analysis, the proposed framework is applied to a population of 33 AD patients based on functional network templates. Figure 6 shows the averaged DMN templates for both NC and AD groups using our proposed framework and two traditional methods as shown in Figure 1 . It is clear that AD group exhibits shrunk and altered DMN, as highlighted by the red arrows. Then, statistical maps resulting from twosample t test are generated for quantitative comparisons between NC and AD group (Figure 7) . Joint height and extent thresholds of < 0.05 are used to determine significant clusters. The proposed framework shows promising results of detecting AD's decreased DMN activity: More significant deactivation of DMN in most associated brain regions, i.e., bilateral inferior-lateralparietal cortex, precuneus and posterior cingulate, hippocampal area and ventromedial frontal cortex, which are consistent with the previously-reported findings in the literature [24] . Apparently, our proposed framework shows improvement over all the traditional methods in comprehensively detecting subtle decreased activity in DMN of AD, as shown in Figure 7 . Figure 6 . Averaged DMN templates of NC and AD groups, using our proposed framework and two traditional strategies. Figure 7 . Decreased DMN activity in AD. Red circles show significant decreases in bilateral inferior-lateral-parietal cortex; Yellow circles denote more significantly decreased connectivity in hypo-area of precuneus and posterior cingulate; Green arrows show more significantly decreased activity in hippocampal area; Blue arrows denote more significantly decreased activity in ventromedial frontal cortex."}, {"section_title": "DISCUSSION AND CONCLUSION", "text": "In this paper, we proposed a new fMRI image registration framework that utilizes the individualized common ICNs decomposed by ICA technique from each subject as guidance for groupwise registration. The common functional networks provide functionally meaningful boundaries and contrast that do not exist in the raw BOLD fMRI images for better spatial registration. To our best knowledge, this is among the earliest works that use functional networks as guidance for groupwise fMRI image registration. Given the lack of ground truth for validation, the reasonably good experimental results shown in Section 3 suggest the promise of our framework."}]
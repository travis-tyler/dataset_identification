[{"section_title": "Abstract", "text": "We present a novel method for estimation of the fiber orientation distribution (FOD) function based on diffusion-weighted magnetic resonance imaging (D-MRI) data. We formulate the problem of FOD estimation as a regression problem through spherical deconvolution and a sparse representation of the FOD by a spherical needlets basis that forms a multi-resolution tight frame for spherical functions. This sparse representation allows us to estimate the FOD by 1 -penalized regression under a non-negativity constraint on the estimated FOD. The resulting convex optimization problem is solved by an alternating direction method of multipliers (ADMM) algorithm. The proposed method leads to a reconstruction of the FOD that is accurate, has low variability and preserves sharp features. Through extensive experiments, we demonstrate the effectiveness and favorable performance of the proposed method compared to three existing methods. Specifically, we demonstrate that the proposed method is able to successfully resolve fiber crossings at small angles and automatically identify isotropic diffusion. We also apply the proposed method to real 3T D-MRI data sets of healthy individuals. The results show realistic depictions of crossing fibers that are more accurate, less noisy, and lead to superior tractography results compared to competing methods. (J. Peng). 1 Data used in preparation of this article were obtained from the Alzheimers Disease Neuroimaging Initiative (ADNI) database ( adni.loni.usc.edu ). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at: http://adni.loni.usc.edu/ wp-content/uploads/how _ to _ apply/ADNI _ Acknowledgement _ List.pdf ."}, {"section_title": "Introduction", "text": "Diffusion-weighted MRI (D-MRI) ( Le Bihan et al., 2001; Mori, 2007 ) has become a widely used, non-invasive tool for clinical and experimental neuroscience due to its capability of characterizing tissue microstructure in vivo by measuring the diffusion displacement of water molecules. Specifically, high angular resolution diffusion imaging (HARDI) enables extraction of accurate and detailed information about fiber tract directions through measurements made along a large number of gradient directions ( Tuch et al., 2002 ) . Such information is then used in fiber reconstruction algorithms ( tractography ) to facilitate better mapping of neuronal connections.\nHARDI techniques may be categorized according to their sampling schemes in the space of possible b-values and diffusion gradient directions ( i.e. , the q space) ( Assemlal et al., 2011; Descoteaux et al., 2011; Jones et al., 2013; Parker et al., 2013; Tournier et al., 2011; Yeh et al., 2010 ) . Single q -shell techniques sample gradient directions with a single b-value , whereas multiple q -shell techniques sample gradient directions with multiple b-values ( Jensen et al., 2005; Lu et al., 2006; Weeden et al., 2005 Weeden et al., , 2008 Wu and Alexander, 2007; Wu et al., 2008; Liu et al., 2004; Descoteaux et al., 2011; Assemlal et al., 2009; Cheng et al., 2010 ) . Models for single q -shell diffusion data include the fiber orientation distribution (FOD or fFOD) ( Tournier et al., 2004 ( Tournier et al., , 2007 Jian and Vemuri, 2007; Yeh and Tseng, 2013 ) , diffusion orientation distribution function (ODF or dODF) ( Tuch, 2004; Descoteuax et al., 2007 Descoteuax et al., , 2009 Aganj et al., 2010 ) , diffusion orientation transform (DOT) ( Oz \u030e arslan et al., 2006 ) and fiber ball imaging ( Jensen et al., 2016 ) .\nDifferent q -space sam pling schemes and data representations are optimal for different analytical goals. For example, multiple qshell techniques enable explicit modeling of separate cellular contributors to the D-MRI signal. In this paper, we focus on one particular representation for single q -shell data: the FOD. The FOD is designed to describe the local spatial arrangement of axonal fiber bundles in such a way that sharply-defined geometric features are preserved ( Jensen et al., 2016 ) . This property makes the FOD an attractive representation if the downstream analytic goal is fiber reconstruction.\nOne commonly used approach to FOD estimation is based on spherical deconvolution ( Tournier et al., 2004 ( Tournier et al., , 2007 , which assumes that the observed D-MRI data consists of a convolution of the underlying FOD and a spherical convolution kernel. A parsimonious representation of the FOD in a suitable basis is the key to a successful deconvolution method, since there is greater noise amplification when the effective number of basis coefficients is larger ( Kerkyacharian et al., 2007; Johnstone and Paul, 2014 ) .\nSeveral popular FOD estimators rely on spherical harmonics (SH) representations of the D-MRI data ( Tournier et al., 2004 ( Tournier et al., , 2007 . However, when the function being represented has localized sharp peaks, as the FODs of well-defined fiber tracts do, the SH basis does not provide an efficient representation due to the global support of its basis functions.\nIn Yeh and Tseng (2013) , FODs are represented in a monoresolution basis consisting of a large class of putative dODF functions and an 1 penalty is used to induce a sparse representation. In Daducci et al. (2014) , an ad-hoc dictionary of functions is used to represent FODs under 1 and 0 penalization schemes. While these methods aim to give sparse solutions, their choice of basis functions may not lead to sparse representation of the FOD.\nAnother approach to modeling D-MRI data uses a multiresolution basis on the sphere, namely ridgelets , to filter the noisy DWI signal and extract information about local fiber orientations ( Michailovich et al., 2010 Rathi et al., 2011 ) . Rathi et al. (2011) applied an 1 penalty to the coefficients in the ridgelet representation, Michailovich et al. (2010) used orthogonal matching pursuit, and Michailovich et al. (2011) combined an 1 penalty with a total variation penalty to utilize spatial information for ODF estimation. In contrast, our objective here is to estimate the FOD, rather than DWI signal reconstruction or ODF estimation.\nAnother class of methods for FOD estimation is based on the discrete mixture model, also referred to as the multi-tensor model. A prominent approach in this framework ( Landman et al., 2012 ) is to use an 1 penalty with a non-negativity constraint on the mixture fractions. For such methods, the number of mixture components needs to be reasonably small to ensure identifiability of the parameters ( Scherrer and Warfield, 2010; Wong et al., 2016 ) and low variability of the estimator.\nIn this paper, we propose a novel FOD estimator based on a multiresolution basis called needlets ( Narcowich et al., 2006a; Marinucci and Peccati, 2011 ) , which are smooth functions localized in both space and frequency. Consequently they yield sparse and stable representations for a spiky but otherwise regular functions such as FODs ( Narcowich et al., 20 06a; 20 06b ) . The tightness of the needlet frame, which translates into low mutual correlation and a parsimonious representation, is particularly beneficial for estimation accuracy when solving a deconvolution problem based on noisy data ( Kerkyacharian et al., 2007; Johnstone and Paul, 2014 ) .\nUnlike a monoresolution basis such as that used by Yeh and Tseng (2013) , multiresolution frames such as needlets are better suited to parsimonious approximation of inhomogeneous, spiky functions due to their localization and tight frame properties. These are the key reasons why orthogonal wavelets or wavelet type tight frames have played such an important role in signal denoising and adaptive estimation in deconvolution problems ( Mallat, 1999 ) . The term \"multiresolution basis\" is used to mean a collection of functions that is complete in the L 2 sense; Moreover, the basis elements are indexed through a \"location-scale index\" whose value controls the degree of spatial and frequency localization ( Mallat, 1999; Marinucci and Peccati, 2011 ) .\nNeedlets also provide an accurate approximation of finite mixtures of distinct directions since these are well approximated by smooth inhomogeneous functions. Therefore, a needlet representation can be used to obtain good estimates for a broad class of FODs including the finite mixtures. Moreover, although the discrete mixture model is a convenient mathematical abstraction of fiber populations within a voxel, the actual local geometry of neuronal fiber bundles is often more complex. There can be significant variability in local orientations among the fibers within an individual fiber bundle passing through a voxel. Under such circumstances, the representation of the FOD as a continuous distribution with a few sharp peaks would provide a more realistic depiction of the geometry.\nWe ensure sparsity of the needlet representation by imposing an 1 penalty on the needlet coefficients of the FOD. The 1 penalty results in accurate estimates that preserve sharp peaks even when the number of gradient directions and signal-to-noise ratio are both moderate. In addition, since the FODs are probability densities, we impose a nonnegativity constraint on the estimated FODs. This allows us to take advantage of the needlets representation, even though the needlets are not nonnegative functions themselves.\nTo eliminate subjectivity in the estimation procedure and to ensure a good statistical performance of the estimator, we propose a data-driven scheme for selecting the 1 penalty parameter that balances between bias and variance in the FOD estimation. This is in contrast to the ad-hoc choices of the regularization parameters made by many methods in the literature. Finally, we implement an efficient estimation algorithm based on a fast computation of the spherical needlets transform and the Alternating Direction Method of Multipliers algorithm ( Boyd et al., 2011 ) . Our experiments demonstrate that these methodological and computational innovations lead to improved estimation accuracy and better detection of fiber directions.\nWe conduct synthetic data experiments to demonstrate the effectiveness of the proposed estimator and to compare it with three existing methods based on the SH representation ( Tournier et al., 20 04, 20 07 ) and the discrete mixture model ( Wong et al., 2016 ) , respectively. We specifically consider small crossing angles since this is a challenging yet very important problem in resolving crossing fibers, and we focus on high b-value and/or high signal-to-noise ratio for such cases as this is the direction the field is moving ( Setsompop et al., 2013; Van Essen et al., 2013 ) . The proposed estimator shows favorable performance compared to the competing methods. For example, it is able to recover the FOD even when the fiber crossing angle is as small as 30 \u00b0, and automatically identify isotropic diffusions.\nFinally, we conduct experiments using real 3T D-MRI data sets of healthy individuals. We corroborate the results against the FSL J\u00fclich Histological Atlas ( Jenkinson et al., 2012; Smith et al., 2004 ) and apply deterministic tractography ( Wong et al., 2016 ) to the estimated FODs. Tractography results based on the FODs estimated by the proposed method tend to agree better with the known geometric configuration of fiber tracts, compared to FODs based on other estimators. These results demonstrate that the more accurate description of local fiber organization afforded by the proposed FOD estimator results in superior tractography performance.\nThe rest of the paper is organized as follows. We describe the proposed method and experiments based on both synthetic data and real D-MRI data in Section 2 . We report the experimental results in Section 3 . We draw conclusions and discuss future directions in Section 4 . Much of the technical detail and additional experimental results are reported in the Supplementary material."}, {"section_title": "Material and methods", "text": ""}, {"section_title": "Needlets representation of spherical functions", "text": "We give a brief introduction to needlets and some of their relevant properties. More details are available in Marinucci and Peccati (2011) and Narcowich et al. (2006a,b) .\nNeedlets are constructed by complex-valued SH functions { lm : m = \u2212l , . . . , l } l=0 , 1 , 2 , ... , which form an orthonormal basis for L 2 (S 2 ) , the space of square integrable functions defined on the unit sphere S 2 . The indices l and m , referred to as level index and phase index , respectively, together determine the wavy pattern of the function lm . The needlets construction is based on two key ideas ( Marinucci and Peccati, 2011 ) : (a) discretization of S 2 : If H l denotes the space spanned by { lm : m = \u2212l , . . . , l } , and K j := j l=0 H l , then for every j \u2208 N , there exists a finite subset\nwhere d \u03c9( x ) denotes the surface element of S 2 at x ; and (b)\nLittlewood-Paley decomposition: this is through a function b de-\nWith the above, a class of needlets { \u03c8 jk ;\nwhere p j = N r j , \u03b6 jk = \u02dc \u03b6 r j k and \u03bb jk = \u02dc \u03bb r j k , with r j = 2 B j+1 . The index j \u2208 N encodes scale/frequency and k \u2208 { 1 , . . . , p j } encodes location (determined by \u03b6 jk ) and P l is the l th Legendre polynomial. Also note that, the needlets are real valued spherical functions.\nIt can be shown that needlets thus constructed are localized in both space and scale, with exponentially increasing concentration around the quadrature point as the scale index j increases. The quadrature formula (1) is an important factor behind the spatial concentration of needlets and the consequent advantages in terms of function approximation.\nThe collection of needlets together with 00 (i.e., the constant function on the sphere) form a tight frame (referred to as the needlets frame), i.e., for\nis called the needlet coefficient of f corresponding to index pair ( j, k ). The tight frame property, together with the localization in space and scale, imply that needlets can be used to perform multiresolution analysis of functions in L 2 (S 2 ) . Moreover, by (2) , the needlet coefficients of f have the linear representation in terms of SH coefficients:\nEq. (4) provides a very useful computational tool since fast computational algorithms are available for the SH transform ( Driscoll and Healy, 1994; Fan, 2015 ) . In order to obtain the quadrature points and weights, we make use of the HEALPix construction due to G\u00f3rski et al. (2005) that partitions S 2 into N j,pix = 12 N 2 j,side = 12 \u00d7 (2 j ) 2 spherical triangles of equal area, where N j, side is a power of two determining the resolution. Then, quadrature points are chosen as the centroid of the triangles, while the weights are all equal to 4 \u03c0 / N j, pix .\nSince we assume FODs to be symmetric, we construct symmetrized needlets which can be easily derived from the original needlets. Henceforth (with slight abuse of notations), { lm } denote the real symmetric SH functions where l = 0 , 2 , 4 , . . . ( Atkinson and Han, 2012; Descoteuax et al., 2007 ) and { \u03c8 jk } denote the symmetrized needlets functions. See Section S.1 in the Supplementary material for details."}, {"section_title": "Regression model for D-MRI measurements", "text": "In this section, we first describe the spherical deconvolution model that relates FOD, denoted by F ( \u00b7 ), with the diffusion signal function, denoted by S ( \u00b7 ). We view the observed diffusion weighted measurements y = { y i } n i =1 corresponding to n gradient directions as noise corrupted samples from the diffusion signal function S ( \u00b7 ) evaluated at the respective gradient directions. After representing the FOD in the SH basis, we can then model the observed measurements by a linear regression model where the needlet coefficients of the FOD are the regression coefficients.\nFollowing, Tournier et al. (2004) , Tournier et al. (2007) , Sakaie and Lowe (2007) and Lenglet et al. (2009) , it is assumed that the diffusion signal function S ( \u00b7 ) is a spherical convolution of the FOD F : S 2 \u2192 R + , a symmetric spherical distribution; with an azimuthal symmetric kernel R :\nreferred to as the response function , represents the local diffusion characteristics of water molecules along neuronal fibers, which are assumed to be the same across different fiber bundles and voxels. In the following, we assume that the response function R ( \u00b7 ), and hence its SH coefficients, are known. In practice, we may assume that R ( \u00b7 ) belongs to a parametric family of nonnegative functions on [ \u22121 , 1] (e.g., specified by a tensor model) and then estimate the parameters based on voxels with a single dominant fiber bundle, typically characterized by high fractional anisotropy (FA) values. Experimental results show that our method is robust to the specification of the response function (see Supplementary material Section S.3.9 for more details).\nDenote S = R F to mean the spherical convolution of F with the axially symmetric kernel R , which is defined as\nThe SH coefficients of the diffusion signal function S ( \u00b7 ) follow:\nwhere r l := R , l , 0 and f lm := F , l, m , are the rotational harmonics and spherical harmonics coefficients of the response function and FOD, respectively. Moreover, by the orthonormality of the SH basis, we can express the diffusion signal function as:\nIn the following, we assume that both S ( \u00b7 ) and F ( \u00b7 ) can be well approximated in a finite order real symmetric SH basis { l,m : \u2212l \u2264 m \u2264 l} l=0 , 2 , ... ,l max consisting of L = (l max + 1)(l max + 2) / 2 basis functions. The observed DWI measurements thus can be modeled as:\nwhere R is an L \u00d7 L diagonal matrix with diagonal elements 4 \u03c0 / (2 l + 1) r l (in blocks of length 2 l + 1 ); f = ( f lm ) is the L \u00d7 1 vector of SH coefficients of the FOD F ; is the n \u00d7 L matrix with the i th row being { l, m ( \u03b8 i , \u03c6 i )}, where \u03b8 i and \u03c6 i are elevation angle and azimuthal angle, respectively, of the i th gradient direction.\nThe i th coordinate of y = (y i ) n i =1 corresponds to the observed diffusion measurement along the i th gradient direction; and \u03b5 = ( i ) n i =1\nis an n \u00d7 1 vector representing observational noise and possible approximation error."}, {"section_title": "1 -Penalized estimation of FOD under needlets representation", "text": "If we assume that the FOD F ( \u00b7 ) is either a constant function on the sphere (when the diffusion is isotropic) or a spherical function with a few sharp peaks (each corresponding to a distinct major fiber bundle), the localization and tight frame properties of the needlets would imply that the needlet coefficients of F ( \u00b7 ) form a sparse vector ( Narcowich et al., 2006a ) , i.e., F ( \u00b7 ) can be well approximated by a small fraction of needlet functions.\nConsider a symmetrized needlets frame with the first N = 1 + ( 0 \u2264 j\u2264 j max N j,pix ) / 2 = 2 2 j max +3 \u2212 1 frame elements (corresponding to B = 2 ), where j max \u2265 0 is the maximum level of needlets being used. j max is set to be log 2 ( l max ) so that SH functions up to level l max can be linearly represented in the first N needlets. Denote the\nmatrix. This allows us to rewrite Eq. (7) as\nA key point here is that C can be easily computed (see Section S.1 in the Supplementary material for details), and so is the design matrix RC . Furthermore, since the response function R is the same across voxels, the design matrix needs to be computed only once.\nThe sparseness of the FOD needlet coefficients \u03b2 motivates us to propose a penalized regression estimate:\nwhere P \u03bb ( \u03b2) denotes a sparsity-inducing penalty, with the tuning parameter \u03bb \u2265 0 controlling the degree of regularization, and \u02dc is the matrix of SH basis functions (up to level l max ) evaluated on a pre-specified dense evaluation grid. The constraint \u02dc C \u03b2 0 ensures that the estimated F ( \u00b7 ) evaluated on this grid, i.e., F := \u02dc C \u02c6 \u03b2, is nonnegative. In the subsequent experiments, we use an equiangular grid (corresponding to the triangular tessellation of the unit sphere using an Icosahedron) with 2562 grid points. Following Tibshirani (1996) and subsequent developments in the statistical literature, we propose to use an 1 penalty P \u03bb ( \u03b2) = \u03bb j,k | \u03b2 jk | . The estimation problem is then a convex optimization problem with a non-negativity constraint. We develop a computationally efficient algorithm based on the Alternating Direction Method of Multipliers (ADMM) ( Boyd et al., 2011; Sra et al., 2012 ) to solve (9) . ADMM is a general-purpose algorithm for solving convex optimization problems with constraints. Finally, we rescale the estimated F ( \u00b7 ) such that it integrates to one on the unit sphere. The details of the ADMM algorithm is given in Section S.2.1 of the Supplementary material. Since our goal here is to get a good estimate of FOD, particularly one that is useful for subsequent analyses such as tractography, thus slight overfitting is less detrimental than underfitting. Thus we propose a criterion which chooses the largest \u03bb such that the penalty parameter values smaller than this value will lead to essentially the same residual sum of squares (RSS) (see Section S.2.2 in Supplementary material for details). The commonly used model selection criteria such as BIC ( Schwarz, 1978 ) and AIC ( Akaike, 1974 ) require specification of the degrees of freedom for the model which is difficult when the design matrix is ill-conditioned and non-smooth penalties such as the 1 norm are used. Experiments based on synthetic data show that the proposed strategy is able to strike a good balance between bias and variance in FOD estimation and leads to better results than BIC or AIC (results not reported).\nAfter obtaining an estimated FOD, we may want to identify major fiber bundle orientation(s), which could be used for subsequent analyses such as deterministic tractography or for evaluation and comparison of methods. Ideally, this can be done through peak detection, i.e., locating the local maxima of the (estimated) FOD. However, since the estimated FOD may have spurious peaks due to noise, we need to eliminate peaks that are likely to be false. We propose a simple yet effective peak detection algorithm based on grid search, followed by a pruning step and a clustering step to filter out potential false peaks. Details are given in Section S.2.3 of the Supplementary material. One may also consider more sophisticated peak detection algorithms including Ghosh et al. (2014) , Michailovich et al. (2010) , Alexander (2005) ."}, {"section_title": "Synthetic data experiments", "text": "In this section, we describe experiments based on synthetic data to study the performance of the proposed estimator, referred to as SN-lasso , and to compare it with three competing estimators as described below.\nIn the main text, we only report graphical summaries of the results for cases with two-fiber ( K = 2 ) crossing and n = 41 gradient directions. For detailed numerical summaries, see Tables S.3-S.5 in the Supplementary material. We also defer results and discussions of other settings to Section S.3 of the Supplementary material.\nAs can be seen from Fig. 1 , when the crossing angle is large-tomoderate (90 \u00b0, 75 \u00b0, 60 \u00b0), even at relatively low b-value and SNR ( b = 10 0 0 s/mm 2 , SNR = 20 ), SN-lasso leads to satisfactory reconstruction of FOD, particularly in terms of accurately identifying the peak directions. SCSD8 and SCSD12 also show various degrees of success in these cases, though their performances are not as good as that of SN-lasso ( SCSD16 estimates are very variable and thus omitted). Particularly, SN-lasso estimates have much more localized and sharper peaks. While crossing at a smaller angle (45 \u00b0; Fig. 2 ) , none of these methods works well when b-value and SNR are both low ( b = 10 0 0 s/mm 2 , SNR = 20 ). However, when either parameter is increased ( b = 30 0 0 s/mm 2 and/or SNR = 50 ), SN-lasso is able to accurately recover the sharp features of FOD. SCSD estimators are again much less localized ( SCSD8 estimates are overly smoothed and thus omitted). For a small crossing angle (30 \u00b0; Fig. 3 ), SN-lasso works well when both b-value and SNR are high ( b = 30 0 0 , 50 0 0 s/mm 2 and SNR = 50 ), while all other methods do a poor job in terms of detecting crossing fibers irrespective of b-value and SNR. In Fig. 4 , we depict success rate, angular error in direction estimation (averaged over the two directions) and bias in separation angle estimation, respectively. Under 90 \u00b0/75 \u00b0/60 \u00b0/45 \u00b0crossing, DiST has overall the highest success rate (except for 45 \u00b0crossing with b-value 10 0 0 s/mm 2 and SNR 20), followed by SN-lasso and SCSD12 . In contrast, SCSD8 , SCSD16 and SH-ridge have considerably lower success rate. The advantage of DiST in picking the correct number of fiber directions lies in the fact that it utilizes the information that there are only finite discrete fiber bundles (which is the truth here). In contrast, the other methods do not use such information. In terms of angular error (calculated on replicates where the correct number of fibers is identified), SCSD , SN-lasso and DiST perform similarly. On the other hand, SN-lasso has considerably smaller bias in separation angle estimation, leading to a more faithful reconstruction of crossing patten.\nUnder 30 \u00b0crossing, SN-lasso has the best performance in all three aspects. More specifically, for all four combinations of b-value and SNR, SN-lasso successfully identifies two peaks for at least 70% of the replicates with an average angular error ranging from 2.7 \u00b0to 9 \u00b0. In this case, DiST requires both large b-value and SNR to work well, otherwise it tends to under-select the number of fibers. This is because it is hard to distinguish two tensors with very close major axes. This is in contrast to the high angular resolution of the SN-lasso estimator rendered by the localization properties of needlets.\nWe also considered a setting where the true FOD is not a mixture of Dirac functions, instead it is a continuous spherical density with two dominant peaks. This setting corresponds to the scenario where there are two major fiber bundles; However, within each bundle the fiber directions are not completely homogeneous.\nIn this case, SN-lasso performs much better than DiST (Table   S .6). Moreover, by comparing the results in Tables S.6 and S.5 (first block), it can be seen that SN-lasso performs only slightly worse in this more challenging setting, whereas DiST performs much worse.\nThese results demonstrate that SN-lasso leads to good FOD estimation and direction identification even when the crossing angle is as small as 30 \u00b0as long as the b-value and SNR are sufficiently large. It also has overall the best performance among the competing methods with regard to these aspects cross a large range of settings. As large b-value and SNR are being advocated with the advancement of MRI technologies ( Setsompop et al., 2013; Van Essen et al., 2013 ) , SN-lasso holds promise in resolving even subtle fiber crossing patterns. In contrast, the other methods have difficulty in resolving small crossing angles. Specifically, DiST tends to under-select the fiber directions in such a case. As for the SH representation based methods, SH-ridge leads to overly smoothed estimates and consequent loss of directionality information, while SCSD estimators either tend to have large variability ( SCSD12, SCSD16 ) or overly smoothed estimates ( SCSD8 ). Consistent with the observations in Tournier et al. (2007) , SCSD8 works better for large-to-moderate crossing angles and SCSD12, SCSD16 work better for small crossing angles. However, without prior knowledge of the crossing angle, in practice it would be hard to choose which SCSD estimator to use. In contrast, SN-lasso is able to automatically adjust for different crossing angles through the specification of the penalty parameter \u03bb which is determined in a data driven way."}, {"section_title": "Competing estimators", "text": "In addition to the proposed SN-lasso , we also consider three existing estimators:\n(i) The SH-ridge estimator ( Tournier et al., 2004 ) through a ridge type regression by minimizing:\nb is the spherical Laplacian operator and P is a diagonal matrix with entries l 2 (l + 1) 2 in blocks of size 2 l + 1 ( l = \nThe penalty parameter \u03bb can be chosen by the Bayesian Information Criterion ( Schwarz, 1978 ) .\n(ii) The super-CSD estimator ( Tournier et al., 2007 ) . The idea is to suppress small values of the estimated FOD and consequently sharpen the peak(s) of the FOD estimator using an SH representation of order l s max . In our experiments, we apply super-CSD algorithm to the SH-ridge estimates and consider l s max = 8 , 12 , 16 . We refer to the corresponding estimators as SCSD8 , SCSD12 , and SCSD16 , respectively. For other parameters in the super-CSD algorithm, we follow the recommended values in Tournier et al. (2007) . For more details, see Section S.2.4 in Supplementary material.\n(iii) The DiST method ( Wong et al., 2016 ) . DiST is based on the discrete mixture model and utilizes a novel parameterization to resolve the non-identifiability issue of such models. Particularly,\nDiST focuses on diffusion direction estimation and uses MLE and BIC for direction estimation and selection, respectively."}, {"section_title": "Experimental setting", "text": "We consider FOD estimation for a voxel with various scenarios of fiber populations. We use sep to denote the separation angle between a pair of crossing fiber bundles. Our experimental settings include K = 2 fiber bundles crossing at sep = 90 \u2022 , 75 \u2022 , 60 \u2022 , 45 \u2022 , 30 \u2022 . We also consider K = 0 fiber bundle, i.e., isotropic diffusion; K = 1 fiber bundle, i.e., no crossing fiber; and K = 3 fiber bundles with pairwise crossing at sep = 90 \u2022 , 75 \u2022 , 60 \u2022 .\nWe simulate noiseless diffusion weighted signals according to the convolution model (5) , where the true FOD F :\nwith w k > 0 , K k =1 w k = 1 being the volume fractions and \u03b8 k (elevation angle) and \u03c6 k (azimuthal angle) being the spherical coordinates of the orientation of the k th fiber bundle, respectively. The response function is set as:\nwhere throughout we fix S 0 = 1 , \u03bb 3 = 1 \u00d7 10 \u22123 mm 2 /s and set the ratio between \u03bb 3 and \u03bb 1 as ratio = 10 . The volume fractions are set as w 1 = w 2 = 0 . 5 for the two-fiber case and w 1 = w 2 = 0 . 3 , w 3 = 0 . 4 for the three-fiber case.\nIn terms of the D-MRI experimental parameters, we consider bvalue at b = 10 0 0 s/mm 2 , 30 0 0 s/mm 2 and 50 0 0 s/mm 2 (for small crossing angles only); and three angular resolutions, namely, n = 41 , 81 , 321 gradient directions on an equiangular grid. These settings aim to cover commonly used values in large-scale D-MRI experiments such as those in ADNI (relatively low b-value and angular resolution) and human connectome project (relatively high b-value and angular resolution).\nThe observed diffusion weighted measurements along the n gradient directions are generated by adding independent Rician noise ( Gudbjartsson and Patz, 1995; Hahn et al., 2006; Polzehl and Tabelow, 2008 ) to the respective noiseless diffusion signals. The signal-to-noise ratio (SNR), defined as the ratio between the b 0 image intensity S 0 and the Rician noise level \u03c3 ( Tournier et al., 2007 ) , is set at SNR := S 0 /\u03c3 = 20 and 50 (for small crossing angles only). Note that b-value =50 0 0 s/mm 2 and SNR = 50 may be a rare setting for current D-MRI experiments. We included this scenario mainly as a reference point to demonstrate the potential of these methods, with the expectation that future technological advancements would make such an experimental setting more realistic ( Setsompop et al., 2013 ) ."}, {"section_title": "Evaluation metrics", "text": "We report the statistical characteristics of the estimators (across 100 independent data sets) by depicting the mean estimated FOD in opaque color and the mean plus two standard deviations in translucent color. Since DiST only gives direction estimation, in these plots we only report results corresponding to SN-lasso , SH-ridge and SCSD .\nWe also examine the performance of each estimator using various numerical metrics including: (i) the success rate of the peak detection algorithm applied to the 100 estimated FODs, where 'success' means that the algorithm identifies the correct number of fiber bundles. (ii) Among the successful estimators, the mean angular errors between the identified peaks and the true fiber directions, as well as bias in separation angle estimation (defined as the average of the estimated separation angle across the \"successful replicates\" minus the true separation angle) between pairs of fiber bundles. Throughout, \"true FOD\" refers to the true FOD projected on to an SH basis for ease of visualization and comparison."}, {"section_title": "Real D-MRI data experiments", "text": "Data used in the preparation of this article were obtained from the Alzheimers Disease Neuroimaging Initiative (ADNI) database ( adni.loni.usc.edu ) and the Human Connectome Project (HCP) database. The ADNI was launched in 2003 as a public-private partnership, led by Principal Investigator Michael W. Weiner, MD. The primary goal of ADNI has been to test whether serial magnetic resonance imaging (MRI), positron emission tomography (PET), other biological markers, and clinical and neuropsychological assessment can be combined to measure the progression of mild cognitive impairment (MCI) and early Alzheimers disease (AD). HCP is the result of effort s of co-investigators from the University of Southern California, Martinos Center for Biomedical Imaging at Massachusetts General Hospital (MGH), Washington University, and the University of Minnesota.\nWe analyzed a D-MRI data set from a 58 year old female from the second phase of the ADNI project (ADNI-2). This participant was scanned at the Wein Center for Alzheimer's Disease and Memory Disorders on a 3 T MRI machine produced by General Electric. The scanning protocol was analogous across scanners, and was optimized prior to the study to provide harmonized data across scanners.\nWe used eddy-current-corrected diffusion images ( Andersson and Sotiropoulos, 2016 ) from ADNI database. The diffusion signals were measured on a 256 \u00d7 256 \u00d7 60 3D grid (voxel side-length: x \u22121.37 mm, y \u22121.37 mm, z \u22122.7 mm) along 41 distinct gradient directions under b = 10 0 0 s/mm 2 . There are also five b 0 images based on which we extracted the brain using FSL ( Jenkinson et al., 2012; Smith et al., 2004 ) BET module ( Smith, 2002 ) and estimated the b 0 image intensity S 0 and the Rician noise level \u03c3 . The signal-to-noise ratio S 0 / \u03c3 has a median 40 across voxels. We first fitted the single diffusion tensor model ( Le Bihan, 1995; Basser and Jones, 20 02; Mori, 20 07; Carmichael et al., 2013 ) to each voxel and calculated the fractional anisotropy (FA) value and mean diffusivity (MD) . We then identified voxels with a single dominant fiber bundle characterized by FA > 0.8 and the ratio between the two minor eigenvalues of the tensor < 1.5. We used these voxels to estimate the response function R under a Gaussian diffusion model. The (estimated) response functions have the leading eigenvalue 1 . 5 \u00d7 10 \u22123 mm 2 / s and the ratio between the leading and the minor eigenvalue is 6.5. See Section S.4 in the Supplementary material for more details.\nWe then focused on a 16 \u00d7 16 \u00d7 6 region of interest (ROI) with x-slices 108-123, y-slices 124-139, z-slices 37-42. This region included portions of the corpus callosum (CC), cingulum bundle (CB), superior occipitofrontal fasciculus (SOF) and corticospinal tract (CT) according to the FSL J\u00fclich Histological Atlas ( Eickhoff et al., 20 05, 20 06, 20 07 ) . In Fig. 5 , we first used the FSL FLIRT module ( Jenkinson and Smith, 2001; Jenkinson et al., 2002 ) to register the tracts from J\u00fclich Histological Atlas with the extracted brain b 0 image, and then superimposed these tracts onto the extracted brain image using FLSeyes. The right portion of the ROI on z-slices 37 and 38 also encompassed the cerebrospinal fluid (CSF) region as indicated by Fig. 5 (see also Fig. S.14 of the Supplementary material). In Fig. 6 (a) , we also showed the fiber orientation colormap, FA map and MD map (zoomed into the ROI) at z-slice 40. The fiber orientation colormaps depict the orientation of the principal eigenvector under a single tensor model, where red indicates left-toright direction, green indicates up-to-down direction (anterior-toposterior in 3D brain) and blue indicates into-to-out-of-page direction (inferior-to-superior in 3D brain). Moreover, fiber orientation colormaps were modulated by the FA values such that voxels with small FA values were darker. The FA map and MD map were also calculated under the single tensor model, where darker colors correspond to smaller FA/MD values.\nWe first applied the FOD estimation methods to each voxel in this region and then extracted the peaks of the estimated FODs. We then applied the deterministic tracking algorithm developed in Wong et al. (2016) to the estimated FODs. We also analyzed a second data set from ADNI and a data set from the MGH Adult Diffusion Data of the Human Connectome Project ( http://www. humanconnectome.org ). We defer descriptions and results of these two experiments to Sections S.4.3 and S.4.4, respectively, of the Supplementary material. \n"}, {"section_title": "Results", "text": ""}, {"section_title": "FOD estimation", "text": "In this section, we examine FOD estimation by SN-lasso , SH-ridge and SCSD on the ROI described in Section 2.5 ( DiST only gives direction estimation, so we only discuss its tractography results in the next subsection). Moreover, we focus on the ROI at z-slice 40 as this subregion included several crossing fiber tracts as shown below.\nThe FOD estimates on z-slice 40 are shown in Fig. 6 (b) , where the FA map is drawn on the background and the size of the estimated FOD is modulated by mean diffusivity (MD; The larger the MD is, the smaller is the size of the depicted FOD estimate) for ease of visualization of the crossing pattern. It can be seen that, in the single fiber subregions, the SN-lasso estimates have sharp peaks consistent with the directions suggested by the fiber orientation colormaps. SCSD8 and SCSD12 are also able to preserve directionality pattern in such regions. However, in the crossing fiber regions, SCSD estimators tend to be very noisy, while SH-ridge leads to overly smoothed estimates causing loss of directionality information. In contrast, SN-lasso is able to correctly resolve crossing patterns as evidenced by the following observations. From Fig. 6 (a) FA and MD maps, the middle part of the ROI (highlighted by the white box) have both small FA and MD values. This is likely due to crossing fibers rather than being CSF since one defining feature of CSF is large MD values caused by faster water diffusion . This is confirmed by the SN-lasso estimates shown at higher magnification in Fig. 7 , lower right panel, which showed the presence of three fibers in this subregion. On the other hand, the SCSD estimates on this subregion are noisy and show no clear pattern ( Fig. 7 , upper right and lower left panels).\nIn the following, we use a standard white matter atlas to argue that it is highly plausible that there are crossing fibers at this anatomical location for this subject.\nIn Fig. 5 , we used the FSL J\u00fcelich Histological Atlas to superimpose the following fiber tracts: corpus callosum (CC), cingulum bundle (CB), superior occipitofrontal fasciculus (SOF), and corticospinal tract (CT). The ROI is shown as a box superimposed over these slices. The anatomical directions of travel of these four tracts are left to right (i.e., from the left to right side of the figure) , anterior to posterior (from top to bottom of the figure), anterior to posterior, and inferior to superior (from inside the page to outside of the page), respectively.\nIn the upper right hand corner of the ROI at slice 40 ( Fig. 5 ) , we see the cingulum bundle, which travels along the direction from the top to the bottom of the figure. Similarly, top-to-bottom directionality is present in the corresponding FOD estimates ( Fig. 6 (b) , lower right panel). In the lower right hand corner of the ROI at slice 40, we see a combination of the cingulum bundle which trav- Fig. 6 (b) , lower right panel, shows left-to-right directionality. The left hand edge of the ROI shows the corticospinal tract, with its into-the-page, out-of-the page direction of travel. Similarly, the left hand edge of Fig. 6 (b) , lower right panel, shows FOD estimates with this same directionality.\nThe center of the ROI at slice 40 (subregion shown at higher magnification in Fig. 7 ) can be plausibly hypothesized to be the location where the corticospinal tract, superior occipitofrontal fasci- culus, and corpus callosum intersect. According to the atlas ( Fig. 5 ) , the corticospinal tract begins to the left of the ROI in slice 39, and is shown progressing toward the center of the ROI by slice 41. Similarly, the corpus callosum is shown to the right of the central region in slice 39 but has progressed toward the left, to the center of the ROI, by slice 41. The superior occipitofrontal fasciculus is clearly shown just to the left of center of the ROI in slice 39, is faintly visible in slice 40, and is gone in slice 41. These are also corroborated by SN-lasso estimates on slices 39 and 41 ( Fig. 8 ) .\nEach of these observations suggests that the three tracts were indeed on a course to intersect with each other in the center of the ROI at slice 40. Correspondingly, SN-lasso estimates for that re- The middle to right portion of the ROI at slice 38 in Fig. 5 is the CSF region according to the b 0 image on the background (see also Fig. S.14) . The MD map ( Fig. 9 (a) , right panel) also indicates that this region is likely to be CSF by large MD values. This is corroborated by the fact that the SN-lasso estimates of FODs for many voxels in this subregion are isotropic, represented by green balls in Fig. 9 (b) , lower right panel. In contrast, the other three estimators do not automatically identify isotropic voxels in this subregion and instead give noisy estimates with spurious peaks."}, {"section_title": "Tractography results", "text": "The reconstructed fiber trajectories are shown in Figs. S.10 and S.16 from two different perspectives. The major observations are as follows. All four tracts in the atlas ( Fig. 5 ) are clearly present in the tracking results based on the SN-lasso estimates: the blue trajectories correspond to CT, the red trajectories correspond to CC, the bigger bundle of green trajectories corresponds to CB and the smaller bundle of green trajectories corresponds to SOF. Moreover, among the five estimators, tracking based on the SN-lasso estimates showed the most coherent and least noisy trajectories. For example, the red trajectories (part of CC) form a more tightly grouped cluster of curves and they are more parallel to each other.\nThe sizes of CC and SOF in the SN-lasso fiber traces are more consistent with the atlas than the fiber traces based on the other FOD estimators.\nThe most prominent difference between SN-lasso based results and those based on the other estimators is that, in the lower right part of the region shown in Fig. 10 , SN-lasso based tracking showed no trajectories while tracking based on the other FOD estimators did show trajectories, including some combination of CC and SOF. This region corresponds to the right portion of the ROI shown on z-slices 37 and 38 of Figs. 5 and S.14; based on these figures, the region does not contain white matter at all, but rather cerebrospinal fluid (CSF). Therefore, since it shows no fiber trajectories through this region, SN-lasso based tracking is more consistent with the atlas than tracking based on the other FOD estimators. Finally, tracking based on the SH estimates has the least coherent and the most noisy patterns."}, {"section_title": "Discussion", "text": "In this paper, we present a novel method for FOD estimation that is accurate, has low variability, preserves sharp features, and is computationally efficient. The effectiveness of the proposed method derives from utilization of a multiresolution spherical frame called needlets that admits stable and parsimonious representation of FODs. Estimation accuracy is gained by imposing a sparsity constraint on the needlet coefficients, together with a nonnegativity constraint on the estimated FOD. The proposed method mitigates difficulties faced by SH-ridge ( Tournier et al., 2004 ) and SuperCSD ( Tournier et al., 2007 ) , two well-known FOD estimators based on the SH representation. Specifically, due to the global nature of the SH basis, SH-ridge tends to over-smooth the peaks, resulting in the loss of directionality information. In addition, SuperCSD tends to amplify spurious peaks in estimated FODs due to high variability. The proposed SN-lasso estimator also outperforms DiST ( Wong et al., 2016 ) , a method based on the discrete mixture model, which tends to under-estimate the number of fibers when the crossing angle is small.\nThe localization properties of needlets are one of its major advantages over SH basis or tensor based methods, as the true FODs are expected to have localized peaks. Particularly, SN-lasso is able to achieve good angular resolution due to the localization properties of the needlets. A potential disadvantage of needlets is that unlike SH basis they do not form an orthonormal basis. Thus certain mathematical and computational conveniences are lost. Nevertheless, many properties are still retained as needlets form a tight frame. In terms of computation, the current implementation of SN-lasso is able to fit 10 0,0 0 0 voxels in a few hours on a server with 256 RMA and 72 cores. The codes will be disseminated through git repository.\nExperimental results on synthetic data suggest that the proposed method leads to better FOD estimation than the competing methods, particularly in terms of identification of major fiber directions. These results are consistent with the well-established statistical notion that a nonlinear shrinkage strategy allied with sparse representation is more efficient for signal recovery than a linear shrinkage strategy ( Johnstone, 2017; Tsybakov, 2009 ). Moreover, the use of 1 penalized regression by SN-lasso enables an effective bias-variance trade off.\nThe proposed method is able to successfully reconstruct an FOD when the fiber crossing angle is as small as 30 \u00b0pro-vided that the b-value and SNR are sufficiently large (e.g., b = 30 0 0 , 50 0 0 s/mm 2 , SNR = 50 ). Resolving small crossing angles at relatively low b-values has been reported to be a challenging setting. For example, in Yeh and Tseng (2013) , under b = 1500 s/mm 2 , SNR = 20 , n = 55 , the best performing method has around 20 \u00b0angular deviation at 45 \u00b0crossing angle. On the other hand, with the fast advancement of D-MRI technologies, we are expecting larger b-values and SNR ( Setsompop et al., 2013; Van Essen et al., 2013 ) . The use of larger b-values for reconstruction of diffusion characteristics has also been previously advocated in the literature ( Jensen et al., 2016; Jones et al., 2013; Roine et al., 2015 ) in anticipation of future technological advances. Therefore, the proposed method is promising in terms of resolving subtle fiber crossing patterns in settings that will become increasingly relevant over time. Moreover, it is able to effectively identify isotropic diffusion with a high degree of accuracy.\nIn experiments on real 3T D-MRI data sets, the proposed method leads to more realistic descriptions of crossing fibers and better tractography results than competing methods at a relatively small number of gradient directions, indicating the practical value of our method for analyzing D-MRI data from current studies.\nOur use of multiresolution spherical wavelets bears some similarity to the dODF-sharpening strategy of Kezele et al. (2010) where a spherical wavelets transform due to Starck et al. (2006) is employed. However, the method of Kezele et al. (2010) is not directly applicable here since we aim to estimate the FOD (or fiber ODF) rather than dODF. Moreover, the spherical wavelets constructed by Starck et al. (2006) do not possess the spherical function representation characteristics and tight frame properties of needlets. Finally, while our needlets representation enables us to impose sparsity constraints, Kezele et al. (2010) uses the spherical wavelets transform only as a band-pass filter. Among alternative choices of spherical wavelets, the lifting scheme based wavelets constructed by Schr\u00f6der and Sweldens (1995) provide excellent spatial localization and ease of computation. However, since these wavelets are nonsmooth and consequently poorly localized in frequency, they are not optimal for FOD reconstruction since FODs have sharply localized features, which require frequency localization of the basis functions for a parsimonious representation.\nThere are a few limitations of the proposed method. First, the FOD is only a convenient mathematical abstraction of the complex geometry of neuronal fiber organization within a voxel. Therefore, the identification of FOD peaks with the orientations of the fiber bundles may not hold in a strict physical sense. Nevertheless, since we are treating the FOD as a continuous function on S 2 as opposed to a discrete mixture of point masses, the reconstructed FOD is arguably a more realistic descriptor of the local geometry of the fiber bundles. Second, we assume antipodal symmetry of the FOD following existing literature on FOD estimation. Such FODs may not represent diverging (\"fanning\") configurations of fiber bundles very well. However, by using the original (not symmetrized) needlets, it is possible to extend our method to deal with scenarios involving fanning, bending of fiber tracts, and so on. Third, when estimating the FOD at a voxel, currently we only use data from that voxel. Since fibers tend to be spatially contiguous, incorporation of data from neighboring voxels in FOD estimation may further improve estimation accuracy.\nOne avenue for future research is the extension of this method to multiple q -shell data. An emerging strength of such data is its ability to accommodate multiple cellular compartment models that separately quantify the contributions of free water, water bound within the myelin sheath, inter-axonal water, and other compartments to the D-MRI signal. As such, multiple q -shell data may be best modeled to allow for different FOD representations for different compartments, as in the NODDI scheme ( Zhang et al., 2012 ) , rather than a single spherical function as in our method. On the other hand, spherical needlets might provide accurate and robust representation of some of these signal components, possibly with specific coefficient penalties for specific components. Future experimentation should determine settings in which spherical needlets are useful for modeling components of the multiple q -shell D-MRI signal."}]
[{"section_title": "Abstract", "text": "The literature on climate risk and crop yields is currently focused on the potential for highly nonlinear marginal effects, essentially modeling the threshold effects with a yield function that maps weather inputs into crop yields. Implicit in this line of research is the assertion that the traditional quadratic model of crop yield suffers from specification bias. This article examines this assumption by using the Flexible Fourier Transforms (FFT) to allow for global flexibility in the weather effects while also maintaining the traditional quadratic model as a nested model specification. In order to speak to the global flexibility of FFT, as well as to provide both robustness to outliers and information on the scale effects of weather variables, this article compares FFT with restricted cubic spline (RCS) and quadratic models in a quantile regression framework. Using U.S. county-level data on corn, soybeans, and winter wheat from 1975 to 2013, we find that while the threshold effects are largely captured by the traditional quadratic model, we statistically reject the hypothesis that the quadratic model is sufficiently flexible. We find that, under the more flexible FFT functional forms, at lower temperatures there is a greater positive impact of marginal increases in temperature on yield than with the quadratic model, which suggests a different yield-temperature relationship than found in much of the literature on threshold effects of temperature on crop yields, and is more consistent with the positive effects of minor temperature increases found in some of the Ricardian climate effect literature."}, {"section_title": "", "text": "Methodological debates over model specifications are central to research on agricultural impacts of climate change. Ricardian models that examine the link between land values and climate (Mendelsohn, Nordhaus, and Shaw 1994) , as well as alternative versions that examine the link between cropland profits and weather (Deschenes and Greenstone 2007) , rely almost exclusively on quadratic functional forms for weather or climate variables. One justification given for this approach is that the crop production function is likely quadratic with respect to weather (Schlenker, Hanemann, and Fisher 2005) , although some research finds that aggregation and truncation of the monthly temperature data into growing degree days can produce better fit (Schlenker, Hanemann, and Fisher 2006) .\nA parallel research effort focuses on estimating conditional yield functions (which are derived from crop production functions by normalizing output with respect to the acreage input and then excluding all other endogenous inputs). The current literature argues that quadratic specifications are not adequate representations of conditional crop yield functions when those functions have threshold effects Roberts 2006, 2009) . The costs of climate change to agricultural production may be driven more by environmental risks such as drought and flooding than by changes in average temperature and precipitation, particularly if climate change increases the frequency and intensity of extreme events (Parry 2007) . These alternatives to the quadratic approach for modeling threshold incorporate both alternative functional forms and significant transformation of weather data, the latter of which is intended as a response to measurement error. But by blending alternative data structure and functional forms, the threshold effect literature makes it difficult to be sure which of these factors lies behind the findings of significant threshold effects. In this article, we isolate the issue of model specification by using Flexible Fourier Transforms (FFT), a globally flexible model in which the traditional quadratic model is a nested component. We also compare FFT with restricted cubic spline (RCS) and illustrate how these semi-parametric specifications can be combined with quantile regression (QR) to provide both robustness to outliers and information on the scale effects of weather variables.\nThe quadratic functional form of crop yield functions remains attractive for climate change research because it is parsimonious, simple to implement, easy to understand, and quite capable of capturing rapidly increasing marginal damages at higher temperatures. Nonetheless, the possibility of non-linear threshold effects remains an important concern when estimating the expected damages of climate change. Specifying a quadratic production function may do a reasonable job of estimating the average marginal effect of temperature. However, it will produce biased estimates of localized marginal effects. Specifically, it will overestimate marginal damages near the threshold temperature but underestimate marginal damages further from the threshold temperature. Note that this problem of localized bias of marginal effects is similar to the problem of using linear or quadratic time trends as proxies for technical change when the goal is to recover the distribution of detrended (i.e., constant technology) yield shocks.\nOf course, specification bias is just one possible source of bias in yield models. Efforts to control for omitted variables bias are central to the debate over whether it is more appropriate to use cross-sectional variation in climate data to estimate these models or whether temporal variation in local weather in combination with (usually county) fixed effects can be used instead. In addition, some studies suggest that there is considerable measurement error and accompanying attenuation bias when using monthly average temperature and precipitation data (Schlenker and Roberts, 2006) .\nIn this article, we seek to clearly address the issue of specification bias through the use of flexible functional forms. In keeping with the recent literature, we use weather data combined with fixed effects to control for omitted variable bias. In contrast to the threshold effects literature, we explicitly do not incorporate methods that control for potential measurement error in the weather variables by aggregating those variables into exposure times of different temperature bins. Instead, we address the measurement error by relying on average daily maximum temperatures, a measure of exposure to extreme heat in each month that is less noisy than average daily mean temperatures. Maintaining the temperature data in separable monthly measures allows us to nest the traditional quadratic model within the more flexible FFT model. This nesting of functional forms provides a clean test for the hypothesis that functional form specification bias is the source of underestimates of localized marginal damages of high temperatures. Thus, if the traditional quadratic model is taken as the null hypothesis and is rejected, then it will be rejected purely on the basis of the functional form specification. If the traditional quadratic model is not rejected, then this research will point toward other aspects of the crop yield data-generating process as being fundamental to earlier studies that model non-linear threshold effects.\nThe primary model used in this article, the FFT, is a semi-nonparametric method that allows for the non-linear response of yield to weather variables. The FFT provides a parsimonious representation of non-linear marginal effects and allows for much greater flexibility than higher-order polynomial functions, and is more easily applied to multivariate estimations than is kernel regression. The Fourier functional form is one of the few functional forms known to have Sobolev flexibility, which means that the difference between an estimated function g\u00f0x; h\u00de and the true function f \u00f0x; h\u00de can be made arbitrarily small for any value of x as the sample size becomes large (Gallant 1994 ).\nHowever, the flexible properties of the FFT are asymptotic. To reduce the burden on the applied FFT analysis in converging on the true function, this article uses the FFT in conjunction with quantile regressions (QR). Further, M-estimators such as quantile regression have been advocated in crop yield studies for both their robustness to outliers and their semi-parametric properties, that is, their freedom from distributional assumptions (Harri et al. 2009; Finger 2010 ), but not from functional form assumptions. The combined FFT-quantile estimator is seminonparametric and is free of assumptions regarding the distribution of the regression error as well as the functional form of the yield relationship g\u00f0:\u00de. The benefit of this approach over a nonparametic quantile (kernel) regression is that multiple explanatory variables can be easily included. In order to test the validity of FFT, we also compare it with RCS, another semi-nonparametric specification commonly used in the yield estimation literature (Berry, Roberts, and Schlenker 2013; Roberts and Schlenker 2011) .\nWe implement the combination of FFT, RCS, and QRs for the estimation of yield distributions for corn, soybeans, and wheat in all U.S. counties where these crops are grown and for which the National Agricultural Statistics Services reported data over 1975 to 2013. We find that while higher marginal damages at higher temperatures are largely captured by the traditional quadratic model, the benefits of using a more flexible functional form are mixed. Using the nested specification, a quantile regression rank test (Gutenbrunner et al. 1993 ) statistically rejects the nested quadratic model, which suggests that the quadratic model is insufficiently flexible. In addition, quantile estimator goodness-of-fit tests (Koenker and Machado 1999) also favor FFT over RCS. However, there are mixed results on tests of whether the FFT and RCS models are overfitting the data.\nBeyond the issue of functional form, this research also finds evidence that the local marginal effects of temperature on crop yields are different across the summer months. This finding contrasts with a critical assumption in the methods used to reaggregate temperature data in some of the threshold effects literature. Finally, even though the quadratic model is statistically rejected, the FFT and RCS models do not always find larger negative impacts of higher temperatures in all cases. Taken as whole, our findings suggest that correcting only the functional form misspecification of the quadratic model does not consistently reveal large threshold effects in the conditional yield functions. This suggests that some of the discrepancies between the crop-yield threshold effects literature and the climate change effects Ricardian literature is due to difference in data aggregations rather than misspecification of functional form in the Ricardian literature.\nThe rest of the article is organized as follows. The following section presents a brief review of the literature on crop yield estimation method. The next section presents the FFT, RCS, and QR estimation methods. The subsequent section summarizes the data used in the analysis, followed by a section that presents the results of the model. The last section concludes."}, {"section_title": "The Literature on Estimation of Crop Yield Distributions", "text": "A large body of literature exists on methods for estimating crop yield distributions. Examples include conditional (Schlenker and Roberts 2006) and unconditional (Harri et al. 2009 ) crop yield distributions based on (county-level) crop yield data and including time-dependent technical change (Moss and Shonkwiler 1993) , controls for influential outliers, often due to drought or flooding, (Finger 2010) , allowance for potentially nonnormal yield distributions (Ramirez, Misra, and Field 2003) , and tests of non-linear responses to weather shocks (Schlenker and Roberts 2009 ). Most of these studies utilize panel data fixed effects to control for potential omitted variables bias, especially bias due to regional differences in soils and other landscape factors that influence production but are unobserved by the econometrician. In this way, these models run somewhat contrary to the Ricardian models of climate impacts, which argue that cross-sectional (between) variation rather than time-series (within) variation is the appropriate proxy for estimating long-run changes in production functions likely to occur due to climate change (e.g., Mendelsohn, Nordhaus, and Shaw 1994) , a position challenged by others (e.g., Deschenes and Greenstone 2007) . Some studies have found that both types of variation can lead to similar results, at least when estimating yield functions rather than profit or hedonic price functions (Schlenker and Roberts 2009) .\nAgronomic simulation models provide an alternative method to estimate the impacts of climate change on expected crop yields (Adams et al. 1990; Park and Sinclair 1993) . However, crop simulators may not adequately represent optimization at the farm level, which leads some analysts to prefer econometric models of conditional crop yields (Lobell, Cahill, and Field 2007; McCarl, Villavicencio, and Wu 2008; Huang and Khanna 2010) . Some of these studies also examine change in production risk by examining conditional variance of yield (Chen, McCarl, and Schimmelpfennig 2004) . For the most part, these studies focus on the specification of weather variables and rely on linear or quadratic time trends. While there is evidence that crop yields may not be either differencestationary or trend-stationary (Pujula, Maradiaga, and Dicks 2010) , conditioning on weather variables may solve these problems (Chen, McCarl, and Schimmelpfennig 2004) .\nControlling for time trends is a more central topic in the estimation of unconditional crop yield distributions. Potentially non-linear trends in technical adoption are difficult to estimate in the presence of nonnormal distributions (Moss and Shonkwiler 1993) . Kernel-density estimation is a useful method for capturing non-linearities and may help reduce sensitivity to non-normality (Ker and Goodwin 2000; Ker and Coble 2003) but it is not computationally tractable in multivariate regressions.\nSkewness is a prevalent concern in crop yield distributions, although there are dramatic differences in skewness across regions and crops (Harri et al. 2009; Ramirez, Misra, and Field 2003) . In general, skewed crop yield distributions generate outliers that make the estimation of time trends sensitive to large yield shocks that occur toward the beginning or end of a data series. Robust estimators, such as quantile regression, provide one means of controlling for these outliers (Finger 2010) . Skewness may also result from underlying skewness in weather variables even if the underlying conditional distribution is normal (Hennessy 2009 ), meaning that conditioning on weather also provides a useful means of ensuring robustness in time trend estimation. These higher moments of the crop yield distribution can be estimated using maximum entropy models (e.g., Tack, Harri, and Coble 2012) or, more indirectly, through quantile methods such as the one used in this article."}, {"section_title": "Overview of the Econometric Models", "text": "In our analysis, we model yield as a function of input and output prices, weather variables, state-specific quadratic time trends, and county fixed effects, which serve as proxies for land characteristics. The explanatory variables, excluding time trends and county fixed effects, are then transformed using quadratic, Fourier, and restricted cubic spline function forms."}, {"section_title": "Fourier Functional Form", "text": "Semi-nonparametric (SNP) methods, which expand the parameter space, are halfway between parametric and nonparametric inference procedures. An advantage of SNP over nonparametric methods is that they allow the researcher to reduce the potential for misspecification bias associated with parametric techniques, while at the same time more easily accounting for explanatory variables than nonparametric methods.\nThe Fourier functional form we use for the SNP is the only functional form known to have Sobolev flexibility, which means that the difference between the model Y SNP \u00f0x; h\u00de and the true function f \u00f0x\u00de can be made arbitrarily small for any value of x as the sample size becomes large (Gallant 1994) . The Fourier flexible functional form, which attaches linear and quadratic terms to the Fourier terms to help decrease the number of terms needed to model nonperiodic functions, is specified as (Gallant 1982) : \na k a , and h \u00bc \u00f0b; u; v; w\u00de is a vector of parameters (with dimensionality to be determined). The variables s\u00f0x\u00de are scaled version of x such that s\u00f0x\u00de lie in the interval \u00bd0; 2p, which prevents periodicity in the model (Gallant 1982; Mitchell and Onvural 1996) , k a is an elementary multi-index vector with length K, and J is a positive integer and is called the order of Fourier function form.\n1 The selection of J and K is discussed later in the article."}, {"section_title": "Restricted Cubic Spline", "text": "In order to judge the global efficiency of the Fourier functional form, we compare it with the RCS, which is another flexible functional form used in recent yield estimation literature (Roberts and Schlenker 2011; Berry, Roberts, and Schlenker 2013) .\nIn essence, RCS is an interpolation method over a set of pre-determined points (\"knots\"); it is a restricted version of cubic spline, a smooth set of piecewise cubic polynomials between the adjacent knots, in the sense that the function is forced to be linear outside of the first and the last knots. Let k i ; where i \u00bc 1; . . .; n; to the knots values;x i , be the variables to be created using RCS transformation; and x be the original explanatory variables. The RCS transformed variables are\nwhere \u00f0u\u00de \u00fe \u00bc u if u > 0, and 0 otherwise."}, {"section_title": "2", "text": "It can be seen from equation (2) that RCS multiplies the number of relevant variables by (n -1). Given that the number of knots are generally between 3 and 7, RCS does not reduce the degrees of freedom as much as high-order polynomials or step functions."}, {"section_title": "Quantile Estimation", "text": "Obtaining the conditional mean of the yield function, using equation (1), is a natural starting point for regression analysis. However, if the conditional distribution of yield is not symmetric, then robustness of coefficient estimates to outliers becomes a concern. We therefore employ median quantile regression in our analysis (Koenker 2005) . The median quantile version of our main equation, following the notations in Krishnamurthy (2012) , can be written as\nwhere Q 50 denotes median quantile, y it is the dependent variable, a i is the county fixed effects, x it and z it are explanatory variables, it is the error term, and h and c are model parameters. 3 The variables in vector z it are time trend variables that are not transformed using FFT or RCS.\nOur yield model includes county fixed effects, which are meant to capture county soil heterogeneity and other potential fixed crosscounty differences. Since quantiles are not linear operators, we could not apply the standard de-meaning approach. Instead, we employed the two-step-estimators proposed by Canay (2011) . This approach assumes that fixed effects are pure location shifts, meaning that the fixed effects have the same effects on the dependent variable regardless of the quantiles.\nUsing the pure location shift assumption, Canay (2011) shows that quantile regression for panel data can be estimated as follows:\n\u2022 Step 1. Estimate the standard fixed effects regression at the conditional mean and\nit\u0109l , where\u00e2 i are the estimated fixed effects and\u0125 l and c l are estimated parameters from the conditional mean regression.\n\u2022 Step 2. Define\u0177 it y it \u00c0\u00e2 i and replace y it with\u0177 it in the standard quantile regression. 1 The rules for formulating k a are given in Gallant (1982) : (i) k a cannot be a zero vector and its first non-zero element must be positive; (ii) its element cannot have a common integer divisor; (iii) these qualified k a vectors have to be further arranged into a sequence such that k 1 ; k 2 ; ::; k A are elementary vectors and their lengths are non-decreasing in a. The integer A denotes the number of k a vectors needed, where A equals K \u00c3 K less the sum of an integer sequence from 1 to (K\u00c01), and where K is the number of variables to be transformed.\n2 It is sometimes recommended that the vectorsx i be orthogonalized to reduce numerical instability in a regression setting. We did not carry out orthogonalization in our analysis because there was no numerical instability when running the model and other RCS models of yields did not require orthogonalization (Berry, Roberts, and Schlenker 2013) . In our analysis, we apply spline functions of the same order to all the variables of interest simultaneously.\nUsing a two-step approach in estimating parameters of FFT and RCS specifications raises two issues. First, the computation of standard errors, which is quite challenging for quantile regression, must account for this two-step nature. Second, taken individually, FFT and RCS coefficients, which are not in their original forms, do not have an economic interpretation and provide minimal theoretical or behavioral insight, especially if the number of Fourier terms and knots are large. To give FFT and RCS regression results an economic interpretation, we use bootstrapping to estimate the marginal effects (\n) and elasticities of the base (i.e., untransformed) variables."}, {"section_title": "Model Selection in Quantile Regression", "text": "From equation (1), because s\u00f0x\u00de is a simple affine transformation of the original x, one could think of u 0 \u00fe b 0 x \u00fe s\u00f0x\u00de 0 Ds\u00f0x\u00de as a quadratic function that is nested within the FFT specification. The validity of the quadratic model, therefore, can simply be assessed by testing whether or not the Fourier parameters, v; w, are statistically different from zero.\nWe compare quadratic with FFT by using a quantile rank score test as introduced in Gutenbrunner et al. (1993) . As noted in Cade, Richards, and Mielke, Jr. (2006) , the v 2 test statistic in Gutenbrunner et al. (1993) was just the limiting form of an F statistic, and that the F statistic had better small sample Type I error rates. Because of this, we report F statistics in our rank score test.\nThe rank score test, however, can only be used when the models are nested, such as in the case of the FFT and quadratic. In order to compare FFT and RCS specifications, we rely on the pseudo-R 2 as suggested by Koenker and Machado (1999) . The pseudo-R 2 measures goodness of fit by comparing the sum of weighted deviation from the full model of interest with the associated sum of a model with only the intercept. This article examines yield data for corn (for grain), soybeans, and winter wheat, the three most significant row crops in the United States in terms of planted acreage. For each crop we construct a fully-balanced panel by excluding any counties that are missing planted acreage data in any year. Some marginal counties (counties with too few planted acres to permit NASS publishing the data without consequences for confidentiality) are omitted from the analysis.\nSome earlier studies, recognizing the impact that irrigation can have in mitigating the impacts of weather on yield, ruled out (most) irrigated production by employing a geographic restriction that excluded counties in the western United States, where irrigation is used for most crop production (e.g., Schlenker and Roberts 2009 ). We do not use such a geographic restriction as it would exclude some dryland production in the western United States and because it would still include a significant amount of irrigated production in the Southern Mississippi region. Instead, we exclude irrigated counties, which we define as counties where at least 10% of harvested cropland was irrigated in 1997, 2002, or 2007 , the years when the Census of Agriculture was collected and the irrigated share of harvested acreage can be calculated for all counties. Our finalized dataset is comprised of 804, 718, and 367 counties for corn, soybeans, and winter wheat, respectively. 5, 6 Yields in each year are planted-acre yield, that is, total production divided by planted acreage. Some other studies rely on harvested acreage yield. Harvested acreage yields do not account for unharvested acreage and are, therefore, within-county averages that ignore fields with zero yield. Planted acreage yields account for fluctuations in the total number of unharvested acres, which we expect varies with weather shocks. Because planted acreage for corn includes both silage and grain production but the yield data (in terms of bushels per acre) only includes grain production, the planted acreage yield for corn needs to be adjusted. Total planted acreage is corrected by subtracting out acreage that is harvested for silage, which is equivalent to assuming that all unharvested acreage was planted for grain rather than for silage.\nWeather data are taken from the Oregon State University's PRISM (Parameter-elevation Regressions on Independent Slopes Model) climate mapping system (PRISM 2014) . Taking into account the interaction of topography and meterological processes, the PRISM data is a gridded interpolation of weather station data and includes monthly values of total precipitation, average daily maximum temperature, and average daily minimum temperature. For this article, all PRISM grid cells that overlaid agricultural land in each county were averaged to produce county-level weather variables. These monthly weather variables are directly used for each month during the primary growing season (May, June, July, and August for corn and soybeans, and March, April, and May for winter wheat). Other months are aggregated into either bi-monthly or quarterly weather variables by averaging the daily maximum temperature and summing the total precipitation. Using average daily maximum temperature provides a better measure of exposure to extreme heat than average daily temperature.\nThe full list of weather variables is provided in the supplemental appendix online.\nFor the input price, we use the April ammonia price from the ERS fertilizer data. The output prices are the maximum of the Chicago Board of Trade (CBOT) futures price and loan rate in the same year. The loan rate is defined by Title I of the U.S. Farm Act covering that year. The CBOT futures price are publicly available from Quandl (Quandl 2015) . Both input and output prices are normalized by the annual U.S. Consumer Price Index for 2013 (Bureau of Labor Statistics 2015)."}, {"section_title": "7", "text": "The other explanatory variables are the state-specific time trend, which proxies for technical change, and lagged acreage shares reflecting crop rotations, which captures the impacts of crop rotation or double cropping on yields that occur when farmers deviate substantially from standard rotations. The lagged acreage share is the ratio of corn acres to the sum total of corn, soybeans, and winter wheat acres from the previous year. "}, {"section_title": "Results", "text": "We present the results in five parts. The first part presents the primary results, which are the model specification tests based on the nesting of the quadratic model within the FFT model. The second part summarizes the results in terms of the average marginal weather effects that result from the preferred model. The third part compares the alternative specification in terms of local marginal effects, which allows for a closer comparison of the \"threshold effects\" estimated by each model. The fourth part compares weather responses across months, which provides insight into the additivity assumption that the local marginal effects of temperature exposure is the same across months during the growing season (Schlenker and Roberts 2009 ). Finally, the fifth part is an out-of-sample test to examine whether the more flexible functional forms are overfitting the data. 5 In 2013, these counties account for 63.4% of planted acreage for corn, 62.5% of planted acreage for soybeans, and 34.03% of planted acreage for winter wheat. This is approximately half of the counties used in studies that do not require a balanced panel for yield observations (e.g., Schlenker and Roberts 2009) . 6 Per internal policy change, NASS has recently started replacing data for marginal counties with \"Combined Counties.\" As a result, many counties that had data in the earlier years are no longer identifiable. This results in the low number of counties used in our analysis, especially for winter wheat. 7 Corn and soybeans futures are defined as settled prices for contracts signed in February to be delivered in September. Similarly, winter wheat futures are settled prices for contracts signed in September to be delivered in May of next year.\n8 Shares provide a better measure of rotation than absolute acreage levels and have the added benefit of reducing loss of degrees of freedom."}, {"section_title": "Model Selection", "text": "For all three crops, we estimate the FFT model containing quadratic terms and the nested model (without Fourier terms) in which yield is a quadratic function of the weather variables. We also estimate the restricted cubic spline model to provide some basis for comparison to earlier studies that have used splines as an alternative flexible functional form (e.g., Roberts and Schlenker 2011; Berry, Roberts, and Schlenker 2013) . The primary specification test is a rank test of the FFT model against the quadratic model.\nAs commonly found in semi-parametric estimation frameworks, the choice of the \"tuning parameters\" (i.e., the integers J; K in the FFT case, and \"knots\" in the RCS) plays a key role in both estimation and inference. For FFT, a formal criterion for choosing K and J is not well-established. Chalfant and Gallant (1985) suggest a rule of thumb that the dimension of h \u00bc N 2=3 , but Fenton and Gallant (1996) noted that h \u00bc N 1=2 is likely to be more representative of actual practice. For RCS, Harrell (2001) suggested having between 3 and 7 knots. Because the selection of these \"tuning parameters\" can significantly change test results, we compare FFT, RCS, and quadratic models using several different sets of J, K, and knots (tables 1 and 2). Table 1 presents pseudo-R 2 for the three models and rank test comparing FFT and quadratic models. For all of the different specification of FFT parameters, the rank tests reject the quadratic model with significant F-statistics. The goodness-of-fit references at the median, pseudo-R 2 , also favor the FFT specification. Due to the two-step approach used in estimating the quantile regression, the pseudo-R 2 for the quadratic model varies over the specifications even though the number of variables does not change. Table 1 shows that RCS with 5 knots fits the data slightly better than FFT for corn and soybeans when the number of Fourier terms is small. Once we increase the number of FFT variables using the rule of thumb suggested in Chalfant and Gallant (1985) , we see that FFT has a better fit than RCS at the median. This result holds even when we increase the number of knots for RCS from 5 to 15 (table 2) .\nBased on these F tests, the quadratic model is statistically rejected in favor of the more flexible FFT model. This result is consistent with earlier studies showing that the quadratic model is not sufficiently flexible. Therefore, functional form mis-specification is an important concern for crop yield models. Determining whether the localized biases are the same across models, however, requires additional analysis."}, {"section_title": "Crop Yields Response to Weather under FFT", "text": "As discussed above, there is limited benefit to directly reporting the Fourier coefficients. Instead, tables 3 and 4 show the elasticities of key variables in FFT, which are numerically computed at their median values using the relatively parsimonious rule for adding Fourier terms (i.e., length\u00f0h\u00de \u00bc N 1=3 )."}, {"section_title": "10, 11", "text": "The standard errors of the estimates are found using 200 block (state-level) bootstraps. The block bootstrapping method was used to preserve all the potential spatial correlation of crop yields among counties in the same state. In addition, instead of reporting the time trend for each state, we show a national trend, which is the acreage-weighted average of state-specific time trends. For corn and soybeans, we found that higher temperatures in the summertime have a pronounced negative impact on their yields, which is similar to findings in the previous literature. Higher temperatures during the planting and harvesting periods have positive impacts on yields, though not as significant in terms of magnitude as the negative summer impacts. Not surprisingly, summer precipitation is beneficial for crop yields. Planting season precipitation has small but statistically significant negative impacts on yield, perhaps because wet fields can delay planting. Since both temperature and precipitation significantly affect yield, we introduce an interaction term between these variables in the second version of each model. However, results from table 3 show that none of the interaction terms are statistically significant. The third model for each crop omits the price and lagged acreage variables, leaving a selection of variables that is comparable to Schlenker Note: Bold estimates are significant (p 0:05) with 200 block bootstraps (state level) using state-specific time trend and county fixed effects. Lag acreage is the ratio of lag corn acres over the sum of lag corn, soybeans, and winter wheat acres. National time trend is the area-weighted average of state-specific time trends.\nand Roberts (2009) , albeit without their reaggregation of the temperature variable into time-of-exposure bins.\nThe wheat model (table 4) , while exhibiting similar overall fit to the corn and soybean models, is difficult to interpret, on average. Almost all of the precipitation variables have a negative effect on winter wheat yields. This could reflect well-known problems due to excess moisture later in the season (e.g., lodging) or from the large impact of delayed planting in the previous fall, or from heavy and prolonged snow cover during the winter. The absence of an average positive effect for moisture in any month is surprising, but could reflect the fact that many winter wheat areas rely heavily on soil moisture that accumulated during a prior year of a fallow rotation. Alternatively, this could be due to the fact that, based on our method of excluding irrigated counties, we have many winter wheat areas where there is a large amount of marginal winter wheat land. More importantly, though, since the model is highly flexible, these average effects do not tell the whole story (see the supplemental appendix online for the impacts of precipitation on winter wheat yields over a range of precipitation values). Winter wheat yield is also adversely affected by May maximum temperatures. High temperatures in May can cause wheat to break dormancy and initiate growth too early, which can lead to freeze injury."}, {"section_title": "A Closer Look at FFT, RCS, and Quadratic Models", "text": "To illustrate the fit of the FFT, RCS, and quadratic models, we examine the non-linear response of corn, soybean, and winter wheat yields to average monthly maximum temperatures. Given the high elasticities on maximum temperature in the summer for corn and soybeans, and on maximum temperature in May for winter wheat, we focus on visually examining these marginal effects in figure 1 . 12 In addition, based on the results in table 1, we choose the FFT specifications where the conditional (median) pseudo-R 2 from FFT is higher than that of a RCS specification with 5 knots. Predicted yields are computed assuming that the other explanatory variables are held constant at their sample medians. For example, the predicted corn and soybeans yields in figure 1 equalb\u00f0TmaxSummer\u00de \u00fe\u0109X 50 , whereb and\u0109 are estimated parameters (the latter a vector) Note: Bold estimates are significant (p 0:05) with 200 block bootstraps (state level) using state-specific time trend and county fixed effects. Lag acreage is the ratio of lag corn acres over the sum of lag corn, soybeans, and winter wheat acres. National time trend is the area-weighted average of state-specific time trend. Fall season includes September-November. Winter season includes December-February of the following year.\nand X 50 represents all the other variables being held at their medians.\nThe non-linear responses of yield to weather are easily seen for corn and soybeans in all models, particularly in the tails of the yield distribution. However, the quadratic model fails to detect the high variance of corn and soybeans yield at higher temperatures, showing consistently declining gains in corn and soybeans yields as temperature rises. In addition, both quadratic and RCS models overestimate the impacts of weather on crop yields, resulting in negative predictions for corn and soybeans.\nThe fit of FFT over RCS and quadratic models can be seen from the lower panel of figure 1 , where we show the 95% confidence intervals of each regression. The FFT errors are consistently balanced across the observed temperature ranges. In contrast, the error bands of RCS and quadratic models skew as one approaches the temperature tails.\nAnother noteworthy feature of figure 1 is that, based on observed corn and soybeans data, colder-than-optimal temperatures are more harmful (defined as steeper slopes) than warmer-than-optimal temperatures. This phenomenon can also be seen from tables 5 and 6 where, under FFT, the yield derivatives ( @Q 50 \u00f0YjX\u00de @X ) over lower summer temperatures are higher than those for higher temperatures. This finding is consistent with Wilson, Muchow, and Murgatroyd (1995) , who found that lower temperatures can negatively affect yield potential by reducing crops' photosynthetic capacity and prolonging growth duration, which exposes crops to frost prematurely, and thus lowers the growth rate. marginal impacts at the lower temperature relative to the quadratic and RCS. In particular, except for the Tmax of 20 Celsius in July in the case of soybeans, the FFT shows significantly larger benefits in terms of increased yields from raising temperature for the lowest level in the tables. Moving to higher temperatures of 30 Celsius in July and August, the FFT shows higher negative impacts on yields than does the quadratic. On the other hand, moving to the highest temperature in tables 5 and 6 of 35\nCelsius, the quadratic model predicts larger increases in marginal damages as temperatures rise than the RCS, and particularly larger than the FFT. When considering high temperatures of 35\nCelsius over the whole summer-the Tmax Summer-the FFT shows the smallest yield impacts of high temperatures. In summary, for corn and soybeans, both the RCS and the quadratic have a strong tendency to under-predict-by several orders of magnitude-the positive effect on yields of raising temperatures from low levels in the summer. Conversely, the quadratic in particular has a tendency to overpredict the negative effects of high summer temperatures on yields, but the magnitude of over-prediction at high temperatures is lower than the magnitude of its under-prediction at low temperatures.\nWhile we find agreement with prior literature on large negative impacts at higher temperatures across three models, we also find some large positive impact at lower temperatures using FFT. This finding is qualitatively similar to some of the findings in the Ricardian literature suggesting that moderate warming could have some positive impacts, although we would emphasize that most of that literature used cross-sectional variation in climate rather than panel variation in weather. The significance of the positive impacts at lower temperatures probably has more relevance for crop insurance research than for climate adaptation research. Figure 2 compares the effects of temperatures across different months in the growing season based on the conditional median. Most significantly, this figure graphically shows that the marginal benefit of heat accumulation is not constant throughout the growing season, a result that contrasts with the assumptions embedded in most yield models that make use of growing degree days to specify the cumulative exposure of a crop to heat over the course of the growing season."}, {"section_title": "Additivity Assumption", "text": "Statistically, panel (a) in tables 5 and 6 presents comparisons between the marginal effects of maximum June, July, and August temperatures on corn and soybean yields, across the FFT, RCS, and quadratic models. The Kruskal-Wallis test finds statistically significant differences in the marginal impacts of heat on crop yields in June, July, and August across all three models. The effect of warmer temperatures in the summer is much more pronounced when we shock the aggregated summer temperature relative to when we shock each summer months independently. That is suggestive of the idea that findings from Schlenker and Roberts (2009) have a lot to do with data aggregation."}, {"section_title": "Overfitting Tests Using Out-of-Sample Forecasting", "text": "One concern with highly flexible models is that they will overfit the data, thus outperforming simpler models under most traditional statistical tests but actually performing less well at fitting other data. While the goodness-of-fit tests discussed earlier showed that the FFT is the preferred model, we also perform out-of-sample tests. Since we are using panel data, we implement both crosssectional and time-series out-of-sample strategies. Use of these statistics is consistent with the quantile regression of panel data method used in this article as it is based on both N and T asymptotics (Canay 2011) . In order to implement the cross-sectional method, we randomly drop a portion of counties from within each crop-reporting district and then estimate a model with crop-reporting district fixed effects. This allows us to still rely on fixed effects methods to control for unobservable variables. For the time-series method, we randomly drop 7 years out of 39 years. We repeat the whole process 100 times using 5 knots for RCS and length\u00f0h\u00de \u00bc N 2=3 for FFT. Results are reported in tables 7 and 8.\nIn general, for time-series forecasting, RCS outperforms both FFT and quadratic models, suggesting that the FFT may be slightly overfitting the data. Dropping national-level data and lagged variables in table 8 yields better predictions for FFT, yet it still performs worse than both RCS and quadratic specifications. 13 The overfitting of FFT, however, disappears in the cross-sectional setting with smaller mean absolute difference in both tables 7 and 8.\nSince these test runs have mixed findings, the out-of-sample results suggest that using flexible functional forms to detect threshold effects is not without some methodological cost. Previous results on threshold effects in yield functions, such as Roberts and Schlenker (2011) and Berry, Roberts, and Schlenker (2013) , may have involved important interactions between potentially overly flexible functional forms and data disaggregation that lead to the finding of significant Note: Predicted yield is computed assuming that excluded independent variables are at their medians. 13 The fact that complex methods do not necessarily provide more accurate time series forecasts than simple ones is welldocumented in a series of papers led by Spyros Makridakis. Along with others, Makridakis evaluated and compared the accuracy of different forecasting methods over 20 years and found that simpler models frequently perform better than more complex ones in forecasting economic time series (Makridakis et al. 1982 (Makridakis et al. , 1993 Makridakis and Hibon 2000) . Similarly, Poon and Granger (2003) , drawing from 93 volatility forecasting studies, also suggested that simple methods often perform equally well and sometimes better than more advanced models. threshold effects at high temperatures and limited benefits of additional warmth at lower temperatures. Examining this interaction is an important topic for future research."}, {"section_title": "Conclusion", "text": "This article uses Flexible Fourier Transforms to revisit the debate on functional form specification. Specifically, by nesting the traditional quadratic model within an FFT specification, we are able to test whether the added FFT terms provide statistically significant explanatory power. We are then able to compare differences in local marginal effects, which is the concern that motivates the use of flexible functional forms in many studies. We also compare FFT with restricted cubic splines (RCS), another semi-nonparametric method commonly used in yield modeling, to illustrate the relative performance of FFT.\nBecause the flexible properties of the FFT are asymptotic, to reduce the burden on the applied FFT analysis in converging on the true function, this article uses the FFT in conjunction with quantile regressions. The combined FFT-quantile estimator is seminonparametric, and is free of assumptions regarding the distribution of the regression error as well as the functional form of the yield relationship.\nUsing climate and crop data from 1975 to 2013, we statistically reject the hypothesis that the quadratic model is sufficiently flexible, although we also note that the quadratic model does show much larger negative impacts of higher temperatures on yields. In addition, we also found evidence against the additivity assumptions embedded in the newest conditional yield models, which treat exposure to temperature ranges as equivalent throughout the entire growing season.\nThis article contributes to the growing body of literature on the agricultural impacts of climate change. Since FFT is the only functional form known to have Sobolev flexibility, meaning the difference between the estimated and the true model can be made arbitrarily small as the sample size increases, FFT Note: Results are found in two steps: (1) Randomly remove 20% of counties in each crop-reporting district for the cross-sectional prediction and 7 years (out of 39) for time series prediction; (2) predict yields for the dropped counties and compare them with their corresponding observed yields. The entire process is then replicated 100 times. Standard deviations are reported in parentheses. The FFT are transformed such that length\u00f0h\u00de \u00bc N 2=3 , where h are parameters of the fourier model and N is the sample size. Cubic spline is estimated with 5 knots. provides a systematic way of looking for functional form bias. Future research can use this model to examine the implications of model specification on climate change analysis, structural models of the agricultural sector, and federal crop insurance premiums and other commodity support calculations."}, {"section_title": "Supplementary Material", "text": "Supplementary material is available online at http://ajae.oxfordjournals.org/content/ current."}]
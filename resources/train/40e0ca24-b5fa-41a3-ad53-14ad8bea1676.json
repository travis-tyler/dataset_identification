[{"section_title": "Abstract", "text": "Abstract. Neuroimaging datasets keep growing in size to address increasingly complex medical questions. However, even the largest datasets today alone are too small for training complex machine learning models. A potential solution is to increase sample size by pooling scans from several datasets. In this work, we combine 12,207 MRI scans from 15 studies and show that simple pooling is often ill-advised due to introducing various types of biases in the training data. First, we systematically define these biases. Second, we detect bias by experimentally showing that scans can be correctly assigned to their respective dataset with 73.3% accuracy. Finally, we propose to tell causal from confounding factors by quantifying the extent of confounding and causality in a single dataset using causal inference. We achieve this by finding the simplest graphical model in terms of Kolmogorov complexity. As Kolmogorov complexity is not directly computable, we employ the minimum description length to approximate it. We empirically show that our approach is able to estimate plausible causal relationships from real neuroimaging data."}, {"section_title": "Introduction", "text": "As neuroimaging is joining the ranks of a \"big data\" science with more and larger datasets becoming available [22] , the issue of dataset bias is becoming apparent. Usually, neuroimaging datasets are collected with a particular research question in mind, and inclusion criteria are tailored to answering this particular question. With the advancement of machine learning, in particular deep learning, researchers require large sample sizes for training their models. However, pooling data from studies that have been designed with different research questions in mind, will likely lead to bias in the learned model. For the same reason, an estimate of a statistic from one dataset, will likely differ from the estimate in another dataset. In general, bias refers to an estimate of a statistic that is systematically different from its population value. If estimates would be truly unbiased on a population level, models would naturally generalize to other datasets. However, in practice, neuroimaging datasets are subject to various types of biases, including subject selection, acquisition method, and processing biases [9, 13] .\nSelection bias stems from the fact that subjects included in the study do not represent the overall population. Examples are: (i) the recruitment of particular target groups, e.g., young adults; (ii) the recruitment of a particular disease arXiv:1907.04102v1 [cs. LG] 9 Jul 2019 group; or (iii) an over-representation of more educated participants in convenience samples. While the first two are potentially related to the study objective and can be controlled for, the third one is more difficult to control and also seems to appear in epidemiological studies [22] . A second bias stems from the image acquisition, where magnetic field strength, manufacturer, gradients, pulse sequences and head positioning cause variations in the images. While standardization efforts are undertaken for instance by the ADNI [11] , variations related to the scanner remain [13] , and it is even questionable if a further standardization is in the manufacturer's interest. In addition, there is processing bias in image segmentation and registration, which is in part related to acquisition bias, because of motion artifacts, voxel sizes, and image noise that can cause bias in segmentation results. Moreover, different segmentation algorithms and different choices for their hyper-parameters often lead to varying segmentation results. Finally, an association between an image-derived measure and an outcome is subject to confounding bias, if both variables are affected by a third latent random variable.\nIn this paper, we study bias in neuroimaging data. To this end, we combine data from 15 large-scale studies. We propose, (i) to predict the dataset that a subject is part of as a means to detect inter-dataset bias; (ii) to distinguish between causal and confounded statistical relationships; (iii) to quantify the extent of confounding and causality in a single dataset using causal inference. To this end, we use the algorithmic Markov condition to determine the simplest model in terms of Kolmogorov complexity to determine the true causal model.\nRelated Work: Correcting confounding factors in neuroimaging have to date been mainly studied within datasets [4, 15, 21] , but not across datasets. The focus of these studies has primarily been on age and sex as confounders. The harmonization of cortical thickness across datasets was studied in [7] . An instance reweighting approach for domain adaptation in Alzheimer's prediction was pro- posed in [25] . In contrast to prior work, note that our proposed approach aims to detect and quantify bias using causal inference, but not to remove bias."}, {"section_title": "Data", "text": "We work on MRI T1 brain scans from 15 large-scale public datasets: ABIDE I+II [3] , ADHD200 [19] , ADNI [11] , AIBL [5] , COBRE [18] , CORR [26] , GSP [2] , HBN [1] , HCP [24] , IXI 1 , MCIC [8] , NKI [20] , OASIS [16] , and PPMI [17] . All datasets were processed with FreeSurfer [6] version 5.3. We keep only one scan per subject from longitudinal or test-retest datasets. After exclusion of scans with processing errors and incomplete meta data, scans from 12,207 subjects (6,827 male; 8,126 controls; mean age: 33.5 \u00b1 23.9) remained. We present an overview of demographics per dataset in Table 1 ."}, {"section_title": "Name That Dataset", "text": "In order to evaluate the impact of dataset bias, we play the game Name That Dataset on neuroimaing data that was originally proposed by Torralba and Efros [23] on natural images. The task is to predict the dataset an MRI scan is coming from solely based on image-derived measures, where we use volume and thickness. We mainly focus on healthy controls to exclude disease-specific effects that would ease classification. Fig. 1 illustrates the performance for classifying the 15 datasets for different combinations of image features. A random forest classifier with default settings was used for the prediction. When splitting data into training and testing sets, we take the dataset membership into account to ensure each dataset is accordingly represented.\nIf dataset bias would be absent, we would expect a prediction accuracy close to random chance (6.7% for 15 datasets). As not all datasets have the same size and have different distributions of age and sex, we compare to results of a classifier trained on age and sex alone as baseline. With only 0.1% of the data used for training, volume measures perform similar to prediction with age and sex. As we increase the amount of training data to 70%, the accuracy increases to 73.3% for the combination of volume and thickness features, which perform better than each of them alone. The classifier with age and sex has 42.2% accuracy, which is well above random and therefore hints at selection bias. But compared to the 73.3% accuracy for image features, there must be another source of bias that cannot be explained by basic demographics, such as confounding bias. Fig. 1 also shows similar results after including diseased patients, denoted by '(w/ Disease)'.\nFrom the confusion matrix in Fig. 1 , we can see that datasets with a similar population result in higher confusion, e.g., between ABIDE I+II, and ADHD200. Single-site datasets, like HCP, that have strict inclusion criteria and imaging protocols show almost no confusion with any of the other datasets. In contrast, multi-site datasets like CORR that also cover a wide age range, show high confusion with other datasets. Overall, the high classification accuracy (diagonal elements) indicates that datasets possess unique, identifiable characteristics.\nThe lesson learned from this experiment is that even when working with image-derived values that represent physical measures (volume, thickness), substantial bias in datasets remains, despite techniques like atlas renormalization [10] were employed to improve consistency across scanners. Of course, much of the bias can be attributed to the different goals of the studies, like the inclusion of subjects from different age groups. However, even when focusing on datasets that cover a similar age range, we observe a high accuracy, e.g., ABIDE I and II. While we are not aware of previous attempts to Name That Dataset, our results echo concerns raised in previous studies. In an ENIGMA study with over 15,000 subjects on brain asymmetry [9] , it was reported that dataset heterogeneity explained over 10% of the total observed variance per structure. In ADNI, which has an optimized MPRAGE imaging protocol across all sites [11] , the intrasubject variability of compartment volumes for scans on different scanners was roughly 10 times higher than repeated scans on the same scanner [13] . Similarly, [25] reported a drop in accuracy when training and testing on different datasets."}, {"section_title": "Telling Causal from Confounded with Causal Inference", "text": "In the previous section, we have established that there is correlation between a feature vector y, derived from MRI scans, and the dataset D the scan belongs to, by estimating the probability P (D = d | Y = y) via a random forest classifier. While this has yielded useful insights, it is flawed: (i) it cannot be used with MRI scans from a single dataset only, and (ii) it only provides a measure of statistical dependence, which alone is insufficient to determine causal structures of confounding bias. Here, we want to study bias in a more principal manner by looking at confounding bias in a causal inference framework. Given one particular dataset, we want to quantify to what extent the correlation between biological factors X = {X 1 , . . . , X m } and a single image-derived measure Y j is due to X influencing Y j , i.e., an underlying neurobiological cause, and to what extent it is due to other common causes, i.e., confounders Z = {Z 1 , . . . , Z k }. In the purely causal setting, where there is no confounding, there is a causal relationship between biological variables X and image-derived measure Y j , which we denote as X \u2192 Y j . On the other end of the spectrum, the correlation between X and Y j is entirely due to other measured or unmeasured causes that have an effect on both the biological factors and image-derived measures. This would constitute a purely confounded relationship: X \u2190 Z \u2192 Y j . Fig. 2 illustrates the different scenarios, where the statistical dependency between X and Y j is due confounding (middle), a causal relationship (right), or a mixture of both (left)."}, {"section_title": "Causal Inference by Minimum Description Length", "text": "Inferring causal relations from observational data is challenging and is only attainable under specific model assumptions. We use an approach that incorporates the algorithmic Markov condition [12] , which states that the simplest factorization of the joint distribution P (X, Y ), in terms of Kolmogorov complexity, corresponds to the true generative process. As Kolmogorov complexity is not directly computable, we employ the minimum description length to approximate it. Here, we consider two factorizations of P (X, Y ) as depicted in Fig. 2: (i) the causal model P (X, Y ) = P (Y |X)P (X|Z)P (Z) is represented by a linear regression model, and (ii) the confounded model P (X, Y ) = P (Y |Z)P (X|Z)P (Z) by probabilistic PCA. Thus, the complexity under the causal model can be estimated by minimum description length L ca (X, Y j ) via:\nL ca (X, Y j ) = \u2212 log P (X) P (Y j |X, w)P (w)dw, \nHCP have been acquired on a single, dedicated scanner that was customized for this project. In contrast, COBRE, HBN, PPMI, MCIC, and AIBL have zero or negative mean difference. While we do not know the actual source of confounding, the result seems plausible, because these datasets comprise diverse scans from various sites and scanners (cf. table 1), which likely constitute sources of confounding. Consequently, we are unable to reliably attribute the relationship between age, sex, and volume to either model in these datasets. We also note that these datasets have among the lowest accuracy in the classification experiment in Fig. 1 . ABIDE I+II and ADHD200 pooled previously collected data from independent sites, yielding fairly heterogeneous datasets. Nevertheless, their estimated causal effect is weaker compared to ADNI, GSP, and IXI, which put more effort into standardizing imaging protocols. Harmonization across sites may strengthen the causal relationship in multi-site data. In Fig. 3 (right), we focus on individual differences \u2206 for each brain structure in the ADNI dataset, due to its prominent role in the community. Our estimate is most causal for lateral and inferior lateral ventricles, which is consistent with the characteristic expansion of ventricular spaces in older ages. We observed the strongest confounding bias for cerebellum cortex, suggesting the association between age, sex and cerebellum cortex is more likely due to confounders."}, {"section_title": "Conclusion", "text": "We defined various forms of bias common to neuroimaging data. Based on a dataset with more than 12,000 individuals, we have demonstrated that simply pooling scans from distinct studies can introduce substantial bias that would be passed on to a machine learning model trained on the pooled data. Next, we introduced a novel approach for differentiating causal from confounded relationships based on causal inference. We estimated the strength of the neurobiological causal model -age and sex influence a brain structure's volume -versus the confounded model -age, sex, and volume are influenced by latent confoundersfor 15 datasets and 22 brain structures. Results yielded large differences in the causal strength across datasets and brain structures. These results are specific to our assumptions for causal and confounding model, where other choices are possible and may yield different conclusions. Overall, we believe that the growing amount of neuroimaging data necessitates to quantify bias in datasets and image-derived features, for which we have proposed a causal model in this work. Finally, we note that our approach is not restricted to a biology-derived causal model, but could also be used to estimate the causal effect for other relationships, such as the effect of magnetic field strength on signal-to-noise ratio."}]
[{"section_title": "Table of contents", "text": ""}, {"section_title": "Introduction", "text": "The following report presents standard methods used at the Center for Coastal Geology for the rectification of satellite imagery and the enhancement and normalization of dn (digital number) values in all bands to permit inter-scene comparisons. Minimal pre-processing is necessary when conducting a one-time analysis of satellite imagery for land cover within a particular area. However, when a time-series of imagery is compared or when an area encompassed by many images is analyzed, accurate and compatible spatial and spectral data must be employed.\nThe report is divided into two chapters. Chapter 1 is written as a generic approach to image processing with explanations of how and why particular steps are conducted. Chapter 2 presents image pre-processing, step-by-step, as would be conducted with PCI, Inc. software on Landsat satellite imagery. The imagery utilized is entirely Landsat TM (Thematic Mapper) and MSS (Multi-spectral Scanner).\nThe first chapter includes basic image pre-processing steps in a generic format with equations for indices and calibrations. The theory and general approach may be applied to other imagery types and software. Although there will be specific references to the particulars of our own project and resources, these techniques may be creatively adapted to suit other research needs. Appendix A provides an outline of the pre-processing steps.\nThe second chapter covers image processing with PCI, Inc., as conducted on the Florida Big Bend coastal wetlands project. The chapter addresses software-specific parameters for each procedure, details on implementation, and includes a flow chart for PCI EASI procedures,. The procedures included will permit the subsequent pre-processing of imagery in a manner suitable for additional time-series analysis.\nSatellite imagery used in the detection of change along coastlines is processed in a standardized fashion to ensure temporal, spatial, and spectral compatibility between scenes. Imagery is initially selected to correlate as closely as possible with season and time-of-year coincident with high biomass and favorable atmospheric conditions as appropriate per region. Tide level at time of overpass in coastal areas can be critical in the evaluation of between-scene differences in the intertidal zone. However, due to cloud cover and image availability, tide level variations are accepted as an inherent limitation to inter-scene compatibility.\nImagery is registered to the UTM coordinate system using GPS-collected (Global Positioning System) ground control points, achieving inter-scene compatibility of < one pixel for Landsat TM. All images meet map accuracy standards of 1:25,000. Radiometric calibration and solar atmospheric correction are performed on all images to derive surface reflectance dn values in each band. The calculation of surface reflectance permits change analysis to be based on relative spectral changes or changes in vegetation biomass with less emphasis placed on land cover category variations. A vegetation index and wetness index is calculated for each image. The resulting preprocessed imagery is ready for inter-scene comparisons.\nThe procedures used here represent an implementation of techniques by Dobson et al. (1995) , a document which describes approaches recommended by the NOAA Coastal Change Analysis Program (C-CAP)."}, {"section_title": "Chapter 1", "text": "Image processing methods"}, {"section_title": "SCENE SELECTION", "text": ""}, {"section_title": "Season", "text": "Initial imagery selection includes determination of the appropriate dates and time frame for analysis. Leaf-off, or winter aerial photography, has traditionally been used in the determination of wetland habitats. However, satellite imagery does not have the same spectral and textural clues as aerial photography and must be employed in a different manner to identify land cover and change detection. Spring imagery is selected for the Gulf coast sub-tropical environment to maximize distinctions in vegetative health and quantity by providing maximum biomass during a period with a high probability of haze-free images. Biomass would not be adequately identified in winter imagery. The selection of imagery dates must be region and project-specific and should be advised by local ecologists familiar with the territory and the particular research issue.\nOur primary project area is in the Big Bend region of the Florida Gulf coast (Figure 1 ). Two scenes are required to cover the area, and two seasons are required to fully classify the land cover. Winter imagery is used to augment the spring imagery for the distinction and classification of deciduous vegetation. A total of four coordinated scenes were acquired for the base years in the analysis (Table 1) . Supplementary analysis in the time series requires contemporary spring scenes for each additional year."}, {"section_title": "Water Level", "text": "Tide levels can adversely affect the determination of intertidal environments. It is preferable to select scenes with similar low water levels to optimize the characterization of low elevation intertidal zones. Each additional decimeter of water contributes to the misidentification of 1-1.5% of the intertidal zone as documented by Jensen et al. (1993) , and Raabe and Stumpf (1997) . C-CAP recommends selecting tide levels within 0.3 -0.6 m of mean low water (MLW), which maximizes the utility of the imagery (Dobson et al., 1995) . The tide range in the study area is approximately 1 m from MLLW (Mean Lower Low Water) to MHHW (Mean Higher High Water). Although the majority of the intertidal environment along the Big Bend is high marsh, low water level at the time of satellite overpass enhances the discrimination of the low intertidal environment.\nDue to a combination of factors such as cloud cover and scene availability, the imagery secured for the Big Bend does not entirely fit the C-CAP standards, but is the best available for the analysis. Some variability in water level is acceptable if two scenes per year are employed in the analysis. In the Big Bend we found that a complementary scene near MLW in the same year can facilitate the correction of differences caused by water level (Table 1 ). The 1986 south imagery exhibits high water level in both winter and spring, and consequently poses the greatest difficulty in identifying low elevation intertidal habitats. Cloud cover is the most limiting parameter in scene selection. Listings may be misleading, and previews of imagery should be made whenever possible to ensure quality data before purchase. Although it is advisable to select entirely cloud-free imagery, in some cases it may be necessary to establish only that the critical study area is cloud-free."}, {"section_title": "Simultaneous coverage", "text": "When a study area is large and/or encompasses more than one scene, simultaneous coverage of the whole area is warranted. It is possible, under ideal conditions, to secure several images within days or at most within 3-4 weeks that cover the entire area. In the instance where a study area falls between two scenes in the same path, it is possible to order an image that straddles the image boundaries, eliminating the need to mosaic scenes together."}, {"section_title": "Specifications", "text": "The CD-ROM Format Imagery obtained from the EROS Data Center (EDC) and EOSAT is now provided in CD-ROM format. The procedures that follow begin with this format. Other formats may be accommodated with minor adjustments in the initial steps. All imagery for this project is obtained in Space Oblique Mercator (SOM) and with Nearest Neighbor resampling (NN). NN resampling is recommended for studies involving spectral analyses because it minimizes alterations to the count values. Other resampling such as cubic convolution may be preferred in studies involving pattern recognition."}, {"section_title": "SCENE PREPARATION", "text": "\nImagery is downloaded from the CD-ROM disk with CDNLAPS or CDEOSAT, depending on the format of the disk. Important information is included in the header file. Take time to learn to read the header file with the instructions accompanying your order. Look for format (NLAPS or EOSAT), band sequential or pixel interleaved (BSQ, BIL), number of pixels and lines, date and time of acquisition, resampling scheme (NN, CC, BL), and so on. Once downloaded to a .pix file, examine each band at full resolution for missing lines or blocks of missing data, heavy clouds, and the histogram of dn values. Each band should exhibit a normal range and distribution for the season and region covered. Now is the time to repair or return an image with serious problems. Table 3 shows the parameters set for CDNLAPS. Table 4 shows parameters set for LRP to fix line number 100 in band 2 with the mean from the line above and the line below. The EASI procedure, LRP, requires the operator to specify the missing line(s) +1 to correctly identify the lines to be replaced. If destriping is attempted, read about DSTR1PE in EASI help. "}, {"section_title": "Download raw imagery", "text": "The contents of the CDROM will include 7 bands of TM along with summary and header files. All 7 bands of data are extracted from the CD and converted to a readable format for image processing. The header file is also extracted at this point.\nThe PCI procedures, CDEOSAT and CDNLAPS, read data off the CD-ROM, create a new file on disk, write the band data, and extract header information which is written into an orbital segment attached to the new file. The orbital segment will be used in the rectification of the imagery to the UTM coordinate system. Other coordinate systems may be employed in a similar manner."}, {"section_title": "Check header file", "text": "The header file should accompany the scene and a readable copy of the header file is made to disk. A sample header file may be found in Appendix B. Information from the header file is used in subsequent processing steps. Trailer files may or may not accompany the imagery. Typically, the information desired from this file is the time of overpass in Greenwich Mean Time (GMT), which is noted for use in the radiometric enhancement."}, {"section_title": "Visual check", "text": "All new imagery is previewed, band-byband, to determine if data lines are missing or other anomalous features exist in the scene. The visual review must be done at full-resolution. Attention is focused on identifying lines or blocks of missing data in each band for subsequent \"repair.\" Haze or cloud cover that may render parts of the scene ineffective for analysis is noted as well. In our case the visual check is conducted in PCI Imageworks with seven image planes in the display window. Each portion of the image is displayed at fullresolution, and each band is viewed separately to identify missing data.\nIt is useful to examine the range and histogram of count values in each band at this time. Occasionally imagery is purchased with offset or anomalous count values. A quick evaluation now may save time later. Band 6, the thermal band, is especially prone to such errors."}, {"section_title": "Line replacement and destriping", "text": "Missing lines are \"repaired,\" and other problems are resolved in each band before the scene is rectified to the UTM coordinate system. Once rectification has been conducted, errors will no longer coincide with horizontal lines of data and are virtually impossible to fix. Image line replacement is a simple procedure that allows the operator to fill-in missing lines with the line above, below, or with an average of the two.\nIt also may be necessary to conduct destriping of the image if a linear pattern is prominent in the image. It is usually a more significant problem with Landsat MSS than with TM or SPOT, and affects dark objects such as water in particular. However, we have run several variations of a destriping procedure on scenes with an 8 to 9-line repetitive stripe and have concluded that the output image was not improved over the original. Although we do not conduct this procedure ourselves, it may be advisable in other situations, and, if necessary, must be attempted in this initial phase of preprocessing, before rectification."}, {"section_title": "ORTHORECTIFICATION OF IMAGERY", "text": "Rectification of the imagery requires several steps: identification of ground control within the imagery, collection of ground control points with a GPS unit, development of a rectification model, reprojection of the imagery using the model, and two accuracy checks.\nThree terms are defined:\n1. Rectification fixes each feature in the imagery to the correct position on the earth 2. Reprojection involves transforming and rectifying the image to a standard projection such as Universal Transverse Mercator (UTM) 3. Registration involves having features in multiple scenes exactly match each other in location Ideally, the rectification and reprojection will inherently produce coregistered images. We use rectification and reprojection procedures which result in sufficient accuracy to produce co-registered scenes. The reprojection is critical in that it produces images in a standard projection such as UTM or state plane.\nHowever, in some projects, a previously rectified scene might be used as reference so that all scenes are registered to the base scene. For instance, a set of Landsat MSS scenes might be registered to a NALC (North American Land Characterization) scene. If the above or other procedures are used where a polynomial transform \"rubber sheet\" adjustment is employed, it is usually preferable to co-register scenes, then conduct the reprojection and rectification on all of them. Co-registration without rectification is never recommended.\nThe orbital segment created in CDEOSAT or CDNLAPS contains information used in an adjustment between the estimated latitude/longitude of the raw imagery and the desired coordinate system. SMODEL creates a model from the orbital segment and a ground control point segment. The ground control segment is created in GCPWORKS."}, {"section_title": "Coordinate System", "text": "Rectification and reprojection of satellite imagery to a standard coordinate system is performed on all scenes in the project. Whether you use UTM or another coordinate system, the reprojection allows the determination of geographic coordinates for features identified in the analysis and facilitates integration with other geographic data sets. The approach used in the Big Bend project employs a PCI procedure, SORTHO, which reprojects the image based on satellite orbital information and a set of standard ground control points. The results effectively combine both inter-scene compatibility and coordinate plane rectification. To achieve coregistration without rubber sheeting, a common set of ground control points is used for all images. In this way the original data is rectified and reprojected from the Space Oblique Mercator (SOM) projection of the raw data to the Universal Transverse Mercator (UTM) coordinate system, with corresponding results in each subsequent image rectification."}, {"section_title": "Ground control in image", "text": "Ground control points are identified in the imagery as clearly visible point or right-angle positions, which are also accessible by road. Approximately twice as many points are identified as are ultimately required for the registration for several reasons. Some positions are not retrievable in the field, not all positions are identifiable in all imagery, and some positions are held out as part of the registration accuracy check. The operator examines a fullresolution image display to select the ground control. Preferred locations are corners at small to intermediate right-angle road intersections in rural or low-density developed areas. Highly developed areas tend to give blurred intersections and are difficult to re-locate in subsequent imagery. The identification of visible and distinct locations in the imagery which are also accessible to a field team is a major challenge in many regions. Alternatives to road intersections and right angles may be selected based on other landscape features. For example, the end of a bridge over a stream may be suitable. Consideration is given to the clarity of the location and the possibility of re-identification of the same point in earlier and later imagery. Good judgment and careful selection ensures accurate registration of the study area.\nThe set of selected positions are marked on the imagery file with a vector which can be displayed on a field laptop computer for identification during the field reconnaissance. If the technology is not available, a hardcopy is printed of each potential ground control point in the imagery, and these are bound with map sheets to aid in field identification."}, {"section_title": "Ground control in field", "text": "Accurate ground control points are collected for each image based on pre-identified locations as described in section 3.2. A handheld Global Positioning System (GPS) unit is employed with accuracy guaranteed 5-10 m. Positioning of < 10 m requires differential, Pcode, or comparable receivers for accurate rectification of Landsat TM or SPOT imagery. Standard non-differential units do not produce the necessary sub-pixel accuracy.\nField plans should include 5-10 minutes per station for data collection and site documentation to facilitate identification of the positions in subsequent imagery. We recommend a minimum of 2-3 readings per position, and 24-30 positions per image. The ground control should be well-distributed across the image and at locations which are visible in imagery over a period of 5-10 years. As some GPS readings turn out to be poor quality, we recommend collecting multiple readings at each location. Accurate and complete field notes accompanying the collection of GPS ground control facilitate the identification of the positions in subsequent imagery. A description including county, road, and intersection names, distance from nearby intersections, directional designators, and photographs are helpful in future relocation. We have also concluded that the occupation of an intersection corner, appropriately designated (as in \"southwest corner\"), is better than occupying the center of a road intersection as has been previously practiced.\nOther techniques exist for the collection of ground control points and may be applied where resources are limited. For instance, lowcost, non-differential, non-P-code GPS receivers can be used, providing positional accuracy of 30-100 m. Map accuracy in will be reduced from the 1:25,000 achieved in this project to 1:50,000 or more. Alternative approaches include digitization of positions from mylar 7.5 minute quadrangles, or the selection of similar positions from digital data sets including vectors, digital orthophotographs, and other imagery. Each approach carries with it inherent errors, of which the analyst should be aware. At the very least, the operator should know the error range for the input coordinates prior to the analysis. This will determine an acceptable RMS error range and whether or not the intended and final map accuracy will be achieved. The same caution applies to the selection of alternative adjustment techniques.\nThe PCI software in use for this project has a field version of GCPWORKS (under our investigation), which incorporates the selection of ground control in the imagery and the collection of GPS ground control simultaneously, on a field laptop computer. Although this does not eliminate the need to carefully select quality and well-distributed control within the image and in the field, it does consolidate the work, and allows the operator to evaluate the quality of the ground control as it is being collected. The onsite development of a rectification model eliminates costly returns to the field in the event some ground control proves useless.\nThe GPS unit employed in this project has a stated accuracy of <10 m, which met our mapping needs with TM and MSS. Higher resolution imagery such as SPOT and IRS may benefit from even higher accuracy ground control, available with newer GPS units at 1-5 m. Although 24-30 positions are collected per image, not every position is used in the actual rectification. In addition to the elimination of poor quality positions, other ground control points are not easily relocated in the imagery and are not used. Eight to ten positions are used to rectify the imagery, and another 10-12 are set aside to be used in the accuracy check."}, {"section_title": "Create model", "text": "A model is created with the ground control points. It is preferable to use a low-order polynomial transform to reduce distortion in the final image, particularly at scene edges or over large water bodies. The PCI procedure we use makes the conversion between the two systems without introducing distortion to the resulting image as is normally found in polynomial adjustments. We prefer this approach as it gives consistent spatial positioning across the image. Other registration packages are available and may be applied with varying results depending on the quality of the ground control and the amount of distortion introduced in the polynomial function."}, {"section_title": "User-entered coordinates", "text": "Imagery is brought to display on the monitor for the collection and identification of ground control points. These ground control points are part of the original set selected from the imagery at full-resolution display and subsequently collected in the field. They are spatially well-distributed over the extent of the image and show promise of being stable and easily identifiable in a time series. The GPS coordinates collected at these locations show little variation in repeat readings.\nDuring the identification of ground control, watch the RMS (root mean square) error for each ground control point and the total RMS error in both x and y. Examine the scatter plot of the ground control to help identify positions which are in error. Within reason, it is possible to adjust the location of the ground control in the imagery to achieve optimal positioning and distortion-free rectification.\nWe have found with 10m accuracy in the GPS and 30 m resolution in the imagery that the RMS of each individual position and the total RMS need not exceed 0.5 pixels (15 m). At the same time, consider that excessive adjustment of point positions to produce significantly lower RMS readings will introduce errors in the final adjustment. An RMS of 0.5 pixels indicates that the position is + 15 m or 1/2 pixel from the optimal location. Under the circumstances, it is reasonable to expect a total RMS of 0.3-0.6 pixels, or 10 -20 m, best fits the accuracy achievable with the given data. We have found that substantially forcing the model to lower errors introduces regional distortion into the final image."}, {"section_title": "Model", "text": "The collection of ground control points in the imagery leads to the development of a model to adjust the full image to the new coordinate system. See Chapter 2 for detailed steps in PCI. If not running GCPWORKS, and SMODEL, follow appropriate steps for software application."}, {"section_title": "Satellite image rectification", "text": "The goal of image rectification is to facilitate the overlay of additional imagery and other geographic data sets. A standard map area, with boundaries set in UTM, is established for each scene, thus all image files for the same region, once rectified, will occupy the same map area. The UTM bounds for the scene are established according to the file size, the 28.5 x 28.5 m pixels (57 x 57 m pixels for Landsat MSS), and the minimum/maximum northing and easting required to contain the full scene area. These boundaries, the UTM zone and the ellipsoid are established on each newly-created empty file.\nThe size and initial boundaries for the two scenes in the study (Figures 2 and 3) are shown in Table 2 In the event new regions are processed under these instructions, the designation of an output file size and geographic extent will depend on project needs, although it is recommended that full, or close to full scenes are pre-processed to maximize their subsequent utility. The calculation of file size is determined by the maximum and minimum eastings and northings of the raw image and the pixel size. Pixels in Landsat TM are 28.5 x 28.5 m, in MSS the pixel size is 57 x 57 m. Image rectification is conducted with the model segment created earlier, and the output applied to the newlycreated and georeferenced image file discussed in the preceding paragraph. Accuracy checks involve both geographic or map accuracy, and co-registration or inter-scene accuracy. It is important to recognize that multiple scenes may meet one criteria and not the other. Two scenes may be co-registered to within a pixel, but have significant geographic error. Conversely, scenes may meet a standard map accuracy in a selected coordinate system, but have systematic errors that result in poor coregistration between scenes. Mis-registration may result from poor models or the use of high order polynomials. Evaluation of both map accuracy and image co-registration is necessary subsequent to image reprojection."}, {"section_title": "UTM or coordinate system accuracy", "text": "Image rectification is not complete without accuracy checks. If check points were not entered and evaluated as in GCPWORKS and SMODEL above, it is necessary at this point to objectively locate 8-12 check points in the rectified image. The evaluation will give a measure of the map accuracy, the percentage of the image within the standard 'x' m. Obviously the evaluation varies according to the resolution of the imagery, the accuracy of the ground control, and the intended accuracy for the particular study. The measure obtained tells the user the expected positional accuracy of the majority of features in the image.\nThe check points are part of the larger set of ground control established with GPS as described in 1.3.2 and 1.3.3. Visually locate each ground control check point with the cursor in the rectified image. Note the image coordinates at the location, and evaluate how far the position is from the known x,y (UTM) coordinates. It may be difficult to conduct this step objectively. Try evaluating the portion of a pixel from which your visual position strays from the coordinates at which it visually should be. In our case, the goal was to accurately map 90% or more of the map features within 20 m of their known location, so we evaluate each position relative to our objective.\nThe accuracy check of the image to the UTM coordinate system meets our needs and is acceptable. Clearly, with only 12 check points, only one position per x/y component can exceed the established tolerance. It is worth conducting a careful check at this point to ensure good geographic correlation of data. If there is a geographic error in the image, it helps if you have indicated in which direction it shifted with a simple + after each x/y offset."}, {"section_title": "Inter-image accuracy", "text": "The second accuracy check is conducted on imagery which will be used in inter-scene comparisons. It has been a common practice to rectify only one image, and then register all other images to the base scene, or to co-register all scenes to a master and apply the rectification for that scene to all others. While the standard approach provides a solution to multiple-image registration, every image in the present study is rectified individually to UTM coordinate system. According to this approach, each subsequent image is rectified using the same set of ground control points, and is visually checked against the original, or first-rectified base image as follows.\nThe inter-scene accuracy check consists of selecting 3 to 4 areas within the image to be displayed, one by one, at full resolution with selected bands from each image. Two methods are used to check inter-scene registration: (1) a simultaneous display of the same band from both scenes, using color as a reference to examine horizontal and vertical linear features, (2) a flicker state between the two scenes with the cursor at a fixed, well-defined location. Both methods may be applied regardless of the software in use.\nIn the first method single bands, usually band 4 or 3, from each scene are displayed simultaneously in a red-green-blue (RGB) display. Offsets will be obvious in either the x or y direction as bands of color on either side of a vertical or horizontal roadway (Plate 1). The first evaluation gives a quick check on overall alignment of the two images.\nIn the second approach the bands from the base image are displayed simultaneously with the same bands from the new image in a multiple-image plane display and set to flicker state. Three to five right-angle road intersections which display true horizontal and vertical direction within the image are evaluated in each of the selected full-resolution windows. Each intersection is evaluated and recorded in a table (see Chapter 2.2.7).\nPlate 2 illustrates the position of the cursor at a right angle road intersection in the base image and evaluation of the cursor position relative to the intersection in the newly-rectified image. The cursor is placed at the center of the intersection in the base image, as if two imaginary lines were drawn N/S and E/W, taking into consideration the mixed pixel effect. The display is flickered to the newly-registered image, and the location of the intersection is compared in half pixel increments. Roads and intersections at non-right angles to the pixel/line orientation are never used in this evaluation. See Plate 3 for examples of intersections preferred for evaluation. The second method provides the operator with a detailed evaluation of inter-scene compatibility and the direction of offsets, if any.\nExpected inter-scene registration is + one pixel. A trend of greater than one pixel in x or y requires re-examination of the ground control point segment and a repeat of the whole rectification process. Consistent offsets or regional trends of greater than one pixel suggest poor quality registration and require rerectification of the imagery with a thorough evaluation of the ground control point coordinates, positioning, and land cover changes between the imagery dates.\nAgain, good judgment, and a second opinion may help to eliminate operator errors or unforeseen problems. All imagery in the current project must meet the + one pixel inter-scene accuracy before additional processing can be conducted. The goal is consistently met and presents no real problem with this particular set of imagery. We encourage other projects to develop similar methods to achieve high interscene positional registration."}, {"section_title": "RADIOMETRICAND ATMOSPHERIC CORRECTIONS", "text": "Several band enhancements and corrections are applied to the rectified imagery to normalize the dn (digital number) values, facilitating direct spectral comparisons between imagery bands and a comparable set of values as input to indices and clustering programs. Radiometric calibration, conversion to reflectance or solar correction, and atmospheric correction are conducted on every image. The adjustments rely heavily on data contained within the header file, including gain, bias, and solar zenith angle. Programs have been written in-house to facilitate the radiometric and atmospheric corrections. The aerosol adjustment still relies on a visual/manual assessment of dark water values, although it may also be automated eventually."}, {"section_title": "Radiometric correction", "text": "The digital counts in the image are transformed to reflectance using the calibration that comes with the files and the equations and constants of Price (1987) , and Markham and Barker (1985) "}, {"section_title": "L = G*N + BIAS o", "text": "EQ is the solar constant (Price, 1987; Markham and Barker, 1985) , r is the normalized earth-sun distance, 60 is the solar zenith angle at the image center, N is the digital count, G is the calibration slope, and BIAS is the calibration offset for zero radiance. A scale factor of 500 is applied to bands 1,2,3,4,5, and 7 to convert to 1 byte per pixel (0-255). A scale factor of 100 is applied to band 6. More sophisticated computations for reflectance exist. These involve additional terms in equation 1 for atmospheric transmission, and are being considered for implementation."}, {"section_title": "Atmospheric correction", "text": "The atmosphere introduces two forms of path radiance into the signal, radiance from Rayleigh or molecular scatter, and radiance from aerosols or haze. These can be removed simultaneously using dark object subtractions. However, improvements in atmospheric correction offers advantages in treating atmospheric and Rayleigh corrections separately. If no dark water exists in the scene, the Rayleigh correction is critical.\nRayleigh radiance is removed before the dark object subtraction. While not critical, when dark water is present, removal of the Rayleigh path radiance permits pixel by pixel correction of aerosols for water pixels and allows better control on the adjustment for aerosols. The Rayleigh term is determined using standard equations and coefficients. Models such as LOWTRAN (Air Force) can be used for the solution."}, {"section_title": "Aerosol correction", "text": "The aerosol correction is performed using subtraction from bands 1-4. Because the Big Bend region has black-water lakes and rivers, water can be found that has negligible reflectance in all bands. A dark-object subtraction is used, with the reflectance of the darkest water being the value subtracted. The correction is either constant or decreases slightly with wavelength (Chavez, 1989) . The dn value selected should be that corresponding to the lowest value that has a significant number of pixels. In bands 3 and 4 the dark water area should be the same region. Identifying dark water in the blue and green bands may be difficult. If a suitable area is not present, extrapolation from bands 3 and 4 may be necessary. The foregoing values represent pixels in the darkest water area of a scene. The 5 and 13 values are probably artifacts of the sensor (or boats). A value of 8 would be appropriate for dark water subtraction.\nNormalization of marsh for bands 3 and 4 is determined in the image overlap. By convention, we use values of zero to define missing data. A simple model is applied to all bands to restore zeroes to a value of one within the image bitmap. The non-image area surrounding the scene is eliminated from this and the index calculations by the application of an \"image-only\" mask, detailed in Chapter 2.3 and 2.4.1."}, {"section_title": "INDICES", "text": "Analysis includes the calculation of a vegetation index, wetness index, temperature, and water reflectance. Each index provides a means to compare a particular feature between different scenes.\nSeveral indices are calculated at the final point in processing. An additional band is added to the .pix file for each index desired. Be sure to specify the correct band number when calculating an index. The examples below are based on the radiometrically enhanced data residing in bands 1-7 It is possible to protect previously processed image channels from accidental overwrites with the LOCK procedure."}, {"section_title": "Vegetation Index", "text": "Subsequent analysis uses band ratioing as a surrogate measure of biomass. The vegetation index is a ratio of TM bands 3 and 4. The normalized difference vegetation index (NDVI) is a quantification of green biomass. It is not meaningful for water.\nThe vegetation index, NDVI may be calculated in the EASI procedure, RTR (Table  16) . Alternatively, a model can be written to take the input channels 3 and 4 and write output NDVI to channel 8. Differences in NDVI between two years may range from 90 to +90. These values are re-scaled to range from 1 -200. "}, {"section_title": "EQUATIONS. NDVI (NORMALIZED", "text": ""}, {"section_title": "DIFFERENCE VEGETATION INDEX)", "text": "when it is possible to observe the source and redistribution patterns of the relatively wanner waters of the Floridan aquifer. We convert radiance of TM band 6 to Celsius + 5 . Resulting values include freezing temperatures, which may occasionally occur in the region."}, {"section_title": "EQUATIONS. TEMPERATURE IN CELSIUS", "text": "Celsius + 5 = (1260.56/ln(60.776/(L(6)/100)+l)-268)"}, {"section_title": "Water Reflectance", "text": "Water reflectance is calculated as the difference of bands 2 and 4."}, {"section_title": "EQUATION 6. WATER REFLECTANCE", "text": ""}, {"section_title": "Water reflectance = R(2)-R (4)", "text": ""}, {"section_title": "NDVI = R(4)-R(3) R(4) + R(3)", "text": "where 4 and 3 are near-infrared and red bands, respectively, and R = reflectance after aerosol correction. A weight of 0.01 for the ratio denominator will scale NDVI by 100, such that an NDVI of 1.0 produces a count of 100."}, {"section_title": "Wetness Index", "text": "The wetness index is a measure of the wetness in the soil observable through the canopy and is particularly effective in distinguishing tidal influence in the coastal marsh zone and in areas with thin vegetation canopy. It is calculated based on the inversion of a procedure used to delineate open or standing water. We find that the gradient provided with the inverse, the \"wetness index\", shown here is effective in delineating the extent of tidal flooding in the coastal marshes. \nThe wetness index may be calculated with EASI procedure, ARI ( "}, {"section_title": "INTRODUCTION", "text": "Many of the image pre-processing steps are conducted within an image-processing software package. The Center for Coastal Geology group uses PCI, Inc. The following chapter includes specific instructions on running the procedures. It should serve as a guide to the basic steps required within this program.\nInitial scene selection and ordering is conducted outside of the image processing package. A flow chart (Plate 4) is provided to help the novice follow the different kinds of steps involved and the order in which they are conducted. The check list in Appendix A should become the basis for your own notes, including adjustments and new developments."}, {"section_title": "CDEOSAT CD EOSAT", "text": ""}, {"section_title": "GCPWORKS", "text": "Imagery for the Florida Wetlands is rectified with ground control collected with GPS units and is reprojected to the UTM coordinate system. Ground control selection is described in Chapter 1, and can be conducted in any image display program, including PCI's MAGEWORKS. Once the ground control has been identified and field collected, run GCPWORKS to enter the coordinates at their respective locations in the image. The satellite orthorectification option is selected to permit the use of the orbital segment in the model. Select \"Collect/review GCP's only\", \"Satellite Ortho Correction\", \"User Entered Coordinates\", and then \"Select Uncorrected Image\". Enter the path and filename of the nlaps.pix file. Load three bands, usually natural color (3,2,1) or false color (4,3,2,) are preferred for display. Set the units to meter, and the coordinate system to UTM, zone 17, row R and ellipsoid WGS84. Obviously, the zone and row will change depending on the region. Identify the location of 8 to 12 ground control points and enter the corresponding UTM coordinates collected with the GPS unit.\nDuring the identification of ground control within GCPWORKS, watch the RMS error for each ground control point and the total RMS in both x and y. Within reason, it is possible to adjust the location of the ground control in the imagery to achieve optimal positioning and distortion-free rectification.\nIn GCPWORKS it is possible to also enter accuracy check points at this time. If not working in this program, these check points are set aside for a post-rectification accuracy check. The 10-12 accuracy check points must be of equally high quality and well-distributed about the scene. Care is given to treat these positions and the associated error objectively, as they eventually provide a measure of the model's accuracy. These positions should be entered at the end, when the ground control points have been securely identified to avoid adjusting the model to fit the check points. When the operator is satisfied with the location of the ground control and the total RMS error, the ground control point segment is saved within GCPWORKS. Ideally, this will be segment #3."}, {"section_title": "GCPREP", "text": "A report documenting the ground control point segment as collected is obtained by running GCPREP. Run the procedure with ORDER set to 0. GCPREP produces a text file showing the list of ground control points, their pixel/line locations, the user-entered coordinates, and errors. The UTM coordinates of the ground control is exactly what was entered within GCPWORKS. This will change when the model is run in SMODEL. Remember, in GCPWORKS, the satellite orthorectification was selected. This forces the orbital segment to be referenced while developing the model. GCPREP does not refer to the orbital segment, and thus does not reflect it's influence on the ground control. The output from another procedure, GCPWRTT, may be useful in creating a vector segment. It requires a little editing and then running VREAD. The vector may be displayed in subsequent displays to help re-locate the ground control points for new imagery."}, {"section_title": "SMODEL", "text": "SMODEL draws on both the orbital segment and the ground control point segment to create the model, and must always be run on the whole scene. It is ineffective to run on a partial scene. If check points were entered along with the ground control, SMODEL will also produce a table showing the accuracy of the check points in meters. Run SMODEL as shown in Table 5 . Both the orbital segment, 2, and the ground control point segment, 3, must be specified in the procedure. SMODEL produces a model segment, normally 4, which will be applied in the image rectification, SORTHO. SMODEL also produces a report showing the accuracy of the check points in meters. Examine the report for values outside of the range of expected and desired accuracy (see Appendix C). Excessive values below the original 10 m accuracy of the GPS positions may introduce distortion to the final image rectification. Values greater than 20 m, or 2/3 pixel, suggest the overall registration may not meet inter-scene registration requirements. Note also that the UTM coordinates shift by the RMS error. Table 5 . SMODEL procedure parameters Values for positional accuracy in this project are acceptable between 8-20 m. The rectification of a TM scene will technically meet 1:25,000 map accuracy standards, provided that 90% or more of the individual accuracy check points are within 20 m or less of their desired location. With 12 check points, only one can be > 20 m from its true location. Although we achieve the reported level of map accuracy, TM imagery will always be printed at scales of 1:50,000 or smaller to avoid the blocky appearance of the pixels. "}, {"section_title": "CIM2 -New file creation", "text": "New imagery files are created in CIM2, a file format which creates a separate file for each band, all associated by the header or .pix file (Table 6 ). The size of a fully-processed full size Landsat TM scene makes this option appealing for ease of movement and disk-space issues. The example shows the standard size of the north Big Bend image, path 18, row 39. The size includes the removal of ~1100 lines in the state of Georgia and the enlargement of the file to reproject the region into the UTM coordinate system (see Figure 3 ). All north scenes will be created in the same manner. If working in another region, establish a standard file size based on the full extent of the UTM eastings and northings and the pixel size. The geographic boundaries, the UTM zone, and the ellipsoid are set in the georeferencing segment of the newly created CEM2 file with GEOSET. An example for the north Big Bend is shown in Table 7 . The coordinates given are applied to each corresponding image, making overlays and inter-scene analysis a simple task. "}, {"section_title": "SORTHO -satellite image orthorectification", "text": "Orthorectification of imagery is conducted in PCI with the SORTHO procedure which applies the model segment to the nlaps image file and reprojects the seven bands of data into the empty bands of the newly created and georeferenced .pix file. See Table 8 for SORTHO parameters.\nDue to the minimal topographic variation along the Big Bend coast of Florida, we do not employ a DEM file. Instead, we estimate an average value for elevation as the width of one pixel with no offset (ESCALE). Elevations do not exceed -60 m in the area, and this appears to be sufficient for positional accuracy and inter-scene registration. The need for elevation must be determined on a region-byregion basis.. The SORTHO procedure may take up to 6 hours on a SUN SPARC 20 and is usually run overnight. The inter-scene registration accuracy check is conducted manually within an image display program. Run IMAGEWORKS with a full-resolution window -600 x 800 with 6 image planes. Display 3-5 well-distributed regions in the window, each time loading the newly registered image (4,3,2) and the base image (4,3,2) with the same input window.\nFor instance, in image planes 1,2,3 load the new image (4,3,2) with an input window of 300, 300 (x,y offsets), 600, 800 (x,y window size). Then load the base image to image planes 4,5,6 (4,3,2) using the same full-resolution window. Examine the images first with a single band from each of the images in a RGB display mode. An example may be viewed in Plate 3. Look for truly horizontal or vertical roads and evaluate obvious offsets. A poorly registered image as shown to the left in Plate 3 is not worth evaluating further. Note the direction of the offsets, check other regions to confirm the offsets, and return to GCPWORKS to redo the ground control point segment.\nIf horizontal and vertical roads align well in the first input window, switch to a flicker state with each image displayed 4,3,2 as RGB. Complete a table as follows, with 12-20 road intersections across the scene. The table will highlight regional or full-scene offsets. In this table each region and the scene as a whole meet the requirements of + one pixel inter-scene alignment. The newly registered file is acceptable, and image processing can proceed. If, however, a region or the whole scene exceeds one pixel offset in either direction, then GCPWORKS, SMODEL and SORTHO must be repeated. Run CLR to reset the new file channel values to 0 before running SORTHO again. The table may be used to help guide the adjustment of the ground control points. "}, {"section_title": "RADIOMETRIC AND ATMOSPHERIC CORRECTION", "text": "The following sections illustrate the EASI procedures used for radiometric calibration and atmospheric correction. Information from the header file is employed in the procedures. A bitmap is created first to mask the non-image pixels of the *ort.pix file. Typically the mask can be obtained by selecting all pixels in band 1 or Table 9 . Bitmap creation with THR band 2 with values greater than zero. The mask is subsequently used for the creation of indices and other analysis. Limiting the processing to the image area of the file shortens processing time and eliminates the formation of anomalous features outside of the image area. The EASI thresholding procedure, THR may be use for creating the bitmap (Table 9) . If necessary a similar mask may be created for the non-image area by setting the COMP parameter to \"ON\". The complement is used to fix anomalous data sometimes found in band 6. Seven additional empty channels are added using PCIADD2. These are the output channels for the radiometrically enhanced bands, 8-14. TMRAD is an in-house EASI procedure which solves equations 1 and 2 in section 1.4.1. Sample parameters are set in Table 10 . Latitude and longitude are given in decimal degrees, and Table 10 . EASI procedure TMRAD longitude is a negative value in the western hemisphere. TMSLOPE and TMBIAS may be obtained from the newer header files as Gain/10 and Bias/10, respectively. The solar constants (from Markham and Barker, 1986) , and scale factors will change for different imagery and satellites. TEXT may be set to \"stat\" for a check on the output values (Table 11) , which is also saved to a text file for reference. "}, {"section_title": "RAYRAD -Rayleigh radiance", "text": "The Rayleigh correction factor is calculated with RAYRAD. Calculations may be found in Stumpf (1992) . The procedure requires operator input as in Table 12 , and produces output as in Table 13 . The scale factor should be the same as that used in TMRAD.\nBands 1 -4 are corrected by subtracting the Rayleigh values from each band respectively.\nThe Rayleigh values are the last column in Table  13 , rounded to the nearest whole number. Values for bands 5 and 7 are insignificant, and for band 6, irrelevant. The model used to accomplish the subtraction is shown in Table 14 . The bitmap is specified with \"%%2\" and band 8 as \"%8\". Keep in mind that the radiometrically enhanced bands, 8 -14, are equivalent to TM bands 1 -7. Table 14 . Ravleieh subtraction model doc ************************************************************* doc Correction of the radiance values gathered from using the doc rayrad program. This program will allow corrections of the doc digital numbers for bands 1 through 7 \u00a3jQ\u00a3 ************************************************************* doc_end monitor = \"ON\" report = \"TERM\" Final atmospheric correction values are selected manually from a full-resolution display of bands 1-4, focused on areas of dark water. This step must be conducted, visually, AFTER the Rayleigh correction has been subtracted from the bands. The dark object subtraction itself may be conducted with EASI procedure, ARI, or with a model similar to the one in Table 14 . The values shown in Table 15 are in the normal range for the region of the Big Bend coast. All channel descriptors (image layer histories) are renamed using MCD to more accurately describe the contents of the channel based on the preprocessing applied."}, {"section_title": "Bitmap creation", "text": "A mask is employed to permit processing and modeling of image-only pixels. If not already done, the mask is created by selecting all pixels with a value of > 0 in TM band 1 or 2. The new bitmap segment is on at every image pixel and off at all non-image pixels. It is important that the operator check the band at full-resolution to ensure there are no zero values in the image area itself before running this procedure. The results can be checked afterwards on full-resolution display. Failure to check may result in missing data in the index channels. The mask is created by running THR as in Table 9 . The mask allows the operator to run processes on image data only, maintaining values of zero in non-image areas of the file."}, {"section_title": "Water reflectance", "text": "Water reflectance can be calculated with EASI procedure, ARI, (Table 18) "}, {"section_title": "Brightness", "text": "Brightness is merely TM band 2 with the appropriate adjustments for radiometric enhancement and atmospheric corrections. This is sufficient for comparison of brightness between scenes. The road intersection in the older image is satisfactory. The cursor offset is less than one pixel. The road to the right appears to have been narrower in 1985 which accounts for the 1/2 line offset in the y-axis. The x-axis is well-aligned with less than 1/2 pixel offset. Note: we do not consider the smaller road to the left in this evaluation. It lacks clarity and does not approach the intersection at a right angle. Plate 2. Comparison of right angle road intersection for inter-scene registration."}]
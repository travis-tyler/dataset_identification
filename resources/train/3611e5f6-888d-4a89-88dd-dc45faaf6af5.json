[{"section_title": "Abstract", "text": "In this paper, we propose a heat kernel based regional shape descriptor that may be capable of better exploiting volumetric morphological information than other available methods, thereby improving statistical power on brain magnetic resonance imaging (MRI) analysis. The mechanism of our analysis is driven by the graph spectrum and the heat kernel theory, to capture the volumetric geometry information in the constructed tetrahedral meshes. In order to capture profound brain grey matter shape changes, we first use the volumetric Laplace-Beltrami operator to determine the point pair correspondence between white-grey matter and CSF-grey matter boundary surfaces by computing the streamlines in a tetrahedral mesh. Secondly, we propose multi-scale grey matter morphology signatures to describe the transition probability by random walk between the point pairs, which reflects the inherent geometric characteristics. Thirdly, a point distribution model is applied to reduce the dimensionality of the grey matter morphology signatures and generate the internal structure features. With the sparse linear discriminant analysis, we select a concise morphology feature set with improved classification accuracies. In our experiments, the proposed work outperformed the cortical thickness features computed by FreeSurfer software in the classification of Alzheimer's disease and its prodromal stage, i.e., mild cognitive impairment, on publicly available data from the Alzheimer's Disease Neuroimaging Initiative. The multi-scale and physics based volumetric structure feature may bring stronger statistical power than some traditional methods for MRI-based grey matter morphology analysis."}, {"section_title": "Introduction", "text": "A multitude of morphometric studies using magnetic resonance imaging (MRI) have examined the brain structural marker changes associated with Alzheimer's disease (AD), including cortical atrophy, hippocampal atrophy or ventricular enlargement, which may serve as indicative signs of early diagnosis of AD. Despite evidence that medial temporal atrophy is associated with AD progression, the evaluation of medial temporal atrophy is still not sufficiently accurate on its own to serve as a definitive diagnostic specification for the clinical diagnosis of AD at the mild cognitive impairment (MCI) stage (Frisoni et al., 2010) . Missing at this time is some structural features which are able to capture subtle grey matter morphometry differences between different clinical groups and thus have a high discriminant power. For instance, the thickness of cortex is an important feature which has been applied to detect localized anatomical differences (MacDonald et al., 2000; Fischl and Dale, 2000; Jones et al., 2000; Miller et al., 2000; Kabani et al., 2001; Sowell et al., 2004; Chung et al., 2005; Kochunov et al., 2012) . At present, there are two different computational paradigms on cerebral cortical thickness estimation, with methods generally classified as either surface or voxel based (Clarkson et al., 2011; Jones et al., 2000; Fischl and Dale, 2000) . Besides, there is another line of research that has been focused on grey matter density (GMD) (e.g. Wright et al., 1995; Ashburner and Friston, 2000; Thompson et al., 2003; Sowell et al., 1999) . Basically, GMD can be defined as the proportion of voxels classified as grey matter falling within a sphere centered at some points on registered cortical surfaces . Prior research (e.g. Narr et al., 2004) has shown that GMD is highly correlated with cortical thickness measures. However, the main disadvantages of current cortical thickness estimation methods are either computation complexity on constantly correcting the weights of various evolutionary parameters or inaccuracy on the discrete grid. In addition, all measured distances are unitary distances between boundary surface points and they indicate only global trends and cannot measure topological variations (e.g., the local topological characteristics along the streamlines are not studied).\nIn this paper, we propose a diffusion geometry method to obtain multi-scale intrinsic grey matter morphology signatures (GMMS). This class of methods offers the advantages of inelastic deformation invariance and robustness to topological noise. Mathematically, diffusion kernels (Coifman et al., 2005) express the transition probability by random walk of time t, t \u2265 0. It allows for defining a scale space of kernels with the scale parameter t. Such heat kernel-based spectral analysis induces a robust and multi-scale metric to compare different shapes and has strong theoretical guarantees. It has achieved great success in machine learning, computer vision and medical imaging research (Coifman et al., 2005; Reuter et al., 2006; Nain et al., 2007; Yu et al., 2007; Sun et al., 2009; Lombaert et al., 2013) . Some prior work (Rustamov, 2011 ) studied volumetric heat kernel but their work mainly relied on regular grid mesh, thus suffering from the limited grid resolution which cannot precisely characterize the curved cortical surfaces from MR images. In contrast, we model the grey matter structure by tetrahedral meshes. Based on the volumetric LaplaceBeltrami operator Wachinger et al., 2015; , we introduce multi-scale heat kernel shape descriptors to depict the heat-transfer probability by random walk between some pre-determined boundary point pairs and obtain sub-voxel numerical accuracy. The defined shape features rely upon a solid theoretical background and are robust to noise. Our work may provide accurate quantitative measures of grey matter morphology changes which are important for a variety of neuroimaging studies.\nIn our work, a new set of morphological descriptors are introduced to describe the grey matter morphology changes. They depend on heat transmission time and are also influenced by the topological properties on the heat transmission paths. Following that, a point distribution model (PDM) is applied to reduce the feature dimensionality. To further reduce feature dimension and improve classification accuracy, we adopt a sparse learning (Hastie et al., 2015) approach, sparse linear discriminant analysis (Sparse LDA) (Clemmensen et al., 2011) , which is built upon a solid theoretical foundation and has demonstrated its strong practical values in imaging research. Combining heat kernel shape features with sparse LDA, we hypothesize that our framework may provide robust, informative and biologically meaningful grey matter morphology measures, and therefore, we may make an important advancement towards a holistic cortical thickness descriptor. We tested our hypothesis on the Alzheimer' s Disease Neuroimaging Initiative (ADNI) dataset. We studied the classification of AD and its prodromal stage, i.e. mild cognitive impairment (MCI), comparing our new method to cortical thickness feature estimated by FreeSurfer software (Fischl et al., 1999a) ."}, {"section_title": "Methods", "text": ""}, {"section_title": "Definitions", "text": ""}, {"section_title": "Heat operator and heat kernel", "text": "The heat kernel diffusion on differentiable manifold M with Riemannian metric is governed by the following heat equation:\nwhere f x t ( , ) is the heat distribution of the volume at the given time. Assuming an initial heat distribution F M : \u2192 , let H t (F) denotes the heat distribution at time t, and H F F lim ( ) = \nwhere dy is the volume form at y M \u2208 . The minimum function l x y ( , ) t that satisfies Eq. (2) is called the heat kernel (Coifman et al., 2005) . It can be explained as the amount of heat that is transferred from x to y in time t given a unit heat source at x. In other words, l x H \u03b4 ( , \u00b7) = ( ) . According to the theory of the spectral analysis, for compact M, the heat kernel has the following eigen-decomposition heat diffusion distance:\nwhere \u03bb i and \u03d5 i are the i th eigenvalues and eigenvectors of the LaplaceBeltrami operator, respectively. The heat kernel l x y ( , ) t can be interpreted as the transition density function of the Brownian motion on the manifold (Sun et al., 2009 )."}, {"section_title": "Laplace-beltrami operator", "text": "Let f be a real-valued function, with f C \u2208 2 , defined on a Riemannian manifold M (differentiable manifold with Riemannian metric). The Laplace-Beltrami Operator \u0394 is:\nwith grad f the gradient of f and div the divergence on the manifold. The Laplace-Beltrami operator is a linear differential operator. It can be calculated in local coordinates. In the non-Euclidean case for a Riemannian metric, the Laplacian eigenvalue problem is given by\nSince the Laplace-Beltrami operator is self-adjoint and semi-positive definite (Rosenberg, 1997) , it admits an orthonormal eigensystem . Detailed treatments on harmonic map, heat kernel and the Laplace-Beltrami operators can be found in (Schoen and Yau, 1997; Rosenberg, 1997) . There are also intensive studies on discrete harmonic map and Laplace-Beltrami operator (e.g. Pinkall and Polthier, 1993; Wang et al., 2004a; Coifman et al., 2005; Levy, 2006; Reuter et al., 2006) ."}, {"section_title": "Discrete volumetric laplace-beltrami operator", "text": "The solution to Eq. (5) on volume can be approximated by a piecewise linear function f : \u2192 over a Tetrahedralization with vertices P p u n : , = 1,\u2026, u , n is the vertex number in a tetrahedron. In this work, we propose to refine our prior discrete Laplace-Beltrami operator definition by using a normalization factor, which takes into account the volume of all tetrahedra at each vertex. The lumped discrete Laplace-Beltrami operators can be represented as:\nwhere N(u) represents the index set of the 1-ring of the vertices p u , i.e., the indices of all neighbors connected to p u by an edge. The normalization factor, which takes into account the total tetrahedral volume a(u) of all tetrahedra at vertex u, is defined as\nof the function values at the vertices, the weighted adjacency matrix\n(our definition of k u v , will be discussed in Section 2.2.3) and the diagonal matrix W diag w w = ( ,\u2026, )\nThen the stiffness matrix can be defined as\nThe volume matrix\n, and finally the lumped discrete volumetric Laplace-Beltrami operator in matrix form is defined as\nUsing these matrices, f p \u0394 ( ) u is the u-th component of the vector Lf. Eq. (5) can be written as the generalized symmetric problem Af \u03bbDf = . We provide numerical validation of the proposed volumetric LaplaceBeltrami operator in Appendix."}, {"section_title": "Multi-scale grey matter morphology signature", "text": "Using the defined discrete volumetric Laplace-Beltrami operator (Eq. (8)), we can compute its eigenvectors (\u03d5 i ) and eigenvalues (\u03bb i ). In order to examine the geometrical topological information in the cortical volume, we choose point pair (x,y) of the heat diffusion distance l x y ( , ) t as two points on the outer and inner boundaries of grey matter, respectively. At the same time, we use the streamline in the steady temperature field as the connection constraint for the selection of x y ( , ) pair. Specifically, we apply our prior work to compute boundary point pairs, x and y, by tracing the maximum energy transfer probability. With the computed boundary point pair, x and y, we could estimate the heat diffusion distance l x y ( , ) t by evaluating Eq. (3) by varying time t. We define it as the grey matter morphology signatures (GMMS). Suppose there are S surface point pairs and T time points, the GMMS can be represented by an S T \u00d7 matrix,\nwhere h l x y = ( , ) xt t , i.e., the heat kernel function value between a surface pair x and y, evaluated at time t. Although the h xt definition does not explicitly involve y, y is not a free parameter. y is uniquely determined by our prior work when pursuing the point pairs on both outer and inner surfaces of grey matter. The details on how to compute x-y pair will be discussed in Section 2.2.3.\nWith the properties of the eigenvalues and eigenvectors, the obtained GMMS is isometry invariant, multi-scale and robust to intensity variations between MRI scans. Compared with other rasterization-based Laplace-Beltrami operator computation methods (Rustamov, 2011) , since the tetrahedral mesh modeling reaches subvoxel accuracy, the GMMS may capture and quantify subtle local grey matter geometric structure more accurately and provide more statistical power for brain grey matter morphology analysis. Fig. 1 shows the pipeline of our grey matter morphology analysis system. First, from MR images, we use FreeSurfer (Fischl et al., 1999a) to segment and reconstruct white matter and pial cortical surfaces (the first row). We model the inner volume with a tetrahedral mesh with these two surfaces as its boundaries (the second row). After we register cortical surface with weighted spherical harmonics (Chung et al., 2007a) , we establish correspondence between two boundary surfaces by streamlines which trace the maximal heat transition probability . After that, we compute GMMS by evaluating Eq. (9) (the third row). We further apply point distribution model and sparse linear discriminant analysis to achieve feature reduction and 2-and 3-label classification (the fourth row). We explain some major steps in the following sections."}, {"section_title": "Algorithms", "text": ""}, {"section_title": "Tetrahedral mesh construction", "text": "Given a brain structural MR image, we first employ FreeSurfer (Fischl et al., 1999a) to segment brain grey matter, white matter and CSF (Cerebrospinal fluid) and reconstruct brain white matter-grey matter boundary surface (white matter surface) and grey matter and CSF boundary surface (pial surface). Given these two surfaces, we apply the tetrahedral mesh generation protocol developed in our prior work to generate tetrahedral meshes between these two surfaces. Specifically, first we fill the MRI space with the cubic background voxels with binvox (Min, 2013; Nooruddin and Turk, 2003) . Further we apply CGAL (CGAL Editorial Board, 2013) to generate tetrahedra from these voxels. The tetrahedral mesh quality and smoothness are further improved by harmonic function minimization (CGAL Editorial Board, 2013; Lederman et al., 2011) . In , we discussed in details the parameter settings that help generate high quality tetrahedral meshes."}, {"section_title": "Surface correspondence via weighted spherical harmonics", "text": "Although we used cortical surfaces constructed by FreeSurfer to create grey matter tetrahedral meshes, the locations and number of the vertices on the boundary surfaces are changed when we build the tetrahedral meshes. As a result, we lose the surface correspondence computed by FreeSurfer software so we need compute new surface correspondences between the boundary surfaces of tetrahedral meshes. To establish measurements at analogous locations for statistical analysis, the eigenvectors \u03d5 ( ) i need to be resampled at the vertices of the template surface. It is not a trivial task due to the fact that no two boundary surfaces are identically shaped. Hence, 2D surface registration is needed in order to compare the GMMS measurements across different objects. Various brain surface registration methods have been proposed (e.g. Davatzikos, 1997; Fischl et al., 1999b; Lombaert et al., 2013; Shi et al., 2016) . These methods usually solve sophisticated optimization problems of minimizing some discrepancy measures between two brain surfaces. In this paper, we adopt the weighted spherical harmonic representation (Chung et al., 2007a) together with spherical conformal mapping as a simple way to establish surface correspondence between two surfaces without the time-consuming numerical optimization. In our work, after we compute the spherical conformal mapping ) of a cortical surface, the weighted spherical harmonic coefficients can be estimated and surface correspondence between the different subjects can be established by the weighted spherical harmonic representation. Subsequently, the \u03d5 ( ) i measurements in the different subject surfaces can be interpolated into a unified template by using the weighted spherical harmonic representation. Moreover, the weighted spherical harmonic representation may overcome the Gibbs phenomenon (Gelb, 1997) , which is a weakness of the traditional spherical harmonic representation."}, {"section_title": "GMMS computation", "text": "We adopt the weighted adjacency parameter\n, , which was proposed in our prior work (Wang et al., 2004a) to compute volumetric harmonic maps with the Dirichlet boundary condition. It was widely used in volumetric harmonic map research (e.g. Wang et al., 2004b; Chern et al., 2015; Li et al., 2007; Tan et al., 2010; Pai et al., 2011; Li et al., 2010; Paill\u00e9 and Poulin, 2012; Wang et al., 2012; Xu et al., 2013; Li et al., 2013; Aigerman and Lipman, 2013; Shi et al., 2015) . As shown in Fig. 2 Fig. 2 . By convention, we say that this edge is against u v { , } in this tetrahedron. Thus edge u v { , } is against a total of n edges in these n tetrahedrons. We denote their edge lengths as l i , i n = 1,\u2026, . Similarly, there is a dihedral angle which is associated with each edge, e.g. \u03b8 23 is associated with edge v v [ , ] 2 3 in Fig. 2 . They can be denoted as \u03b8 i , i n = 1,\u2026, . The dihedral angle \u03b8 is also said to be against edge u v [ , ] . So edge u v { , } is against a total of n dihedral angles, \u03b8 i , i n = 1,\u2026, , in these n tetrahedrons. Define the parameters\nwhere l i , i n = 1,\u2026, , are the lengths of the edges to which edge u v { , } is against in the domain manifold M.\nOn grey matter structure represented by a tetrahedral mesh, we can estimate the boundary point pairs (x and y in Eq. (3)) based on the heat propagation direction . Specifically, we first G. Wang, Y. Wang NeuroImage 147 (2017) 360-380 compute the harmonic field on the tetrahedral mesh. Inside the tetrahedral mesh, the isopotential surfaces are computed by the volumetric Laplace-Beltrami operator and streamlines are computed to connect two boundary surfaces. Different from some prior research where the streamline traveling direction is defined to be orthogonal to the isothermal surfaces (Jones et al., 2000) , our streamline direction is obtained by tracing the maximum energy transfer probability based on the heat kernel diffusion . Following that, GMMS are computed by evaluating Eqs. (3) and (9) between the pair of ending points of each streamline."}, {"section_title": "Point distribution model", "text": "In order to reveal the internal structure features in a way that best explains the variance of the GMMS, we apply a point distribution model (PDM) (Cootes et al., 1995; Shen et al., 2004) to extract the most informative features. First, we convert matrix GMMS S T \u00d7 of subject i to a vector G i , by the transpose of all concatenated rows. For example, the matrix in Eq. (9) may become\nGiven a group of N subjects, we can build a S T N ( \u00d7 ) \u00d7 matrix G,\nWe then apply the eigen analysis of the covariance matrix \u03a3 of the GMMS as follows:\nwhere G i is the converted vector of the i th subject's GMMS and G is the mean GMMS of N subjects. The columns of Q hold eigenvectors, and the diagonal matrix D holds eigenvalues of \u03a3. The eigenvectors in Q can be ordered according to respective eigenvalues, which are proportional to the variance explained by each eigenvector. The first few, say P, eigenvectors (with greatest eigenvalues), Q , often explain most of variance in the GMMS data. Now any G i can be approximated using\nwhere v i is the internal structure feature (ISF) which is a vector containing the coefficients associated with each eigenvector in Q . It is a convenient way to encode the individual GMMS with a subset of basis principle components obtained from the population. \nand y=Va, then Fisher's LDA solves n y y y y\nwhere y i is the mean of the i th subvector of y. Substituting y by Va, the within-class sum of squares can be rewritten as\nand the between-class sum of squares as\nTherefore the ratio is given by a aa a\n. If a 1 is the vector that maximizes the ratio, one can find the next direction a 2 in \u2211 w orthogonal to a 1 , such that the ratio is maximized; and the additional directions can be computed sequentially.\nTo eliminate noises in the regular LDA model, the sparse LDA (SLDA) (Hastie et al., 1995a; Clemmensen et al., 2011) was developed based on a recasting of the problem in terms of a multivariate linear regression, where the codes for the output classes are chosen \"optimally\". Basically, the score vector \u03b8 j assigns a real number \u03b8 ij for each\nis 1 if observation i belongs to class k and 0 otherwise. The scored training data Y\u03b8 is an N K \u00d7 ( \u2212 1) matrix on which we will regress the matrix of features v ij to obtain the parameters or directions a P K \u00d7( \u22121) . This leads to P components of sparse discriminative direction. The sparse optimal scoring (SOS) is defined as \nwhere \u03a9 is a penalization term defined by a positive semidefinite matrix (Hastie et al., 1995a) , equivalent to the elastic net penalty in the special case \u03a9 \u03b3I = . The \u2113 1 -norm term introduces sparseness as in lasso or elastic net regularization. And \u03b4 and \u03bb denote control parameters of the regularization terms, respectively. Their values can be determined via cross validation on the training data. For fixed \u03b8, we obtain\nFor fixed a, the optimal scores are \nWe initialize \u0398 to be the size of K K \u00d7 identity matrix and take the first K \u2212 1 column as \u03b8 (Sj\u00f6strand et al., 2012) . We solve a j sos and \u03b8 sos alternatively until convergence. After having obtained a P K sos \u00d7( \u22121) which has only a few nonzero components, we can project the features into the subspace with the informative features and reduced dimension. Classification of a new observation v is performed by graphical projection a v T and finding the closest centroid (Tibshirani et al., 2002) in the derived space defined by a sos , which is the GMMS subspace with a reduced dimension. "}, {"section_title": "Results", "text": ""}, {"section_title": "Synthetic data results", "text": ""}, {"section_title": "Synthetic data and GMMS computation", "text": "We conduct validation and classification experiments on a synthetic data set. To simulate the grey matter structure, we generate volumetric shells with two surfaces, outer and inner surfaces. Each volume is represented by a tetrahedral mesh constructed with our tetrahedral mesh generation module . For classification purpose, we make outer surfaces a relatively uniform cylinder shape while introduce more morphometry differences to inner surfaces. The goal is to classify these volumes by GMMS and SLDA models. Fig. 3 shows two classes of synthetic volumetric structures including 12 structures for each class. Class 1 has 12 cylinders each of which has an inner sphere cavity with different radiuses and class 2 has 12 cylinders each of which has a unique inner bump-sphere cavity. Two enlarged images are shown on the first row.\nFirst, we compute the eigenvectors \u03d5 ( ) i and eigenvalues \u03bb ( ) i of the volumetric Laplace-Beltrami operator matrix (as described in Section 2.1.3). We apply the weighted SPHARM method to register inner surfaces across subjects (as described in Section 2.2.2). We further compute streamlines to build surface point pairs between the registered inner spherical surface and the outer cylinder surface. Finally, the GMMS features are evaluated between the surface point pairs with varying time t according to Eqs. (3) and (9). Fig. 4 (a) shows a volumetric tetrahedral mesh. The inserted image shows the the outer cylinder boundary and the inner spherical cavity boundary. The red color denotes the tetrahedra on the cutting boundary when we cut through the cylinder mesh by a horizonal plane.\n1 Some corresponding point pairs connected by streamlines between the outer cylinder surface and the inner spherical surface are shown on the first row in Fig. 6 . The computed GMMS on these synthetic data are visualized on the second row in Fig. 6 , where the horizontal axis is log(t) and the vertical axis is for the heat kernel, l t . In Sections 3.1.2 and 3.1.3, we discuss in details the validation of heat kernel approximation and parameter selection.\nTo build the PDM model, each data variable, G i , is centered and normalized such that each variable has zero mean and unit Euclidean length (Sj\u00f6strand et al., 2012) . Applying Eqs. (12) and (13), we obtain the first 23 internal structure features of every object. We adopt SpaSM package (Sj\u00f6strand et al., 2012) to sparse LDA. We conduct leave-oneout cross validation experiments to evaluate the classification performance (Section 3.1.4)."}, {"section_title": "Validation of heat kernel approximation: selection of N", "text": "Experiments are designed and conducted to validate the tetrahedral mesh based heat kernel approximation with Eq. (3). First, we generate a tetrahedral mesh which represents a cylinder with an inside spherical cavity. Then we reconstruct the underlying Riemannian manifold based on the obtained eigenvalues and eigenvectors. That is, we construct the subspace k , which is spanned by up to k-th degree orthonormal bases functions based on the eigenvectors. We define the\nwhere \u03bb j , \u03c6 j are the generalized eigenvalue and eigenvector of the Laplace-Beltrami operator of the underlying Riemannian manifold, \u03b2 j are Fourier coefficients to be estimated, \u03c3 is the smoothing factor and the term e \u03bb \u03c3 \u2212 j can eliminate the Gibbs phenomenon during the reconstruction process. Let\nwhere S is the vertex number. Also let\nThe coefficients \u03b2 can be estimated by the least squares method\nWe apply the Eq. (22) to reconstruct the tetrahedral mesh, treating vertex coordinates of the tetrahedral mesh as the signals defined on the Riemannian manifold. Based on the Eqs. (5), (6) and (7), the eigenvalues and eigenvectors of the Laplace-Beltrami operator defined on the volumetric cylinder with spherical cavity can be obtained. After ordering the eigenvalues from small to large, we choose the first k eigenvalues and the corresponding eigenvectors as the orthonormal basis to reconstruct the tetrahedral mesh. Here we choose \u03c3 = 0.01 and k=100 and 300. The reconstructed tetrahedral meshes are shown in the second and third columns in Fig. 4 .\nTo quantify the approximation errors, we define the root mean squared errors (RMSE) as\nFig. 5 shows the RMSE for the coordinates of the tetrahedral vertices between the reconstructed meshes and the original one. RMSE is computed for different \u03c3 varying from 0.01 to 0.05. The degrees of used eigenvectors (k) vary from 5 to 850. After degree 100, we can see less improvements in RMSE values. Most volumetric geometrical information is encoded in a low frequency basis. And the rate of RMSE convergence depends on the \u03c3, i.e., the larger value of the \u03c3 and the higher convergence rate. However, the RMSE curve will converge to the smaller value with a smaller value of the \u03c3. In addition, as the degrees increase, the weights e \u03bb \u03c3 \u2212 j exponentially decrease. So the high frequency eigenvectors do not significantly affect the accuracy of the reconstruction results. On the other hand, the term e \u03bb \u03c3 \u2212 j can effectively suppress the noise interference. The experimental results demonstrate the volumetric geometrical information may be represented by the eigenvalues and eigenvectors of the Laplace-Beltrami operator. In this paper, we empirically set N as 350.\n3.1.3. Validation of heat kernel approximation: selection of T Additional experiments have been conducted to verify whether GMMS are sensitive to discriminate different volumetric shapes. We choose the tetrahedral mesh in Fig. 4(a) as the reference. Then we construct two new tetrahedral meshes by changing the location and geometrical shape of the inner cavity. In the first mesh, the spherical cavity is transferred with 0.3 unit along x-axis. In the second mesh, the spherical cavity is changed into a cubic cavity. The outer surface does not change on both meshes. Our goal is to check whether the computed Fig. 3 . Two classes of synthetic volumetric geometrical structures. The first row shows two zoom-in structures from two classes. The second row shows all 12 structures in Class 1 (cylinder with sphere cavity) and the third row shows all 12 structures in Class 2 (cylinder with bump-sphere cavity).\n1 It is a traditional volumetric mesh rendering technique. It was generated by eliminating all tetrahedra above a predefined horizonal plane. The rendering was done with TetView software (Si, 2015) G. Wang, Y. Wang NeuroImage 147 (2017) 360-380 GMMS can detect the morphological difference among these three tetrahedral meshes. Fig. 6 illustrates these three meshes with their boundary point pairs connected by some streamlines (the first row), the computed GMMS (the second row) and the projection of the heat diffusion distances l x y ( , ) t to the outer cylinder surfaces at certain time points (the third, fourth, and fifth row, respectively). In particular, the left column is the cylinder with a spherical cavity located in the center of the cylinder (the same as Fig. 4 (a) ). The center column is the cylinder with the spherical cavity located in off-center position and the right column is the cylinder with a cubic cavity located in the center. In this special case, the three outer surfaces of the tetrahedral meshes have the same number of vertices and locations. As a result, there is no need to register three outer cylinder surfaces.\nOn these synthetic volumetric structures represented by the tetrahedral meshes, we can estimate the boundary point pairs (x and y in Eq. (3)) based on the heat propagation direction . The first row in Fig. 6 shows the outer surfaces, inner surfaces and the boundary point pairs connected by the streamlines. Following that, GMMS are computed by evaluating Eqs. (3) and (9) between the pair of ending points of each streamline. The GMMS of the three tetrahedral meshes are shown in the second row, where the horizontal axis is log(t) and the vertical axis is for the heat diffusion distance, l t . When log t ( ) \u2208 [\u22124.5, \u22121], the computed l t show strikingly different patterns which reflect different volumetric morphologic characteristics. Further we choose log t ( ) = \u22123.68, \u22122.71, and \u22120.751 as the observation time points and computed GMMS are projected on the outer surfaces (the third, fourth and fifth rows in Fig. 6 ). The values of the l t increase as the color goes from blue to yellow and to red. From the GMMS plots and the mapping results, we can see that the l t gradually converge to 0 when log(t) reaches 0. These experiments demonstrate the potential for our GMMS features to discriminate the volumetric morphometry structures.\nIn this paper, for the synthetic data, we empirically set T in Eq. (9) as 30 and uniformly choose 30 time points between the range log t ( ) \u2208 [\u22124.5, \u22121] and evaluate GMMS on these 30 time points."}, {"section_title": "Classification on synthetic data", "text": "To build the PDM model, each data variable, G i , is centered and normalized such that each variable has zero mean and unit Euclidean length (Sj\u00f6strand et al., 2012) . Applying Eqs. (12) and (13), we obtain the first 23 internal structure features of every object. We adopted SpaSM package (Sj\u00f6strand et al., 2012) to sparse LDA. We conducted leave-one-out cross validation experiments to evaluate the classification performance.\nUsing the SLDA model, the leave-one-out cross validation error rates with different numbers of features are shown in Fig. 7 (a) . From the results in (a), when more features are used in the training data, they are associated with higher error rates. We consider those features with non-zero or large a j (a j as defined in Eq. (19), i.e., the weights of the projection directions) important or informative in driving differential characteristics. After setting up the non-zero number of components in a, the total projection weight on each internal structure feature is shown in Fig. 7 (b) from every training data set. The weights of some features always keep the large values, that is to say, some features have the greater power for discrimination. From Eq. (12), the eigenvectors are associated with internal structure features whose projection weights are the components of a. Here we also map one computed third eigenvector which contains the maximum projection weight onto the mean outer surface point. As a simple visualization scheme, the first component in the third eigenvector corresponding to a given surface point is projected on the mean outer surface point. The mapping result is shown in Fig. 7 (c) . The values of the contributions increase as the color goes from blue to yellow and to red. From this visualization, one can learn that the most significant region for classification exists in middle region of the bottom part of cylinders, supporting the fact that the cylinders of Class 2 have bump-sphere cavities on the bottom. ADNI is the result of efforts of many co-investigators from a broad range of academic institutions and private corporations, and subjects have been recruited from over 50 sites across the U.S. and Canada. The initial goal of ADNI was to recruit 800 subjects but ADNI has been followed by ADNI-GO and ADNI-2. To date these three protocols have recruited over 1500 adults, ages 55 to 90, to participate in the research, consisting of cognitively normal older individuals, people with early or late MCI, and people with early AD. The follow up duration of each group is specified in the protocols for ADNI-1, ADNI-2 and ADNIGO. Subjects originally recruited for ADNI-1 and ADNI-GO had the option to be followed in ADNI-2. For up-to-date information, see www.adniinfo.org.\nTo validate whether GMMS can improve the statistical power on brain structural MRI analysis, we apply it to study the volumetric differences associated with AD, MCI and healthy control (CTL) groups on the ADNI dataset (Mueller et al., 2005) . We used the baseline T1-weighted images from 322 subjects consisting of 107 CTL, 104 patients of AD and 111 patients of MCI. The demographic information of studied subjects in ADNI baseline dataset is shown in Table 1 . Here MMSE is short for mini-mental state examination (Pangman et al., 2000) . It is a measurement of one's IQ. Full score is 30, lower means more demented. So AD patients generally have lower scores."}, {"section_title": "GMMS computation on grey matter structure", "text": "We applied FreeSurfer software (Fischl et al., 1999a) for automatic skull stripping, tissue classification and surface reconstruction. Our analysis was focused on left cerebral cortical grey matter structure because of its relevance to early AD progression (Shi et al., 2014a) . Given the white matter and pial surfaces, we used our prior work to generate an adaptively sized tetrahedral mesh and compute the volumetric Laplacian-Beltrami operator matrix (Wang et al., 2004a) and its eigen decomposition. We adopted the weighted spherical harmonic representation (Chung et al., 2007b) to establish a one-to-one pial surface correspondence across subjects and interpret the eigenvectors \u03d5 ( ) i . After that, each pial surface contained 40,962 vertices that were registered across different cortical surfaces. We further applied our prior work to build surface point pairs between registered pial surfaces and white matter surfaces by tracing the maximum heat transfer probability based on the heat kernel diffusion. Finally, the GMMS was evaluated with Eqs. (3) and (9) by varying t between each surface point pair. Fig. 8 (a) shows the streamlines between white matter and pial surfaces. (b) shows some computed streamlines in the enlarged area that connect the white matter and pial surfaces. The ending points of each streamline is a surface point pair to evaluate the GMMS with Eqs. (3) and (9). (c) shows the computed GMMS, where the x-axis is the log t ( ) and the y-axis indicates the heat kernel, l t , value computed at each time point. From the GMMS plots results, we can see that the l t gradually tends to 0 when log(t) reaches 0.\nIn this paper, for grey matter data, we uniformly choose 30 time points to compute GMMS in the range log t ( ) \u2208 [\u22125.8, \u22121]."}, {"section_title": "Two-label classification", "text": "In order to discriminate the differences between the CTL, MCI, and AD groups, we build the PDM model of the centered and normalized brain GMMS data (Sj\u00f6strand et al., 2012 ) from AD vs. CTL, MCI vs. CTL, AD vs. MCI classifications, respectively. Three different internal structure features are obtained from three PDM analyses. Based on the SLDA (Sj\u00f6strand et al., 2012) , the nonzero components in a are considered as the important or informative directions which can classify different groups effectively. The leave-one-out cross validation error rates for AD vs. CTL, MCI vs. CTL, AD vs. MCI are shown in Fig. 9 . From the results, we can see that AD vs. CTL and MCI vs. CTL groups can be classified well, i.e., when the nonzero components in a reach 75 for MCI vs. CTL group and 111 for AD vs. CTL group, the classification error rates for two groups are 7.23% and 4.91%, respectively. And the lowest classification error rate for AD vs. MCI are 13.84% when the nonzero components in a reach 140. However, the mean classification error rates for AD vs. CTL, MCI vs. CTL and AD vs. MCI groups are 7.73%, 11.64%, and 16.58%, respectively. This may indicate that the features from AD vs. CTL classification have relatively higher discriminative power than the features from MCI vs. CTL, AD vs. MCI studies. The high classification error rate when discriminating AD and MCI may indicate that patients of AD and MCI may have similar brain volumetric morphologic characteristics. We visualize the eigenvectors which had the maximum project weights in a on the mean pial surface. Specifically, we color each surface point based on the first eigenvector value associated with that point in the GMMS model. The mapping result is shown in Fig. 10 . From this visualization, it is apparent that the eigenvectors are focused on the most significant regions, such as medial temporal lobe and prefrontal lobe regions, for discriminating AD or MCI from CTL, supporting the fact that the atrophy on these two regions is the hallmark of AD disease (Thompson et al., 2001 )."}, {"section_title": "Comparison with freesurfer cortical thickness on two-label classification", "text": "We also compare the classification performance between GMMS and the thickness computed by the FreeSurfer software (Fischl et al., 1999a) using the same classification scheme. First, we apply the weighted spherical harmonic representation (Chung et al., 2007b) to establish surface correspondence and interpolate the FreeSurfer thickness onto each registered surface point. Similar to the GMMS model, we also center and normalize each subject's thickness data (Sj\u00f6strand et al., 2012) and build the PDM model to obtain v i as the thickness feature. Three different internal structure features based on the thickness can be obtained from the three PDM analyses, i.e. AD vs. CTL, MCI vs. CTL, AD vs. MCI. We further applied SLDA (Sj\u00f6strand et al., 2012) for classification. The leave-one-out classification error rates based on the cortical thickness for three classification tasks (AD vs. CTL, MCI vs. CTL, AD vs. MCI) are shown in Fig. 11 . From the results, we can see that AD vs. CTL groups can be classified well, i.e., when the nonzero components in a reach 77, the error rate is 16.03%. However, the lowest classification error rates for MCI vs. CTL, AD vs. MCI classifications are 22.78% and 29.21% when the feature numbers reach 59 and 88, respectively.\nNext, we apply the receiver operating characteristic (ROC) analysis to further compare the discriminative power of the two analysis frameworks. The ROC curve is created by plotting the true positive rate against the false positive rate at various threshold settings. Through varying the threshold values which can determine the SLDA classifier boundaries, we can obtain the true positive rate, false positive rate and draw ROC curves. The ROC curves are shown in Fig. 12 . In Fig. 12 Fig. 10 , we also map the eigenvectors of the covariance matrices of the three cortical thickness classifications which contains the maximum projection weight onto the mean pial surface point. The mapping result is shown in Fig. 13 . By comparing Fig. 10 with 13, we can see that two groups of experiments share some common strong discrimination areas but the cortical thickness features spread more broadly (maybe due to the limited training data). Overall, given the same testing data set, we can see that the features of the GMMS have higher discriminative power than the cortical thickness. A key reason for the better classification may be that GMMS can not only compute geodesic distance between the point pairs, but it also compare the immediate neighboring volume changes along the geodesics."}, {"section_title": "Three-label classification", "text": "We also studied the three-label SLDA model by combining the features of AD, MCI and CTL into one observation matrix V N n n n , = + + N P AD MCI CTL \u00d7 , n AD , n MCI , n CTL are subject numbers of three classes. We estimated the orthogonal directions a k , = 1, 2 k , which allow for optimal separation between the three different groups. The leave-one-out classification error rates for AD, CTL and MCI are shown in Fig. 14 (a) . The lowest classification error rate was 11% when the nonzero components in a exceeded 111. Fig. 14 (b) shows the classification results in the projection space, with the horizontal coordinate representing the first direction a 1 , and with the vertical coordinate used for the second direction a 2 . The symbols \u25cb, \u25a1 and \u2207 indicate the distributions of the AD, MCI and CTL groups in the (Fischl et al., 1999a) . Fig. 12 . ROC analyses for comparison between proposed GMMS and FreeSurfer cortical thickness features (Fischl et al., 1999a) .\nG. Wang, Y. Wang NeuroImage 147 (2017) 360-380 projection space based on the SLDA. (b) indicates the distribution with the classification error rate 14.52% when the nonzero components in a reached 111. The symbols with red color are the classification error results. Because the differences between the internal volumetric structure information of CTL with AD and MCI are more dramatic, the cluster center of CTL is farther away from the cluster centers of AD and MCI. Then the error results of classifying the CTL objects into the MCI or AD classes are much smaller than the ones within AD class being classified into the MCI class. In order to verify the classification power of the GMMS, we have made a comparison with using the thickness for three-label classification. The leave-one-out classification error rates with thickness for AD, CTL and MCI are shown in Fig. 14  (c) . The lowest classification error rate was 27.04% when the nonzero components exceeded 115. (d) indicates the distribution of the AD, MCI and CTL with the classification error rate 27.04% when the nonzero components in a reached 120 by using the thickness features. From the (b) and (d), the classification boundary with the thickness is not clear as the GMMS, especially the classification boundary between the AD and the MCI. This implies that the obtained GMMS may capture and quantify more morphometric features and may help improve the classification power of brain cortical thickness analysis."}, {"section_title": "Discussion", "text": "A holistic quantification of brain grey matter morphometry may prove beneficial to many neuroimaging research efforts. Prior work usually generates a univariate representation of brain cortical thickness defined on each brain cortical surface point (e.g. Fischl and Dale, 2000; Jones et al., 2000; Thompson et al., 2004) . In this paper, we present multi-scale heat kernel based brain grey matter morphology signatures that may serve as a practical grey matter morphology imaging biomarker. There are two main findings in our work. First, our formulations make it possible for profoundly analyzing the volumetric geometry structure of grey matters. For example, between a pair of points, our heat kernel based metric may reflect both geodesic distance and regional geometric properties and consequently it provides holistic G. Wang, Y. Wang NeuroImage 147 (2017) 360-380 characterizations of general shell-shape volumes. Since our approach registers pial surfaces, similar to thickness measures (e.g. Clarkson et al., 2011; Jones et al., 2000; Fischl and Dale, 2000) , the proposed GMMS describes localized atrophy changes and may achieve an unprecedented accuracy. With our volumetric Laplace-Beltrami operator (Wang et al., 2004a) , we can model the cortical grey matter structure by random walk and solve it with heat kernel theorem. The obtained GMMS are robust, intrinsic and informative and may help improve the statistical power of brain cortical thickness analysis. Second, we integrated SLDA with our GMMS and built a practical imaging classification system. Our preliminary experiments have demonstrated the feasibility of applying the proposed GMMS to classify AD and MCI patients. In our experiments, we found that our system has produced meaningful results consistent with the literature and outperformed cortical thickness features computed by FreeSurfer. The proposed GMMS may advance the state-of-the-art structural MRI analysis techniques towards a holistic description of grey matter structure.\nIn recent years, the spectrum of the Laplace-Beltrami operator was well studied in the neuroimaging research (Chung et al., 2005; Qiu et al., 2006a; Joshi et al., 2012; Shi et al., 2015; Wachinger et al., 2015) , such as functional and structural map smoothing (Qiu et al., 2006b; Shi et al., 2010 Shi et al., , 2014b , surface registration (Lombaert et al., 2013) , subcortical structure analysis (Lai et al., 2009) , and surface function transfer (Lombaert et al., 2015) . Most of work was done with surface Laplace-Beltrami operator (Reuter et al., 2006 (Reuter et al., , 2009 . A limited number of work have worked on volumetric Laplace-Beltrami operator (Castellani et al., 2011; Wachinger et al., 2015; Shi et al., 2015; Raviv et al., 2010; Rustamov, 2011) . Some work, e.g. (Raviv et al., 2010; Rustamov, 2011; Castellani et al., 2011) , adopted the rasterizationbased Laplace-Beltrami operator while others, e.g. Wachinger et al., 2015; , used discrete finite element based Laplace-Beltrami operator. Between these two kinds of methods, owing to the multi-resolution nature of the tetrahedral mesh, the finite element methods may capture and quantify more local morphometric features and are better suited for volume shape analysis research."}, {"section_title": "Influence of each building block of our pipeline", "text": "As a shape analysis software tool, the input to our system is the binarized images, which are obtained either by some automatic image segmentation tools (e.g. Fischl et al., 1999a) or manual segmentation results using some interactive graphic tools (Shattuck and Leahy, 2002 ). In the current paper, we took the input as the automatic segmentation results by FreeSurfer (Fischl et al., 1999a) . With pial and white matter surfaces constructed by FreeSurfer as boundary surfaces, we built tetrahedral meshes for the subsequent grey matter morphometry signature analysis. Image segmentation step plays a crucial role in our system. Note other options are also available to segment brain grey matter structure. For example, SPM (Friston et al., 2007) and FAST package (Zhang et al., 2001) can also segment brain grey matter and white matter. Thus these systems can be potentially adopted to generate the input data to our system. Whether or not the current FreeSurfer based system provides superior discrimination power than other brain image segmentation tools still needs more validation. However, the benefit of our current system design is the flexibility for users to adapt the system to different data sources. Furthermore, similar to some other work that used FreeSurfer for cortical thickness research (e.g. Fjell et al., 2015; Vuoksimaa et al., 2015) , our software tool may also be interesting to FreeSurfer users so that it may be appealing to a broader range of researchers in the neuroimaging community.\nIn our current system, weighted spherical harmonics was adopted to build surface correspondences across cortical surfaces. To make use of weighted spherical harmonics, we adopted a spherical conformal mapping method to compute the spherical mapping. We have used the same technique in a variety of our prior work Gutman et al., 2009; Shi et al., 2013) . In the literature, area-preserving spherical mapping was also frequently adopted in spherical harmonic analyses, e.g. (Styner et al., 2006; Shen et al., 2004; Chung et al., 2007b) . One of important benefits to use area-preserving spherical mappings is the controlled area distortion, which SPHARM technique is sensitive to. The advantages to use spherical conformal mapping are the theoretical soundness and system robustness. In the following, we are going to explore the influence of two different spherical mapping methods to our current system performance.\nIn our prior work (Shi et al., 2013) , we reported frequent running time errors with the publicly available SPHARM software package (Styner et al., 2006) . Here we adopted another area-preserving spherical mapping method developed by Shen and Makedon (2006) . This area-preserving mapping algorithm contains a novel local mesh smoothing method, which is based on solving a linear system to reduce both area and length distortions at each local submesh. In addition, this mapping algorithm computes the distribution of area distortion on the sphere using the concept of area scaling ratio function (ASRF) and develops a novel global smoothing method which aims to equalize the ASRF values over the entire sphere. The overall algorithm combines the local and global methods together and performs these two methods alternately until a stable result is achieved. In the first experiment, we mapped a left cerebral cortex triangular mesh onto the unit sphere by using both conformal and area-preserving mappings. Then the area distortions between the original triangular mesh and the spherical mapping triangular mesh can be obtained under the condition that the total area of the original cerebral cortex triangular mesh has been normalized to \u03c0 4 . We illustrate the comparison results in Fig. 15 . From  Fig. 15 , we can see that the conformal mapping method can not only preserve the angles of the triangles but also relatively better decrease the area distortions than the other method.\nIn another experiment, we also generated the GMMS data based on the area-preserving mapping algorithm (Shen and Makedon, 2006) . After building the PDM model, we have redone the two-label classification. Based on the SLDA, the leave-one-out cross validation error rates G. Wang, Y. Wang NeuroImage 147 (2017) 360-380 for AD vs. CTL, MCI vs. CTL, AD vs. MCI are shown in Fig. 16 . From the results, we can see that AD vs. CTL and MCI vs. CTL groups can be classified well, i.e., when the nonzero components reach 83 for MCI vs. CTL group and 105 for AD vs. CTL group, the classification error rates for two experiments are 7.65% and 4.78%, respectively. And the lowest classification error rate for AD vs. MCI is 14.01% when the number of nonzero components reaches 138. Compared with the two-label classification results with the conformal mapping (Fig. 9) , there is a little bit improvement (i.e. 0.13% less error rates ) for AD vs. CTL classification but poorer performance on two other experiments. From this empirical experiment, we learn that these two methods generate comparable results for our purpose while spherical conformal mapping method may be more theoretically rigorous and practically robust. Unlike some previous computationally intensive methods for surface registration (e.g. Davatzikos, 1997; Fischl et al., 1999b; Lombaert et al., 2013; Shi et al., 2016 Shi et al., , 2013 , the weighted spherical harmonic representation adopted in this paper provides a simple way of establishing surface correspondence between two surfaces without time consuming numerical optimization (Chung et al., 2007a) . The weighted spherical surface heat kernel (WHK) is defined as\nwhere \u03a9 \u03b8 \u03c6 = ( , ), \u03a9 \u03b8 \u03c6 \u2032 = ( \u2032, \u2032), Y lm is the spherical harmonic basis with the degree l and the order m, and the parameter \u03c3 controls the dispersion of the kernel WHK. The spherical harmonic basis Y lm plays a critical role for the WHK based surface registration. In this case, we change the degree l of the spherical harmonic basis Y lm to study the influence of the registration to the classification results. When l is taken the different values as 10, 20, 30, 40 and 50, we perform the two-label (AD vs. CTL, CTL vs. MCI and AD vs. MCI) classification studies in which other experimental settings stay the same in other experiments. The experiment results are shown in Fig. 17 . From the results, we can see that the large errors are mainly caused by insufficient number of features. The results indicate that the current surface registration algorithm is generally sufficient for the computed GMMS to be effective as imaging biomarkers. However, the total error rates of the classification are influenced to some extent by the degree l. We also compute the areas under the error rates curves (EUAC) to estimate the total error rates. From the results in Fig. 17 , we can see that too low or too high degree of l will all cause the larger EUAC. The main reason may be that a low degree representation is insufficient for estimating the GMMS.\nOn the other hand, although increasing the degree l of the representation increases the goodness-of-fit, it may increase the higher frequency compositions which introduce strong noise interference. In this paper, we choose the degree l of the spherical harmonic basis Y lm as 30 which produces the lowest total error rates for the classification. In addition, too low or too high degree l of the representation will all cause the larger EUAC.\nG. Wang, Y. Wang NeuroImage 147 (2017) 360-380 In addition, we studied our system classification performance using Support Vector Machines (SVM) (Cortes and Vapnik, 1995) , which is a powerful technique for data classification, regression, and other learning tasks. The goal of SVM is to produce a model (based on the training data) which predicts the target values of the test data given only the test data attributes. After PDM process, the GMMS features have been scaled to [\u22121, +1] before the classification. The main advantage of scaling is to avoid attributes in greater numeric ranges dominating those in smaller numeric ranges. Two-label (AD vs. CTL, CTL vs. MCI and AD vs. MCI) GMMS classification results with SVM are shown in Fig. 18 . Based on the GMMS features, we find the best parameter C as 0.5. Comparing the classification results with the the SLDA results shown in Fig. 9 , we find that the error rates of two-label GMMS classification with SVM are roughly comparable with SLDA, i.e., the lowest error rates of two-label (AD vs. CTL, CTL vs. MCI and AD vs. MCI) with SVM approximately equal to the ones with SLDA. This indicates that our GMMS features carry significant grey matter morphological information. However, the error rate curves with SVM fluctuate more than those of the SLDA. The main reason may be that each additional feature adds a parameter to the SVM classifier model which needs to be estimated, and mis-estimations that result from the less informative features can actually degrade performance. This phenomenon of decreasing classifier accuracy from adding the less informative features is known as the \"peaking effect\" or \"Hughes phenomenon\" (Hughes, 1968) . For SLDA, the classification of a new observation v is performed by graphical projection a v T and finding the closest centroid in the derived space defined by a sos . The SLDA provides a concise morphology feature set with improved classification accuracies."}, {"section_title": "Adoption of weighted spherical harmonic for cortical surface registration", "text": "We adopt weighted spherical harmonic (Chung et al., 2007a) to compute surface correspondence between tetrahedral mesh boundary surfaces. The weighted spherical harmonic coefficients are estimated and surface correspondence between the different subjects can be established by the weighted spherical harmonic representation. Subsequently, the eigenvector \u03d5 ( ) i measurements in the different subject surfaces can be interpolated into a unified template by using the weighted spherical harmonic representation. This interpolation method can be considered as weighting the coordinate or eigenvector data of the neighboring vertices according to the geodesic distance along the cortical surface, which can improve the accuracy of the eigenvector interpolation and the group-difference statistical test power. The thickness measures estimated by FreeSurfer (Fischl et al., 1999a) were also linearly interpreted to the unified template based on the weighted spherical harmonic representation. The result is a retriangulation of each surface such that all the surfaces have the same number of registered vertices. Similarly, the following PDM and SLDA analyses also used the registered surfaces.\nIn this paper, we adopt both surface and volumetric spectral analysis techniques. The GMMS are computed by volumetric spectral analysis of the grey matter structure. The weighted spherical harmonic representation (Chung et al., 2007a ) is used to smooth and compare the computed GMMS features. Our work also strongly indicate that manifold spectral analysis techniques may help build efficient neuroimaging systems."}, {"section_title": "Relationship of GMMS to biological processes", "text": "Clinical and neuropathological studies show that atrophy of brain structures is associated with cognitive impairment in normal aging and AD (Frisoni et al., 2010) , and typically results from a combination of neuronal atrophy, cell loss, and impairments in myelin turnover and maintenance, and corresponding reductions in white matter volume. These cellular processes combine at the macroscopic level to induce observable differences on brain MRI. Cortical thickness estimation, among some other MRI measures, such as hippocampal and lateral ventricular morphometry (Jack et al., 2003; Holland et al., 2009; den Heijer et al., 2010; Wang et al., 2011) and average entorhinal cortex volume (Cardenas et al., 2011) , are predictive of progression of MCI to AD. Our work, as well as other cortical thickness estimates developed by other groups (e.g. Clarkson et al., 2011; Jones et al., 2000; Fischl and Dale, 2000) , measures the extent and severity of grey matter shape deformations as a proxy for grey matter atrophy. Fig. 19 illustrates our motivation to compute GMMS. Fig. 19 (a) shows the heat diffusion spectrum and (b) heat diffusion illustrated as random walk. In Fig. 19 (c), two surface pairs x y ( , ) 1 1 and x y ( , ) 2 2 and their diffusion distances illustrated as random walk. Although the geodesic distances between them are very similar, the region between x y ( , ) 1 1 is broader than the one ( , ) 1 1 is broader than the one between x u ( , ) 2 2 . This property is governed by Eq. (2) and can be reflected by our GMMS (as shown by (d)). Essentially, GMMS is a profile to describe the profound thickness changes between pial and white matter surfaces. between x y ( , ) 2 2 . This property can be captured by our GMMS (Eq. (2)). A theoretical model of GMMS is shown in Fig. 19 (d) . Essentially, GMMS is a way to better describe the profound thickness changes between pial and white matter surfaces. Instead a univariate variable, the current work computes a spectrum based on physical models and geometry analysis theories. Biologically speaking, GMMS is a complete description of grey matter atrophy that is associated with macrostructural and microstructural loss in different brain regions. For example, there are certain points that all heat diffusion curves intersect with each other on the second row in Fig. 6 , they mean that at before and after those particular times, the heat diffusion processes flipped. It reflects the neighboring thickness along these heat diffusion curves. Our work indicates that GMMS may have stronger statistical power to describe subtle grey matter morphometry changes."}, {"section_title": "Comparison with two other imaging biomarkers", "text": "We computed the hippocampal volume and entorhinal cortex volume data with FreeSurfer (i.e., 322 subjects consisting of 107 CTL, 104 patients of AD and 111 patients of MCI) from Alzheimer's Disease Neuroimaging Initiative (ADNI) database. They are the same subjects which are used in the GMMS analysis. Because the subject number is much larger than the feature number, there is no need for us to construct PDM models to reduce the feature dimension. We apply the LDA, SVM and SLDA classifiers to do the leave-one-out cross validation experiments on two-label classification tasks between AD vs. CTL, MCI vs. CTL, AD vs. MCI respectively. When using SVM (Cortes and Vapnik, 1995) for classification, the hippocampal volume and entorhinal cortex volume features have been scaled to [0,1] before the classification. Based on the volume features, we find the best penalty parameter of the error term (C) as 0.125 based on a \"grid-search\". The results of the two-label classification error rates are shown in Table 2 . From the results, we can see that both hippocampal volume and entorhinal cortex volume have strong discriminative power to classify between CTL, MCI and AD patients. However, the classification error rates are greater than those of GMMS feature in our current experiment.\nIn the literature, many prior research, e.g. (Frisoni et al., 2010) , has developed theoretical models of progression of cognitive and biological markers for AD. Entorhinal cortex atrophy and hippocampal atrophy are among those imaging biomarkers which have earlier detection power than the whole brain atrophy or temporal neocortex atrophy. The current empirical results just indicate that our results are better than the hippocampal and entorhinal cortex volumes produced by FreeSurfer in this small dataset. We hope our work would help generate more research interest on developing powerful cortical thickness or hippocampus/entorhinal cortex analysis algorithms, e.g. (Shi et al., 2013; Iglesias et al., 2016) , and eventually advanced structural MRI analysis research."}, {"section_title": "The overfitting phenomenon", "text": "Theoretically, when one uses LDA model for classification, more features may only improve or not change performance; however, in practice, each additional feature adds a parameter to the LDA model that needs to be estimated, and mis-estimations that result from the less informative features can actually degrade performance. This is a form of overfitting (Marron et al., 2007) . Using our synthetic model features (described in Section 3.1), we conducted a simple experiment to study different results produced with LDA and SLDA models. Fig. 20 shows the leave-one-out classification results in the projection space, with the horizontal coordinate representing the subject number, and the vertical coordinate for projected data. Fig. 20 (a) and (b) show the leave-one-out classification results based on LDA and SLDA. Here the number of the nonzero components in a are 22 and 16, respectively. The symbols \u25cb and \u25ca indicate two classes. In Fig. 20, comparing (a) and (b), we can see the reduced classification errors. The classification error rates are 20.8% (in (a), with LDA) and 0% (in (b), with SLDA), respectively. It is probably due to the phenomenon of the data piling (Marron et al., 2007) , which means that when the data are projected onto the projection direction a, many of the projections are exactly the same, that is, the data pile up on top of each other. The data pilling is not a useful property for Fig. 20 . The leave-one-out test data distributions based on LDA and SLDA in the projection space.\nG. Wang, Y. Wang NeuroImage 147 (2017) 360-380 discrimination because the corresponding direction vector is constrained into the very particular aspects by the additional features of the training data. It leads to the bad classification result among the test data shown in (a). In contrast, because of the sparsity, the projections to the SLDA direction for the two data sets have separate distributional properties. The phenomenon of data piling can be restrained effectively."}, {"section_title": "Potential future improvements", "text": "The current work is our first step towards achieving a holistic cortical thickness descriptor by applying a multi-scale heat kernel based geometry description to quantify and compare brain grey matter morphology. There are at least three potential extensions or improvements to the current framework. First, here we use the sparse LDA to reduce feature dimension and extract those features with the most discriminant power. We may use other more advanced feature reduction schemes. For example, our recent work (Zhang et al., 2016) developed a patch based sparse coding framework that effectively extract discriminant features from surface multivariate statistics (Wang et al., 2011) . Comparing with sparse LDA, dictionary learning and sparse coding (Mairal et al., 2009 ) provides a concrete feature set defined on an obtained dictionary through iterative learning. It may help further improve our system statistical power. Second, for PDM and SLDA models, our current work mainly relies on point-to-point surface correspondence (e.g. we achieved it by spherical conformal mapping and weighted SPHARM (Chung et al., 2007b) here). Although it helps improve the accuracy, such computation is time-consuming. To reduce the computation cost, we may relax the correspondence to region-to-region correspondence or even make no requirement for surface correspondence. For example, we may apply a spectrum analysis approach (Fang et al., 2015) to get a consistent eigen-shape description of the GMMS on each region or on the entire cortical surface. Taking advantage of the nice theoretic properties of diffusion geometry, the multi-scale GMMS will still carry rich intrinsic geometry information and we may improve the computation efficiency without substantially losing classification accuracy. Third, to compute GMMS, we have to generate thin shell-shape tetrahedral meshes (illustrated on the second row in Fig. 1 ) whose majority of dihedral angles need to be acute angles. We have carefully studied a series of open source tetrahedral mesh construction tools, including tetgen (Si, 2015) , iso2mesh (Fang and Boas, 2009) , CGAL (CGAL Editorial Board, 2013) , TetraMetrix (Lederman et al., 2011) , Quartet (Doran et al., 2013) , etc. In our experience, none of them provide a quality that satisfies these two conditions. So we developed our own tetrahedral mesh generation software and reported our results in our prior work . One limitation of our current system is that the resulting tetrahedral meshes do not keep the original surfaces and their correspondences. To fix this problem, we introduced weighted spherical harmonics to register the resulting surfaces. As a result, we lose the original surfaces and possible surface correspondences defined on them. In future, we will try to refine our tetrahedral mesh generation software and develop new algorithms to keep the original surfaces. Meanwhile, we may also study whether some commercial software, such as CUBIT (Sandia National Laboratories, 2016), will help us achieve this goal."}, {"section_title": "Conclusion", "text": "In this paper, we present heat kernel based grey matter morphology analysis signatures. Together with the sparse linear discriminant model, the framework chooses a sparse feature set that may be beneficial for tracking brain morphology changes related to AD progress and the related diagnosis of different AD progression stages. We performed our preliminary experiments and compared our results with FreeSurfer cortical thickness features on the publicly available ADNI dataset. The new framework combines the sensitivity of GMMS and the efficiency of sparse LDA model and boosts the classification performance. As a reliable and efficient cortical thickness estimation software, FreeSurfer was endorsed by quite a few comparison studies (e.g. Clarkson et al., 2011; Li et al., 2015) and widely adopted by neuroimaging research (e.g. Fjell et al., 2015; Vuoksimaa et al., 2015) . In this work, we compared our work with the thickness estimate by FreeSurfer. In future, we will try to compare our algorithm with some other advanced cortical estimation algorithms (e.g. Jones et al., 2000; Das et al., 2009) . Surface registration plays a major role in our system. Our current system uses weighted spherical harmonics to generate surface correspondence on newly generated tetrahedral meshes. If we develop or adopt new tetrahedral mesh generation software that keep the original surface correspondence, we may be able to compare the performance between our current work and that of the system using FreeSurfer generated surface correspondence. In future, we plan to keep improving the sensitivity and efficiency of GMMS systems and apply them to our ongoing preclinical AD research (Shi et al., 2014a; Li et al., 2016) .\ntheory. In theory, the analytic solutions for the spectrum are only known for a limited number of shapes (e.g., the sphere, the cuboid and the solid ball). Specifically, first exact Dirichlet eigenvalues of the unit ball in 3 are 9.8696, 20.1907 and those of the unit cube in 3 are 29.6088, 59.2176 (Reuter et al., 2006) .\nIn our experiments, we generate tetrahedral meshes of unit solid ball and unit cube. For the sake of numerical accuracy, we control the maximal volume of an individual tetrahedron to be 0.001 in the generated tetrahedral meshes. As a result, there are a total of 6,583 tetrahedra in the unit ball model and 2,018 tetrahedra in the unit cube model. Using the lumped discrete Laplace-Beltrami operator (Eq. (8)) and the lumped volume matrix, we compute the eigenvalues with the Dirichlet boundary condition . We obtained the first 400 eigenvalues on both models and the computation results are shown in Fig. A1 . The first two Dirichlet eigenvalues of the unit ball are 9.8752, 20.2054 and the first two Dirichlet eigenvalues of the unit cube are 29.5235, 59.3216. Although the numerical results may be further refined (e.g. by improving the smoothness of tetrahedral mesh surfaces), the current numerical evaluation results suggest that our discrete Laplace-Beltrami operator provides a solid discretization scheme to compute the proposed GMMS with sufficiently numerical accuracy."}]
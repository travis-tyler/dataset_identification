[{"section_title": "Abstract", "text": "We introduce a general hierarchical Bayesian framework that incorporates a flexible nonparametric data model specification through the use of empirical likelihood methodology, which we term semiparametric hierarchical empirical likelihood (SHEL) models. Although general dependence structures can be readily accommodated, we focus on spatial modeling, a relatively underdeveloped area in the empirical likelihood literature. Importantly, the models we develop naturally accommodate spatial association on irregular lattices and irregularly spaced point-referenced data. We illustrate our proposed framework by means of a simulation study and through three real data examples. First, we develop a spatial Fay-Herriot model in the SHEL framework and apply it to the problem of small area estimation in the American Community Survey. Next, we illustrate the SHEL model in the context of areal data (on an irregular lattice) through the North Carolina sudden infant death syndrome (SIDS) dataset. Finally, we analyze a point-referenced dataset from the North American Breeding Bird survey that considers dove counts for the state of Missouri. In all cases, we demonstrate superior performance of our model, in terms of mean squared prediction error, over standard parametric analyses."}, {"section_title": "Introduction", "text": "The empirical likelihood (EL) dates back to the seminal work of Owen (1988) and has become increasingly popular in recent years, as a result of Owen (2001) , which placed many of the fundamental concepts in a single text. Early work by Qin and Lawless (1994) greatly expanded the use of EL by placing it in the context of estimating equations. Kolaczyk (1994) derived general conditions for the use of estimating equations for the EL that are applicable to many types of linear, nonlinear, and semiparametric models. Many EL-type estimators have since been derived, known as Generalized Empirical Likelihood (GEL) estimators. Newey and Smith (2004) provides an excellent overview of these estimators and their higher order properties. Lazar (2003) provides evidence, by means of a simulation study, that the EL framework is appropriate for Bayesian inference. Making use of a result from Monahan and Boos (1992) that yields conditions by which a likelihood can be determined suitable for Bayesian inference, this paper initiated Bayesian research on EL and GEL estimators. Schennach (2005) derived a Bayesian GEL estimator by means of nonparametric priors and further extended their approach in Schennach (2007) . Fang and Mukerjee (2006) derived the asymptotic frequentist coverage properties of the Bayesian credible intervals for the mean parameters of a wide class of EL-type likelihoods, and demonstrated undercoverage for credible intervals for parametric means generated by GEL estimators. Additional work comparing the properties of credible intervals for specific types of EL-type likelihoods can be found in Chang and Mukerjee (2008) .\nIn particular, this work demonstrates favorable coverage rates for the traditional EL of Owen (1988) .\nBayesian hierarchical modeling (BHM) has become an expansive field. When modeling complex stochastic phenomena within the BHM framework, typically at least three levels of model hierarchy are considered, which are the data model, process model, and parameter model (Berliner, 1996 , Wikle, 2003 . Subsequently, modeling typically proceeds by selecting parametric distributions for each stage of the hierarchy. As demonstrated in Cressie and Wikle (2011) , this framework advantageously also allows for scientifically motivated process models to be utilized at the latent stage. One aspect of this approach is that model implementation typically requires selection of an appropriate data distribution (likelihood) for the observations. Our approach extends the general applicability of BHMs by broadly placing them in the context of the empirical likelihood. The model we propose can be viewed as a semiparametric empirical likelihood (SHEL) model and utilizes either EL estimators or GEL estimators at the data stage of the model hierarchy. Parametric process models can then be utilized to handle the potentially complex underlying dependence structures. By placing the EL in the context of Bayesian hierarchical modeling, we alleviate the issues of modeling the dependency in the observations, which is often difficult to handle in the usual observationdriven EL framework and generally utilizes restrictive blocking arguments. Specifically, we expand the BHM framework to allow empirical data models, rather than requiring the user to select a parametric structure for the data.\nHierarchical approaches to empirical likelihood have been recently considered, but still remain largely underdeveloped, with no general framework to date. Chaudhuri and Ghosh (2011) proposed using the EL in a semiparametric hierarchical nested error regression model for small area estimations (SAE). The model they developed extends the traditional Fay-Herriot (FH) model (Fay and Herriot, 1979) to the EL framework. Although Chaudhuri and Ghosh (2011) demonstrate good model performance, their implementation utilized informative priors for some of the model parameters, and they noted sensitivity to these specifications. The general approach they propose allows for both semiparametric and nonparametric specifications of the model for the superpopulation mean, with the nonparametric specification relying on a Bayesian nonparametric formulation (i.e., a Dirichlet process mixture with Gaussian base measure). We pursue a more complete development of EL in the context of BHMs. The model we propose here is of independent interest and readily allows for various other hierarchical and/or dependence structures, such as temporal and/or spatiotemporal dependencies. However, for the sake of brevity, subsequent exposition focuses on spatially correlated data.\nBased on blocking arguments originally developed for time series by Kitamura (1997) , Nordman and Caragea (2008) developed a point referenced spatial model in the frequentist EL framework that considers variogram fitting for data collected on a regular grid, and assumes stationarity. Utilizing a similar blocking argument, Nordman (2008) considered a observation-driven model for spatial data on a regular lattice using the EL framework that does not require stationarity. To the best of our knowledge, hierarchical models for spatial data on an irregular lattice that explicitly account for the underlying spatial structure in the data do not exist in the current literature. A recent advancement in the spatial EL literature is Bandyopadhyay et al. (2012) , in which irregularly spaced spatial data is modeled using frequency domain techniques. Their framework greatly expands EL methodology for point referenced spatial data but is based on different assumptions than those presented herein and does not immediately extend to the lattice case, where distances are not uniquely defined.\nThe structure of this paper is as follows. Section 2 develops methodology that will be needed for the general specification of the SHEL model. Section 3 discusses technical details related to the Bayesian estimation of the SHEL model. Two simulation studies are provided in Section 4, whereas Section 5 presents three case studies: the FH model for SAE in the context of the American Community Survey (ACS), the North Carolina SIDS data (areal data), and a point referenced dataset from the North American Breeding Bird survey that considers dove counts for the state of Missouri. Section 6 provides concluding discussion."}, {"section_title": "Spatial SHEL Models", "text": ""}, {"section_title": "The SHEL Framework", "text": "Let Z be an n Z -dimensional vector of observations, Y be an n Y -dimensional vector corresponding to an unobserved process, and \u03be be a set of parameters related to both the data model and process model. Here, Z and Y do not need to be of the same dimension. For example, the observations could be mapped to the unobserved process through a matrix that accounts for change-of-support or aggregation (Wikle and Berliner, 2005) . However, for ease of notation, we assume n Z = n Y \u2261 n, unless specified otherwise. The hierarchical framework that we propose is motivated by the parametric counterpart (e.g., Berliner, 1996 , Wikle, 2003 , but with increased flexibility from relaxing the parametric data model assumption. The SHEL structure hierarchy can be written as\nwhere the underlying distribution [Z|Y, \u03be D ] is assumed to have two finite moments. Critically, we further assume E(Z|Y, \u03be D ) = g(X\u03b2 + Y) and E(Z 2 |Y, \u03be D ) = h(X\u03b2 + Y) for g and h known, with X being an n \u00d7 m design matrix of fixed and known covariate information.\nThese relationships will serve to inform a set of estimating equations utilized in estimating the parameters of the empirical data model. One of the main advantages of working in the hierarchical paradigm with an EL data model is the ability to introduce conditional independence in a natural way, specifying the dependence structure at a higher level in the model hierarchy. That is, dependence among outcomes in a spatial (and/or temporal) setting is handled by conditioning on a latent spatial (and/or temporal) process. By taking a conditional approach, the original formulation of the EL, which assumes independent and identically distributed (i.i.d.) observations, becomes immediately applicable -although the assumption of independent observations could be relaxed (e.g., see Owen, 2001, Chapter 4) . In other words, the SHEL framework effectively utilizes the conditional model specification inherent to BHMs to extend the applicability of the EL to a broad range of analyses. In doing so, we alleviate some of the strict assumptions often required of the blocking arguments used in EL modeling of dependent data, such as those in Kitamura (1997) , Nordman and Caragea (2008) , Nordman (2008) , and Kaiser and Nordman (2012) ."}, {"section_title": "Empirical Likelihood", "text": "The use of estimating equations in the EL framework (Qin and Lawless, 1994) has recently been used in the FH model by Chaudhuri and Ghosh (2011) and represents an attractive way to employ EL in the BHM framework. Generally, the EL of a vector of functionals \u03b8 = {\u03b8 1 , . . . , \u03b8 R } given independent and identically distributed observations Z 1 , . . . , Z n , can be computed as\nwhere L(\u03b8) is maximized over the simplex\nand R is the number of functionals to be estimated. Here, for i in 1, . . . , n, {m j (z i , \u03b8 i )} j=1,...,J are a set of J estimating equations and \u03b8 \u2208 R J are of the form k j ( n i=1 w i z i ) = \u03b8 j , for known functions k j (\u00b7), where we have assumed J = R, i.e., that unstructured \u03b8 is not under-or overspecified. Without covariate information, one cannot estimate more parameters than the number of estimating equations. However, Chaudhuri and Ghosh (2011) suggest utilizing structured \u03b8, by which each location i = 1, . . . , n has a unique mean and variance. Covariate information is then used to provide structure to a set of mean parameters {\u03b8 1 , . . . , \u03b8 n }, where \u03b8 i is modeled based on auxiliary information x i . This covariate information allows the dimension of \u03b8 to be greater than J. The estimating equations Chaudhuri and Ghosh (2011) suggest have the form\nwhich are derived based on the exponential family. In the exponential family we define \u03b8 i to be mean of Z i and V (\u03b8 i ) to be the variance of Z i |\u03b8 i . These easily extend to the GEL framework, but V (\u03b8 i ) is no longer properly considered a variance, instead serving as a scale parameter.\nIn the SHEL framework, \u03b8 i will denote the conditional mean of Z i |Y i . The estimating equations approach is natural for the SHEL framework because one can compute the EL based on known formulas given proposed values for {\u03b8 i }. When utilizing the estimating equation approach to the EL, the model weights can be computed as\nwhere\nfor all j, and {z i } denote the observations. Clearly, these weights are monotone in each\nThe likelihood can be extended to a set of GEL estimators (Smith, 1997) by the function\nwhere\n, which is the traditional EL function first introduced by Owen (1988) , and f \u03b8 (w i ) = \u2212w i log(w i ), which was introduced by Schennach (2005) and represents the exponentially tilted empirical likelihood (ETEL) estimator. Henceforth, we utilize only the traditional EL of Owen (1988) throughout the methodological development, but note that other choices of f \u03b8 (\u00b7) in the GEL family could also be used.\nAn important observation of Chaudhuri and Ghosh (2011) is that the non-analytic form of the posterior distributions introduced by the EL makes verification of propriety of these models difficult. Therefore, improper priors should generally not be used in the SHEL framework, as only proper priors can guarantee propriety of the posterior parameter distributions."}, {"section_title": "Lattice Priors for the SHEL Framework", "text": "Intrinsic Gaussian Markov Random Fields (IGMRFs) (Rue and Held, 2005) , such as the intrinsic conditional autoregressive model (ICAR) (Besag et al., 1991) , may seem to be a poor choice for a SHEL prior due to the impropriety implicit to these models. However, recent developments in lattice priors allow for modification of the ICAR to yield a proper prior, while avoiding some of the common difficulties of proper CAR models.\nA common ICAR model specification is given by\nwhere b ij = 1 if locations i and j are neighbors and 0 otherwise, and j \u2208 ne(i) indicates that locations i and j are neighbors. This yields a probability density function for Y =\nwhere B is a matrix with {B} (i,j) = b ij and B + is a diagonal matrix with\nThe IGMRF specification of this model would therefore imply the log-density of y as\nwhere \u03bb 1 \u2265 \u00b7 \u00b7 \u00b7 \u2265 \u03bb n are the ordered eigenvalues of (B + \u2212 B).\nBecause (B + \u2212 B)1 = 0, where 1 is a vector of ones, we see that the precision matrix\nis singular, and the ICAR can only be utilized as an improper prior. One possible solution is to modify the matrix \u03c4 (B + \u2212 B), by adding a spatial dependency parameter. For this ICAR parameterization, the matrix \u03c4 (B + \u2212 \u03c1B) is guaranteed to be positive definite for \u03c1 \u2208 (\u22121, 1). However, there are a two major drawbacks to introducing a spatial dependency parameter \u03c1. First, \u03c1 must be quite large to generate significant spatial dependency, and a uniform prior distribution often leads to diffuse posterior distributions for \u03c1. Second, Wall (2004) notes undesirable properties of the pairwise correlations of the locations on an irregular lattice as \u03c1 is varied throughout the space (-1,1). Hughes and Haran (2013) utilize an orthogonalization argument derived in Reich et al. (2006) by considering orthogonal spatial smoothing using a generalized Moran basis. Hughes and Haran (2013) smooth orthogonal to X by considering an eigenvector basis of P c BP c for the latent process space, where\nThis allows orthogonal smoothing to X while accounting for the underlying lattice structure of the data. In our formulation of a SHEL model on a lattice, we utilize this structure. We define M as an n \u00d7 q matrix with the columns being the eigenvectors corresponding to the q largest nonzero eigenvalues of the matrix P c BP c . The process Y n can then be modeled in a rank-reduced form,\nwhere Y * q is the rank-reduced process. This model is useful because, under weak conditions, the prior of Hughes and Haran (2013) \nthat B is the adjacency matrix for a first order IGMRF (i.e., rank (B) = n \u2212 1). Then, a sufficient condition for M \u2032 (B + \u2212 B)M to be positive definite is that the design matrix X contains a column corresponding to an intercept term.\nA proof of Theorem 1 can be found in Appendix A. Theorem 1 implies that the Hughes and Haran (2013) lattice prior will yield a proper prior suitable for use with EL methods on a lattice whenever one includes an intercept term in the design matrix. The main advantage of this model over other lattice priors is that this basis simultaneously allows for dimension reduction. Let \u2308x\u2309 denote the the ceiling of x -the smallest integer greater than or equal to x. The recommendation of Hughes and Haran (2013) is that the eigenvec-tors associated with the largest q = \u23080.1n\u2309 eigenvalues of the matrix P c BP c are typically sufficient to allow accurate estimation of the fixed effects, though there is some sensitivity to the actual proportion used. In our analyses, which are of much lower dimensionality than those considered in Hughes and Haran (2013) , we have found that the prediction is markedly better in terms of mean squared prediction error (MSPE) when we utilize every eigenvector of P c BP c associated with a positive eigenvalue. This strategy leads to substantially decreased computation time in the SHEL framework, along with simpler tuning of the Markov chain Monte Carlo (MCMC) algorithms employed in this model relative to the full-rank implementation."}, {"section_title": "Bayesian Model Estimation", "text": "EL computation is well established. As early as 2001, several methods had been developed (Owen, 2001) , with additional methods building off of this early research. Chen et al. (2002) is notable in that it provides a method for computing the EL with guaranteed convergence.\nWe propose a straightforward approach that allows the built-in optimization functionality of the R programming language (R Core Team, 2013) to be utilized for fast computation.\nAn issue to overcome is selecting starting parameter and latent values that allow the EL to be computed. We propose setting the process model values to zero, and utilizing the maximum empirical likelihood estimates (MELEs) of the fixed effects as the starting values of the chain. The gmm package in R (Chauss\u00e9, 2010) can be used to rapidly obtain these starting values. MCMC computations can then proceed via standard Metropolis-Hastings methodology for any parameter appearing in the estimating equations for the EL portion of the model.\nIn the case where the model defined by the estimating equations approach to EL as outlined in (3) is not over-or under-determined, the solution for \u03bb = {\u03bb 1 , . . . , \u03bb J }, if it exists, is unique for a given value of \u03b8 = {\u03b8 1 , . . . , \u03b8 R }. The EL constraints for \u03bb are\n..,J . This structure can be exploited by using the optim function in R in order to find the minimum of\nIf the value of this objective function is zero, we can verify that the solution for {\u03bb 1 , . . . , \u03bb J } yields a set of weights {w i , i = 1, . . . , n} in the simplex of (2), by checking that n i=1 w i = 1 and that w i > 0 for all i. When these conditions are met, we have the value of the EL as n i=1 w i . When using the optim function, which is the default fitting method for the gmm package, one must decide on a numerical threshold for deciding when { n i=1 w i m j (z i , \u03b8 j ) = 0} j=1,...,J and n i=1 w i = 1 are satisfied. We have had success in evaluating this term by considering { n i=1 w i m j (z i , \u03b8 j ) < \u01eb} j=1,...,J and (\nBecause the data model is non-analytic, Gibbs sampling is not possible for any of the parameters, as none of the full conditional distributions are of standard form. Therefore, we utilize Metropolis-Hastings within Gibbs (MH) sampling for all of the model parameters.\nSpecifically, for our analyses, we use a random walk MH sampling algorithm having Gaussian proposals with variances tuned based on the empirical covariances from a pilot chain (Gelman et al., 2013 ). An example of the algorithm can be found in Appendix B."}, {"section_title": "Simulation Studies", "text": "Of particular interest is the performance of the SHEL paradigm in spatial prediction, and so we conduct a simulation study to assess the predictive performance of the SHEL framework as compared to parametric models."}, {"section_title": "Study 1: The SHEL Fay-Herriot Model", "text": "The FH model (Fay and Herriot, 1979 ) is a SAE model and can be written as\nwhere Z i is a design unbiased survey estimate of \u03b8 i , the superpopulation parameter of interest at location i, and \u01eb i is a spatially referenced sampling error with mean zero and known variance \u03c3 2 i . Auxiliary information at location i is denoted by x i , and y = (y 1 , . . . , y n ) \u2032 denotes a vector of spatially referenced random effects.\nAdditionally, one typically assumes that, for i = 1, . . . , n, \u01eb i are independent and that \u01eb = (\u01eb 1 , . . . , \u01eb n ) \u2032 follows a multivariate normal distribution. Chaudhuri and Ghosh (2011) employed a Bayesian nested error regression in the FH framework that relaxed this assumption. Their analysis is demonstrated using two possible priors on y. The first prior is an independent and identically distributed (i.i.d.) Gaussian distribution, whereas the second prior is a Dirichlet process (DP) prior with a Gaussian base measure. They note sensitivity in their analysis to the prior specification of the hyperparameters in the prior for y, as well as to the prior for \u03b2 0 -the fixed effect associated with the intercept in Equation (7). The actual estimating equations we utilize in the EL for estimating {\u03b2, Y } are:\nIn the simulation study presented here, we compare the prediction of the SHEL FH model and the independence model of Chaudhuri and Ghosh (2011) on data that behave similar to those of our data analysis in the FH analysis of Section 5.1. We do not utilize their DP prior model due to concerns of computational considerations associated with repeated estimation within a full simulation study and the fact that the DP process model performs similar to the independence model in the analysis of Chaudhuri and Ghosh (2011) . To simulate data, random effects y i are generated based on a Hughes and Haran (2013) lattice prior with a precision parameter equal to the posterior mean of \u03c4 in the analysis of Section 5.1.\nThen data model weights {w i } are generated based on the posterior means of the fixed effects parameters of that analysis. This gives an EL to generate data that will have similar properties to the data in Section 5.1. We generate 125 datasets in this way and perform a leave-one-out MSPE analysis on each dataset. For each location within a given dataset, the model is run for 11,000 iterations, with 1,000 iteration discarded as burn-in (i.e., 10,000 used for our analysis). To assess convergence, we visually inspect a random subset of sample chains from the 125 \u00d7 115 analyses and note that no lack of convergence was detected.\nFor the independence prior, we used the specification y i \u223c N(0, A) with A \u223c IG(1, 1),\nThe constant g represents Zellner's g prior (Zellner, 1986) , here set to 10. The prior means, \u03b2 * , are the weighted least squares (WLS) estimates from a regression of the auxiliary information on the data assuming no latent effects are present.\nThese prior specifications represent an identical formulation as in Chaudhuri and Ghosh (2011) . For comparison, the SHEL model utilizes the Moran basis, with the vague priors \u03c4 \u223c Gamma(1, 1), \u03b2 \u223c N(\u03b2 * , g \u22121 \u03c4 \u22121 I 2 ), and y = My * where y\nWe define MSPE as "}, {"section_title": "Study 2: Breeding Birds", "text": "To illustrate an example with continuous spatial reference and non-Gaussian data we utilize the example described in Wikle (2010) . In particular, the simulation study we perform is designed similar to the North American Breeding Bird Survey (\"Dove\") data analysis performed of Section 5.3 and, to assess the performance of the SHEL model relative to a parametric specification, we use the following model for comparison\nWe modeled y = (y 1 (s 1 ), . . . , y n (s n )) \u2032 as multivariate Gaussian with mean zero and covariance function \u03c3 2 y r(s i , s j ; \u03c6), where r(s i , s j ; \u03c6) = exp(\u2212||s i \u2212 s j ||/\u03c6). We placed a N(0, 100 2 )\nprior on \u03b2, a Unif(0.01, 100) prior on \u03c3 The estimating equations for the SHEL model are based on the identities \u03b8 i = V (\u03b8 i ) = exp{\u03b2 + y(s i )} in Equation (3). This is a SHEL specification based on an overdispersed\nPoisson model, where we have the conditional mean, \u03b8 i , and variance of Z i |\u03b8 i equal.\nWe assess the predictive performance of the model by means of a leave-one-out mean squared prediction error MSPE experiment. In order to generate data that have similar properties to the Dove data, we first analyzed the data according to the SHEL model we propose. Next, we computed the posterior means, \u03b2 and y, from this analysis. These values were then used to compute average weights {w i } which correspond to an EL based on the posterior parameter means. These weights were then used, in turn, to generate new data.\nNew random effects were generated from the spatial prior used in the analysis with \u03c3 (2011), and a model using the DP prior. For these data, there was no available transformation that satisfied the normality assumption of the data, but we perform a na\u00efve parametric FH analysis modeling \u01eb as independent and normally distributed random errors for comparison.\nThe prior for the DP process prior was y i |G \u223c G, G|A \u223c DP(\u03b1, G), where \u03b1 \u2261 1 as in Chaudhuri and Ghosh (2011) and G represents a Gaussian base measure. For computational reasons, we approximate the DP prior using a finite mixture of normals. For these data, we considered possible cluster counts of 20, 50, and 115 (the full data size), and found our results to be robust in terms of MSPE to the number of clusters we select a priori. However, Chaudhuri and Ghosh (2011) utilize an informative prior on A, and we note substantial sensitivity to this prior specification for our data. We assumed several prior specifications for A in their framework, and we present the results for A \u223c IG(2, 1000), which yielded the lowest MSPE of any prior we tried (MSPE of 0.128). The prior specification A \u223c IG(2, 10), which is of similar strength to that of Chaudhuri and Ghosh (2011) , yielded an MSPE of 0.182, which was worse than the parametric analysis. Additionally, we attempted A \u223c IG(1, 1), which is more vague than the priors used by Chaudhuri and Ghosh (2011) , and found that it yielded sample chains with questionable convergence, though it yielded converged chains for the independence prior of Chaudhuri and Ghosh (2011) and for the SHEL model. All other priors in these analyses were set identical to the simulation study in Section 4.1. In order to assess the relative importance of the spatial structure, we additionally consider a spatial parametric FH model with the exact same prior specifications as our SHEL model but with a Gaussian data distribution. Table 1 reports summary statistics for the posterior distributions of these models, as well as the mean posterior variances for the mean posterior predicted variances for \u03b8 = {\u03b8 1 , . . . , \u03b8 n }. All model results are based on 11,000 MCMC iterations with the first 1,000\niterations discarded for burn-in (i.e., 10,000 iterations total). Convergence was assessed through visual inspection of the sample chains, with no deviations from convergence detected.\nWe additionally performed a leave-one-out MSPE analysis for each model. The parametric model performs nearly as well in terms of MSPE as the models of Chaudhuri and Ghosh (2011) . The DP prior model of Chaudhuri and Ghosh (2011) , performs nearly equivalently to their independence model in terms of MSPE. In summary, the SHEL model, which explicitly accounts for the spatial correlation in these data, performs markedly better than all three other models, and yields a MSPE of 0.066, while the best fitting model of Chaudhuri and Ghosh (2011) yields an MSPE of 0.128, which is a reduction in MSPE of 48.4%. These results strongly indicate that the SHEL model with the Hughes and Haran (2013) lattice prior is the preferred model for these data. Additionally, the spatial parametric FH model yielded a MSPE of 0.076, underscoring the importance of accounting for the spatial correlation in these data. The differences in MSPE for each location are plotted spatially in Figure 1 and clearly illustrate that the SHEL model provides estimates that deviate less from the observed data in the high population areas near St. Louis, MO and Kansas City, MO. These cities greatly influence the surrounding areas, and the explicit spatial autocorrelation embedded in the SHEL FH model greatly aids in the estimation of these areas. Due to the similarity in spatial performance, the spatial parametric FH is not shown in this figure."}, {"section_title": "The North Carolina SIDS dataset", "text": "The North Carolina Sudden Infant Death Syndrome (SIDS) dataset is a frequently analyzed areal dataset in spatial modeling. We utilize the data collected over the period from 1974-1978. After accounting for the counts of live births in North Carolina, there is still a significant clustering of events (e.g., Getis and Ord, 1992, Kulldorf, 1997) . For this particular dataset, several parametric models have been considered. For example, Symons et al. (1983) first attempted to model the spatial structure in these data based on high risk and low risk populations. More recent work has considered models with more explicit formulations. The parametric model we utilize is\nwhich is suggested by Cressie and Chan (1989) . Here E i is the expected SIDS count in each county, which is computed as\nwhere N i is the total number of births in county i. We utilize an intercept, and the proportion of births in each county that resulted in non-white children as covariates. A Tukey-Freeman transformation was applied to the proportion of non-white births, as suggested by Cressie and Chan (1989) . This data is well modeled by an overdispersed Poisson distribution, with the exception of a single extreme outlier, which is Anson county. In the analysis performed by Cressie and Chan (1989) , this location was left out of the analysis. More recently, Sengupta and Cressie (2013) dealt with this outlier in the empirical Bayesian hierarchical model setting by modeling the data through a non-stationary spatial process over 13 regions, where the correlation between these spatial regions was built on Euclidian distances. In this analysis, Anson county was considered its own region and included in the model. Since our goal is to demonstrate the robustness of the SHEL model (in terms of MSPE) to extreme outliers, we compare our approach to Cressie and Chan (1989) , as they removed the outlier from their analysis. That is, we propose a relatively simple way to handle this outlier: depart from the Poisson distribution, and use EL methods to obtain estimates for {\u03b2, y}|Z. We propose estimating equations "}, {"section_title": "North American Breeding Birds Survey", "text": "Counts of mourning doves in and near Missouri in 2007 from the North American Breeding Bird Survey represent a highly overdispersed spatially point referenced count dataset (mean=30.8, variance=221.7). Counts are collected on 44 sampling routes containing 50 stops each. All routes are 39.2 km in length and each count is assigned to the centroid of the route (see Robbins et al., 1986 , for a comprehensive description). These data have been previously analyzed using a generalized linear mixed model (GLMM) framework by considering an overdispersed Poisson outcome, with the amount of overdispersion dictated by a latent Gaussian spatial process with the covariance parameterization found in Section 4 (Wikle, 2010) . Modeling is performed equivalently to the simulation study in the previous section in terms of both the model and prior specifications. The results for both models are based on 10,000 MCMC iterations after 1,000 iterations of burn-in, again convergence was assessed through visual inspection of the sample chains with no deviation from convergence detected.\nResults from both the parametric and SHEL models can be found in Table 3 . There are two main differences in the model outcomes. The point estimates of the SHEL model indicate lower spatial variance as well as increasing spatial decay as compared to the parametric model. This would argue that the SHEL analysis detects less spatial structure than the parametric method. It is worth noting that this is likely due to the flexibility of the empirical data model, which serves to account for some of spatial structure of the data. Secondly, we again see an improved predictive ability of the SHEL framework for these data, as indicated by the leave-one-out MSPEs. This decrease is noticeable, with the leave-one-out MSPE for the SHEL model being 195.4, nearly a 15% reduction over the 228.5 for parametric model.\nThe results are displayed in Figure 3 and again demonstrate superior prediction in terms of MSPE in the majority of locations analyzed."}, {"section_title": "Discussion", "text": "In this paper, we have proposed a general framework for including empirical data models in the BHM framework. We have shown that the SHEL model can explicitly accommodate spatial correlation on irregular lattices as well as handle spatial point-referenced data not collected on a regular grid, both of which are novel models. The simulation study in Section 4 demonstrated improved predictive performance and corroborated the results for the spatial point-referenced North American Breeding Birds Survey data presented in Section 5. In order for the models we propose to be useful in practice, we have provided detailed discussion regarding sampling and computational considerations.\nImportantly, we have shown that the SHEL framework outperforms standard parametric analyses in three distinct and unrelated case studies. In every case, the SHEL model has outperformed parametric models in terms of out of sample prediction as measured by reduction in MSPE of at least 15%. In the case of the SIDS data and the ACS data, we have outperformed a standard analyses by a reduction of 30% in terms of MSPE. While the SHEL paradigm can certainly be used for inference, EL methods are known to produce asymptotic credible intervals that slightly undercover the true parameter values in the mean structure of multiple regression models (Fang and Mukerjee, 2006) . Therefore, one should take care when interpreting the credible intervals produced by such methods.\nThe SHEL model overcomes one of the main difficulties in standard EL analysis, which is handling dependence in the outcomes. That is, the SHEL model places the dependence structure at the process and parameter stages of the hierarchy. This makes the framework extremely advantageous for a wide range of problems where parametric modeling assumptions may be difficult to verify. Accordingly, the SHEL model provides a unified BHM framework that is capable of handling a broad range of dependence structures, including spatial dependence, as illustrated here. In short, by casting the SHEL model within the BHM paradigm we provide an extremely flexible approach that takes advantage of conditional thinking and is, therefore, capable of effectively modeling parameters. In addition, as a byproduct of the BHM specification, we are easily able incorporate relevant scientific information, while providing a quantification of uncertainty of our predictions."}, {"section_title": "Appendix A: Proof of Theorem 1", "text": "Let C(A) denote the column space of a matrix A and N (A) represent the null space. Assume that X contain a column equal to the one vector, which implies that the model contains an intercept. We proceed by contradiction. First, suppose there exists v = 0 such that\nLet P\u039bP \u2032 represent the eigenspace decomposition of (B + \u2212 B). Then we have\nfor some v = 0. This implies\nfor this choice of v. Now, we know that, for the ICAR specification we have chosen,\nNote that\nTogether with (A.2), (A.3) implies N (\u039b left as {y * q }. Once generated, we verify that { w i } satisfies (B.1). If it does not, the block of B elements of {y * q } remains at their previous values, and we move to the next block of B elements of {y * q }. Otherwise, perform a Metropolis-Hastings step with the posterior density ratio \u03a5 yq = p(Z| y q * , \u03b2)\u03c0( y q * |\u03c4 ) p(Z|y * q , \u03b2)\u03c0(y * q |\u03c4 )\nWe accept y q * if \u03a5 yq > u yq , where u yq \u223c Unif(0, 1). Repeat this process for every block of B elements of {y * q } until the entire set has been considered."}, {"section_title": "Sampling \u03b2", "text": "We sample \u03b2 using a random walk Metropolis-Hastings step with a multivariate normal proposal \u03b2 \u223c N(\u03b2, \u03a3 \u03b2 ), where the proposal covariance \u03a3 \u03b2 is tuned based on pilot chains. We use the estimating equations \nwhere g is Zellner's g prior and \u03b2 WLS are the weighted least squares estimates of \u03b2. We accept \u03b2 if \u03a5 \u03b2 > u \u03b2 , where u \u03b2 \u223c Unif(0, 1)."}, {"section_title": "Sampling \u03c4", "text": "We sample \u03c4 using a random walk Metropolis-Hastings step with a normal proposal where we have used an IG(\u03b1 1 , \u03b1 2 ) prior distribution for \u03c4 . We accept \u03c4 if \u03a5 \u03c4 > u \u03c4 , where u \u03c4 \u223c Unif(0, 1).\n5. Utilizing (B.1), steps 2-4 are repeated until convergence. "}]
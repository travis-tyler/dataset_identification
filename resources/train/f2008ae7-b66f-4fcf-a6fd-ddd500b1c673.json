[{"section_title": "Abstract", "text": "Brain ageing is associated with morphological changes and cognitive degeneration, and can be affected by neurodegenerative diseases which can accelerate the ageing process. The ability to separate accelerated from healthy ageing is useful from a diagnostic perspective and towards developing subject-specific models of progression. In this paper we start with the 'simpler' problem of synthesising age-progressed 2D slices. We adopt adversarial training to learn the joint distribution of brain images and ages, and simulate aged images by a network conditioned on age (a continuous variable) encoded as an ordinal embedding vector. We introduce a loss to help preserve subject identity despite that we train with cross-sectional (unpaired) data. To evaluate the quality of aged images, a pre-trained age predictor is used to estimate an apparent age. We show qualitatively and quantitatively that our method can progressively synthesise realistic brain images of different target ages."}, {"section_title": "Introduction", "text": "Brain ageing is a complex process characterised by morphological and cognitive changes over a subject's lifespan. This process is influenced by age [18] , neurodegenerative disease(s) [8] , gender [9] , education [4] , and other factors. The separation of these factors is of great value for research and clinical applications to detect early stages of degenerative diseases [6, 13] . One approach to achieve this separation task is to simulate the ageing process w.r.t. different factors, i.e. synthesise brain images given different factors as input [2, 13] . In this paper, we focus on synthesising brain images conditioned on age.\nOne challenge with brain ageing synthesis is inter-subject variation, i.e. different individuals have different brain ageing trajectories. Previous studies used regression [7, 13] to learn population models, which only represented the average brain images of different ages. However, this approach may not traverse a subject-specific ageing trajectory [4] . Another challenge is lack of diverse longitudinal data, since it is difficult to acquire brain images of the same subject at different ages hindering the use of supervised learning. In this paper, we overcome these challenges by proposing an adversarial deep neural network that learns the joint distribution of age and brain images. We introduce, and motivate, a loss function that helps preserve the identity of the subject -a classical problem in synthesis with cross-sectional (unpaired) data [23] and induces progressively modulated changes on the brain. A simplified illustration of the proposed network and some example results are presented in Fig. 1 . Given a brain image and a vector representing the target age difference, our method can synthesise it at an older age. For quantitative evaluation, we train a VGG-like network [17] as an age estimator to predict apparent age given an image. The estimated age is used as a proxy metric to evaluate the quality of output images in terms of age accuracy. We compare our method with conditional GAN [14] and CycleGAN [22] . The results show that we outperform these baselines in terms of age accuracy, and we consistently synthesize visually realistic images. Contributions: 1. We model ageing progression as a conditional network that is trained adversarially from cross-sectional (unpaired) data.\n2. An age embedding mechanism that is used for synthesis and to teach an adversary to learn the joint distribution of age and brain appearance. 3. A regularisation loss to preserve age-modulated subject identity."}, {"section_title": "Related work", "text": "Brain ageing: Previous studies can be classified as: prediction (where ages are predicted from brain images) and simulation (where brain images are synthesised given age as input) [23] . For prediction, convolutional neural networks [5] and Gaussian Process Regression [6] have been used to estimate ages from MRI images as a marker for detecting neurodegenerative diseases. For simulation, [13] used partial regression to learn a model which represents the mean morphological change with age, while [7] proposed a regression method to learn a longitudinal growth model to synthesise population-average brain images of different ages. However, these regression-based methods did not consider subject-specific simulation and their performance was limited by the use of hand-crafted features.\nAdversarial networks: GANs have been widely used in medical image synthesis, with [3] converting MR to CT images and [1, 21] synthesising healthy images from pathological ones. However, these approaches focused on translating images between different discrete states, and did not model a continuous time progression. The progression of Alzheimer's Disease (AD), was approached by [2] with image arithmetic. They synthesised images from random latent vectors and simulated AD progression using linear interpolation in latent space. However, they assumed a linear progression of the disease and did not address the problem of identity preservation. Instead, we directly model age progression, as a non-linear process [18] , and focus on preserving subject identity."}, {"section_title": "Methods", "text": ""}, {"section_title": "Problem overview and notation", "text": "We denote a brain image as x t of age t, and the distribution of brain images of age t as X t , such that x t \u223c X t . Our goal is to synthesise a brain imagex to of desired age t o given an input image x ti of age t i conditioned on the age difference d between input and output\nThe objective is to generat\u00ea x to that is realistic (i.e. the distributionX to of output imagesx to matches the data distribution X to ) and retains the 'identity' of the subject throughout the ageing process. The contribution of our approach, shown in Fig. 2 , is the design of the conditioning mechanism, a loss to preserve age-modulated identity and an adversary that learns the joint distribution of age and brain appearance."}, {"section_title": "Model", "text": "Ordinal encoding of age: we use ordinal vectors to encode age (a continuous variable), to ensure that the mean absolute error between two age vectors positively correlates with age difference [11] . Assuming a max age of 100, we use a 100-d vector v t to encode age t, where the first t elements are 1 and the rest are 0. (Fig. S3 , in the supplemental, shows the benefit of ordinal vs. one-hot encoding.) Model: Our model consists of a Generator and a Discriminator, shown in Fig. 2 . These are detailed below. Note images x ti ,x to and y to represent the input, the aged output and a real older brain image from another subject, respectively. Generator: 'G' takes as input a 2D brain image x ti and an ordinal age vector v d (d = t o \u2212 t i ), and outputs a 2D older imagex to . We condition on v d such that when input and output ages are equal (d = 0) the network is drawn to recreate its input. This works in synergy with our identity-preserving loss described below.\nThe Generator consists of three subnetworks: 'Encoder ' E G , 'Transformer '\nto a bottleneck vector c e1 , and by concatenating c e1 with v d . To keep networks parameters low we empirically set the size of c e1 to 130. Afterwards, to preserve information of x i , and achieve accurate synthetic results, we introduce a skip connection between F e1 and F e2 : F e3 = cat(F e1 , F e2 ), where cat(\u00b7) concatenates the elements of the given tensors along the channel dimension. Finally, the Decoder D G synthesises the aged outputx t from F e3 .x to should manifest the characteristics of brains at age t o whilst preserving the identity of input x ti , i.e. x to should be the brain image of the same subject as x ti at age t o . Discriminator: D contains an Encoder E D and a Transformer T D to condition on target age and a Judge J D to output a discriminator score. Note here we condition on v to , instead of v d , to learn the joint distribution of brain appearance and age, such that it can discriminate real vs. synthetic images of correct age.\nTo summarise, the forward pass for the Generator isx t = G(x ti , v d ), and for the Discriminator is w fake = D(x to , v to ) and w real = D(y to , v to )."}, {"section_title": "Adversarial and identity-preserving training losses", "text": "The overall training loss is defined as:\nwhere L GAN is the GAN loss , L ID is an age-modulated identity-preserving loss and \u03bb ID = 100 the weight of L ID . L GAN pushes the solution towards realistic images of correct age, whereas L ID pushes towards subject-specific synthesis. L GAN is a Wasserstein loss with gradient penalty for stable training [10] :\nwherez t is the average sample defined asz t = x t + (1 \u2212 )y t , \u223c U [0, 1]. First two terms measure the Wasserstein distance between real and fake samples; last term is the gradient penalty. As in [10] we set \u03bb GP = 10. L ID defends against loss of identity, due to lack of longitudinal data and use of L GAN . We offer an illustration in Fig. 3 as motivation, where we show ageing trajectories for two subjects and 3 points A,B and C. We want to 'age' subject 1 of initial age t 1 (point A) to age t 2 (point B), but we do not have ground truth to ensure we stay on the trajectory (of subject 1). Instead, as training data we have images of subject 2 (and of many others) of age t 2 (point C). Without any restrictions, the Generator may learn a mapping from A to C to fool the Discriminator. This will break the identity of subject 1. To alleviate this and encourage mappings from A to B (ie. along the trajectory), we adopt:\nwhere t max and t min are the maximal and minimal age in the training dataset, respectively. The regularisation e \u2212 |to \u2212t i | |tmax \u2212t min | = e \u2212 |d| |tmax \u2212t min | captures that if age difference is small, then the change between x ti andx to should also be small. In the special case of d = 0 it pushes the solution to reconstruct (auto-encode) the input (ie. x ti \u2248x to ). Right panel of Fig. 3 , demonstrates the importance of this loss, via an ablation on training the network without and with L ID ."}, {"section_title": "Experiments", "text": ""}, {"section_title": "Experimental setup", "text": "Dataset and preprocessing: We apply our 2D method on two datasets. We use the Cam-CAN [19] and ADNI datasets [15] . For each dataset, we use FSL [20] Original (27) Fig. 4 . Example results of synthetically aged brain images. Two slices of subjects with age 27, and synthetically aged outputs at different target ages (rows 1 and 3) are shown. The difference (rows 2 and 4) between input and output demonstrates progression.\nto perform brain extraction and volumetric registration to MNI 152 space. We normalise the resulting intensities to [-1,1] . For every 5-year span, we select 38 volumes with 30 used for training and 8 for testing. Thus, there are 360 training and 96 testing volumes for CAM-CAN, and 240 training and 64 testing volumes for ADNI. We select the middle 60 axial slices from each volume and use these 2D slices to perform experiments. Baselines: We set up 2 baselines with conditional GAN [14] and CycleGAN [22] . Since both frameworks only translate images between two discrete styles, for each dataset, we train different models for transforming the youngest group to different target age groups (where each group covers 10 years). Implementation details: The method is implemented in Python using Keras (https://keras.io). The Generator is a U-net [16] with the bottleneck layer modified to be a Transformer. The Discriminator is a ResNet [12] with a latent layer modified as Transformer. The detailed structures are shown in Supplemental. Evaluation metric: Due to lack of sufficient longitudinal data, it is hard to evaluate the synthetic output. As a proxy, we train an age predictor, f pred , to estimate apparent age of outputs, and use the estimated age to evaluate age accuracy, i.e. how close the output is to the desired target age. The age predictor is a VGG-like network [17] with mean absolute error of 3.2 years on training dataset and 5.3 years on testing (detailed structure in supplemental ). Formally, we use predicted age difference (PAD):"}, {"section_title": "Experiments and results", "text": "Ageing progression: We visualise differences between input and output images in Fig. 4 for two subjects (more results in the supplemental, including higher zoom to show sharpness). Observe that the output gradually changes as age increases. At an early stage, the brains do not change much. After around age 52, ageing is accelerated. This observation is consistent with [18] , implying that our method captures known age-modulated changes in the brain. Comparison with baselines: We apply the pre-trained age predictor to quantitatively evaluate the proposed method and compare it with baselines. The results for each age group are shown in Table 1 . Conditional GAN and CycleGAN are trained as described in Section 4.1, to synthesise images of a particular group. Instead, our method can generate images of any age. Therefore, in order to make it comparable with the baselines, we use the middle age of each group as the target age. The quantitative results show that our method, can achieve more age-consistent output compared to the baselines. The higher PAD in the early stage (before age 50) could be caused by the slow rate of brain ageing, i.e. when ageing process is slow, prediction becomes more difficult.\nLongitudinal evaluation: We also evaluated our method using a small number (15) of follow-up studies from ADNI which start from an age between 55-60 years and end at an age larger than 60. The MAE between the ground-truth images and predicted aged images are 0.08, 0.21 and 0.20 for proposed model, conditional GAN and CycleGAN, respectively. These results show that our method synthesizes realistic aged images and preserves subject identity well."}, {"section_title": "Conclusion", "text": "We proposed a deep adversarial neural network to model brain ageing. The method learns the joint distribution of age and brain morphology. We also proposed a loss to encourage the preservation of subject identity. Due to lack of longitudinal data, quantitative evaluation of synthetic images remains challenging. Here, we used an age predictor to predict apparent age of output images as a proxy to evaluate quality. Both qualitative and quantitative results show that our method can smoothly and consistently simulate subject-specific ageing.\nWe evaluated on 2D healthy brain images. As future work, we envision involving 3D data and other factors (e.g. gender). A longitudinal and diverse dataset with large age span will be ideal for evaluation, however, this is currently lacking as a community resource."}]
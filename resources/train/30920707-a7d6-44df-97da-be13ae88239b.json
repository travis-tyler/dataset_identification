[{"section_title": "Abstract", "text": "In recent years, longitudinal neuroimaging study has become increasingly popular in neuroscience research to investigate disease-related changes in brain functions, to study neurodevelopment or to evaluate treatment effects on neural processing. One of the important goals in longitudinal imaging analysis is to study changes in brain functional networks across time and how the changes are modulated by subjects' clinical or demographic variables. In current neuroscience literature, one of the most commonly used tools to extract and characterize brain functional networks is independent component analysis (ICA), which separates multivariate signals into linear mixture of independent components. However, existing ICA methods are only applicable to cross-sectional studies and not suited for modeling repeatedly measured imaging data. In this paper, we propose a novel longitudinal independent component model (L-ICA) which provides a formal modeling framework for extending ICA to longitudinal studies. By incorporating subject-specific random effects and visit-specific covariate effects, L-ICA is able to provide more accurate estimates of changes in brain functional networks on both the population-and individual-level, borrow information across repeated scans within the same subject to increase statistical power in detecting covariate effects on the networks, and allow for model-based prediction for brain networks changes caused by disease progression, treatment or neurodevelopment. We develop a fully traceable exact EM algorithm to obtain maximum likelihood estimates of L-ICA. We further develop a subspace-based approximate EM algorithm which greatly reduce the computation time while still retaining high accuracy. Moreover, we present a statistical testing procedure for examining covariate effects on brain network changes. Simulation results demonstrate the advantages of our proposed methods. We apply L-ICA to ADNI2 study to investigate changes in brain functional networks in Alzheimer disease. Results from the L-ICA provide biologically insightful findings which are not revealed using existing methods."}, {"section_title": "Introduction", "text": "Brain functional network analysis has been widely used in neuroimaging studies to reveal organization architectures of human brain. In functional imaging studies, neural activity is often captured by a series of 3-D fMRI brain images where the observed data represent the combinations of signals generated from various brain functional networks. One of the major objectives of fMRI-based network analysis is to decompose the observed series of brain images to identify underlying networks and characterize their spatial patterns and temporal dynamics. Independent component analysis (ICA) is one of the most commonly used tools for this purpose. As a special case of blind source separation, ICA decomposes observed fMRI signals into linear combinations of latent spatial source signals that are statistically as independent as possible. These latent independent components correspond to various functional networks. The popularity of the ICA method is mainly due to the following reasons. As a multivariate approach, ICA can jointly model the relationships among multiple voxels and hence provide a tool for investigating whole brain connectivity. Unlike second-order statistical methods such as PCA, ICA takes into account higher-order statistics, and the spatial statistical independence assumption of ICA is well-supported by the sparse nature in typical fMRI activation patterns (Calhoun et al., 2001a; \u2606 Data used in preparation of this article were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu) . As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at: http://adni.loni.usc.edu/wp-content/uploads/how-to-apply/ADNI-Acknowledgement-List.pdf. Smith, 2004) . Furthermore, ICA is a fully data-driven approach that does not require a priori temporal or spatial models. This makes ICA an important tool for analyzing resting-state fMRI where there is no experimental paradigm (beckmann et al., 2005) . The classical ICA model was first applied to neuroimaging studies for single subject fMRI data decomposition (Mckeown et al., 1998) . Some extensions referred as group ICA (Calhoun et al., 2001a) have been proposed to decompose the multiple-subject fMRI data. One commonly used group ICA framework is the temporal concatenation group ICA (TC-GICA) which stacks subjects' fMRI data in the temporal domain and then decompose the concatenated group data via ICA Calhoun et al., 2001a; Guo and Pagnoni, 2008) . The main limitation of TC-GICA is the assumption of the homogeneity in spatial distribution of the networks across subjects while studies have shown that functional networks can vary considerably due to subjects clinical, biological and demographic characteristics (Zhao et al., 2007; Greicius et al., 2004, among others) . To address this limitation, a hierarchical ICA framework has been proposed to directly account for between-subject differences in group ICA decomposition and further allows for modeling subjects' covariate effects in ICA (Guo and Tang, 2013; Shi and Guo, 2016; Lukemire et al., 2018) . All the aforementioned ICA methods are developed for cross-sectional imaging studies where subjects are only scanned once during the study.\nIn recent years, longitudinal studies have become increasingly popular in the neuroscience community. In such studies, brain imaging such as fMRI scans from the same individual are acquired repeatedly at multiple time points including the baseline as well as follow-up visit times. Within-subject changes in brain images across different time points provides great insights into effects and causal relationships in investigating changes in brain networks related to disease progression, treatment or neurodevelopment. By taking the advantage of using each subject as his/her own control, longitudinal studies are well-known to have the potentials to provide more reliable and significant scientific findings than cross-sectional studies. Existing longitudinal imaging analysis often focus on modeling fMRI brain activation or structural MRI volumetric measures across time (Calhoun et al., 2001b; Dettwiler et al., 2014; Lee et al., 2015) . There has also been some work on longitudinal analysis of brain connectivity, which mainly involve modeling pairwise connectivity measures or network summary measures from a per-specified network structure (Dai et al., 2017; Wu et al., 2013; Li et al., 2009) . However, methods are lacking for conducting longitudinal ICA that jointly decompose the subjects' repeatedly measured fMRI data, extract the underlying brain functional networks and studying the longitudinal effects on brain networks.\nExisting group ICA methods are not suitable for modeling repeated measured images in longitudinal studies. There are only a couple of ad- Fig. 1 . Schematic illustration of the hierarchical modeling framework of L-ICA. (A) the first level model of L-ICA with N subjects and K visits where each subject/visitspecific fMRI data is decomposed into q subject/visit-specific ICs, here q \u00bc 2 for illustration purpose. (B) the second level model of L-ICA for one specific IC where the subject/visit-specific ICs are modelled in terms of population-level source signals, subject specific random effects, visit effects and visit-specific covariate effects.\nhoc strategies for longitudinal ICA decomposition. The first approach is to conduct ICA separately at each time point and then take the ICs extracted from different time points for secondary longitudinal analysis. This separate analysis approach has limited capacity to evaluate changes in functional networks across time because 1) independent components do not have a natural order, it is difficult to identify matching components across different time points, especially in resting-state fMRI. 2) ICA algorithms usually have random elements in that they may find different local minima across different runs (Himberg et al., 2004) . This reduces the comparability of the ICs extracted separately at each visit. Another major drawback of the approach is that it ignores within-subject correlations among repeatedly measured data, which results in considerable loss of statistical power in testing covariate effects. The second ad-hoc approach is to adopt the TC-GICA framework by stacking all subjects' repeatedly measured images into a single group data matrix and performing ICA decomposition to extract common group spatial source signals. Then, subject/visit-specific IC maps are reconstructed via post-ICA analysis such as the dual regression. The longitudinal effects are then evaluated based on the reconstructed subject/visit-specific ICs. The limitations of the TC-GICA approach are that it ignores the between-subject variability in the ICA decomposition, does not take into account the random variabilities introduced in reconstructing subject/visit-specific IC maps and does not account for within-subject correlations among repeated scans in ICA decomposition. These limitations lead to loss of accuracy and efficiency in estimating and testing covariate effects on brain networks in longitudinal studies.\nIn this paper, we propose a longitudinal ICA (L-ICA) model that incorporates subject-level random effects and the time-dependent covariate effects in ICA decomposition to investigate temporal changes in brain networks and their associations with subjects clinical or demographic Fig. 2 . Comparison between the proposed L-ICA and the TC-GICA based approach for estimating the population-level IC maps at baseline and the last visit (N \u00bc 20, low subject/visit-specific random variability): (A) truth, (B) L-ICA estimates and (C) estimates from TC-GICA. Column (i) represents the IC maps at baseline; Column (ii) represents the IC maps at last visit; Column (iii) represents the longitudinal trends for activated voxels (where each line represents a voxel) in the first IC (IC1). Results show that L-ICA provides more accurate estimates than TC-GICA at each visit and more precisely captures the voxel-specific longitudinal trend.\ncovariates. The L-ICA is a hierarchical model where the first-level of L-ICA decomposes a subject's fMRI data obtained at a visit into a linear mixture of subject/visit-specific spatial source signals or ICs, and these ICs are then modelled at the second-level of L-ICA in terms of populationlevel baseline source signals, visit effects, covariate effects, subjectspecific random effects and subject/visit-specific random variability. To the best of our knowledge, L-ICA is the first model-based extension of ICA for longitudinal imaging analysis. L-ICA is able to account for withinsubject correlations among repeated scans, provide more accurate estimates of changes in brain functional networks on both the populationand individual-level, and increase statistical power in detecting covariate effects on networks. Furthermore, L-ICA provides model-based prediction for changes in brain networks related to disease progression, treatment or neurodevelopment.\nFor model estimation, we propose an exact EM algorithm which is fully traceable and simultaneously provides the estimation on population-level spatial maps and subject/visit-specific ICs. Furthermore, we propose a subspace-based approximate EM algorithm to provide more efficient computation. Results from the simulation studies and real data analysis show that the approximate EM algorithm significantly reduces the computation time while maintaining high estimation accuracy comparable to the exact EM. Moreover, we develop a statistical inference procedure for testing covariate effects in L-ICA, which demonstrates lower type I error and higher statistical power than the existing testing method based on TC-GICA. We apply the L-ICA method to investigating changes in functional networks in ADNI2 longitudinal rs-fMRI study. Results from L-ICA showed differential temporal changing patterns between Alzheimer and control groups in relevant brain networks, which is not revealed by existing ICA methods. This paper is organized as follows. The methodology of L-ICA is presented in section 2 which includes the L-ICA model specification, estimation via the exact EM algorithm and the approximate EM algorithm, and the inference procedure. In section 3, results from the simulation study are presented. Section 4 is the real data application of ANDI2 study. Conclusion and discussion are in section 5."}, {"section_title": "Methods", "text": "This section introduces the L-ICA framework, which includes the model specification, EM algorithms and the inference procedure. To set the notation, suppose that in a longitudinal fMRI study, there are N subjects and each of them has K visits during the study. At each visit, a series of T fMRI scans are acquired where each scan represents a 3D brain image containing V voxels. Let\u1ef8 ij \u00bc \u00bd\u1ef9 ij \u00f01\u00de; \u2026;\u1ef9 ij \u00f0V\u00de be the T \u00c2 V fMRI data matrix for subject i (i \u00bc 1;\u2026;N) at visit j (j \u00bc 1;\u2026;K) where\u1ef9 ij \u00f0v\u00de 2 \u211d T represents the centered blood-oxygen-level dependent (BOLD) signal series at voxel v (v \u00bc 1;\u2026;V). Prior to ICA, some preprocessing steps such as centering, dimension reduction and whitening of the observed data are usually performed to facilitate the subsequent ICA decomposition (Hyv\u20ac arinen, Karhunen and Oja, 2001) . Following a PPCA-based preprocessing procedure similar to that used in previous work (Beckmann and Smith, 2004; Shi and Guo, 2016; Guo and Tang, 2013) , we perform the dimension reduction and whitening procedure on\u1ef8 ij to obtain a q \u00c2 V preprocessed data matrix Y ij for subject i at visit j, where q is the number of independent components. Throughout the rest of our paper, we will present the L-ICA model and methodologies based on the preprocessed data."}, {"section_title": "Longitudinal ICA model (L-ICA)", "text": "In this section, we propose a longitudinal ICA (L-ICA) model to jointly decompose repeated measured fMRI data acquired across multiple visits. The L-ICA is developed under a hierarchical modeling framework. We present a schematic illustration of the L-ICA in Fig. 1 . The first level of L-ICA decomposes the subject/visit-specific fMRI data into a product of subject/ visit-specific spatial source signals and temporal mixing matrix. This allows capturing the variabilities of the functional networks across subjects and across visits. We also include a noise term in the first level ICA model to account for residual variabilities in the fMRI data that are not explained by the extracted ICs, which is known as probabilistic ICA (Beckmann and Smith, 2004) . Specifically, the first level of L-ICA is as follows, Level 1 : y ij \u00f0v\u00de \u00bc A ij s ij \u00f0v\u00de \u00fe e ij \u00f0v\u00de;\n(1) where s ij \u00f0v\u00de \u00bc \u00bds q) representing the spatial source signal of the \u2113 th IC (i.e., brain functional network) at voxel v for subject i at visit j, A ij is the q \u00c2 q mixing matrix for subject i at visit j, which is commonly assumed to be orthogonal given that y ij \u00f0v\u00de is whitened (Hyv\u20ac arinen and Oja, 2000) . e ij \u00f0v\u00de is a q \u00c2 1 vector that represents the noise in the subject's data and e ij \u00f0v\u00de $ N\u00f00; E v \u00de for v \u00bc 1; \u2026; V. Prior to ICA, preliminary analysis such as prewhitening (Beckmann and Smith, 2004) can be performed to remove correlations in the noise term and to standardize the variability across voxels (More details about prewhitening can be found in Appendix). Therefore, following previous work (Hyv\u20ac arinen, Karhunen and Oja, 2001; Smith, 2004, 2005; Guo and Pagnoni, 2008; Guo, 2011) , we assume that the covariance for the noise term is isotropic across voxels, i.e. E v \u00bc \u03c3 2 0 I q . At the second-level of L-ICA, we further model subject/visit-specific spatial source signals s ij \u00f0v\u00de as a combination of the population-level source signals, subject-specific random effects, visit-specific covariate effects and subject/visit-specific random variations. That is,\n(2) where s 0 \u00f0v\u00de \u00bc \u00bds 01 \u00f0v\u00de; \u2026; s 0q \u00f0v\u00de' is the population-level spatial source signals. The q elements of s 0 \u00f0v\u00de are assumed to be independent and non-Gaussian. b i \u00f0v\u00de is the q \u00c2 1 subject-specific random effects for q ICs where Table 1 Simulation results for comparing L-ICA method against TC-GICA-based method with 100 simulation runs. Values presented are mean and standard deviation of correlations between the true and estimated: population-level spatial maps, subject/visit-specific spatial maps and subject/visit-specific time courses. The mean and standard deviation of the MSE of the covariate effects estimates are also provided."}, {"section_title": "Subj-Visit Var", "text": "Population-level spatial maps Subject/Vist-specific spatial maps b i \u00f0v\u00de $ N\u00f00; D\u00de with D \u00bc diag\u00f0\u03bd 2 1 ; \u2026; \u03bd 2 q \u00de. The subject-specific random effects help capture the within-subject correlations among the scans repeated acquired on the same subject at different visits, (Verbeke, 1997; Cheng et al., 2014; Gao et al., 2017a,b) . \u03b1 j \u00f0v\u00de is a q \u00c2 1 visit effects parameter representing the population-level changes in spatial source signals from baseline to the jth visit. x i \u00bc \u00bdx i1 ; \u2026; x ip 0 is the p \u00c2 1 subject-specific covariate vector which may contain a subject's clinical and demographic information such as disease group, gender, age, etc. \u03b2 j \u00f0v\u00de is a p \u00c2 q parameters matrix reflecting how subjects' covariates x i modulate the subject/visit-specific brain networks. Finally, \u03b3 ij \u00f0v\u00de is a q \u00c2 1 zero-mean Gaussian random vector, i.e. \u03b3 i \u00f0v\u00de$ iid N\u00f00; \u03c4 2 I q \u00de , capturing the residual random variability among subject/visit-specific brain networks after adjusting for the other effects in the model. In the Level 2 model, by including the subject-specific random effects, L-ICA is able to borrow information among the multiple visits within the same subject to obtain more accurate estimate of unique patterns in brain networks specific to the individual. L-ICA incorporates the visit-specific covariate effects to allow flexibly modeling time-varying covariate effects on subjects' brain networks in a longitudinal study."}, {"section_title": "Source signal distribution model", "text": "We specify mixtures of Gaussians (MoG) as our source distribution model for the population-level spatial source signals, s 0 \u00f0v\u00de. MoG has been selected as the distribution for independent components in quite a few ICA analysis (Attias, 2000; Guo, 2011; Guo and Tang, 2013; Shi and Guo, 2016) because it has several desirable properties for modeling fMRI signals. Within each brain functional network, only a small percentage of locations in the brain are activated or deactivated whereas most brain Fig. 3 . Simulation results for testing covariate effects based on 1000 runs with sample size N \u00bc 40 using the proposed L-ICA method (red) and the TC-GICA (blue) based method. We considered two types of hypothesis tests: testing the time-specific covariate effect at a given visit (the 2nd visit), i.e. H 0 : \u03b2 2 \u00f0v\u00de \u00bc 0 (the left column), and testing the time-varying longitudinal covariate effects between the 1st and 2nd visit, i.e. H 0 : \u03b2 1 \u00f0v\u00de \u00bc \u03b2 2 \u00f0v\u00de (the right column). Panel (A) and (B) presents the type I error rates and the statistical power, respectively. The results show that the L-ICA method demonstrates lower type I error and higher statistical power as compared with the TC-GICA based method. areas exhibit background fluctuations (Biswal and Ulmer, 1999) . MoG are well suited to model such mixed patterns. Furthermore, MoG can capture various types of non-Gaussian signals (Xu et al., 1997; Gao et al., 2017a,b; Kostantinos, 2000; Gao et al., 2018) and also offer tractable likelihood-based estimation (McLachlan and Peel, 2004 ). Specifically, for \u2113 \u00bc 1; \u2026; q we assume that the spatial source signal s 0\u2113 \u00f0v\u00de follows a MoG distribution, i.e.\nare the mean and variance parameters of the Gaussian component distributions in the MoG; m is the number of Gaussian components in MoG. The probability density function of MoG\u00f0\u03c0 \u2113 ; \u03bc \u2113 ; \u03c3 2 \u2113 \u00de is P m j\u00bc1 \u03c0 \u2113;j g\u00f0s 0\u2113 \u00f0v\u00de; \u03bc \u2113;j ; \u03c3 2 \u2113;j \u00de where g\u00f0\u00c1\u00de is the pdf of the Gaussian distribution. In fMRI applications, mixtures of two to three Gaussian components can be used to capture the distribution of fMRI spatial signals, with the different Gaussian components representing the background fluctuation and the negative or positive fMRI BOLD effects respectively (Beckmann and Smith, 2004; Guo and Pagnoni, 2008; Guo, 2011; Wang et al., 2013; Guo and Tang, 2013) . Without loss of generality, we denote the first Gaussian component, i.e. j \u00bc 1 , to be the background fluctuation state throughout the rest of the paper. To facilitate derivations with the MoG model, we introduce a voxel-specific latent state variable z \u2113 \u00f0v\u00de which represents which Gaussian component in MoG that voxel v belongs to. Specifically, z \u2113 \u00f0v\u00de takes a value in f1; \u2026; mg with probability p\u00bdz \u2113 \u00f0v\u00de \u00bc j \u00bc \u03c0 \u2113;j \u00f0j \u00bc 1;::; m\u00de. When z \u2113 \u00f0v\u00de \u00bc j, the vth voxel follows the jth Gaussian component distribution in MoG, i.e. p\u00f0s 0\u2113 \u00f0v\u00dejz \u2113 \u00f0v\u00de \u00bc j\u00de \u00bc g\u00f0s 0\u2113 \u00f0v\u00de; \u03bc \u2113;j ; \u03c3 2 \u2113;j \u00de."}, {"section_title": "Maximum likelihood estimation and the EM algorithm", "text": "The parameters in L-ICA model is estimated via maximum likelihood (ML) approach. Based on the hierarchical models in (1) and assuming the independence among voxels, (2) and (3), the complete data loglikelihood for L-ICA model is,\nVg are the preprocessed longitudinal fMRI data across subjects, X \u00bc fx\nVg are the latent independent component spatial source signals,\nVg are the subject-specific random effects and Z \u00bc fz\u00f0v\u00de\nVg are the latent states for MoG source distribution model; the parameters in L-ICA are denoted by \u0398 \u00bc ff\u03b1 j \u00f0v\u00deg; f\u03b2 j \u00f0v\u00deg;fA ij g;E;D;\u03c4;f\u03c0 \u2113 g;f\u03bc \u2113 g;f\u03c3 2 \u2113 g :\nSince our likelihood function involves unobserved latent variables, we consider the expectation-maximization (EM) framework (Dempster et al., 1977) for finding the maximum likelihood estimates of parameters. The EM algorithm is an iterative algorithm that alternates between performing an expectation step (E-step) and a maximization step (M-step). In the E-step, we compute an expectation of the log-likelihood conditioning on the distribution of latent variables given the observed data Y and the current parameter estimates b \u0398\n. At the M-step, the updated maximum likelihood estimates of the parameters is computed by maximizing the expected log-likelihood found on the E-step. The parameter estimates found on the M-step are then used to begin another E-step, and the process is iterated until convergence, i.e. until the parameter estimates b \u0398 \u00f0k\u00de and b \u0398\nin two consecutive iterations are considered sufficiently close. In the following, we present two EM algorithms for solving the L-ICA model. The first is an exact EM method that provides exact evaluation of the conditional expectation in the E-step. We then propose an approximation EM algorithm is computationally more efficient especially with large number of ICs."}, {"section_title": "The exact EM algorithm", "text": "We first develop an exact EM which has an explicit E-step and M-step to obtain ML estimates for the parameters in L-ICA."}, {"section_title": "E-step:", "text": "In the E-step, given the estimated parameter b \u0398 \u00f0k\u00de from the last step, we evaluate the conditional expectation of the complete data loglikelihood as follows,\nwhere \nwhere R represents the set of all possible values of z\u00f0v\u00de , i.e., R \u00bc fz r g m q r\u00bc1 where z r \u00bc \u00bdz r 1 ; \u2026; z r q 0 and z r \u2113 2 f1; \u2026; mg for \u2113 \u00bc 1; \u2026q.\nFollowing this procedure, we can derive explicit form for the conditional distribution for the latent variables and subsequently deriving the conditional expectation Q\u00f0\u0398 b \u0398 \u00f0k\u00de \u00de in (5)."}, {"section_title": "M-step:", "text": "In the M-step, the updated estimates are obtained by maximizing the expected log-likelihood function computed in the E-step, i.e., We have derived explicit solutions for all parameter updates (please see Appendix for details).\nThe steps of the exact EM algorithm is summarized in Algorithm 1. The detailed derivations are presented in the Appendix.\nAfter obtaining the ML estimates b \u0398, we estimate the baseline population-and subject/visit-specific source signals as well as their variability based on the mean and variance of their conditional distributions, i.e., \u00bds 0 \u00f0v\u00de y\u00f0v\u00de; b \u0398 and \u00bds ij \u00f0v\u00de y\u00f0v\u00de; b \u0398. These conditional moments are directly obtainable from the E-step of our algorithm upon convergence and no separate post-ICA steps are required. Based on the estimated covariate effects f b \u03b2\u00f0v\u00deg, we can investigate how subjects' clinical and demographic characteristics affects their brain functional networks and their changes across visits. Furthermore, the L-ICA also provides model-based prediction of the brain functional networks for specific sub-populations at a given visit. For example, for a sub-population characterized by a covariates pattern x \u00c3 , the predicted brain functional networks at the jth visit can be derived by plugging the ML parameter estimates into Level 2 of L-\n2.4. Subspace approximate EM algorithm\nThe exact EM algorithm requires O \u00f0m q \u00de operations at each voxel which is an exponential increase with regard to the number of the ICs extracted in L-ICA, which will be time consuming when q is large. The reason for needing O \u00f0m q \u00de operations is that, the exact EM evaluates the conditional distribution of the latent states z\u00f0v\u00de, i.e. p\u00bdz\u00f0v\u00dejy\u00f0v\u00de, across the whole sample space R of z\u00f0v\u00de , which has a cardinality of m q . To reduce the computation load, we develop a subspace-based approximate EM for L-ICA model. The motivation of the subspace EM is based on the observation from fMRI analysis that the density of p\u00bdz\u00f0v\u00dejy\u00f0v\u00de is mostly concentrated on a subspace R s \u00bc fz r 2 R ; s:t: P \u2113 I\u00f0z r \u2113 6 \u00bc 1\u00de 1g To help understand this subspace, recall that the latent state z r \u2113 takes values in \u00f01; \u2026; m\u00de with the first state, i.e. z r \u2113 \u00bc 1, corresponding to the background fluctuation while other states, i.e. z r \u2113 6 \u00bc 1, corresponding to either positive or negative signals at a voxel. Therefore, the subspace R s corresponds to that a voxel has active signals in at most one of the q ICs. This approximation is reasonable when the source signals are sparse across ICs, i.e. p\u00f0z \u2113 6 \u00bc 1\u00de % 0 for \u2113 \u00bc 1; \u2026; q. Because given the statistical independence of the ICs, p\u00f0z \u2113 \u00c3 6 \u00bc 1jz \u2113 6 \u00bc 1\u00de \u00bc p\u00f0z \u2113 \u00c3 6 \u00bc 1\u00de % 0. That is given a voxel is activated in the \u2113 th IC, the probability for it to be also activated in another IC \u2113 \u00c3 is close to zero. In Shi and Guo (2016) , we have provided theoretical proof that the density of the conditional distribution of the latent states is mostly concentrated in the subspace R s when the source signals are sparse in each IC, which is the case with the fMRI spatial source signals which have been shown to be sparse across the brain for each network (Mckeown et al., 1998; Daubechies et al., 2009) . It is noteworthy to mention that there are some network hubs in the brain that are active in multiple networks. The proposed subspace EM is still able to recover overlapping spatial signals across the ICs, hence capable of identifying brain regions that are involved in multiple functional networks (Shi and Guo, 2016) . The subspace approximation only results in small attenuation on the estimated source signals in the overlapping region.\nIn the subspace EM algorithm, we follow the similar steps as in the exact EM algorithm presented in Algorithm 1. The main difference is that when evaluating and summing across the latent states z\u00f0v\u00de in the E-step and M-step, we replace the whole sample space R with the proposed subspace R s which only has carnality of \u00f0m \u00c0 1\u00deq \u00fe 1. This means the subspace EM only requires O \u00f0mq\u00de operations at each voxel which scales linearly with the number of ICs and is significantly faster than the exponential growth of the exact EM algorithm."}, {"section_title": "Statistical inference for testing covariate effects in L-ICA", "text": "In this session, we propose a statistical inference procedure for testing covariate effects in L-ICA to investigate whether the covariates have significant effects on brain functional networks and their changes across visits. Typically, statistical inference in maximum likelihood estimation is conducted by inverting the information matrix to estimate the variance-covariance matrix of ML estimates of the parameters. However, this standard approach is not feasible when modeling fMRI data with L-ICA because the high dimensionality of the parameter space makes extremely challenge to obtain a reliable inversion of information matrix. To address this issue, we develop a computational efficient statistical inference procedure based on the connection between the L-ICA and multivariate linear models. The proposed inference procedure provides an efficient approach to estimate the variance-covariance matrix of the time-specific covariate effects at each voxel by directly using the output from our EM algorithms.\nSpecifically, let y i \u00f0v\u00de be the ith subjects longitudinal fMRI data which is a qK \u00c2 1 vector obtained by stacking his/her data across visits, i.e. y i \u00f0v\u00de \u00bc \u00bdy i1 \u00f0v\u00de 0 ; \u2026; y iK \u00f0v\u00de 0 0 . By collapsing the hierarchical models, we rewrite the L-ICA model in a non-hierarchical form which is similar to classical multivariate linear model, i.e.,\nwhere\nis the response vector, X \u00c3 i is the design matrix which includes the visit time and the covariates in L-ICA, C \u00c3 \u00f0v\u00de is the parameter matrix which includes the effects parameters in L-ICA such as the visit effects \u03b1 and covariate effects \u03b2, \u03b6 i \u00f0v\u00de is the zero-mean Gaussian random variation term which includes the subject-specific random effects and noise terms in L-ICA. Please see the Appendix for details.\nThe model in (8) \ncan be derived as follows,\n(9) Fig. 4 . L-ICA estimates of subpopulation spatial source signal maps for the DMN for the four disease group across the visits, with the mean baseline age (73.7 year old) and are averaged between genders. All IC maps are thresholded based on the source signal intensity level.\nY. Wang, Y. Guo NeuroImage 189 (2019) 380-400 where W\u00f0v\u00de \u00bc Var\u00f0\u03b6 i \u00f0v\u00de\u00de and can be estimated by plugging ML estimates obtained from the EM algorithm. After deriving the variance estimator for the ML estimates of the parameters in L-ICA, We can then conduct hypothesis testing on the covariate effects the brain networks and their changes across visits. Spe-cifically, we first formulate the hypothesis in terms of linear combinations of the parameters in the L-ICA model, i.e. H 0 : l 0 C \u00c3 \u00f0v\u00de \u00bc 0 vs: H 1 : l 0 C \u00c3 \u00f0v\u00de 6 \u00bc 0 where l is a vector of constant coefficients specified based on the hypothesis that we are testing on. We can then construct the test statistic as, Fig. 5 . L-ICA estimates of subpopulation spatial source signal maps for the medial visual network for the four disease group across the visits, with the mean baseline age (73.7 year old) and are averaged between genders. All IC maps are thresholded based on the source signal intensity level.\nthe test statistic z\u00f0v\u00de will then be compared against its null distribution to derive the p-value for testing the significance of the covariate effects at voxel v. Standard multiple testing correction procedures can be applied to control for family wise error rate (FWER) or the false discovery rate (FDR) when testing the covariate effects across voxels, (Genovese et al., 2002; Chumbley and Friston, 2009; Storey, 2011; Wang et al., 2017) . Fig. 6 . L-ICA estimates of subpopulation spatial source signal maps for the occipital visual network for the four disease group across the visits, with the mean baseline age (73.7 year old) and are averaged between genders. All IC maps are thresholded based on the source signal intensity level."}, {"section_title": "Simulation study", "text": "We conducted three types of simulation studies to 1) evaluate the performance of the proposed L-ICA model as compared with the approach based on the existing TC-GICA framework, 2) to evaluate the performance of the proposed inference method for testing covariate effects on brain networks, and 3) to evaluate the performance of the proposed subspace-based EM algorithm as compared with the exact EM algorithm. Fig. 7 . L-ICA estimates of subpopulation spatial source signal maps for the FPL for the four disease group across the visits, with the mean baseline age (73.7 year old) and are averaged between genders. All IC maps are thresholded based on the source signal intensity level. In this simulation study, we evaluate the performance of the proposed L-ICA model versus the TC-GICA based approach for analyzing longitudinal fMRI. In the simulation, we considered three different sample sizes N \u00bc 10; 20; 60 and each subject has three visits: baseline, visit 1 and visit 2 (K \u00bc 3). The simulated fMRI data were generated from 3 underlying ICs or source signals, i.e., q \u00bc 3, (see Fig. 2 (A) ). For each IC, we generated the source signals fs 0 \u00f0v\u00deg as a 3D spatial map with the dimension of 53 \u00c2 63 \u00c2 3, which was based on three selected slices from a real fMRI imaging data. The source intensity at the activated region in the IC maps was generated from a Gaussian distribution with the mean of 4. The visit specific intercepts, i.e., \u03b1 2 \u00f0v\u00de and \u03b1 3 \u00f0v\u00de , are set to be 2 and 3 respectively for the voxels within the activated IC regions and 0 for other voxels. We then generated a binary covariate for each subject as x i $ iid Bernoulli\u00f00:5\u00de. The covariate effects at the jth visit, \u03b2 j \u00f0v\u00de, were specified using a 2D Gaussian process within the IC regions where the mean level of the covariate effects increased across the 3 visits. Additionally, we generated subject-specific random effects, i.e., b i \u00f0v\u00de, from a zero-mean Gaussian distribution with the covariance matrix of D \u00bc diag\u00f01:0 2 ; 1:1 2 ; 1:2 2 \u00de. For the residual subject/visit-specific variability, i.e., \u03b3 i \u00f0v\u00de, we considered two levels of variability: low (\u03c4 2 \u00bc 0:5) and high (\u03c4 2 \u00bc 4). The time series associated with each IC was generated from real fMRI time courses with the length of T \u00bc 200 and hence represented realistic fMRI temporal dynamics. We generated subject/visit-specific time sources that had similar frequency features but different phase patterns (Guo, 2011; Shi and Guo, 2016) , which mimic temporal dynamics in resting-state fMRI. After simulating the spatial source signal and the temporal mixing matrices for the ICs, Gaussian background noise with a standard deviation of 1 (i.e. E \u00bc I q ) were added to generate observed fMRI data.\nFollowing previous work Guo and Pagnoni, 2008; Guo, 2011) , we evaluate the performance of each method based on the correlations between the true ICs and estimated ICs in both temporal and spatial domains. We report the estimation accuracy for both the population-level as well as the subject/visit-specific source signals. To compare the performance in estimating the covariate effects, we report the mean square errors (MSEs) of b \u03b2\u00f0v\u00de defined by\nb \u03b2 j \u00f0v\u00de \u00c0 \u03b2 j \u00f0v\u00de 2 F averaged across simulation runs. Here k \u00c1 k F is the Frobenius norm for a matrix. Since ICA recovery is permutation invariant, the estimated ICs were matched to the true IC with which it has the highest spatial correlation. We present the simulation results in Table 1 . The results show that L-ICA provides more accurate estimates for the source signals on both the population-and subject/visit-level, by demonstrating higher correlation with the true source signals. L-ICA also provides more accurate estimation of the covariate effects with smaller mean square errors (MSE). Moreover, compared with the TC-GICA, the L-ICA estimates of the source signals and covariate effects are more stable with consistently smaller standard deviations (SD) across simulation runs.\nWe also display the estimated population-level IC maps at baseline and the last visit, i.e. visit 2, based on both methods in Fig. 2 . The L-ICA shows better accuracy in recovering the true activation patterns in the ICs at both visits. The intensity of the source signals in the activated regions in each IC increases from baseline to the last visit in true IC maps. This increase in intensity is well captured by the L-ICA estimated IC maps but not obvious in the TC-GICA estimated IC maps. Furthermore, the estimated IC maps from the TC-GICA approach show \"cross-talk\" between the ICs. In Fig. 2 , we also present the true and estimated longitudinal trends of source signals for activated voxels in an IC. The L-ICA shows better performance than the TC-GICA approach in recovering the temporal changing patterns across voxels."}, {"section_title": "Simulation study II: performance of the proposed inference procedure for testing covariate effects", "text": "In this simulation study, we evaluate the performance of the methods in testing covariates effects on ICs. We simulated fMRI datasets with two source signals (q \u00bc 2), two visits (K \u00bc 2), one binary covariate and the Fig. 8 . L-ICA estimates of longitudinal trends for voxels in the DMN network for each disease group in ADNI2 study. Results show that AD and late MCI (LMCI) patients generally have more changes across visits and that AD group has higher within-network variations than the other disease groups at each visit. sample size of N \u00bc 40. Since we need a large number of simulation runs to estimate the type I error and power in the test, we generated source signal images with the dimension of 20 \u00c2 20 to facilitate computation. The covariate effects at baseline \u03b2 1 \u00f0v\u00de are set to be 0 representing no difference at baseline and visit-specific covariate effects \u03b2 2 \u00f0v\u00de took values in f0; 0:375; 0:5; 0:625; 0:75; 0:875; 1; 1:125; 1:25g for the IC region and are set to 0 for background region.\nWe applied L-ICA method and TC-GICA method to the simulated datasets and tested for covariate effects using both methods. We considered two type of hypothesis tests. The first one aims to test whether the covariate has an effect on the network source signals at a given visit, where the hypotheses are H 0 : \u03b2 2 \u00f0v\u00de \u00bc 0 versus H 1 : \u03b2 2 \u00f0v\u00de 6 \u00bc 0 for the given IC. In the second test, we assess the whether the covariate's effect on the network vary across visits, or equivalently whether the covariate affect the longitudinal changes in the network across visits, where the hypotheses are H 0 : \u03b2 1 \u00f0v\u00de \u00bc \u03b2 2 \u00f0v\u00de versus H 0 : \u03b2 1 \u00f0v\u00de 6 \u00bc \u03b2 2 \u00f0v\u00de. These two type of tests are the most commonly conducted in longitudinal studies. For L-ICA, hypothesis tests were conducted using the test proposed in section 2.5. For TC-GICA based approach, covariate effects were tested by performing post-ICA longitudinal analysis of the dual-regression reconstructed subject/visit-specific IC maps. We estimated the Type-I error rate with the empirical probabilities of not rejecting H 0 at voxels where H 0 is true. We estimated the power of the tests with the empirical probabilities of rejecting H 0 at voxels where H 1 is true.\nWe report the Type-I error rates and the statistical power for detecting covariate effects based on 1000 simulation runs in Fig. 3. The panel (A) in Fig. 3 presents the Type I error rates where the diagonal line represents the nominal level for the type I error corresponding to various significance levels. The proposed L-ICA test demonstrates lower type-I error rates which are closer to the nominal level as compared with the TC-GICA method. For the power analysis presented in panel (B), the L-ICA have much higher statistical power in detecting covariate effects than the TC- Fig. 9 . L-ICA estimates of longitudinal trends for voxels in FPL and visual networks for each disease group in ADNI2 study. Results show that AD and LMCI patients generally have more changes across visits and that AD group has higher within-network variations than the other disease groups at each visit.\nGICA method. Overall, these results indicate that L-ICA provides more reliable and powerful statistical tests for assessing covariate effects on the functional networks."}, {"section_title": "Simulation study III: performance of the subspace EM algorithm for LICA", "text": "In this section, we examined the performance of the subspace approximate EM algorithm as compared with the exact EM algorithm for the L-ICA model. We simulated data for ten subjects and considered three different number of ICs: q \u00bc 3; 5; 10. We summarize the results based on the two EM algorithms in Table 2 . Results show that the accuracy of the subspace EM is comparable to that of the exact EM. The major advantage of the subspace EM is that it was much faster than the exact EM. This advantage becomes more clear with the increase of the number of ICs. For q \u00bc 10 , the subspace-based EM only uses about 2% computation time of the exact EM."}, {"section_title": "Application to longitudindal rs-fMRI data from ADNI2 study", "text": ""}, {"section_title": "Rs-fMRI acquisition and description", "text": "We applied the proposed L-ICA method to the longitudinal rsfMRI data from the Alzheimer's Disease Neuroimaging Initiative 2 (ADNI2) study. One of the main purposes of the ADNI2 project is to examine changes in neuroimaging with the progression of mild cognitive impairment (MCI) and Alzheimer's Disease(AD). Data used in our analysis were downloaded from ADNI website (http://www.adni.loni.usc.edu) and included longitudinal rs-fMRI images that were collected at baseline screening, 1 year and 2 year for four disease groups, i.e. Alzheimer's Disease (AD), late mild cognition impairment (LMCI), early mild cognition impairment (EMCI) and control (CN). A T1-weighted high-resolution anatomical image (MPRAGE) and a series of resting state functional images were acquired with 3.0 T MRI scanner (Philips Systems) during longitudinal visits. The rs-fMRI scans were acquired with 140 volumnes, TR/TE \u00bc 3000/30 ms, flip angle of 80 and effective voxel resolution of 3.3 \u00c2 3.3 \u00c2 3.3 mm. More details can be found at ADNI website (http://www.adni.loni.usc.edu). Quality control was performed on the fMRI images both by following the Mayo clinic quality control documentation (version 02-02-2015) and by visual examination. After the quality control, 51 subjects were included for the following ICA analysis. Among these subjects, 6 are diagnosed with AD, 17 are diagnosed with EMCI, 12 are diagnosed with LMCI and 16 are normal controls (CN) at baseline. For gender, there are 2 (33.3%) males for AD, 10 (58.8%) males for EMCI, 7 (58.3%) males for LMCI and 8 (50.0%) males for CN. The mean (SD) of age for each group is 80.3 (4.5) for AD, 72.8 (6.2) for EMCI, 70.0 (7.1) for LMCI and 74.8 (4.7) for CN. Based on F Fig. 10 . p-values for testing group differences in DMN between AD and CN subjects at each visit. The first row shows the test results based on L-ICA and the second row shows the results from the TC-GICA based approach.\ntests, there is no significant between-group difference in gender (pvalue \u00bc 0.734) but significant difference in age across the groups (pvalue \u00bc 0.008). We included both gender and age as covariates in the following L-ICA modeling to control for any potential confounding effects."}, {"section_title": "Rs-fMRI preprocessing", "text": "Skull stripping was conducted on the T1 images to remove extracranial material. The first 4 vol of the fMRI were removed to stablize Fig. 12. Longitudinal changes from baseline and later visits in DMN within AD, LMCI, EMCI and CN groups. The first column shows the comparison between year 1 versus baseline and the second column shows the comparison between year 2 versus baseline, where the value represents the longitudinal differences in source signal intensity for DMN voxels, i.e. b s j \u00f0v\u00de \u00c0 b s 0 \u00f0v\u00de. Fig. 11 . p-values, thresholded at 0.05, for testing group differences in DMN between EMCI and LMCI subjects at each visit. L-ICA finds between-group differences in DMN at each visit while TC-GICA detects little group differences. the signal, leaving 136 vol for subsequent prepossessing. We registered each subject's anatomical image to the 8th volume of the slice-timecorrected functional image and then the subjects' images were normalized to MNI standard brain space. Spatial smoothing with a 6 mm FWHM Gaussian kernel and motion corrections were applied to the function images. A validated confound regression approach (Satterthwaite et al., 2014; Wang et al., 2016; Kemmer et al., 2015) was performed on each subject's rs-fMRI time series data to remove the potential confounding factors including motion parameters, global effects, white matter (WM) and cerebrospinal fluid (CSF) signals. Furthermore, motion-related spike regressors were included to bound the observed displacement and the functional time series data were band-pass filtered to retain frequencies between 0.01 and 0.1 Hz which is the relevant range for rs-fMRI. Lastly, we performed the prior-ICA preprocessing steps including centering, dimension reduction and whitening as described in section 2."}, {"section_title": "L-ICA model specification for ADNI2 study", "text": "We applied the L-ICA for modeling the preprocessed baseline, 1 year and 2 year rs-fMRI data from ADNI2 study to examine the longitudinal pattern in brain networks among AD, LMCI, EMCI and CN subjects. We decomposed data into 14 ICs. The first level of L-ICA decompose subjects' longitudinal fMRI data as the product of subject/visit-specific mixing matrix and spatial source signals as specified in equation (1). In the second level model of the L-ICA, we included three binary indicators representing subjects' membership in the four disease groups (with the CN as the reference group) as our primary covariates of interest. We also included subjects' gender and baseline age as covariates to adjust for any potential confounding effects. Specifically, The second level for lth IC was specified as \u00f0v\u00de represent the contrast between AD, LMCI and EMCI vs. CN, respectively, at the jth visit. We estimated the parameters in the L-ICA model using the subspace-based EM algorithm implemented by in-house MATLAB programs. To ensure the validity of the results from EM, we initialized the EM algorithm with 20 different initial values and the results were highly consistent."}, {"section_title": "4.4.", "text": "Longitudinal changes in brain networks for ADNI2 study based on L-ICA Among the extracted ICs from L-ICA, we identified components that correspond to well-established brain functional networks (Smith et al., 2009 ) such as the default mode network (DMN), medial visual network, occipital visual network and frontoparietal left network, which are visualized in Figs. 4-7 . In Fig. 4 , we present the L-ICA model-based estimates of the DMN for the four disease groups at the three visits. The subpopulation maps were estimated at the mean baseline age (73.7 year old) and averaged between the two genders to control for confounding effects. They were thresholded based on the estimated intensity of the source signals. To provide better visualization of the changing patterns across voxels in the DMN, we also present in Fig. 8 the model-based estimates of longitudinal trends of source signals for voxels in the two subregions of DMN, i.e. the posterior cingulate cortex (PCC) and the lateral parietal cortex (LPC). Figs. 4 and 8 shows that the four disease groups demonstrated different temporal changing patterns in the DMN source signals across the visits. Results show that the AD and LMCI patients generally have more significant changes in the DMN network across the 3 visits as compared with the EMCI and CN subjects. We also found that the longitudinal changes in the network may not necessarily follow a linear pattern and are different between the PCC and LPC regions of the DMN. Another finding from Fig. 8 is that the AD group demonstrate larger variations across voxels within the network as compared with the other groups.\nWe also present the estimated subpopulation IC maps and the voxellevel longitudinal trends for other networks of interest 9) . Similar as the DMN, we found that the AD and LMCI patients generally have more significant changes in these networks across the 3 visits as compared with the EMCI and CN subjects, the longitudinal changes are not necessarily linear across time, and that the AD group demonstrates the larger within-network heterogeneity as compared with the other groups.\nWe then applied the proposed inference procedure to formally test the between-group differences at each visit while controlling for potential confounding effects from age and gender. We considered the differences between AD and CN group to demonstrate network changes in clinically diagnosed Alzheimer patients as compared with normal controls. We also considered the differences between the two MCI groups to investigate the heterogeneity between the early and late MCI stages. We then conducted tests to examine longitudinal changes from baseline to year 2 within disease group. For comparison, we applied the TC-GICA based method to examine the group differences and longitudinal differences. We illustrate results for the DMN for demonstration purpose. Fig. 10 and Fig. 11 present the between-group test results for AD vs. CN and LMCI vs. EMCI, respectively. The proposed L-ICA detected significant between-group differences at each visit. Furthermore, the test results from L-ICA indicate that the between-group differences tend to increase across time with group differences observed at increasingly more spatial locations in the network. In comparison, the TC-GICA based approach identified few differences between the groups. Fig. 12 represents the differences between baseline and following visits based on L-ICA. It shows that AD has more longitudinal changes compared with other groups. Specifically, Fig. 13 presents the results for testing the changes from baseline screening to year 2 for AD group. Results from L-ICA show that the AD group demonstrated noticeable longitudinal changes in DMN, which are consistent with findings reported in previous work (Dai et al., 2017) . In comparison, the TC-GICA approach identified very little longitudinal changes in DMN among the AD patients. As in the simulation studies, the results from the real data analysis show that the L-ICA method has higher statistical power in detecting group differences and longitudinal changes. Based on a reviewer's suggestion, we also conduct additional analyses to evaluate the robustness of the between-group test results based on the L-ICA. Our findings indicate the test results from L-ICA are fairly robust (Please refer to Appendix for details)."}, {"section_title": "Discussion", "text": "In this paper, we proposed a longitudinal ICA model (L-ICA) to formally quantify time-evolving patterns in brain function networks. In the L-ICA model, we incorporated subject-specific random effects to capture the varbilities across subjects and also borrow information across visits within the same subject to improve the model efficiency. Furthermore, to capture the possible non-linear changing effects in brain functional networks, L-ICA incorporates visit-specific covariate effects which can flexibly capture time-varying effects from subjects' demographic, clinical and biological variables. The proposed L-ICA has demonstrated lower type I error and higher statistical power in detecting covariate effects on brain networks and their changes across time.\nWe developed a maximum likelihood estimation method via EM algorithms for L-ICA model. Based on results from the EM, L-ICA model can simultaneously estimate population and subject/visit-specific brain functional networks. We show that L-ICA's model-based estimates of brain functional networks are more accurate on both population-and individual level. Furthermore, we proposed a computationally efficient subspace based EM algorithm. Simulation study showed that the approximate EM dramatically improves computational efficiency while achieving similar accuracy in model estimation. Matlab functions for implementing the L-ICA model will be added to an Matlab toolbox \"HINT: Hierarchical Independent Component Analysis Toolbox\" (Lukemire et al., 2018) which is publicly available and updated on NITRC (NeuroImaging Tools and Resources Collaboratory) and the website of Center for Biomedical Imaging Statistics (CBIS) at Emory University.\nSome potential extensions to L-ICA is to incorporate more general model specification such as functional data analysis for more flexible modeling of longitudinal effects. Another potential extension to L-ICA is to incorporate spatial dependence in modeling the covariate effects in the ICA which can help improve the accuracy and efficiency in effects estimation. Furthermore, as a reviewer points out, given the computational cost of the MoG source distribution, one may consider alternative source distributions such as fixed or binary prior densities (Hyv\u20ac arinen, Karhunen and Oja, 2001) , which is worth investigating in future work."}, {"section_title": "Q-function in E step:", "text": "The detailed expression for the complete data log-likelihood function at each voxel v is: We derive the Q function in E step as follows,\n2. Details about the E step of the exact EM algorithm.\nIn this section, we provide the details about the derivation in the exact E step. By collapsing our model across N subjects and K visits, for v \u00bc \ny\u00f0v\u00de \u00c0 AU \u00f0c\u00de \u03bc z\u00f0v\u00de \u00c0 AC \u00c3 \u00f0v\u00deX \u00c3 i ;\nNext, we evaluate the conditional distribution of L\u00f0v\u00de. Given that L\u00f0v\u00de \u00bc Pr z\u00f0v\u00de \u00fe Q z\u00f0v\u00de , we have L\u00f0v\u00de y\u00f0v\u00de; z\u00f0v\u00de $ N\u00f0P\u03bc r\u00f0v\u00dejy\u00f0v\u00de \u00fe Q z\u00f0v\u00de ; P\u03a3 r\u00f0v\u00dejy\u00f0v\u00de P'\u00de,\nBy integrating out p\u00bdz\u00f0v\u00dejy\u00f0v\u00de, we obtain the conditional distribution of L\u00f0v\u00de."}, {"section_title": "Details about the M step of the exact EM", "text": "In this section, we only provide the M step of the exact EM.\nUpdate the time-specific covariate effects C j \u00f0v\u00de: for j \u00bc 1; ::; K, v \u00bc 1; :: \nUpdate second level variance term \u03c4 2 I q : where R \u00f0\u2113;j\u00de is defined as fz r 2 R : z r \u2113 \u00bc jg for all \u2113 \u00bc 1; ::; q; j \u00bc 1; \u2026; m.\n4. Statistical inference for testing covariate effects in L-ICA:\nIn this section, we present the statistical inference procedure for testing covariate effects in L-ICA. We first stack the fMRI data from all visits of a subject to have the subject-specific fMRI data y i \u00f0v\u00deof dimension qK \u00c2 1which is \u00bdy i1 \u00f0v\u00de 0 ; \u2026; y iK \u00f0v\u00de 0 0 , and a non-hierarchical form of L-ICA is derived by combining equations (1) 5. Details about the pre-whitening prior to ICA:\nFollowing previous work (Beckmann and Smith, 2004) , we perform preliminary analysis to prewhiten the data so that the noise covariance can be assumed to be isotropic across voxels in the probabilistic ICA model. Specifically, if the original covariance of the noise e ij \u00f0v\u00deis known as \u03c3 2 0 E v , we can use the Cholesky decomposition\nand obtain a new representation,\nwhere e ij \u00f0v\u00de $ N\u00f00; \u03c3 2 0 I\u00de. Therefore, the noise covariance becomes isotropic and standardized across voxels. When E v is unknown, the prewhitening can be achieved by the following iterative procedure: (1) start with an initial noise covariance E \u00f00\u00de v , prewhiten the data as in (16), (2) with voxel-wise prewhitened data, we can readily derive the ML estimates of b A ij;ML , b s ij;ML \u00f0v\u00de and b \u03c3 2 0;ML (Beckmann and Smith, 2004) , (3) re-estimate the noise covariance E v based on the residuals b e ij \u00f0v\u00de from model (17), and then repeat steps (1)-(3). By performing the iterative procedure, we obtain the preprocessed data for the subsequent ICA modeling."}, {"section_title": "Robustness of between-group test results based on L-ICA", "text": "We conduct additional analyses to evaluate the robustness of the between-group comparison results in the DMN for the ADNI2 study based on the proposed L-ICA. We obtain 51 data sets by applying the leave-one-out procedure on the ADNI2 data, where each data set contains 50 subjects by removing one subject from the original data. We then run L-ICA and conduct between-group comparisons for each of the data sets. We evaluate the consistency of the comparison results for each voxels in the DMN by examining whether the significance of the test result is consistent or not with the original data. Specifically, for voxel v, the consistency rate is defined as 1 51 P 51 k\u00bc1 1\u00f0sig k \u00f0v\u00de \u00bc sig org \u00f0v\u00de\u00de , where sig org \u00f0v\u00de is a binary indicator that equals 1 if the voxel v showed significant between-group test result in the original data and equals 0 if otherwise, and sig k \u00f0v\u00de is the corresponding binary test significance indicator under the kth leave-one-out dataset. Table 3 presents the results on the consistency rate across voxels for each of the group comparisons, including AD vs. CN at every visit, EMCI vs. LMCI at every visit, and longitudinal changes from baseline to year 2 for the AD group. Specifically, we first present the average consistent rate across all voxels in the network (1st row in Table 3 ) Then, we present the average consistency rates separately for voxels that are significant in the original tests (2nd row in Table 3 ) and voxels that are non-significant in the original tests (3rd row in Table 3 ). Results show that the group test results based on the L-ICA on average have a consistent rate of over 90% across the DMN and also within both significant voxels and non-significant voxels, indicating the between-group comparison results based on L-ICA are fairly robust for the ADNI2 study. "}]
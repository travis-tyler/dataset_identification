[{"section_title": "Abstract", "text": "With rapid progress in high-throughput genotyping and neuroimaging, imaging genetics has gained significant attention in the research of complex brain disorders, such as Alzheimer's Disease (AD). The genotype-phenotype association study using imaging genetic data has the potential to reveal genetic basis and biological mechanism of brain structure and function. AD is a progressive neurodegenerative disease, thus, it is crucial to look into the relations between SNPs and longitudinal variations of neuroimaging phenotypes. Although some machine learning models were newly presented to capture the longitudinal patterns in genotype-phenotype association study, most of them required fixed longitudinal structures of prediction tasks and could not automatically learn the interrelations among longitudinal prediction tasks. To address this challenge, we proposed a novel temporal structure auto-learning model to automatically uncover longitudinal genotype-phenotype interrelations and utilized such interrelated structures to enhance phenotype prediction in the meantime. We conducted longitudinal phenotype prediction experiments on the ADNI cohort including 3,123 SNPs and 2 types of biomarkers, VBM and FreeSurfer. Empirical results demonstrated advantages of our proposed model over the counterparts. Moreover, available literature was identified for our top selected SNPs, which demonstrated the rationality of our prediction results. An executable program is available online at https://github.com/littleq1991/sparse_lowRank_regression."}, {"section_title": "Introduction", "text": "deteriorating to AD [3] . According to [4] , AD is the 6th leading cause of death in the United States. Every 66 seconds, there is someone in the United States developing AD. Up until 2016, an estimate of 5.4 million individuals in the United States are living with AD, while the number worldwide is about 44 million. To make matters worse, if no breakthrough discovered, the world will see a more striking increase in these numbers in near future.\nWith all these facts, AD has gained its growing attention in this day and age. Current consensus underscores the need of understanding the genetic causes of AD, with which to achieve the goal of stoping or slowing down disease progression [5] . Recent advances in neuroimaging and microbiology have provided a helping hand for exploring the associations among genes, brain structure and behavior [6] . Meanwhile, rapid developments in highthroughput genotyping have enabled the measurement of hundreds of thousands of, or even more than one million single nucleotide polymorphisms (SNPs) simultaneously [7] . These progresses have facilitated the pullulation of imaging genetics, which holds great promise for better understanding complex neurobiological systems.\nIn imaging genetics, an emerging strategy to facilitate identification of susceptibility genes for disorders like AD is to evaluate genetic variation using outcome-relevant biomarkers as quantitative traits (QTs). The association studies between genetic variations and imaging measures usually maintain an obvious advantage over case-control studies, as QTs are quantitative measures with the ability of increasing statistical power four to eight fold and decreasing required sample size to a large extent [8] . Numerous works have been reported to identify genetic factors impacting imaging phenotypes of biomedical importance [9] [10] [11] .\nIn the genotype-phenotype association study, we can denote our inputs in the matrix format as follows: the SNP matrix X \u2208 \u211d d\u00d7n (n is the number or samples, d is the number of SNPs) and the imaging phenotype matrices Y = [Y 1 , Y 2 , \u2026, Y T ] \u2208 \u211d n\u00d7cT (c is the number of QTs, T is the number of time points, and Y t \u2208 \u211d n\u00d7c is the phenotype matrix at time t). The goal is to find the weight matrix W = [W 1 , W 2 , \u2026, W T ] \u2208 \u211d d\u00d7cT , which properly reflect the relations between SNPs and QTs and capture a subset of SNPs responsible for phenotype prediction at the same time. If we treat the prediction of one phenotype at one time point as a task, then the association study between genotypes with multiple longitudinal phenotypes can be seen as a multi-task learning problem.\nConventional strategies [12] [13] [14] , which perform standard regression at all time points, are equivalent to carrying out regression at individual time point separately, thus ignore the longitudinal variations of brain phenotypes. Since AD is a progressive disorder and imaging phenotype is a quantitative reflect of its neurodegenerative status, prediction tasks at various time points can be reasonably assumed related. For a certain QT, its value at different time may be correlated, while distinct QTs at a certain time may also retain some mutual influence. To excavate correlations among longitudinal prediction tasks, several multi-task models were proposed on the basis of sparse learning [15, 16] . The main idea of these models is to exert trace norm on the entire parameter matrix, such that the common subspace globally shared by different prediction tasks can be extracted.\nHowever, longitudinal prediction tasks are interrelated as different groups, not as a whole. Existing methods cannot find the task interrelations properly. It is intractable to discover such task group structure. One straightforward way of capturing such interrelated groups is to conduct clustering analysis and extract the group structure as a preprocessing step. Nevertheless, such a heuristic step is independent to the entire longitudinal learning model, thus the detected group structures are not optimal for the longitudinal learning. To bridge this gap, we propose a novel temporal structure auto-learning low-rank predictive model to simultaneously uncover the interrelations among different prediction tasks and utilize the learned interrelated structures to enhance phenotype prediction."}, {"section_title": "Notations", "text": "In this paper, matrices are all written as uppercase letters while vectors as bold lower case letters. For a matrix M \u2208 \u211d d\u00d7n , its i-th row and j-th column are denoted by m i , m j respectively, while its ij-th element is written as m ij or M(i, j). For a positive value p, the \u2113 2,p -"}, {"section_title": "Temporal Structure Auto-Learning Predictive Model", "text": ""}, {"section_title": "Illustration of Our Idea", "text": "Our main purpose is to construct a model to simultaneously detect the latent group structure of longitudinal phenotype prediction tasks and study SNP associations across all endophenotypes. As is shown in Fig. 1 , the four phenotypes marked by the green rectangles have similar distributions and are very likely to be correlated. However, previous models are not capable of capturing such interlinked structures in different task groups. In our model, we expect to uncover such latent subspaces in different groups via low-rank constraints. Meanwhile, the SNP loci marked by the red rectangle, rs429358, appears to be predominant for most response variables. Correspondingly, we impose a sparsity constraint to pick it out.\nIn consequence, our model should be able to capture the group structure within the prediction tasks and utilize this information to select prominent SNPs across the relevant phenotypes. In the next subsection, we will elaborate how to translate these ideas into the new learning model."}, {"section_title": "New Objective Function", "text": "To discover the group structure of phenotype prediction tasks, we introduce and optimize a group index matrix set Q. Suppose the tasks come from g groups, then we have Q = {Q 1 , Q 2 , \u2026, Q g }, where Q i is a diagonal matrix and Q i \u2208 {0, 1} cT\u00d7cT . For each Q i , (Q i ) (k,k) = 1 means the k-th feature belongs to the i-th group while (Q i ) (k,k) = 0 means not. To avoid overlap of subspaces, we maintain the constraint that\nOn the other hand, since SNPs are often correlated and have an overlap in impacting phenotypes, we impose low-rank constraint to uncover the common subspaces shared by prediction tasks. The traditional method to impose low-rank constraint is minimizing trace norm, which is a convex relaxation of rank minimization problem. However, trace norm is not an ideal approximation of the rank minimization. Here, we use the Schatten p-norm regularization term instead, which approximates the rank minimization better than trace norm [17] . The definition of Schatten p-norm of a matrix M \u2208 \u211d m\u00d7n is: Moreover, since we intend to integrate the SNP selection procedure across multiple learning tasks, here we impose a sparsity constraint. One possible approach is \u2113 2,1 -norm regularization [18] , which is popularly utilized owing to its convex property. However, the real data usually don't satisfy the RIP condition, thus the solution of \u2113 2,1 -norm may not be sparse enough. See [19, 20] for details. To solve this problem, in our model, we resort to a stricter sparsity constraint, \u2113 2,0+ -norm, which is defined as follows:\nwhere q is a positive value. Similarly to the previous discussion, when 0 < q < 1, \u2113 2,0+ -norm can achieve a more sparse solution than \u2113 2,1 norm.\nAll in all, we propose a new temporal structure auto-learning model:\nIn Eq. (2), we adopt the k-power of Schatten p-norm to make our model more robust. The use of parameter k will be articulated in Section 4. Since it is difficult to solve the proposed new non-convex and non-smooth objective, in the next section we propose a novel alternating optimization method for Problem (2)."}, {"section_title": "Optimization Algorithm", "text": "In this section, we first introduce an optimization algorithm for general problems with Problem (2) being a special case, and then discuss the detailed optimization steps of Problem (2)."}, {"section_title": "Lemma 1", "text": "Let g i (x) denote a general function over x, where x can be a scalar, vector or matrix, then we can claim:\nis equivalent to\nProof-When \u03b4 \u2192 0, it's apparent that the optimization problem\nwill reduce to\n. (5) So we turn the non-smooth Problem (5) to the smooth Problem (4) where \u03b4 is fairly small.\nThe Lagrangian function of Problem (4) is:\nwhere r(x, \u03bb) is a Lagrangian term for the domain constraint x \u2208 . Take derivative w.r.t. x and set it to zero, we have:\nRes Comput Mol Biol. Author manuscript; available in PMC 2018 April 23."}, {"section_title": "Author Manuscript Author Manuscript", "text": "Author Manuscript\nAuthor Manuscript\nBased on the chain rule [21] , Eq. (7) can be rewritten as:\nAccording to the Karush-Kuhn-Tucker conditions [22] , if we can find a solution x that satisfies Eq. (8), then we usually find a local/global optimal solution to Problem (4). However, it is intractable to directly find the solution x that satisfies Eq. (8). Here we come up with a strategy as follows:\n2 as a given constant, then Eq. (8) can be reduced to\nBased on the chain rule [21] , the optimal solution x* of Eq. (9) is also an optimal solution to the following problem:\nBased on this observation, we can first guess a solution x, next calculate D i based on the current solution x, and then update the current solution x by the optimal solution of Problem (10) on the basis of the calculated D i . We can iteratively perform this procedure until it converges.\nAccording to Lemma 1 and the property of Q i that\nwhere D i is defined as:\nand B is defined as a diagonal matrix with the l-th diagonal element to be:\nand \u03b4 1 and \u03b4 2 are two fairly small parameters close to zero.\nWe can solve Problem (11) via alternating optimization.\nThe first step is fixing W and solving Q, then Problem (11) becomes:\nLet A i = W T D i W, then the solution of each Q i is as follows:\nThe second step is fixing Q and solving W. Problem (11) becomes:\nwhich can be further decoupled for each column of W as follows:\nTaking derivative w.r.t. w k in the above problem and set it to zero, we get:\nWe can iteratively update D, Q, B and W with the alternative steps mentioned above and the algorithm for Problem (11) is summarized in Algorithm 1."}, {"section_title": "Convergence analysis", "text": "Our algorithm uses the alternating optimization method to update variables, whose convergence has already been proved in [23] . As for the newly proposed reweighted algorithm, we will provide its convergence proof in Appendix A. In our model, variables in each iteration has a closed form solution and can be computed fairly fast. In most cases, our method converges within 10 iterations."}, {"section_title": "Discussion of Parameters", "text": "In our model, we introduced several parameters to make it more general and adaptive to various circumstances. Here we analyze the functionality of each parameter in detail.\nIn Problem (2), parameter p and q are norm parameters proposed for the two regularization terms. For p, it adjusts the stringency of the low-rank constraint. As analyzed in Section 3, Schatten p-norm makes a stricter low-rank constraint than trace norm when 0 < p < 1. The closer p is to 0, the more rigorous low-rank constraint the regularization term \u2016M\u2016 S p p imposes. The rationale is similar for parameter q. The \u2113 2,0+ -norm is a better approximation of \u2113 2,0 -norm than \u2113 2,1 -norm when q lies in the range of (0, 1), thus makes our learned parameter matrix more sparse."}, {"section_title": "Algorithm 1", "text": "Algorithm to solve problem (11).\nInput:\n10 \u221212 and \u03b4 2 = 10 \u221212 , number of groups g."}, {"section_title": "Output:", "text": "Weight\nwhich groups the tasks into exactly g subspaces. k to make our model robust. According to experimental experience, the value of k can be determined in the range of [2, 3] .\nThe parameters \u03b3 1 and \u03b3 2 are proposed to balance the importance of two regularization terms. Larger \u03b3 1 lead to more attention on the low-rank constraint while larger \u03b3 2 lays more emphasis on the sparse structure. These two parameters can be adjusted to accommodate different cases.\nIn our empirical section, we didn't make too much effort on tuning these parameters. Instead, in fairness to other comparing methods, we just simply set each parameters to a reasonable value. Though these parameters brought about great challenges in solving our optimization problem, they make our model more flexible and adaptive to different settings and conditions."}, {"section_title": "Experimental Results", "text": "In this section, we evaluate the prediction performance of our proposed method using both synthetic and real data. Our goal is to uncover the latent subspace structure of the prediction tasks and meanwhile select a subset of SNPs responsible for their variation."}, {"section_title": "Experiments on Synthetic Data", "text": "First of all, we utilize synthetic data to illustrate the effectiveness of our model. Our synthetic data is composed of 30 features and 3 groups of tasks from 4 different time points. Each group includes 4 tasks, who are identical to each other up to a scaling. After we generated weight matrix W in this way, we constructed a random X including 10000 samples and get Y according to Y = X T W. form three low-rank subspaces. For easier visualizing this low-rank structure, we reshuffled tasks in W o by putting tasks in the same group together and formed Fig. 2(b) . Now the lowrank structure within the synthetic data can be easily detected, where every four columns in Fig. 2 (b) make a low-rank subspace. We applied our method to this synthetic data and plotted our learned W matrix in Fig. 2(c) . To evaluate the structure of W, we did the rearrangement likewise. By comparing Fig. 2(b) and Fig. 2(d) , we note that our method has successfully uncover the group structure of the synthetic data and recovered the parameter matrix W in an accurate way."}, {"section_title": "Experimental Settings on Real Benchmark Data", "text": "In the following we evaluate our method on real benchmark datasets. We compare our method with all the counterparts discussed in the introduction section, which are: multivariate Linear Regression (LR), multivariate Ridge Regression (RR), Multi-Task Tracenorm regression (MTT) [24] , Multi-Task \u2113 2,1 -norm Regression (MTL21) [25] and their combination (MTT+L21) [15, 16] .\nIn our pre-experiments, we found the performance of our method to be relatively stable with parameters in the reasonable range (data not shown). For simplicity, we set \u03b3 1 = 1, \u03b3 2 = 1, p = 0.8, q = 0.1, and k = 2.5 without tuning. The definition and reasonable range of these parameters has been discussed in Section 4.\nAs the evaluation metric, we reported the root mean square error (RMSE) and correlation coefficient (CorCoe) between the predicted and actual scores in out-of-sample prediction. In our experiment, the RMSE was normalized by the Frobenius norm of the ground truth matrix. Better performance relates with lower RMSE or higher CorCoe value. We utilized the 5-fold cross validation technique and reported the average RMSE and CorCoe on these 5 trials for each method."}, {"section_title": "Description of ADNI Data", "text": "Data used in this work were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). One goal of ADNI is to test whether serial magnetic resonance imaging (MRI), positron emission tomography (PET), other biological markers, and clinical and neuropsychological assessment can be combined to measure the progression of mild cognitive impairment (MCI) and early AD. For up-to-date information, see www.adni-info.org. The genotype data [26] of all non-Hispanic Caucasian participants from the ADNI Phase 1 cohort were used here. They were genotyped using the Human 610-Quad BeadChip. Among all the SNPs, only SNPs, within the boundary of \u00b120K base pairs of the 153 AD candidate genes listed on the AlzGene database (www.alzgene.org) as of 4/18/2011 [27] , were selected after the standard quality control (QC) and imputation steps. The QC criteria for the SNP data include (1) call rate check per subject and per SNP marker, (2) gender check, (3) sibling pair identification, (4) the Hardy-Weinberg equilibrium test, (5) marker removal by the minor allele frequency and (6) population stratification. As the second preprocessing step, the QC'ed SNPs were imputed using the MaCH software [28] to estimate the missing genotypes. As a result, our analyses included 3,576 SNPs extracted from 153 genes (boundary: \u00b120KB) using the ANNOVAR annotation (http:// www.openbioinformatics.org/annovar/).\nTwo widely employed automated MRI analysis techniques were used to process and extract imaging phenotypes from scans of ADNI participants as previously described [11] . First, Voxel-Based Morphometry (VBM) [29] was performed to define global gray matter (GM) density maps and extract local GM density values for 90 target regions. Second, automated parcellation via FreeSurfer V4 [30] was conducted to define volumetric and cortical thickness values for 90 regions of interest (ROIs) and to extract total intracranial volume (ICV). Further details are available in [11] . All these measures were adjusted for the baseline ICV using the regression weights derived from the healthy control (HC) participants. The time points examined in this study for imaging markers included baseline (BL), Month 6 (M6), Month 12 (M12) and Month 24 (M24). All the participants with no missing BL/M6/M12/M24 MRI measurements were included in this study, including 96 AD samples, and 219 MCI samples and 174 health control (HC) samples."}, {"section_title": "Performance Comparison on ADNI Cohort", "text": "Here we assessed the ability of our method to predict a set of imaging biomarkers via genetic variations. We tracked the process along the time axis and intended to uncover the latent subspace structure maintained by phenotypes and meanwhile capture a subset of SNPs influencing the phenotypes in a certain subspace.\nWe examined the cases where the number of selected SNPs were {30, 40, \u2026, 80}. The experimental results are summarized in Table 1 and 2. We observe that our method consistently outperforms other methods in most cases. The reasons go as follows: multivariate regression and ridge regression assumed the imaging features at different time points to be independent, thus didn't consider the correlations within. Their neglects of the interrelations among the data was detrimental to their prediction performance.\nAs for MTTrace, MTL21 and their combination MTTrace+MTL21, even though they take into account the inner connection information of imaging phenotypes, they simply constrain all phenotypes to a global space thus cannot handle the possible group structure therein. That is why they may overweigh the standard methods in some cases, but cannot outperform our proposed method. As for our proposed method, not only did we capture the latent structure among the longitudinal phenotypes, but we also selected a set of responsible SNPs at the same time. All in all, our model can capture SNPs responsible for some but not necessarily all imaging phenotypes along the time continuum, which save more effective information in the prediction."}, {"section_title": "Identification of Top Selected SNPs", "text": "Shown in Fig. 3 are the heat maps of top regression weights between imaging QTs and SNPs. APOE-rs429358, the well-known major AD risk factor, demonstrated relatively strong predictive power in both analysis: (1) In FreeSurfer analysis, it predicts mainly the cerebral cortex volume at M06, M12 and M24. (2) In VBM analysis, it predicts the GM densities of amygdala, hippocampus, and parahippocampal gyrus at multiple time points (Fig. 4) . Both patterns are reassuring, since APOE-rs429358 and atrophy patterns of the entire cortex as well as medial temporal regions (including amygdala, hippocampus, and parahippocampal gyrus) are all highly associated with AD.\nIn addition, APOE-rs429358 has been shown to be related to medial temporal lobe atrophy [31] , hippocampal atrophy [32] and cortical atrophy [33] . Variants within membranespanning 4-domains subfamily A (MS4A) gene cluster are some other recently discovered AD risk factors [34] . Our analysis also demonstrated their associations with imaging QTs:\n(1) MS4A4E-rs670139 predicts cerebral white matter volume at BL, M06 and M12; and (2) MS4A6A-rs667897 predicts GM densities of posterior cingulate and pallidum at almost all time points. Another interesting finding is EBF3-rs482761, which is identified in both analyses: (1) In FreeSurfer analysis, it predicts left cerebral white matter volume at M06; and (2) in VBM analysis, it predicts GM densities of left Heschl's gyri, left superior temporal gyri, hippocampus, left amygdala at multiple time points. EBF3 (early B-cell factor 3) is a protein-coding gene and has been associated with neurogenesis and glioblastoma. In general, both FreeSurfer and VBM analyses picked up similar regions across different time points. These identified imaging genomic associations warrant further investigation in independent cohorts. If replicated, these findings can potentially contribute to biomarker discovery for diagnosis and drug design."}, {"section_title": "Conclusions", "text": "In this paper, we proposed a novel temporal structure auto-learning model to study the associations between genetic variations and longitudinal imaging phenotypes. Our model can simultaneously uncover the interrelation structures existing in different prediction tasks and utilize such learned interrelated structures to enhance the feature learning model. Moreover, we utilized the Schatten p-norm to extract the common subspace shared by the prediction tasks. Our new model is applied to ADNI cohort for neuroimaging phenotypes prediction via SNPs. We conducted experiments on both synthetic and real benchmark data. Empirical results validated the effectiveness of our model by demonstrating the improved prediction performance compared with related methods. In real data analysis, we also identified a set of interesting and biologically meaningful imaging genomic associations, showing the potential for biomarker discovery in disease diagnosis and drug design.\nObviously, when \u03c3 > 0 and 0 < p \u2264 2, then f\u2033(\u03c3) \u2265 0 and \u03c3 = 1 is the only point that f\u2032(\u03c3) = 0. Note that f(1) = 0, thus when \u03c3 > 0 and 0 < p \u2264 2, then f(\u03c3) \u2265 0, which indicates Eq. (16)."}, {"section_title": "Lemma 3 ([35])", "text": "For any positive definite matrices M, M with the same size, suppose the eigendecomposition M\u0303 = U \u03a3U T , M = V \u039bV T , where the eigenvalues in \u03a3 is in increasing order and the eigenvalues in \u039b is in decreasing order. Then the following inequality holds:\nSumming Eq. (22) and Eq. (25) in the two sides, we arrive at\n) . (26) Note that the equality in Eq. (26) holds only when the algorithm converges. Thus the reweighted algorithm shown in Lemma 1 will monotonically decrease the objective of Problem (4) in each iteration until the algorithm converges. Illustration of our temporal structure auto-learning regression model. In this figure, parameter matrices at different time points are arranged in the column order. Four tasks marked out by green rectangles obey similar patterns thus have high interrelations while one SNP loci rs429358 enclosed by a red rectangle appears to be correlated with most phenotypes. Our model is meant to uncover the group information among all prediction tasks along the time continuum, i.e., cluster the phenotypes in the same latent subspace (phenotypes marked out by green rectangles) into the same group and meanwhile discover genetic biomarkers responsible for most prediction tasks (SNPs marked out by red rectangles). Top 10 weights of APOE-rs429358 mapped on the brain for the VBM analysis. Wang et al. Page 22 Table 2 Biomarker \"VBM\" and \"FreeSurfer\" (upper table for "}]
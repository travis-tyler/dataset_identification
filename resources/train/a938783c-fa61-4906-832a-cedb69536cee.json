[{"section_title": "Abstract", "text": "Associating genetic markers with a multidimensional phenotype is an important yet challenging problem. In this work, we establish the equivalence between two popular methods: kernel-machine regression (KMR), and kernel distance covariance (KDC). KMR is a semiparametric regression frameworks that models the covariate effects parametrically, while the genetic markers are considered non-parametrically. KDC represents a class of methods that includes distance covariance (DC) and Hilbert-Schmidt Independence Criterion (HSIC), which are nonparametric tests of independence. We show the equivalence between the score test of KMR and the KDC statistic under certain conditions. This result leads to a novel generalization of the KDC test that incorporates the covariates.\nOur contributions are three-fold: (1) establishing the equivalence between KMR and KDC; (2) showing that the principles of kernel machine regression can be applied to the interpretation of KDC; (3) the development of a broader class of KDC statistics, that the members are the quantities of different kernels. We demonstrate the proposals using simulation studies. Data from the Alzheimer's Disease Neuroimaging Initiative (ADNI) is used to explore the association between the genetic variants on gene FLJ16124 and phenotypes represented in 3D structural brain MR images adjusting for age and gender. The results suggest that SNPs of FLJ16124 exhibit strong pairwise interaction effects that are correlated to the changes of brain region volumes."}, {"section_title": "Introduction", "text": "To better understand and decode the information from genomic data, researchers often study the associations between the genetic variants and disease phenotypes. Recently, intermediate phenotypes are attracting more attention compared to the final disease diagnosis, since intermediate phenotypes potentially have stronger connections to the genetic variants and also provides comprehensive information for the final disease outcome. We consider data from the Alzheimer's Disease Neuroimaging Initiative (ADNI) study (ADNI, 2003) as an example. It is a study for Alzheimer's disease with the intermediate multiple phenotypes being the structural magnetic resonance imaging (MRI) of the brain from the enrolled subjects, and many research efforts have been devoted in finding genetic variants that affect such phenotypes (Ge et al. (2012) , Stein et al. (2010a) , Stein et al. (2010b) . In this article, we will primarily focus on the problem of correlating the genetic variants with the imaging data.\nOne of the previous ADNI analyses applied linear regression using one genetic marker versus one phenotype (a single voxel of the brain MRI) in a massively univariate manner across all markers and all phenotypes (Stein et al., 2010b) . Such a method is feasible if the number of genetic variants and phenotypes is small; when the dimension of genotypes and phenotypes are both very large, the resulting test has limited power due to the issue of multiple comparisons. Two popular modelling frameworks that could potentially be applied to the motivating example are the multivariate kernel machine regression model (MV-KMR) (Maity et al., 2012) and the kernel distance covariance method (KDC) (Sz\u00e9kely et al. (2007) , Sz\u00e9kely and Rizzo (2009) , and Gretton et al. (2007) ).\nMV-KMR is a multivariate response framework based on kernel machine regression (KMR) (Maity et al., 2012) , where KMR is a semiparametric regression that models the covariates effect parametrically, and considers the genetic markers non-parametrically (Liu et al. (2007) and Kwee et al. (2008) ). Specifically, the non-parametric effect of multiple markers is introduced by a kernel. The Gaussian RBF kernel is frequently used for quantitative measurements, while the IBS or polynomial kernel can be considered for the qualitative variables. One advantage of this approach is that it is able to greatly simplify the specification of a non-parametric model for multiple markers effects (Liu et al., 2007) . Since we focus our discussion on multivariate phenotypes in this work, we simply use KMR to denote the multivariate case, as the KMR model is feasible for both univariate and multiple phenotypes.\nKDC is a term that we define as a class of methods for the tests of independence, and it includes distance covariance (DC) and Hilbert-Schmidt Independence Criterion (HSIC).\nDC was established by Sz\u00e9kely et al. (2007) as providing a test of independence in highdimensional settings that is consistent against all alternatives. One advantage of distance covariance is the compact representation of the statistic which is the product of expectations of pairwise L 2 distance, which can be estimated empirically in a straightforward manner. On the other hand, Gretton et al. (2007) formulated the two-variable independence test (HSIC) in Reproducing Kernel Hilbert Spaces (RKHS). Similar to DC, the HSIC statistic is able to find the test of dependence in multivariate spaces, and it is consistent when a characteristic kernel (Sriperumbudur et al., 2010 ) is used. Sejdinovic et al. (2013) demonstrated that the above two statistics are the same when the distance-induced kernel in HSIC is chosen. The results in Sejdinovic et al. (2013) showed that the HSIC test is more sensitive when the quantity is derived from other kernels, and the HSIC tests can be readily extended to more structured and non-Euclidean spaces.\nIn this work, we establish the equivalence between KMR and KDC. We begin our discussion by first reviewing two preliminaries in application to the linear model, followed by an algebraic representation of the multiple phenotypes version of KMR, and show that the KMR and KDC are equivalent under the condition of no covariate adjustment and when a Gower distance kernel (Gower, 1966) or linear kernel is used for the phenotype spaces. Furthermore, we propose a new covariate-adjusted KDC test with the presence of the covariates, and show that KDC is equivalent to the KMR of Maity et al. (2012) . Three major implications are found by the equivalence established in this work. First, the equivalence shows that the principles of KMR can be applied to the interpretation of KDC. Second, the new proposed covariate-adjusted KDC test shows an increase in power relative to the original KDC test in our simulation studies. Third, the KMR statistic is a member of the KDC family, in that the members are the quantities of different kernels. Our numerical results suggest that KDC may yield a more power result with kernels that are tailored to the particular application."}, {"section_title": "Preliminaries", "text": ""}, {"section_title": "Distance properties of the sum of squares", "text": "Before we introduce the equivalence between KMR and KDC, a review of the distance properties of the sums of squares (Gower, 1966) is provided. Suppose the multivariate sample has a set of n points\nWe denote A as a n \u00d7 n symmetric sum of squares matrix of Y with eigenvalues \u03bb 1 , ..., \u03bb n and eigenvectors c 1 , ..., c n . If c 1 , ..., c n are normalized, then A = c 1 c\nand a ij = n r=1 c ir c jr . Hence, the distance between Y i and Y j can be derived as follows:\nNow, A is centered by subtracting the means, then a ii = 0, and\nGower distance (Gower, 1966) ), then the sum of squares matrix of Y is\nwhere 1 n is a n \u00d7 1 vector with elements 1, and I is an identity matrix of size n."}, {"section_title": "Linear model", "text": "Linear models are often utilized to examine the effects between two variables. Suppose we observe n subjects with index i = 1, ..., n, and the response \nFurthermore, McArdle and Anderson (2001) suggested that the above partitioning procedure can be done using the outer product matrix, i.e., tr(YY\nTherefore, we can replace YY \u2032 with any n \u00d7 n distance matrix D:\nIf D is a Gower distance matrix, then (3) is the same as (2); if D is some other distance (kernel) matrix, then the significance of (3) can be tested using the permutation technique.\nThe estimate in (3) is flexible in capturing the nature of the response, and measures the effect between the predictors and the responses at the same time."}, {"section_title": "Methods", "text": "McArdle and Anderson (2001) applied the outer product tool to extend the MANOVA to the general MANOVA. This inspires us to apply the same argument to the KMR model, and it turns out that KMR is equivalent to the KDC when a common kernel is chosen. To understand this link between KMR and KDC, we first consider the KMR model without covariates. We then consider the situation when covariate effects are included, which leads to our proposal of a new covariate-adjusted KDC test with the presence of the covariates."}, {"section_title": "Without covariates", "text": "In order to test the dependence between two random vectors, i.e., the association between\nDC or HSIC) can be used for the purpose. Here we use the same algebraic formulation as the one in Gretton et al. (2007) , and denote the kernel function k ij = k(Z i , Z j ) as an element of row i and column j of the kernel matrix K in Z, and\nTherefore, the KDC statistic for association between Y and Z is defined as\nwhere tr(X) is the trace of X and H = (I \u2212 11 \u2032 /n). If both k and l are L 2 distance kernels, then (4) is the DC statistic (Sz\u00e9kely et al., 2007) ; if other reproducing kernels are applied, (4) is the HSIC statistic (Gretton et al., 2007) . In summary, the KDC statistic is used for testing the dependence between Y and Z without distributional assumptions.\nAnother powerful test for test of interactions is kernel machine regression, which we now briefly discuss and later relate to the KDC. The linear model in Liu et al. (2007) and Kwee et al. (2008) is given by\nwhere h(\u00b7) is an unknown function to be estimated by the effects of the SNPs on the univariate response Y , and it is determined by a specified positive semi-definite kernel function k(., .).\nTo test the effects h(\u00b7), Liu et al. (2007) proposed a hierarchical Gaussian process regression for the linear model (5):\nTherefore, the null hypothesis is that phenotype Y and the SNPs Z exhibit no association, and one can test H 0 : \u03c4 = 0 since h can be treated as the subject-specific random effects with mean 0 and covariance matrix \u03c4 K. Thus, the corresponding variance component score test is proportional to:\nBy using the trace trick, (6) can be extended into two directions: first, the previous work in Liu et al. (2007) and Kwee et al. (2008) focused on a single phenotype Y . We can also replace Y with a multivariate phenotype Y, and it turns out that tr[KHYY \u2032 H] is equivalent to MV-KMR in Maity et al. (2012) in the absence of covariates. Second, a common kernel is used in K for both KMR and KDC, and by replacing the outer product Y Y \u2032 with any distance matrix L in (6) results in the equivalence of KMR and KDC in (4)."}, {"section_title": "With covariates", "text": "In practice, we may want to know the relationship between the genotypes (Z) and phenotypes (Y) where the phenotypes are adjusted by the covariates (X), and we observe n samples from X \u2208 R m , Y \u2208 R p , and Z \u2208 R q . Under this setting, the multivariate traits KMR model (Maity et al., 2012) is\nwhere h(\u00b7) is an non-parametric function which describes the effect of Z. To test the effect of\n..\u03c4 p = 0 under the following representation that is a multivariate extension of the hierarchical Gaussian process regression from the previous section:\nand the corresponding score test of H 0 is proportional to\nwhere\u1ef8 = Y \u2212 X\u03b2, and\u0232 is the average of\u1ef8 in (7) with H being a centering offset (normalized constant) (I \u2212 11 \u2032 /n) Notice that\u03b2 is the MANOVA estimates in the linear model section. Hence, (7) is equivalent to the score test in KMR from Maity et al. (2012) , and the outer product\u1ef8\u1ef8 \u2032 can be replaced with any distance measureL so that (7) becomes\nThe original KDC (i.e., DC in Sz\u00e9kely et al. (2007) and HSIC in Gretton et al. (2007) ) was presented as a test of independence between Y and Z. Here, we extend it to the case when the covariates X are present. Specifically, by applying a common kernel on K for both statistics, and ifL is composited by a Gowder distance kernel or a linear kernel, then KDC in (8) is again equivalent to (7) for the KMR.\nFor both cases when covariate effects are absent or present in (6) and (7), respectively, we ignore the covariance matrix structure of Y in order to establish the connection between KDC and KMR. Our idea for this step is similar to the work in Pan (2011) that treats the covariance term as the fixed effects, while the covariance effects among Y are not skipped in our work. We demonstrate that the covariance effects of Y are able to be captured by choosing a suitable kernel matrix in the simulation studies."}, {"section_title": "Simulation studies", "text": "\nThe goal of the following simulations is to compare the performances of KMR and KDC in terms of the empirical size and powers under different kernel combinations."}, {"section_title": "Possible kernel choices", "text": "There is a number of kernels for characterizing the similarity of individuals with respect to the variations of genotypes and phenotypes. We considered the following kernels for our numerical data analyses:\n(1) Identity-by-state (IBS) kernel:\n, where q is the number of loci considered in the calculation.\nwhere \u03c1 is the weight parameter.\nof Z i and Z j , and c is a constant.\nNotice that the polynomial kernel can be simplified into a linear kernel when c=0 and d = 1, or into a quadratic kernel when c = 1 and d = 2."}, {"section_title": "Simulation 1", "text": "The first simulation examined the association between the effect of a single phenotype Y and the multivariate Z adjusted by a single covariate X, and the design of the simulation was based on Liu et al. (2007) . The true linear model was:\nand X = 3 cos(Z 1 ) + u. The Z \u2032 j s(j = 1, ..., 5) were generated from uniform(0,1) while u and \u01eb were generated from independent N(0, 1).\nTo estimate for the coefficients of X, we first used the lm function from stat package in R permutations, and this experiment was repeated 1000 times. In the following, we used K to represent the kernel matrix for the genotypes Z, andL to represent the kernel matrix for the adjusted phenotype\u1ef8 . Table 1 shows the results of empirical sizes and powers of KMR and KDC tests, where the linear and quadratic kernels were considered on K of KMR, while the L 2 distance, linear and quadratic kernels were used in both K andL of KDC. As the results, the KMR and KDC were equivalent whenL was a linear kernel in KDC, and the performances of the quadratic kernel resulted in less powers than its counterparts.\n[ Table 1 about here.]"}, {"section_title": "Simulation 2", "text": "For the second simulation, the design was based on Maity et al. (2012) . For k = 1, ..., p, the data were generated through the model\nwhere X = (X 1 , X 2 ) T were generated from bivariate normal BV N((0.2, 0.4) T , I), and \u01eb \u2032 k s were generate MV N(0, \u03a3 true ). The q-SNP genotype data Z \u2261 (Z 1 , ..., Z q ), with q = 9, were simulated as in the CATIE SNPs data described in Maity et al. (2012) . Two choices for the effects of h k (k = 1, 2, 3) were considered. The first is the sparse effect, i.e., h 1 = a(z 1 + z 2 + z 3 + z 1 z 4 z 5 \u2212 z 6 /3 \u2212 z 7 z 8 /2 + (1 \u2212 z 9 )), h 2 = h 3 = 0, where a = 0, 0.1, 0.2. The second is the common effect, i.e., h * 1 = h 1 + az 3 , and h 2 = h 3 = az 3 with a = 0, 0.1, 0.2. In addition, we also investigated the performances of KMR and KDC by varying the variancecovariance of \u03a3 true using an independent structure (\u03a3 1 ) and a highly dependent structure (\u03a3 2 ): \nThe empirical size (a = 0) and powers (a = 0.1, 0.2) were examined at significance level of 0.05. The sample size n was 100, the dimension of genotypes q was 9, and the dimension of phenotypes p was 3. Furthermore, to adjust the covariate effects X, we again used the lm function from stat package in R to solve\u03b2, and then\u1ef8 = Y \u2212 X\u03b2, where Y = (Y 1 , ..., Y p ), and\u03b2 =\u03b2 1 , ...,\u03b2 p . In this simulation, the linear, quadratic, IBS and L 2 distance kernels were used for the performance evaluation. results in an increase in power; although the highly dependent structure of \u03a3 2 weakened the power estimates in Table 3 , the values remained very high. This implies that KDC test is able to identify the associations even when the phenotypes Y are correlated.\nOverall, when the sparse effect and the independent covariance matrix \u03a3 1 were used, the best power performance was achieved when KMR and KDC were computed by a linear kernel on bothL and K in Table 3 . This is expected because the linear kernel only identified the single connection between the Y 1 and h 1 without considering pairwise interactions. When the common effect and the dependent structure \u03a3 2 were considered, the KDC with the L 2 kernel on both L and K resulted in the largest empirical power. This suggests that the L 2 kernel is able to incorporate the dependent covariance structure, i.e., \u03a3 2 , and also identify the interaction effects between Y and Z at the same time.\n[ "}, {"section_title": "Experiments with the Alzheimer Disease Neuroimaging Initiative (ADNI) study", "text": "In this section, we first briefly introduce the ADNI dataset, followed by our simulation design according to the ADNI data samples for examining the empirical size and powers, and we then apply KDC and KMR with different kernels to the real ADNI samples. In this work, the phenotypes were summarized from 31,662 total voxels into 119 regionof-interests (ROIs), where the mapping of the ROIs was based on the GSK CIC Atlas (Tziortzi et al., 2011) . The average voxel volumetric differences within each region was used to represent each of the 119 ROIs. Hua et al. (2013) used the DC test on the same 119 brain MRI regions, and discovered that the difference in brain volumes were highly associated with a common variant rs11891634 in the intron region of gene FLJ16124, with a total of 141 SNPs within gene FLJ16124 that were identified by SNP-gene mapping from Hibar et al. (2011) . Furthermore, 741 of all subjects from the ADNI study passed the quality control filtering according to Stein et al. (2010b) (206 normal older controls, 358 mild cognitive impairment (MCI) subjects, and 177 Alzheimer's Disease (AD) patients), which we retained for the simulation and real data analysis."}, {"section_title": "Simulation based on ADNI", "text": "For this simulation study, a linear model Y = X\u03b2 +h(Z)+\u01eb was used to find the associations between the multiple phenotypes and genotypes. Similar to simulation two, the correlated structure among the phenotypes was considered, and the design of phenotypes correlation was based on Vounou et al. (2010) : the authors suggest to use the frontal cortex regions according to the GSK CIC atlas, and estimate the pairwise correlations from those regions using MCI subjects from the ADNI data set. We followed the same procedure (Vounou et al., \nWe then estimated the eight ROIs' covariance matrix \u03a3 using 358 MCI participants. The 358 MCI samples were selected for the simulation design due to the relatively uniform MRI outputs in the MCI group (Vounou et al., 2010) , and hence all \u01eb \u2032 s were generated from MVN(0, \u03a3). For the genotypes elements, all 141 SNPs on gene FLJ16124 were used, i.e. Z = (Z 1 , ..., Z 141 ). The effect of h is defined as h(Z 1 , ..., Z 141 ) = a \u00d7 h 1 , with only the first 5 SNPs, (Z 1 , ..., Z 5 ) of 141 Z's were the causative SNPs, such that\nFor the covariate effects, we considered gender and standardized age based on the same 358 MCI subjects, where gender (X 1 ) was generated from a Bernoulli distribution with p = 0.36, and standardized age (X 2 ) was generated from a standard normal. A total of 100 samples were generated, and the empirical size (a = 0) and powers (a = 0.05, 0.1) were computed based on 10 4 permutation.\nThis simulation was repeated 1000 times and the significance level was set as 0.05. Table 4 shows the empirical size and powers results with the linear, quadratic, IBS and L 2 distance kernel of KMR and KDC, and the KDC test with the L 2 distance measure resulted in the highest power among all the kernels. We also implemented the KDC test with a Gaussian kernel forL (\u03c1 \u2208 0.1, 0.5, 1, 5, 10), and the linear, quadratic, and IBS kernel for K in Table 5 . The highest power estimate was observed when we used a Gaussian kernel forL (\u03c1=0.1) and a linear kernel for K. The highest power in Table 5 is close to the power performance of KDC test with the L 2 distance kernel in Table 4 , which suggests that when the dimensions of phenotype and genotype are both very high, both the Gaussian RBF kernel (with optimal parameter \u03c1) and the L 2 distance kernel are able to describe the high dimensional interactions, and also result in powerful performances.\n[ Table 4 about here.]\n[ "}, {"section_title": "Real data analysis", "text": "The KMR and KDC tests were conducted using real ADNI samples to find the associations between the genetic variants and the multivariate brain MRI voxel with the demographic effects of gender and age. In contrast to the previous simulation setup, we utilized all 741 subjects of the ADNI study, 141 SNPs within gene FLJ16124, 119 ROIs, and two covariates, i.e., gender and age. [ Table 6 about here.]"}, {"section_title": "Conclusion and discussion", "text": "In this work, we provided the algebraic formulation that the score of KMR is equivalent to the KDC statistic. The advantage of such equivalence allows the use of KMR interpretation to explain the KDC test. For instance, Liu et al. (2007) and Maity et al. (2012) provided the REML score test of KMR, and it suggests that the null distribution of the KMR test is able to fit on the KDC test for the hypothesis testing, which greatly reduces computational costs compared to the permutation approach. Exploring the parametric distribution of the KDC statistic deserves further investigation, but is beyond the scope of this article.\nIn addition, the KMR tests can be treated as the members of a larger family of KDC, and more powerful test can be designed by looking at the optimal kernel among the family members. Although there is no single kernel that was concluded as the best from our simulations, the linear kernel for KMR or KDC achieved better performances than other kernels when considering the single phenotype; when the multiple phenotypes with multiple correlations or dependent covariance were presented, the Gaussian RBF or the L 2 kernel achieved better performances than other kernels. This result can be extended into designing a strategy to select for the the optimal kernel from the members of the large KDC family.\nFinally, several work have utilized the KDC/KMR family members in the applications including genetic pathway analysis using KMR (Liu et al., 2007) , voxel-wise genome-wide association studies using least square KMR (Ge et al., 2012) , Neuroimaging genome-wide association using DC (Hua et al., 2013) , and multiple change point analysis using DC by Matteson and James (2013) . Two recent work have presented and discussed the equivalence between the family members of our work, such as the relationships between Genomic\nDistance-Based Regression (GDBR) and KMR from Pan (2011) and the equivalence between DC and HSIC from Sejdinovic et al. (2013) . Therefore, our establishment of the equivalence between KMR and KDC in this work is an important unification of all the above applications.\nWith High-dimensional Neuroimaging Phenotypes: A Sparse Reduced-rank Regression Approach. Neuroimage 53, 1147-1159. "}]
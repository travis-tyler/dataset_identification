[{"section_title": "Abstract", "text": "Abstract. Alzheimer's disease (AD) is a progressive neurodegenerative disease that impairs a patient's memory and other important mental functions. In this paper, we leverage the mutually informative and complementary features from both structural magnetic resonance imaging (MRI) and single nucleotide polymorphism (SNP) for improving the diagnosis. Due to the feature redundancy and sample outliers, direct use of all training data may lead to suboptimal performance in classification. In addition, as redundant features are involved, the most discriminative feature subset may not be identified in a single step, as commonly done in most existing feature selection approaches. Therefore, we formulate a hierarchical multimodal feature and sample selection framework to gradually select informative features and discard ambiguous samples in multiple steps. To positively guide the data manifold preservation, we utilize both labeled and unlabeled data in the learning process, making our method semi-supervised. The finally selected features and samples are then used to train support vector machine (SVM) based classification models. Our method is evaluated on 702 subjects from the Alzheimer's Disease Neuroimaging Initiative (ADNI) dataset, and the superior classification results in AD related diagnosis demonstrate the effectiveness of our approach as compared to other methods."}, {"section_title": "Introduction", "text": "As one of the most common neurodegenerative diseases, Alzheimer's disease (AD) accounts for most dementia cases. AD is progressive and the symptoms worsen over time by gradually affecting patients' memory and other mental functions. Unfortunately, there is no cure for AD yet. Nevertheless, once AD is diagnosed, treatment including medications and management strategies can help improve symptoms. Therefore, timely and accurate diagnosis of AD and its prodromal stage, i.e., mild cognitive impairment (MCI), which can be further categorized into progressive MCI (pMCI) and stable MCI (sMCI), is highly desired in practice. Among various diagnosis tools, brain imaging, such as structural magnetic resonance imaging (MRI), has been widely used, since it allows accurate measurements of the brain structures, especially in the hippocampus and other AD related regions [1] .\nBesides imaging data, genetic variants are also related to AD [2] , and genomewide association studies (GWAS) have been conducted to identify the association between single nucleotide polymorphism (SNP) and the imaging data [3] . In [4] , the associations between SNPs and MRI-derived measures with the presence of AD were explored and the informative SNPs were identified to guide the disease interpretation. To date, most of the previous works focused on analyzing the correlation between imaging and genetic data [5] , while using both for AD/MCI diagnosis has received very little attention [6] . In this paper, we aim to jointly use structural MRI and SNPs for improving AD/MCI diagnosis, as the data from both modalities are mutually informative [3] .\nFor MRI-based diagnosis, features can be extracted from regions-of-interest (ROIs) in the brain [6] . Since not all of the ROIs are relevant to the particular disease of AD/MCI, feature selection can be conducted to identify the most relevant features in order to learn the classification model more effectively [7] . Similarly, only a small number of SNPs from a large SNP pool are associated with AD/MCI [6] . Therefore, it is preferable to use only the most discriminative features from both MRI and SNPs to learn the most effective classification model. To achieve this, supervised feature selection methods such as Lasso-based sparse feature learning have been widely used [8] . However, they do not consider discarding non-discriminative samples, which might be outliers or non-representative, and including them in the model learning process can be counterproductive.\nIn this paper, we propose a semi-supervised hierarchical multimodal feature and sample selection (ss-HMFSS) framework. We utilize both labeled and unlabeled data for manifold regularization, to preserve the neighborhood structures during the mapping from the original feature space to the label space. Furthermore, since the redundant features and outlier samples inevitably affect the learning process, instead of selecting features and samples in one step, we perform feature and sample selection in a hierarchical manner. The updated features and pruned sample set from each current hierarchy are supplied to the next one to further identify a subset with most discriminative features and samples. In this way, we gradually refine the feature and sample subsets step-by-step, undermining the effect of non-discriminative or rather noisy data. The finally selected features and samples are used to train support vector machine (SVM) classifiers for AD and MCI related diagnosis. The proposed method is evaluated on 702 subjects from the Alzheimer's Disease Neuroimaging Initiative (ADNI) cohort. In different classification tasks, i.e., AD vs. NC, MCI vs. NC, and pMCI vs. sMCI, superior results are achieved by our framework as compared to the other competing methods."}, {"section_title": "Method", "text": ""}, {"section_title": "Data Preprocessing", "text": "In this study, we use 702 subjects in total from the ADNI cohort whose MRI and SNP features are available 1 . Among them, 165 are AD patients, 342 are MCI patients, and the rest 195 subjects are normal controls (NCs). Within the MCI patients, there are 149 pMCI cases and 193 sMCI cases. sMCI subjects are those who were diagnosed as MCI patients and remained stable all the time, while pMCI refers to the MCI case that converted to AD within 24 months.\nFor MRI data, the preprocessing steps included skull stripping, dura and cerebellum removal, intensity correction, tissue segmentation and registration. The preprocessed images were then divided into 93 pre-defined ROIs, and the gray matter volume in these ROIs are calculated as MRI features. The SNP data were genotyped using the Human 610-Quad BeadChip. According to the AlzGene database 2 , only SNPs that belong to the top AD gene candidates were selected. The selected SNPs were imputed to estimate the missing genotypes, and the Illumina annotation information was used to select a subset of SNPs [9] . The processed SNP data have 2098 features. Since the SNP feature dimension is much higher than that of MRI, we perform sparse feature learning [8] on the training data to reduce the SNP feature dimension to the similar level of the MRI feature dimension."}, {"section_title": "Semi-supervised Hierarchical Feature and Sample Selection", "text": "The framework of the proposed method is illustrated in Fig. 1 . After features are extracted and preprocessed from the raw SNP and MRI data, we first calculate the graph Laplacian matrix to model the data structure using the concatenated features from both labeled and unlabeled data. This Laplacian matrix is then used in the manifold regularization to jointly learn the feature coefficients and sample weights. The features are selected and weighted based on the learned coefficients, and the samples are pruned by discarding those with smaller sample weights. The updated features and samples are forwarded to the next hierarchy for further selection in the same manner. In such a hierarchical manner, we gradually select the most discriminative features and samples in order to mitigate the effects of data redundancy in the learning process. Finally, the selected features and samples are used to train classification models (SVM in this work) for AD/MCI diagnosis tasks. In the following, we explain in detail how the joint feature and sample selection works in each hierarchy.\nSuppose we have N 1 labeled training subjects with their class labels and the corresponding features from both MRI and SNP, denoted by y \u2208 R N1 , X MRI \u2208 R N1\u00d7d1 , and X SNP \u2208 R N1\u00d7d2 , respectively. In addition, data from N 2 unlabeled subjects are also available, denoted asX MRI \u2208 R N2\u00d7d1 , and X SNP \u2208 R N2\u00d7d2 . The goal is to utilize both labeled and unlabeled data in a semi-supervised framework to jointly select the most discriminative samples and features for the subsequent classification model training and prediction. Let\nrepresent features of the unlabeled data, and w \u2208 R d1+d2 be the feature coefficient vector, the objective function for this joint sample and feature learning model can be written as\nwhere E(y, X) is the loss function defined for the labeled data, and R m (y, X,X, w) is the manifold regularization term for both labeled and unlabeled data. This regularizer is based on the natural assumption that if two data samples x p and x q are close in their original feature space, after mapping into the new space (i.e., label space), they should also be close to each other. R f (w) = w 1 is the sparse regularizer for the purpose of feature selection.\nIn the following, we explain in detail how the loss function and the manifold regularization term are defined by taking into account sample weights."}, {"section_title": "Loss function:", "text": "The loss function E(y, X) considers the weighted loss for each sample, and it is defined as\nwhere A \u2208 R N1\u00d7N1 is a diagonal matrix with each diagonal element denoting the weight for a data sample. Intuitively, a sample that can be more accurately mapped into the label space with less error is more desirable, and thus it should contribute more to the classification model. The sample weights in A will be learned through optimization and the samples with larger weights will be selected to train the classifier."}, {"section_title": "Manifold regularization:", "text": "The manifold regularization preserves the neighborhood structures for both labeled and unlabeled data during mapping from the feature space to the label space. It is defined as\nwhereX \u2208 R (N1+N2)\u00d7(d1+d2) contains features of both labeled data X and unlabeled dataX. The Laplacian matrix L \u2208 R (N1+N2)\u00d7(N1+N2) is given by where D is a diagonal matrix such that D(p, p) = q S(p, q) , and S is the affinity matrix with S(p, q) denoting the similarity between samples x p and x q . S(p, q) is defined as\nwhere y p and y q are the labels for x p and x q . For the case of unlabeled data, y p defines a soft label for an unlabeled data sample x p as y p = k is the number of x p 's neighbors with positive class labels out of its k neighbors in total. Note that for an unlabeled sample, the nearest neighbors are searched only in the labeled training data, and the soft label represents its closeness to a target class. Using such definition, the similarity matrix S encodes relationships among both labeled and unlabeled samples. The diagonal matrix\u00c2 \u2208 R (N1+N2)\u00d7(N1+N2) applies weights on both labeled and unlabeled samples. The elements in\u00c2 are different for labeled and unlabeled data:\nBy this definition, if an unlabeled sample whose k nearest neighbors are relatively balanced from both positive and negative classes (i.e., k pos p /k \u2248 0.5), it is assigned a smaller weight as this sample may not be representative enough in terms of class separation. The weights in A for the labeled data are to be learned in the optimization process."}, {"section_title": "Overall objective function:", "text": "Taking into account the loss function, the manifold regularization, as well as the sparse regularization on features, the objective function is min w,A A(y \u2212 Xw)\nNote that the elements in A are enforced to be non-negative to assign physically interpretable weights to different samples. Also, the diagonal of A should sum to one, which makes the sample weights to be interpreted as probabilities, and also ensures that sample weights will not be all zero. We employ an alternating optimization strategy to solve this problem, i.e., we fix A to find the solution of w, and vice versa. For solving w, the Accelerated Proximal Gradient (APG) Algorithm 1. Semi-supervised hierarchical multimodal feature and sample selection"}, {"section_title": "Input:", "text": "Labeled and unlabeled data from MRI and SNP, and the number of hierarchies L. 1: Initialize labeled sample weights in A and feature coefficients in w.\nCalculate the data similarity scores in S by Eq. (4)."}, {"section_title": "4:", "text": "Calculate the sample weights in\u00c2 by Eq. (5). 5: repeat 6:\nFix A and solve w in Eq. (6)."}, {"section_title": "7:", "text": "Fix w and solve A in Eq. (6). 8: until convergence 9:\nDiscard insignificant samples and features based on the values in A and w."}, {"section_title": "10:", "text": "Weight the remaining features by the coefficients in w. 11: end for Output:\nSubset of samples and features for classification model training.\nalgorithm is used. The optimization on A is a constrained quadratic programming problem and it can be solved using the interior-point algorithm. After this hierarchy, insignificant features and samples are discarded based on the values in w and A, and the remaining features are weighted by the coefficients in w. The remaining samples with their updated features are used in the next hierarchy to further refine the sample and feature set. The entire process of the proposed method is summarized in Algorithm 1."}, {"section_title": "Experiments", "text": "Experimental Settings: We consider three binary classification tasks in the experiments: AD vs. NC, MCI vs. NC, and pMCI vs. sMCI. A 10-fold crossvalidation strategy is adopted to evaluate the classification performance. For the unlabeled data used in our method, we choose the irrelevant subjects with respect to the current classification task, i.e., when we classify AD and NC, the data from MCI subjects are used as unlabeled data. The dimension of the SNP features is reduced to 100 before the joint feature and sample learning. The neighborhood size k is chosen by cross-validation on the training data. After each hierarchy, 5 % samples are discarded, and the features whose coefficients are smaller than 10 \u22123 are removed. To train the classifier, we use LIBSVM's implementation of linear SVM 3 . The parameters in feature and sample selection for each classification task are determined by grid search on the training data."}, {"section_title": "Results:", "text": "To examine the effectiveness of the proposed hierarchical structure, Fig. 2 shows classification accuracy (ACC) and area under receiver operating characteristic curve (AUC) with different number of hierarchies. It is observed that the use of more hierarchies benefits the classification performance in all tasks, although the improvement becomes marginal after the third hierarchy. Especially for cases such as pMCI vs. sMCI, where the training data are not abundant, keeping discarding samples and features in many hierarchies may result in insufficient classification model training. Therefore, we set the number of hierarchies to three in our experiments. It is also worth mentioning that compared to AD vs. NC classification, MCI vs. NC and pMCI vs. sMCI classifications are more difficult, yet they are important problems for early diagnosis and possible therapeutic interventions. For benchmark comparison, the proposed method (ss-HMFSS) is compared with the following baseline methods: (1) classification using MRI features only without feature selection (noFS (MRI only)), (2) classification using SNP features only without feature selection (noFS (SNP only)), (3) classification using concatenated MRI and SNP features without feature selection (noFS), (4) classification using concatenated MRI and SNP features with Laplacian score for feature selection (Laplacian), and (5) classification using concatenated MRI and SNP features with Lasso-based sparse feature learning (SFL). In addition, we evaluate the performance of our method using labeled data only (HMFSS). Besides, we also report sensitivity (SEN) and specificity (SPE).\nThe mean classification results are reported in Table 1 . Regarding each feature modality, MRI is more discriminative than SNP to distinguish AD from NC, while for MCI vs. NC and pMCI vs. NC classifications, SNP is more useful. Directly combining features from two different modalities may not necessarily improve the results. For example, in AD vs. NC classification, simply concatenating SNP and MRI features decreases the accuracy due to the less discriminative nature of the SNP features, which negatively contribute in the classification model learning. This limitation is alleviated by SFL. In our method, we further improve the selection scheme in a hierarchical manner and only the most discriminative features and samples are kept to train the classification models. Even without using unlabeled data, our method (i.e., HMFSS) outperforms the other baseline methods. By incorporating unlabeled data to facilitate the learning process, the performance of our method (i.e., ss-HMFSS) is further improved. It is also worthwhile to mention that when only feature example is enabled in our method, the accuracies for the three classification tasks are 91.1 %, 77.2 %, and 77.9 %, respectively, which are all inferior to the results using both feature and sample selection. Compared with a state-of-the-art method for AD diagnosis [10] , which considers the relationships among samples and different feature modalities when performing feature selection, at least a 1-2% improvement in accuracy is achieved by our method on the same data. Regarding the computational cost, our method in Matlab implementation on a computer with 2.4 GHz CPU and 8 GB memory takes about 15 s for feature and sample selection, and the SVM classifier training takes less than 0.5 s."}, {"section_title": "Conclusions", "text": "In this paper, we have proposed a semi-supervised hierarchical multimodal feature and sample selection (ss-HMFSS) framework for AD/MCI diagnosis using both imaging and genetic data. In addition, both labeled and available unlabeled data were utilized to preserve the data manifold in the label space. Experimental results on the data from ADNI cohort showed that the hierarchical scheme was able to gradually refine the feature and sample set in multiple steps. Superior performance in different classification tasks was achieved as compared to the other baseline methods. Currently, data from two modalities including MRI and SNP were used. We would like to extend our method to utilize data from more modalities, such as positron emission tomography (PET) and cerebrospinal fluid (CSF), to further improve the diagnosis performance."}]
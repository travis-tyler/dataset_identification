[{"section_title": "Abstract", "text": "Abstract-This paper presents a novel surface registration technique using the spectrum of the shapes, which can facilitate accurate localization and visualization of non-isometric deformations of the surfaces. In order to register two surfaces, we map both eigenvalues and eigenvectors of the Laplace-Beltrami of the shapes through optimizing an energy function. The function is defined by the integration of a smoothness term to align the eigenvalues and a distance term between the eigenvectors at feature points to align the eigenvectors. The feature points are generated using the static points of certain eigenvectors of the surfaces. By using both the eigenvalues and the eigenvectors on these feature points, the computational efficiency is improved considerably without losing the accuracy in comparison to the approaches that use the eigenvectors for all vertices. In our technique, the variation of the shape is expressed using a scale function defined at each vertex. Consequently, the total energy function to align the two given surfaces can be defined using the linear interpolation of the scale function derivatives. Through the optimization of the energy function, the scale function can be solved and the alignment is achieved. After the alignment, the eigenvectors can be employed to calculate the point-to-point correspondence of the surfaces. Therefore, the proposed method can accurately define the displacement of the vertices. We evaluate our method by conducting experiments on synthetic and real data using hippocampus, heart, and hand models. We also compare our method with non-rigid Iterative Closest Point (ICP) and a similar spectrum-based methods. These experiments demonstrate the advantages and accuracy of our method."}, {"section_title": "INTRODUCTION", "text": "Shape registration is one of the important research topics for scientific visualization, computer vision, and shape analysis. In biomedical area, its application ranges from analyses of cardiac deformations [1] to brain structures deformations caused by diseases such as epilepsy [2] or Alzheimer [3] . Considering that the deformations of most organs such as heart or brain structures are non-isometric, it is very difficult to find the correspondence between the shapes before and after deformation, and therefore, very challenging for diagnosis purposes.\nTraditional landmark-based methods usually detect relevant corresponding points or curves in two shapes, i.e., landmarking is essential in many shape registration and mapping applications [4] , [5] , [6] , [7] , [8] , [9] . There are two drawbacks in this type of methods. First, due to the shape complexity of organs, these methods require labor-intensive human intervention when done manually, or error-prone if conducted automatically through spatial detection [10] . Secondly, in many situations, there exists no salient spatial landmarks in the non-isometric deformations, e.g., in left ventricle of heart or brain hippocampus.\nShape spectrum is another method to represent the shape. There is a powerful tool called Laplace-Beltrami (LB) operator that can analyze the intrinsic property of the shape. Employing this operator, Reuter [11] and L\u00e9vy [12] defined a shape spectrum approach with the Laplace-Beltrami operator on a manifold and employed the eigenvalues and eigenvectors as a global shape descriptor [13] , [14] . The eigenvectors are orthogonal basis functions; therefore, the shape can be projected to the orthogonal bases and then analyzed and reconstructed using these bases [15] . As the geometry changes, the spectrum of the shape changes as well. Some studies employed the spectrum of this operator to classify, register, and differentiate shapes [16] , [17] , [18] , [19] . However, the spectrum through these methods can only show the global difference between shapes and cannot map and quantify the non-isometric shape differences due to the lack of non-isometric registration with spectrum. Hamidian et al. [20] , [21] proposed an alignment method through the eigenvalues, however, the point-to-point correspondence cannot be determined. Shi et al. [22] used the difference between the eigenvectors of two surfaces to generate a conformal mapping, but the method is computationally expensive. While many promising techniques were developed, there is still a lack of a method that can generate the correspondence between points for non-isometric shape structure change in a timely efficient fashion. In this paper, we focus on a method based on spectrum alignment of the non-isometrically deformed surfaces using both eigenvalue and eigenvector variations in order to find the correspondence and map the non-isometric deformations. To search for the alignment, we utilize a scale function on the surface that deforms one surface to a targeted one. Compared to the traditional approaches through the experiments, our method can accurately and automatically map and localize the point-to-point non-isometric deformations in addition to global difference of the shapes. Because the spectrum of shape only depends on the intrinsic geometry, our method is invariant to spatial translation, rotation, scaling, and isometric deformation. Furthermore, our method is computationally efficient and takes considerably less time to execute compared with existing methods [22] ."}, {"section_title": "Related Work", "text": "By definition, shape spectrum represents the information of intrinsic local geometry. It is invariant to isometric deformations and different triangulations. Reuter et al. [11] defined the spectrum of the Laplace-Beltrami operator of a shape as the signature or fingerprint of the shape. Rustamov in [23] employed the spectrum of this operator for shape clustering and classification purposes. L\u00e9vy in [12] employed the theory of stationary waves to study the behavior of eigenvectors and the static points of the eigenvectors. These points correspond to the locations that do not move in the theory of stationary waves. This study shows that the static points are strongly linked to the geometry of a shape and these points' locations change when the geometry varies. As these points are extracted from eigenvectors, they are invariant to isometric deformations of the shape. Thus, these points can be employed as the feature points to describe the geometry of the shape. Reuter et al. [24] , [25] employed these points, together with the domains generated by these static points, as topological features to segment and register different parts of the shapes. But the deformation of the shapes is restricted to be isometric in these studies. In reality, many deformations, such as heart motion, brain development, and so on, are not isometric. Hence, applying geometric spectrum methods for analyzing nonisometric deformation and registration is very challenging. Some recent work [26] , [22] showed that the shape spectrum can be controlled with a scale function on the Riemannian metric. Shi et al. [26] discussed that the eigenvalues and eigenvectors change according to the Riemannian metric of a manifold. Later in [22] , Shi et al. employed this metric to measure the difference between the eigenvectors of two surfaces in order to generate a conformal mapping between them. To this end, they minimized the difference between surfaces in the Laplace-Beltrami embedding space using an optimization approach. This work focused on eigenvector variation, but the eigenvalue variation was not investigated, and the method is very computationally expensive. For instance, to map two hippocampal surfaces with 1000 faces, the procedure took around 20 minutes on a computer with a 2.6-GHz Intel Xeon CPU and approximately 60 MB memory consumption. Instead, Hamidian et al. presented a method to align two surfaces by mapping their eigenvalues [20] , [21] . This method provided a deformation matrix showing the deformation of the initial surface to the target one but did not generate a point-to-point correspondence mapping of the vertices.\nThere exists other work that employs shape spectrum to match shapes. Rodol\u00e0 et al. [27] proposed a method based on the Laplace-Beltrami eigenvectors for computing partial functional correspondence between non-rigid shapes that have isometric deformation. Litany et al. [28] extended this study to match partial shapes that undergo topological noise and non-isometric deformation within the same framework. There are some limitations for this method. The main limitation lies in its reliance on good local features to drive the matching process. There are recent advances in the field of spectral shape analysis closely related to the proposed approach. For instance, Kovnatsky et al. [29] showed how to modify (align) the eigenvectors of the Laplace-Beltrami operator in order to match non-isometric shapes. Ovsjanikov et al. [30] proposed a spectral method for shape matching which is to find an alignment between eigenvectors based on a set of linear constraints. Later, they [31] presented a method for finding functional correspondence between manifolds based on the geometric matrix completion framework [32] . In [31] , [33] , [34] , visualizing shape deformations based on a spectral representation of the correspondence was shown. However, the key difference between the methods mentioned above and our proposed approach lies in the fact that our method is using both eigenvalues and eigenvectors to align two manifolds versus these methods employed only the eigenvectors. Also, our method extracts feature points from eigenvectors, instead of using all the points, and employs them to align two surfaces without loosing accuracy.\nIn this paper, we present a novel method that can align two surfaces and visualize the corresponding points through the variation of geometric spectrum. This is achieved by mapping eigenvalues and certain feature points extracted from the eigenvectors of two surfaces. Given two triangle meshes, the spectra can be varied from one to another with a scale function defined on each vertex. In order to compute the alignment, we aim to minimize an energy function which is the integration of a smoothness term for aligning the eigenvalues and a distance term describing the distance between the corresponding feature points. Optimizing this energy function is a quadratic programming problem which can be solved using an iterative method. Furthermore, we assume that the variation of eigenvalue is expressed as a linear interpolation of eigenvalues of the two surfaces. The derivative of the scale function is the solution of such a problem. Therefore, the final scale function can be computed by an integral of the derivatives from each step. Subsequently, the scale function can describe the mapped surface eigenvectors that can be employed to find the pointto-point correspondence. Our major contributions in this work can be summarized as follows:\n\u2022 We present a spectrum alignment algorithm using eigenvalue and eigenvector variations for 3D surfaces, supporting non-isometric global and local deformation analysis. In the discrete domain, the variation of eigenvalues and eigenvectors in terms of the scale function can be presented as matrices. Employing these matrices, together with the smoothness function to align the eigenvalues and a distance function to align the feature points extracted from eigenvectors, a linear system can be defined. By solving this system, the eigenvalues and eigenvectors are aligned and the corresponding points of the surfaces can be determined.\n\u2022 Feature points automatically extracted from eigenvectors of the surfaces, along with the defined distance between the corresponding feature points, can lead to an improved correspondence with considerably reduced computational cost. Because our method aligns both eigenvalues and eigenvectors at the same time, a limited number of feature points for the eigenvectors are sufficient to warrant the alignment. This helps to improve the accuracy and reduce the computational time considerably. These feature points are proven to be highly related to the geometry of the shape and they change when deforming the shape.\n\u2022 Our developed system demonstrates the accuracy and efficiency of the spectral variation and registration algorithm on visualization of nonisometrically deformed shapes. The applications to biomedical imaging problems show that it is a viable solution for morphometric analysis and visualization in biomedical applications and clinical diagnoses."}, {"section_title": "SURFACE REGISTRATION USING SPECTRAL OPTIMIZATION", "text": "In this paper, we employ Laplace-Beltrami operator to compute the geometric spectrum of a manifold. Let f 1 \u2208 C 2 be a real function defined on a Riemannian manifold M . The Laplace-Beltrami operator is defined as f 1 = \u00b7 ( f 1 ), where f 1 is the gradient of f 1 and \u00b7 is the divergence on the Manifold M . The eigen-system for this equation is defined as f = \u2212\u03bbf, where the family solution {\u03bb i } is a real nonnegative scalar and will result in the corresponding real family functions of {f i } for i = 0, 1, 2, .... To solve these differential equations, discrete differential operator is employed [35] . In this framework, Voronoi region for the vertices of a triangle mesh is used to construct the LaplacianBeltrami matrix as:\nwhere \u03b1 ij and \u03b2 ij are the two angles opposite to the edge in the two triangles sharing the edges i, j and A i is the area of Voronoi region at vertex i. k is the indices of triangles within 1-ring neighborhood of the vertex i. Therefore, the eigen equation turns to Lf = \u03bbf, where f is n dimensional vector for each \u03bb in which n is the number of vertices of manifold. To solve this equation we use a sparse matrix W and a diagonal matrix S such that:\notherwise, and S ii = A i . Thus, the Laplace Matrix L can be written as L = S \u22121 W and eigen equation can be presented as:\nwhere f n and \u03bb n are the nth eigenvector and eigenvalue, respectively. The eigenvectors for different eigenvalues are orthogonal in term of S dot product. Using this concept, an embedding I M : M \u2192 R \u221e is proposed as follows [36] :\nwhere \u03a6 = {f 0 , f 1 , f 2 , ...}. By finding the proper mapping between the eigenvector embeddings after solving the sign ambiguity, two shapes can be aligned. Considering that for each eigenvalue, there is an eigenvector of size n, mapping eigenvectors of two surfaces for all the vertices is timeconsuming. Therefore, we propose to use the eigenvector values for certain feature points to map the shapes."}, {"section_title": "Calculating the Feature Points", "text": "Using the spectrum of Laplace-Beltrami operator, L\u00e9vy [12] employed the theory of the stationary waves to model the shape. The spectrum contains a lot of information about the shape which can therefore be used for matching and mapping among different shapes. Looking closely to the eigenvectors, it shows that the n-th eigenvector can have at most n nodal domains. The nodal domains are the partitions of the surface that have the same sign. In this work, we are interested in the points, called nodal sets, which are the static points between two nodal domains. In other words, the nodal sets separate the nodal domains. These nodes are the still zones in the theory of stationary waves. L\u00e9vy in [12] showed that these points are strongly linked to the geometry of the shapes. In our method, we use the nodal sets of certain eigenvectors as the feature points to map the eigenvectors of two shapes. As mentioned before, the n-th eigenvector has at most n \u2212 1 nodal sets which partition the n nodal domains. We use this concept and employ the nodal sets of the eigenvectors corresponding to the first non-zero eigenvalue as the first set of feature points. Figure 1a shows the first non-zero eigenvector for a sample left ventricle of heart and the red set of points in Figure 1b show this first feature set. The second feature sets are the nodal sets for the eigenvector corresponding to the second or third non-zero eigenvalue that are parallel to the first set of feature points. We use the parallel points in order to get exclusive sets of points for mapping the eigenvector of two shapes. Figure 1c shows the eigenvector corresponding to the second nonzero eigenvector and the blue sets of points on Figure 1b present the second sets of feature points. This approach can provide us three sets of points that are used for matching the eigenvectors of different shapes. When needed, more nodal sets can be used. Using these feature points for mapping the eigenvectors, instead of using all of the points, reduces the computational time considerably. "}, {"section_title": "Spectral Registration Using Eigenvector and Eigenvalue", "text": "To register two surfaces, the challenge is how to minimize the difference between the two shapes in the spectral space. In order to align two surfaces using the LB spectral space, we aim to maximize the similarity between both eigenvalues and eigenvectors of the LB operator of the surfaces. As a result of non-isometric deformation, the eigenvalues and eigenvectors of the shape dramatically change. On a compact closed manifold M with Riemannian metric g, we define shape deformation as a time variant positive scale function \u03c9(t) : M \u2192 R + such that g \u03c9 ij = \u03c9g ij and d\u03c3 \u03c9 = \u03c9d\u03c3, where \u03c9(t) is non-negative and continuously differentiable.\nTo increase the similarity between eigenvectors, we try to minimize the distance of the eigenvectors on the feature points. Therefore, we need a distance function in the embedding space. We employ the distance measurment that was proposed in [22] . In order to find the optimal scale function \u03c9 for two surfaces (N, \u03c9g 1 ) and (M, g 2 ), the energy function is defined as follows:\nwhere\nand \u03c9 is the scale function that applies on N . \u03a6 1 and \u03a6 2 are the eigenvector basis for LB embedding of (N, \u03c9g 1 ) and (M, g 2 ). In this work, we focus on mapping one manifold to another and aim to find such a metric optimization. Therefore, we assume that the manifold M is fixed and N changes using the scale function \u03c9 to minimize the distance between M and \u03c9N on those feature points.\nTo increase the similarity of eigenvalues between two manifolds N and M , we employ the theorem proved in [21] , i.e., \u03bb n (t) is piecewise analytic and, at any regular point, the t-derivative of \u03bb n (t) is given by:\nThis theorem shows that the spectrum is smooth and analytical to non-isometric local scale deformation."}, {"section_title": "NUMERICAL OPTIMIZATION USING SPECTRAL VARIATION", "text": "In this section, we will detail a discrete algorithm for the alignment of non-isometrically deformed shapes through the variation of eigenvalues and eigenvectors. Consider two closed manifolds, N and M with the eigenvalues of \u03bb 1 and \u03bb 2 , and eigenvector basis of \u03a6 1 and \u03a6 2 . These two manifolds are represented with discrete triangle meshes. We use their first k 1 non-zero eigenvalues and eigenvectors to align two surfaces. As we mentioned before, the deformation is not isometric; thus the first k 1 eigenvalues and eigenvectors of these two surfaces are not the same. In order to align the first k 1 eigenvalues of N to those of M , a continuous scale diagonal matrix \u2126(t) is applied on N . \u2126 is an m by m matrix, where m is number of vertices on N . The element \u2126 ii at the diagonal is a scale factor defined on each vertex on N and will introduce a variation and alignment from N to M . It is a non-negative, continuously differentiable matrix.\nTo solve the numerical problem, we use the time interval of t and we divide the time interval of t \u2208 [0, 1] into K steps which we will index them as q. For each step of q, we solve an optimization equation to increase the similarity of eigenvalues and eigenvectors of \u2126N toward those of manifold M . At the beginning, t = 0, the eigenvectors and eigenvalues are \u03a6 1 and \u03bb 1 and \u2126(0) = I. When t reaches 1, the eigenvalues and eigenvectors will be \u03bb 2 and \u03a6 2 . In order to do that, we assume that the eigenvalues of N vary linearly toward those of M . This can be represented as:\nwhere n is the index of eigenvalues. Therefore, at any regular time of t, the derivative of \u03bb is constant and can be calculated as:\u03bb\nFor mapping of eigenvectors, in each step we minimize the distance function described in the Equation 4 between \u2126N and M . The following will explain the details how to calculate the optimization function to minimize the distance between eigenvalues and eigenvectors in each step."}, {"section_title": "Eigenvector Optimization Equation", "text": "To minimize the energy function in Equation 4 , we need to calculate the distance between two manifolds using Equation 5. In order to do that, we compute the k 1 eigenvalues and eigenvectors for both manifolds using Equation 2. One of the concerns about the calculating the eigenvectors is the sign ambiguity. This means that either f n or \u2212f n can be the eigenvector of a specific eigenvalue. For a target surface M , we fix the eigenvectors by picking random signs for \u03a6 2 . Then, we calculate the feature points as described before.\nFor the surface N , we start with \u2126 = 1 and in each step we update the surface using the optimized \u2126 to minimize the energy function E. At each step, we first calculate the k 1 eigenvalues and eigenvectors of the updated surface N using Equation 2. Then we calculate the three sets of feature points using the eigenvectors as explained before. We need to find the corresponding feature sets on two surfaces for solving the sign ambiguity of eigenvectors. As shown in Figure 1a , there is one nodal set for the eigenvector corresponding to the first non-zero eigenvalue. Therefore, these sets are matched on two surfaces. For the other two nodal sets, we calculate the corresponding sets using their signs on the eigenvector corresponding to the first non-zero eigenvalue. We first calculate and determine the sign of this eigenvector using the histogram of the positive and negative eigenvector values for both surfaces. As we mentioned before, the second sets of the nodal nodes are parallel to the first set. Also, the sets of nodes are at the opposite sides of the first nodal set. Therefore, each set of nodes has a different sign value on the first eigenvector. By knowing the sign of the first eigenvector, we can categorize and determine the corresponding sets of nodes for the second feature sets.\nBy detecting the corresponding feature sets in each step, we find the nearest feature points of surface N to the feature points of M that minimize the distance Equation 5 . To achieve this, we consider all combinations of signs for k 1 eigenvectors for surface N to minimize the distance equation. After finding the corresponding points and the signs, the points are employed to generate matrix C as the nearest feature points mapping from I\nwhere S(N ) is the surface area of N and \u2126 is the scale function. In this work, because we change the surface N toward surface M and surface M does not change in each step, the second part of the Equation 4 is zero and only the first part is used to calculate the numerical equation. Considering that in each iteration the corresponding feature points are calculated and the eigenvalues do not change, the derivative of E with respect to time can be defined as follows:\nwhere\nBecause \u2126 is a diagonal matrix, we extract the diagonal elements as a vector v \u2126 and Equation 10 can be rewritten as:\nUsing this equation, we update the eigenvectors through the numerical optimization of the gradient of the energy function in each step."}, {"section_title": "Eigenvalue Optimization Equation", "text": "In order to increase the similarity of two eigenvalues of \u03bb 1 and \u03bb 2 , we employ the method in [21] . Considering the scale function applies on the surface N , the weighted generalized spectral problem in Equation 2 can be presented as follows:\nwhere \u03bb n and f n are n-th corresponding solution. Using this equation, Equation 6 can be transformed in the discrete form:\u03bb\n\u03bb n is piecewise analytic. Considering that we only apply \u2126 on the surface N by combining Equations 8 and 13, the derivative of each \u03bb i (t) leads to the following equation:\nwhere S N is a diagonal matrix that each element shows the Voronoi region for the corresponding vertex. Although the time derivative of \u2126 can be calculated in Equation 14 , solving this equation is not straightforward. We need to transform the individual integration equation into a linear system. We achieve this by extracting the diagonals as vectors v \u2126 and v S N , and then applying Hadamard product to Equation 14. Thus, this equation can be rewritten in a linear form as follows:\nNote that, as the first k 1 eigenvalues are going to be aligned, we can get k 1 independent equations, which lead to a linear system as follows:\nwhere a is a row stack of (v\n. Considering that we use the first k 1 eigenvalues for this work and that practically k 1 is much less than the number of nodes in the mesh, the system is underdetermined and has no unique solution.\nWe solve this by assuming that the scale factors distributed on N are smooth. On the discrete triangle mesh N , with the scale function vector v \u2126 , the smoothness energy of E is define as:\nwhere L N can be calculated using Equation 1 for manifold N . Because the scale vector applies to surface N only, this equation only applies to surface N . Assuming that v \u2126 is known at each time t, v\u03a9 is going to minimize the quadratic smooth energy. Then it leads to the following equation:\nwhere z = W N v \u00b7\u2126 . Through the combination of this energy function and the energy function calculated for eigenvectors, the distance between the eigenvalues and eigenvectors of two surfaces can be minimized."}, {"section_title": "Energy Equation Integration", "text": "In order to increase the similarity of eigenvalues and eigenvectors of two surfaces, we integrate the energy function calculated for both eigenvalues and eigenvectors in order to find a scale matrix that minimizes the total energy function as follows:\nIn order to preserve the physical availability, v \u2126 must be bounded, i.e., the scale factor cannot be zero or negative; and it cannot be infinite either. We denote a lower bound\nThis inequality bound can be written into a matrix form:\nwhere G is a stack of identity matrices as:\nand h is a 2n dimensional vector as:\nThe linear system (Equation 16), energy function (Equation 19) , and constant bound (Equation 21) form a quadratic programming problem at each time t. Assume the eigenvalues and eigenvectors are known at each time t, the derivative of the scale matrix\u03a9 is the solution of this problem. The result\u03a9(q) for each iteration can be used to calculate \u2126(q + 1) as follows:\nAfter K steps, the desired \u2126(K) will be achieved and two manifolds are aligned. The summary of the algorithm can be found in Algorithm 1. As shown, after K steps surface N will be aligned to surface M and the correspondence can be computed using the aligned eigenvectors."}, {"section_title": "Algorithm 1 Spectrum Alignment", "text": "Require: Closed 2D manifolds N and M , represented by triangle meshes, and constant k 1 ; Ensure: Diagonal weight matrix \u2126(q) on N , aligning first k 1 non-zero eigenvalues and corresponding eigenvectors of feature points from N to M ; 1: Initialize \u2126(0) \u2190 I, calculate matrices W N and S N , and \u03bb 2,n , f 2,n , \u03bb 1,n , and f 1,n , for n = 1, 2, . . . , k 1 ; 2: Compute the feature points for surfaces M . 3: while q < K do a: Calculate \u03bb 1,n (q), f 1,n (q), for n = 1, 2, . . . , k 1 using Equation 2 with \u2126(q); b: Calculate the feature points for surface \u2126(q)N using f 1,n (q); solve the eigenvector sign ambiguity; and find the corresponding feature points between surfaces \u2126(q)N and M ; c: Construct the quadratic programming problem using Equations 16, 19, and 21; d: Solve the quadratic programming problem to get\u03a9(q) and calculate \u2126(q + 1); e: q \u2190 q + 1; 4: end while 5: The correspondence of surface N and M can be computed using the aligned eigenvectors."}, {"section_title": "EXPERIMENTS AND APPLICATIONS", "text": "The proposed algorithm and system are implemented using Python and C++ on a 64-bit Linux platform. For visual- ization purposes, we employ MATLAB and VTK library in Python. The experiments are conducted on a computer with an Intel Core i7-3770 3.4 GHz CPU and 8 GB RAM. We apply our algorithm to 2D manifolds, represented with triangle meshes. We employ the approach in [37] , [38] to generate the uniform meshes. The number of vertices in those meshes is about 3000 for most of the experiment data. Besides the vertex number, there are two constants, i.e., K iteration and the first k 1 nonzero eigenvalues and eigenvectors to be aligned. For our experiments we choose K = 10. This number is sufficient to generate accurate results. We use different k 1 for different experiments. Depending on the resolution that we need in our experiments, the number k 1 may vary. The average computational time for 3000 nodes, with k 1 = 8 and K = 10, is around 12 seconds."}, {"section_title": "Experiments on Synthetic Data", "text": ""}, {"section_title": "Our Results", "text": "In order to evaluate our method, we manually make some non-isometric deformations on the surface of the shape and then we register the initial shape to the deformed one. In these experiments, we use a Stanford bunny model and make a non-isometric deformation on the surface and then generate uniform triangle meshes on both surfaces. We employ the first 10 non-zero eigenvalues and the corresponding eigenvectors to do the alignments. The processing time for k 1 = 10, K = 10, and 3000 mesh vertices is about 43 seconds. Note that, no correspondence information is used in the experiments.\nIn the first experiment, we manually generate a bump on the back of a bunny and align the original surface to the deformed one. Figure 2 shows the original surface in cyan and target surface in yellow. The location of the bump is marked by a red circle. Figure 2c and 2d present the results of point-to-point mapping of the surfaces from different angles. The original and targeted shapes are overlaid and the arrows in the bump area show the deformation of each vertex from the original to the targeted surface.\nIn the second experiment, we manually create an indentation on the surface of a bunny and align the original surface to the dent one. Figure 3a and 3b show the original and the surface results of creating the non-isometric dent on the surface, respectively. Figure 3c and 3d present the result of point-to-point mapping of surfaces using our method. The original and targeted shapes are overlaid and the arrows in the bump area show the deformation of each vertex from the original to the targeted surface. These results confirm that our method can accurately detect and localize the nonisometric deformation and find the corresponding points.\nFor more complex and challenging deformations, we use a hammer model and create 2000 uniform meshes on the surface. Then we create different non-isometric deformations on the surface and align the original surface to the deformed one. Figure 4 show the original hammer in yellow color and target deformed hammers in the cyan color. Figures 4c, 4f, 4i, and 4l show the results of aligning the original surface to the deformed ones using our method. The point-to-point alignments are demonstrated using the arrows that connect the corresponding points on the original and deformed surfaces. The original and target surfaces are overlaid in these figures. These results conclude that our method can detect the simple and complex non-isometric deformations on the surface accurately."}, {"section_title": "Comparison to a Spatial-based Method", "text": "In order to further demonstrate the capabilities of our method, we compare the results of our algorithm with the ones from non-rigid Iterative Closest Point (ICP) algorithm. ICP is introduced by Besl and Mckay in [39] and is one of the popular approaches in spatial registration-based methods. In this approach, the initial transformation for global matching is first estimated and then the closest points are found by minimizing the distance between two shapes. Therefore, using this method we first register the original surface to the target one rigidly and then the corresponding points between the rigidly registered original shape and the target shape are calculated. For our method, we employ the first 12 non-zero eigenvalues and the corresponding eigenvectors for alignment purposes. The processing time for 3000 vertices, k 1 = 12 and 10 iterations is 118 seconds.\nIn order to compare two methods, we use a template hippocampus and synthetically deformed the shape by bending and stretching the shape from upper and lower sides. The original and deformed surfaces are shown in Figures 5a and  5b , respectively, which exhibit global variation. Figure 5c presents the overlay of the original and deformed shapes. As can be seen, the top and the bottom parts of the surface are stretched and the shape is bent in the middle part. Figure 5d shows the result of performing ICP rigid registration on the original shape to map it to the deformed shape. Comparing  Figures 5c and 5d , one can notice that the rigid ICP does not match the shapes correctly, especially in the top and bottom regions of the shapes. Figures 5e and 5f present the results of our method and non-rigid ICP, and the arrows show the displacement of each vertex on the surface. Because the ICP method fails in the rigid registration stage, the corresponding points calculated using non-rigid ICP do not reflect the accurate deformation, especially in the top and bottom region. On the other hand, because our method does not require pre-rigid registration to find the corresponding points, this variation can be captured by our registration and mapping method accurately. These results justify the advantage of our method over the rigid and non-rigid ICP method. In order to demonstrate that our method can handle both global and local deformation simultaneously, we create a bump on the shape of Figure 5b as shown in Figure 5g . Then we align the surface in Figure 5a to Figure 5g using our method. Both global and local deformations (bump) can be captured by our method as shown by arrows in Figure 5h . Therefore, these results confirm that our method can detect and localize the non-isometric deformation and find the correspondence and their displacements resulted from both global and local deformations."}, {"section_title": "Comparison to a Spectral-based Method", "text": "In order to compare our method with a similar spectralbased technique, we employ an approach suggested by Shi et al. in [22] . They proposed a method based on aligning the eigenvectors of two surfaces via optimization of a conformal metric on the surfaces. They employed the eigenvectors for all the points of the surfaces therefore the computation is very expensive.\nIn this experiment, we employ a template hippocampus and create 1500 uniform vertices on the surface. Then, similar to the previous section, we synthetically deform the shape by bending and stretching the shape from upper and lower sides. The bending and stretches are larger in this experiment than in the previous one. Figures 6a and  6b show the original and synthetically deformed surfaces, respectively. Figures 6c and 6d show the results of the shows the result of ICP rigid registration result. The ICP method register the shape from one side and therefore this method cannot generate accurate result for bending deformation. (e) and (f) present the results of point-to-point mapping from the original surface to the deformed one using our method and ICP method, respectively. Because the result of non-rigid ICP depends on rigid ICP, the result is not accurate. Our method can detect the deformation accurately. In order to show that our method can handle both global and local deformation simultaneously, we make a bump on the deformed surface as presented in (g). The result of mapping (a) to (g) is presented in (h). shows the result of mapping these two shapes using our method. (e) presents the color map visualization of the corresponding points of the shapes using our method. alignment using Shi et al.'s and our methods. As can be seen, the bottom tip of the surface cannot be aligned correctly using Shi et al.'s method but our method can align all the points accurately.\nIn order to quantitatively evaluate the capabilities of these methods in localizing the point-to-point correspondence, we use the following metric:\nwhere d i is the distance between corresponding points calculated using either methods, d\nO i is the known ground truth distance, m is the number of all nodes and i is the index of nodes. The experiments demonstrate that the average outcome for our method is 91.4% while it is 85.8% for Shi et al.'s method. This number is 75.6% for ICP method. Therefore, our method can find the point-to-point correspondence better than the other two methods for complex deformation. In this experiment we use 10 iterations and 12 non-zero eigenvalues and eigenvectors to do the alignments. For 1500 mesh vertices, our method takes 67 seconds while Shi et al.'s approach takes 94 minutes. In [22] , they mentioned that their execution time for 1000 triangle faces with approximately 500 vertices, is 20 minutes. Table 1 demonstrates the comparison between our method, Shi et al.'s method, and non-rigid ICP method. As mentioned before, non-rigid ICP method requires rigid registration before aligning two surfaces while Shi et al.'s and our methods do not have this requirement. All the methods can localize the deformation of the surface but our method has the best average accuracy based on metric defined in Equation 25 . The computational time for our method is considerably less than Shi et al.'s method and similar to non-rigid ICP. Therefore, our method has the best features to align two surfaces."}, {"section_title": "Applications on Real Patient Imaging Data", "text": ""}, {"section_title": "Alzheimer Data", "text": "Alzheimer disease (AD) is a brain mis-functionality that is caused by the loss of neurons and neural volume. Hippocampus is vulnerable to damage in the early stage of Alzheimer. Volumetric longitudinal studies using MR images show hippocampal atrophy during time in comparison to healthy cases. In this study we show the point-to-point deformation for an Alzheimer case. We employ 10 AD and 10 healthy cases, which have longitudinal study for one year to track and compare the deformation of hippocampi. The cases are downloaded from the hippocampal study from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu) and are segmented using FreeSurfer software. Then, the 3D objects and meshes with 3000 vertices are generated. In this study, we use the first 10 eigenvectors to align the surfaces. Figures 7a and  7b show a sample of AD case for the baseline and after one year. The deformation in the tail part can be detected visually. The deformation mapping is shown by using the blue arrows in Figure 7c . It needs to be mentioned that the deformation mapping is down-sampled by five in order to better visualize the results. As can be seen, our method can detect the deformation accurately. Figure 7d shows the 6th eigenvector before and after alignment. Columns A and B show the eigenvector for the baseline surface before and after alignment, respectively. Column C shows the targeted surface eigenvector. It is noted that our method can match and align the eigenvectors. The color map shows the scaled value of the eigenvector.\nIn order to show the variation of eigenvalues of the manifolds before and after alignment, we list the 2nd to 10th non-zero eigenvalues of baseline hippocampus (before and after mapping) and hippocampus after one year in Table 2 . The eigenvalues are normalized by the first nonzero one to remove the scale factor. It can be seen that after applying the spectrum alignment algorithm, the eigenvalues of the source manifold have changed to well align with the target ones.\nTABLE 2: The result of aligning eigenvalues from the baseline hippocampus to one after one year (target) using the same case as in Figure 7 . "}, {"section_title": "Cardiac Data", "text": "We use the Sunnybrook Cardiac Data [40] for this experiment. The data is acquired from the 3D left ventricle during cardiac cycles from end diastolic to end systolic, and then, back to end diastolic cycle. For this study, we use five cases for each category: heart failure with infarction, heart failure without infarction, left ventricle (LV) hypertrophy, and healthy. Meshes with 5000 vertices are generated. 10 non-zero eigenvalues and the corresponding eigenvectors are used for alignment. We map the surface for the end diastolic (first time point) to all other 19 time points. Then, the mean averages of the displacements for all the nodes are calculated and used to generate a plot of surface displacement for 19 different time points. Figure 8a shows the result of mapping these surfaces using our method and the mean average plot for a sample case. The first shape close to the origin of the axes is the diastolic shape and the rest of the shapes are the target ones. As can be seen, the results follow the heart beating pattern. Figure 8b shows the overlay of the first time point surface (cyan) to the 7th one (yellow) which has the most mean displacement according to the average plot. The results of mapping these two surfaces are also presented in this figure by using arrows, which connect the corresponding points and show the point-to-point deformation mapping. One can see that our method can detect the contraction and the tangential turning deformation of the heart. This method can be used in different applications in cardiac study. The first application is longitudinal study of a subject. In this study, the 3D images of the subject are generated for more than one heart beating full cycles. Using these models, the deformation plot for mean average of displacement can be generated. Physicians usually look at more than one cycles to exam the abnormality of the heart. By using our method, the abnormality can be detected via the mean average plot and then using the point-to-point deformation mapping to find out the specific abnormal time points. Therefore, the abnormal area of the ventricle may be detected. Figure 9a shows three heart beating cycles and the one time point which is marked by a red circle in the 2nd cycle showing abnormality according to its location. As can be seen, the abnormality can be detected using our method. We detect this abnormality by creating a bump ( Figure 9c ) on a heart surface ( Figure 9b ). Then, our method can generate the displacement color map and the abnormal region can be also located (Figure 9d ). The second application is the cross-subject analysis through temporal alignment. The same time point of a heart (a)\nThe longitudinal study for a subject using our method. By studying more than one cycle, the abnormal beat can be detected using our method and the abnormal area of the left ventricle can be identified. (a) shows 3 heart beat cycles and the abnormal time point is marked by a red circle. We create this abnormality by creating a bump on a heart surface. (b) shows the original heart. (c) shows the deformed surface. The deformed area is marked by a red circle. (d) shows the displacement color map generated by our method to detect the abnormal region.\nbeat cycle for two different subjects can be identified. For instance, in one subject, the largest heart contraction may happen at the 7th time point, but in another subject, the largest heart contraction may be detected in 8th time point. Using our method, different time points in different subjects can be aligned according to the heart beating cycle through temporal alignment. Figure 10 shows this procedure. Using this alignment, we can align different healthy cases and then use the aligned mean average mapping to generate a standard mean average mapping. This mapping can be used to compare with normal and patient cases in order to categorize the abnormal cases from the normal ones by using the difference indicator between this mapping and a target one. In Figure 11 , the red plot shows the standard mean average plot generated by calculating the average of mean average mappings from temporally aligned five healthy cases. Figure 11a shows a healthy case in a blue curve, as compared with the standard mean average mapping. Figure 11b shows a diseased case in a green curve when temporally aligned to the standard mean average mapping and Figure 11c shows a LV hypertrophy case in a black curve. Yellow area shows the difference between two curves. As can be seen, the difference area in healthy case is much less than that in the patient cases. Using difference area, one can accurately categorize healthy cases from patient cases. Figures 11d, 11e , and 11f show the displacement mapping of the left ventricle from the diastolic to systolic state for normal, diseased, and hypertrophy cases showed in Figures 11a, 11b , and 11c, respectively."}, {"section_title": "Application on Hand Data", "text": "In order to demonstrate that our method can be used on non-medical applications as well, we use data of different hand gestures and create 3000 uniform vertices on the surfaces. Figures 12a, 12b , and 12c show different gestures of the hand. We employ the shape in Figure 12a as the original surface and then align it to the shapes in Figures 12b,  and 12c . Figures 12d and 12e show the results of this alignment using our method. The original and target surfaces are overlaid and the point-to-point alignment is shown using the arrows that connect the corresponding points. As can be seen, different parts of the hand are aligned correctly and our method can detect the point-to-point correspondence accurately."}, {"section_title": "CONCLUSION AND DISCUSSION", "text": "In this paper, we have introduced a new method based on shape spectrum to find the point-to-point correspondence between two surfaces undergoing global and local deformations. We employ both eigenvalues and eigenvectors of the surfaces in the alignment. Our method can localize the non-isometric deformation of the surface and find the displacement mapping for all the vertices. Because we use certain feature points instead of all the vertices to align the eigenvectors, our method is considerably more efficient than existing methods. We have applied our method to both synthetic and real data, and the results confirm the advantage and accuracy of our method. We have also compared our method with non-rigid ICP method and a similar spectrumbased method. The results show that our method has the best accuracy. In terms of computational time, our method is considerably faster than previous spectrum-based method and similar performance as non-rigid ICP method. Note that, for searching for proper eigenvectors, in addition to sign ambiguity, there are some cases that the order of the eigenvectors switches. In addition, by using large number of eigenvectors, numerically it is possible for near multiplicities of eigenvectors to cause the eigen-spaces to split in different directions [22] . In such cases, the eigenvectors matching becomes difficult. In our algorithm, we mainly focus on resolving the sign ambiguities. The order switching of eigenvectors and detection of high dimensional multiple eigenvectors will be our future research work. "}]
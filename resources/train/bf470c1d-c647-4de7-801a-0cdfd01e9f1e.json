[{"section_title": "Introduction", "text": "Thanks to advances in computational power, global climate models are now configured with increasingly higher horizontal resolution, thus resolving the baroclinic deformation radius in the tropics. However, the extension of the range of application of this type of model will raise some new challenges for the climate community. Oceanic General Circulation Models (OGCMs) (Bryan, 1969) have been designed using discrete algorithms that significantly differ from the methods used for high-resolution regional applications and more generally for computational fluid dynamics applications. Indeed, for coarse resolution global simulations it is considered to be essential to ensure conservation of water masses, as well as quantities like energy, potential vorticity or enstrophy (Sadourny, 1975). For higher resolution eddy-resolving studies, the emphasis is put more on local accuracy and good dispersion properties. The regional numerical models are thus generally based on multiple-time-level time-stepping and high-order upstream-biased advection schemes. The significant differences in the numerical kernels used by the climate community and the regional community make it difficult to come up with a clear view of the best options when multi-scale, long-term simulations are considered. This is a crucial dilemma because multi-resolution configurations via 1-way or 2-way nesting techniques have now reached a certain maturity (Penven et al., 2006;Debreu and Blayo, 2008;Mason et al., 2010;Debreu et al., 2011) and are increasingly used. This type of practice makes it essential to assess the relevancy of a given numerical kernel to simulate the ocean circulation over a wide range of spatio-temporal scales because the same numerical model is used to integrate the entire hierarchy of grids, from a coarser one to a finer one. This paper focuses on the ability of a regional model like the Regional Oceanic Modeling System (ROMS, Shchepetkin and McWilliams (2005)) to deal with coarse resolution basin-scale applications. ROMS has been extensively used so far for mesoscale (e.g., Marchesiello et al. (2003); Colas et al. (2011)), submesoscale (e.g., Capet et al. (2008)), and nearshore flows (e.g., Uchiyama et al. (2010)). We show that, with some adjustments of the algorithmic choices, this model can also be adequate to simulate large-scale flows, thus paving the way toward meaningful studies of the upscaling/downscaling interplay. ROMS, as well as many other regional models, is discretized using a terrain following \u03c3-coordinate. Traditionally, the use of this type of vertical coordinate has been considered as a disadvantage, compared to the other vertical coordinate systems, in carrying out large scale simulations (Griffies et al., 2009a). Early attempts using the Princeton Ocean Model (POM) (Ezer and Mellor, 1997) and the S-coordinate Primitive Equation Model (SPEM) (Barnier et al., 1998) have clearly shown that \u03c3-errors associated with the tracer diffusion and horizontal pressure gradient can be very harmful. The DYNAMO (Willebrand et al., 2001) and DAMEE (Chassignet et al., 2000) projects aimed at intercomparison of different classes of models in eddy-permitting regimes. They showed that isopycnic and terrain following coordinates were in general inferior to z-level models in simulating large-scale characteristics of the North Atlantic circulation. However, at that time the MOM (Modular Ocean Model) z-level model used for those inter-comparisons had been used for a long time and had reached a level of maturity, while the \u03c3 or isopycnal models were at an early stage of their development. Beside the difficulties in representing the oceanic interior adiabatic dynamics and the horizontal pressure gradient, terrain-following models also require a vertical mixing parameterization that is robust to changes in vertical resolution. Indeed, the resolution in the upper layers can change by one order of magnitude between the shelf and the open ocean. During the last 10 years major improvements have been brought to different components of the \u03c3-coordinate models (Ezer et al., 2002;Shchepetkin andMcWilliams, 2003, 2005;Marchesiello et al., 2009) resulting in a much more advanced level of maturity. As indicated by Danabasoglu (2007), it is legitimate to reassess the status of this class of model for basin-scale simulations. This paper is organized as follows. The adjustments made to the tracer advection to improve the representation of the oceanic interior adiabatic dynamics are presented in Sec. 2. Section 3 focuses on the redesign of the vertical mixing in ROMS necessary to predict efficiently the mixed-layer extent. The methodology to implement a basin-scale Pacific configuration is in Sec. 4. Finally, in Sec. 5 and 6 we assess the Pacific simulation with particular emphasis on the mixed-layer depth, the representation of water mass properties, and the horizontal circulation."}, {"section_title": "Active Tracer Advection", "text": "It is well known that the oceanic interior is highly adiabatic in the sense that tracer properties are little mixed across the neutral directions. A numerical simulation needs to respect these small levels of diapycnal mixing and therefore requires a careful design of the numerical schemes responsible for the tracer transport. In this section we first briefly recall the difficulties we face when designing a tracer advection scheme. Then, we describe our rationale for implemented formulation. This formulation is a generalization of the RSUP3 (Rotated Split UPstream-biased 3rd order) scheme proposed by Marchesiello et al. (2009). We modified this scheme to rotate the hyperdiffusive part in the neutral direction as well as to increase its stability range. We discuss here only the horizontal advection problem; in the vertical direction the use of centered (non dissipative) schemes is well-established and the level of associated spurious mixing is usually weak enough to be considered acceptable to maintain the integrity of the stratification. This point will be further discussed in Sec. 4.1. Throughout this paper, x and y are the horizontal directions aligned with the computational grid, z is the vertical coordinate taken positive downward, and t is the time variable. We note q the tracer field of interest, q can represent either temperature or salinity."}, {"section_title": "Advection and Diffusion", "text": "For long-term climate simulations, maintenance of the water mass properties is a strong requirement. The amount of \"spurious\" diapycnal mixing associated with the horizontal advection-diffusion of tracers must, therefore, be as small as possible (Griffies et al., 2000). For the particular case of \u03c3-coordinate models, this problem of non-physical mixing of water masses has been emphasized by Barnier et al. (1998). They showed that maintaining the diffusion tensor in the iso-\u03c3 direction can be responsible for large spurious baroclinic currents. The order of magnitude of those spurious currents is significantly reduced when a rotation in the geopotential direction is used. Advection and diffusion must be consistently defined because purely advective (centered) schemes allow accumulations of variance at the smallest resolved scales (i.e., the grid scale), and this variance must be controlled through smoothing of the fields by a dissipative operator. This operator must be carefully tuned; otherwise, dispersive errors will persist and grow over time leading to physically unrealistic results (Hecht, 2010). The usual practice in non-isopycnic large scale ocean models is the use of centered schemes with an explicit, usually second-order, diffusive operator rotated in the neutral direction (Redi, 1982;Griffies et al., 2000). A long-standing problem in this context is related to the choice of the diffusion coefficients (isotropic vs. anisotropic, flow dependent vs. spatially constant). For regional applications the use of high order upwind advection schemes (e.g., with an hyperdiffusive truncation error) thought to be satisfactory to keep spurious mixing at an acceptable level. Moreover, for this type of application, the flow is generally constrained by open boundary conditions that help to control the water mass errors. However, recent studies pointed out that under some circumstances the associated truncation error was greatly exceeding the small level of physically acceptable mixing observed in the oceanic interior (Marchesiello et al., 2009). The physical results proved to be improved when using either very complex non-linear advection schemes with minimal implicit dissipation (Tatebe and Hasumi, 2010) or advection schemes with an (hyper-) diffusive part rotated in the geopotential direction (Marchesiello et al., 2009). In the present study we essentially follow the approach suggested in Marchesiello et al. (2009). Several modifications are made to make the scheme work with isoneutral hyperdiffusion as well as extending its stability range."}, {"section_title": "\u03b3-Scheme Formulation", "text": "The regional oceanic models usually rely on upwind-biased high-order advection schemes. Several authors (e.g., Holland et al. (1998); Webb et al. (1998)) have underlined the fact that odd-ordered schemes are equivalent to the next higher ordered (even) scheme plus a diffusive term of the higher even order. This type of splitting of the upwind schemes has been useful in studying the sensitivity of some turbulent flows to the level of dissipation (Shchepetkin and McWilliams, 1998) and useful in enabling the use of such schemes with leapfrog time-stepping. In this paper, only 3rd-order upwind schemes are considered because they are the standard for applications using ROMS, and also because higher-order schemes, although widely used for atmospheric flows, raise additional difficulties in maintaining the overall efficiency of the code and in designing the boundary conditions at the coasts. For a given tracer field q and zonal velocity u, the cell interfacial flux associated with 3rd-order upwind schemes, in the one-dimensional case, can be written in a very generic way using a \u03b3-formulation (Shchepetkin and McWilliams, 1998)  leading to the following modified equation where B x = \u03b3|u|\u2206x 3 3 . For \u03b3 = 1/4, this formulation is equivalent to the scheme proposed by Farrow and Stevens (1995), and for \u03b3 = 3/16, we retrieve the QUICK 1 scheme. In (2.1) the terms with coefficient \u03b3 represent a velocity-dependent hyperdiffusion vanishing when \u2206x \u2192 0, thus ensuring a dissipatively dominant truncation error. In (2.2), we keep the f adv term, corresponding to a centered advection, as it is, and we replace the hyperdiffusive f diff term by an isoneutral mixing term with the same hyperdiffusion coefficient. The resulting scheme is a fourth order centered scheme plus an explicit rotated biharmonic with flow dependent hyperdiffusivities chosen to mimic the third order upwind schemes. The rotation of the hyperdiffusive term is not straightforward because it introduces additional stiff terms into the problem, making it harder to maintain both stability and accuracy. More generally, to our knowledge, biharmonic isopycnal diffusion operators have not yet been successfully developed and implemented in non-isopycnic climate models."}, {"section_title": "Space-Time Discretization of the Tracer Mixing Operator", "text": "Since Redi (1982) it is very common for climate z-level models to rotate the diffusion tensor in a direction non-aligned with the computational grid (typically in the neutral direction). In \u03c3-coordinate models this type of rotation is also sometimes implemented but essentially in the geopotential direction (Stelling and Kester, 1995). The use of a second-order diffusive operator for climate models is satisfactory notably because this operator provides strictly downgradient tracer fluxes, preventing the development of unphysical cabbeling processes, (Griffies, 2004). For the present study we put more emphasis on the scale selectivity of the mixing operator to introduce less damping of the larger scales, thereby enabling higher levels of tracer variance. This is especially important because the scheme is also designed for future use in eddying regime. We, therefore, implemented a neutral biharmonic mixing operator D 4 , under the small slope approximation ad) ). The superscripts (ad) are used to emphasize the fact that it is necessary to perform the gradient operations in an adiabatic manner (thus removing pressure effects). The validity of the small slope approximation in the context of a \u03c3-coordinate model is discussed in Sec. 2.4.2. In (2.4), R corresponds to the so-called Redi-tensor in which we introduced the hyperdiffusivities B x and B y . Those anisotropic flow dependent coefficients are given by B x = |u|\u2206x 3 /12 and B y = |v|\u2206y 3 /12 corresponding to \u03b3 = 1/4. We split the biharmonic coefficients B x and B y into two square roots to ensure that this operator always dissipates the total tracer variance (Griffies, 2004). Moreover, it enables us to write the neutral biharmonic as the composition of two identical second-order operators. In (2.4) the neutral directions are computed by taking advantage of the formulation of the Equation of State (EOS) described in Shchepetkin and McWilliams (2003) and Shchepetkin and McWilliams (2011). This EOS form has the property to facilitate computation of adiabatic differences in all spatial directions. It is based on a Taylor expansion of the EOS proposed in Jackett and McDougall (1995), leading to where is the sea-water density at the standard pressure of 1 Atm (sea surface); \u03b8 is the temperature; S is the salinity; and the q \u2032 n terms represent the compressibility coefficients. This splitting of the EOS into two separate contributions allows for the representation of spatial derivatives of density as the sum of adiabatic derivatives and the compressible part. This makes it straightforward to remove pressure effects to compute the neutral directions (Eq. (3.6) in Shchepetkin and McWilliams (2011))."}, {"section_title": "Discretization in Space", "text": "The spatial discretization of the isopycnal mixing operators is a difficult problem that has been thoroughly tackled by Beckers et al. (1998), Beckers et al. (2000) and Griffies et al. (1998). Following those studies, as well as Lemari\u00e9 et al. (2011), we consider here the so-called LINEAR1 method described in Beckers et al. (2000). The idea behind this scheme is to make the stencil as compact as possible in the cross-isopycnal direction. In the triads formalism defined by Griffies et al. (1998), the fluxes needed to construct the rotated diffusion are computed as the sum of four triads with equal weights. The LINEAR1 scheme is built by introducing a weighted sum of the four triads in order to align the discretization with the isopycnals (Fig. 5 in Beckers et al. (2000)). This weighted averaging considers only the contribution of the two triads that are crossed by the isopycnal line and excludes the two others. There is thus a switch from one pair of triads to the other depending on the sign of the slopes Sx \u03c1 \u03c3 and Sy \u03c1 \u03c3 . To be more explicit we prefer to rename the LINEAR1 scheme as a switching triads scheme. More details about the discretization are given in App. A. To our knowledge no z-level climate models use this type of discretization. We found it useful for our purposes because the slope between the computational grid and the isopycnal direction can be greater than the grid aspect ratio (i.e., Sa \u03c1 \u03c3 > \u2206z/\u2206a, a = x, y) with a \u03c3-coordinate. We, therefore, need to maintain a good accuracy in this type of situation, and this is what the switching triads give (Lemari\u00e9 et al., 2011). Moreover, this approach leads to less severe restriction on the time step compared to the scheme using four triads with equal weights ."}, {"section_title": "Discretization in Time", "text": "It is well known that the use of a standard forward Euler differencing scheme to advance in time the isoneutral biharmonic equation would result in a severe restriction of the stability range compared to the iso-\u03c3 biharmonic equation (Griffies, 2004). In the longitudinal-depth (x \u2212 z) case, the ratio between the time step \u2206t \u03c3 allowed in the non-rotated case (i.e. for Sx \u03c1 \u03c3 = 0) and the time step \u2206t \u03c1 allowed for Sx \u03c1 \u03c3 = 0 is given by This shows that even for very gentle conditions Sx \u03c1 \u03c3 = O(10 \u22123 ) and \u2206x/\u2206z = O(10 3 ), \u2206t \u03c1 should be four times smaller than \u2206t \u03c3 . Moreover, when we consider a terrain-following coordinate, \u2206z can become very small in shallow regions leading to a very large ratio \u2206x/\u2206z making the stability problems more severe. To alleviate this problem the use of a standard backward-time differencing scheme to advance the stiff vertical component of the tensor R could be used, however it would require the solution of a high order elliptic problem, which can be both computationally expensive and laborious to code. In this case the main stability constraint would arise from the terms involving mixed horizontal and vertical derivatives. Our recent work (Lemari\u00e9 et al., 2011) shows that it is possible to design an easy-to-implement scheme that is stable for \u2206t \u03c3 = \u2206t \u03c1 , meaning that the stability range is unchanged whatever the value of Sx \u03c1 \u03c3 (resp. Sy \u03c1 \u03c3 ). The semi-discretized form of this scheme is given by (2.7) where is a diffusivity that has been optimally chosen through a linear stability analysis. When the first explicit-in-time step is stable, this results in \u03ba(z) = 0; otherwise \u03ba(z) is chosen to stabilize the scheme through a semi-implicit step. This scheme only requires the solution of a tridiagonal system in the vertical direction. Refer to Lemari\u00e9 et al. (2011) for further details concerning the design of the new scheme."}, {"section_title": "Boundary Rotation and Tapering in Weakly Stratified Regions", "text": "To fully define our approach we need to supplement our scheme with a methodology to avoid spurious interactions between the rotated operator and the vertical mixing scheme in the boundary layers and to smoothly satisfy the vertical boundary conditions. Even if the scheme (2.7) is designed to be stable for large slopes, the possibility of infinite slopes and associated infinite fluxes would introduce numerical instabilities. As mentioned earlier, the rotation is done under the small-slope approximation. This means that the possibility of rotating the diffusion, whatever the values of Sx \u03c1 \u03c3 and Sy \u03c1 \u03c3 , is not pursued. We need to taper the isoneutral slopes not only near the boundaries but also in the oceanic interior to stay consistent with the small slope limit. To do so we can easily show that where Sa \u03c1 \u03c3 is the slope between the neutral direction and the direction of the computational grid; Sa z \u03c3 the slope between the horizontal direction and the computational grid; and Sa \u03c1 z is the angle between the horizontal and the isopycnal direction. Particular attention must be paid to the Sa \u03c1 z term in the weakly stratified regions where the slopes can potentially become very large. The use of (2.10) enables us to isolate the Sa \u03c1 z term (appearing as a perturbation around the horizontal direction), allowing the possibility of using the usual practices of z-level climate models to taper the slopes (the Sa z \u03c3 term is not tapered except in the surface layer). In the oceanic interior the exponential tapering scheme suggested in Danabasoglu and McWilliams (1995) and defined by is used with S d = 0.4 and S max = 1/100 in the open ocean. For the present study the maximum slope S max is linearly decreased in shallow areas, arbitrarily defined as regions shallower than 300 m, with respect to the local depth. This is done to progressively make the transition toward a mixing along geopotentials in very nearshore regions (shallower than 50 m) where the stratification is generally ill-defined in climate models. The slopes used in practice to compute the various terms of the tensor R are given by where h bl is the depth of the boundary layer and F br is an analytical function used to rotate the lateral mixing near the surface boundary In Sec. 5 we show that our approach provides physically valid results and does not lead to spurious interactions with the vertical mixing scheme in the surface layer."}, {"section_title": "Discussions", "text": ""}, {"section_title": "Dispersive Errors in Climate Models", "text": "An important point is made in Hecht (2010). It is shown that centered advection schemes in climate models may be problematic because they can allow the creation and accumulation of dispersive errors that are not efficiently smoothed away by the tracer diffusion operator. Indeed, in this context the tracer diffusion is designed for the purpose of parameterizing mesoscale eddies. The spurious dispersive extrema generated by the centered advection scheme can thus go uncontrolled because the tracer diffusion is not designed to locally moderate those extrema. For the present study we make the choice to consider that the primary role of lateral mixing parameterizations is to regularize the solution on the grid scale by limiting fine-scale variance. With the present design of the advection scheme the form of the hyperdiffusivities B x and B y is based only on numerical considerations. We can check that those coefficients are especially tuned to \"fight\" the dispersive errors associated with a fourth-order centered advection scheme. The resulting scheme is not formally monotonic, but the creation of spurious extrema is generally very moderate (for example, Fig. 3 in Hecht (2010))."}, {"section_title": "Limitations of our Approach", "text": "As mentioned earlier, the rotation of the hyperdiffusive part of the advection scheme is done under the small slope approximation which is formally valid for (Sx \u03c1 \u03c3 ) 2 + (Sy \u03c1 \u03c3 ) 2 \u226a 1. This approximation has two direct implications : it decouples the x and y directions, thus limiting the number of terms to compute at their non-natural position, and the horizontal terms of the tensor become slope-independent. This second property is very convenient because we rely on those horizontal along-\u03c3 terms to control the grid-scale noise and we don't want them to be reduced for large slopes, for the reasons explained in Sec. 2.4.1. Our methodology is therefore valid as long as the small slope approximation is valid. In (2.10), the slope Sa \u03c1 z is tapered and never goes beyond a maximum value that is empirically set to 1/100; this tapering ensures that this term stays consistent with the small slope limit. In the framework of a \u03c3-coordinate model, we can be more concerned about the iso-\u03c3 to geopotentials slope Sa z \u03c3 . As explained later in Sec. 4.1 and 4.2.1, the order of magnitude of this term is controlled by the level of bathymetry smoothing and by the analytical formulation of the function responsible for the vertical placement of the \u03c3 levels. The maximum value of Sa z \u03c3 is at the bottom, where Sa z \u03c3 = \u2206h/\u2206a, with h the bathymetry and a = x, y. To limit pressure gradient errors, bathymetry is usually filtered to keep a \"slope parameter\" r = \u2206h/2h smaller than a maximum value r max whose order of magnitude is around 0.2. Considering this smoothing of the bathymetry, we find that For example, for the configuration analyzed in Sec. 5 and 6, we have \u2206x = 50 km, h max = 5000 m and r max = 0.2, this results in Sa z \u03c3 \u2264 4/100. More generally, we see that for \u2206a larger than \u2206x = O(10 km) the small slope approximation remains valid. For a finer horizontal resolution, a more careful checking has to be done."}, {"section_title": "Mesoscale Eddies Parameterization", "text": "Most climate models use the Gent and McWilliams (1990) (referred to as GM) parameterization to represent the eddy effects in non-eddy resolving configurations. The GM parameterization is often defined as the sum of an eddy-induced transport and a tracer diffusion along isopycnal surfaces. As described earlier, this latter component of the parameterization is part of the tracer advection scheme. We decided not to implement the eddy-induced contribution to the tracer advection in the configuration investigated here. There is strong evidence that this term cannot be ignored in regions with deep water formation or intense baroclinic instability like in the Antarctic Circumpolar Current. In midlatitude basins, the zonallyaveraged eddy-induced overturning is however generally rather small (Gent, 2011). For the present study the focus is put more on the large scale circulation at low and mid latitudes; we thus found it reasonable to assume that the eddy-induced advection does not play a major role (but see Roemmich and Gilson (2001) and McWilliams and Danabasoglu (2002) for a counter example in the Northern Tropical Pacific). In Sec. 5 we show that the absence of such a parameterization does not seem to be problematic in obtaining a physically realistic basin-scale Pacific simulation, although this issue may be more acute elsewhere. The role of eddy parameterizations in the Pacific should however be examined further in future work."}, {"section_title": "Boundary Layer Parameterization", "text": "In ROMS the vertical mixing is represented using the K-Profile Parameterization (KPP) scheme (Large et al., 1994). Some adjustments have been made following the recommendations of Shchepetkin (2005). The primary motivation behind these changes is to improve the regularity of the solution and the overall numerical efficiency. Some parameterizations, like KPP, are nondifferentiable and may thus be responsible for the development and the persistence of discontinuities in model variables (and their derivatives) and unphysical jumps in time. In this section we review the original KPP formulation explaining the aspects that have been found the most problematic to obtain a well behaved solution. We then briefly explain the modifications made while keeping essentially the same physical principles as the original KPP model. A more comprehensive and thorough description for the motivations and the implementation of the new scheme can be found in Shchepetkin (2005). The focus here is on the surface boundary layer; the parameterization of the mixing in the oceanic interior is beyond the scope of this paper."}, {"section_title": "Boundary Layer Depth in the Original Surface KPP", "text": "Originally introduced in Large et al. (1994) the KPP scheme has been extensively used for many oceanic studies and for a wide range of applications. Some adjustments have been made to produce deeper mixed-layer depths and are summarized in Danabasoglu et al. (2006). The extent of the planetary boundary layer, h bl , is determined by computing a bulk Richardson number Ri b relative to a reference state chosen as the average density \u03c1 r and velocity u r in the surface sublayer (whose extent is usually 10% of the boundary layer extent). Ri b is thus defined as The value of h bl corresponds to the smallest value of z at which Ri b reaches its critical value Ri cr (ranging typically from 0.2 to 0.5; a value around 0.3 is advocated in Large et al. (1994)). Ri b represents the ratio between the stabilizing stratification and the destabilizing shear, the term V 2 t (z) parameterizes the unresolved turbulent contribution to the shear. Depending on the regime (stable, unstable or wind driven) further checking of h bl is made. (i) Monin-Obukhov (MO) length limitation : it is stated in Large et al. (1994) that with stable buoyancy forcing (i.e., B f > 0) the boundary layer depth h bl must be less than the MO length L, defined as , where u \u22c6 is the friction velocity determined through the surface wind stress and \u03ba is the semi-empirical Von Karman's constant. (ii) Ekman depth limitation : with stable buoyancy forcing h bl is required to be less than the Ekman length h Ek given by h Ek = cu \u22c6 /f with c = 0.7 and f the Coriolis frequency. By definition, h Ek gives the extent of the boundary layer in the case of neutral forcing and stratification. KPP has been designed, tuned, and widely validated for the purpose of climate modeling. The aim is to not alter its physical principles. The only aspect of the original parameterization that is eliminated is the enforcement of the MO length limitation with stable forcing conditions, essentially because the underlying motivation supporting this limitation is somehow unclear. Indeed, following Arya (1981) the coefficient of proportionality between h bl and L is expected to be of the order of 10 (in the stable atmospheric boundary layer). In a more recent study of a comparison over many large-eddy simulations of a weakly to moderately stable atmospheric boundary layer, Beare and McVean (2004) came up with h \u2248 2.16L. The previous remarks provide good support for eliminating the Monin-Obukhov override rule in the stably stratified shear regime as it was discussed in Danabasoglu et al. (2006). This choice is consistent with the fact that it is shown in Large et al. (1994) that the MO length limitation does not bring clear improvements to the model solution. The use of the bulk Richardson number criterion to diagnose h bl comes with some numerical delicacies. Ri b (z) changes very abruptly near the base of the boundary layer, notably due to the density contrast between the mixed-layer and the stratified water below, making it difficult to accurately calculate h bl . Another issue is that the logic of application of Ekman depth and MO depth limitation can be responsible for unphysical jumps in the time evolution of h bl . Those limitations are enforced through if-tests in the code, leading to discontinuities and thus nondifferentiabilities in time in the vertical propagation of h bl . Moreover, the Ekman depth limitation is essential to prevent oscillations of Ri b (z) when u(z) has an Ekman spiral structure (Shchepetkin, 2005). To alleviate the aforementioned delicacies arising from the discrete implementation of the KPP scheme some modifications have been made."}, {"section_title": "An Integral Condition for", "text": "cyan) and associated velocity profiles (u in blue and v in green) for a coarse resolution vertical grid (left) with 32 vertical levels and a fine resolution vertical grid (right) with 512 vertical levels. h Ek (grey) is shown for reference only and does not participate in determining h bl . These results are obtained for the Ekman layer problem described in McWilliams and Huckle (2006). The most substantial adjustment is to the condition that determines the surface boundary layer depth. The bulk Richardson number criteria (3.1) is based on the definition of the boundary layer as the depth of water within which (destabilizing) turbulent shear production is balanced by the stabilizing stratification and rotation (through the Ekman layer depth limitation). So as an alternative to (3.1) the formulation suggested in Shchepetkin (2005) is the following : h bl is the first non-zero depth; z \u2264 \u03b6 (\u03b6 being the free-surface), at which Cr(z) = 0, where Here ad) is the square of the Brunt-V\u00e4is\u00e4l\u00e4 frequency. Again, the computation of the adiabatic differences to compute N 2 (z) takes advantage of the EOS formulation (2.5). In (3.1) a reference state (\u03c1 r , u r ,z r ) had to be chosen because h bl was defined as the depth where a water parcel with mean velocity u r and density \u03c1 r first becomes stable relative to the local velocity and density (Large et al., 1994). The use of adiabatic derivatives has the advantage of eliminating the need for choosing a reference state. The purpose of the K(z) kernel function, defined as K(z) = z \u2212 \u03b6 \u03b5h bl + z \u2212 \u03b6 , is to exclude the surface Monin-Obukhov layer from controlling the extent of the boundary layer. As mentioned earlier the extent of the surface sublayer is usually assumed to correspond to 10% of h bl , leading to \u03b5 = 0.1. In (3.2) C Ek is a nondimensional constant chosen so that h bl is as close as possible to h Ek for a neutrally stratified fluid. Under some scaling arguments it is found in Shchepetkin (2005) that C Ek = 258 provides an acceptable value. The consequence of adding the C Ek \u2022 f 2 term in (3.2) is that no a posteriori limitation of h bl is required because the Ekman layer depth limitation is included in the Cr-based criterion (Fig. 1). Danabasoglu et al. (2006) mentioned that the Ekman layer depth limitation was considered for elimination in the standard KPP implementation in CCSM 2 . For the present formulation we chose to keep this condition through the C Ek \u2022 f 2 term, so that the scheme is not \"Coriolis blind\" and is consistent with the Ekman problem. Unlike Ri b (z), the Cr(z) function varies smoothly in the vertical direction (notably when u(z) has the structure of an Ekman spiral, Fig. 1) provided that u(z) and \u03c1(z) are continuous functions."}, {"section_title": "Discretization of KPP", "text": "One of the most challenging problems when discretizing the KPP scheme is achieving an accurate diagnosis of the boundary layer extent once the discrete interval [z \u2212 , z + ] enclosing h bl has been found (using the Cr-based criterion here). This is a difficult task in practice, because h bl resides within a critical interval where a sharp transition in vertical derivatives of density occurs between the mixed-layer (weak gradients) and the water just below (strong gradients). This rapid change can be hardly captured using a simple two point finite difference approach, so higher order reconstructions would be more appropriate. This is achieved by using cubic polynomial fits to reconstruct the density and velocity profiles. This results in a smooth profile for the Cr(z) function ( Fig. 1) and hence a simple linear interpolation is accurate enough to find the depth at which Cr(z) cancels. An other important point is that the turbulent viscosities and diffusivities predicted by KPP are computed at z k+ 1 2 -points; h bl preferably needs accuracy relative to those z k+ 1 2 -points. For those reasons it has been found more convenient and accurate to compute Cr(z) at z k+ 1 2 -points. Once the extent of the boundary layer has been determined, an isotropic horizontal Laplacian filter is applied to h bl to prevent the development of grid point noise generated by the one-dimensionality of the parameterization. In the case of an Ekman layer problem, Fig. 1 illustrates the robustness of the proposed scheme to changes in vertical resolution. The presence of the kernel function K proved to be essential in obtaining convergence of the scheme with resolution. Note that a slight modification has been brought to the KPP shape function to locally regularize the logarithmic singularity in u(z) as z \u2192 0 associated with the classical surface layer depth profile for a wall-bounded shear flow (McWilliams and Huckle, 2006). In Sec. 5 we show that the KPP scheme, including the adjustments proposed in the present section, provides a good depiction of the large-scale Pacific mixed-layer dynamics."}, {"section_title": "ROMS 1/2 degree Pacific Ocean Simulation", "text": "To illustrate the practical effects of the new developments in Sec. 2 and 3 a set of realistic Pacific Ocean simulation has been carried out. The ROMS model in its UCLA 3 version is used (Table 1 in Shchepetkin and McWilliams (2009) for a thorough description of the different branches of ROMS). In the following, we first briefly describe the model and the Pacific configuration we have implemented. In subsequent sections we proceed to the validation of the solution with a particular emphasis on the water mass properties, mixed-layer physics, and seasonal variability. The results of some sensitivity tests proving the robustness of the numerical developments will be investigated."}, {"section_title": "Model Overview", "text": "ROMS is a primitive-equation, free-surface, split-explicit oceanic model. The equations are discretized using a \"z-\u03c3\" vertical coordinate. The formulation used for the present study is described in Shchepetkin and McWilliams (2009) (Eqs. (2.2) and (2.4)). The main advantage associated with this choice is that the parameter h c , setting the depth of the transition between flat z-levels and terrain-following \u03c3-levels, is no longer constrained by the minimum depth h min , allowed in the domain. We take advantage of this feature by choosing h c = 400 m in order to help alleviate the sigma-errors in pressure-gradient (Burchard and Peterson, 1997) and advection terms between the surface and approximately the expected depth of the pycnocline. To fully define the vertical grid two additional parameters \u03b8 s and \u03b8 b , controlling the surface and bottom refinement of the grid, have to be set. We designed our grid with N = 50 vertical levels, \u03b8 s = 10, and \u03b8 b = 2 resulting in 20 almost equally-spaced levels in the first 200 m in deep areas i.e. h \u2248 5000 m (Fig. 2). This provides a sufficient vertical resolution at the base of the boundary layer, even in the middle of the oceanic basin. This is particularly important to accurately diagnose the value of the parameter h bl introduced earlier. The overall improvement brought by this new formulation, compared to the previous ROMS formulation (Song and Haidvogel, 1994), is illustrated by Fig. 2. In Sec. 2 the design of the tracer horizontal advection scheme is discussed. For vertical advection, the use of a fourth-order centered scheme with harmonic averaging (sometimes referred to as an Akima scheme) turns out to provide a good compromise between small inherent diffusion and accuracy. Indeed, by using harmonic averages the loss of accuracy associated with the non-uniformity of the vertical grid is alleviated (formally speaking the scheme becomes second order accurate in this case); see Sec. 5 in Shchepetkin and McWilliams (2008) for a thorough discussion. A sensitivity test using parabolic splines has been carried out without showing significant differences in the physical solution. Besides the tracer advection and the vertical grid, the algorithmic choices used for the present paper are the standard choices given in Shchepetkin and McWilliams (2009) for the UCLA kernel. The horizontal pressure gradient is computed using a density-Jacobian scheme with cubic polynomial fits (Sec. 5 in Shchepetkin and McWilliams (2003)). The numerical open boundary condition algorithms used for the baroclinic and barotropic parts are fully described in Mason et al. (2010) (Sec. 2.1.1 and 2.1.2)."}, {"section_title": "Pacific Configuration", "text": "A Pacific domain has been configured to assess the ability of ROMS to deal with basin-scale problems. The computational grid has been designed using a transverse Mercator projection allowing a smooth transition of the grid size from 50 km at the equator to 35 km at high latitudes. The slow variation of the grid size from one cell to the other is essential to maintain the order of accuracy of the numerical schemes that are formally derived on uniform grids. The domain roughly extents between 37.5 \u2022 S and 60 \u2022 N in latitude and between 95 \u2022 E and 80 \u2022 W in longitude. In this section we describe the different ingredients needed to prepare the Pacific ROMS configuration. From our perspective an accurate description of these aspects, although frequently not documented, is useful because it allows the reproducibility of the results. Moreover, it would be helpful if this practice could be more systematic in order to better understand the consequences of the choices that are commonly made."}, {"section_title": "Topographic Smoothing", "text": "The preparation of the model topography h for terrain-following models is a long standing subject of intense discussions. It is usually assumed that the Horizontal Pressure Gradient (HPG) errors are the most harmful \u03c3-errors associated with strong topographic slopes. The slope parameter r i\u22121/2 = (h i \u2212 h i\u22121 )/(h i + h i\u22121 ) (the \"r-factor\") has been historically used as a measure of the order of magnitude of the HPG truncation errors. The model bathymetry is interpolated from the Smith and Sandwell Global Seafloor 1 km resolution Topography (SRTM30, Becker et al. (2009)) and has a minimum depth of 50 m. The preparation of the topography is split into two successive steps, first a coarsening procedure and second the so-called logsmoothing procedure to satisfy an r-factor criterion. The coarsening procedure to compute an intermediate topography h raw at model grid points is done using a weighted averaging involving all the data points inside a given radius of influence R defined as a number of grid points. The weights are computed by means of a quadratic function W , with d k the distance between the target point and the data point k. The usual values for R are between 2 and 4 to obtain an additional smoothness for h raw . In Sec. 6 we will illustrate the sensitivity of the ROMS solution to the parameter value used for R. The second step in the bathymetry preparation is an extra local-smoothing step to ensure that the r-factor does not exceed a given maximum value r max (typically r max \u2248 0.2). This is achieved using iteratively a nine-point Laplacian operator with coefficients proportional to the local r-factor. The notion of locality is crucial here because once a given subregion of the domain satisfies the r max criterion, this subregion is not further smoothed even if the global iterative process has not converged. A final remark concerning the bathymetry preparation is that the redesign of the vertical grid to minimize the departure of the \u03c3-levels from the horizontal direction, discussed in Sec. 4.1, does not imply that larger r max values are tolerable. Even if the near-surface \u03c3-levels are nearly flat, an increased r max would still increase the pressure gradient errors at depth, thus affecting the circulation in the upper layers through baroclinic-barotropic coupling."}, {"section_title": "Climatological Wind Stress Forcing", "text": "For the present study the low-frequency interannual variability is deliberately left out so that we can focus on climate equilibrium. The forcing fields are, therefore, computed from climatologies. The wind stress is prepared following a two step procedure using the monthly QuikSCAT-based Scatterometer Climatology of Ocean Wind stress (SCOW 4 , Risien and Chelton (2008)), the Tropical Atmosphere-Ocean (TAO) buoys 5 available in the Equatorial Pacific, and the CERSAT (French ERS Processing and Archiving Facility) Mean Wind Fields (MWF) blended product 6 . This product, available every 6 hours from 2004 to 2009 on a 0.25 \u2022 resolution grid, is obtained by blending QuikSCAT data with the European Center for Medium-Range Weather Forecast operational global model outputs. We derived the monthly TAO wind stress vectors from the daily 4 m TAO winds (over the period [2000][2001][2002][2003][2004][2005][2006][2007][2008][2009] using the Large and Yeager (2004) bulk formulation under the assumption of a neutrally stratified surface layer. A monthly climatology of drifters data (Lumpkin and Garraffo, 2005) has been used during the computation of the wind stress to account for the effect of the oceanic surface currents. The rectification by surface currents is required because anemometers on buoys measure winds relative to solid earth while scatterometers measure winds relative to the moving ocean surface (Dickinson and Kelly, 2001;Kelly et al., 2001). In the first step, SCOW wind stress is corrected toward TAO wind stress. This type of correction, al- ready suggested by earlier Pacific modeling work (Menkes et al., 1998), is chosen here because of the recurring bias in modeled equatorial currents with SCOW forcing (i.e., a stronger and broader South Equatorial Current (SEC) and very weak North Equatorial Counter Current (NECC)). This pathological behavior is not related to the model formulation as the NECC dynamics is known to be fundamentally a Sverdrup response to local wind curl (Yu and Moore, 2000;Kessler et al., 2003). This bias may be explained by the inaccuracies of the wind derived from the scatterometer backscatter under rainy conditions (Milliff et al., 2004), or by the strong current shear in this region that can bias scatterometer measurements by modifying the radar cross section (Quilfen et al., 2001). The stress correction \u03b4\u03c4 , whose annual mean is shown in Fig. 3, is based on a monthly TAO climatology and turns out to be non-trivial, specifically in the Inter-Tropical Convergence Zone (ITCZ) between 0 \u2022 and 10 \u2022 N. Note that a smoothing kernel is used to ensure a smooth transition at the limits of the TAO array and to restrict the correction to regions with intense rainfalls. The mismatch between TAO and scatterometer in the ITCZ was also observed for the 10m winds (Jiang et al., 2005;Capps and Zender, 2008). This suggests the mismatch is not artificially created by the assumption of a neutrally stratified surface layer used to derive the TAO wind stress. It is worth mentioning that ignoring the effect of oceanic currents in the TAO wind stress computation leads to a significantly larger correction with additional patterns outside the ITCZ. This indicates that SCOW properly accounts for ocean current influence on surface wind stress, at least outside the ITCZ. The stress correction \u03b4\u03c4 proves to be essential in obtaining more realistic surface equatorial currents as discussed later in Sec. 5.3. The correction is applied to the zonal component only; the correction to the meridional component, whose amplitude is two orders of magnitude smaller, had no significant impact on the resulting solution. The second step for the wind stress preparation consists of adding a high-frequency (daily) component to our SCOW/TAO-corrected monthly climatology using the MWF blended product. This is motivated by the need for high temporal frequency in the wind forcing to account for the strong variability in the winter storm track, as discussed in Sec. 5.2 and Griffies et al. (2009b). We have extracted the daily high-frequency component from two extreme years, July 2005 to June 2006 (whose annual mean is close to SCOW mean) and July 2007 to June 2008 (whose annual mean differs significantly from SCOW mean), and superimposed it on our monthly climatology. This superimposition is done in such a way that the monthly means of the daily climatology coincide with the SCOW/TAO corrected monthly means. Finally, a periodization step is carried out by merging the last days of June to the first days of July. The merging is done at the end of June in order to preserve the coherency of the North Pacific winter storm track (a periodization at the end of December results in unphysical patterns due to the intense storm activity). We decided to build two daily climatologies (based on two separate years) in order to assess the sensitivity of the ROMS solution. However, the results obtained were nearly identical, and thus only the daily climatology based on the 2007-2008 high frequency component will be used for the simulations presented in this paper. The corresponding wind stress root mean square \u03c4 HF rms computed in frequency domain for frequencies larger than f c = 1/(2\u03c0 60days) at each horizontal location is plotted in Fig. 4. This clearly shows that high-frequency winds are required to capture the synoptic scale variability in the extratropical regions."}, {"section_title": "Climatological Heat, Radiation, and Water Fluxes", "text": "The CORE 7 (Common Ocean-Ice Reference Experiment, Large and Yeager (2009)) monthly climatology for the period 1981-2006 at 1 \u2022 horizontal resolution is used for the solar shortwave radiation and the net heat fluxes. The freshwater fluxes are from the HOAPS-3 8 (Hamburg Ocean Atmosphere Parameters and Fluxes from Satellite Data ) dataset (Andersson et al., 2010) for 1987-2005 at 1/2 \u2022 horizontal resolution. The heat and freshwater fluxes are set to zero whenever the surface temperature falls below -1.8 \u2022 C to account for the presence of sea ice. We supplement the surface heat flux with a mild restoring tendency (Barnier et al., 1995) using a 9-km Pathfinder sea surface temperature (SST) climatology. The corresponding restoring coefficients varies spatially from 0.4 m days \u22121 to 0.8 m days \u22121 . A sea surface salinity (SSS) restoring term toward the World Ocean Atlas 2005 (WOA, Antonov et al. (2006)) monthly climatology is also added with a restoring coefficient of 7 m / 90 days. The river-runoff forcing dataset we use is a monthly climatology from Dai et al. (2009). River runoff is included off-line as surface precipitation and is spread using a Gaussian distribution over the grid cells that fall within the coast and 150 km offshore. This procedure is useful to avoid excessively low salinities confined at the coast near the mouths of large rivers, which would generate discontinuities in the ocean salinity field and the creation of false extrema by the tracer advection scheme. This spreading is also a way to compensate for the inability of a coarse resolution model to represent the offshore transport of fresh water. Initial and boundary information are taken from a monthly SODA (Simple Ocean Data Assimilation, Carton and Giese (2008)) climatology based on SODA v2.0.2-4 9 averaged between 1981 and 2006."}, {"section_title": "Sensitivity Experiments", "text": "To test the robustness of our Pacific solutions to the parameter values and algorithmic choices, a set of experiments has been made. All the simulations are run for 25 years, with averages of the outputs saved every month. The first 19 years are discarded for the analysis; the diagnostics shown in the next sections are thus done using the last 6 years. A quasi-equilibrium state is approximately reached after 14 years of integration for the near-surface properties like the thermocline depth. Deep adjustment is significantly longer and hence deeper properties are still expected to drift on longer timescales. The parameter space we explore includes sensitivity tests to the bathymetry smoothing, the orientation of the tracer hyperdiffusion operator, and the value of the critical Richardson number Ri cr in KPP. We define first a base case gathering the choices we find the most appropriate, and second we test the effect of perturbations around this base case. The various simulations are summarized in Table 1."}, {"section_title": "Validation", "text": ""}, {"section_title": "Analysis Goals and Observational Datasets", "text": "The current section provides a descriptive view of different aspects of our ROMS solution. Our intent is to assess the model plausibility by looking at its quantitative correspondence to nature. We will first look at the basin-scale mixed-layer dynamics, horizontal circulation, and tracer distributions. Then, a particular emphasis is on the Equatorial Pacific and on the seasonal variability. Throughout this section we provide comments and references to existing work that may help to explain the observed model biases. With the exception of the mixed-layer depth (MLD) validation, our study is done exclusively on the base case ISO2. More details about the model sensitivity to the form of tracer dissipation and bathymetric smoothing are given in Sec. 6. The CARS (CSIRO Atlas of Regional Seas) 2009 climatology dataset (Ridgway et al., 2002) is used for validating various model fields. CARS utilizes oceanographic data from many sources, including Argo and the World Ocean Database, mapped on a global grid of 1/2 \u2022 resolution. The isopycnal analysis of Johnson et al. (2002) is used for validation of equatorial hydrography and currents. This annual climatology is created from Conductivity-Temperature-Depth (CTD) and Acoustic-Doppler-Current-Profiler (ADCP) measurements in the Equatorial Pacific during the 1990s and is available on a 15 \u2022 by 0.4 \u2022 longitudelatitude grid. The analysis, referred to as \"J02\" in the present study, preserves the sharp pycnocline and velocity structures in the equatorial region. The validation of the MLD is carried out using the 2 \u2022 by 2 \u2022 observational climatology 10 constructed by de Boyer Mont\u00e9gut et al. (2004). The 1 \u2022 by 1 \u2022 resolution Lumpkin and Garraffo (2005) monthly surface current climatology 11 , computed from satellite tracked surface drifters, has been used to validate the model surface currents. Griffies et al. (2009b) offers a benchmark for the evaluation of ocean climate models through a detailed comparison and validation of seven global models (those experiments are referred to as COREs). Though their methodology and objectives significantly differ from our present study in several aspects (e.g., for horizontal resolution and forcing fields), it is instructive to examine some characteristics of our results against the COREs standard because this standard does not include any terrain-following coordinate model. COREs are based on multi-centennial global simulations while the present study is a multi-decadal basin-scale simulation using different surface forcing. Although the model integration length differs significantly between their study and ours, model matrices like the SST and SSS distribution or the shape of equatorial thermocline attain a steady spatial pattern during the first few decades of the integration and do not change appreciably afterward (Griffies et al., 2009b). Hence, wherever is relevant, we offer a qualitative comparison between the present study and COREs. "}, {"section_title": "Modeled Mixed-Layer Depth and Sensitivity to Algorithmic Choices", "text": "We use the so-called variable density criterion suggested by de Boyer Mont\u00e9gut et al. (2004) to estimate the MLD from our model outputs. This criterion defines the MLD as the depth where the density increase compared to density at 10 m depth equals an increase of density equivalent to a temperature decrease of 0.2 \u2022 C. This quantity is computed using the successive monthly averages and then averaged to compute a seasonal climatology. There is a good overall agreement between the ISO2 solution annual mean and the MLD observations at the basin scale (Fig. 5). The main bias is observed in the North Pacific storm track (north of 45 \u2022 N) where ROMS tends to simulate mixed-layer depth shallower by 30 m compared to observations. This bias may be explained by the high temporal variability of the atmospheric conditions in winter in this region (as illustrated by Fig. 4 for the particular case of the wind stress). The use of daily winds instead of monthly winds results in a deepening of the mean MLD by 25 m in this region (not shown). We can anticipate that transient freshwater and heat fluxes would help to further improve the mixed-layer dynamics in the North-East Pacific. Indeed, Griffies et al. (2009b) emphasizes the fact that 6-hourly flux inputs are required to better represent the storm track variability. We observe a moderate sensitivity of the annual mean of MLD to the value of the critical Richardson number defined in Sec. 3.2 (Fig. 6). However, in winter, higher values helped to partially correct the shallow mixed-layer bias by 10 to 20 m in the Northern Pacific, leading to the choice Ri cr = 0.45 for our base case ISO2. The various simulations are carried out without any diurnal cycle of solar forcing. From our experience, when a diurnal cycle is imposed (through synoptic forcings or analytically) the value of Ri cr must be reconsidered and decreased. In fact, with transient forcing the mean boundary layer profiles are altered and a robust characteristic of diurnal solar heating is an overall deepening of the mean MLD (McWilliams et al., 2009)."}, {"section_title": "Horizontal Circulation and Currents", "text": "The large-scale spatial patterns of ROMS mean sea level compare well with that from the AVISO (DUACS, Pascual et al. (2006)) dataset. The subtropical gyres, northern subpolar gyre, as well as the trough (around 7 \u2022 N) corresponding to the NECC and NEC are well reproduced in ROMS, including their shape and geographical extent (Fig.7). Overall, the Kuroshio and its extension are weaker in ROMS, which is a typical problem with coarse resolution models. As expected for a relatively coarse resolution model, regions with multiple islands and strong flows, like those to the east of Papua New Guinea and the Indonesian throughflow area, show significant differences in mean sea level between ROMS and AVISO, even though the quality of altimetric data in this type of region is uncertain (Pascual et al., 2006). Annual mean surface currents from ROMS are compared with those from the Lumpkin and Garraffo (2005) drifter climatology (Fig. 8). ROMS successfully reproduces major currents in terms of magnitude and spatial extent. Like the observations, the model SEC has two westward-flowing branches (a northern and southern branch around 3 \u2022 N and 5 \u2022 S latitude respectively) separated by an upwelling region near the equator (Kessler et al., 2003). The TAO correction of the wind stress, as discussed in Sec. 4.2.2, brings in a region of minimum westward surface wind stress roughly aligned with the boundary of the eastward-flowing NECC (around 7 \u2022 N) and the northern branch of the SEC (Fig. 3). These changes in the equatorial structure of the wind stress and associated curl pattern result in significant improvement to the model surface currents. Without the TAO correction the NECC is practically absent, while adding the TAO correction to the wind stress leads to a solution that shows a realistic NECC, both in location and intensity  . In addition, we observe a more realistic SEC with a stronger northern branch and an improved westward extension. The westward-flowing North Equatorial Current in the model (centered at 12 \u2022 N) is weaker than that in drifter data in the eastern part of the basin. In the model, the Kuroshio is too weak, and its extension is practically absent. Earlier work has shown that to correctly reproduce intensified western boundary currents, a minimal resolution of O(10 km) is required (Bryan et al., 2007;Hasumi et al., 2010). Even though this is a deficiency of the current coarse resolution solution, this is not a result related to the use of a \u03c3-coordinate, and simulations at higher resolution of the same model would be expected to show improved representation of the Kuroshio (Guo et al., 2003).  "}, {"section_title": "SST, Thermocline Structure, and SSS", "text": ""}, {"section_title": "Temperature Distribution", "text": "The annual mean SST from ISO2 is compared with the CARS climatology (Fig. 9). Most of the open ocean SST biases are within 0.5 \u2022 C, while keeping in mind that the SST is being restored toward a Pathfinder monthly climatology. Regions with high SST bias (\u2265 1 \u2022 C) in ROMS show a similar pattern compared to the results of the models in COREs and hence suggest common modelling issues and/or deficiencies in the forcing. Significant SST biases in the Western Pacific marginal seas may be resulting from the inability of a coarse resolution model to adequately resolve local mixed-layer processes and proper water mass exchanges with the open ocean. The model resolution is also insufficient to resolve coastal upwelling possibly leading to a warm bias off the South and North American west coasts. As underlined by Griffies et al. (2009b), because the CORE radiative fluxes are satellite-based, this warm bias off the South American west coast is probably not due to the cloud related issues typically found in products derived from atmospheric reanalysis data (Large and Yeager, 2004). The negative temperature bias very close to the coast in the Eastern Pacific may be due to nearshore inaccuracies in the CARS data set. However, compared to other climate scale models, such as those in COREs, the ROMS SST biases are either of the same order or smaller (e.g., in the Equatorial Pacific). The distribution of the depth of 20 \u2022 C isotherm (Z20) is used as a proxy for thermocline depth. ROMS and CARS show very consistent features, although there are significant differences in the coastal areas of Western Pacific and off the west coast of South America (Fig.10). The deeper Z20 in ROMS off the South American West Coast may result from the under-resolved upwelling or, more likely, from an inadequate representation of subsurface ocean processes like the subduction of temperature anomalies (Karstensen, 2004;Yeager and Large, 2004). The deep bias south of 20 \u2022 S in the central part of the basin, also seen in the MLD (Fig. 5), may be explained by deficiencies in the forcing and/or boundary conditions. "}, {"section_title": "Salinity Distribution", "text": "Model data SSS difference exceeds 0.3 PSU in coastal regions (in the Northern and Western Pacific), subtropical gyres, and in the Kuroshio extension (Fig. 9). Again, the model SSS bias in the coastal region is attributed to the inability of the relatively coarse resolution model to resolve fine scale processes in the coastal region. An example is the positive SSS bias to the northwest of the Gulf of Panama. Errors in the freshwater forcing, in addition to errors resulting from SSS restoring toward the coarse resolution WOA data set, can also contribute to the near coastal bias. The most striking feature in the SSS error pattern in Fig. 9 is the basin scale positive/negative bias in both northern and southern subtropical gyres. Because the spatial extent of this bias resembles the scale of the gyre circulation, it may be tempting to associate this error with basin scale circulation errors. ROMS also exhibits negative/positive biases, reminiscent of the surface bias, between the surface and 200 m (not shown). The observed biases coincide with large scale patterns in the evaporation/precipitation field; errors in the forcing thus are also plausible. Too high SSS in the northern subtropical gyre and too low SSS in the northern subpolar gyre are seen in most of the models involved in COREs. However, among those models different methodologies are used for the control of long-term salinity drift, making it difficult to establish a clear comparison."}, {"section_title": "Equatorial Pacific", "text": ""}, {"section_title": "Zonal Currents", "text": "The ISO2 simulation reproduces major features of the subsurface currents in the Equatorial Pacific (Fig. 11). The modelled eastward Equatorial Undercurrent (EUC) agrees very well with that in J02 in terms of maximum speed, depth of current core, east-west slope, and upper boundary. As observed by Lengaigne et al. (2003), we note that the isoneutral diffusion brings improvements to the EUC shape. In ISO2, the pycnocline is tighter compared to SIG2; this change of stratification is accompanied by a horizontal stretching and a vertical flattening of the EUC core, making it more realistic (not shown). However, the lower boundary of the modelled EUC still extends too deep (> 300 m depth) in the western and central parts of the Equatorial Pacific compared to J02, while it is shallower to the east of about 120 \u2022 W. In the models in COREs the EUC slope is generally too flat in the central and western part of the basin and too steep in the east, compared to J02 and ROMS. The wind forcing may be one of the reasons for those differences. Underneath the EUC, the observations show a westward return current, the Equatorial Intermediate Current (EIC), at a depth of 350 m. The EIC is most prominently visible west of 140 \u2022 W (Fig.11, top-left). The deeper penetration of the EUC in the central and western parts is accompanied by a weaker and deeper EIC in the mean field. The strong seasonal variability of zonal jets at the depth of the EIC makes it tricky to interpret the annual mean, as discussed in Sec. 5.6. The Pacific North and South Subsurface Countercurrents (NSCC and SSCC, respectively) are narrow (1.5 \u2022 wide) off-equatorial (around 4 \u2022 N and 4 \u2022 S, respectively) eastward jets located at depths from 200 to 500 m (Tsuchiya, 1975). A secondary SSCC (sSSCC) can also be identified between 7 \u2022 S and 8 \u2022 S (Fig. 12). In ROMS, the depth and the spatial location of the subsurface countercurrents is well reproduced, while the intensity is weaker, compared to J02. At 140 \u2022 W the NSCC is not clearly detached from the NECC, this may result from a relatively weak northern branch of the SEC at this location. The sSSCC is discernible in ISO2, although extremely weak. Due to its narrowness this secondary current is not expected to be well represented by such a coarse resolution model. Various studies have shown that the simulation of the different equatorial subsurface jets is sensitive to model formulation and, in particular, to lateral physics (Maes et al., 1997;Jochum et al., 2008;Hecht, 2010). In Fig. 12 we show vertical sections at the same locations as Hecht (2010) (i.e., at 140 \u2022 W) and Jochum et al. (2008) (i.e., at 125 \u2022 W) to allow a direct comparison. Unlike the numerical models used in those studies, horizontal viscosity and diffusion in ROMS are implicitly set by the numerical schemes, and no explicit contribution is added. This \"self regulation\" by the numerics provides results that are in good agreement with the ones obtained by Jochum et al. (2008) in their low viscosity experiment and by Hecht (2010) when using a combination of centered advection scheme and isopycnal explicit diffusion at a 0.1 \u2022 horizontal resolution. In those studies, those two cases show the best agreement with observations. Hecht (2010) also illustrates that the spurious diapycnal mixing associated with the use of a Lax-Wendroff tracer advection scheme with an implicit diffusion along the geopotentials can lead to a significant degradation of the subsurface jets. The present results suggest that the numerical schemes used in ROMS (including the advection scheme presented in Sec. 2) provide an implicit viscosity and tracer mixing that are meaningful for a good representation of the structure of equatorial jets."}, {"section_title": "Temperature", "text": "An essential requirement for a Pacific Ocean simulation is proper representation of the equatorial temperature structure. Due to non-trivial differences between the J02 and CARS climatologies, we decided to use both datasets for the validation of temperature and salinity in the Equatorial Pacific. The differences between those datasets also serve to illustrate the uncertainty in the observational data. Compared to CARS and J02, ROMS is able to reproduce the equatorial thermocline with reasonable sharpness and slope ( Fig. 13). Between 145 \u2022 E and 100 \u2022 W, the 20 \u2022 C isotherm shoals by about 125 m in J02, 145 m in CARS, and 125 m in ISO2. While the modelled thermocline shows a very good agreement with J02, it is deeper by about 10 m east of 135 \u2022 W, and shallower by about 15 m in the Western Pacific, compared to CARS. The West Pacific warm pool, which is defined by the 28 \u2022 C isotherm (Wyrtki, 1989), simulated by ROMS is consistent with the one in CARS with a proper horizontal (i.e., west of 170 \u2022 W) and vertical (i.e.,  maximum depth around 100 m) extension. In comparison, the warm pool in J02 extends west of 176 \u2022 W and up to 90 m deep. In COREs, the 4 models (out of 7) comparing favorably with J02 show a warm pool with an eastward and vertical extent relatively similar to ROMS. However, in those models, the west-east thermocline slope is generally too flat in the west and too steep in the east. The temperature structure in the cross-equatorial direction is shown in Fig. 14. The doming and slumping of the thermocline, associated with the equatorial currents, as well as the latitudinal distribution of warm waters (temperature > 20 \u2022 C) are quite similar between ROMS and CARS. While the temperature difference between ROMS and CARS is largely within 0.5 \u2022 C in the upper 75 m, slight mismatches in the depth of the thermocline result in biases above 0.5 \u2022 C below 75 m depth. The cold anomaly below 125 m in ROMS, between the equator and 5 \u2022 S (Fig. 14), may be the result of too deep a penetration of the southern branch of the SEC observed in ISO2 between 160 \u2022 W and 170 \u2022 W (not shown)."}, {"section_title": "Salinity", "text": "The distribution of salinity in the upper 100 m in the Equatorial Pacific exhibits two \"fresh pools\" (defined as regions with salinity lower than 35 PSU), west of 170 \u2022 E and east of 140 \u2022 W, delimited by saline waters (\u2265 35 PSU) centered around 175 \u2022 W (Fig. 15). Those large scale features are clearly visible in J02 and CARS despite the numerous striking differences between those two datasets. Compared to J02, the fresh pools in ISO2 are slightly deeper while the high salinity core (at a depth of 135 m), and the location of the 35 PSU isohaline surfacing are relatively similar. The surfacing of waters with salinity higher than 35 PSU is absent in SIG2 (not shown). In CARS, the high salinity waters extend further west at the surface to reach 135 \u2022 W (instead of 150 \u2022 W for J02) and have significantly higher subsurface salinity values. As for the temperature structure (Fig. 13), ROMS clearly shows more similarities with J02 than with CARS and is able to reproduce the major observed features. The discrepancies among the available datasets call for caution when we proceed to evaluate the model output."}, {"section_title": "Seasonal Cycle", "text": "We investigate the ability of ROMS to properly reproduce the climatological mean seasonal cycle, focusing on the zonal currents in the Equatorial Pacific and on the heat content at mid-latitudes in the northern hemisphere, both known to exhibit a pronounced seasonal dependence (Yu and McPhaden, 1999;Thompson et al., 2002;Marin et al., 2010). Both ROMS and the Lumpkin and Garraffo (2005) drifters monthly climatology show similar large-scale features in their mean seasonal zonal currents along the equator, including a strong westward propagation in the east, with ROMS reaching a maximum speed of 55 cm s \u22121 around 120 \u2022 W in May (Fig. 16). This maximum in the eastern part of the basin is associated with vertical exchanges of momentum between the eastward flowing EUC and the surface during spring and summer (Fig. 17), thus contributing to the \"spring reversal\" (from April to August) of the normally westward flowing SEC (Yu and McPhaden, 1999). The modelled seasonality of the vertical migration of the EUC core in the eastern part of the basin, from 120 m depth between October and January to 80 m depth between April and July, is consistent with ADCP data (Fig. 17, left and middle) .  The ROMS EIC shows a significant seasonal variability with sub-thermocline zonal velocities (averaged between 450 m and 540 m) ranging from 21 cm s \u22121 to the east in June reversing to 15 cm s \u22121 to the west in November at 165 \u2022 E (Fig. 17, right). Marin et al. (2010) also observe this large reversal of nearequatorial sub-thermocline zonal transports. They associate the origin of this variability to the presence of annual vertically propagating Rossby waves generated by zonal wind forcing. However, the absence of monthly observational data at the depth of the EIC does not allow a rigorous validation of this aspect of our solution. The heating and cooling cycle and resulting mixed-layer depth entrainment/detrainment cycle can play an important role at mid-latitudes notably in the propagation of wind-driven Rossby waves (Thompson   ., 2002). In general climate models suffer from too weak a seasonal heat storage in those regions, as shown by Griffies et al. (2009b) in the particular case of the Atlantic basin at 35 \u2022 N. Even though an important factor controlling this seasonal trend is solar heating, a sensitivity to the vertical mixing parameterization in the surface boundary layer is also expected (Griffies et al., 2009b). In the northern Pacific, ROMS shows a good ability to reproduce the observed heating and cooling patterns along 40 \u2022 N. The subsurface penetration of summer heating is, however, slightly slower in ROMS compared to that in CARS (Fig. 18). The present model formulation uses a SST restoring term that may be a factor in helping to obtain a proper heating/cooling cycle."}, {"section_title": "Performance of the Rotated Hyperdiffusion", "text": "In the previous section we assessed several aspects of our Pacific solutions by comparison to observed fields. In this section we complete this validation by putting more emphasis on the role played by the isoneutral hyperdiffusion."}, {"section_title": "Water Mass Properties", "text": "Due to its large size, as compared to the other oceanic basins, the Pacific Ocean spans a wide range of Temperature and Salinity (T&S) relationships. Following Tomczak and Godfrey (2003), six water masses can be distinguished, namely the Western South and North Pacific Central Water (WSPCW and WNPCW), the Eastern South and North Pacific Central Water (ESPCW and ENPCW), and the South and North Pacific Equatorial Water (SPEW and NPEW). We here focus on the WSPCW, ESPCW, SPEW, and WNPCW because they present a significant curvature, associated with a subsurface salinity extremum, in their T&S relationships. Progressive diapycnal mixing would act to smooth out this curvature leading to an increase of salinity in the case of a salinity minimum. As shown by Marchesiello et al. (2009), the rotation of the diffusion and associated minimization of spurious diapycnal mixing is expected to imply a better preservation of the salinity extrema. To illustrate this point, the T&S relationships for four Pacific water masses are shown for the ISO2 and SIG2 solutions, as well as for the SODA climatology used to initialize and force at the boundaries in our simulations (Fig. 19). The geographical subregions we choose for each water mass are consistent with Tomczak and Godfrey (2003). The T&S diagrams are averaged into a single line to obtain results easier to interpret. This procedure is done by averaging together a set of temperature and salinity bins weighted by the volume in each bin. For the four water masses shown here, the use of an isoneutral hyperdiffusion leads to T&S relationships that are consistent with the SODA climatology, even after 25 years of simulation. Moreover, we did not observe creation of any spurious water masses due to the dispersive errors associated with the rotated biharmonic operator, such as in Marchesiello et al. (2009). A certain amount of caution must be used as the flow under consideration in this paper is non-eddy resolving and results may be different for turbulent, high resolution flows. Finally, Fig. 19 clearly shows that for long-term simulations, diffusion along \u03c3-surfaces leads to a significant level of diapycnal mixing, and so there is a significant temporal drift in water mass properties."}, {"section_title": "Circulation Errors and Bathymetry Smoothing", "text": "As mentioned earlier, one of the main difficulties when we consider a terrain-following model is finding the best possible compromise between an accurate representation of the \"true\" topography while maintaining the numerical schemes truncation errors within an \"acceptable\" level. The notion of \"acceptable\" level is somehow arbitrary and dependent on the type of flow and configuration under investigation. In general, sensitivity of the model solution to the bathymetric smoothing is observed, and is clearly a concern. To illustrate this point, we show in Fig. 20 the difference in sea surface height (SSH) between two ROMS simulations performed with different levels of bathymetric smoothing (represented by the parameter R introduced in Sec. 4.2.1). When the hyperdiffusion operator is kept along \u03c3-surfaces, differences on the order of 0.2 m in SSH occur between SIG4 and SIG2 when averaged between year 20 and 25 of the simulation. It is striking that the order of magnitude of those differences is severely reduced when going from an iso-\u03c3 to an isoneutral diffusion. This result suggests that this is not just the HPG error, but the interplay between numerically-induced mixing of active tracers and HPG errors that plays a crucial role in the time-evolution of circulation errors. In Mellor et al. (1994) it is stated that the HPG error is advectively eliminated after a longtime integration. This \"advective elimination\" is shown with zero horizontal and vertical diffusivities and with a centered  Fig. 19. Temperature-salinity relationships for four distinct water masses : ESPCW (top,left), WSPCW (top,right), SPEW (bottom, left), and WNPCW (bottom, right). The black dotted line corresponds to the SODA climatology used to initialize and force the model at the boundaries (Sec. 4.2.2). The ISO2 and SIG2 solutions are represented, respectively, by a black and a grey line. advection scheme. However, for the reasons explained in Sec. 2.1, a diffusive operator acting on active tracers is required for realistic applications. In this context, the available potential energy (APE) viewpoint provides a useful formalism to interpret our results. When the active tracers are mixed in a non-adiabatic way, as is the case for an iso-\u03c3 diffusion close to bathymetric slopes, this tends to artificially generate (resp. flatten) isopycnal slopes leading to spurious sources (resp. sinks) of APE. The local APE sources may then interact with the flow leading to erroneous conversion to kinetic energy. Our results suggest that those errors of energy conversion can be harmful for long-term integrations. However, this particular point requires further investigation to untangle the different mechanisms at play. The use of an isoneutral hyperdiffusion (originally intended for the conservation of water masses properties) also has a feedback on circulation errors."}, {"section_title": "Conclusion", "text": "The use of a terrain-following coordinate is usually considered unsuitable for large-scale modelling applications. One of the main reasons supporting this statement is that the non-alignment of the vertical Fig. 20. Difference in the annual mean of sea surface height [m] between two solutions due to two different levels of bathymetry smoothing : between ISO2 and ISO4 (top), and SIG2 and SIG4 (bottom). coordinate isosurfaces with the isopycnals or geopotential surfaces makes the representation of interior adiabatic dynamics and horizontal pressure gradient unnatural. Moreover, with this type of coordinate, the surface mixed-layer extent can be delicate to calculate because the vertical distance between grid points generally increases in deep areas, leaving the mixed-layer with potentially poor vertical resolution in the middle of an oceanic basin. In this study, we show that those problems are not crippling if the different components of the model are properly designed. We, thus, can draw the overall conclusion that a terrainfollowing coordinate can provide a viable alternative for large-scale, climate studies. Terrain-following models suffer from spurious diapycnal mixing due to advection errors. To circumvent this problem, we split the tracer advection operator between a fourth-order centered part and an isoneutral hyperdiffusion part to achieve both an adiabatic and a scale-selective tracer variance dissipation. Flowdependent hyperdiffusivities are defined to ensure that the dispersive leading error of the centered part of the scheme is efficiently reduced. In addition, a new way of handling the temporal discretization of the neutral hyperdiffusion is used, making the scheme computationally efficient. Modifications to the vertical grid and K-Profile vertical mixing Parameterization (KPP) are also made to improve the prediction of the surface boundary layer extent h bl . The redesign of the analytical function responsible for the distribution of the vertical levels leads to an increase of the vertical resolution at the expected depth of the boundary layer, and a flattening of the near surface \u03c3 levels, thus reducing the pressure gradient error. A few adjustments are brought to KPP to improve the regularity of the solution: the adjustments lead to the elimination of the Monin-Obukhov length limitation of h bl and to the reformulation of the parameterization, changing from a bulk-difference to an integral-based criterion for diagnosing h bl . The modified advection scheme, KPP, and vertical grid are used to implement a ROMS basin-scale 0.5 \u2022 Pacific configuration. Comparisons with various observational datasets are carried out to evaluate the quality of our results in terms of mixed-layer depth, tracer distribution, horizontal circulation, and seasonal variability. ROMS gives results comparable to existing climate models in this way showing its ability to deal with large-scale oceanic flows. Rotating the tracer hyperdiffusion from an iso-\u03c3 to isopycnal direction proves to improve the intermediate water representation and the Equatorial Pacific thermocline structure. An overall tightening of the thermocline is observed, leading to a more realistic Equatorial Undercurrent. Moreover, minimizing the amount of spurious mixing has a negative feedback on the growth rate of circulation errors. During the last two decades several inaccuracies and recurrent circulation errors of \u03c3-coordinate models have been assigned only to pressure-gradient errors. We provide some evidence here that this statement must be mitigated because pressure-gradient and tracer diffusion errors are both at play. Indeed, spurious diapycnal mixing can be responsible for spurious sources of Available Potential Energy (APE) \"feeding\" the growth of circulation errors. This may explain why we see less sensitivity of the solution to the bathymetry smoothing when an isopycnal hyperdiffusion is used, because in this case we minimize the spurious APE sources associated with strong bathymetric slopes. One reason for the present study is to evolve toward a consistent multi-scale modeling of oceanic basins using nesting techniques. In climate models coarse horizontal resolution leads to a severe misrepresentation of the regional oceanic circulation and associated mesoscale eddies. This clearly motivates us to develop and use multi-scale models that are capable of capturing the nearshore mesoscale dynamics (i.e., with embedding in large-scale models) and that allow for non-local upscaling effects. Before responding positively to the question raised in the title of this paper, some aspects would require a deeper investigation. In this study, we emphasize the fact that using an isoneutral biharmonic greatly reduces the model drift for deep properties compared to an iso-\u03c3 biharmonic. However, it still needs to be checked that for multi-centennial simulations the model drift remains at a reasonable level. The control of pressure gradient errors may be considered as a source of concern but it must be clear that significant improvements have been made over the last few years (Shchepetkin and McWilliams, 2003) compared to the schemes used in the DYNAMO or DAMEE projects, and the conclusions drawn by those projects about the inadequacy of terrain-following models should not be taken for granted. Otherwise, the missing pieces in the current model formulation to evolve toward global-scale applications (e.g., sea-ice model and eddy-induced advection) are not expected to be more complicated to implement than with any other type of vertical coordinate. Active Archive Center (PO.DAAC) at the NASA Jet Propulsion Laboratory. The authors would also like to thank one anonymous reviewer and S. Griffies whose comments and suggestions during the review process helped to clarify earlier version of the manuscript. 2 ,j,k . A total of four triads of tracer and density values can be defined, T 1 = {(i, j, k), (i + 1, j, k), (i, j, k + 1)}, T 2 = {(i, j, k), (i + 1, j, k), (i + 1, j, k + 1)}, T 3 = {(i, j, k), (i + 1, j, k), (i, j, k \u2212 1)}, and T 4 = {(i, j, k), (i + 1, j, k), (i + 1, j, k \u2212 1)}, see Griffies et al. (1998) for more details. The discretized cell interfacial flux F (x) i+ 1 2 ,j,k , assuming a stable stratification (i.e. \u03c1 i,j,k+1 < \u03c1 i,j,k ), reads w + \u2206x q i,j,k \u2212 q i,j,k\u22121 \u03c1 i,j,k \u2212 \u03c1 i,j,k\u22121 + q i+1,j,k+1 \u2212 q i+1,j,k \u03c1 i+1,j,k+1 \u2212 \u03c1 i+1,j,k + w \u2212 \u2206x q i+1,j,k \u2212 q i+1,j,k\u22121 \u03c1 i+1,j,k \u2212 \u03c1 i+1,j,k\u22121 + q i,j,k+1 \u2212 q i,j,k \u03c1 i,j,k+1 \u2212 \u03c1 i,j,k . (A.2) with w + = max(\u03c1 i+1,j,k \u2212 \u03c1 i,j,k , 0), and w \u2212 = min(\u03c1 i+1,j,k \u2212 \u03c1 i,j,k , 0). Using the notations introduced in Fig. A.1, we see that depending on the orientation of the slope, this scheme uses either triads T 2 and T 3 , or triads T 1 and T 4 . The computation of the vertical flux F (z) i,j,k+ 1 2 follows the same rule Here the selection is done using the vertical average \u03b3 1 + \u03b3 3 (resp. \u03b3 2 + \u03b3 4 ) of the horizontal density gradient, to ensure that no more than two triads could be selected. If we consider w + = w \u2212 = (\u03c1 i+1,j,k \u2212 \u03c1 i,j,k )/2 in (A.2), and w 1 = w 2 = w 3 = w 4 = 1/2 in (A.3), we recover the scheme introduced in Griffies et al. (1998)."}]
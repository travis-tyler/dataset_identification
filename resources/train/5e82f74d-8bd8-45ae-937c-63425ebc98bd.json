[{"section_title": "", "text": "I would like to thank my outsider committee members, Dr. Zhang for his flexibility and delicate advise. I would like to deeply thank Dr. Zarillo for believing in me, and the professional perspective I learned from him after joining his research group in the past year. Special thanks to Dr. Lazarus from who I learned tremendous lessons and values in the areas of science/research and ethics. I like to thank Lucy Serody for her support, kindness, and her dedication to many international students such as me. I want to emphasize my gratitude to Dr. Lazarus, Dr. Zarillo, and especially Dr. Weaver for their generosity and taking great care of my educational expenses during the past five years. Last but not the least, my deepest gratitude goes to my admirable girlfriend, Maryam, who sacrificed a lot for me, who always believed in me, and for the love, she gave to my work. She is a part of my Ph.D. life, a pleasant memory. xiii"}, {"section_title": "Dedication", "text": "To my old friend, Who showed me the path to success, health, and happiness in the years he's gone,"}, {"section_title": "To my father \u2026 Introduction", "text": "The ultimate goal of this dissertation is to deliver an operational, ensemble-based, highresolution coastal estuarine forecasting system for the Indian River Lagoon (IRL) system forecasting. The first objective is to reduce the computational costs associated with highresolution modeling in ADvanced CIRCulation (ADCIRC) model  so that ensemble predictions are feasible in the framework of operational forecasting. A coupled version of the ADCIRC model is used in this study, known as ADCIRC + SWAN. Simulating Waves Nearshore (SWAN) is tightly coupled with ADCIRC (Dietrich et al., 2011;J. C. Dietrich et al., 2012;Hope et al., 2013). Similar to WAM (Cycle 3 and 4) and WAVEWATCH III, SWAN is a third-generation phase-averaged wave model but contains additional formulations for shallow water. In contrast to similar shallow-water, spectral wave model, STWAVE (STeady-stage WAVE), SWAN resolves additional physical processes such as wave set up and triad interaction and features additional options such as spherical coordinate, non-stationary mode, and extended applications to regions beyond the nearshore into the continental and deep ocean (Gon\u00e7alves et al., 2012;Massey et al., 2011). Therefore, it is suitable for the site study of this work that stretches from deep ocean to continental shelf onto the very shallow estuary,"}, {"section_title": "IRL.", "text": "The study site is the Indian River Lagoon (IRL) system, stretching nearly 250 km along the east coast of Central Florida, USA. The system consists of three sub-lagoons; Mosquito Lagoon, Indian River, and Banana River, and is connected to the Atlantic Ocean through Ponce de Leon, Sebastian, Fort Pierce, Saint Lucie, and Jupiter inlets. The IRL system is a shallow, narrow, and confined estuarine system Weaver et al., 2016b). A finite element unstructured model, such as ADICRC, is the optimal model to resolve the geometrically complex domain (Dietrich et al., 2012). This research directly addresses the expensive computational cost of ADCIRC modeling, the absence of a coastal ocean forecasting tool resolving the IRL system, and the need for addressing uncertainties in IRL modeling efforts by accounting for the wind input uncertainties. These motivations are discussed in the following sections of Chapter one."}, {"section_title": "The computational complexity of high-resolution coastal modeling", "text": "Over the past few decades, numerical modeling has become a preferred approach to study, evaluate, and predict the dynamics of coastal and ocean responses (Blumberg and Georgas, 2008;J.C. Dietrich et al., 2012;Gray, 1989;Le Minor et al., 2019;Lynch et al., 1996;Massey et al., 2011;Ramakrishnan et al., 2007;. There are two main drivers that either encourage the use of numerical models in coastal/ocean studies or drive the need for further model developments and optimizations. They are the continuous increase in human population and activities around the coastal regions (Condon and Sheng, 2012) and rapid improvements in computing power and capacity . These drivers eventually result in improved evaluations of coastal hydrodynamic responses in that: 1) different models/techniques are coupled Cyriac et al., 2018;, 2) larger domains with increasing resolution of computational grids are employed (Blain et al., 1994;Kourafalou et al., 2015;Weisberg sand Zheng, 2006) and 3) probabilistic modeling approaches are employed to address the shortcomings of deterministic techniques (Kourafalou et al., 2015;) (See Appendix C). These three efforts are intended to create a more realistic representation of a coastal dynamics, from which, a wide range of coastal applications will be improved, whether the coastal modeling is carried out for supporting daily forecasts of the sea states, or for operational decision-making processes, emergency management or long-term planning tasks. Combined or even individual implementation of these efforts will lead to an increase in simulation runtime (reduction in model scalability), to an extent that the modeling efforts can be useless (because the model results do not become available in a timely manner)."}, {"section_title": "Operational coastal forecasting systems", "text": "For coastal zones with significant economic activities and increasing anthropogenic pressure, it is necessary to develop or adopt effective coastal management for the purposes of protection and organization of activities and resources. Due to the vulnerability of the majority of coastal areas to natural hazards, there is a growing need to continuously monitor and predict the state of the environment as a component of coastal management (Beatley et al., 2002). Coastal ocean forecasting systems, often integrated systems of observing components, numerical model predictions, product dissemination, and quality-control monitoring, are used worldwide in support for coastal management and protections (Feyen et al., 2013;Kourafalou et al., 2015). The Chinese Global operational Oceanography Forecasting System, for example, has been developed by China's National Marine Environmental Forecasting Center for the use of climatology, hindcast, and forecast simulations for the Yellow Sea and the East China Sea (Kourafalou et al., 2015). The MOVE/MRI.COM-Seto coastal monitoring and forecasting system is developed by the Meteorological Research Institute (MRI) of Japan Meteorological Agency (JMA). The system is comprised of a high-resolution coastal model and an eddy-resolving dataassimilative model and applies one-way nested into the Western North Pacific (WNP) model (Ishikawa, 2005;Kourafalou et al., 2015). Kourafalou et al. (2015) presented a list of systems featured in the Systems Information Table maintained by the Coastal and Shelf Seas Task Team of GODAE/Oceanview for three regions; Region I: Americas; Region II: Asia and Australia; Region III: Europe. One of the systems listed under Region I is the operational coastal forecast system based on numerical hydrodynamic models developed by the National Operational Coastal Modeling Program (NOCMP) (https://tidesandcurrents.noaa.gov/models.html). Hydrodynamic predictions are made by models such as ROMS, FVCOM and SELFE driven by real-time data and boundary conditions at the coastal shelf from a Real-Time Ocean Forecast System (RTOFS), which is based on a global ocean model known as Hybrid Coordinate Ocean Model (HYCOM) [HYCOM: ]. The system includes critical coastal regions in the Atlantic, Gulf of Mexico, Tampa Bay in west Florida, Great Lakes and the two coastal regions along the Pacific West Coast. However, the system neither performs operational coastal modeling nor monitoring data in real-time for the domain of our interest (the Indian River Lagoon system). The Coast Survey Development Laboratory (CSDL) of the National Ocean Service (NOS) and the Environmental Modeling Center (EMC) of the National Centers for Environmental Prediction (NCEP) have established an extratropical Surge and Tide Operational Forecast System (ESTOFS) to simulates surge and tides for the Western North Atlantic basin. The hydrodynamic predictions are made by the ADCIRC model using EC2001 grid that does not resolve the IRL system (Feyen et al., 2013). Coastal Emergency Risk Assessment (CERA) (http://nc-cera.renci.org) implements the ADCIRC Surge Guidance System (ASGS) for making daily forecast and storm surge and waves forecasts. The system employs a basin-scale domain covering the entire North Atlantic, Caribbean Sea, the Gulf of Mexico and most critical estuarine systems, rivers, bays, and other coastal regions along the US coast. However, as with NOCMP, the computational mesh does not resolve the IRL, especially in geometrically complex regions such as causeways where accurate model predictions are required for detailed studies such as bridge abutment design. Moreover, it does not resolve some regions such as the Haulover Canal which connects the Mosquito Lagoon to the Indian River, nor the Barge Canal that connects Banana River and Indian River. Such deficiencies could result in unrealistic predictions of circulation patterns."}, {"section_title": "Ensemble-based operational coastal forecasting systems", "text": "In modeling non-linear chaotic systems such as ocean and weather, even small errors in the initial condition, model forcing, and model error can introduce significant uncertainties in model forecasts. These sources of error limit the predictability of a deterministic forecast as the uncertainties cannot be quantified within a single model run. Ensemble prediction instead provides an estimate of the probability density function of the forecast quantities. In general, probabilistic presentation of forecasts has been perceived as the optimal method in modeling chaotic systems. For a calibrated system (particular errors/bias characteristics of the system are corrected (Bao et al., 2010)) the results of a probabilistic forecast typically have a greater forecast skill than any member of the ensemble. Additionally, they create representative scenarios of possible future states Houtekamer et al., 2005;Kourafalou et al., 2015;Ramakrishnan et al., 2007;Stensrud et al., 1999). Most examples of probabilistic coastal ocean forecast systems are applied to storm surge modeling. The ASGS system, for example, can create an ensemble of up to five members by perturbing the storm parameters obtained from forecast advisories issued by the National Hurricane Center (NHC) . NOAA P-Surge performs thousands of simulations using the Sea, Lake, and Overland Surges from Hurricanes (SLOSH) model in that a normal distribution is created around the storm parameters and perturbations are introduced in forward speed, cross-track error, the radius of maximum wind and storm intensity (Taylor and Glahn, 2008). There are several examples of uses of probabilistic techniques in coastal ocean modeling, e.g. assessing flooding risk (Apel et al., 2006;Purvis et al., 2008), forecasting severe events (Abramson et al., 1996), or surface drift predictions (Rixen et al., 2008), none of them, though, are either aimed to be or have the capability of being operational."}, {"section_title": "Chapter 2 Single-domain vs nesting", "text": "To reduce the expensive computational cost associated with ADCIRC modeling, it was hypothesized that if the traditional single-domain method is replaced by a nesting approach, simulation wall-clock time will be reduced while the model performance is retained."}, {"section_title": "Single domain and associated inefficiencies", "text": "In ADCIRC modeling, the coastal dynamic response is simulated by employing a single basin-scale unstructured mesh. For the east coasts of the US, the unstructured mesh covers the northwest Atlantic Ocean, the Caribbean Sea, and the Gulf of Mexico between 98\u00b0W and 60.0\u00b0W and between 9\u00b0N and 47\u00b0N (Westerink et al., 1992).  (Blain et al., 1994). To simulate response inside an estuary, the large West Atlantic mesh is extended into the estuary of study. Figure 1 (Weaver et al., 2016b) demonstrates a typical mesh used for modeling coastal response for the east coast of Central Florida with a high-resolution representation of the IRL system."}, {"section_title": "Figure 1 -ADCIRC single-domain with zoomed inset over the northern IRL", "text": "Due to the grid flexibility of an unstructured mesh, the mesh size function can vary across a domain between regions of high-resolution (coastal regions) and of coarse-resolution (Deep Ocean). The change in mesh size function has to be smooth and gradual, resulting in highly resolved areas (transition from high-to coarse-mesh) away from the coastal estuary of study   Inefficiency in single-domain ADCIRC modeling arises from two requirements: the necessity of employing a larger mesh, although the response is of interest in a limited coastal region, and the necessity of applying dense grid points in regions away from the coastal region of study (transition between high-to coarse-mesh). Moreover, model scalability is degraded by the requirement for using spatially constant, small time steps across the domain. While significantly large time steps can be applied to regions resolved by a coarse mesh, a smaller time step determined by the CFL condition is dictated to the entire domain by the regions of small grid spacing  "}, {"section_title": "Nesting approach", "text": "In this work, state-of-the-art conventional one-way (C1W) nesting, comprising a large-scale coarse mesh and small-scale fine mesh, is implemented as an alternative to single-domain modeling. The coarse outer mesh communicates with the high-resolution mesh of the estuary of interest through the specification of open boundary conditions of the high-resolution mesh. The application of the nesting technique involves the division of the geographical domain into two regions with significantly different grid spacing, i.e. splitting the single ADCIRC simulation into a coarse mesh run with a subsequent fine mesh run, Figure 2 (A). The large-scale coarse mesh is forced at its open boundary by the tide and physical forces such as meteorology throughout the simulation. The coarse mesh simulation creates forecast results for the nearshore ocean, in proximity to the estuary, and generates the time series boundary conditions (surface elevation) for the nested mesh. Subsequently, the fine mesh is forced with boundary conditions (surface elevation) from the coarse mesh at open boundaries and meteorology over the domain    The nesting method allows for a large discontinuity in the mesh size function at the junctions of coarse and fine meshes. As a result, a smooth transition between the highresolution estuary and coarse-resolution deep ocean is not required and fewer nodes represent these regions that are resolved by a high-resolution configuration in a continuous single domain. Furthermore, a significantly larger time step can be implemented in the coarse mesh simulation. However, the fine mesh is still run with the same minimum time step as the single-domain approach ) (See Appendix B). The degree to which these measures are effective is determined by results of the test runs. Additional advantages of nesting in ADCIRC modeling include the use of different physics in the coarse mesh and fine mesh, i.e. different models or different modes within the same model, e.g. two-dimensional (2D) versus 3-dimensional (3D), and selectively activation of SWAN in the coarse or fine mesh run ) (See Appendix B)."}, {"section_title": "Test study", "text": "The effectiveness of applying a nesting technique in ADCIRC has been tested on two study sites: the IRL system located on the east coast of Central Florida (the IRL case study), and Charlotte Harbor/San Carlos Bay (CSB) in the west coast of Central Florida (the CSB case study). For the IRL system, coastal response to Hurricane Matthew from 2016 was hindcast, and the CSB system was forced by Hurricane Charley from 2014. The total length of simulations is 22 days in the SCB case (a 17-day tidal spin-up and a 5-day meteorological event simulation), and 11 days in the IRL case (a 7-day tidal spin-up and a 4-day meteorological event simulation). The required tidal spin-up times were determined in the preliminary work presented by . The goal of this study was to eliminate any inefficiency associated with unnecessary long spin-up simulation time. A suite of simulations was carried out to determine the minimum time required for tides to propagate across the domain, i.e. the minimum required time for the coarse mesh spin-up simulation. Calculations are based on the model-to-model comparison. Minimum required spin-up time for the coarse mesh is determined at locations along the east coast of the US and the Gulf of Mexico, Table 1. The east-coast 1995 grid (ec95) is forced by tidal constituents; M2, N2, O2, P2, Q2, K1, K2, S2 (Le Provost et al., 1998); at the open boundary. Ec95 has exactly the same geographical coverage as the single domain. Two simulations were performed. The first simulation was run for a longer time to allow for all constituents to propagate across the domain and provides the \"spun-up\" condition to which the shorter simulation will be compared. The second, shorter simulation starts 30 days after the beginning of the first simulation. The goal is to have the long run fully \"spun-up\" before starting the shorter simulation. The duration of the second simulation was long enough to ensure that harmonic oscillations converge. The daily root-mean-squared error (RMSE) is calculated between the longer and shorter runs. When the daily RMSE becomes less than the specified criterion, 10 \u22124 , the short run signal is considered fully \"spun-up\", and the minimum required spin-up time for that particular location is determined, Table 1. "}, {"section_title": "Development of nesting meshes", "text": "The east-coast 1995 (ec95)  mesh was adopted as the basis for developments of the coarse meshes. For each case, a relatively higher resolution was employed in regions in proximity to the coastal estuary of study, yet coarser than the same configuration in the single-domain mesh. For each case study, a high-resolution mesh was created. The open boundaries were placed at the inlets of the IRL (and at so-called passes in CSB). This method contradicts the conventional nesting methods in that the highresolution mesh is extended onto the continental shelf (e.g. . Although optimal in capturing the interaction between the coastal estuary and the continental shelf, the conventional practice might not be suitable for the purpose of operational forecasting if, compared to the implemented method in this work, the number of grid points of the fine mesh is significantly increased, i.e. the simulation runtime of the fine mesh is longer. First, the original ec95 was used to produce the boundary condition. Results confirmed that that certain flow features are not captured around the open boundary (see appendix B, Coarse mesh development section). Presumably, due to using one-way nesting, the impact of the dynamic interaction between the estuary and near-shore water was discarded. The proposed method to overcome this shortcoming was to include the coastal estuary in the coarse mesh, although by a coarse representation, rather than inclusion of the continental shelf in the high-resolution mesh, Figure 2 (B, right). Using trial and error, the configuration of the coarse mesh around the estuary was modified to better represent the coastal estuary. This process was repeated until the boundary conditions created by a trial converge to the solutions computed by the single-domain at the same point. In conclusion, the extension of the coarse mesh to the coastal estuary was found effective "}, {"section_title": "Performance: nesting vs single-domain modeling", "text": "In this section, the performance of the applied nesting technique is evaluated by calculating the model solution deviation from the single-domain technique. The deviation of the solution (DS) is calculated over the spatial region shared by the fine mesh of Multistage and the high-resolution coastal estuary of the single-domain, Eq. 1. The single-domain approach has been applied by the ADCIRC community with great success (Bacopoulos et al., 2012;Chen et al., 2007;Forbes et al., 2010;Olume et al., 2011;Sebastian et al., 2014;Westerink et al., 2008). In the absence of measured data against which the model can be compared, it is assumed that presenting a spatially and temporally averaged deviation from the single domain technique will give a sense of the reliability of the Multistage system. The model output interval is set to 1800 sec, providing time-dependent DS. The DS is averaged over output time snaps, Eq. 2, representing an average deviation over space and period of hydrodynamic simulations. where and represent the model solution of single-domain and Multistage, respectively. Index \"j\" indicates the number of the computational node of the fine mesh. is the total number of computational nodes that are in common between two meshes and are active (wet). is the number of time snaps at which model solutions are output.  Results indicated that despite the underestimations of the storm peak by both singledomain and nesting runs, results are in good agreement with the observations, Figure 3. Another simulation was also performed in which the open boundaries of the fine mesh was forced only with tidal constituents, i.e. no coarse mesh run was performed. As can be seen in Figure 3 (gray solid line), the water level peak is significantly underestimated when the meteorological boundary forcing is not applied to the open boundaries, indicating the importance of the coarse mesh run. Due to the lack of historical wave data inside the IRL system, wave height comparisons are made between nesting and single-domain models,    The model predictions and observation matched up quite well at this station. Interestingly, no remarkable difference is noticed within the nesting runs. In other words, the response is insensitive to the non-tidal open boundary forcing at this location. While discussed in detail in Taeb and Weaver (2019b), there are elements of basin geometry that, to a great extent, isolated the hydrodynamic response at this point during the storm passage. They are the orientation of the IRL system, the causeways, and the narrow connections between the sub-basins; Banana River and the IRL system. There is no tangible difference in wave prediction between the nesting and single-domain runs at this point. Coarse mesh validations were made at Trident Pier station operated by NOAA for surface elevation as well as at the NOAA buoy station 41114offshore from Fort Pierce (FL) for wave heights, Figure 5. Note that the dataset of Buoy 41114 does not include data after October 7 th , 2016 at 10 UTC. The buoy was recovered later in late October 2016. From Figure 5, the maximum set-down of water level was overestimated by the nesting and the single-domain runs, however, the coarse mesh run outperforms. Both runs underestimated the peak wave height at Fort Pierce. Moreover, they predicted an early increase in wave height that can be due to the SWAN model set-up or parametric wind forcing."}, {"section_title": "Performance: efficiency", "text": "The simulation runtimes are compared to the single-domain runs. Wall-clock Time Reduction (WTR) was calculated by defining the following expression ) (See Appendix B), with and the wall-clock time of the single-domain and the nesting runs, respectively. The series of simulations were originally forced by ADCIRC + SWAN models. To examine the sensitivity of wall-clock time reduction to the model selection, ADCIRC only simulations were performed as well. Simulation runtimes for the single-domain and the nesting runs are presented in  Depending on the model type (ADCIRC or ADCIRC + SWAN), applications of the nesting method showed significant improvements in runtime reductions, 71% to more than 80%. The smaller value of WTR is associated with ADCIRC + SWAN runs. The results proved the effectiveness of nesting applications in ADCIRC modeling for coastal regions such as estuaries and bays, and their adjacent near-shore seas. The savings in computational cost will enable ensemble modeling for the IRL system. In Chapter 3, the development of an operational system for performing ensemble-based forecast using the nesting technique in ADCIRC is presented."}, {"section_title": "Chapter 3 Operational and Ensemble-based", "text": "To support operational decision-making processes, sustain economic activities, and protect life in vulnerable coastal zones, operational coastal forecasting and warning systems are developed (or adopted) and placed in use (e.g. Kourafalou et al., 2015;Taylor and Glahn, 2008). For the IRL system and near-shore east coast of Florida, the ADCIRC Surge Guidance System (ASGS)   scripted as an ADCIRC subroutine reads storm parameters, e.g. wind speed in four quadruplets at different radii, the maximum radius at each quadruplet, storm forward speed, central sea surface pressure, to create the meteorological forcing. Users can select to modify storm input parameters based on uncertainty in storm maximum winds, the forecast period and storm track  to generate up to four additional scenarios. While retaining the ASGS capabilities, it is intended to improve the forecasting framework by implementing the nesting technique to reduce simulation runtimes. Saving in computational cost will allow for incorporating more ensemble members in the tropical cyclone module and instituting ensemble capabilities in the daily forecast in which deterministic predictions are promoted to probabilistic predictions forced by a set of forcing members created from three gridded weather forecast models"}, {"section_title": "The Multistage system", "text": "To fulfill the main objectives of this study, a fully automated, operational coastal forecasting tool is developed based on hydrodynamic model predictions and real-time  ) (See Appendix C). In the following sections, a description of the workflow of the system and the weather forecast models used for providing the meteorological forcing are presented. The system products are illustrated in graphics and the IRL response and will be discussed. A more detailed discussion can be found in the peer-reviewed paper published in the Conference Proceeding Coastal Sediment 2019  "}, {"section_title": "Workflow", "text": "The framework of the nesting technique implemented in the Multistage software is shown in Figure 6. The software is driven and controlled by a driver script that reads userspecified simulation parameters from a configuration file (see an instance of the config file in Appendix D), calls modules and subprograms, and controls the information stream between them. In addition to the configuration file, the model grid file and nodal attributes are prepared by the user, and their paths are provided in the configuration file.   Figure 7; S1 indicates stage one or coarse mesh run, and S2 indicates stage two or fine mesh run. BC and HSF are Boundary Conditions and Hot-Start File, respectively. The sequence in which the simulations are carried out is depicted by the gray shading with the lighter (darker) shades indicating an earlier (later) process. "}, {"section_title": "Atmospheric forcing", "text": "The atmospheric forcings include the 10 m winds and sea surface pressures obtained from three weather forecast models: a regional deterministic (NAM), a regional ensemble-based, and a global ensemble-based model. The ensemble regional model is the Short-Range Ensemble Forecasting (SREF) system, and the ensemble global model is the Global Ensemble Forecast System (GEFS). Considerations are made in the selection of the ensemble weather forecast models. These include in large part the feasibility of accessing data, the reliability, and the popularity of their applications in coastal ocean modeling. By utilizing a global and a regional ensemble weather forecast model in this study, the sensitivity of the forecast variability to the type of the model providing atmospheric forcing can be explored and discussed. The NAM model is run by Non-hydrostatic Mesoscale Model (NMM) version of Weather Research and Forecasting (WRF) Model with a spatial resolution of 12 km. The NAM cycles are 00Z, 06Z, 12Z, and 18Z (https://www.ncdc.noaa.gov/data-access/modeldata/model-datasets/north-american-mesoscale-forecast-system-nam). The SREF is a regional weather forecast model (Stensrud et al., 1999b), and uses the Advanced Research WRF (ARW) solver as well as an NMM-based solver. The latter, which is used in this study, contains a control run of NMM on a B grid (NMMB) with 6 negative and 6 positive perturbations with a spatial resolution of approximately 16 km. SREF is run four times a day (03Z, 09Z, 15Z, and 21Z) and its products are provided by NCEP Central Operations (https://www.nco.ncep.noaa.gov/pmb/products/sref/). The GEFS is a global weather forecast model comprised of one analysis and 20 perturbations. GEFS products are available four times daily at 00Z, 06Z, 12Z and 18Z and are provided in longitude and latitude grids on 2.5\u00b0,1\u00b0, and 0.5\u00b0 resolutions from which the 0.5\u00b0 resolution products are used in this study. The six-hour nowcast runs are deterministic simulations forced by analyses that are suitable for the purpose of nowcast/synoptic modeling (Smedstad et al., 2003). Due to the importance of the wind spatial resolution in capturing hydrodynamic responses in the IRL system (Weaver et al., 2016b), the NAM analysis is preferred over other models as it provides a higher spatial resolution compared to SREF and GEFS ) (See Appendix C). NAM files are retrieved and processed using sub-programs of the ASGS system adopted by the Multistage tool. In addition to the nowcast simulations, one forecast member is also 2) mean and standard deviations are calculated over the ensemble members at each grid point at each time step for each set of SREF's and GEFS files, and 3) one meteorological input is constructed in ADCIRC format from the mean of GEFS ensemble, one from ensemble mean plus one standard deviation, and one from the ensemble mean minus one standard deviation. Similarly, three meteorological forcings are constructed from SREF ensemble members. The meteorological forcing members are presented in Table 4. "}, {"section_title": "Application to the Indian River Lagoon", "text": "The Ensemble-Multistage has been running operationally since summer 2018 made up of one member forced by NAM and three members forced by meteorology obtained from GEFS. Three members forced by SREF were included in winter 2019. The IRL mesh was constructed using the software SMS (https://www.aquaveo.com), and a high-resolution bathymetry/topography Digital Elevation Model (DEM) data (~ 10 m) was obtained from NOAA's National Geophysical Data Center (NGDC) (\"Central Florida 1/3 arc-second MHW Coastal Digital Elevation Model,\" 2014). Apart from the potential capability of ensemble modeling, the reduction in simulation runtime may contribute to increasing the grid resolution over the region of interest. In Multistage, the IRL system is resolved by ~126,000 grid points and ~251,000 elements. This is more than three times the number of grid points of the mesh employed in the ASGS system resolving the IRL system. The high-resolution mesh resolves the most complex geometry/bathymetry of the IRL system, with a minimum grid spacing of 15-30 m near the causeways, creeks, and the channels and larger grid spacing on the order of 100-600 m representing the neighboring lands (with elevations less than 10 m in NAVD88) ) (See Appendix C).  The response in the IRL system is dominated mostly by tidal (at the inlets) and meteorological forcings (Weaver et al., 2016a). However, the dynamics of mid-Atlantic and southeast coasts of the US are impacted by the Gulf Stream (GS) and its temporal variations as well (Ezer et al., 2013;Kang et al., 2016;Lee and Atkinson, 1983). Figure 9 illustrates the seasonal variations using (monthly moving-average filtered) water level obtained from NOAA's tide and current (https://tidesandcurrents.noaa.gov/) for the east coast of Florida and the Georgia coast from 2010 to 2019. The Multistage tool makes numerical predictions using the coupled ADCIRC+SWAN. For efficiency, the ADCIRC model is set to run in 2-dimensional Depth Integrated (2DDI) barotropic mode, which has been validated for capturing the response to the tides and meteorology (e.g. Bacopoulos et al., 2009;Choi et al., 2013;Xie et al., 2016). However, the reproduction of the GS dynamic and its impact on the coastal water requires the use of 3-dimensional (3D) models such as the Regional Ocean Modeling System (ROMS) (Gula et al., 2014), or HYCOM . Nevertheless, fully 3D model runs are computationally expensive and are not suitable for the purpose of operational use in the absence of high-performance computers. At the same time, the elimination of the GS impact on the southeast coastal water in modeling efforts can result in a misrepresentation of the mean water level along the coast and in turn at the inlets of the IRL system, i.e. the mean boundary forcings created by the coarse mesh run have offsets of the order of the deviations of coastal water from the annual mean. This is shown in Figure 10 by schematic decomposition of the water-level response  In this work, it is hypothesized that, as long as the time-scale of these variations is significantly larger than (3.5-day) short-term simulations, the temporal varying offset can be corrected by adjusting the surface water level with the sea surface anomaly obtained from the real-time data at the beginning of a forecast simulation throughout the entire simulation, illustrated in Figure 10, bottom, dashed blue line. contour, contour-line, and vector plots (Dietrich et al., 2013). The visualization cores read the ADCIRC(+SWAN), convert the data into appropriate formats, and then call the GMT tools to generate the plots. As will be described in the \"Guidance Framework\" section, four 2D animations are created upon completion of NAM runs. Animations are generated by converting 168 2D contour plots created by FigureGen to GIF files. Because this process can be time-intensive, a secondary computer carries out the creation of 2D plots and animations while the main computer initializes and launches the next member of the ensemble grid. Although the creation of these plots is time-intensive, it does not require significant computational resources. Therefore, a desktop computer is sufficient for this purpose. To enable the option of remote plot generation, the user needs to set up the secondary system's environment and specify the IP address, the path to the working directory, and the path to the FigureGen executable file in the configuration file. The process of generating animations begins by checking the connectivity status between the main server and the secondary computer. If the secondary system is down, or its specifications are not provided by the user, animations will be generated in the main computer, though increasing the total wall-clock time. Additionally, GNUplot, an open-source command-driven interactive plotting program, is used to plot forecast times series results at specific locations. Forecast time series are created in the main computer within a few minutes. The forecast results are validated at locations where real-time observations are available. The response time series presented in validation graphics is a 5.5-day illustration consisting of an old cycle (validation forecast) starting two days prior to the starting point of the current cycle on to 3.5 days in the future e.g. Figure 11. To demonstrate representative output from the Ensemble-Multistage system as well as to illustrate the use of advanced probabilistic predictions, results from a random forecast cycle is presented. Table 5 is a list of geographical points at which observed data is available for the use of forecast validation. Moreover, forecast time series are plotted at representative points and presented within the sub-basins, especially in the proximity of populated residential communities or economic activities with a focus on the Central IRL (listed in Table 5 referred to as non-obs). At the non-observational points, 3.5-day forecast results are plotted.   "}, {"section_title": "Guidance framework", "text": "As a part of delivering an integrated coastal forecasting system, a GUI-based website (https://ptaeb2014.github.io/Multi-stage/) was designed to present visualizations of forecast results. The website is comprised of a home page, description page, who we are, and redirect pages to other operational forecasting efforts that are carried out, or maintained/operated by the author for the IRL system (ASGS IRL and IRL setup). At top of the home page, representative 2D forecast animations are illustrations generated from the latest forecast run forced by NAM, Figure 13. The forecast animations include the forecast surface elevation overlaid with wind vectors and the forecast wave height overlaid with wave direction provided for both the coarse mesh (large domain) and the fine mesh (the IRL system), Figure 14. The enlarged 2D animation is created from coarse mesh run forced by NAM. The user can navigate to the next animation by clicking on the arrow, or by clicking on the 2D animation of interest below the enlarged one. The home page also presents the forecast times series at 22 locations listed in Table 5 and illustrated in Figure 12. Demonstrated in Figure 15, the latest forecast time series can be retrieved in high-quality JPEG format by clicking on the points.       "}, {"section_title": "Archiving and publication", "text": "Atmospheric forcing files are archived in a local server for future reference, model Array of Inexpensive Disk (RAID) is allocated for archiving data which is more than enough for a 100-year data archive. Forecast results are not archived because they need extremely large storage space, but they can be re-created using archived input forcing files. However, upon completion of simulations of a forecast cycle, results are published on a file hosting service and are available for 10 days. The product inventory includes the hourly output of surface elevation, current velocity, significant wave heights, and wave direction generated by all seven members. A wider range of users and modelers can use these near-real-time products "}, {"section_title": "Discussion", "text": "Since the onset of operation in winter 2019, sources of flaws, slow-downs, inefficiency, and deficiencies have begun to surface and day-to-day work was dedicated to troubleshooting, optimizing, and adding (removing) features recognized to be necessary (unnecessary). Each forecast time series plot created by the system was assessed. Although the system has been in operation for less than half a year, there exist distinguishable behaviors with respect to both model input and model outputs. However, these trends might be ruled out as the system is exposed to future events. In terms of water level prediction, from Figures 16-17,19-20, the relative ensemble spread or model variability in predicted water level might seem considerable inside the estuary, however, the absolute variability inside the lagoon is smaller than those of nearshore areas. For instance, the ensemble spread of model predicted water level was approximately 30 cm on April 20 00UTC at the CPRG station (offshore Sebastian Inlet) and the corresponding spread was approximately 20 cm at Sebastian Inlet inside the lagoon. The predicted water level is in strong agreement with the observation at the Trident Pier station, Figure 16 (top panel). At the CPRG station, ensemble runs and observation match up quite well; however, the low tides are not well represented during the validation cycle, while the model and observations are in good agreement since the beginning of the forecast cycle, Figure 17. With respect to wave height prediction, the application of ensemble modeling using NAM, SREF, and GEFS show significant improvements in model performance. The only wave validation is provided at NOAA-41113, Figure 18. Wave validation plots are also configured at CPRG, however, the gauge was down at the time of measurement. The predicted water levels at the Haulover Canal have an offset from the observation, Figure 19, i.e. all forecast runs at this station overpredict the surface elevation time series. At Wabasso, the model underestimates the tidal range which can be attributed to misrepresenting bottom friction rather than wind, Figure 20. Although the application of ensemble modeling shows the capability of reflecting wind forcing uncertainties in hydrodynamic responses, the practice of forcing the model with different uncalibrated input winds is not adequate to precisely mimic the observed response for the operation duration, January to May 2019, at our few validation points. With respect to wind models, NAM and SREF occasionally outperform the predictions made by GEFS, particularly with respect to wave height predictions, Figure 21. This finding is not entirely surprising given that these two weather forecast models have higher spatial resolution than the GEFS. In our previous work (Weaver et al., 2016b), it was shown that hydrodynamic variations within a coastal estuary are captured only if the spatial resolution of the wind model resolves the nuanced land water geometry. For detailed evaluations, readers are referred to the article where the goodness of fit of each ensemble member for a forecast cycle on January 2019 was evaluated through forecast skill score ) (See Appendix C). Analyses showed that the performance of SREF and GEFS varied with respect to the two consecutive forecast cycles of study and it depends on the validation locations. For the selected forecast cycles,the simulations forced by SREF and NAM members generally had better forecast skill than the GEFS. At the Trident Pier and Sebastian Inlet, coarse mesh runs yield values between 0.98 and 0.99 for forecast skills. The strong predictability can be due to the ability of the core model for accurately modeling tides and the fact that the response is dominated by tidal signals during the selected event, Table 6 and Figure 22.  At the CPRG station and the NOAA buoy, simulations forced by NAM, SREF members, and GEFS mean -1 std yield the highest forecast skills while the GEFS mean and the GEFS mean + 1 std show poor predictability, Table 6 and Figure 24.  has been separately incorporated in preexisting systems, the combined qualities together are implemented for the first time in an operational forecasting system. These combined attributes are: (1) the quality of operation with the absence of high-performance computers, (2) probabilistic representations of forecast results for the full spectrum of meteorological events, (3) and the simplicity of model configuration and implementation. The first quality was achieved in large part by implementing a nesting approach in a physics-based numerical model as well as optimizing the modeling steps and automating the entire process. The Ensemble Multistage system was developed in response to the expensive computational cost as well as the complexity of model setup and applications associated with existing operational forecasting systems. The tool will support early warning tasks, coastal resilience, operational decision-making processes, and long-term coastal development plans. Delivering this forecasting system, a GUI-based website was developed presenting model output visualizations as well as validations. A remote server hosting contacting the latest model products is also assigned for the use of modelers and a wide range of end users. The focus of the research activities was to deliver a forecasting system featuring certain capabilities. The model performance was quantitatively and visually analyzed. Based on visual examinations at more than 23 points within the IRL system, it has been noticed that the circulation pattern in terms of water level is not sensitive to wind forcing variations for a certain range of wind speeds and directions while the wave forecasts are responsive even to small variations in the input wind. Therefore, a larger saving in computational cost can be achieved if the tool has the ability to selectively activate a subset of seven ensemble members for circulation forecasting. Work is underway to further improve the efficiency "}, {"section_title": "Two-Dimensional Depth-Integrated, 2DDI, equations", "text": "The vertically-integrated continuity equation is:  = 0 \u222c (( sin 2 + \u2212 1 2 ) ) Where is the ratio of group velocity to phase velocity. Wave radiation stresses are computed on vertices. Wave radiation stresses in form of functions, therefore, can be differentiated to obtain gradients , and , using equations 4B and 5B. These gradients are constant on each elements. At each node, element-based gradient are projected using an area-weighted average of the gradients of the neighboring elements."}, {"section_title": "Generalized Wave-Continuity Equation", "text": "In the ADCIRC model, the vertically-integrated continuity equation is developed to a Generalized Wave-Continuity Equation (GWCE). In the development of the GWCE, following steps are taken: 1) the primitive continuity equation is differentiated with respect to time, 2) the primitive momentum equations are differentiated with respect to x and y, respectively and then substituted into the equation obtained in step 1, 3) the primitive continuity equation 1Bis multiplied by a weighting factor, 0 (which may vary in space), and substituted in into the equation derived in step 2. Parameter 0 weights the relative contribution of the wave and continuity portions of the GWCE, 4) based on the experience of the model developers, the advective terms are converted from conservative to non-conservative forms to improve numerical stability, 5) the lateral closure model in ADCIRC which is a simplified eddy viscosity model of Koler and Gray (1990) is substituted into latest derived equation, 6) the lateral diffusive/dispersive terms are rearranged to decrease the functional continuity requirements from 1 to 0 , 7) the divergence of flux is then substituted by the primitive continuity equation. These steps yield GWCE as: Wave action density equation on the domain and model type, it is possible to perform 3-to-5 ensemble simulations on both coarse and fine meshes by applying the nesting technique and using the same amount of CPU-hours needed to complete one single-domain simulation. This research details the"}, {"section_title": "Introduction", "text": "Numerical modeling of coastal circulation and waves has evolved considerably over the past few decades, as a result of rapid improvements in computing power (speed, memory, etc.) and scientific knowledge . to account for a variety of applicationsbut with the addition of an automated coupling tool. State-of-the-art conventional one-way (C1W) nesting, comprising a (large-scale) coarse mesh and (small-scale) fine mesh, is applied with careful considerations and adjustments to maintain model accuracy. In C1W nesting, a coarse-resolution outer model communicates to a fine-resolution inner model through the specification of the open boundary conditions of the fine-resolution model. The main disadvantage is that the fine-resolution grid does not communicate to the coarse-resolution grid, so the inner model does not update the solutions on the coarse grid. Inter-grid communication can be two-way as suggested by Oey and Chen (1992). In twoway nesting, the coarse grid outer model variables are continually replaced by inner model variables where the two grids overlap so that the outer model benefits from the fine resolution of the inner model through the grids interface (Harris and Durran, 2010;Sheng et al., 2005). This paper describes the implementation of C1W nesting in the ADCIRC model. Since the coarse-resolution and fine-resolution models are run sequentially in C1W nesting, it is computationally efficient and is preferred over two-way nesting. In addition to taking advantage of the efficiency associated with C1W nesting, Multistage also accounts, in part, for the impact of the coastal estuary on the coastal ocean by extending the coarse mesh onshore. Multistage is the first automated system developed for nesting applications within the approximately 50% to more than 80% wall-clock time reduction compared to conventional single-domain techniques with ADCIRC . In the past few decades, there have been several efforts on coupling models and nesting grids in coastal and ocean modeling communities (e.g., . Within most of them, a high-resolution shallow water model representing complex irregular coastal dynamics is nested to a regional or global ocean model that represents the circulation patterns of larger-scale flows. The model representing larger-scales does not have to be the same as the finer-scale model. Depending on physical processes and domain characteristics of study, structured-grid or unstructuredmesh nesting techniques are applied. , for example, studied the density-driven two-layer flow in the Dardanelles strait by nesting ADCIRC and the structured-grid HYbrid Coordinate Ocean Model (HYCOM) (HYCOM: Halliwell et al., 2000). In their study, ADCIRC is applied to provide the resolution necessary to represent the flow in the narrow complex strait, obtaining the initial and boundary conditions from HYCOM. Another instance of nesting ADCIRC to HYCOM is within the Real-Time Operational Forecast System (RTOFS). RTOFS is run at the National Center for Environmental Prediction (NCEP) for the Atlantic basin and is based on the HYCOM model. The RTOFS output is provided as initial and boundary conditions to the ADCIRC model which is configured for specific domains on the east coast of the US employing high-resolution unstructured meshes . Zhang and Weisberg (2012) studied the density-driven oceanic and coastal circulation in three-dimensions for the West Florida Continental Shelf (WFS) for the calendar year 2007. The study was conducted by nesting a coastal region model, the The advantages of the unstructured-mesh nesting are its simple implementation and better performance in retaining the consistency and continuity of computed variables at the interface of two nested domains compared to structured-grid nesting . Modeling coastal and estuarine flows with a structured grid will usually require multiple layers of nesting to achieve the high resolution needed at the coastal level while optimizing the mesh in the deep open ocean. An unstructured mesh typically can eliminate the need for multiple layers of nesting because the mesh will vary in resolution, moving from coarse deep ocean to a fine-scale resolution in complex and irregular coastal and inter-coastal regions . Multistage takes advantage of the variable resolution in an unstructured mesh to optimize the C1W nesting. The method applied in this study is similar to the subdomain modeling approach (Baugh et al. 2015, Altuntas andBaugh, 2017). \nCoastal and ocean circulation models are widely used in conjunction with atmospheric, and wave models to study hydrodynamic processes and responses such as storm surge characteristics (e.g., Heerden et al., 2007;Hope et al., 2013). Additionally, these (individual or coupled) models provide input forcing to pollutant dispersion models for simulating oil spill trajectories, search and rescue (Jordi et al., 2006;Dietrich et al., 2012), to sediment transport and morphology models for studying bathymetric changes Lindemer et al., 2010), and to fisheries-related consulting and research projects (Hobday et al., 2011;Haase et al., 2012). The atmospheric forcing plays a key role in forecast accuracy with respect to both ocean circulation and wave simulating models. Although numerical weather predictions have improved over the past few decades, weather predictions are still sensitive to the uncertainties introduced by model initial conditions and model physics (Stensrud et al., 1999a). Even small uncertainties in wind forcing, when applied to circulation and wave models, can result in degraded predictions. Therefore, predictions made by a single deterministic forecast of these models cannot quantify the uncertainty in the forecasts. On the other hand, ensemble forecasting has better forecast skill than single deterministic predictions (Stensrud et al., 1999b;Ramakrishnan et al., 2007). Probabilistic ensemble-based forecasting can provide client models an envelope of input variables containing the unknown \"true\" state of the predicted parameter(s) (Stensrud et al., 1999b). For this purpose, we developed a daily ensemble-based module to address the uncertainties in input wind forcing and their impact on hydrodynamic prediction uncertainties."}, {"section_title": "Background", "text": "\nAn operational, high-resolution regional coastal ocean model system was developed by  in an effort to reduce the computational cost of high-resolution finite-element (FE) based model as well as to provide support for ensemble modeling. The system employs a nesting approach and is built around the ADvanced CIRCulation (ADCIRC) model . The modeling processes and communication are scripted into a software program referred to as \"Multistage\". The system obtains and processes atmospheric data, manages model control input parameters and output data, delivers results, and processes the results for 132 visualization and dissemination. The output of the current Multistage tool includes water level (and inundation), current velocity and wave predictions. The system has been operational since summer 2018 for the east coast of Central Florida. The objective of the Multistage system is similar to the ADCIRC Surge Guidance System (ASGS, Fleming et al., 2008). However, while the ASGS employs a single domain, the  Figure 1 illustrates the Multistage workflow of the daily forecasts. The system is comprised of a core model, ADCIRC or ADCIRC+SWAN, and several utilities and modules, each of which is tasked to perform specific functions. In our previous work (Taeb and Weaver 2018), we illustrated the workflow of these modules and briefly described their applications and functions. For ensemble forecasting, additional modules have been developed and incorporated in the system that manage the downloading, processing, and creation of ensemble atmospheric forcing files."}, {"section_title": "Hydrodynamics: circulation model", "text": "The ADvanced CIRCulation (ADCIRC) model   ."}, {"section_title": "Hydrodynamics: coupled circulation and wave model", "text": "ADCIRC is typically coupled with a wave model to provide wave forecast/hindcast along with a more accurate prediction of surface elevation and current velocity. Although circulation is a separate physical process from wind-waves, waves are affected by the circulation and vice-versa. Wind-induced waves contribute to water level rise by 10-15% in storm tides, 5-20% on continental shelves, and 30% on steep slope regions (Dietrich et al., 2011;. This change in water levels will affect wave breaking and propagation. On the other hand, waves can affect water level and currents through wave momentum flux. Wind-waves can also increase the surface roughness and vertical mixing momentum and change the bottom friction which in turn impacts circulation (Bunya et al., 2010;Dietrich et al., 2011;Funakoshi et al., 2008;. To predict wave characteristics, Simulating Waves Nearshore (SWAN), is tightly coupled with ADCIRC (ADCIRC+SWAN) (Dietrich et al., 2012(Dietrich et al., , 2011Hope et al., 2013). SWAN is a third generation phase-averaged wave model. Compared to WAM (Cycle 3 and 4) and WAVEWATCH III, SWAN contains additional formulations for shallow water so that it is suitable for coastal estuarine modeling. SWAN numerical implementation is implicit and therefore unconditionally stable. It solves the evolution of action density N(t,\u03bb,\u03d5,\u03b8,\u03c3) over time t and geographical space (\u03bb,\u03d5), and spectral space of direction (\u03b8) and frequency (\u03c3). Wave properties, such as wave heights and periods, are computed by integrating action density (Booij et al., 2004. ADCIRC passes water levels, current velocities, wind velocities, and friction roughness lengths to SWAN where water depth, wave propagation, depth-induced breaking, and other wave processes are calculated. SWAN passes wave information, wave action, the ratio of group velocity to phase velocity, and relative frequency, to the ADCIRC model where radiation stress gradients are calculated at each vertex (Dietrich et al., 2013(Dietrich et al., , 2011. The ADCIRC and SWAN models are tightly coupled, i.e., the coupled model system benefits from utilizing the same unstructured mesh and sharing the same sub-grids in parallel applications."}, {"section_title": "Conventional scheme: continuous single-domain", "text": "In the traditional single domain approach, the model system is run to spin up applied boundary conditions. Surface elevations are spun-up by forcing astronomical tidal constituents on open-ocean boundaries, and if desired, river inflow is spun-up by applying flow rates at specified nodes along river boundaries. The model can also be forced using meteorological forcing, and wave radiation-stress gradient (Dietrich et al., 2011;Funakoshi et al., 2008). Depending on geometry, bathymetry, bottom friction, viscosity, etc. (Stelling et al., 1986), as well as the characteristics of the tidal constituents (Lyard et al., 2006), tidal signals can take a significant amount of time to fully propagate across the domain and reach the condition in which the domain is completely adjusted to boundary forcing, \"spun-up\". Due to the effects of tides on currents and surface elevation , it is necessary to perform a tidal spin-up simulation to accurately create the initial conditions at the beginning of the event simulation. A spin-up run can add a notable amount of time to total forecast. It is also vital to place open ocean boundary far away from immediate coastal regions of study. Westerink et al. (1992) (Westerink et al., 1992). To study hydrodynamics inside a lagoon, the coastal ocean domain and beyond must be included in the computation. This necessity involves model calculations at a large number of points; whereas, in most cases, the researcher is only interested in hydrodynamic predictions and measurements within a small portion of the full domain, such as in estuarine modeling."}, {"section_title": "Multistage", "text": ""}, {"section_title": "General description", "text": "Implementing one-way nesting is a two-stage scheme, each providing hydrodynamic solutions for separate geographical regions. In the first stage, a large-scale coarse mesh is forced at the open boundary by tidal constituents to propagate long waves and currents across the domain and towards the coastal regions. Meteorological forcing is applied during the final days of the spin-up period and throughout the simulation of interest. The coarse mesh simulation produces forecast results on the coastal ocean side of the estuary of interest and generates the time series boundary conditions for the stage two simulation. This coarse mesh does not feature any high-resolution coastal features. In the second stage, the fine mesh is forced with boundary conditions from the coarse mesh at open boundaries and meteorology over the duration for which hydrodynamic prediction is going to be made. The tool allows for a tide-only spin-up simulation on the fine mesh before applying the meteorology. The stage two simulation employs a fine-resolution mesh to resolve the more complex geometry and flow features inside a coastal estuarine system. Based on the geometry and geography of the domain, surface elevations of the fine mesh may need a short spin-up time. For storm surge and wave forecasting, as will be discussed in the case studies section, a 2D barotropic circulation model coupled to a phase-averaged wave model is applied in both coarse mesh simulation and fine mesh simulation. However, the physics of the coarse mesh and fine mesh do not need to match. Depending on the physical processes of study, any combination of model types can be applied such as 2D barotropic, 3D baroclinic, water quality model, and/or sediment transport. Most FE-based models with a spatially varying grid resolution use a spatially constant time step, which is restricted by the smallest element size in the mesh. By implementing a nesting technique, we attempt to mitigate such inefficiency by splitting the geographical domain into two regions with different resolutions. While the fine mesh still requires the same minimum time step as the continuous single-domain approach, a significantly larger time step is allowed in the coarse mesh simulation."}, {"section_title": "Efficiency improvements", "text": "Also, the nesting technique makes it possible for applying different physics in the coarse mesh and fine mesh. For example, in the case of a 3D circulation study inside an estuary, it may be unnecessary to perform 3D simulations outside the estuary. In this case, the nesting technique allows for a 2D barotropic run on the coarse mesh that produces boundary 94 condition for a 3D baroclinic simulation of an estuary. In the case of coupling a circulation model to a wave model, the nesting technique makes it more feasible to couple the coarse mesh representing the deep ocean to a deep ocean wave model while the fine mesh as an automated tool, we took advantage of the ADCIRC Surge Guidance System (ASGS), a real-time storm surge and wave forecasting system created by . Real-time application of Multistage can be analogized to a branch of ASGS specifically designed for coastal estuarine system forecasting. For consistency within the ADCIRC community, similar approaches are applied in scripting the tool where modules and their interactions are either identical to those of ASGS (e.g., tide-generating modules) or adjusted for nesting applications (e.g., main script, control file generator). There is also a new component added for generating the boundary condition file from the coarse mesh simulation, and a few auxiliary scripts for performing miscellaneous tasks. The Multistage tool consists of external and internal components. External components are variables and must be adjusted and customized by users for the study. Internal components are either fixed parts of the system or created by the system in the process. In brief, the system consists of the main driver script that initiates the simulation and proceeds by calling modular scripts to carry out specialized function(s). model spin-up time. As presented in preliminary studies, a spin-up time of two days was found to be sufficient for case study one domain (SCB), and a spin-up time of one day for the case study two domain (IRL) . Spin-up simulations on the fine mesh are forced with meteorology and boundary conditions that contain storm-induced coastal impacts and tides."}, {"section_title": "Assessment", "text": "We assess the performance of the applied nesting technique regarding model solution deviation from the single-domain technique and forecast runtime reduction. The deviation of the solution (DS) is calculated over the spatial region shared by the fine mesh of Multistage and the high-resolution coastal estuary of the single-domain, Eq. 1. The singledomain approach has been applied by the ADCIRC community with great success (Bacopoulos et al., 2012;Chen et al., 2007;Forbes et al., 2010;Olume et al., 2011;Sebastian et al., 2014;Westerink et al., 2008). In the absence of measured data against which the model can be compared, we assume that presenting a spatially and temporally averaged deviation from the single domain technique will give a sense of the reliability of the Multistage system. We calculate deviations as a supplementary measure to modelobservation comparisons that will be presented later, regarding the sparse observation data. The model output interval is set to 1800 sec, providing time-dependent DS. The DS is averaged over output time snaps, Eq. 2, representing an average deviation over space and period of hydrodynamic simulations."}, {"section_title": "98", "text": ""}, {"section_title": "DS", "text": "Where and represent the model solution of single-domain and Multistage, respectively. Index \"j\" indicates the number of the computational node of the fine mesh. is the total number of computational nodes that are in common between two meshes and are active (wet). is the number of time snaps at which model solutions are output. Forecast time reduction will be obtained by defining FTR following the relation in Eq. 3. "}, {"section_title": "Model setup", "text": "The same model parameters are specified for the Multistage and single-domain simulations throughout the study. We apply the barotropic 2-Dimensional Depth-Integrated (2DDI) ADCIRC construct using the lumped GWCE. Governing equations are described in spherical coordinates and transformed into Cartesian coordinates before discretization. A quadratic bottom friction law is applied that varies spatially and temporally based on the roughness (Manning's n) value generated by an ADCIRC utility program. ADCIRC reads in Manning's n values from the nodal attribute file, with a prescribed = 0.02 in water. Over land, the parameter is determined from the National Land Cover Dataset (NLCD) (Arcement and Schneider, 1989;Fry et al., 2011;). A weighting factor, 0 , between the primitive and wave contributions in the GWCE is determined at each computational node based on velocity, depth, and grid spacing. The Coriolis parameter is set to be spatially varying, computed from the y-coordinate of the computational nodes. From results obtained in our previous work (not shown here)  and the experience gained in the course of this study, a two-minute time-interval is applied as the boundary condition time step. Coupled ADCIRC+SWAN simulations have a coupling interval of 1200 sec, the same as the SWAN time step size. In addition to water level, wind, and currents, SWAN is configured to read bottom friction computed by ADCIRC. SWAN is run in the third generation mode, with applied whitecapping according to Komen et al. (1984). Depth-induced wave breaking in shallow water is activated in SWAN with default options and values. The iterative computation in SWAN is terminated if the absolute change in from one iteration to the next is less than 0.005 m or the relative change in from one iteration to the next is less than 0.01 m and the curvature of the iteration curve of normalized with is less than 0.005. More than 95% of all wet grid points need to fulfill these two conditions. Swan is run in nonstationary mode, where a four-iteration computation is specified before moving to the next time step. The lower and upper limit of the frequency range used for computing integral parameters are set to 0.031 Hz and 1.42 Hz, respectively (Booij et al. 2004). We conduct a series of studies on coarse mesh development in which the original mesh and two configurations of an onshore-extended coarse mesh are tested. Boundary conditions produced by modified versions of the coarse meshes are compared between an ADCIRC only, and a coupled ADCIRC+SWAN runs. Following the coarse mesh development section, for each case study, we performed four sets of validation simulations. Each set of simulations applies the same model parameters for the single-domain simulation and the nesting simulation. The first set of simulations, Table 1 row 1, use only the ADCIRC model. The second set, Table 1 row 2, uses the coupled ADCIRC+SWAN, but the coarse mesh simulation is run with ADCIRC only. The third set of simulations, Table 1 row 3, uses ADCIRC+SWAN for the single-domain and both coarse mesh and fine mesh simulations. The fourth set of simulations, Table 1 "}, {"section_title": "Coarse mesh development", "text": "In coastal modeling, it is essential to account for the interaction between coastal estuaries and coastal oceans. This interaction is accounted for in continuous single-domain and in nesting applications where the fine mesh is extended far enough offshore. Offshore extension of a coastal estuary can add significant computational nodes to the fine mesh simulation. The IRL system, for example, is 250 km long along the coast. Offshore extension of the IRL fine mesh to areas where the bathymetry is well-represented by the coarse mesh would at least double the number of computational nodes. The increase in nodes and the small time step needed for the high resolution would result in no significant difference in runtime between a single-domain and a nesting technique. Alternatively, we propose to extend the coarse mesh into coastal estuaries and to resolve the region by a coarse representation. We adopt the east-coast 1995 (ec95)  mesh as the basis for developing the coarse meshes. The ec95 is modified at the locations bordering the open boundaries of the fine mesh of interest. Custom coarse meshes are developed for each target coastal estuary. These custom meshes contain increased resolution in the region neighboring the fine meshes. The depth of the nodes in the coarse mesh that correspond to the boundaries in the fine mesh is set to match the elevations of the fine mesh boundary. Results from the initial simulations, in which resolution of the coarse mesh was not increased to include the coastal estuaries, indicated that the model was not capable of correctly capturing certain flow features near the open boundary. This deficiency is clearly To mitigate such exaggerated variations, we modify the original coarse mesh, Fig. 3(a), to cover the estuary of study by a coarse representation, Fig. 3(b). Improvements in boundary condition accuracy are evaluated visually, and also quantitatively by Root-Mean-Square Deviation (RMSD), which is a measure of the difference between the truth and boundary (a) (b) and San Carlos Bay entrance, Fig. 3(d). Including the estuary in the coarse mesh is shown to damp the overestimated set-downs/set-ups which were illustrated in Fig. 2(a). The results indicate the importance of including the coarsely resolved coastal estuary in the coarse mesh. In the development of the modified coarse mesh, a minimum grid spacing of ~0.009\u00b0 was not exceeded to avoid reducing the time step. The resulting coarse mesh captures the bulk characteristics of the flow through Boca Grande Pass, Fig. 2(d), and improves the predicted increase in water level in the nearshore coast between longitudes 82.28\u00b0W and 82.34\u00b0 W, Fig. 2(d). Evaluating the different configurations for the coarse mesh was conducted by ADCIRC, and the single-domain run is performed by the coupled model. A final series of simulations are carried out on the coarse mesh with no estuary coverage and also coarsely resolved estuary by applying the coupled ADCIRC+SWAN model. This suite of simulations is intended to assess the applied model type for boundary condition accuracy. When the estuary is not represented in the coarse mesh, the time series of predicted boundary conditions are overestimated by the ADCIRC+SWAN run,Figs. 3(c and d). For the coarsely resolved estuary case, the ADCIRC+SWAN run shows no outperformance over the ADCIRC-only run, for hurricane Charley, but could be significant for other storms. The resulting coarse mesh developed for the IRL does not cover the entire region. The IRL is a long narrow, shallow estuarine system extending 250 km along the Florida east central coast. Regarding circulation, the IRL can be divided into sub-regions, each acting as an enclosed basin rather than an integrated system (Schultz, 2008). Among numerous different configurations, the best results were achieved when the coastal estuary is approximated by five sub-regions, Fig. 4(a). For IRL-Matthew, minor improvements are obtained by representing the estuary in the coarse mesh. Only at Sebastian Inlet, a similar overestimating of predicted water level shown in Fig. 2(a) is seen after the storm has passed the inlet. By including the IRL in the coarse mesh, offshore estuary flow is allowed at the inlet improving the accuracy of the predicted water level, Fig. 4(b). between model runs whether or not the coastal estuary is resolved in the coarse mesh, Fig.   4(c). In contrast to SCB-Charley, improvements, although small, are achieved at open boundaries by applying coupled ADCIRC+SWAN model in the coarse mesh simulation. At Fort Pierce Inlets, for example, the coupled ADCIRC+SWAN run on the coarse mesh with the inclusion of the estuary helped improve the boundary condition at the peak of the storm surge, Fig. 4(d). "}, {"section_title": "Results", "text": "The performance of the Multistage system tested on two case studies is presented in this section and comparisons are made within models and between models and observations. Time series of surface elevations produced are compared against observation in For IRL-Matthew, model to observation comparisons are made at two stations that are well-represented by the mesh. Results indicate that water levels predicted by both singledomain and nesting techniques match up well to the observations at those locations. Both techniques underestimate the peak water level at the southern station, Sebastian fishing pier which is just west of the Sebastian Inlet, Fig. 5 (d by the geometry and orientation of the IRL system. The IRL system is comprised by four sub-lagoons that are connected to each other through narrow canals or conveyances. The system circulation pattern is interrupted at the interfaces of two adjoining sub-lagoons. The Lansing Island station is located in the south of Banana River, one of the four sub-lagoons of the IRL system that is connected to the Indian River by two narrow channels. These connections are narrow and can disrupt the circulation between two sub-lagoons. The IRL circulation pattern is also interrupted by 13 causeway / bridges that divide the IRL system into sub-basin compartments (Schultz, 2008). Two of these causeways (Melbourne Causeway and Eau Gallie Causeway) are located between the Lansing Island station and Sebastian Inlet. Moreover, the IRL system is shallow and narrow oriented parallel to the coastline while the Port Charlotte Harbor/San Carlos Bay system is oriented inshore. We found no historical data of wave heights recorded inside the coastal estuaries for   (c) and (f) are fine mesh simulations of the nesting technique for San Carlos Bay corresponding to August 13, 2004, 20:00 UTC and the IRL system corresponding to October 7, 2016, 06:00 UTC, respectively. Highlighted white hatched circles in Fig. 6(a) depict three regions inside the estuary that are predicted to be flooded by the singledomain simulation, but not by the fine mesh simulation of nesting technique. the nesting technique compared to the single-domain simulation. For SCB-Charley, we illustrate a snapshot of predicted surface elevation overlaid with depth-integrated current velocity vectors on August 13, 2004, at 20:00 UTC, Figs. 6(a, b, and c). As shown in A summary of simulation lengths, spin-up, event, and total runtime are presented in Table   3 for each case study and technique. The first series of simulations is an ADCIRC only type. The largest forecast time reduction is associated with this type for both case studies, "}, {"section_title": "Conclusion", "text": "Conventional one-way nesting is applied within the framework of an unstructured ADCIRC model to improve the computational efficiency. The modeling processes are scripted into an automated software to facilitate the applications for offline simulations and future real-time ensemble forecasting, named Multistage. The results obtained from Multistage validation show significant improvements, with simulation runtime reductions 71.6% of 54% to more than 80%. At the same time, the solution resulted in relatively small deviations compared to the conventional single-domain technique. Using the same CPUhours required by the conventional single-domain technique, the Multistage system can produce 2-to-5 ensemble runs for the large-scale coarse mesh and the small-scale fine mesh. Alternatively, the savings in the computational cost can be used for running multiple fine meshes after a single coarse mesh run. This practice has applications in real time where a single coarse mesh is run first, and only the fine meshes that are in the path of a storm are activated. Boundary nodes of the fine meshes can be forced with the non-periodic normal flow in ADCIRC which will be included in future versions. Wave information will also be added to the boundary condition forcing of the fine mesh. The present results illustrate that refinement of the coarse mesh resolution in nearshore areas, as well as the inclusion of tidal inlets, is important, but that the level of refinement is still subject for further research as the present methodology did not yet give reliable results for some inlets. We are working on establishing a robust algorithm for configuring the coarse mesh in the coastal regions of interest to ensure reliability at any open boundaries of a coastal estuary.\nA high resolution operational ensemble-based coastal forecast system has been developed for the east coast of Central Florida with the main focus on the IRL estuarine system. We use the spread of the hydrodynamic predictions, generated from the various wind forcings, as a proxy measure of uncertainty. The atmospheric model members include the deterministic NAM, three members from both the SREF GEFS. The outputs from the seven-member hydrodynamic ensemble are compared to one another as well as to observations within both the IRL and coastal zone. Preliminary results indicate that, in the nearshore, each of the members perform reasonably well compared to observations and the spread amongst the members is not significant i.e. no remarkable difference is seen within predictions made by seven ensemble members. However, the relative uncertainty could be considerable inside the estuary. The performance of the SREF and GEFS varied with respect to the two consecutive forecast cycles presented here and also depends on the validation locations. The largest spread was observed in the nearshore wave predictions 147 (i.e., at buoy 41113). For the selected forecast cycles in this study, the SREF and NAM had better forecast skill than the GEFS. This finding is not entirely surprising given that these two weather forecast models have higher spatial resolution than the GEFS. Resolving the nuanced land water geometry has been shown to be critical in capturing hydrodynamic variations within a coastal estuary (Weaver et al., 2016)."}, {"section_title": "Description of the system", "text": ""}, {"section_title": "Selection of atmospheric ensemble models", "text": "The atmospheric ensemble members, which provide wind forcing to the hydrodynamic model, consist of a medium-range coarse resolution (0.5 degrees) global and short-range, higher resolution (16 km) regional model. The former is the Global Ensemble Forecast System (GEFS) and latter, is the Short-Range Ensemble Forecasting (SREF) system. Regional models are forced at their lateral boundaries using boundary conditions obtained from global models, which can be problematic with respect to accuracy. However, higher spatial resolution is important with respect to capturing circulation patterns in confined water bodies such as estuaries (Weaver et al., 2016). The goals of this preliminary study are to lay the groundwork to determine whether or not forecast skill can be improved by applying an ensemble approach and to determine the sensitivities with respect to its individual members."}, {"section_title": "Global Ensemble Forecast Model (GEFS)", "text": "The Global Ensemble Forecast System (GEFS) is a global weather forecast model run by the National Center for Environmental Prediction (NCEP). GEFS is comprised of one analysis and 20 perturbations and its products are available by the NOAA National Operational Model Archive and Distribution System (NOMADS) four times daily at 00Z, 06Z, 12Z and 18Z. GEFS products are provided in longitude and latitude grids on 2.5\u00b0,1\u00b0, and 0.5\u00b0 resolution and files are formatted in GRIB2. resolution (12 km vs 0.5\u00b0) as well as the SREF whose products are available but the model has a cycle offset of 3 hours. The 6-hour nowcast is then used to initialize a 3.5-day forecast. The first nowcast is hot started from a tidal spin-up simulation. Subsequent forecast cycles are initiated from the previous nowcast cycle (model hot-starting, e.g., Ramakrishnan et al., 2007). The downloading and processing is comprised of 29 NAM forecast files (F00 to F84) at 3hourly intervals as well as 21 GEFS ensemble members and 13 SREF members (also 29 files at a 3-hourly interval). Because the download process is time intensive, in order to maximize the efficiency, forecast data files are retrieved simultaneously using all available CPUs. The user has the option to determine the number of ensemble runs via the command line. NAM files are retrieved and processed using sub-programs of the ASGS system that are embedded in Multistage. SREF and GEFS files are downloaded and processed by modular software programs developed in this work. The workflows of these modules are initiated by downloading GRIB2 files and extracting U and V components of forecast winds at 10 m above mean sea level as well as forecast sea surface pressure. For each ensemble model (SREF and GEFS), the mean and standard deviation of U and V wind components are separately calculated. The mean and standard deviation of the sea surface pressure is also calculated. Three distinct wind and atmospheric pressure forcing grids at 3 hourly resolution are generated from 13 members of SREF, and three forcing grids are created from 21 members of GEFS. Calculating the mean and standard deviation of the U and V components separately creates variations of wind directions within the generated wind forcings. interactions between basins (Blain, Westerink and Luettich, 1994;Dietrich et al., 2011). The coarse mesh has a maximum grid spacing of roughly 9 km in the deep Atlantic Ocean and a minimum of 900 m at IRL inlets and around the Caribbean and Bahamas Islands. A nested unstructured fine-scale high-resolution mesh consisting of 126,770 nodes represents the entire IRL and the proximity low-lying land, Fig. 2(B). The fine-scale mesh resolves most of the complex geometry inside the lagoon with a minimum grid spacing of 15-30 m near the causeways and relief conveyances, creeks, as well as the channels that pass "}, {"section_title": "Hydrodynamic responses", "text": "Validation graphics are presented at locations where real-time observations are available, Technology (Zarillo and Watts, 2018). The water level instrument, which is located at the north jetty of the inlet allows us to validate the boundary condition forcing at this location. "}, {"section_title": "140", "text": "Significant wave height, H s , is also validated by CPRG using real-time data collected form oceanographic instrumentation located approximately 530 m northeast of the Inlet mouth at depth of 10 m. Significant wave height is also validated at the Cape Canaveral nearshore station (NDBC) 41113 run by NOAAwhich is located less than 6 km east of Port Canaveral at a depth of 9.8 m. Within the estuary, validation is limited to two locations, one in the northern and a second in the southern portions of the IRL, and is limited to surface elevation only. These are the only hydrodynamic observations made available in near real-time inside the IRL. Both stations are operated by the US Geological Survey Both of these locations are within the coarse mesh. The model predicted water level is in deviates from these simulations in the early part of the cycle, but then become more similar to the other GEFS members. Water level time series predicted by NAM most often lies in the middle of the SREF runs. Time series plots of water level at the Haulover canal and Wabasso stations) are shown in Figures 5a and 5b. These validation points are located inside the estuary i.e. inside the fine scale high-resolution mesh. The hydrodynamic model appears to struggle somewhat at both locations, especially during the beginning of the validation cycle. At Haulover Canal, during the latter portion of the validation cycle, the SREF members appear to better match the observations while at Wabasso, it is the GEFS members that capture the observations within their ensemble spread. The highest forecast skill scores are obtained from the 144 \"GEFS mean\" and \"GEFS mean + std\", 0.85 and 0.82, respectively. The NAM run, which falls within the GEFS ensemble spread, has lower forecast skill (0.67) while the SREF members have forecast skill scores below 0.72. Similar to the validation at the Sebastian and Trident Pier stations, the GEFS has wider spread compared to the SREF during the validation cycle. At Wabasso, the spread in the GEFS simulations encompass the SREF members during the first 2.5 days of the forecast cycle. The maximum spread peaks around 20 cm on 25 January. At Haulover Canal, the maximum ensemble spread occurs on 24 January, which is similar to Sebastian CPRG and Trident Pier stations. While Haulover Canal is 40 km away from the nearest open boundary (i.e., Ponce Inlet), the Wabasso station is located 9 km south of the Sebastian Inlet. Similar to the open ocean validation locations, the NAM forced simulation is close to that of the SREF ensemble mean during the forecast cycle. The forecast skill of the NAM and the SREF mean are both 0.8 while that of the GEFS are quite low (0.158\u00b10.05)."}, {"section_title": "145", "text": ""}, {"section_title": "Wave Height", "text": "Nearshore wave validation is provided at both the Sebastian CPRG station and at Cape Canaveral nearshore (Figures 6a and 6b, respectively). The hydrodynamic predictions forced by NAM, \"GEFS mean + std\", and \"SREF mean -std\" yield the largest forecast skill scores (0.841, 0.8, and 0.84 respectively). During the forecast cycle, the GEFS ensemble spread begin to grow after 12 hours of the beginning of the forecast cycle while the SREF spread evolves after the first day of the forecast cycle. Towards the end of the forecast cycle, the SREF ensemble spread is much larger than the GEFS's. The NAM forecast is in better agreement with the \"SREF mean\" throughout the forecast cycle. During the validation period at Cape Canaveral, the \"SREF mean\" ensemble member had a skill score of 0.94 while the NAM's performance was similar (i.e., a skill of 0.95). Among"}, {"section_title": "Fig. 6. Ensemble of significant wave height and validations at (A) Sebastian Inlet and (B)", "text": "Cape Canaveral nearshore. GEFS members, the \"GEFS mean -std\" had the best forecast skill (0.85). The \"SREF mean\" shows better performance from 22 January through 12 UTC 23 January while the NAM appears to perform best during the latter portion of the forecast cycle. During the forecast cycle, the NAM run is close to the \"SREF mean\" run beginning the second day of the forecast cycle. Similar to the Sebastian CPRG station, the GEFS ensemble spread grows quickly over the first couple of days and reaches the maximum of 70 cm at 15 UTC 24 January. The GEFS spread then shrinks towards the end of the forecast cycle (to approximately 40 cm)."}]
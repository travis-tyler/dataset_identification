[{"section_title": "Abstract", "text": "Abstract. Climate Change is one of the most pressing challenges facing humanity in the 21st century. Climate simulations provide us with a unique opportunity to examine effects of anthropogenic emissions. Highresolution climate simulations produce \"Big Data\": contemporary climate archives are \u2248 5P B in size and we expect future archives to measure on the order of Exa-Bytes. In this work, we present the successful application of TECA (Toolkit for Extreme Climate Analysis) framework, for extracting extreme weather patterns such as Tropical Cyclones, Atmospheric Rivers and Extra-Tropical Cyclones from TB-sized simulation datasets. TECA has been run at full-scale on Cray XE6 and IBM BG/Q systems, and has reduced the runtime for pattern detection tasks from years to hours. TECA has been utilized to evaluate the performance of various computational models in reproducing the statistics of extreme weather events, and for characterizing the change in frequency of storm systems in the future."}, {"section_title": "Introduction", "text": "Climate simulations provide us with an unprecedented view of the state of earth's present, and potential future climate under global warming. Contemporary climate codes, such as CAM5 [2] , when run in 25-km spatial resolution with 6-hour data multi-variate dumps, produce over 100TB from a 25-year integration period. The current CMIP-5 archive [3] , consisting of international contributions from a number of climate modeling groups consists of over 5PB of data; this dataset was mined extensively for the IPCC AR5 report [5] . It is anticipated that CMIP-6 dataset [7] will cross the exabyte threshold with 25-km model runs being the norm. Faced with this massive deluge of multi-variate, spatio-temporal data, sophisticated and scalable \"pattern detection\" tools are critical for extracting meaningful scientific insights. One example of the types of climate data analytics of societal relevance is the identification and tracking of extreme weather. Figure1 illustrates the types of extreme weather observed in the natural climate system. Phenomena such as cyclones and atmospheric rivers can have widespread and long-lasting impact on national economies. Understanding how extreme weather events will change in the future climate is an important open question.\nIn order to address this important challenge, we have developed the Toolkit for Extreme Climate Analysis (TECA) [10] to identify storms in high-frequency climate model output. To date, we have applied our technique to identify three different classes of storms: tropical cyclones, atmospheric rivers and extra-tropical cyclones. Due to the high-frequency nature of the data required to identify and track individual storms in a climate model simulation, the raw input datasets that we have analyzed range from 0.5TB to 13TB. As the next generation of climate models moves into tropical cyclone permitting horizontal resolutions, we expect the publicly available datasets necessary for this type of analyses to exceed 10PB. By extracting the relevant storm trajectory information by \"Big Data\" analytics methods, we can dramatically reduce the volume of data needed to quantify the human -induced changes in storm behavior. Furthermore, the techniques we have developed are amenable to parallel execution, and are demonstrated to scale up to full size of the largest machines available to us, including a 150,00 core Cray XE6 and 750,000 core IBM BG/Q platform."}, {"section_title": "Methods", "text": ""}, {"section_title": "TECA (Toolkit for Extreme Climate Analytics)", "text": "TECA [10] is a climate-specific, high-performance pattern detection toolkit that is designed for efficient execution on HPC systems. We have developed the code in C/C++, and utilize MPI for intercommunication traffic. We utilize NetCDF-4 for parallel reads, and MPI-IO for producing output.\nThe design and implementation of TECA is guided by our observations of pattern detection problems in climate science. After analyzing the climate pattern detection literature for a number of event types, we discovered the following recurring theme. The detection process can be typically broken down into two steps:\n1. Detection of candidate points that satisfy multi-variate constraints 2. Stitching of candidate points into a trajectory that satisfies spatio-temporal constraints\nStep 1 tends to be data-intensive, involving loading anywhere between 10GB-10TB of data. The algorithm has to scan through all of the relevant fields to select candidate points. However, this step can be executed in parallel across timesteps. The degree of parallelism can be as high as the number of timesteps in the processed dataset (typically 10 2 -10 5 ); hence a dramatic speedup in overall runtime is feasible Step 2 involves pairwise analysis on potential storm matches across consecutive time slices in order to stitch trajectories. However, a small amount of data (typically 10MB-1GB) is required for this analysis, and this can be easily loaded on memory on a single node and executed in serial.\nConceptually, Steps 1 and 2 can be directly translated to the MapReduce computational paradigm powering much of the commercial Big Data Analytics workloads. TECA implements a custom framework for processing scientific datasets, with an eye towards high performance. We utilize the MPI interface for optimizing job launch and communication traffic. We stripe the NetCDF data across multiple low-level storage targets to optimize read performance. Writing (relatively small) partial results in Step 2 can create metadata bottlenecks, especially at concurrencies in excess of 50,000 cores. We implement a 2-phase collective I/O mechanism to aggregate writes on a smaller number of nodes (O(1000)) and perform file-per-node writes using MPI-IO."}, {"section_title": "TECA for detecting Tropical Cyclones", "text": "We have implemented the Tropical Cyclone detection procedure outlined in [?] . The detection step consists of finding co-located vorticity maxima, pressure minima (within a radius of 5\n\u2022 ) and temperature warm-core centers. The stitching step involves linking storms across subsequent 6-hr time windows. Candidate storms should travel lt 400km in 6-h, persist for at least 2 days, and have a wind velocity (gt 17m/s) during at least 2 days within their lifetime. "}, {"section_title": "TECA for detecting Extra-Tropical Cyclones", "text": "We implement the Extra-Tropical Cyclone detection and tracking procedure utilized in [12] . We detect a local minima in the pressure field within a 100x100 km radius. Ties between adjacent low-pressure storm centers are resolved based on strength of the local laplacian (i.e. storm centers with largest laplacian are declared to be candidates). Potential candidates are stitched into trajectories by performing a nearest neighbor analysis with distance constraints on storms (i.e. storms are constrained to travel lt 1000km in a 6-hr window, and lt 700 km in a 6-hr window in the North, South, and Westward directions. We only retain storms that persist for more than 24 hours, and travel gt 500km over their lifetime. Storms over high elevation areas (gt1500km) are excluded."}, {"section_title": "TECA for detecting Atmospheric Rivers", "text": "Atmospheric Rivers (ARs) are large, spatially coherent weather systems with high concentrations of elevated water vapor. These systems often cause severe downpours and flooding over the western coastal United States and western Europe. We have implemented an algorithm to detect ARs in the TECA framework [8] . We first compute a 2D Integrated Water Vapor (IWV) by performing a vertical integral on the specific humidity field. Following the definition of physical features of an AR [11] ; we perform a thresholding operation for identifying all grid points with IWV \u00bf 2cm. We then use a connected component labeling algorithm to find all the connected regions of grid points. We test if a candidate originates in the tropics, and makes landfall on the US coast. For all the polygons satisfying the origin and the landfall conditions, we compute a medial axis, and check if the length of the AR gt 2000km and if the width of the AR lt 1000km. If a polygon satises all of these geometric constraints, we declare it to be an atmospheric river \"pattern\".\nAll of these detection and stitching criteria can be easily accommodated within the design of TECA; thereby utilizing parallel job launch, execution and parallel I/O capabilities. Apart from returning summary statistics on storm counts and location, we are also able to pull out valuable detailed information on precipitation patterns and velocity profiles of storm during the course of their lifetime."}, {"section_title": "Experimental Setup", "text": ""}, {"section_title": "Data", "text": "We utilized multi-model output from the community produced CMIP-5 archive [3] , and a high-resolution version of the Community Atmospheric Model (CAM5) [2] simulations conducted by our group at NERSC. The CMIP-5 datasets are freely and publicly accessible via a number of international Earth System Grid Federation web portals and are the basis of most climate model results presented in the IPCC AR5 WG1 report [4] . The observational SSM/I datasets are available via a web portal [6] ."}, {"section_title": "Platforms", "text": "We utilized the Hopper system at NERSC, and the Mira system at ALCF for all results reported in this paper. Hopper is a 1.28 PF, Cray XE6 system featuring 153,216 compute cores, 212TB of memory and 2PB of disk available via a 35 GB/s Lustre filesystem. Mira is a 10PF, IBM BG/Q system featuring 786,432 cores, 768 TB of memory with 384 I/O nodes accessible via GPFS."}, {"section_title": "Results", "text": "We now report on both the scaling performance obtained by TECA on various HPC platforms, as well as the scientific results facilitated by these runs."}, {"section_title": "Scaling Performance", "text": "Table1 summarizes the performance of TECA on a range of pattern detection problems. We have analyzed CAM5 model output (0.5-13 TB), CMIP-5 multimodel output (6 TB), and SSMI (a 35 GB satellite data product). We have run TECA at full scale on Hopper and Mira platforms, facilitating pattern detection on these massive datasets. Needless to say, such pattern detection problems cannot be tackled on individual workstations. "}, {"section_title": "Science Results", "text": "We applied the TECA Atmospheric River detection capabilities to characterize ARs simulated by four CMIP-5 models (GFDL-ESM2M, HadGEM2-CC, MIROC5, CCSM4). We analyzed data for the RCP8.5, with the historical scenario as a baseline. We will now present and discuss both of these results."}, {"section_title": "Tropical Cyclones", "text": "One of the primary scientific utilities of the TECA software is to evaluate how well models perform in reproducing extreme event statistics, compared to observational records. If we assess models to perform well for the historical period, we can have greater confidence in the trends projected by the same models for future runs. We have applied TECA to the CAM5 0.25-degree output, over a simulated time period spanning 1979-2005 [13] . For this time period, the handcurated iBTrACS dataset reports 87 (+/-8) storms every year. TECA reports 84 (+/-9) storms, which is rather accurate. Figures 3 and 4 highlight the spatial distribution of the storms, as well as the seasonal distribution. We note that CAM5 does a good job of reproducing the spatial pattern, with perhaps too many storms in the central pacific. The model also does a good job of reproducing the seasonal pattern in various ocean basins (North Atlantic, Indian Ocean, Northwest Pacific), but the storms counts are off in the Pacific.\nAfter validating the TECA output for the historical period, w decided to apply the capabilities for climate change experiments conducted by various US and international efforts. We processed a climate change experiment specified by the CliVAR Working Group [1]. We used the CAM5 model to simulated the earth's climate under a baseline (climo), a scenario consisting of 2xCO2, SSTs increased uniformly by 2-celsius, and the conjunction of both CO2 and SST We applied the TECA AR detection capability to the SSM/I satellite product. Fig8 shows a range of diverse AR features returned by our implementation. We note that the implementation is reasonably robust to various shapes and sizes of AR events. In order to validate the procedure, we compared the events returned by TECA to a hand-curated database of known AR events maintained by [9] . We note that TECA was able to detect 93% of all events reported in the database. We furthermore applied the TECA toolkit to various CMIP-3 and CMIP-5 models over the historical period. Fig7 shows that several models match reasonably well with the observed record, however, some models do exhibit hyperactivity with regards to generation of ARs."}, {"section_title": "Extra-Tropical Cyclones", "text": "In ongoing work, we have successfully applied TECA to detect Extra-Tropical Cyclones in climate data. In perhaps the leading example of Scientific Big Data analytics, we scaled TECA to process the entire CMIP-5 archive (historical and RCP8.5 runs, all ensemble members, 6-hourly data) in one shot on 750,000 cores "}, {"section_title": "Conclusions", "text": "Pattern Recognition problems are increasingly common in the scientific world. As a leading example, Climate science requires sophisticated pattern recognition on TB-PB sized datasets. We have developed and successfully applied TECA to the problem of finding extreme weather phenomena (such as tropical cyclones, atmospheric rivers and extra-tropical cyclones) across the most contemporary climate models (CAM5), data archives (CMIP-5) and observational products (SSMI). We have scaled TECA on DOE's leading HPC platforms at NERSC and ALCF, and obtained important scientific insights on the potential change in extreme weather phenomena in future climate regimes."}]
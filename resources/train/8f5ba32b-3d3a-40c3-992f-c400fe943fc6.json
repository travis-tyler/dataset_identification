[{"section_title": "INTRODUCTION", "text": "Significant progress has been made in the diagnostic decision-making processes and in predicting the onset and the course of brain disorders [Kantarci and Jack, 2003; Lovestone, 2010; Rachakonda et al., 2004; Roe et al., 2011] . The traditional endpoint diagnosis, clinical measurements, and cognitive tests used in clinical trials have proved to be informative but have their own limitations in accurately quantifying the progression of brain disorders in an unbiased and objective manner [Borroni et al., 2007; Knopman et al., 2001] . Advances in brain imaging technologies have enabled researchers to investigate and test novel biomarkers that could serve either as diagnostic tools to aid clinical decision-making or as surrogates, reflecting disease progression and underlying disease pathology [Biomarkers Definitions Working Group, 2001] . Accordingly, there is a growing body of evidence in the literature showing that structural and functional brain imaging can be valuable tools for predicting and classifying gradually progressive neurological and psychiatric disorders such as Alzheimer's disease (AD) [Drzezga, 2009; Kawachi et al., 2006; Mosconi et al., 2006; Nordberg et al., 2010; Tartaglia et al., 2011] . Although both PET and MRI imaging modalities have been found to be discriminative in various neurological disorders, there is disagreement in the community about which are most sensitive for particular disorders. Specifically, differences in sensitivity and specificity of structural magnetic resonance imaging (MRI) and 2-deoxy-D-glucose (FDG) positron emission tomography (PET) features in the prediction of early AD has been debated in the literature with no clear consensus [De Santi et al., 2001; Mosconi et al., 2006] . Nevertheless, AD research studies evaluating the diagnostic and predictive value of regional specific glucose metabolic rate and volume changes suggest the greater reliability of FDG PET over MRI in discriminating AD from subjects with intact and mild cognitive impairment (MCI) [De Santi et al., 2001; Kawachi et al., 2006; Mosconi et al., 2006] . However, De Santi et al. and Mosconi et al. indicate image postprocessing influences the outcome of discriminative analyses and subsequently, their predictive value.\nAlthough advances in imaging have enabled researchers to visually inspect both functional and structural brain scans of disease, it is often difficult for the human observer to identify the subtle differences in the brain images that are often necessary for reliable disease classification. Furthermore, visual identification of brain diseases by a human observer is time consuming and error prone. Automated image analysis algorithms that can reliably discriminate the diseased from the healthy brain are preferred because they save time, are generally less prone to errors, are not influenced by rater bias or inter-rater differences in neuroanatomical expertise, and can identify subtle statistical correlations in the data. For preventative and longitudinal studies in large populations, automated image analysis is critically important to evaluate the data. To achieve automated and reliable image analysis and classification, we can use computer vision techniques that are designed to extract information from images.\nObject recognition in images and video is an active area of research in the computer vision community. Finding objects is fundamentally related to pattern recognition where the presence of unique patterns of colors, edges, and/or textures are consistent with a particular class of object. Probabilistic models are particularly well suited for recognition problems because they provide a structured approach to modeling uncertainty and can be less sensitive to noise in the data. Object recognition systems often consist of a feature extraction component and a classifier. The feature extractor is used to identify properties of the objects that are most important in discriminating one object from another. The features along with a labeled training set are then used to train a classifier to map the features into a class label for each object the detection system is built to recognize. Although the overall process is simple, there are many subtleties in real world applications of detection systems such as object illumination, scale, occlusion, and orientation that affect accuracy. Most often we have a small set of images representing the objects to be recognized and do not have exhaustive examples at all possible scales, orientations, illuminations, etc. The challenge is therefore to find a feature space that avoids irrelevant variations in the objects and instead captures the most discriminating characteristics [Forsyth and Ponce, 2002] .\nOne source of inspiration for engineering such invariant features is the primate visual system, which performs object detection robustly across a huge range of viewpoints, illuminations, and occlusions. One very successful r Keator et al. r r 2 r method, the scale invariant feature transform (SIFT) proposed by Lowe [1999] uses features with partial invariance to local variations in scale and illumination, similar to the receptive fields of the neurons in the inferior temporal cortex, an area important for object recognition in primates. Serre et al. [2005] introduced a filtering method whose hierarchical architecture was designed specifically to emulate visual processing in the cat and primate striate cortex. They applied this method to detecting objects in photographs and reported high success rates from a few training examples. Mutch and Lowe [2006] reported similar performance results using a similar filtering scheme that scaled the input images instead of the filters as was done in Serre et al.'s work.\nSimilar to object recognition in photographs, for automated image-based diagnosis, it is necessary to ignore some classes of variation across healthy individuals while identifying other specific variations which are indicative of disease state. Differences in ligand uptake in the brain measured by functional brain imaging modalities such as FDG PET and Tc99m HMPAO Single Photon Emission Tomography (SPECT) result in spatially smooth patterns of differing intensities which can be used to differentiate a disease group from healthy subjects. Similarly, precise morphology/anatomy may vary among individuals requiring some degree of local scale and orientation invariance. Based on this insight, we extend the neurologically inspired filtering model described by Serre et al. [2005] to signal detection in functional brain imaging. To evaluate how well the Serre et al.'s feature model works in capturing disease patterns in the human brain, the model is extended to three-dimensional volumetric space and signal detection differentiation in functional brain imaging. The hierarchical filtering pipeline is analyzed to identify which steps are most important for classification accuracy and the filter outputs are used to train both neural network (NN) and logistic regression (LR) classifiers. Two distinct and previously published datasets are tested using this feature extraction and classification method: (1) Alzheimer's Disease Neuroimaging Initiative (ADNI) AD FDG PET scans sampled at baseline, 12 months, and 24 months time-points versus the study-specific agematched healthy comparison (HC) subjects [Mueller et al., 2008] ; (2) a Tc99m HMPAO SPECT National Football League (NFL) dataset versus study-specific age-matched HC subjects [Amen et al., 2011] . The AD classification results are further compared against a blinded expert human rater (J.H.F.), providing a baseline measure of how well a human counterpart can recognize disease in the same dataset."}, {"section_title": "METHODS", "text": ""}, {"section_title": "Filtering and Feature Extraction", "text": "The image filtering pipeline consists of a series of alternating steps of simple filtering (S layers) and complex filtering (C layers) layers briefly summarized here and discussed in detail in subsequent sections. The first simple layer (S1) outputs respond to oriented edges at different spatial scales and orientations (see S1 Layer). Spatial scales in this context refer to the underlying spatial distribution of the signal in the images. Filters with larger spatial scales will respond to larger (spatially) image signals. S1 layer filters are separated into ''bands'' where each band is composed of two similar spatial scales as shown in Table I , rows 1 and 2. The first complex layer (C1) combines the outputs from the S1 layer at different scales but within orientations, providing scale invariance (see C1 Layer). The complex layers pool the simple layer outputs using a max operator, where the strongest simple layer output drives the complex layer output. The second simple layer (S2) matches the detections from the C1 layer against healthy subjects in a template matching framework where higher scores indicate a closer match (see C1 Layer Training Patches and S2 Layer). The second complex layer (C2) combines the outputs from template matching scores across orientations gaining invariance to orientation (see C2 Layer)."}, {"section_title": "S1 layer", "text": "The S1 layer is computed by applying 16 orientated three-dimensional Gabor filters at orientations y [ {0, p/4, p/2, 3p/4}, f [ {0, p/4, p/2, 3p/4}, and wavelength k to each brain scan in the dataset. A Gabor filter is a linear filter whose impulse response is a harmonic function multiplied by a Gaussian function: G\u00f0x; y; z\u00de \u00bc 1\n\u00c2 cos 2p k \u00f0x cos\u00f0h\u00de sin\u00f0/\u00de \u00fe y sin\u00f0h\u00de sin\u00f0/\u00de \u00fe z cos\u00f0/\u00de\u00de 8 > : The cosine term in Eq. (1) controls the harmonic component through the k wavelength parameter. The variables x, y, and z are the spatial variables defining the spatial extent of the filter. The standard deviation r describes the size of the Gaussian envelope. The orientation of the filter is represented by variables y and f, where f orients the filter in the x-y plane and y is the orientation from the positive z axis. For a detailed description of three-dimensional Gabor filters, refer to Bau et al. [Bau and Healey, 2009; Bau et al., 2008] . Frequency and orientation representations of the filter are similar to those of the human visual system. The original Serre method performed Gabor filtering in twodimensional, consistent with the image matrix of photographs. In this work, the Gabor filtering was performed in three-dimensional and applied using filter sizes, sigmas, and lambdas over a series of eight bands. The parameters of each band are listed in Table I , rows 2 to 4. The filter sizes and parameters were kept essentially the same as the Serre work, but the spatial extents of the bands were decreased in order to make the features more sensitive to small activation differences in functional brain imaging. The relative proportions between sizes across the bands remained the same. The voxel sizes of the functional brain imaging data used in this study were 2 mm 3 per voxel (see Methods for a detailed description of the test data). The smallest filter size in the Serre work (7 pixels) if directly applied as seven voxels would be unlikely to respond to small differential signals that could be discriminative in the context of functional imaging and disease. To avoid missing small signals, the lowest filter band was set to three voxels. An example of the AD PET scan slices filtered with the three-dimensional Gabor functions are shown in Figure 1 . Oriented signals are indeed differentially selected by the filters, consistent with our hypothesized responses of the filters when applied to functional brain imaging data."}, {"section_title": "C1 layer", "text": "The C1 layer combines incident S1 units of the same y and f orientations, creating tolerance to size and shift within Gabor filter orientation. Complex cells in the hierarchical visual cortex model have larger receptor fields than the S1 layer [Serre et al., 2005] . To operationalize this Figure 1 . Examples of Gabor filtered slices. For each example, the filter size, r, and k remained constant at 5 3 , 2.1, and 2.6, respectively while the orientation parameters y and f were varied. A) y \u00bc 0, relationship, the S1 layer volumes are filtered with a max operator over Gabor filter scales (Table I , row 1(filter)), but within each orientation band (columns of Table I ). Max filtering is a nonlinear image processing technique where the value at each voxel in the filtered image is the maximum of the input image voxels in a local neighborhood defined by the filter size. The filter size over which the maximums are calculated depends on the Gabor filter size (shown in Table I , row 4 (max grid)). Gabor filters with larger spatial scales will respond more strongly to larger (spatially) signals in the images at the same y and f orientations, therefore, the corresponding max filter sizes should be tuned accordingly. These operations are performed for each Gabor orientation and for each band resulting in 16 \u00c2 8 volumes, representing maximums over scales but within orientations. Due to the large numbers of voxels in the volumes and thus the large numbers of max operations over increasing neighborhoods, we used the algorithm developed by Van Herk et al. [1992] to efficiently compute the maximums over neighborhoods for each voxel in the S1 layer volumes. The method requires only a small number of operations per voxel to compute the maximums and lowers the computational time of this stage of the processing pipeline.\nC1 layer training patches. Template matching is a common approach to object recognition in computer vision systems. It is a technique which matches image regions to stored representative templates using a specific scoring function [Brunelli, 2009] . In this work, representative templates were collected on a random subset of hold-out healthy subjects to be used in the subsequent S2 layer template-matching step. Ten randomly selected hold-out training images were chosen for template extraction. Templates were extracted randomly across these training images and from random locations within the images but constrained to fall within the boundaries of user specified regions of interest (see The Alzheimer's Disease Neuroimaging Initiative (ADNI)). The regions from which templates are randomly sampled are completely user defined and could be chosen based on some a priori hypothesis or from the literature. Selecting templates from specific regions of interest in the brain is similar to learning that a car is characterized by particular features in spatial locations, e.g. rides on four tires, has doors on the sides, a hood on the front, etc.\nOperationally, the user selects regions of interest and the number of features before pipeline execution. We uniformly divide the number of random locations across the number of regions of interest. To generate the random voxel locations within a region of interest, we use an atlas labelmap, which assigns a numerical code to each atlas region. Each atlas region is therefore defined by all the contiguous voxels in the labelmap volume that have equal numerical codes. From this information, we can find the cube containing this region. We then use rejection sampling: drawing a random point uniformly within the cube, we accept it if it falls within the bounded region; otherwise we reject and try again. This process continues until the required number of locations has been found for each region. In our experiments, 50 or 100 templates were chosen to describe the low level representation of the brain images. We chose the two sets such that we had a reasonable number of templates per region of interest selected and so we could evaluate the dependence of the classification results on the number of feature scores used. The original Serre work suggests a modest dependence of performance on the number of feature scores used. For each selected template location, 5 3 , 9 3 , 13 3 , and 17 3 voxel ''patches'' were extracted from each of the 16 Gabor filtering orientations and bands from the C1 layer of the 10 randomly selected hold-out healthy subject training images. These patches are simply contiguous sets of voxels of differing spatial extents (5 3 , 9 3 , 13 3 , and 17 3 ) centered on the template location and effectively give the vision system a ''memory'' of image feature examples from the functional brain images of healthy subjects."}, {"section_title": "S2 layer", "text": "The S2 layer corresponds to the template-matching phase of the pipeline. For each C1 image in the test dataset and for each template patch collected from the hold-out healthy subject data, we compare the Gaussian radial basis function score shown in Eq. (2) for each band independently. The S2 unit's response depends on the Euclidean distance between the test dataset patch (X) and the stored prototype patch (P) sampled at the same location, scale, and orientation. If the functional activity profile in the test data is identical to the stored template patch, the score equals 1 whereas if the differences from the stored template patch are large, the score approaches 0. The parameter c normalizes for different patch sizes (n [ {5, 9, 13, 17}) when computing the score in Eq. (2). The parameter c is fixed to (n/5) 3 where n is the patch size and the denominator is the smallest patch size. The parameter r in Eq. (2) is the uncertainty or variance in the stored prototype patch (P). This parameter was set to 1 in all experiments. Alternatively, it could be set to the empirical variance of the training prototype patches discussed in C1 Layer Training Patches."}, {"section_title": "C2 layer", "text": "The final layer in the pipeline computes the maximum response of the S2 layer scores from all bands and orientations for each prototype template. The final feature sets therefore consist of 50 or 100 shift and scale invariant scores (i.e., for 50 and 100 prototype patches) that are subsequently used for classification. Conceptually, for each r Functional Brain Imaging in Monitoring Brain Disorders r r 5 r test image, for each prototype template patch sampled from a brain region, we are using the score that indicates the best match between the test image and a healthy subject regardless of signal size and orientation. We expect that subjects with neurological disorders will match less well with the healthy subjects and thus have a lower score. The final size of the feature vector therefore depends only on the number of patches extracted during training and not on the number of voxels in the full three-dimensional brain image. This allows the user to balance the number of template patches sampled during patch selection (i.e. number of features) and the number of subjects available in the dataset. Flexibility in choosing the number of features provides insulation from classifier overfitting, which can occur if the number of features greatly exceeds the number of examples."}, {"section_title": "Evaluation", "text": "We used two datasets to evaluate the approach. Both are functional imaging datasets but distinctly different modalities. We selected these datasets to evaluate the generality of this approach and its application to distinctly different neurological abnormalities."}, {"section_title": "The Alzheimer's Disease Neuroimaging Initiative (ADNI)", "text": "ADNI was launched in 2003 by the National Institute on Aging (NIA), the National Institute of Biomedical Imaging and Bioengineering (NIBIB), the Food and Drug Administration (FDA), private pharmaceutical companies, and nonprofit organizations as a $60 million, 5-year public-private partnership. The primary goal of ADNI is to test whether serial MRI, PET, other biological markers, such as cerebrospinal fluid (CSF) markers, Apolipoprotein E (APOE) status, and full-genome genotyping via blood sample, and clinical and neuropsychological assessments can be combined to measure the progression of MCI and AD. Determination of sensitive and specific markers of very early AD progression is intended to: (1) aid in the development of new treatments, (2) increase the ability to monitor their effectiveness, and (3) reduce the time and cost of clinical trials. The principal investigator of the initiative is Michael W. Weiner, M.D., of the Veteran's Affairs Medical Center and University of California, San Francisco. ADNI is the result of efforts of many coinvestigators from a broad range of academic institutions and private corporations, and participants have been recruited from over 50 sites across the U.S. and Canada. ADNI participants range in age from 55 to 90 years and include approximately 200 cognitively normal elderly followed for 3 years, 400 elderly with MCI followed for 3 years, and 200 elderly with early AD followed for 2 years. Participants are evaluated at baseline, 6, 12, 18 (for MCI only), 24, and 36 months (AD participants do not have a 36-month evaluation). Baseline and longitudinal follow-up structural MRI scans are collected on the full sample and 11 C-labeled Pittsburgh Compound-B ( 11 C-PIB) and FDG PET scans are collected on a subset of every 6 to 12 months (for study details see http://www.adni-info.org). A subset of these data were published in Mueller et al. [2008] and Langbaum et al. [2009] was used in this analysis."}, {"section_title": "AD dataset", "text": "The dataset used in this study consisted of 154 baseline FDG PET scans acquired as part of the ADNI study and published in Mueller et al. [2008] and Langbaum et al. [2009] . There were 82 HC subjects (mini-mental state exam (MMSE) 28.6 AE 1.1; age 75.1 AE 9.6 yr) and 72 AD subjects (MMSE 23.2 AE 3.5; age 75.1 AE 11.2 yr) from the baseline ADNI sample used for this study. The 12m and 24m ADNI samples contained a subset of the baseline dataset due to subject dropout. The 12m sample included 72 HC subjects (MMSE 29.2 AE 1.2; age 77.5 AE 8.4 yr) and 61 AD subjects (MMSE 20.9 AE 4.9; age 75.4 AE 11.8 yr). The 24m sample included 68 HC subjects (MMSE 28.6 AE 3.7; age 76.0 AE 10.2 yr) and 33 AD subjects (MMSE 18.4 AE 6.1; age 74.6 AE 15.2 yr). The acquisition protocol consisted of collecting six 5-min frames 30 to 60 min post-18 FDG injection. During the uptake period subjects were asked to rest comfortably in a dimly lit room with their eyes open. The collected frames were registered to the first frame (acquired at 30-35 min postinjection) and averaged to yield a single 30 min average PET image in ''native'' space. The image matrix, field of view, and resolution of the datasets from participating sites were then matched by the ADNI group. The images were spatially normalized to the MNI atlas using SPM8 software (2007) resulting in image matrices of 79 \u00c2 95 \u00c2 68 voxels in x, y, and z dimensions, respectively with isotropic 2 3 mm voxel sizes. The Automated Anatomical Labeling (AAL) atlas was used to constrain the region of interest selection based on the anatomical parcellations available in the atlas [Tzourio-Mazoyer et al., 2002] . The AAL atlas used to define the region of interest boundaries is consistent with the space defined by the MNI atlas.\nCoordinates for template patch sampling and S2 layer matching scores were constrained to fall within regions identified in the literature to be affected by AD (see C1 Layer Training Patches and S2 Layer). Delacourte et al. identified stages of AD neurofibrillary degeneration in patients of various ages and different cognitive statuses [1999] . Further, Langbaum et al. [2009] identified regions of reduced metabolic rates in AD. Regions included the cingulate cortex, parietal and temporal lobes, among others. For this study, we chose AAL atlas regions (bilateral): anterior and posterior cingulum, temporal lobes (middle), hippocampus, amygdala, thalamus, frontal and orbital cortices (superior and middle), temporal pole (superior, middle, inferior), and parietal lobe (inferior) as being consistent with published findings on potentially discriminative regions."}, {"section_title": "NFL dataset", "text": "The NFL dataset used in this study consisted of 162 technetium-99m hexamethylpropyleneamine oxide (Tc99m HMPAO) SPECT scans acquired for a study evaluating the impact of playing American football by Amen et al. [2011] . There were 83 HC (age 41.7 AE 17.8 yrs) and 79 NFL (age: 57.5 AE 11.5 yr) subjects. Subjects were injected with an age/weight appropriate dose of Tc99m HMPAO and performed the Conners' Continuous Performance test II for 30 min during uptake. All subjects completed the task and were subsequently scanned on a high-resolution Picker Prism 3000 triple-headed gamma camera with fan beam collimators. The original reconstructed image matrices were 128 \u00c2 128 \u00c2 29 voxels with sizes of 2.16 mm \u00c2 2.16 mm \u00c2 6.48 mm. The images were spatially normalized to the MNI atlas using SPM8 software (2007) resulting in image matrices of 79 \u00c2 95 \u00c2 68 voxels in x, y, and z dimensions, respectively with isotropic 2 3 mm voxel sizes. Images were smoothed using an 8-mm FWHM isotropic Gaussian kernel. The preprocessing steps were identical to the previously published work by Amen et al. In the previously published work, a subset of the HC dataset was used and matched on gender and race. For this work, all subjects were used regardless of race and gender.\nCoordinates for template patch sampling and S2 layer matching scores (see C1 Layer Training Patches and S2 Layer) were constrained to fall within regions identified in Amen et al. as the top discriminating regions for the NFL group. To our knowledge, the Amen study was the first brain imaging study evaluating NFL players and as such, the regions were picked based only on that publication. For this study, we used AAL atlas regions (bilateral): anterior and posterior cingulum, frontal pole, hippocampus, amygdala, and temporal pole (middle and inferior)."}, {"section_title": "Ethics", "text": "The NFL study was approved by each of the participating sites' Institutional Review Boards (IRBs) and complied with the Code of Ethics of the World Medical Association (Declaration of Helsinki). Written informed consent was obtained from all participants after they had received a complete description of the studies.\nThe ADNI data were previously collected across 50 research sites. Study subjects gave written informed consent at the time of enrollment for imaging and genetic sample collection and completed questionnaires approved by each participating sites' Institutional Review Board (IRB)."}, {"section_title": "Feature sets", "text": "In order to identify which components of the feed-forward hierarchical model implemented in this study were most important in correct classification, three separate feature sets were computed. The FTM (Gabor filter \u00fe template match) feature set is the result of the full hierarchical pipeline as described in Methods. In order to understand the effect of the Gabor filtering, the TM (template matching) dataset was created using the same procedures outlined in Methods without Gabor filtering. More precisely, the dataset consists of selecting template patches from the unfiltered images (neither S1 nor C1 layers) and performing the computations in the S2 and C2 layers. To evaluate the effect of template matching, the AP (average patch) feature set consists of simply averaging the voxels in the neighborhood around the prototype patch locations selected in C1 Layer Training Patches, across the various filter sizes (Table I , row 2) and taking the maximum response.\nTo compare the feature sets of the hierarchical model with more typical data reduction (DR) techniques, the maximum group difference (MaxT) and DR sets were computed. The MaxT feature set is computed by performing a typical voxel-wise independent, two-sample t-test in the SPM8 software. The resulting SPM(t) maps were then thresholded at P < 0.01 (AD baseline), P < 0.001 (AD 12m), P < 0.001 (AD 24m), and P < 1e-6 (NFL) and corrected for multiple comparisons using the family-wise error rate (FWE) correction. Probability thresholds were chosen to limit the number of voxels in the resulting tscore maps such that similar numbers of voxels were obtained for each data set ($3K points). The absolute values of the resulting t-scores were ranked and the data from the top 50 and 100 locations were then sampled from each subject and used for classification (MaxT). The DR feature set used all the locations found in the group difference maps, discussed above, after probability thresholding ($3K points), sampling the original data at those locations ($3K points) for each subject. The resulting N \u00c2 K matrix (N subjects, K sampling locations) was mean-centered for each column K and run through principal components analysis (PCA). Each subject's data was then projected onto the eigenvectors of the top 50 and 100 largest eigenvalues from the PCA decomposition giving a low dimensional representation with 50 or 100 feature scores that were subsequently used for classification. The top 50 and 100 largest eigenvectors were chosen so that the projected dataset contained 50 and 100 scores per subject, consistent with the number of feature scores calculated from the full feed-forward hierarchical model."}, {"section_title": "Classification", "text": "Classification was done using both a multilayered perceptron NN and a LR classifier to understand the dependence of the results on the classifier chosen [Hall et al., 2009] . Each classifier was trained separately on the same datasets to compare the performance of the simpler LR classifier, able to find linear decision boundaries, with the NN classifier, able to model more complex nonlinear functions. The NN was constructed with one hidden layer (hidden layer nodes \u00bc (#features \u00fe #classes)/2) and r Functional Brain Imaging in Monitoring Brain Disorders r r 7 r trained with a learning rate of 0.3 and a momentum of 0.2. For each classifier, 10-fold cross validation was used. The dataset was divided in each fold into training and testing subsets. The classifier was trained using the training subset and tested on the testing subset. This process was repeated 10 times. Areas under the receiver operating characteristic (ROC-AUC) curves were computed from the probability of class membership of the testing data from each of the trained classifiers. The full filtering pipeline (FTM) ROC-AUC curves were statistically compared with each of the alternative methods for each dataset and classifier using the DeLong et al. [1988] method of comparing areas under correlated ROC curves as implemented in the pROC package [Robin et al., 2011] . To compute 95% confidence intervals and statistics, the data were resampled 2,000 times, stratified by group membership.\nTo compare the classifier results on the baseline AD dataset with the visual ratings of neuroanatomist (J.H.F.), true-positive (TP) and false-positive (FP) rates were calculated. To calculate the TP and FP rates, the probability of class membership from the trained classifiers for each testing subset data point, in each fold, was computed. The data point was assigned to the class with the largest probability. The TP rate was the proportion of examples in the testing subsets that were classified as class AD, among all testing examples that were originally labeled as class AD. The TP rate is the average across all folds. The FP rate was the proportion of examples in the testing subsets that were classified as class AD, but were originally labeled as the alternative class, among all testing examples which are not of class AD. The FP rate is the average across all folds. The TP and FP results for Dr. Fallon were computed from his designation of either AD or healthy control for each of the baseline data compared with the original class labels."}, {"section_title": "RESULTS", "text": "To summarize the performance of each classifier, the ROC-AUC results for the Alzheimer's disease (AD) baseline, 12m, and 24m datasets are shown in Figures 2-4 , respectively for 50 and 100 feature datasets and both LR and NN classifiers. The confidence intervals for each ROC-AUC and statistical comparisons of the FTM with each of the other methods for all classifiers and datasets are shown in Tables II-IV. The FTM method outperformed the other methods in terms of ROC-AUC in 80% of the tests, and was statistically better in 35%. No other method was statistically better than FTM; although, the PCA DR strategy in the 50-feature, baseline AD, LR classifier was close (P < 0.064). Overall, the NN classifier generally outperformed the LR classifier in ROC-AUC. Further, the FTM method was statistically better than all other methods in 46% of the NN classification experiments compared with 25% using the LR classifier, suggesting a benefit of using the more sophisticated classifier with the FTM method. There was a small, nonsignificant, increase on average in ROC-AUC over all the classifiers in the results using the larger 100 feature datasets. Overall performance of the FTM trained classifiers were consistent with other published classification results (see Discussion) using the ADNI dataset, with maximum ROC-AUC at baseline of 0.962 AE 0.025 (NN, 100 feature), at 12m of 0.837 AE 0.073 (NN, 100 feature), and at 24m of 0.878 AE 0.070 (NN, 100 feature).\nNeuroanatomist (J.H.F.) was given the baseline AD dataset images in transaxial, coronal, and sagittal orientations, without the diagnosis and given no practice set of normal or ADs to examine before the analysis, and asked to classify the scans as either AD or HC. These results are only available for the baseline AD data due to the significant effort in manually rating so many scans. J.H.F. achieved a true/false-positive rate for AD of 0.718/0.380 and for the HC group of 0.671/0.244 as shown in Table VI . The FTM classifier performed better in both true/false positives for both AD and HC groups while also outperforming the MaxT and DR methods, further suggesting the potential utility of this approach.\nThe AUC results for the NFL group are shown in Figure  5 for 50 and 100 feature datasets and both LR and NN classifiers. The confidence intervals for each ROC-AUC and statistical comparisons of the FTM with each of the other methods for all classifiers and datasets are shown in Table V . Interestingly, unlike the AD dataset, the FTM method did not dominate the others, outperforming the other methods in 44% of the tests and was statistically better in only one. Alternatively, the MaxT method consistently outperformed the others in terms of ROC-AUC and was statistically better than the FTM method in three out of four comparisons. We speculate this result is related to specific brain functional changes accompanying repeated head injuries evident in the NFL dataset (see Discussion). Overall performance of the FTM classifier was still quite good with maximum ROC-AUC of 0.939 AE 0.037/0.145 (LR, 100 features). Unlike the AD experiments, the NN classifier did not outperform the LR classifier for the FTM dataset but did for the best performing MaxT dataset."}, {"section_title": "DISCUSSION", "text": "The overall classification results suggest the biophysically inspired feed-forward hierarchical model used in these experiments is sensitive to differences in functional brain imaging data. Both AD and NFL classification experiments showed impressive ROC-AUC rates using a method not specifically tuned for these imaging modalities. The FTM results are consistent with published classification rates for the ADNI AD data set using brain imaging; although, most reported results use a mix of structural and functional imaging features. For example, Hinrichs et al. used the ADNI dataset in a spatially augmented boosting framework and reported an ROC-AUC of 0.8716 when using just FDG PET [Hinrichs et al., 2009] "}, {"section_title": "Figure 2.", "text": "Area under the ROC curve for AD classification of the ADNI baseline data set for logistic regression (LR) and neural network (NN) classifiers for both 50 and 100 feature datasets (MaxT \u00bc maximum t-score, DR \u00bc PCA data reduction, AP \u00bc average patch, TM \u00bc template matching, FTM \u00bc Gabor filtering \u00fe template matching). The FTM method outperforms the others in 94% of the cases and is statistically better in 50% of the cases. The table lists ROC-AUC measurements, 95% confidence intervals, z-scores, and probabilities for comparisons of the FTM method with the other methods within each dataset and classifier combination. Negative z-scores indicate methods that are lower in ROC-AUC than the FTM method. Significant differences are highlighted in bold.\nMaxT \u00bc maximum t-score, DR \u00bc PCA data reduction, AP \u00bc average patch, TM \u00bc template matching, FTM \u00bc Gabor filtering \u00fe template matching."}, {"section_title": "Figure 3.", "text": "Area under the ROC curve for AD classification of the ADNI 12m data set for logistic regression (LR) and neural network (NN) classifiers for both 50 and 100 feature datasets (MaxT \u00bc maximum t-score, DR \u00bc PCA data reduction, AP \u00bc average patch, TM \u00bc template matching, FTM \u00bc Gabor filtering \u00fe template matching). The FTM method outperforms the others in 88% of the cases and is statistically better in 38% of the cases. A benefit of using LR classifiers is the clear interpretation of which features are most informative for classification. For baseline AD classification, the four most informative patches (highest weights) were sampled from AAL atlas regions right hippocampus and superior temporal lobes left and right while the posterior cingulate, a region commonly associated with disease progression, ranked fourth. For 12m AD classification the most informative patches were sampled from frontal superior right, frontal superior orbital left, and the temporal pole superior right. For 24m AD classifications the most informative patches were sampled from the frontal superior right, temporal pole mid left, and hippocampus left. It is interesting that the frontal lobe was not included as a top discriminating location in the baseline data set but was in both the 12m and 24m data, consistent with well-known structural changes in AD disease progression. We also evaluated the performance of the FTM features using ROIs that specifically did not include those selected in AD dataset. The results were on average 10 to 15% lower in ROC-AUC for baseline AD than those reported in the Results, suggesting this method is sensitive to region of interest selection. Therefore we suspect the filtering pipeline could be used to test competing hypotheses about specific regions of interest implicated in disease. The top three most informative patches from the features evaluated using ROIs that specifically did not include those selected in AD dataset, were sampled from AAL atlas regions frontal inferior orbital left, insula right, and occipital middle right. Other informative patches for AD included the supramarginal right, lingual right, and frontal inferior operculum left. Interestingly, the frontal inferior orbital, operculum, and the supramarginal gyrus are all associated with AD in the literature suggesting the classification results are still picking up on areas related to the disease [Espasy and Jacobs, 2010; Grignon et al., 1998 ]."}, {"section_title": "TABLE III. Results from the AD ROC-AUC analysis of the ADNI 12m data", "text": "Overall, the average patch (AP) feature set outperformed the template matching (TM) feature set, suggesting no compelling benefit of template matching without Gabor filtering in this application. The utility of oriented Gabor filtering and template matching in deriving the feature set was most evident in AD classification. This trend was not observed for the NFL classification experiments. Why would oriented filtering improve classification rates in AD and not the NFL data set? It is well known in the literature that structural changes in AD follow an anatomical trajectory starting in entorhinal cortex and hippocampus, then moving to temporal and parietal lobes, and finally affecting the frontal lobes in late stage AD [Braak and Braak, 1997; Hua et al., 2008; Thompson et al., 2003 ]. These structural changes should be reflected in corresponding functional changes. In addition, the accumulation of amyloid plaques between nerve cells in the brain is known to be a hallmark of AD. Both the structural changes and plaques may be altering the functional brain imaging derived signal in orientation, scale, and localized spatial extent due, in part, to brain plasticity and compensation.\nAlternatively, the FTM might not perform as well in data sets with widespread, global functional changes observed in the NFL data. Indeed the article by Amen et al. reports ''significant decreases in regional cerebral blood flow were seen across the whole brain.'' The comparison feature sets MaxT and DR should perform well in that setting because they rely on group differences and maximal variation. It is possible that the FTM method performs better in settings with more localized functional differences. The NFL dataset differed from the AD dataset in both imaging modality (SPECT vs. PET) and uptake conditions (continuous performance test vs. rest), which could contribute to the differences in classifier performance. We suspect modality is not a factor as the feature scores used in classification are modality neutral. Lower resolution imaging systems may contribute to lower true-positive rates if the regions of interest are small in size, despite the model's attempt to mitigate this effect using filter sizes of differing spatial scales. Regardless of how well the filtering method does, if the discriminating feature of a disease is too small to be accurately measured by the imaging device, performance of the classification system will undoubtedly suffer. The benefit of this method is that it r Functional Brain Imaging in Monitoring Brain Disorders r r 13 r uses information across spatial scales, orientations, and locations in the volumes to calculate the matching scores used for subsequent classification and should therefore be less reliant on any one discriminating feature. The uptake task will contribute to the functional signals and should be taken into account when selecting the regions of interest to calculate feature scores (C1 Layer Training Patches). Choosing regions that are absolutely not affected by the disease will decrease the discriminative power of the method. Alternatively, if the number of subjects in the dataset is high and there is no fear of classifier overfitting, choosing many regions, some known to be related to the disease and/or task and others whose relationship is unknown could provide interesting insight into whether the unknown regions are contributing to classification accuracy. Further, because the features of the dataset are computed separately from the classifier, one could choose to sample some features from all brain regions and either perform regularization in the classifier or choose a classification model that is less sensitive to overfitting (e.g., support vector machines). Each of these decisions should be made relative to the particular dataset and illness being studied."}, {"section_title": "CONCLUSIONS", "text": "In general our volumetric variant of the hierarchical feed-forward model originally proposed by Serre et al. for detecting objects in photographs performed quite well on the functional brain imaging data sets used in this study. In fact, it outperformed both the comparison methods and the human counterpart at detecting AD in the FDG PET ADNI data set. The method is very general and does not rely on particular imaging modalities. It could be used on many spatial maps commonly computed in diagnostic and research imaging studies. Furthermore, there is evidence that it could be used to test hypotheses about regions implicated in disease. In conclusion, models designed in the computer vision community for object recognition and tracking in images of natural scenes may indeed have applications in detecting and tracking disease progression in human functional brain imaging with minimal modifications."}, {"section_title": "ACKNOWLEDGMENTS", "text": "Data collection and sharing for the NFL dataset used in this study was made available by Daniel Amen, M.D., and the Amen Clinics Inc. Industry partnerships are coordinated through the Foundation for the National Institutes of Health. The grantee organization is the Northern California Institute for Research and Education, and the study is coordinated by the Alzheimer's Disease Cooperative Study at the University of California, San Diego. ADNI data are disseminated by the Laboratory of Neuro-Imaging at the University of California, Los Angeles. The funders had no role in study design, data collection, and analysis, decision to publish, or preparation of the article."}]
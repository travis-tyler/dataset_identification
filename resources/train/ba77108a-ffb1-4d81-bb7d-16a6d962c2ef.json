[{"section_title": "Abstract", "text": "We present an extension of the Linear Mixed Effects (LME) modeling approach to be applied to the massunivariate analysis of longitudinal neuroimaging (LNI) data. The proposed method, called spatiotemporal LME or ST-LME, builds on the flexible LME framework and exploits the spatial structure in image data. We instantiated ST-LME for the analysis of cortical surface measurements (e.g. thickness) computed by FreeSurfer, a widely-used brain Magnetic Resonance Image (MRI) analysis software package. We validate the proposed ST-LME method and provide a quantitative and objective empirical comparison with two popular alternative methods, using two brain MRI datasets obtained from the Alzheimer's disease neuroimaging initiative (ADNI) and Open Access Series of Imaging Studies (OASIS). Our experiments revealed that ST-LME offers a dramatic gain in statistical power and repeatability of findings, while providing good control of the false positive rate.\n\u00a9 2013 Elsevier Inc. All rights reserved.\nIn a recent paper (Bernal-Rusiel et al., 2012) , we advocated the use of Linear Mixed Effects (LME) models (Fitzmaurice et al., 2011; Verbeke and Molenberghs, 2000) , a mature and versatile statistical framework, for the analysis of longitudinal neuroimage (LNI) data. As part of this prior manuscript, we implemented a toolkit of LMEbased methods suitable for analyzing univariate neuroimaging measures (e.g. hippocampal volume) and illustrated their utility on a well-studied longitudinal dataset from the Alzheimer's Disease Neuroimaging Initiative (ADNI). These freely available tools facilitate exploratory data visualization, model specification, model selection, parameter estimation, hypothesis testing, statistical power analysis, and sample size estimation. Our experiments confirmed our theoretical expectations and demonstrated that LME offers superior specificity and sensitivity over alternative methods, such as repeated measures ANOVA and the cross-subject analysis of longitudinal change measures (e.g. atrophy rate). These advantages are mainly due to the LME method's appropriate modeling of the covariance structure in serial measurements and its ability to handle unbalanced longitudinal data with missing data-points and imperfect timing.\nThe core goal of this follow-up manuscript is to extend the LME framework to handle spatial LNI data and enable an image-wide mass-univariate exploration of effects. The mass-univariate approach is a widely used, powerful methodology for the identification and characterization of regionally specific variation across the brain, which is due to clinical, experimental, or biological conditions of interest (Friston, 2007) . This approach is exploratory and complementary to hypothesis-driven univariate analyses of summary statistics from a priori, focused regions of interest (ROIs); or of brain-wide measures, such as total brain volume.\nDespite the tremendous growth in LNI studies over the last decade, e.g."}, {"section_title": "Introduction", "text": "In a recent paper (Bernal-Rusiel et al., 2012) , we advocated the use of Linear Mixed Effects (LME) models (Fitzmaurice et al., 2011; Verbeke and Molenberghs, 2000) , a mature and versatile statistical framework, for the analysis of longitudinal neuroimage (LNI) data. As part of this prior manuscript, we implemented a toolkit of LMEbased methods suitable for analyzing univariate neuroimaging measures (e.g. hippocampal volume) and illustrated their utility on a well-studied longitudinal dataset from the Alzheimer's Disease Neuroimaging Initiative (ADNI). These freely available tools facilitate exploratory data visualization, model specification, model selection, parameter estimation, hypothesis testing, statistical power analysis, and sample size estimation. Our experiments confirmed our theoretical expectations and demonstrated that LME offers superior specificity and sensitivity over alternative methods, such as repeated measures ANOVA and the cross-subject analysis of longitudinal change measures (e.g. atrophy rate). These advantages are mainly due to the LME method's appropriate modeling of the covariance structure in serial measurements and its ability to handle unbalanced longitudinal data with missing data-points and imperfect timing.\nThe core goal of this follow-up manuscript is to extend the LME framework to handle spatial LNI data and enable an image-wide mass-univariate exploration of effects. The mass-univariate approach is a widely used, powerful methodology for the identification and characterization of regionally specific variation across the brain, which is due to clinical, experimental, or biological conditions of interest (Friston, 2007) . This approach is exploratory and complementary to hypothesis-driven univariate analyses of summary statistics from a priori, focused regions of interest (ROIs); or of brain-wide measures, such as total brain volume.\nDespite the tremendous growth in LNI studies over the last decade, e.g. (Asami et al., 2011; Blockx et al., 2011; Chetelat et al., 2005; Davatzikos and Resnick, 2002; Desikan et al., 2011; Draganski et al., 2004; Driscoll et al., 2011; Fjell et al., 2009; Fotenos et al., 2005; Fouquet et al., 2009; Frings et al., 2011; Giedd et al., 1999; Hedman et al., 2011; Ho et al., 2003; Holland et al., 2009 Holland et al., , 2011 Hua et al., 2009 Hua et al., , 2010 Jack et al., 2008 Jack et al., , 2009 Josephs et al., 2008; Kaladjian et al., 2009; Kalkers et al., 2002; Ment et al., 2009; Misra et al., 2009; Pantelis et al., 2003; Paviour et al., 2006; Resnick et al., 2010; Sabuncu et al., 2011; Schuff et al., 2010; Schumann et al., 2010; Sidtis et al., 2010; Sluimer et al., 2008 Sluimer et al., , 2009 Sullivan et al., 2011; Thambisetty et al., 2010 Thambisetty et al., , 2011 Whitwell et al., 2007 Whitwell et al., , 2011 , most LNI studies have either focused on a small number of image measurements via univariate analyses and/or utilized methods that are suboptimal for detecting longitudinal effects (Bernal-Rusiel et al., 2012) . The reduction in statistical power due to suboptimal methodology is particularly detrimental when exploring brain-wide associations in a mass-univariate fashion. We believe the main reason behind the underutilization of more powerful methods is that the relevant statistical tools are not readily available in user-friendly image analysis software environments (such as SPM (Friston, 2007; SPM, n.d) , AFNI (Cox, 1996) , FSL , or FreeSurfer (Fischl, 2012) ) for the neuroimaging community to utilize. 2 In recent years, several studies have employed dedicated longitudinal models (e.g. LME models) for the voxel-level, mass-univariate analysis of LNI data, e.g. (Bowman and Kilts, 2003; Chetelat et al., 2005; Delaloye et al., 2011; Lau et al., 2008; Lerch et al., 2005; Li et al., 2013; Shaw et al., 2008; Shinohara et al., 2011; Skup et al., 2012; Zhang et al., 2009; Zipunnikov et al., 2011) . Many of the methods used in these studies suffer from at least one of the following two drawbacks, both of which will be addressed in the present manuscript. Firstly, model selection is commonly conducted for each voxel separately. This procedure is typically based on a statistical test, such as the likelihood ratio, and hence suffers from the multiple comparisons problem, which is usually not accounted for. Secondly, voxel-level models do not take advantage of the spatial structure in the data, since they model the covariance components separately at each and every voxel in the search volume. As a consequence, the estimators are less efficient and statistical power is reduced.\nIn the present paper, we examine a spatial extension of the LME framework for the mass-univariate analysis of longitudinal neuroimage data. To our knowledge, there are only two recently published statistical tools that are also suitable for performing the types of analyses we consider in this paper (Li et al., 2013; Skup et al., 2012) . The present paper proposes a different strategy, which might be more appropriate for longitudinal studies that are unbalanced. In the Discussion, we provide a theoretical comparison of the proposed approach with these alternative methods.\nSpatiotemporal statistical models have been already proposed for the analysis of time series data from functional neuroimaging studies. Friston et al. (2002a Friston et al. ( , 2002b Friston et al. ( , 2005 present the theory and applications for the hierarchical random effects models commonly used in the analysis of multi-subject fMRI data and discuss both classical and Bayesian inference perspectives. Other authors have adopted a fully Bayesian approach. Gossl et al. (2004) and Woolrich et al. (2004) model correlations between neighboring voxels within computationally expensive Bayesian frameworks. Guo et al. (2008) propose a Bayesian hierarchical (two-level) model for predicting post-treatment neural activity from individual's baseline functional neuroimaging scans. In more recent work, a similar Bayesian hierarchical model is extended to capture spatial correlations both between intra-regional voxels and between regions, where the regions of interest are obtained from an anatomical parcellation (Derado et al., 2012) . This model can also be seen as an extension of the hierarchical model proposed by .\nThe above models, though useful for the analysis of time series data, are not suitable for the analysis of LNI data for three main reasons. Firstly, different from functional time series, LNI data are typically highly unbalanced, i.e., the number of time-points and the timing of scans can vary substantially between subjects. Secondly, in LNI studies only a handful of longitudinal scans are usually available per subject, which prevents the application of hierarchical random effects models. Additionally, hierarchical models can force us to consider more complex covariance models than necessary, which, in turn, affect the precision of the parameters estimates and increase the required computation time. This is because every time-varying covariate necessary to accomplish a sufficiently complex model for the mean must be considered as a random effect and therefore included in the model for the covariance (Fitzmaurice et al., 2011) . Finally, certain modeling assumptions made for functional time series data are unrealistic for LNI data. For example, in the implementation of the Statistical Parametric Mapping software (SPM), all \"responsive\" voxels across the brain are assumed to share the same temporal correlation matrix (Friston et al., 2005) .\nIn this paper, we introduce a novel method for the mass-univariate analysis of LNI data based on a spatiotemporal linear mixed effects (ST-LME) modeling strategy. In the proposed approach, we take advantage of the mass-univariate setting, where the analysis is performed at an enormous number of spatial image locations (voxels or mesh vertices), and pool the temporal covariance structure across neighboring locations. In comparison with a voxel/vertex-wise LME approach (V-LME), the proposed strategy offers a significant improvement in the precision of parameter estimates and degrees of statistical freedom, which in turn yields a boost in statistical power. Our goal here is to provide the theoretical details and an empirical validation of the proposed computational tools for the mass-univariate statistical analysis of LNI data. These tools will be made freely available in FreeSurfer (http://surfer.nmr.mgh.harvard.edu/fswiki) (Dale et al., 1999; Fischl et al., 1999a; Fischl et al., 1999b) as a natural complement to its new longitudinal image-processing pipeline Reuter et al., 2010 Reuter et al., , 2012 . In our experiments, we analyzed longitudinal cortical thickness measurements obtained from the ADNI and OASIS (Marcus et al., 2007 (Marcus et al., , 2010 datasets to validate ST-LME and carry out an empirical comparison with voxel/vertex-wise methods, such as the V-LME and the widely used cross-subject analysis of longitudinal change measurements."}, {"section_title": "Material and methods", "text": "Voxel/vertex-wise linear mixed effects (V-LME) models One basic approach for the mass-univariate analysis of LNI data is to apply the linear mixed effects (LME) model at each spatial location (voxel or mesh vertex) independently. We will call this approach, which has been used in prior studies, (e.g. Bowman and Kilts, 2003; Chetelat et al., 2005; Delaloye et al., 2011; Lau et al., 2008; Lerch et al., 2005; Shaw et al., 2008) , voxel-or vertex-wise LME (V-LME).\nThe LME approach offers a parsimonious strategy to jointly model the mean and covariance structure in longitudinal data (Fitzmaurice et al., 2011; Verbeke and Molenberghs, 2000) . The central idea in LME is to allow a subset of the regression parameters to vary randomly across subjects. Hence, the mean trajectory is modeled as a combination of population-level \"fixed\" effects and subject-specific \"random\" effects.\nLet Y i be the n i \u00d7 1 vector of serial univariate measurements for subject i, where n i is the subject-specific number of serial measurements; X i denote the n i \u00d7 p subject design matrix for the fixed effects, \u03b2 = (\u03b2 1 ,\u03b2 2 , \u2026,\u03b2 p )\nT denote a p \u00d7 1 vector of unknown fixed effects regression coefficients, Z i be the n i \u00d7 q, q \u2264 p design matrix for the random effects,\nT be a q \u00d7 1 vector of random effects and e i \u00bc e i1 ; e i2 ; \u2026; e in i \u00c0 \u00c1 T be a n i \u00d7 1 vector of independent and identically distributed measurement errors. The LME model can then be expressed as:\n2 A noteworthy exception is AFNI (Cox, 1996 Note Z i links the vector of random effects b i to Y i and its columns are a subset of the columns of X i . Then, the following usual distributional assumptions are made:\nwhere N(0,D) denotes a zero mean (q dimensional) multivariate Gaussian with covariance matrix D; I n i denotes the n i \u00d7 n i identity matrix; and b 1 , \u2026, b m , e 1 , \u2026, e m are independent with m being the number of subjects in the study. The components of b i reflect how the subset of regression parameters for the i th subject deviate from those of the population. The components of e i represent random sampling or measurement errors.\nThe LME model provides a parsimonious representation for the population mean:\nNote that, as in any other regression problem, the choice of independent variables needs to be made on a subject-matter basis. The contribution of time-varying variables will determine the mean temporal trajectory. One simple strategy is to assume the trajectory is linear, since longitudinal studies with a limited duration are likely to only be capable of exposing simple trends. Alternative models can be chosen based on domain specific knowledge and/or visual inspection of data.\nThe non-diagonal temporal covariance matrix between the serial measurements of the ith subject is,\nthe structure of which is determined by the choice of random effects (Bernal-Rusiel et al., 2012) . Finally, the joint distribution of the univariate serial measurements is:\nUnbiased estimates of the covariance componentsD and\u03c3 can be obtained by numerically maximizing the restricted log-likelihood function (Verbeke and Molenberghs, 2000) . Finally, hypothesis testing can be conducted based on the Satterthwaite-based approximation of a scaled F-statistic (Kenward and Roger, 1997) ."}, {"section_title": "Spatiotemporal linear mixed effects (ST-LME) models", "text": ""}, {"section_title": "Related prior work", "text": "Spatiotemporal models that pool the temporal covariance structure across spatial locations have been successfully used in the functional neuroimaging literature (Bowman, 2007; Bowman et al., 2008; Derado et al., 2012; Friston et al., 2005; Gossl et al., 2004; Guo et al., 2008; Woolrich et al., 2004) . In practice, it has been demonstrated that this approach can increase the precision of parameter estimates. However, in order to efficiently pool parameter estimates over many locations it is necessary to model the spatial covariance among those locations. For example, the SPM strategy (Friston et al., 2005) pools over \"responsive\" voxels (a responsive voxel is defined as surviving an F-test for any effect of interest at an uncorrected p-value threshold of 0.001). Here, responsive voxels can be scattered across the entire brain and their temporal covariance structure is simply assumed to be a scaled version of a global temporal covariance matrix. Furthermore, inter-voxel correlations are ignored, i.e., assumed to be zero. This model is not suitable for LNI data mainly for two reasons. Firstly, the temporal covariance structure of longitudinal measurements is likely to be quite different between distant regions of the brain, reflecting the fact that different brain regions are affected at different stages in various disease processes. Secondly, inter-voxel correlations are likely to be quite high between proximal points, since structural change is rarely punctate, but rather affects an entire structure or region of the cortex.\nAn interesting alternative strategy was developed in (Bowman, 2007) , where a spatiotemporal model is used to estimate temporal and spatial correlations inside a given region of interest (ROI). The spatial covariance structure is captured through a parametric matrix that explicitly models the dependency between the error terms associated with each voxel as a function of the distance between the voxels. Inspired by this approach, we developed the following spatiotemporal LME (ST-LME) modeling strategy for LNI data.\nThe ST-LME model Our basic assumption is that the temporal covariance structure of the LME model is shared across points (voxels or mesh vertices) within a homogenous region of interest (ROI). Furthermore, there is a simple parametric covariance structure that models the spatial dependency between points. With these assumptions, there are two questions to consider:\n\u2022 How to divide up the image into homogenous regions 4 ? \u2022 How to model the spatial dependency?\nFirst, let us address the second question and assume we are given a parcellation of the image into homogeneous regions. Henceforth, we will focus on a single one of these regions and each one of these regions will be modeled separately.\nLet g denote the region we are considering and v g be the number of voxels or vertices in this region. Let Y ig denote the (n i v g ) \u00d7 1 vector of measurements for region g in subject i, where n i is the subject-specific number of serial measurements. Y ig is composed of stacking up length\nwhere Y igv is the vector of n i serial measurements at the v th voxel of region g in subject i. We model the covariance of Y ig as\nwhere \u2297 denotes the Kronecker tensor product, (2)) is the region-and subject-specific LME temporal covariance matrix, and G g is a v g \u00d7 v g matrix that models the spatial correlation structure. One particular example for G g that we found was empirically useful is:\nwhere a g , b g \u2265 0 are unknown model parameters, and d jk \u2265 0 represents the value of some distance metric (for example Euclidean or surface-based geodesic distance) between voxels (vertices) j and k in region g. In the Supplementary material, we provide a comparison 4 By homogeneous, we mean the covariance structure of subject-level serial measurements within each region can be considered to have a similar temporal component and a relatively smooth spatial component. We note that we are not assuming that the effect of interest is homogeneous within each region. As we discuss below the effect of interest is not used to obtain the segmentation, thus we avoid the issue of \"double-dipping.\" I.e., the proposed two-step strategy (segmentation + model fitting/hypothesis testing) is not coupled in a way that would bias the statistical results.\nof alternative spatial correlation matrices suggested by (Bowman, 2007) . Note that the \"Gaussian\" and \"exponential\" models of Bowman (2007) correspond to special cases of Eq. (4) with a g = 0 and b g = 0, respectively. Our results indicate the model of Eq. (4) provides a good fit to structural MRI-derived measurements such as cortical thickness (as reflected in lower AIC values) and offers good control for type 1 errors.\nHence the joint distribution of the serial measurements within region g is:\nwhere X ig \u00bc I v g \u2297X i , I v g denotes the v g \u00d7 v g identity matrix, and the p \u00d7 1 vectors of fixed effects for each location j = 1, \u2026, v g , \u03b2 gj , are\nWe use restricted maximum likelihood (REML) to estimate the model parameters associated with region g, i.e., D g , \u03c3 g , a g , and b g by maximizing:\nwhere\u03b2 g is the generalized least squares estimator;\ny ig is the realization of the random vector Y ig and\u0174 ig is the REML estimate of W ig , which is a function ofD g ,\u03c3 g ,\u00e2 g andb g . Note that we are estimating a parsimonious model for the spatiotemporal covariance inside homogeneous regions as opposed to the voxel-or vertex-wise approach that would require separate estimatesD gj and\u03c3 gj , j = 1, \u2026, v g , for every voxel/vertex in the region. In addition, the spatiotemporal model accounts for spatial correlations in the data that are neglected by the voxel-wise approach. In the Supplementary material, we give the formulae for the derivatives and expected information matrix that can be used in a Fisher's scoring algorithm to estimate the model parameters based on maximizing Eq. (5). Finally, a Satterthwaite-based approximation can be used to compute p-values for the null hypothesis at each voxel/vertex using the estimates of the temporal parametersD g ,\u03c3 g ,\u03b2 gj , j = 1, \u2026, v g (Kenward and Roger, 1997) . This approach utilizes an appropriate strategy to compute the precision (or equivalently the covariance,"}, {"section_title": "Cov KR\u03b2 gj", "text": ") of the parameter estimates in the small sample setting.\nSince the spatiotemporal model pools over locations in estimating the model parameters, in practice, we expect the precision of these estimates to be much higher than an approach that does not utilize the spatial structure of the image. As our experiments demonstrate, this increase in the precision of estimates and the increase in the statistic's degrees of freedom translate into a boost in statistical power. We emphasize that in the ST-LME approach, we conduct a separate hypothesis test at each vertex (see Supplementary material for details). Hence the number of conducted tests and the multiple comparisons correction is exactly the same as a vertex-wise analysis, such as V-LME."}, {"section_title": "Segmenting the image into localized homogeneous regions", "text": "Above, we assumed that we were given a parcellation of the image into homogeneous (in terms of the spatiotemporal covariance structure) regions. In each of these regions, we assumed that the temporal covariance structure is shared across voxels or vertices. Now, let's present an algorithm to automatically identify such a parcellation from the data. In doing so, we will assume we have approximate estimates of the temporal covariance components at each location across the brain. In the following section, we will describe an approach to obtain these approximate estimates, which are used as vertex-or voxel-wise attribute vectors for the segmentation.\nThe segmentation algorithm we propose to use is a data-driven, region-based method presented in Gonzales et al. (2002) . Let R denote the entire image domain (the entire set of voxels/vertices). Our goal is to partition R into r homogeneous regions, R 1 , R 2 , \u2026, R r , such that (note that r is not pre-determined)\nHere H(R i ) is a logical condition of homogeneity defined over the locations in R i , and \u2205 is the empty region.\nThe segmentation algorithm consists of two stages. In the first stage, the entire image R is recursively divided up into a large number of small homogeneous regions, until all the resultant regions R i satisfy H(R i ) =true. That is, at any state of the splitting process, if a generated region is not homogeneous it is further split into smaller sub-regions until all satisfy the homogeneity criteria. These sub-regions are then combined in the second stage using a region growing strategy, where neighboring regions are recursively fused if the resulting region is still homogeneous, i.e., H(R i ) = true, and until no two regions can be combined.\nIn our particular application we allow H(R i ) = true only when the following two criteria hold for region R i (k is a pre-defined parameter): i) More than 95% of the region vertices have an attribute entry that is less than k standard deviations away from the region mean. ii) The correlation among the ordinary least squares 5 (OLS) residuals within R i is greater than 0.5. This conservative threshold ensures that correlations among the residuals decay monotonically with distance inside region R i and therefore can be appropriately modeled by the spatial correlation model of Eq. (4) (see Supplementary material for a more detailed discussion).\nThe above homogeneity criteria aim to ensure the validity of the modeling assumptions of the subsequent spatiotemporal model within each region R i . The parameter k determines how similar the covariance components within a region should be to assume that their true values are the same. A relatively large k (e.g. k = 2.5) will yield larger regions, where the statistical precision of the parameter estimates will be high. Yet these estimates might be biased, which would in turn reduce the accuracy of the model. Setting k = 0 will reduce ST-LME to V-LME since each vertex will effectively be considered as a separate region. In the Supplementary material, we present a sensitivity analysis that reveals the effect of k on the statistical inference. In general, higher values of k translate to more statistical power; but this increase in efficiency comes at a cost of increased type I error. Based on our experiments we recommend setting k between 1 and 2 (our default setting is 2), since empirically we observe that with this setting we can control the type I error, while achieving high sensitivity.\nThe splitting step of the segmentation algorithm can be instantiated in many different ways. For example, in the case of Euclidean images a region can be recursively split into quadrants (Gonzales et al., 2002) .\nFor the surface-based analysis, we employed the spherical coordinate system that provides a convenient representation of each subject's individual surface. Here, for any given region (patch on the sphere) we computed the average 2D spherical coordinates (\u03c6,\u03d5) of its elements (i.e., the surface centroid) and classified any point within the region as being in one of four possible quadrants with respect to the centroid."}, {"section_title": "Initial estimates of vertex-wise covariance parameters", "text": "In the previous section, we described a procedure for obtaining a segmentation of the image into homogeneous regions with similar covariance component estimates. Here, we provide formulae for vertex-wise estimates of the covariance parameters. These are based on ordinary least squares (OLS) estimates for the mixed-effects model, and are given in Laird et al. (1987) .\nwhere q, p and n i are as defined in the Section Voxel/vertex-wise linear mixed effects (V-LME) models and M \u2212 indicates the left generalized inverse of matrix M. Here,D 0 should be assessed to ensure it is positive semi-definite. Finally, some fast expectation maximization iterations, as detailed in Laird et al. (1987) , can be optionally applied to the above approximations in order to obtain more accurate parameter estimates (so that they vary more smoothly over space and yield a parcellation with a smaller number of regions). Once again, we emphasize that the attributes used for the segmentation step do not depend on the hypothesis tests (or their corresponding contrast matrices) that would follow the parcellation step.\nOnce the parcellation step is complete, we average the parameter estimates within each region to be used as an initialization for the iterative REML procedure. We also initialized the spatial parameter a as 0.01 mm and b as 0.05 mm, which were further optimized in the REML procedure."}, {"section_title": "The data", "text": "In our experiments, we analyzed longitudinal brain MRI data (T1-weighted, 1.5 Tesla) from the Alzheimer Disease Neuroimaging Initiative (ADNI). We further utilized brain MRI data from the longitudinal OASIS database in our supplementary analyses for additional validation (see Supplementary material). All MRI scans were automatically processed with FreeSurfer (version 5.1.0, http://surfer.nmr. mgh.harvard.edu, including its new longitudinal processing pipeline (http://surfer.nmr.mgh.harvard.edu/fswiki/LongitudinalProcessing) Reuter et al., 2010 Reuter et al., , 2012 ).\nFreeSurfer's automatic processing steps include the computation of the subject's cortical surface and thickness measurements across the cortical mantle. These measurements are further spatially normalized to a standard atlas space, which can be sampled onto a common spherical mesh."}, {"section_title": "Longitudinal ADNI", "text": "There were four clinical groups in the longitudinal ADNI sample we analyzed. These were as follows: (1) stable healthy controls (HC), who were clinically healthy throughout the study (N = 210, 75.9 \u00b1 5 years, 48.1% female); (2) stable subjects with Mild Cognitive Impairment (sMCI), who were categorized as MCI at baseline and remained so throughout the study (N = 227, 74.8 \u00b1 7.7 years, 33.5% female); (3) converter MCIs (cMCI), who were suffering from MCI at baseline and progressed to dementia during follow-up (N = 166, 74.7 \u00b1 7.1 years, 38.6% female); and (4) AD patients, who were diagnosed with dementia of the Alzheimer type at baseline (N = 188, 75.2 \u00b1 7.5 years, 47.3% female). Table 1 provides a summary of the longitudinal characteristics of the analyzed sample.\nIn our ADNI experiments, we analyzed longitudinal cortical thickness data across the entire cortex, since AD has been shown to be strongly associated with widely distributed cortical thinning (Dickerson et al., 2009; Lerch et al., 2005) . Spatial cortical thickness maps were computed automatically by FreeSurfer for each subject time point, which were then transferred onto a common template via a nonlinear surface based registration procedure (Fischl and Dale, 2000; Fischl et al., 1999a Fischl et al., , 1999b . Finally, every thickness map was smoothed by applying an iterative nearest neighbor averaging procedure that approximates Gaussian kernel smoothing on the high resolution surface of FreeSurfer's fsaverage template subject (Han et al., 2006) . Note that the optimal extent (full-width at half max, or FWHM) of smoothing depends on the sample size, the effect size, the spatial extent of the effect and the type of multiple comparison correction (Bernal-Rusiel et al., 2010) . Based on our prior experience with these data, we decided to use FWHM = 15 mm for the experiments where we analyzed relatively small cohorts (e.g., 2 N = 20-50), and FWHM = 8 mm for the analysis of the entire ADNI dataset."}, {"section_title": "LME-based statistical analyses", "text": "Two important choices need to be made in the LME-based analysis of longitudinal data: the specification of time-varying independent variables that model the mean temporal trajectory, and the selection of (intercept and/or time-varying) independent variables that will determine the covariance structure. In the mass-univariate setting, these model specification/selection questions are particularly challenging Time from baseline (in years) is in mean \u00b1 standard deviation; Ranges are listed in square brackets.\ndue to the large number of tests that need to be conducted. In all our analyses, we employed a powerful two-stage adaptive False Discovery Rate (FDR) procedure to control for multiple comparisons at q = 0.05 (Benjamini et al., 2006) . Based on our previous analyses of the ADNI data (Bernal-Rusiel et al., 2012), we expected a clinical group-specific linear trajectory to be an appropriate model for Alzheimer-associated cortical thinning during the follow-up period. However, in order to account for any possible non-linearity we performed a model selection procedure starting with a model that was quadratic in time and included the following independent variables as fixed effects: (scan) time (from baseline), time squared, clinical group membership (HC was the reference group and there were indicator variables for all remaining groups. E.g., for the sMCI indicator, the value was one if the subject was clinically categorized as sMCI and zero otherwise), the interactions between clinical group indicators with time and with time squared, baseline age, sex, APOE genotype status (one if e4 carrier and zero if not), the interaction between APOE genotype status and time (note that this variable was included based on the evidence that e4 accelerates atrophy during the prodromal phases of AD (Jack et al., 2008) ), and education (in years). Random effects were then determined via a vertex-wise likelihood ratio test, where nested models were compared based on a chi-square mixture statistic (Bernal-Rusiel et al., 2012; Fitzmaurice et al., 2011) . After correcting for multiple comparisons, over 80% of the cortex vertices included both the intercept and time, and not time squared, as the optimal set of random effects. Hence, these two random effects were included in the final model for all remaining analyses and time squared (the quadratic term) was not included as a random effect. We then tested the null hypothesis of no group differences in the quadratic term (i.e., the coefficient of the \"time squared\" fixed effect) and no vertex exhibited a statistically significant association after multiple comparisons correction. Therefore, we dropped the quadratic term from the model. The final model was thus consistent with our prior results: a linear trajectory with two random effects: intercept and time (Bernal-Rusiel et al., 2012) .\nIn the ST-LME method, we applied five expectation maximization iterations to improve the initial vertex-wise estimates of covariance components that were used as features in the segmentation. We then used the spherical surface (called ?h.sphere in FreeSurfer) to segment the brain into homogeneous regions of similar covariance estimates, with the parameter value set to k = 2. This yielded about 12,000 regions per hemisphere (with a maximum region size of 83 vertices) from an approximate total of 149,000 vertices (see Supplementary Fig. S1 for a segmentation example). We used FreeSurfer's spherical surface to compute the distances in the spatial correlation matrix of Eq. (4).\nIn general, longitudinal studies are conducted to assess group differences between the trajectories of variables of interest. Therefore, we constrained our analyses to the association between the grouptime interaction (i.e., group-specific atrophy rate) and cortical thickness."}, {"section_title": "An alternative longitudinal analysis method", "text": "A popular method to analyze LNI data, e.g. (Fotenos et al., 2005; Fouquet et al., 2009; Frings et al., 2011; Hedman et al., 2011; Hua et al., 2009 Hua et al., , 2010 Jack et al., 2009; Josephs et al., 2008; Kalkers et al., 2002; Kasai et al., 2003; Martensson et al., 2012; Paviour et al., 2006; Rosas et al., 2011; Sabuncu et al., 2011; Sluimer et al., 2008; Wenger et al., 2011; Whitwell et al., 2007; Wilde et al., 2012) , employs subject-level summary measures (e.g. the annualized difference between two time-points, the slope of a regression line, or metrics from longitudinal deformation fields), which are computed from the sequence of repeated measures for each individual. Standard parametric or non-parametric statistical methods can then be utilized to perform a cross-subject analysis of these summary measures. From a theoretical standpoint, such an approach is usually not appropriate for unbalanced data, since summary measures will not be identically distributed (e.g., will have a variance that depends on the temporal sampling 6 ) violating a fundamental assumption made by standard statistical methods. Furthermore, as our experiments demonstrate, there can be a significant loss in statistical power due to ignoring the correlation among the repeated measures and omitting subjects with a single time-point."}, {"section_title": "Results", "text": "Comparing the ST-LME approach with two alternative methods\nIn our first experiment, our goal was to provide an objective comparison between three competing longitudinal mass-univariate analysis methods: the proposed ST-LME approach, the V-LME method and the cross-subject analysis of thickness change, i.e., rates of cortical thinning estimated at each spatial location (vertex) and for each individual. For the third method (X-Slope), we computed the thinning rate at each vertex of each subject as the slope of the line that fits the corresponding serial measurements best (in the least square sense), similar to Martensson et al. (2012) , Rosas et al. (2011) , Sabuncu et al. (2011 ), Wenger et al. (2011 ), and Wilde et al. (2012 . Hence subjects with only a single time-point were discarded from the analysis. The slope estimates were then submitted to a General Linear Model (GLM) based cross-subject analysis to assess the difference between groups. The independent variables in this GLM were the same as the \"fixed effect\" variables used in the LME-based analyses (i.e., the first two methods), with the exception of time, which was not entered into the GLM. We note that for the ST-LME analyses, the segmentation step was run on each sample independently. Thus the ST-LME results reflect the variability in the segmentation step as well. The surface FWHM used for smoothing the thickness data for this analysis was 15 mm. For computational efficiency, we ran the following analyses on the left hemisphere of fsaverage6, which is a lower resolution version of fsaverage (FreeSurfer's average template surface) and has about 35 k vertices.\nTo assess the statistical power offered by the three analysis methods, we used an empirical strategy inspired by (Thirion et al., 2007) , where we randomly drew subsets of HC and AD subjects from the entire sample and conducted group comparison analyses of thinning across the entire cortex on these subsets. The main reason we chose to focus on AD and HC subjects was the known significant and widespread difference in cortical thinning rates between these groups (Dickerson et al., 2009) , which are also revealed in the results presented in the next section. The dramatic extent of the group difference enabled us to explore the statistical power offered by an analysis method based on pseudo-independent subsamples of variable sizes (with N = 10, 15, 20 and 25 per group) randomly drawn from the entire ADNI sample.\nTo obtain each sample for the comparisons (with N subjects per group), we randomly selected two sets of independent AD + HC samples, (i.e., two independent samples of 2 N). There was no overlap between the two independent samples and each sample contained the same number of AD and HC subjects. We repeated this procedure 400 times to obtain 400 random pairs of independent AD + HC samples. In addition, for each of the 400 pairs of AD + HC samples we built a new sample of the same size by using only the corresponding HC subjects, yielding 400 HC + HC samples (Note that there was no overlap between the two HC groups). The HC + HC samples served to quantify the control for specificity under the null hypothesis, since on average one would not expect to observe a difference in cortical thinning rates between two arbitrary HC groups. The AD + HC samples, on the other hand, served to quantify statistical sensitivity and repeatability.\nFor each sample (whether AD + HC or HC + HC), we used the three aforementioned methods to compute significance maps for the two-group comparison of longitudinal cortical thinning. We used the two-stage adaptive FDR procedure with an array of q-values (Benjamini et al., 2006) to control for multiple comparisons. We emphasize that all three methods had to go under the same FDR correction procedure for the same number of tests. Note that although ST-LME fits a model in each segmentation region separately and the number of regions can vary across samples, the number of conducted statistical tests is equal to the number of vertices. For a detailed discussion of this issue, please refer to the Supplementary material.\nFirstly, we used the HC + HC samples to assess the family-wise error (FWE) rate. We computed the FWE rate at the sample-level as the fraction of instances (out of the 400) where the statistical method falsely \"detected\" a group difference at one or more vertices for a given FDR q-value. Note that under the null hypothesis, the FDR q-value is theoretically equal to the FWE p-value. Our results illustrate that all three methods provide very good control of type I error rate, with V-LME being the most conservative among the three (see Table 2 ).\nSecondly, we employed the AD + HC samples to quantify sensitivity and repeatability. We computed the statistical power (sensitivity) at the sample-level as the fraction of instances (out of the 400 \u00d7 2 = 800) where the statistical method detected some group difference at a given FDR q-value (see Fig. 1 ). We further computed the statistical power as a function of the sample size (2 N) for a fixed FDR q-value of 0.05 (see Fig. 2 ). Next, we assessed repeatability via the overlap area between the two independent AD + HC samples. Fig. 3 shows the means and standard errors across the 400 random draws over a range of FDR q-values. Fig. 4 quantifies repeatability as a function of sample size with fixed FDR q-value = 0.05. These results demonstrate that ST-LME offers superior sensitivity and repeatability over the benchmark methods considered here. However, we note that the difference between the statistical power offered by ST-LME and V-LME tends to decrease with increasing sample size and more liberal q-value thresholds.\nFinally, we conducted a sensitivity analysis of the ST-LME results to assess the effect of varying the segmentation parameter k. These results, presented in the Supplementary Material, reveal that the statistical power, repeatability and type I error control offered by ST-LME are influenced by the segmentation step, and in particular by the size Table 2 Empirical FWE rates for three longitudinal mass-univariate analysis methods. These FWE rates were computed at the sample-level based on CN + CN samples (2 N = 30), where no group differences were expected. X-Slope: vertex-wise cross-subject analysis of cortical thinning rates estimated by fitting a line to serial measurements; V-LME: vertex-wise application of the LME approach to longitudinal thickness data; ST-LME: the proposed spatiotemporal LME modeling method applied to longitudinal thickness data. , randomly drawn from the complete ADNI data (800 random sub-samples). Sensitivity is quantified as the fraction of instances, where the corresponding statistical method detected some group difference at a given FDR q-value. X-Slope: vertex-wise cross-subject analysis of cortical thinning rates estimated by fitting a line to serial measurements; V-LME: vertex-wise application of the LME approach to longitudinal thickness data; ST-LME: the proposed spatiotemporal LME modeling method applied to longitudinal thickness data. and number of the segmentation regions. In general, as k is increased, the segmentation step outputs larger regions, which in turn can boost statistical power. However, when these regions are too big (e.g., when k = 2.5) ST-LME becomes prone to type I errors, because the model's assumption that the temporal covariance structure is the same across the vertices in each region is likely to be violated. Thus, in general we recommend k to be set between 1 and 2."}, {"section_title": "Comparing rates of atrophy across four clinical groups", "text": "Now, we present the maps revealed by the ST-LME and X-Slope approaches for characterizing longitudinal thinning differences between four well-studied clinical groups (HC, stable MCI-sMCI-, converter MCI-cMCI-, and AD patients), using the entire ADNI dataset. The surface FWHM used for smoothing the thickness data for this analysis was 8 mm. In the Supplementary material, we provide supporting evidence for the validity of the assumptions in the ST-LME approach based on this analysis.\nFigs. 5 and 6 show the maps for comparing the rates of cortical thinning between HC and AD subjects obtained using the two methods: ST-LME and X-Slope. Figs. 7 and 8 show the same comparisons between sMCI and cMCI subjects. We make several important observations. First, the ST-LME maps of cortical thinning associated with clinical Alzheimer's and conversion from MCI to AD are in strong agreement with prior findings (Dickerson et al., 2009; Singh et al., 2006) . Second, ST-LME reveals a dramatically wider extent of significant cortical thinning compared to X-Slope for both the AD vs. HC and stable vs. converter MCI analyses. The difference is particularly striking for the MCI group analysis of Figs. 7 and 8, where X-Slope was barely able to detect any significant longitudinal difference between stable and converter MCI subjects. Finally, the sMCI vs. cMCI map obtained with ST-LME is remarkably similar to the AD vs. HC map obtained with X-Slope. This is likely pointing to a statistical power issue. The regions exhibiting a large difference of cortical thinning in AD (and thus are detectable by X-Slope) probably exhibit a relatively smaller effect in the MCI group as well, which apparently is detectable by a powerful method such as ST-LME, but not by X-Slope. The decreased effect size in the MCI group could be due to either a smaller difference in atrophy rates, which would be consistent with cortical thinning accelerating throughout this phase, or the clinical heterogeneity in the MCI population, or both.\nFinally, Supplementary Fig. S9 shows the cortical thinning group comparison maps obtained with V-LME. These maps are almost identical to those obtained with ST-LME, suggesting that the two LMEbased methods offer similar statistical power on the entire ADNI dataset, which contains over 750 subjects. This is in agreement with our previous results that indicated that the difference in the statistical power offered by V-LME and ST-LME decreases with increasing sample size."}, {"section_title": "Supplementary experiments on the OASIS dataset", "text": "In the Supplementary material, we provide further experiments that we conducted on the healthy subjects of the longitudinal OASIS dataset (Marcus et al., 2007 (Marcus et al., , 2010 . In these experiments, we focused on healthy aging. Thus, instead of conducting a case-control group difference analysis, our effect of interest was simply nonzero longitudinal thinning across the cortex. Our results from the OASIS supplementary experiments are in full agreement with the ADNI experiments, and hence help us generalize our conclusions about the statistical power, repeatability and type I error control offered by ST-LME to applications other than dementia.\nDiscussion LME models provide a powerful and flexible approach for analyzing longitudinal data, while elegantly handling variable missing rates and non-uniform timing, and making use of subjects with a single time-point in order to characterize population-level variation (Bernal-Rusiel et al., 2012; Fitzmaurice et al., 2011) . In this work, we extended the LME framework to exploit the spatial structure in neuroimage data and apply it to mass-univariate analysis. Our empirical results demonstrated that the proposed spatiotemporal LME (ST-LME) strategy offers significantly higher statistical power than a vertex-wise na\u00efve application of LME and an alternative benchmark method commonly used in prior LNI studies. This boost in statistical power is particularly dramatic for studies with relatively modest sample size.\nIn our first experiment, we conducted a direct comparison of the statistical performance afforded by the proposed ST-LME approach and two benchmark methods, namely the vertex-wise application of the LME strategy (V-LME) and a vertex-wise cross-subject analysis of within-subject slope estimates (X-Slope), using the longitudinal ADNI data, which consisted of healthy controls (HC), subjects with MCI, and AD patients. We employed FreeSurfer's tools to automatically compute thickness measurements across the entire cortical mantle of each subject, which were then normalized to a common template. By randomly sampling from the ADNI data, we created sub-groups of AD + HC (2 N = 20-50, 800 random samples, or 400 independent pairs of samples) and HC + HC (2 N = 20-50, 400 random samples) subjects.\nOur analysis based on HC + HC samples, where no group differences were expected, revealed that all three methods provided a conservative control of specificity -well within the bounds predicted by theory. Next, we assessed sensitivity and repeatability on AD + HC samples of varying size (N = 10-25) . This analysis exposed the dramatic gain in statistical power offered by the proposed ST-LME approach, especially when the sample size was modest. At a typical FDR q-value of 0.05 and with N = 15, ST-LME afforded an empirical true positive rate (quantified at the sample level) of 0.87, whereas V-LME and X-Slope's sensitivity were approximately 0.56 and 0.21, Fig. 6 . Cortical regions exhibiting a statistically significant difference in longitudinal thinning between HC and AD subjects (in red) on the entire ADNI sample. These maps were derived by thresholding the values shown in Fig. 5 with an FDR correction at q = 0.05. (A) ST-LME method and (B) X-Slope method. ST-LME reveals a much wider extent of significant thinning in AD.\nwhich represents a 55% and 314% gain, respectively. Our results further revealed that the difference in the statistical power offered by ST-LME and V-LME decreased as the sample size increased.\nAs expected, this increased sensitivity translated into a remarkable increase in the reliability of discoveries (see Figs. 3-4) . The average overlap area between the detected regions in two independent AD + HC samples of N = 15 at FDR q = 0.05 was 0 mm 2 for X-Slope, 236 mm 2 for V-LME and 1456 mm 2 for ST-LME. We emphasize that the ST-LME results were generated by running the segmentation step separately for each new sample. Thus, the reported empirical repeatability measures also reflect the variation in the segmentation step.\nWe further quantified the effect of the segmentation step by running the same ST-LME analyses for different settings of the segmentation parameter k. These supplementary experiments demonstrated that the proposed ST-LME method offers increased statistical power and repeatability over V-LME for the recommended range of k values between 1 and 2, while providing good control of type I error. In general with higher k values, the segmentation step produced larger regions, which improved efficiency but increased the type I error. Our experiments suggested that for a wide range of k values (k b= 2), the type I error was successfully controlled with the employed FDR procedure.\nIn our second set of experiments, we conducted mass-univariate analyses of cortical thinning on the entire ADNI data. Our results, which were in strong agreement with the literature, illustrated the use of the proposed ST-LME strategy in mapping disease-specific longitudinal thinning effects. They further highlighted the dramatic gain in statistical power offered by V-LME and ST-LME compared to X-Slope. The cortical thinning maps obtained by the LME methods revealed a substantially larger extent of cortical thinning associated with AD and MCI to AD conversion. There was little difference between the maps of V-LME (presented in the Supplementary material) and ST-LME, probably because the sample size of this experiment was relatively large and the study was well powered.\nFinally, we conducted additional experiments on a different dataset (OASIS), where the effect of interest was aging-associated atrophy and not dementia-related. Our results, in general, confirmed our ADNI observations: ST-LME offers a substantial boost in statistical efficiency, while maintaining good control of type I error rates.\nThe proposed ST-LME approach exploits the inherent spatial structure in neuroimaging data by treating subsets of locations as having the same temporal covariance structure, as suggested by (Friston et al., 2005) , and modeling the local spatial correlations in the data (Bowman, 2007) . To achieve this, the entire image is adaptively segmented into relatively small homogeneous regions of variable sizes and a region-wise spatiotemporal model is constructed via a Kronecker tensor product between a parametric spatial correlation matrix and the classical mixed effects temporal covariance matrix. This resulted in parsimonious yet effective models for the spatiotemporal covariances within homogeneous regions.\nTo our knowledge, there are only two other recently published methods that are focused on mass-univariate longitudinal image analysis (Li et al., 2013; Skup et al., 2012) . These methods utilize a marginal modeling approach (such as generalized estimating equations, GEE, and its variants), which provides a complementary strategy to the LME methods we employed in our own work. In contrast with the generalized linear model setting, in the linear model setting, LME and GEE-type methods can lead to very similar types of inferences (Fitzmaurice et al., 2011) , although there are subtle, yet important distinctions between the two approaches. The major advantages offered by the LME approach are that it enables the explicit modeling and analysis of within and across-subject sources of variability in the temporal covariance, can elegantly handle unbalanced data, and most importantly provides a valid inference strategy for the small-sample setting, which is common in neuroimaging studies. Crucially, inference in GEE-type methods relies on asymptotic distributions, which might not be appropriate for studies where N is small. We refer the reader to (Fitzmaurice et al., 2011) for a detailed discussion of this issue.\nWe plan to further investigate several open issues in the future. The segmentation algorithm we used in the present work might be sub-optimal and a better strategy would be to incorporate the spatial correlation model into the segmentation step. That said, our empirical results suggest that even with the employed sub-optimal segmentation step, the proposed ST-LME approach provides increased statistical efficiency. There are also alternative strategies we would like to examine for modeling/exploiting the spatial smoothness of image data. One such method is the recently proposed MARM framework (Li et al., 2011) , which has the advantage of being adaptive and multi-scale.\nThe random effects selection strategy we used in our work employed a likelihood ratio test based on a 50:50 mixture of chi-square distributions, as suggested in (Fitzmaurice et al., 2011) . There is a recent debate on whether this is an optimal strategy, or whether better approximate distributions exist, cf. Greven et al. (2008) . Future work will further examine this issue in more detail and consider alternative inference methods in the context of neuroimage analysis.\nOther directions we plan to explore include using surface-based distances between vertices to improve the accuracy of the spatial covariance parameterization and employing alternative multiple comparisons correction methods, for example those based on the topology of the statistical maps, which might provide a further statistical boost in examining longitudinal effects."}, {"section_title": "Conclusions", "text": "We presented a spatial extension of the linear mixed effects (LME) approach, which provides a powerful and flexible framework for the mass-univariate analysis of longitudinal neuroimage data. We have implemented and validated these tools for mapping longitudinal cortical thinning effects within the FreeSurfer framework. The proposed approach is general and can be adapted to the analysis of any type of longitudinal spatial data."}]
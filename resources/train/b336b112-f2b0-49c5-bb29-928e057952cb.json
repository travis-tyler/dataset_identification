[{"section_title": "Abstract", "text": "Abstract-This paper presents a framework to introduce spatial and anatomical priors in SVM for brain image analysis based on regularization operators. A notion of proximity based on prior anatomical knowledge between the image points is defined by a graph (e.g., brain connectivity graph) or a metric (e.g., Fisher metric on statistical manifolds). A regularization operator is then defined from the graph Laplacian, in the discrete case, or from the Laplace-Beltrami operator, in the continuous case. The regularization operator is then introduced into the SVM, which exponentially penalizes high-frequency components with respect to the graph or to the metric and thus constrains the classification function to be smooth with respect to the prior. It yields a new SVM optimization problem whose kernel is a heat kernel on graphs or on manifolds. We then present different types of priors and provide efficient computations of the Gram matrix. The proposed framework is finally applied to the classification of brain Magnetic Resonance (MR) images (based on Gray Matter (GM) concentration maps and cortical thickness measures) from 137 patients with Alzheimer's Disease (AD) and 162 elderly controls. The results demonstrate that the proposed classifier generates less-noisy and consequently more interpretable feature maps with high classification performances."}, {"section_title": "\u00c7", "text": ""}, {"section_title": "INTRODUCTION", "text": "R ECENTLY, there has been growing interest in Support Vector Machine (SVM) methods [1] , [2] , [3] , [4] for brain image analysis. Theses approaches allow one to capture complex multivariate relationships in the data and have been successfully applied to the individual classification of a variety of neurological and psychiatric conditions, such as Alzheimer's Disease (AD) [5] , [6] , [7] , [8] , [9] , [10] , fronto-temporal dementia [6] , [11] , autism [12] , schizophrenia [13] , and Parkinsonian syndromes [14] . In these approaches, with the exception of [15] , the specificity of neuroimaging data is taken into account in the feature extraction but not in the classification method per se. Brain images are indeed a prototypical case of structured data whose structure is governed by the underlying anatomical and functional organization.\nA lot of research has been carried out to take the structure of the data into account in SVM approaches. For example, graph and sequence kernels [16] have been proposed to classify corresponding structured data such as chemical compounds or DNA sequences [17] . On the other hand, efforts have also been made to introduce structured priors into classification of vectorial data. In the literature, three main ways have been considered in order to include priors in SVM. The first way to include prior is to directly design the kernel function [2] . Another way is to constrain the classifier function to be locally invariant to some transformations. This can be done 1) by directly engineering a kernel which leads to locally invariant SVM [18] , 2) by generating artificially transformed examples from the training set to create virtual support vectors (virtual SV) [19] , 3) by using a combination of both these approaches called kernel jittering [20] . The last way is to consider SVM from the regularization viewpoint [2] , [21] , [22] , [23] .\nIn the case of brain imaging data, defining a proper similarity measure between individuals is challenging, and the use of an irrelevant similarity would only plunge the data into a higher dimensional space. As for the locally invariant approach, it seems restricted to relatively basic transformations, which would not be adapted to anatomical knowledge. In this paper, we therefore adopt the regularization viewpoint and show that it allows modeling various types of priors.\nGraphs are a natural and flexible framework to take spatial information into consideration. Voxels of a brain image can be considered as nodes of a graph which models the voxels' proximity. A simple graph can be the voxel connectivity (6, 18, or 26) , allowing us to model the underlying image structure [24] . More sophisticated graphs can be introduced to model the specificities of brain images. Graphs can, for example, model relational anatomy by encoding the relations between brain structures [25] . They are also widely used to model brain connectivity, be it structural or functional [26] .\nIn this paper, we propose a framework to introduce spatial and anatomical priors into SVM using regularization operators defined from a graph [2] , [21] . The graph encodes the prior by modeling the proximity between image points. We also present an analogous framework for continuous data in which the graph is replaced with a Riemannian metric on a statistical manifold. A regularization operator can then be defined from the graph Laplacian or from the Laplace-Beltrami operator. By introducing this regularization operator into the SVM, the classification function is constrained to be smooth with respect to the prior. This exponentially penalizes high-frequency components with respect to the graph or to the metric. It yields a new SVM optimization problem whose kernel is a heat kernel on graphs or on manifolds. We then introduce different types of spatial and anatomical priors, and provide efficient implementations of the Gram matrix for the different cases. Note that the framework is applicable to both 3D image data (e.g., Gray Matter (GM) maps) and surface data (e.g., cortical thickness maps). We apply the proposed approach to the classification of MR brain images from patients with Alzheimer's disease and elderly controls. The present paper extends work previously published at conferences [27] , [28] . Compared to the conference papers, the present paper provides a comprehensive description of all different cases, new approaches for anatomical and combined regularization in the discrete case, experiments on simulated data, more thorough evaluation on real data, updated state of the art, and proofs of some important results.\nThe paper is organized as follows: In the next section, we briefly present SVM and regularization operators. We then show that the regularization operator framework provides a flexible approach to model different types of proximity (Section 3). Section 4 presents the first type of regularization, which models spatial proximity, i.e., two features are close if they are spatially close. We then present, in Section 5, a more complex type of constraints, called anatomical proximity. In the latter case, two features are considered close if they belong to the same brain network; for instance, two voxels are close if they belong to the same anatomical or functional region or if they are anatomically or functionally connected (based on fMRI networks or White Matter (WM) tracts). The two types of regularization, spatial and anatomical, are then combined in Section 6. Then, in Section 7, the proposed framework is applied to the analysis of MR images using gray matter concentration maps and cortical thickness measures from 137 patients with Alzheimer's disease and 162 elderly controls from the ADNI database (www.adni-info.org). A discussion of the methods and results is presented in Section 8."}, {"section_title": "PRIORS IN SVM", "text": "In this section, we first describe the neuroimaging data that we consider in this paper. Then, after some background on SVM and on how to add prior knowledge in SVM, we describe the framework of regularization operators."}, {"section_title": "Brain Imaging Data", "text": "In this contribution, we consider any feature computed either at each voxel of a 3D brain image or at any vertex of the cortical surface. Typically, for anatomical studies the features could be tissue concentration maps, such as gray matter or white matter, the 3D case, or cortical thickness maps for the surface case. The proposed methods are also applicable to functional or diffusion weighted MRI. We further assume that 3D images or cortical surfaces were spatially normalized to a common stereotaxic space (e.g., [29] , [30] ) as in many group studies or classification methods [7] , [8] , [10] , [13] , [31] , [32] .\nLet V be the domain of the 3D images or surfaces. v will denote an element of V (i.e., a voxel or a vertex). Thus, X \u00bc L 2 \u00f0V\u00de, the set of square integrable functions on V, together with the canonical dot product h\u00c1; \u00c1i X will be the input space.\nLet x s 2 X be the data of a given subject s. In the case of 3D images, x s can be considered in two different ways: 1) Since the images are discrete, x s can be considered as an element of IR d , where d denotes the number of voxels. 2) Nevertheless, as the brain is intrinsically a continuous object, we will also consider x s as a real-valued function defined on a compact subset of IR 3 or more generally on a 3D compact Riemannian manifold.\nSimilarly, in the surface case x s can be viewed either as an element of IR d , where d denotes the number of vertices or as a real-valued function on a 2D compact Riemannian manifold.\nWe consider a group of N subjects with their corresponding data \u00f0x s \u00de s2\u00bd1;N 2 X N . Each subject is associated with a group \u00f0y s \u00de s2\u00bd1;N 2 f\u00c01; 1g N (typically his diagnosis, i.e., diseased or healthy)."}, {"section_title": "Linear SVM", "text": "The linear SVM solves the following optimization problem [1] , [2] , [4] :\nwhere 2 IR \u00fe is the regularization parameter and ' hinge is the hinge loss function defined as\nWith a linear SVM, the feature space is the same as the input space. \nin the classifier function. However, this is not guaranteed with the standard linear SVM (as, for example, in [7] ) because the regularization term is not a spatial regularization. The aim of the present paper is to propose methods to ensure that w opt is spatially regularized."}, {"section_title": "Regularization Operators", "text": "Our aim is to introduce spatial regularization of the classifier function. This is done through the definition of a regularization operator P . Following [2] , [21] , P is defined as a linear map from a space U & X into X . When P is bijective and symmetric, the minimization problem\nis equivalent to a linear SVM on the data \u00f0P \u00c01 x s \u00de s :\nSimilarly, it can be seen as an SVM minimization problem on the raw data with kernel K defined by K\u00f0x 1 ; x 2 \u00de \u00bc hP \u00c01 x 1 ; P \u00c01 x 2 i X . One has to define the regularization operator P so as to obtain the suitable regularization for the problem."}, {"section_title": "LAPLACIAN REGULARIZATION", "text": "Spatial regularization requires the notion of proximity between elements of V. This can be done through the definition of a graph in the discrete case or a metric in the continuous case. In this section, we propose spatial regularization based on the Laplacian for both of these proximity models. This penalizes the high-frequency components with respect to the topology of V."}, {"section_title": "Graphs", "text": "When V is finite, weighted graphs are a natural framework to take spatial information into consideration. Voxels of a brain image can be considered as nodes of a graph which models the voxels' proximity. This graph can be the voxel connectivity (6, 18, or 26) or a more sophisticated graph.\nThe Laplacian matrix L of a graph is defined as L \u00bc D \u00c0 A, where A is the adjacency matrix and D is a diagonal matrix verifying [33] . Note that the graph Laplacian can be interpreted, in some cases, as a discrete representation of the LaplaceBeltrami operator (e.g., as in Section 4). We chose the following regularization operator:\nThe parameter controls the size of the regularization. The optimization problem then becomes\nSuch a regularization term exponentially penalizes the high-frequency components and thus forces the classifier to consider as similar voxels which are highly connected according to the graph adjacency matrix. Note that the eigenvectors of the graph Laplacian correspond to functions partitioning the graph into clusters. They can be considered as a soft min-cut partition of V [34] . As a result, such regularization operators strongly penalize the components of w which vary a lot over coherent clusters in the graph.\nAccording to the previous section, the new minimization problem (5) is equivalent to an SVM optimization problem. The new kernel K is given by\nThis is a heat or diffusion kernel on a graph. Diffusion kernels on graphs were also used by Kondor and Lafferty [35] to classify complex objects which are nodes of a graph defining the distance between them. Thus, in this approach the nodes of the graph are the objects to classify, which is different from our approach where the nodes are the features. Laplacian regularization was also used in satellite imaging [36] but, again, the nodes were the objects to classify. Our approach can also be considered as spectral regularization on the graph [37] ."}, {"section_title": "Compact Riemannian Manifolds", "text": "In this paper, when V is continuous, it can be considered as a 2D (e.g., surfaces) or a 3D (e.g., 3D euclidean or more complex) compact Riemannian manifold \u00f0M; g\u00de, possibly with boundaries. The metric, g, then models the notion of proximity required for the spatial regularization. Such spaces are complete Riemmanian manifolds; thus, on such spaces, the heat kernel exists [38] , [39] . Therefore, the Laplacian regularization presented in the previous paragraph can be extended to compact Riemannian manifolds [39] .\nUnlike the discrete case, for the continuous case, the regularization operator P is not defined on the whole space X but on a subset U & X. Therefore, we first need to define the domain U. In the following, let \u00c1 g denote the LaplaceBeltrami operator. 1 Let \u00f0e n \u00de n2IN be an orthonormal basis of X of eigenvectors of \u00c1 g (with homogeneous Dirichlet boundary conditions) [38] , [40] . Let \u00f0 n \u00de n2IN 2 IR \u00fe IN be the corresponding eigenvalues. We define U for > 0 as\nwhere ' 2 denotes the set of square-summable sequences. Similarly to the graphs, we chose the following regularization operator:\nThe optimization problem is also equivalent to an SVM optimization problem with kernel\nLaferty and Lebanon [39] proposed diffusion kernels to classify objects lying on a statistical manifold. Thus, in this approach, the points of the manifold are the objects to classify. On the contrary, in our case, the points of the manifold are the features.\nIn this section, we have shown that that the regularization operator framework provides a flexible approach to model different types of proximity. One has now to define the type of proximity one wants to enforce. In the following sections (Sections 4 and 5), we present different types of proximity models which correspond to different types of graphs or distances: spatial and anatomical. We then combine these two regularization types in Section 6."}, {"section_title": "SPATIAL PROXIMITY", "text": "In this section, we consider the case of regularization based on spatial proximity, i.e., two voxels (or vertices) are close if they are spatially close."}, {"section_title": "The 3D Case", "text": "When V are the image voxels (discrete case), the simplest option to encode the spatial proximity is to use the image connectivity (e.g., 6-connectivity) as a regularization graph. Similarly, when V is a compact subset of IR 3 (continuous case), the proximity is encoded by a euclidean distance. In both cases, the spatially regularized SVM will be obtained in practice by preprocessing the data with a Gaussian smoothing kernel with standard deviation \u00bc ffiffiffi p voxels [35] before using a standard linear SVM. Therefore, the computational complexity of the Gram matrix is O Nd log\u00f0d\u00de \u00f0 \u00de :"}, {"section_title": "The Surface Case", "text": "The connectivity graph is not directly applicable to surfaces. Indeed, the regularization would then strongly depend on the mesh used to discretize the surface. This shortcoming can be overcome by reweighing the graph with conformal weights. In this paper, we chose a different approach by adopting the continuous viewpoint:\nWe consider the cortical surface as a 2D Riemannian manifold and use the regularization operator defined by (8) . Indeed, the Laplace-Beltrami operator is an intrinsic operator and does not depend on the chosen surface parameterization. The heat kernel has already been used for cortical smoothing, for example, in [41] , [42] , and [43] . We will therefore not detail this part. In [41] and [42] , the Finite Difference Method (FDM) or the finite element method were used. We used the implementation described in [43] and freely available for download online. 2 It uses the parametrix expansion [44] at the first order. Similarly to the Gaussian case, the diffusion parameter sets the amount of smoothing 2 with the following relation:"}, {"section_title": "The computational complexity of the Gram matrix is in", "text": "O\u00f0Nd\u00de:"}, {"section_title": "ANATOMICAL PROXIMITY", "text": "In this section, we consider a different type of proximity, which we call anatomical proximity. Two voxels are considered close if they belong to the same brain network. For example, two voxels can be close if they belong to the same anatomical or functional region (defined for example by a probabilistic atlas). This can be seen as a \"short-range\" connectivity. Another example is that of \"long-range\" proximity, which models the fact that distant voxels can be anatomically (through white matter tracts) or functionally connected (based on fMRI networks).\nWe focus on the discrete case. The presented framework can be used either for 3D images or surfaces and computed very efficiently."}, {"section_title": "The Graph: Atlas and Connectivity", "text": "Let \u00f0A 1 ; . . . ; A R \u00de be the R Regions of Interest (ROI) of an atlas and p\u00f0v 2 A r \u00de the probability that voxel v belongs to region A r . Then the probability that two voxels, v \u00f01\u00de and v \u00f02\u00de , belong to the same region is:\nLet E 2 IR d\u00c2R be the right stochastic matrix defined by\nThen, for v \u00f0i\u00de 6 \u00bc v \u00f0j\u00de , the \u00f0i; j\u00deth entry of the adjacency matrix A \u00bc EE T is the probability that the voxels v \u00f0i\u00de and v \u00f0j\u00de belong to the same regions. For \"long-range\" connections (structural or functional), one can consider a positive semidefinite R-by-R matrix C with the \u00f0r 1 ; r 2 \u00deth entry being the probability that A r1 and A r 2 are connected. Then, the probability that the voxels v \u00f0i\u00de and v \u00f0j\u00de are connected is A i;j \u00bc P r 1 E i;r1 P r 2 C r1;r2 E j;r2 . Thus, the adjacency matrix becomes (Fig. 1) :\nTo compute the Gram matrix, one needs to calculate e \u00c0L , where L is the Laplacian matrix defined as L \u00bc D \u00c0 A. The matrices D and A do not commute, which prevents us from computing the matrix exponential by multiplying e \u00c0D and e A . We thus chose to use the normalized version of the LaplacianL:L\nThat is to say:L\nT . As mentioned in Section 3, the eigenvectors of the graph Laplacian correspond to a partition of the graph into clusters. Using the unnormalized or normalized Laplacian corresponds to different types of partition: With the unnormalized Laplacian, these clusters are a min-cut segmentation of the graph, whereas with the normalized Laplacian, they are a normalized cut segmentation [34] ."}, {"section_title": "Computing the Gram Matrix", "text": "\nEquivalence with the heat equation. Once the notion of proximity is defined, one has to compute the Gram matrix. The computation of the kernel matrix requires the computation of e \u00c0\u00c1g x s for all the subjects of the training set. The eigendecomposition of the Laplace-Beltrami operator is intractable since the number of voxels in a brain image is about 10 6 . Hence, e \u00c0\u00c1g x s is considered as the solution at time t \u00bc of the heat equation with the Dirichlet homogeneous boundary conditions of unknown u:\nThe Laplace-Beltrami operator is given by [38] \nwhere h is the inverse tensor of g. Solving the heat equation. In this paragraph, s is fixed. To solve (31) , one can use a variational approach [47] . We used the rectangular finite elements f \u00f0i\u00de g in space and the explicit finite difference scheme for the time discretization.\nx and t denote the space step and the time step, respectively. Let U\u00f0t\u00de denote the coordinates of u\u00f0t\u00de. Let U n denote the coordinates of u\u00f0t \u00bc n t \u00de and U 0 denote those of x s . This leads to\nwith K the stiffness matrix and M the mass matrix. The stiffness matrix K is given by \nThe mass matrix M is given by\nThe trapezoidal rule was used to approximate K and M; in particular: M i;j % ij det g\u00f0v \u00f0i\u00de \u00de. The explicit finite difference scheme is used for the time discretization, thus U n\u00fe1 is given by\nx is fixed by the MRI spatial resolution. t is then chosen so as to respect the Courant-Friedrichs-Lewy (CFL) condition, which can be written in this case as\nwhere i are the eigenvalues of the general eigenproblem: KU \u00bc MU. Therefore, the computational complexity is in\nTo compute the optimal time step t , we estimated the largest eigenvalue with the power iteration method [45] .\nFor our problem, for loc \u00bc 5, max % 15:4 and, for loc \u00bc 10, max % 46:5."}, {"section_title": "Formulation", "text": "General case. The matrix exponential can be computed by diagonalizing the normalized Laplacian. However, due to the images sizes, the direct diagonalization of the normalized graph Laplacian is computationally intractable. Nevertheless, in this case, it only comes to finding a basis of \u00f0ker\u1ebc\u1ebc T \u00de ? of eigenvectors ofL . This is detailed in the following paragraph. The matrix\u1ebc T\u1ebc is real symmetric. Let X be an R-by-R orthogonal matrix and \u00c3 an R-by-R diagonal matrix such as\nLet k be the rank of\u1ebc T\u1ebc . Without loss of generality, we assumed that the sole nonzero components of \u00c3 are its first k diagonal components \u00c3 1;1 ; . . . ; \u00c3 k;k . LetX be the d-by-k matrix defined as follows: The rth column ofX,X r , is given byX\nwhere X r denotes the rth column of X. Let\u00c3 be the k-by-k diagonal matrix defined b\u1ef9\nNote that \u00f0X r \u00de r\u00bc1;...;k is an orthonormal eigenbasis of \u00f0ker\u1ebc\u1ebc T \u00de ? and that \u00f0\u00c3 r;r \u00de r\u00bc1;...;k are the corresponding eigenvalues. Then, the matrix exponential is given by\nSpecial case of a binary atlas. When the atlas used to define the region is binary, in other words, when p\u00f0v 2 A r \u00de 2 f0; 1g, the formulation of the matrix exponential can be more explicit than (17) . Thus, the role of the regularization becomes more interpretable. Besides, it also leads to a much more efficient computation of the Gram matrix. \nNote that, in the case \u00bc 0, this is equivalent to the standard linear SVM with no anatomical regularization. In the limit case \u00bc \u00fe1, this is equivalent to replacing each voxel with the average of its atlas region, such as in [31] . The cases 2 IR \u00fe\u00c3 are intermediate cases."}, {"section_title": "Computational Complexity", "text": "The computation of the Gram matrix requires only: 1) the computation of D\n, which is done efficiently since D is a diagonal matrix, 2) the diagonalization of an R-by-R matrix, which is also efficient since R $ 10 2 . The number of operations needed to compute the Gram matrix is in\nIn the special case of a binary atlas, assuming that R < d, the computational complexity drops to O\u00f0Nd\u00de."}, {"section_title": "Setting the Diffusion Parameter", "text": "The proposed regularization exponentially penalizes the high-frequency components of the graph. More specifically, each component is weighted by e \u00c0 , where is the corresponding eigenvalue. In the previously described approach, the eigenvalues are known. Hence, the range of the diffusion parameter can be chosen according to the range of eigenvalues . The specific range that we used in our experiments is given in Section 7.5.1.\nThe method described in this section can be directly applied to both 3D images and cortical surfaces. Unfortunately, the efficient implementation was obtained at the cost of the spatial proximity. The next section presents a combination of both anatomical and spatial proximity.\nWe chose the same values for as in the spatial-only case (4.1). For the metric tensor to be comparable with the spatial-only case, we normalized g with"}, {"section_title": "COMBINING SPATIAL AND ANATOMICAL PROXIMITIES", "text": "In the previous sections, we have seen how to define regularization based on spatial proximity or on anatomical proximity. In this section, we propose to combine both those proximities: first from a discrete viewpoint and then from a continuous viewpoint in which the data lies on a Riemannian manifold."}, {"section_title": "On Graphs", "text": ""}, {"section_title": "The Optimization Problem", "text": "One of the simplest options to combine the spatial and anatomical proximities would be to add up the two regularization terms. In the following, when the notation could be confusing subscripts will be added to distinguish the spatial case ( s ) from the anatomical case ( a ). For instance, L s will refer to the Laplacian of the graph encoding spatial proximity. Similarly, L a will refer to the Laplacian of the graph encoding the anatomical proximity. As a result, a way of combining both regularization terms is to consider the following optimization problem:\nNote that the regularization parameters () of the spatial regularization and of the anatomical regularization could have differed. We have chosen them to be equal to avoid tuning another parameter. The sum of definite positive matrices is a definite positive matrix. Then, according to Section 2.3, (21) is an SVM optimization problem with kernel \nWhen the computational complexity of the spatial term is proportional to (for instance for the surface case), if s ! 1 2 a , using the following factorization leads to a better bound on the number of iterations:\nIn this case, the bound on the condition number drops to\nAs a result, according to [45] , the number of iterations needed to obtained a residual error is at most\nFor instance, if one considers the regularization with a binary atlas, the spectrum of L a verifies: Sp\u00f0L a \u00de \u00bc f1g. For\n\u00c04 , the number of iterations will not exceed 100 iterations. In practice, with our data the number of iterations did not exceed 43.\nSpecial case of Gaussian spatial regularization. Note that, in the 3D case, if the spatial proximity is encoded with the image connectivity (6-connectivity), then L s is diagonalizable by a symmetric orthogonal matrix Q which is the imaginary part of a submatrix of the Discrete Fourier Transform (DFT) matrix. Therefore, multiplying a vector by Q requires only O\u00f0d log\u00f0d\u00de\u00de operations using the Fast Sine Transform. Let S be the diagonal matrix such that: L s \u00bc QSQ. Then, according to (17) :\nUsing the Woodbury matrix identity [45] , the inverse matrix \u00f0e aLa \u00fe e sLs \u00de \u00c01 is equal to\nIn terms of computational complexity, the most costly steps are the computation of\u00c3 and the multiplication by D. Therefore, based on the complexity of the anatomical framework, ((5.2.2)), the computational complexity of the Gram matrix is O \u00f0N \u00fe R\u00ded log 2 \u00f0d\u00de \u00fe R 3 \u00c0 \u00c1 :"}, {"section_title": "Setting the Parameters s and a", "text": "The parameters s and a can be set using the previous two sections."}, {"section_title": "On Statistical Manifolds", "text": "Another way to combine spatial and anatomical information is to consider such a combination as a modification of the local topology induced by the spatial information with respect to some given anatomical priors. Since the brain is intrinsically a continuous object, it seems more interesting to describe local behaviors from the continuous viewpoint. So, in this section we proposed a single continuous framework to naturally integrate various prior information such as tissue information, atlas information, and spatial proximity. We first show that this can be done by considering the images or surfaces as elements of a statistical manifold together with the Fisher metric. We then give some details about the computation of the Gram matrix."}, {"section_title": "Fisher Metric", "text": "Let v 2 IR 3 be some position in the image. The images are registered in a common space. Thus the true location is known up to the registration errors. Such spatial information can be modeled by a probability density function: x 2 IR 3 7 ! p loc \u00f0xjv\u00de. A simple example would be p loc \u00f0\u00c1jv\u00de $ N \u00f0v; 2 loc \u00de. It can be seen as a confidence index about the spatial location at voxel v.\nWe further assume that we are given an anatomical or a functional atlas A composed of R regions: fA r g r\u00bc1\u00c1\u00c1\u00c1R . Therefore, in each point v 2 V, we have a probability distribution p atlas \u00f0\u00c1jv\u00de 2 IR\nA which informs about the atlas region in v.\nAs a result, in each point v 2 IR 3 , we have some information about the spatial location and some anatomical information through the atlas. Such information can be modeled by a probability density function p\u00f0\u00c1jv\u00de 2 IR Therefore, we consider the parametric family of probability distributions\nIn other words, in this section, instead of considering the voxels as such, each voxel is described by a probability distribution informing us about the atlas regions to which the voxel could belong and the certainty about the spatial location. In the following, we further assume that p loc and p atlas are independent. Thus, p verifies p\u00f0\u00f0A r ; x\u00dejv\u00de \u00bc p atlas \u00f0A r jv\u00dep loc \u00f0xjv\u00de; 8\u00f0A r ; x\u00de 2 A \u00c2 IR 3 :\nIn the following, we assume that p is sufficiently smooth in v 2 V and that the Fisher information matrix is definite at each v 2 V. Then the parametric family of probability distributions M can be considered as a differential manifold [46] . A natural way to encode proximity on M is to use the Fisher metric since the Fisher information metric is invariant under reparameterization of the manifold. M with the Fisher metric is a Riemmanian manifold [46] . V is compact; therefore, M is a compact Riemannian manifold. For clarity, we present this framework only for 3D images, but it could be applied to cortical surfaces with minor changes. The metric tensor g is then given for all v 2 V by "}, {"section_title": "EXPERIMENTS AND RESULTS", "text": "Alzheimer's disease is the most frequent neurodegenerative dementia and a growing health problem. Many group studies using structural MR images based on volumetric measurements of regions of interest (e.g., [48] ), voxel-based morphometry (e.g., [48] , [49] ) or group comparison of cortical thickness (e.g., [50] , [51] ) have shown that brain atrophy in AD is spatially distributed over many brain regions. Recently, several approaches have been proposed to automatically classify patients with AD from anatomical MRI (e.g., [6] , [7] , [9] , [10] , [52] , [53] , [54] ). In this section, we first evaluate the proposed framework on simulated data. Then, it is applied to the analysis of MR images using gray matter concentration maps and cortical thickness measures from patients with Alzheimer's disease and elderly controls."}, {"section_title": "Simulated Data", "text": "To generate the simulated data, we constructed a template composed of two concentric circles (Fig. 2) , with multiplicative white noise. From this template, we then generated two groups of 100 subjects each as follows: For each subject of the first group, we added a simulated lesion in the inner circle with angular position defined randomly between \u00c05 and 10 degrees, and size between 1 and 4 degrees. For each subject of the second group, we added a simulated lesion in the outer circle with the same range of parameters. White noise was then added to all subjects.\nWe compared the classification performances of three different approaches: spatial regularization (with corresponding to an FWHM of 8 mm), combined spatial and anatomical regularization (same ), no spatial regularization (standard SVM). Classification accuracy was computed using Leave-One-Out Cross-Validation (LOOCV). This experiment was repeated 100 times (i.e., we generated 100 populations of 200 subjects).\nClassification performances for the three approaches are presented on Fig. 3 . The combined regularization approach was consistently more accurate than the spatial regularization, which was in turn more accurate than the standard SVM."}, {"section_title": "Real Data: Material", "text": "Data used in the preparation of this paper were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (adni.loni.ucla.edu). The ADNI was launched in 2003 by the National Institute on Aging (NIA), the National Institute of Biomedical Imaging and Bioengineering (NIBIB), the Food and Drug Administration (FDA), private pharmaceutical companies, and nonprofit organizations as a $60 million, 5-year public-private partnership. The primary goal of ADNI has been to test whether serial Magnetic Resonance Imaging (MRI), Positron Emission Tomography (PET), other biological markers, and the progression of Mild Cognitive Impairment (MCI) and early Alzheimer's disease. Determination of sensitive and specific markers of very early AD progression is intended to aid researchers and clinicians to develop new treatments and monitor their effectiveness, as well as lessen the time and cost of clinical trials. The Principal Investigator of this initiative is Michael W. Weiner, MD, VA Medical Center and University of California, San Francisco. ADNI is the result of efforts of many coinvestigators from a broad range of academic institutions and private corporations, and subjects have been recruited from over 50 sites across the US and Canada. The initial goal of ADNI was to recruit 800 adults, ages 55 to 90, to participate in the research-approximately 200 cognitively normal older individuals to be followed for 3 years, 400 people with MCI to be followed for 3 years, and 200 people with early AD to be followed for 2 years. For up-to-date information, see www.adni-info.org."}, {"section_title": "Participants", "text": "We used the same study population as in [10] . We selected all the cognitively normal subjects and AD patients used in our previous paper [10] . As a result, 299 subjects were selected: 162 cognitively normal elderly controls (CN) and 137 patients with AD. Demographic characteristics of the studied population are presented in Table 1 ."}, {"section_title": "MRI Acquisition", "text": "The MR scans are T1-weighted MR images. MRI acquisition had been done according to the ADNI acquisition protocol in [55] . For each subject, we used the MRI scan from the baseline visit when available and from the screening visit otherwise. We only used images acquired at 1.5 T. To enhance standardization across sites and platforms of images acquired in the ADNI study, preprocessed images that have undergone some postacquisition correction of certain image artifacts are available [55] ."}, {"section_title": "Features Extraction", "text": "Gray matter concentration maps. For the 3D image analyses, all T1-weighted MR images were segmented into gray matter, white matter, and Cerebrospinal Fluid (CSF) using the Statistical Parametric Mapping (SPM5), London, United Kingdom, unified segmentation routine [56] and spatially normalized using the DARTEL diffeomorphic registration algorithm [30] with the default parameters. The features are the GM probability maps in the MNI space. All maps were then modulated to ensure that the overall tissue amount remains constant.\nCortical thickness. Cortical thickness measures were performed with the FreeSurfer image analysis suite (Massachusetts General Hospital, Boston, Massachusetts), which is documented and freely available for download online (http://surfer.nmr.mgh.harvard.edu/). The technical details of this procedure are described in [57] and [58] ."}, {"section_title": "Classification Experiments", "text": "We performed the classification of MR images from AD and controls for each regularization type presented in the previous sections. We used both the GM concentration maps and cortical thickness measures. As a result we tested the following regularization types."}, {"section_title": "Spatial Regularization", "text": "We tested the spatial regularization (Section 4) for both the 3D and the surface case. In the following, they will be referred to as Voxel-Regul-Spatial and Thickness-RegulSpatial, respectively.\n"}, {"section_title": "Anatomical Regularization", "text": "For the anatomical regularization (Section 5), we used the Automatic Anatomical Labeling (AAL) binary atlas [59] for the 3D case. This atlas is composed of 116 regions of interest. This approach will be referred to as Voxel-Regul-Atlas in the following.\nAs for the surface case, we used the binary cortical atlas of Desikan et al. [60] . This atlas is composed of 68 gyralbased regions of interest. This approach will be referred to as Thickness-Regul-Atlas in the following.\nFig . 6 shows the OMH coefficients obtained with ThicknessRegul-Atlas. When no anatomical regularization has been added ( \u00bc 0), Thickness-Regul-Atlas corresponds to Thickness-Direct. The maps are then noisy and scattered (Fig. 6a) . When the amount of regularization is increased, voxels of the same region tend to be considered as similar by the classifier (Figs. 6b, 6c, and 6d) . Note how the anatomical coherence of the OMH varies with .\nThe regions in which atrophy increases the likelihood of being classified as AD are mainly: the hippocampus, the amygdala, the parahippocampal gyrus, the cingulum, the middle and inferior temporal gyri, and the superior and inferior frontal gyri. "}, {"section_title": "Combination of Spatial and Anatomical Regularization", "text": "As for the combination of the spatial and anatomical regularization described in Section 6, we tested both the graph-based (Section 6.1) and the manifold-based approaches (Section 6.2). The graph-based approaches, Voxel-Regul-CombineGraph and Thickness-Regul-CombineGraph, also used the AAL atlas and the atlas of Desikan et al. [60] for the surface case.\nWe then illustrate the regularization on a statistical manifold. The atlas information used was only the tissue types. We used gray matter, white matter, and cerebrospinal fluid templates. This approach will be referred to as Voxel-Regul-CombineFisher in the following."}, {"section_title": "No Regularization", "text": "To assess the impact of the regularization we also performed two classification experiments with no regularization: Voxel-Direct and Thickness-Direct.\nNamely, Voxel-Direct refers to an approach which consists of considering the voxels of the GM probability maps directly as features in the classification. Similarly, Thickness-Direct consists of considering cortical thickness values at every vertex directly as features in the classification with no other preprocessing step."}, {"section_title": "OMH Coefficient Maps", "text": "The classification function obtained with a linear SVM is the sign of the inner product of the features with w opt , a vector orthogonal to the optimal margin hyperplane (OMH) [1] , [2] . Therefore, if the absolute value of the ith component of w opt , jw opt i j, is small compared to the other components \u00f0jw opt j j\u00de j6 \u00bci , the ith feature will have a small influence on the classification. Conversely, if jw opt i j is relatively large, the ith feature will play an important role in the classifier. Thus, the optimal weights w opt allow us to evaluate the anatomical consistency of the classifier. In all experiments, the C parameter of the SVM was fixed to one (\nAs an illustration of the method, we present, for some of the experiments presented in Section 7.3, the maps associated to the OMH varying the regularization parameter . The optimal SVM weights w opt are shown in Figs. 4 and 6. For regions in warm colors, tissue atrophy increases the likelihood of classification into AD. For regions in cool colors, it is the opposite. Fig. 4a shows the w opt coefficients obtained with VoxelDirect. When no spatial or anatomical regularization has been carried out, the w opt maps are noisy and scattered. Figs. 4b and 4c show the results with spatial proximity for the 3D case, Voxel-Regul-Spatial. The w opt map becomes smoother and spatially consistent. However, it mixes tissues and does not respect the topology of the cortex. For instance, it mixes tissues of the temporal lobe with tissues of the frontal and parietal lobes (Figs. 5b and 5c )."}, {"section_title": "Combining Spatial and Anatomical Regularization", "text": "The results with both spatial proximity and tissue maps, Voxel-Regul-Fisher, are shown in Figs. 4d and 4e. The OMH is much more consistent with the brain anatomy. Compared to Voxel-Regul-Spatial, it respects the topology of the cortex more (Fig. 5) .\nThe main regions in which atrophy increases the likelihood of being classified as AD are very similar to those found with the anatomical prior: the medial temporal lobe (hippocampus, amygdala, parahippocampal gyrus), the inferior and middle temporal gyri, the posterior cingulate gyrus, and the posterior middle frontal gyrus.\nWe analyzed the stability of the obtained hyperplanes using bootstrap for the approach Voxel-Regul-Fisher. We drew 75 percent of each subject group to obtain a training set on which classification approaches were trained and the corresponding OMH estimated. The procedure was repeated 1,000 times and thus 1,000 corresponding OMH were obtained for each approach. We compared the standard SVM to the proposed regularization (with corresponding to FWHM of 4 mm and 8 mm). For each approach, we computed the average of the 1,000 OMH. To estimate the stability of the OMH, we computed the norm of the difference between any of the 1,000 normalized OMH and the average normalized OMH. The norm was significantly lower (Student t test, p < 0:001) with the proposed regularization (0.64 for 8 mm, 0.65 for 4 mm) than with the standard SVM (0.68). The spatially regularized approach thus resulted in more stable hyperplanes.\nThere are two different viewpoints to combine the spatial and anatomical regularization. The first one is to consider the different types of proximity as two separate concepts. The combination can thus be done by just adding the two different regularization terms up. This is appropriate when the anatomical proximity models \"long-range\" proximity or connectivity. This is less appropriate for local anatomical information such as the tissue types. Another way to combine spatial and anatomical information is to consider such a combination as a modification of the local topology induced by the spatial information with respect to some given anatomical priors. In the discrete case, local behaviors could have been encoded using histogram distances such as the 2 distance or the Kullback-Leibler divergence, which is in fact closely related to the Fisher metric (e.g., [39] ). In this paper, we chose to describe local behaviors from the continuous viewpoint.\nWe propose a single framework to naturally integrate various priors such as tissue information, atlas information, and spatial proximity. In this approach, instead of considering the voxels as such, each voxel is described by a probability distribution informing us about the atlas regions to which the voxel could belong, the tissue types, and some information about the spatial location. As for the spatial information, it can be seen as a confidence index about the spatial location at each voxel and could be adapted to a specific registration algorithm. The distance between two voxels is then given by the Fisher metric.\nThe first limitation of this approach is that, in its current formulation, this framework is not very appropriate for binary atlases for two reasons. The first reason is the smoothness assumptions on the probability family. The second reason is the discretization. The metric tensor is evaluated at each voxel. As a result, as the norm of the metric tensor is very large at the frontier between two regions, the diffusion process is therefore stopped on a twovoxel-wide band along the frontier, which is very wide compared to the brain structures or the cortical thickness. Upsampling the image to avoid this effect is not an option due to the image size. Another limitation is that the continuous framework does not allow modeling long-range connections. This is left for future work. "}, {"section_title": "Classification Performances", "text": ""}, {"section_title": "Evaluation", "text": "We assessed the classification accuracies of the different classifiers the same manner as in [10] and on the same images. As a result, in order to obtain unbiased estimates of the performances, the set of participants was randomly split into two groups of the same size: a training set and a testing set ( Table 1 ). The division process preserved the age and sex distribution. The training set was used to determine the optimal values of the hyperparameters of each method and to train the classifier. The testing set was then only used to evaluate the classification performances. The training and testing sets were identical for all methods, except for those four cases for which the cortical thickness pipeline failed. For the cortical thickness methods, as mentioned in [10] , four subjects were not successfully processed by the FreeSurfer pipeline. Those subjects could not be classified with the SVM and were therefore excluded from the training set. As for the testing set, since those subjects were neither misclassified nor correctly classified, they were considered as 50 percent misclassified.\nThe optimal parameter values were determined using a grid-search and leave-one-out cross validation on the training set. The grid search was performed over the ranges C \u00bc 10 \u00c05 ; 10 \u00c04:5 ; . . . ; 10 3 for the cost parameter of the C-SVM ( \u00bc For each approach, the optimized set of hyperparameters was then used to train the classifier using the training group; the performance of the resulting classifier was then evaluated on the testing set. In this way, we achieved unbiased estimates of the performances of each method."}, {"section_title": "Classification Results", "text": "The results of the classification experiments are summarized in Table 2 . The accuracies ranged between 87 and 91 percent for the 3D case. The highest accuracy was obtained with Voxel-Regul-CombineFisher and the lowest with Voxel-Regul-CombineGraph. With no regularization, the classification accuracy was 89 percent. As for the surface case, Thickness-Direct reached 83 percent accuracy. As for the spatially and anatomically regularized approaches, the obtained accuracies were 84 and 85 percent with Thickness-Regul-Spatial and ThicknessRegul-Atlas, respectively.\nOn the whole there were no statistically significant differences in terms of classification accuracies, even though classification performances were slightly improved by adding spatial and/or anatomical regularization in most cases."}, {"section_title": "Influence of", "text": "In this section, we further assess the influence of the parameter on the classification performances. The C parameter of the SVM was fixed to one. The accuracies functions of are reported in Fig. 7 . It mainly yielded hump-shaped curves. The spatial or anatomical regularization improved the classification. However, a too-large amount of regularization can lead to a decrease in the classification performances."}, {"section_title": "DISCUSSION", "text": "In this contribution, we proposed using regularization operators to add spatial and anatomical priors into SVM for brain image analysis. We show that this provides a flexible approach to model different types of proximity between the features. We proposed derivations for both 3D image features, such as tissue concentration maps, or surface characteristics, such as cortical thickness."}, {"section_title": "Different Proximity Models", "text": "We first considered the case of regularization based on spatial proximity, which results in spatially consistent OMH making their anatomical interpretation more meaningful. We then considered a different type of proximity model which allows modeling higher level knowledge, which we call anatomical proximity. In this model, two voxels are considered close if they belong to the same brain network. For example, two voxels can be close if they belong to the same anatomical region. This can be seen as a \"short-range\" connectivity. Another example is that of \"long-range\" proximity, which models the fact that distant voxels can be anatomically connected, through white matter tracts, or functionally connected, based on fMRI networks. This approach can be directly applied to both 3D images and cortical surfaces. Unfortunately, the efficient implementation was obtained at the cost of the spatial proximity. We thus propose to combine the anatomical and the spatial proximities. We consider two different types of formulations: a discrete viewpoint in which the proximity is encoded via a graph, and a continuous viewpoint in which the data lies on a Riemannian manifold."}]
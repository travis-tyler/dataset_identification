[{"section_title": "Abstract", "text": "Life-expectancy is a complex outcome driven by genetic, socio-demographic, environmental and geographic factors. Increasing socio-economic and health disparities in the United States are propagating the longevity-gap, making it a cause for concern. Earlier studies have probed individual factors but an integrated picture to reveal quantifiable actions has been missing. There is a growing concern about a further widening of healthcare inequality caused by Artificial Intelligence (AI) due to differential access to AI-driven services. Hence, it is imperative to explore and exploit the potential of AI for illuminating biases and enabling transparent policy decisions for positive social and health impact. In this work, we reveal actionable interventions for decreasing the longevity-gap in the United States by analyzing a County-level data resource containing healthcare, socio-economic, behavioral, education and demographic features. We learn an ensemble-averaged structure, draw inferences using the joint probability distribution and extend it to a Bayesian Decision Network for identifying policy actions. We draw quantitative estimates for the impact of diversity, preventive-care quality and stable-families within the unified framework of our decision network. Finally, we make this analysis and dashboard available as an interactive web-application for enabling users and policy-makers to validate our reported findings and to explore the impact of ones beyond reported in this work."}, {"section_title": "Introduction", "text": "Inequities in healthcare impose an estimated burden of $300 billion per year in the United States (LaVeist, Gaskin, and Richard 2011). Longevity-gap is a collective effect of inequities such as economic, racial, ethnic, gender and environmental that lead to a decrease in life-expectancy. While the effects of inequities on longevity have been a subject of study for social scientists for decades, the society is now presented with an opportunity (or a threat) for the use of Artificial Intelligence (AI) in addressing (or propagating) healthcare inequities. Most of the AI research in healthcare has focused on developing discriminative models for automated Copyright c 2019, Association for the Advancement of Artificial Intelligence (www.aaai.org). All rights reserved. diagnosis and predictions. Despite many promising applications, and the raised bar for demonstrating value in Clinical Trials (Abr\u00e0moff et al. 2018) , the opaque nature of many of these models has raised concerns about propagation of blind-spots resulting from human-biases (Cabitza, Rasoini, and Gensini 2017; AS and Smith 2018; Keane and Topol 2018) . In this study we demonstrate the use of expressive, interpretable and explainable AI for understanding healthcare inequities themselves and for learning actions that may help mitigate these in the United States. We learn the complex interplay of factors that influence life-expectancy and quantify the impact of social, demographic and healthcare variables through a data-driven Bayesian Decision Network. We do this by learning a joint probabilistic graphical model (PGM) upon a county-level dataset and extending it to a decision framework for revealing policy actions. The key motivation for this study was to create a unified model that integrates geographical, socio-economic, behavioral, demographic and healthcare indices at county-level resolution in order to discover the skeleton and key drivers of the longevity-gap. Since graphical models are intuitive and interpretable, we enhance the utility of our model with an interactive webapplication available to users for exploring and discovering further insights from our model."}, {"section_title": "Determinants of the Longevity-gap", "text": "While access to medical care is the most tangible factor for improving longevity, the latter is determined by a more nuanced interplay of social, behavioral, and economic factors. Unavailability of fine-grained, integrated datasets has been a major factor responsible for the lack of models for measuring the joint impact of these factors on health-inequality. Hence, various theories and models have assessed these factors in isolation. The Health Inequity Project, (Chetty et al. 2016 ) compiled and released granular data at the County, Commute Zone, Core Based Statistical Area and State levels, and demonstrated the longevity gap attributable to income disparity in the United States. Income data from 1.4 billion Tax Records were combined with County-level Mortality (Census), Healthcare (Dartmouth Atlas, Small Area Insurance Estimates) Health-behaviors (CDC Behavioral Risk Factor Surveillance System, BRFSS), and Education (National Center for Education Statistics Common Core of Data & Integrated Postsecondary Education Data System) for the period covering 1999-2014, thus generating the most fine-grained data resource on socio-demographic determinants of longevity so far. Standard statistical analysis revealed significant correlations with longevity, however a bigger picture integrating the heterogeneous data into a single model has been lacking. Next, we review the formulation of problem as Bayesian structure-learning, inference, and decision networks, which we used in this study as a unified model to draw estimates and policy for addressing the longevity-gap. The problem was set up as a data-driven Bayesian decision network learning for discrete policy decisions and inferences."}, {"section_title": "Bayesian Decision Networks", "text": "We first establish the notational conventions before giving the definitions of Bayesian Networks (BNs) and Bayesian Decision Networks (BDNs). We will use v to represent a node and V to represent a set of nodes. The parent nodes of v are represented as pa(v)."}, {"section_title": "Bayesian Network", "text": "A Bayesian Network (Pearl 1985 ) is a triple, N = {X, G, P } defined over a set of random variables, X, consisting of a directed acyclic graph (DAG), G, together with the conditional probability distribution P . The DAG, G = (V, E) is made up of vertices V = {v 1 , v 2 , ..., v n } and directed edges E V \u00d7 V specifying the assumptions of conditional independence between random variables according to the d-separation criterion (Geiger, Verma, and Pearl 1990) . The set of conditional probability distributions, P , contains P (x v |x pa(v) ) for each random variable x v \u2208 X. Since a Bayesian Network encodes the conditional independencies based on the d-separation criterion, it provides a compact representation for the data. The joint-probability distribution over a set of variables, can be factored as the product of probabilities of each node v conditioned upon its parents."}, {"section_title": "Structure-learning", "text": "The structure of a Bayesian Network represents conditional independencies and can be specified either by an expert or can be learned from data. In data-driven structure-learning, the goal is to identify a model representing the underlying joint distribution of the data, P . For simplification, we assume the faithfulness criterion, that is, the underlying joint probability distribution P can be represented as a DAG. Structure-learning of the DAG can then be carried out with one of the three classes of algorithms: constraint-based, score based or hybrid algorithms. Since constraint-based methods rely on individual tests of independence, they are known to suffer from the problem of being sensitive to individual failures (Koller and Friedman 2009) . Score based methods view the structure learning as a model-selection problem and are implemented as search and score-based strategy. These are computationally more expensive because of the super-exponential space of models, however recent theoretical developments have made these tractable (Koller and Friedman 2009) . In this study, hill-climbing search was used along with the Bayesian Information Criterion (BIC) scoring function. The scoring function is a measure of goodness of each Bayesian Network N = {X, G, P }, for representing the data, D. The BIC scoring function takes the form\nwhere N is the sample size of the data, D, and l(\u03b8 G : D) is the likelihood fit to the data. We chose the BIC scoring function as it penalizes complex models over sparse ones and is a good trade-off between likelihood and the model complexity, thus reducing over-fitting.\nThe hill-climbing search algorithm is a local strategy wherein each step, the next candidate neighboring structure of the current candidate is selected based on the highest score and is described as follows. 1. Initialize the structure G. "}, {"section_title": "Inference", "text": "The next task is to parametrize the learned structure by computing posterior marginal distribution of an unobserved variable x vj \u2208 X given an evidence e = {e 1 , e 2 , ..e m } on a set of variables X(e). The prior marginal distribution P (x vj ) can be computed as\nUsing (1) in (3), we get\nFurther evidence e can be incorporated as\nFor each x vj / \u2208 X(e), where E x is the evidence function for x \u2208 X(e) and v i is the node representing x vi . The likelihood is then defined as,\nthat is, the likelihood function of x vj given e. Application of Bayes rule and using (4) and (6), then yields\nwhere the proportionality constant P (e) can be computed from P (X, e) by summation over X and P (x vj ) may be obtained by inference over empty set of evidence.\nThis parametrization of the learned structure with posterior marginal conditional probabilities allows to make Inference and the task is called inference-learning. Inference learning is an extremely useful step that allow us to estimate marginal probabilities after setting evidences in the network. Depending upon the size of the network, inference-learning can be carried out with exact, i.e. closed form or approximate i.e. based upon Monte Carlo simulation methods. The details of these can be found in standard texts (Koller and Friedman 2009) . In this work, we derived both exact estimates using the clique-tree algorithm and approximate estimates using rejection sampling to estimate conditional probabilities."}, {"section_title": "Bayesian Decision Network", "text": "A Bayesian Network can be extended to a decision network (BDN) with the addition of utility nodes U (Koller and Friedman 2009) . A BDN extends a BN in the sense that a BN is a probabilistic network for belief update, where as a BDN is a probabilistic network for decision making under uncertainty. Formally defined, a BDN is a quadruple BDN: N = {X, G, P, U } and has three types of nodes\n\u2022 Chance nodes ( X C ) : Nodes which represent events not controlled by the decision maker.\n\u2022 Decision nodes ( X D ) : Nodes which represent actions under direct control of the decision maker.\n\u2022 Utility nodes ( X U ) : Nodes which represent the decision maker's preference. These nodes cannot be parents of chance or decision nodes.\nA decision maker interested in choosing best possible actions can either specify a structure and marginal probability distributions or use the model learned with structure and inference learning. The decision maker then ascribes a utility functions to particular states of a node. The objective of decision analysis is then to identify the decision options that maximize the expected utility.\nThe expected utility for each decision option is computed and the one which has the maximum utility output is returned. The mathematical formulation for the same can be given as follows: Let A be the decision variable with options a 1 , a 2 ......a m and H is the hypothesis with states h 1 , h 2 , ........h n and \u03b5 is a set of observations in the form of evidence, then the utility of an outcome (a i , h j ) is given by U (a i , h j ) where U (.) is the utility function and the expected utility is given as:\nWhere P (.) is our belief in H given \u03b5 . We select the decision option a * which maximizes the expected utility such that:\nWe did not find any open source implementations that allowed a combination of data-driven structure learning with bootstraps, ensemble averaging and the extension of the learned structure to a decision network. Therefore, we wrote custom codes that allowed interfacing of the structure with available implementations that allow manual specification of a decision network (Dalton and Nutter 2018) . We verified the consistency of network specifications and automated creation of decision networks along with their probability distributions. In order to learn optimal policy, preferences (between -1 to +1) were defined for the states of the Utility node and 1000 iterations of Markov Chain Monte Carlo (MCMC) simulations were carried out to maximize utility after compilation to a JAGS (Just another Gibbs Sampler) model and obtaining an MCMC sample of the joint posterior distribution of the decision nodes (Dalton and Nutter 2018) . For example, for assessing the factors that could minimize the longevity-gap between Q4 and Q1 income quartiles, the maximum preference (+1) was assigned to the minimum longevity-gap level (see Fig. 2, 3 ). Decision nodes were specified on the basis of actionable interventions (e.g. quality of preventive care in the County). Gibbs sampling (Dalton and Nutter 2018) was used to estimate the best combination of actions (policy) that maximized the expected utility. Figure. 2 shows a part of the Decision network with setting of LE Q Disp M (difference in longevity between highest and lowest income quartiles in males), a derived variable defined by us."}, {"section_title": "Experiments Dataset", "text": "County-level data from The Health Inequality Project (Chetty et al. 2016), available from https://healthinequality.org/data/ were used in this study. County-level characteristics (Online Data  Table 12 ) were merged with county-level life expectancy estimates for men and women by income quartiles (Online Data Table 11 ). The merged table had data on 1559 counties and in addition to life-expectancy estimates, it included county-level features representing (1) Healthcare, such as quality of preventive care, acute care, percentage of population insured and Medicare reimbursements (2) Health behaviors, such as prevalence of smoking and exercise by income quartiles (3) Income and affluence of the area, such as median house-value and mean household income, (4) Socioeconomic features such as absolute upward mobility, percentage of children born to single-mothers and crime rate, (5) Education at the K-12 and post-secondary level, school expenditure per student, pupil-teacher ratios, test scores and income-adjusted dropout rates (6) Demographic features, such as population diversity, density, absolute counts, race, ethnicity, migration, urbanization (7) Inequality indices, such as Gini Index, Poverty rate, Income segregation, (8) Social cohesion indices, such as social capital index, fraction of religious adherents in the county, (9) Labor market conditions, such as unemployment rate, percentage change in population since 1980, percentage change in labor force since 1980 and fraction of employed persons involved in manufacturing and (10) Local Taxation. Since the motivation of our work was to address the factors associated with income disparity, additional variables derived by us included (1) Q1 -Q4 longevity-gap, i.e., the difference in life-expectancy between income quartiles Q4 and Q1 in both males and females, (2) Mean pooled life-expectancy estimates across the income quartiles Q1 through Q4 in both males and females and (3) Pooled Standard-deviation of life-expectancy estimates across the Q1 through Q4 income quartiles and (4) Proportion of income quartiles Q1-Q4 in both males and females relative to the total population of the County. Data were non-missing for most of the variables, wherever missing these were imputed with a non-parametric method for imputation in mixed-type data (Stekhoven and B\u00fchlmann 2012) implemented in R language for Statistical Computing (R Development Core Team 2011). Discretization of continuous variables was done using an in-house code written in R which used k-means, frequency-based, quantile and uniform-interval based methods (in that order of preference) for each variable. The number of discrete classes were fixed at three for the ease of interpretation of discrete policy decisions."}, {"section_title": "Structure-learning and Inference", "text": "Since the data were observational and not interventional, a learned-structure cannot be used for causal inference but only for probabilistic reasoning. However, we exploited the fact that certain variables such as State-policy are known to have a causal influence on healthcare inequities (Fisher et al. 2003a; Fisher et al. 2003b; Gottlieb et al. 2010; Murray et al. 2006; Braveman et al. 2010 ). Hence, in order to encode this effect in the structure of our model, we black-listed all incoming edges to State, County and Core Based Statistical Area (CBSA) prior to the start of structurelearning. The out-going edges from these nodes were allowed to be learned from the data by the structure learning algorithm. Structure learning using the hill-climbing search algorithm was done and the scoring function used was Bayesian Information Criterion (BIC). Since hill-climbing may lead to a local optima, we bootstrapped the dataset 1001 times, learned structures on the bootstrapped datasets and ensemble averaged the 1001 structures using a majority voting criterion R package bnlearn (Scutari 2010) to arrive at the final structure (Figure 1 ). The next step after structure learning was to conduct network-inference. Both Approximate Inference and Exact Inference (the gold-standard) were conducted using gRain (Jsgaard 2012 ) and bnlearn (Scutari 2010) libraries respectively. Since Approximate Inference may suffer from stochastic variations resulting from MCMC sampling, its stability was tested by repeating the procedure 25 times, confidence estimates were derived using the standard deviation of estimated posterior probabilities and the estimates were compared with Exact inference and confirmed to be identical."}, {"section_title": "Interactive web-application", "text": "We deployed the learned model as an interactive webapplication developed with shinydashboard package in R (Chang and Borges Ribeiro 2018). We mapped the inferences to state boundaries in the United States using the data of Global Administrative Areas (GADM) through the use of leaflet package (Cheng, Karambelkar, and Xie 2018) . The Shiny-dashboard application along with instructions to download and install are available at https://github. com/SAFE-ICU/Longevity_Gap_Action."}, {"section_title": "Results and Discussion", "text": "The bootstrapped-structure learned from data consists mostly of intuitive edges as it represents the ensembleaverage of 1001 structures. This is a trade-off between reliability and novelty, as some of these individual network structures may contain novel and unexpected edges which may have been lost on majority voting. However, we chose reliability over novelty in order to learn estimates with potential impact on policy and social interventions. Hence, with our model that encapsulates the joint probability distribution over the complex multivariate dataset, we asked the following questions:-(Q 1): What minimizes the longevity-gap between the lowest and the highest income quartiles in the Health Inequality Data? (A 1): Population diversity of the County. We created the variables LE Q Disp M and LE Q Disp F as the difference in life-expectancy between income quartiles Q4 and Q1 in males and females. These represent the longevitygap attributable to income-disparity in males and females. We observed that among all factors in the network, only cs born foreign, the proportion of foreign-born residents in the county was a parent-node of longevity-gap. Exact inference with setting evidence on different levels of diversity revealed that males in Counties with lowest diversity had a 41% probability of Q4 -Q1 longevity-gap > 9 years versus males living in Counties with high diversity which showed only 3% probability for Q4 -Q1 longevity-gap > 9 years. Even though our model is based upon observational data, the causal interpretation of the influence of diversity on longevity gap is reasonable because the opposite Figure 1 : Ensemble network learned upon The Health Inequality Data. The majority-voted structure from 1001 bootstrap structure-learning iterations used hill-climbing search along with Bayesian Information Criterion as the scoring function. Prior to learning the structures, all incoming edges into State, CBSA and County were black-listed in order to facilitate causalreasoning about State policies and their influence upon healthcare. The legend shows the network queries presented in this paper. For example, the solid-red ellipse shows the link between diversity and longevity gap thus motivating Q1, i.e., \"what minimizes longevity gap between the highest and the lowest income quartiles in this dataset\". direction would imply that foreign born individuals choose counties with lower longevity gap. This would be an unlikely scenario as income specific longevity gap has only been studied recently. The explanation of this influence is clear upon tracing the structure and exploring the learned inferences in our graphical model. Diversity is a child-node of median house value and a grand-child of proportion of high-earning females in the county. The learned inference illuminates that counties with higher diversity have a higher median house-value and proportion of high-earning females. Interestingly, Chetty et al observed that beyond a certain threshold, increasing income does not yield proportionate gains in longevity. Our model-inference is indicative of the same effect, thus highlighting the explainable and interpretable potential of our generative model. It is important to note that there might be more associations when explored through pair-wise correlations as is typically done in statistical explorations. However since a BN is a joint probabilistic model, it accounts for confounder, mediator and collider biases (Pearl 2011) in a transparent manner. Thus our model structure reveals that population diversity encapsulates all the factors that may be indirect influences upon longevitygap while capturing the complex interactions in the network and is able to provide quantitative estimates for these effects. (Q 2): What maximizes the mean life expectancy in males and females? (A 2): Preventive Care Quality. We observed that med prev qual z, the Index of Preventive Care, was the Figure 2 : Part of the Bayesian Decision Network learned from Health Inequality data. This is a part of the same network shown in Figure 1 , now embellished with a Utility defined upon LE Q Disp M (blue circle), and a Decision over its parent cs born foreign. Policy learning demonstrated that the longevity-gap is lower in counties with higher diversity.\nFigure 3: Exact inference for estimating the effect of diversity on the longevity-gap for males. Males in Counties with lowest diversity had a 41% probability of Q4 -Q1 longevitygap > 9 years versus males living in Counties with high diversity which showed only 3% probability for Q4 -Q1 longevity-gap > 9 years.\nonly parent-node of le mean pool F and a grand-parent of le mean pool M (variables derived by us from the Health Inequality Data). Estimates drawn through exact inference reveal that high quality Preventive Care med prev qual z improves the probability of living beyond 85 years of age by a staggering 43% in females and 30% in males. We inferred that an improvement in preventive-care quality was the most actionable factor (in females) because it was the only modifiable direct neighbor of mean life-expectancy in females. In males, preventive-care quality is a grand-parent and smoking (a first order neighbor) has a higher influence (see O 2 below), indicating gender specific influences. Apart from these two factors, there are no direct or near-neighbors of life expectancy in males and females in the joint probabilistic model. Preventive Quality Indices (PQI) provide a proxy for healthcare quality of the system outside the hospital setting and were compiled from the Dartmouth Atlas as a part of The Health Inequality Project. PQIs are based upon \"ambulatory care sensitive conditions\" (ACSCs) such as diabetes, i.e., conditions in which high-quality outpatient care or early interventions can prevent hospitalizations and complications. PQIs are used along with discharges for ASCS per thousand and the association between these was captured as a first-order relation between these variables in our graphical model. Therefore, improving PQIs is the most actionable step for increasing mean life-expectancy and for reducing economic burden due to hospitalizations as indicated by our model. (Q 3): Which preventive-care measure maximizes the probability of life-expectancy beyond 85 years? (A 3): Annual Lipid Testing in the diabetic population. We asked this question as a policy-learning question from the perspective of maximizing the availability of these tests during the preventive care visits. This was pertinent as Medicare reimbursements were found to be drastically different across the states (visualized as a heatmap on the web-application) which in-turn were linked to the quality of preventive care. The data included PQI indicators only for diabetes and mammography. We set a high preference on high longevity as the utility node and PQIs as decision nodes. The policy table learned from simulations (Table 1) indicates that the payoff was maximized by focusing on Annual Lipid Testing in the proportion of population that was diabetic. This comparison between actionable factors was empirically derived on the basis of the ranked payoffs. The rank at which the first flip from highest to lowest stratum occurred was considered indicative of the importance of the variable. In addition to the directed questions, the graphical decision model allowed us to make the following observations:-(O 1): Acute mortality and mean household-income. We observed that mean household income is a direct (and only) parent of 30-day hospital mortality index in our model. Areas with high mean household-income (greater than $45,000 p.a.) have a 30% less probability of having high 30-day Hospital Mortality Rate Index (greater than 0.92) as compared to areas with low mean household-income (less than $30,000 p.a.). Tracing the grand-children nodes of Hospital Mortality Rate Index, Pneumonia had the highest contribution to this effect among other available diseases including congestive heart failure and acute myocardial infarction.\n(O 2): Smoking and mean life-expectancy. As expected, smoking was negatively associated with life expectancy in our model. This was inferred from the structure showing currently smoking males in Q4 income quartile as a childnode of mean life expectancy in males. Being a child node should not be interpreted causally and in our probabilistic reasoning setup, the direction simply reveals that setting evidence upon life-expectancy is indicative of prevalence of smoking in the county, yet life-expectancy is a complex trait which cannot be explained by smoking alone. Setting the evidence of high life-expectancy in males (81.9 -85 years) makes it 33% more likely for smoking to be in the lowest stratum in the county (compared from counties with low lifeexpectancy).\n(O 3): Education, Exercise, Obesity and Longevity. We observed that graduate level education cs educ ba was a major distributor of probabilistic influence in the network and was linked to obesity, exercise, income and unemployment rates. This indicates that a significant part of the effect of exercise and obesity can be apportioned to education as the driver of healthy behaviors and higher income. Although these find- stratum is expected to maximize this objective. We inferred this empirically on the basis of the ranked payoffs. The rank at which the first flip from highest to lowest stratum occurred was considered indicative of the importance of the variable and it was seen that the lowest stratum was absent in this variable among the top 10 policy combinations ranked by payoffs ings are not surprising, our model reveals these in a transparent, unified manner and allows inference queries to estimate quantitative effects of these factors on health outcomes. For example, we estimated that areas with exercising populations, especially in Q1 income quartile, have a 19% lower probability of hospitalization rates in the highest band after correcting influences from other variables present in the data.\n(O 4): Poverty breeds poverty, links with racial factors and stability of families. In addition to health-inequities, our model illuminated the social disparities and their indirect role in propagating health inequity through income disparities. We observed that high income-segregation (Gini index) was a parent of and negatively associated with absolute upward mobility i.e. the upward mobility in percentage of children born to lower quartile income parents. This indicates that poverty was associated with lower inter-generational mobility, thus perpetuating the socio-economic disparities in the society which are well studied in the United States (Levy and Wilson 1989) . Our model also confirmed the univariate correlations between low social mobility being linked with lower family stability(40% lowered mobility) and higher Gini disparity (37% lowered mobility) as indicated by (Chetty et al. 2016) . The latter phenomenon referred to as assortative mating or the \"marriage-gap\" has been noticed to consistently increase in the recent years in the United States and is an under-appreciated factor in widening income and health disparities. Thus, our results indicate the social impact of deriving these estimates in a joint probabilistic setting and integrating information across complex interactions."}, {"section_title": "Conclusion", "text": "This study presents the overarching need and an AI solution to address healthcare inequities with Bayesian Decision Network learned from data. We provide quantitative estimates and potential policy decisions for mitigating health inequality in the United States by learning structural dependencies, inferences and policy decisions upon a county-level complex heterogeneous health dataset. We extend the transparency, interpretability and explainability of our model through the creation of a web-application that encapsulates our model inferences and visualizations for public users and policymakers. The application will allow users to not only validate our results but also to explore further insights into healthcare inequality and social impact that extends beyond the findings presented in this paper."}]
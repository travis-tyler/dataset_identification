[{"section_title": "Abstract", "text": "Abstract. We present a new Stata command, bmte (bias-minimizing treatment effects), which implements two new estimators proposed in Millimet and Tchernis (2012) designed to estimate the effect of treatment when there exists selection on unobserved variables and appropriate exclusion restrictions are unavailable. In addition, the bmte command estimates treatment effects from several alternative estimators that also do not rely on exclusion restrictions for identification of the causal effects of the treatment, including: 1) Heckman's two-step estimator (Heckman 1976 (Heckman , 1979; 2) a control function approach outlined in Heckman et al. (1999) and Navarro (2008) ; and 3) a more recent estimator proposed by Klein and Vella (2009) that exploits heteroskedasticity for identification. By implementing two new estimators alongside pre-existing estimators, the bmte command provides a picture of the average causal effects of the treatment across a variety of assumptions. We present an example application of the command following Millimet and Tchernis (2012) ."}, {"section_title": "Introduction", "text": "The causal effect of binary treatment on outcomes is a central component of empirical research in economics and many other disciplines. When individuals self-select into treatment, and when prospective randomization of the treatment and control groups is not feasible, researchers must adopt alternative empirical methods intended to control for the inherent self-selection. If individuals self-select on the basis of observed variables (selection on observed variables), there exist a variety of appropriate methodologies to estimate the causal effects of the treatment. If instead individuals self-select on the basis of unobserved variables (selection on unobserved variables), estimation of treatment effects is more difficult.\nWhen confronted with selection on unobserved variables, the most common empirical approach is to rely on an instrumental variable (IV); however, if credible instruments are unavailable, a small number of approaches now exist that attempt estimate the effects of the treatment without an exclusion restriction. This paper introduces a new Stata command, bmte, which implements two recent estimators proposed in Millimet and Tchernis (2012) designed to estimate treatment effects when there exists selection on unobserved variables and appropriate exclusion restrictions are unavailable:\n1. The minimum-biased (MB) estimator: This estimator implements a search for the observations among which the bias in the treatment effect estimate of interest is minimized. This is accomplished by trimming the estimation sample to include only observations with a propensity score within a certain interval as specified by the user. When the conditional independence assumption (CIA) holds (i.e., independence between treatment assignment and potential outcomes, conditional on observed variables), the MB estimator is unbiased. Otherwise, the MB estimator will tend to minimize the bias among estimators that rely on the CIA. Importantly, the MB estimator changes the parameter being estimated due to the restricted estimation sample.\n2. The bias-corrected (BC) estimator: This estimator relies on the two-step estimator of Heckman's bivariate normal (BVN) selection model in order to estimate the bias among estimators that inappropriately apply the CIA (Heckman 1976 (Heckman , 1979 . However, unlike the BVN estimator, the BC estimator does not require specification of the functional form for the outcome of interest in the final step. Moreover, unlike the MB estimator, the BC estimator does not change the parameter being estimated.\nIn addition, the bmte command summarizes results of several alternative estimators across a range of assumptions, including standard OLS and inverse probability weighted (IPW) treatment effects estimates. The bmte command also presents the results of additional estimates applicable when the CIA fails and valid exclusion restrictions are unavailable, including: 1) Heckman's BVN estimator; 2) a control function approach outlined in Heckman et al. (1999) and Navarro (2008) ; and 3) a more recent estimator proposed by Klein and Vella (2009) that exploits heteroskedasticity for identification. By implementing two new estimators alongside pre-existing estimators, the bmte command provides a picture of the average causal effects of the treatment across a variety of assumptions and when valid exclusion restrictions are unavailable."}, {"section_title": "Framework and Methodology", "text": "Here, we provide a brief background on the potential outcomes model and the estimators implemented by the bmte command. For additional discussion, see Millimet and Tchernis (2012) . We consider the standard potential outcomes framework, denoting by Y i (T ) the potential outcome of individual i under binary treatment T \u2208 T = {0, 1}. The causal effect of the treatment (T = 1) relative to the control (T = 0) is defined as the difference between the corresponding potential outcomes,\nIn the evaluation literature, several population parameters are of potential interest. The most commonly used include the average treatment effect (ATE), the ATE on the treated (ATT), and the ATE on the untreated (ATU), defined as:\n(1)\nThese parameters may also vary with a vector of covariates, X, in which case the parameters have an analagous representation conditional on a particular value of X. In the case of non-random treatment assignment, selection into treatment may follow one of two general paths: 1) selection on observed variables, also referred to as the CIA or unconfoundedness (Rubin 1974; Heckman and Robb 1985) ; and 2) selection on unobserved variables. Under the CIA, selection into treatment is random conditional on covariates, X, and the average effect of the treatment can be obtained by comparing outcomes of individuals in different treatment states with identical values of the covariates. This approach often employs propensity score methods to reduce the dimensionality problem arising when X is a high-dimensional vector (Rosenbaum and Rubin 1983) , with the propensity score denoted by P (X i ) = Pr(T i = 1|X i ).\nIf the CIA fails to hold, then estimated treatment effects relying on the CIA are biased. Following Heckman and Navarro-Lozano (2004) , denote by T * = h(X) \u2212 u the latent treatment variable, where T = 1 if T * > 0 and T = 0 otherwise, and denote by \u03b4 the difference in residuals of the potential outcomes Y (0) = g 0 (X) + \u03b5 0 and Y (1) = g 1 (X) + \u03b5 1 . The bias can then be derived as:\nwhere \u03c1 \u03b4u is the correlation between \u03b4 and u and \u03c3 \u03b4 is the standard deviation of \u03b4. When the CIA fails, consistent estimation of the treatment effect of interest requires an alternative technique robust to selection on unobervables. The difficulty in this case is that obtaining a consistent point estimate of a measure of the treatment effect typically requires an exclusion restriction, which is not available in many situations. The proposed bmte command presents a series of treatment effects estimators designed to to estimate the average effects of treatment when appropriate exclusion restrictions are unavailable, exploiting the functional form of the bias in (4). Below, we present briefly five of the estimators implemented by the bmte command."}, {"section_title": "The Minimum-Biased Estimator", "text": "This technique relates generally to the normalized inverse probability weighted (IPW) estimator of Hirano and Imbens (2001) , given b\u0177\nwhereP (X i ) is an estimate of the propensity score obtained using a probit model. Under the CIA, the IPW estimator in (5) provides an unbiased estimate of \u03c4 AT E . When this assumption fails, the bias for the ATE follows the closed functional form in (4), with similar expressions for the ATU and ATT. The MB estimator aims to minimize the bias by estimating (5) using only observations with a propensity score in a neighborhood around the bias-minimizing propensity score, denoted P * . The MB estimator of the ATE is formally given by\u03c4\nwhere \u2126 = {i|P (X i ) \u2208 C(P * )} and C(P ) denotes a neighborhood around P . Following Millimet and Tchernis (2012) , the MB estimator defines C(P * ) as C(P * ) = {P (X i )|P (X i ) \u2208 (P , P )}, where P = max{0.02, P * \u2212 \u03b1 \u03b8 }, P = min{0.98, P * + \u03b1 \u03b8 }, and \u03b1 \u03b8 > 0 is the smallest value such that at least \u03b8 percent of both the treatment and control groups are contained in \u2126. The MB estimator obtains \u2126 using Heckman's BVN selection model, the details of which are provided in Millimet and Tchernis (2012) . Specific values of \u03b8 are specified within the bmte command, with smaller values reducing the bias at the expense of higher variance. Note that the MB estimator trims observations with propensity scores above and below specific values, regardless of the value of \u03b8. These threshold values can be specified within the bmte command options. Note also that obtaining \u2126 does not require the use of Heckman's BVN selection model when the focus is on the ATT or ATU, since P * is known to be one-half in these cases (Black and Smith 2004) .\nIf the user is particularly sensitive to potential deviations from the normality assumptions underlying Heckman's BVN model, the MB estimator and other estimators can be extended appropriately (Millimet and Tchernis 2012) . Such adjustments are included as part of the bmte command, denoted by the Edgeworth expansion (EE) versions of the relevant estimators."}, {"section_title": "The Bias-Corrected Approach", "text": "Estimation of the error correlation structure using Heckman's BVN model immediately gives rise to the possibility of a bias-corrected version of each estimator. Specifically, estimates of the bias of the MB estimator of the ATE, denoted B AT E [P * ], can be derived from the two-stage BVN model. The estimated bias can then be applied as an adjustment to the standard IPW treatment effects estimate.\nThe minimum bias bias-corrected estimator, denoted MB-BC, for the ATE is then given by\u03c4\nwhere the corresponding estimators for the ATT and ATU follow. With heterogeneous treatment effects, the MB-BC estimator changes the parameter being estimated. In order to identify the correct parameter of interest, the bmte command first estimates the MB-BC estimator in (7) conditional on the propensity score, P (X), and then estimates the (unconditional) average treatment effect by taking the expectation of this over the distribution of X in the population (or sub-population of treated). The resulting bias-corrected (BC) estimator is given by\u03c4\nwhere again the corresponding estimators for the ATT and ATU follow."}, {"section_title": "BVN Selection", "text": "Briefly, Heckman's BVN selection model adopts a two-stage approach: 1) estimate the probability of treatment, \u03a6(X i\u03b3 ), using a standard probit model with binary treatment as the dependent variable; and 2) estimate via OLS the following second-stage outcome equation:\nwhere \u03c6(\u00b7)/\u03a6(\u00b7) is the inverse Mills' ratio, and \u03b7 is a well-behaved error term. With this approach, the estimated ATE is given b\u0177\nSimilar expressions are available for the ATU and ATT."}, {"section_title": "Control Function Approach", "text": "Heckman's BVN selection model is a special case of the control function (CF) approach. The idea is to devise a function such that treatment assignment is no longer correlated with the error term in the outcome equation upon its inclusion, as outlined nicely in Heckman et al. (1999) and Navarro (2008) . Specifically, consider the outcome equation\nApproximating E[\u03b5 t |X, T = t] with a polynomial in P (X) yields\nwhere S is the order of the polynomial. The following equation is then estimable via OLS\nAs is clear from (13), \u03b1 t and \u03c0 t0 are not separately identified; however, since the selection problem disappears in the tails of the propensity score, it follows that the control function becomes zero and the intercepts from the potential outcome equations are identified based on observations in the extreme end of the support of P (X). After estimating the intercept terms, the ATE and ATT are given b\u0177\nwhere"}, {"section_title": "Klein & Vella (2009) Estimator", "text": "Unlike the CF approach which relies on observations at the extreme of the support of P (X), the KV estimator attempts to identify the treatment effect utilizing more information from the middle of the support. Our implementation of the KV estimator relies on a similar functional form assumption to the BVN estimator in the absence of heteroskedasticity, but effectively induces a valid exclusion restriction in the presence of heteroskedasticity. Specifically, denote latent treatment by T * = X\u03b3 \u2212 u * , where u * = S(X)u and u \u223c N (0, 1). In this case, the probability of receiving the treatment conditional on X is given by\nAssuming S(X) = exp(X\u03b4), the parameters of (16) are estimable by maximum likelihood (ML), with the log-likelihood function given by\nand where the element of \u03b4 corresponding to the intercept is normalized to zero for identification. The ML estimates are then used to obtain the predicted probability of treatment, P (X), which may be used as an instrument for T in equation (9) excluding the selection correction terms.\n3 The bmte Command"}, {"section_title": "Syntax", "text": "The bmte command implements the above MB, BC, BVN, CF, and KV estimators as well as the traditional OLS and IPW estimators. The syntax for the bmte command is bmte depvar indepvars if in , group(varname) theta (#) psvars ( "}, {"section_title": "Specification and Options", "text": "The bmte command requires the user to specify an outcome variable, depvar, at least one independent variable, and a treatment assignment variable, group(). Additional independent variables are optional. The command also utilizes Stata commands hetprop and ivreg2. The remaining options of the bmte command are detailed below:\ntheta(#) denotes the smallest value such that \u03b8 percent of the treatment and control groups have propensity scores in the interval (P , P ) from equation (6). The user can specify multiple values for \u03b8 (e.g., theta(5 25)). Each value will form a different estimated treatment effect using the MB and MB-BC estimators.\npsvars(indepvars) denotes the list of regressors used in the estimation of the propensity score. If left unspecified, the list of regressors is assumed to be the same as the original covariate list.\nkv(indepvars) denotes the list of independent variables used to model the variance in the hetprob command in Stata. Like the psvars option, the list of kv regressors are assumed to be the same as the original covariate list if not explicitly specified.\nee specifies that Edgeworth-expansion versions of the relevant estimators also be provided.\nhetero allows for heterogeneous treatment effects, with ATE, ATT, and ATU estimates presented at the mean level of each independent variable.\ncf(#) specifies the order of the polynomial used in the CF estimator, with default order of 3.\npmin(#) and pmax(#) specify the minimum and maximum propensity scores, respectively, included in the MB estimator. Observations with propensity scores outside of this range will be automatically excluded from the MB estimates. The default values of pmin and pmax are 0.02 and 0.98, respectively.\nbs specifies that 95% confidence intervals be calculated by bootstrap using the percentile method based on the number of replications in reps(#). If reps is unspecified, the program defaults to 100 replications.\nfixp is an option for the bootstrap command that, when specified, estimates the bias-minimizing propensity score (P * (X)) and applies this estimate across all bootstrap replications, rather then re-estimating at each replication.\npsate(#) -psatuee(#) allow for the user to specify fixed propensity score values (specific to each treatment effect of interest) to be used as the biasminimizing propensity scores, in lieu of estimating the values within the program itself."}, {"section_title": "Example", "text": "Following Millimet and Tchernis (2012) , we provide an application of the bmte command to the study of the U.S. school breakfast program (SBP). Specifically, we seek causal estimates of the average treatment effects of SBP on child health. The data are from the Early Childhood Longitudinal Study -Kindergarten Class of 1998-99 (ECLS-K) and are available for download from the Journal of Applied Econometrics Data Archive.\n1 We provide estimates of the effect of SBP on growth rate in BMI from first grade to spring of third grade.\nWe first define global variable lists XVARS and HVARS and limit our analysis to third grade students only. XVARS are the covariates used in the OLS estimation as well as for the calculation of the propensity score. HVARS are the covariates used in the KV estimator (i.e., the variables that enter into the heteroskedasticity portion of the hetprob command).\n. global XVARS gender age white black hispanic city suburb /// > neast mwest south wicearly wicearlymiss momafb momafbmiss /// > momft mompt momnw momeda momedb momedc momedd momede ses /// > sesmiss bweight bweightmiss hfoodb hfoodbmiss books /// > booksmiss momafb2 ses2 bweight2 books2 age2 z1-z22 . global HVARS ses age south city Here, we focus on the general structure and theme of the output. For a thorough discussion and interpretation of the results, see Millimet and Tchernis (2012) . As indicated by the section headings, the output presents results for the ATE, ATT, and ATU using basic OLS and IPW treatment effects estimates, as well as each of the MB (equation 6), MB-BC (equation 7), BC (equation 8), BVN (equation 10), CF (equations 14 and 15), and KV (equations 16, 17, and 9) estimators. Below each estimate is the respective 95% confidence interval.\nAs discussed in the text, separate MB and MB-BC estimates are presented for each value of \u03b8 specified in the bmte command (in this case, 5% and 25%). The results for the CF estimator also include a joint test of significance of all covariates in the OLS step of the CF estimator (equation 13). Similarly, the KV results include a test for weak instruments (the Cragg-Donald Wald F-statistic and p-value) as well as a likelihood ratio test for heteroskedasticity based on the results of hetprob. Also included in the bmte output is the estimated bias-minimizing propensity score."}, {"section_title": "Remarks", "text": "Despite advances in the program evaluation literature, treatment effects estimators remain severely limited when the CIA fails and when valid exclusion restrictions are unavailable. Following the methodology presented in Millimet and Tchernis (2012) , we propose and describe a new Stata command (bmte) that provides a range of treatment effects estimates intended to estimate the average effects of the treatment when the CIA fails and appropriate exclusion restrictions are unavailable.\nImportantly, the bmte command provides results useful across a range of alternative assumptions. For example, if the CIA holds, the IPW estimator provided by the bmte command provides an unbiased estimate of the causal effects of treatment. The MB estimator then offers a robustness check given its comparable performance when the model is correctly specified or over-specified, but improved performance if the model is under-specified. If, however, the CIA does not hold, the bmte command provides results appropriate under strong functional form assumptions, either with homoskedastic (BVN or CF) or heteroskedastic (KV) errors, or less restrictive functional form assumptions (BC). As illustrated in our example application to U.S. school breakfast program, the breadth of estimators implemented with the bmte command provides a broad picture of the average causal effects of the treatment across a variety of assumptions."}]
[{"section_title": "Abstract", "text": "In order to fit an unseen surface using statistical shape model (SSM), a correspondence between the unseen surface and the model needs to be established, before the shape parameters can be estimated based on this correspondence. The correspondence and parameter estimation problem can be modeled probabilistically by a Gaussian mixture model (GMM), and solved by expectation-maximization iterative closest points (EM-ICP) algorithm. In this paper, we propose to exploit the linearity of the principal component analysis (PCA) based SSM, and estimate the parameters for the unseen shape surface under the EM-ICP framework. The symmetric data terms are devised to enforce the mutual consistency between the model reconstruction and the shape surface. The a priori shape information encoded in the SSM is also included as regularization. The estimation method is applied to the shape modeling of the hippocampus using a hippocampal SSM."}, {"section_title": "INTRODUCTION", "text": "Statistical shape models (SSM) are used to describe the shape of biological objects and their variation among the population. A lower dimensional subspace accounting for most of the variability in the observed samples is usually determined by a principal component analysis (PCA 1 ), which can be used as prior information to guide the deformation in tasks such as registration and segmentation. The model parameter of each shape components can also be used as anatomical descriptors of the object of interest for classification or regression. For instance, in the investigations into Alzheimer's disease (AD), it is of particular interest to study the atrophy of hippocampus, which is shown to be affected at an early stage of neurodeneration process. SSM has been applied to model the variability in the shape of hippocampal structure among the population. 2, 3 On the other hand, in order to segment the hippocampal structure from megnetic resonance (MR) images, method such as active shape model (ASM 4 ) uses the shape model to fit to the automatically detected image features or manually defined landmarks."}, {"section_title": "5", "text": "Using shape information, the elastic deformation of the model to match the intensity profile can be restricted to a prior shape subspace learned from the training set. 6 Knowledge of relative position and distance between anatomical structures, and texture descriptors have also been added to the ASM segmentation of hippocampus."}, {"section_title": "7", "text": "A shape-intensity joint prior model for both hippocampus and amygdala 8 has been developed with neighbor constraints and the level set formulation of shape.\n9 The aim of this paper is to develop a method that directs the shape model to fit the landmark data, such as shape surface meshes, using an Expectation-Maximization (EM) algorithm.\nFitting and estimating the parameters of an unseen shape requires a dense correspondence between the target shape and the SSM in order to register the model, and map the shape to the legitimate subspace modeled by the SSM. The estimation result and the quality of the model reconstruction thus depend upon the accuracy of the correspondence between shape surfaces. In point set registration problems, the popular ICP algorithm estimates the transformation by minimizing the distance between two point sets based on the nearest neighbor correspondence. This method is sensitive to incorrect correspondences, and outliers need to be rejected in order to avoid local minima. * Data used in preparation of this article were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (www.loni.ucla.edu/ADNI). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at: http://loni.ucla.edu/ADNI/Collaboration/ADNI_Authorship_list.pdf Instead of deterministic matching between two point sets, a Gaussian mixture model (GMM 10, 11 ) can be used to interpret the correspondence probabilistically as hidden random variables, and the maximum likelihood (ML) estimation of the transformation can be solved by EM algorithm.\n12 A symmetric formulation of the energy function has been proposed to achieve inverse consistency of the transformation.\n13 Previous work 14 using EM-ICP has been developed for SSMs to estimate the model parameters with latent correspondences probabilities, and to build the shape model.\nThe EM-ICP framework is extended here to the extrapolation of a given the PCA-based SSM to estimate the shape parameters for unseen data, and to improve the estimation by imposing symmetric consistency and regularization on the estimator. Since PCA provides a linear parameterization of the variation and non-rigid deformation in the shape space, the formulation of symmetric data terms for consistent estimation has a closed form least square solution. The deformation of the shape model under the guidance of shape components also reduces significantly the dimension of the linear system. The shape parameters are associated with a priori distribution due to the statistical nature of SSM, which facilitates the extension of ML estimator to maximum a posteriori (MAP) by adding a Tikhonov regularization term."}, {"section_title": "METHODS", "text": ""}, {"section_title": "Statistical shape models", "text": "We build the SSM upon the training set of surfaces with optimized correspondence of the n x landmarks. Incorrect correspondences may affect the generalizability and specificity of the shape model and give rise to false variations. The correspondence problem can be solved by optimization of an information theoretic objective function based on the minimum description length (MDL) of the shape model. 15 To facilitate the interpolation of the landmarks in reparameterization, the parameterization in spherical coordinate (\u03b8, \u03c6) can be re-mapped to the Cartesian system in R 2 , and the correspondence over the training set can be established by a groupwise optimization and fluid regularization on the shape image. 16 Once the correspondence is established, the surfaces can be aligned by using Procrustes analysis via rigid-body transformations to the size-and-shape space (Kendall's S\u03a3 \nwhere we use the superscript to denote the k-th landmark point on x i such that\nbe performed on the data matrix (x 1 , x 2 , \u00b7 \u00b7 \u00b7 , x ns ), and the shape data can be expressed as\nwherex is the mean of {x i }, W is the matrix consisting of the eigenvectors of the covariance matrix of the training data, and the elements in vector\nT are the parameters describing the i-th shape.\nFor a shape vector x / \u2208 {x i , i = 1, \u00b7 \u00b7 \u00b7 , n s } given explicit correspondence with and aligned to the meanx, the b descriptors can be calculated by least-square estimation\nFor a target y of n y points {y k \u2208 R 3 , k = 1, 2, \u00b7 \u00b7 \u00b7 , n y } without the assumption of correspondence or alignment between y and the modelx, the parameter estimation problem is to find the optimal transformation T = (T A , b), such that\nis the best representation of y, where T A is the affine part of transformation T restricted to a similarity transformation of 7 degrees of freedom ((R + \u00d7 SO(3)) R 3 ), the vector b describes the mode of model deformation (cf. eq. 2). Based on the correspondence found by ICP, the minimization problem can be solved by black-box optimizers. However, the assumption of ICP that the point in closest pair corresponds to each other does not hold when the geometry of y andx are related via a non-rigid deformation modeled by SSM."}, {"section_title": "Gaussian mixture model and EM algorithm", "text": "Gaussian mixture model for point set registration models the transformed points T (x) as samples from a mixture of Gaussian distribution with the mean at target points in y\nwhere A = (A jk ) is the binary matching matrix of which each entry A jk = 1 if point y k corresponds tox j on the model with a priori probability P (A jk = 1) = \u03c0 jk . By applying the Bayes' rule, the distribution density of the matching matrix A given the transformation T\ngives the conditional expectation\nViewing the correspondence matching matrix A as hidden variables, EM algorithm can be used to find the solution to the estimation problem. In implementation, isotropic Gaussian noise with covariance \u03c3 2 I is assumed\nwhere\nand the target point y k , with (Wb) j \u2208 R 3 indicating the displacement of the j-th model point given the parameter vector b. The prior distribution is set to be uniform\nThe EM algorithm estimates the hidden match A and the transformation T alternatively. In the Expectationstep (E-step), the algorithm estimates the expectation of the match matrix A based on the current estimate of T\nIn the Maximization-step (M-step), the transformation T is estimated by minimizing the energy\nNoting that A is row-stochastic, and consequently its conditional expectation also statisfies that k A * jk = 1, we can transform the estimation in the M-step into a least square problem\nwhere c j y \u2261 k A * jk y k is the correspondence of the model pointx j on the target surface y weighted by the conditional expectation of A. The optimization of T in the M-step can be divided further into: "}, {"section_title": "{E-step}", "text": ""}, {"section_title": "7:", "text": "A * \u2190 E(A|T ) (eq. 9)"}, {"section_title": "8:", "text": "{M-step}\nc y \u2190 A * y 10:\nUpdate T \u2190 (T A , b) 13: end while"}, {"section_title": "Estimation with symmetrical consistency and shape priors", "text": "The energy function (10) to be minimized in M.1 is asymmetric since it is the mean square distance from each point in T (x) to c y . Symmetrically, a mean square data term\ny to T (x) can be added to the energy, where B = (B kj ) is the row-stochastic match matrix, which is updated in the E-step\nThe formulation of SSM allows the shape priors based on the distribution of b parameters b m \u223c N (0, \u03bb m ), where \u03bb m is the m-th eigenvalue of the covariance matrix. To include a priori information of parameters, a Tikhonov regularization term is added to the energy function, which penalize the coefficients of the lesser components. Hence the cost function for symmetric consistent estimation with regularization\nwhere \u03b1 and \u03b2 control the amount of symmetric consistency and regularization. Fixing the affine part T A in T , and noting that all rows in A and B sum to 1, we can rewrite the cost function as\nwhere s is the scaling factor in T A , c k x \u2261 j B * kjx j , and \u039b is the diagonal matrix of eigenvalues {\u03bb i } in the PCA of the shape model. As opposed to B \u2208 R ny\u00d7nx , B \u2208 R 3ny\u00d73nx is left multiplied to Wb \u2208 R 3nx , which is modified from B *\nThe minimum is reached with the derivative \u2202E/\u2202b = 0, which is the solution to the linear system We can impose sparsity on B by restricting the search of correspondence in (12) within neighborhood of radius \u03c1."}, {"section_title": "EXPERIMENTAL RESULTS", "text": "In the experiments, we first built SSMs for hippocampus based on the semi-automated segmentations from the ADNI database. Then we tested the performance of the EM-ICP based model extrapolation method we proposed. We compared the performace of the symmetric and asymmetric estimation both with and without regularization. The reconstruction error and the accuracy of the parameter estimation are evaluated."}, {"section_title": "SSM parameter estimation", "text": "We used the SSM of left hippocampus built previously in the experiments of model extrapolation and parameter estimation. We evaluate the effect of the symmetric consistency and regularization on the performance of the estimation by measuring the accuracy of the estimated shape parameters b compared to the phantom ground truth, and the precision of the estimated shape surfaces. Two experiments were carried out, and in each of the experiments, we performed both the symmetric and asymmetric shape parameter estimation, with and without regularization.\nIn the first experiment, we aim to evaluate the accuracy of the estimated parameters by generating phantom samples from the SSM. The phantom shapes were generated by a random vector b in which each component b m \u223c N (0, \u03bb m ). Gaussian random noises (0.05 b ) were added to the coordinates of surface points, and regularized by smoothing with a windowed sinc function.\n18 These surfaces were further decimated, 19 reducing 60% to 80% of triangles, to create missing correspondences between the phantom and the SSM, and match the density of marching cube meshes produced from hippocampal segmentations. The error of the estimation b were measured by normalized mean squared error (MSE)\nwith respect to b as the ground truth.\nIn the second experiment, we evaluated the precision of the estimated shapes by testing our method to represent smoothed marching cube surfaces obtained from an unseen testing set of hippocampal volumes (20 controls and 20 AD from ADNI). We deformed the SSM to fit the surfaces and measure the root mean square (RMS) error and the Hausdorff distance between SSM-reconstructed surface and the testing surface."}, {"section_title": "Results and discussion", "text": "The results parameter estimation accuracy of first experiment are listed in Table. 1. The results of reconstruction precision in the second experiment are plotted listed in Figure 1 . One example of reconstruction is shown in Figure 2 with the effect of regularization shown in Figure 3 .\nThe formulation of shape parameter estimation as a least square problem results in the explicit optimization for the RMS error. Thus the lowest RMS error from the reconstruction based on asymmetric estimation without regularization is unsurprising. A closer look at one example (Figure 2(b) ) reveals mismatch and inconsistent geometry in the regions with high-frequency of change and high-curvature details. The mismatch was corrected by the symmetric estimation, which ensures a mutually consistent match, and thus the Hausdorff distance between the reconstruction and the target were significantly reduced. "}]
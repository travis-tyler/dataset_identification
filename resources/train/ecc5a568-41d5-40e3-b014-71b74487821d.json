[{"section_title": "Abstract", "text": "Motivation: Neuroimaging genetics identifies the relationships between genetic variants (i.e., the single nucleotide polymorphisms) and brain imaging data to reveal the associations from genotypes to phenotypes. So far, most existing machine-learning approaches are widely used to detect the effective associations between genetic variants and brain imaging data at one time-point. However, those associations are based on static phenotypes and ignore the temporal dynamics of the phenotypical changes. The phenotypes across multiple time-points may exhibit temporal patterns that can be used to facilitate the understanding of the degenerative process. In this article, we propose a novel temporally constrained group sparse canonical correlation analysis (TGSCCA) framework to identify genetic associations with longitudinal phenotypic markers. Results: The proposed TGSCCA method is able to capture the temporal changes in brain from longitudinal phenotypes by incorporating the fused penalty, which requires that the differences between two consecutive canonical weight vectors from adjacent time-points should be small. A new efficient optimization algorithm is designed to solve the objective function. Furthermore, we demonstrate the effectiveness of our algorithm on both synthetic and real data (i.e., the Alzheimer's Disease Neuroimaging Initiative cohort, including progressive mild cognitive impairment, stable MCI and Normal Control participants). In comparison with conventional SCCA, our proposed method can achieve strong associations and discover phenotypic biomarkers across multiple timepoints to guide disease-progressive interpretation. Availability and implementation: The Matlab code is available at https://sourceforge.net/projects/ ibrain-cn/files/."}, {"section_title": "Introduction", "text": "Integrating neuroimaging and molecular genetics technology hold great promising to use brain imaging as quantitative phenotypes to investigate the role of genetic variations. These imaging quantitative traits (QTs) serve as intermediate phenotypes with rich information, which bridge the gap between genetic factors and phenotypic outcomes (Glahn et al., 2007; Gottesman and Gould, 2003; Hariri et al., 2006) and may lead to a better understanding of the complex biological mechanism underlying neurodegenerative diseases [e.g., mild cognitive impairment (MCI), the prodromal stage of Alzheimer's disease (AD)].\nIn prior imaging genetic studies, pairwise univariate analysis strategies have been performed to identify the associations between single nucleotide polymorphisms (SNPs) and neuroimaging QTs. The most comprehensive studies focused on scanning the entire brain and the entire genome (Shen, et al., 2010; Stein et al., 2010) . In recent studies, taking into account the inherent structure among genotype or phenotype data, some researchers have developed generalized multivariate linear regression models (Hibar et al., 2011; Kohannim et al., 2011 Kohannim et al., , 2012 Vounou et al., 2010; Wang et al., 2012a) and structured bi-multivariate models (Chi et al., 2013; Lin et al., 2014; Yan et al., 2014) to identify multi-SNP-multi-QT associations. Those methods have sufficient power to discover structured phenotypic imaging markers associated with disease-relevant SNPs. However, examining genetic influence on the longitudinal profiles of imaging phenotype is still an under-explored topic in imaging genetics. Specifically, a straight forward approach such as conventional sparse canonical correlation analysis (SCCA) (Chi et al., 2013; Witten et al., 2009; Witten and Tibshirani, 2009 ), which does not take into account the valuable information conveyed by the longitudinal pattern of phenotypic input, is to perform multi-SNPmulti-QT associations at one time-point. In fact, the phenotypes across multiple time-points may exhibit temporal patterns that can be used to describe the degenerative process. Some studies have investigated on prediction of memory impairment and cognitive assessments with longitudinal magnetic resonance imaging (MRI) data (Jie et al., 2016; Wang et al., 2016) .\nSo far, only a few machine-learning strategies have been proposed to examine how the phenotypic changes are that affected by SNPs. Recently, Wang et al. (2012b) proposed a novel task-correlated longitudinal sparse regression model to study the association between phenotypic imaging markers and the genotypes by taking into account the temporal structure of the longitudinal imaging data. More specifically, they used L21-norm for regression coefficient matrix to jointly select imaging markers that have common effects across all time-points. However, the task-correlated longitudinal sparse regression model assumed that longitudinal imaging markers were related to all candidate SNPs as a taskcorrelated constraint, which might not hold in real applications. More recently, Vounou et al. (2010) have proposed a two-step framework based on sparse reduced-rank regression to solve the imaging genetics problem for the genome-wide detection of markers associated with voxel-wise longitudinal changes in brain (Vounou et al., 2012) . They first pre-selected the disease relevant voxel level imaging phenotypes with high-classification performance between AD and NC group by penalized linear discriminant analysis, and then identified the SNPs associated with the multivariate imaging phenotypes from the first step. This approach might be inadequate to capture the dynamics of phenotypic trajectories and thus unable to detect the underlying temporal patterns. Therefore, how to identify the longitudinal phenotypes across consecutive time-points associated to the disease sensitive SNPs is still an important topic in imaging genetic studies.\nWith these observations, the motivation of this study is to identify associations between risk genotypes and longitudinal phenotypes, where we aim to design a powerful model to simultaneously maximize progression-relevant imaging genetic associations and capture the consecutive changes in brain between adjacent timepoints. Accordingly, as shown in Figure 1 , we propose a novel temporally constrained group sparse canonical correlation analysis (TGSCCA) framework that incorporates the group sparsity constraint and fused penalty to identify the associations between genetic factors and longitudinal phenotypes. In particular, it is promising to find the consecutive patterns that are robust to noises or outliers via considering both joint selection and the fused information in imaging phenotypes from adjacent time-points.\nIn this study, to evaluate the effectiveness and efficiency of our proposed method, we perform experiments on both synthetic and real data. For real data, using the Alzheimer's Disease Neuroimaging Initiative (ADNI) cohort (Mueller et al., 2005) , we examine imaging genetic associations between SNPs nearby the apolipoprotein E (APOE) gene and region of interest (ROI) measures extracted from longitudinal structural MRI. The empirical results show that our method not only yields clearly improved association performance under the metrics of correlation coefficient but also detects relevant risk SNP loci and imaging ROI markers.\nThe rest of this article is organized as follows. Section 2 introduces the TGSCCA method. The performances of the proposed method are evaluated through both simulations and real data analysis in Section 3. The last section concludes the study."}, {"section_title": "Materials and methods", "text": ""}, {"section_title": "Sparse Canonical Correlation Analysis (SCCA)", "text": "We first describe relevant notations to present imaging genetic association analysis. We use lowercase letters to denote vectors, and uppercase letters to denote the matrices. Let X \u00bc \u00bdx 1 ; . . . ; x n ; . . . ; x N T 2 R N\u00c2p be the SNP genotype data, \u00bdy 1 ; . . . ; y n ; . . . ; y N T 2 R N\u00c2q be the phenotype data, where N is the number of participants, and p and q are the feature number of SNPs and imaging data, respectively.\nCanonical correlation analysis (CCA) is a powerful association method that seeks linear transformations of two data sets X and Y to achieve the maximal correlation between Xu and Yv (Hotelling, 1935) , which can be formulated as: X.Hao et al.\n(1)\nwhere we assume that the columns of X and Y are standardized to have zero mean and unit variance, and u and v are canonical weights, reflecting the contribution of each feature in the identified canonical correlation. However, in imaging genetics applications, the traditional CCA model tends to overfit and does not yield desirable results as the dimension of the data is much higher than the sample size. In addition, the CCA outcome could spread nontrivial effects across all features, which are not desirable for applications needing to identify relevant features. To address these issues, sparse version of CCA (SCCA) (Chi et al., 2013; Witten et al., 2009; Witten and Tibshirani, 2009 ) has been proposed by introducing penalties with L1 regularization for variable selection (Tibshirani, 2011) as follows:\nwhere the constraints u j j j j 1 c 1 and v j j j j 1 c 2 are regularization term for the objective function, and c 1 and c 2 is the corresponding regularization parameters. In imaging genetics applications, the weight vectors u and v measure the relative contributions of the SNP loci and imaging phenotype ROIs. For easy computation, the variance matrix of X and Y is treated as diagonal matrix, which has shown to be effective and efficient for high-dimensional data (Grellmann et al., 2015; Witten et al., 2009 )."}, {"section_title": "Temporally constrained group sparse canonical correlation analysis (TGSCCA)", "text": "In clinical practice, imaging phenotypes affected by genetic factors changes over time. To investigate the association between genotypes and longitudinal imaging phenotypes, in this article, we consider how to perform bi-multivariate association analysis across the consecutive time-points. Assume that we have N training subjects, and each subject has imaging data derived from T different time-points. Given the genotype SNPs data X \u00bc \u00bdx 1 ; . . . ; x n ; . . . ; x N T 2 R N\u00c2p and longitudinal imaging phenotypes Y t \u00bc \u00bdy 1t ; . . . ; y nt ; . . . ; y Nt T 2 R N\u00c2q at time-point t (1 t T) as input in the association model, where N is the number of participants, p and q are the numbers of feature dimensionalities (i.e., number of SNP loci and brain imaging ROIs). As described in Section 1 and Figure 1 , our aim is to discover those longitudinal brain imaging markers associated with genetic factors across different time-points. Task-correlated longitudinal analysis model has recently been successfully investigated and applied to regression problems (Wang et al., 2012a, b) , which are inspired by using multi-task learning framework (Liu et al., 2009; Obozinski et al., 2006) in machine-learning community. Following their previous work, we induce the joint penalty term L21-norm into the Equation (2) and then develop group sparse canonical correlation analysis (GSCCA) model as follows:\nwhere the weight vector u and v t measure the relative importance of the SNP loci and imaging phenotype ROIs at time-point t (1 t T). k u and k v denote control parameters of the regularization terms, respectively. V \u00bc \u00bdv 1 ; . . . ; v t ; . . . ; v T 2 R q\u00c2T is the weight matrix whose row v i is the vector of coefficients assigned to the -th feature across different time-points, and V j j j j 2;1 \u00bc P d i\u00bc1 jjV i jj 2 is to penalize all coefficients in the same row of matrix V for joint feature selection. It is worth noting that the L21 regularization term can be coupled over time dimension and this \"group-sparsity\" regularizer forces only a small number of features being selected (Yuan and Lin, 2006) . In other words, the longitudinal imaging features across all time-points will be identified.\nTo further take into account detecting temporally-constrained imaging genetic associations, we expect to develop our model to explore the association between baseline SNPs and longitudinal imaging phenotypes for a better understanding of underlying progressive mechanism specific to the disease. More specifically, motivated by the existing work (Jie et al., 2016) , we induce a new regularization term called fused least absolute shrinkage and selection operator (Lasso) (Liu et al., 2010) in machine-learning community and then formulate the TGSCCA model as follows:\nwhere the weight vectors u and v t measure the relative contributions of the SNP loci and imaging phenotype ROIs at time-point t. The weight vector v t\u00fe1 and v t are from adjacent time-points. k u , k v and k t denote control parameters of the regularization terms, respectively. The fused Lasso regularization term tends to constrain the differences between two successive canonical weight vectors from adjacent time-points to be small, that is the smoothness of weight vectors encourages neighboring features to be selected together. Due to the two regularization terms in Equation (3), it is promising to find the better solution that is robust to noises or outliers via considering both joint selections and the fused information inherent in imaging genetic associations."}, {"section_title": "Optimization algorithm", "text": "In this section, we introduce the algorithm to obtain u and V from Equation (4). The objective function is convex with respect to u when V is fixed and vice versa. So the iteration procedures mainly contain two steps as follows:\nWe can use the Lagrange multiplier and write the penalties into the matrix form for Equation (5), thus the new objective function is as follows:\nwhere k u and h are the model parameters. In this solution, a smooth approximation has been estimated for L1 term by including an extremely small value. Take the derivative regarding k u and let it be 0. The solution for u in each iteration step is as follows:\nwhere D is a diagonal matrix with the kth element as 1=2jju k jj 1 \u00f0k 2 \u00bd1; p\u00de.\nTo obtain V when u is fixed for Equation (6), we follow the previous work (Fang et al., 2016; Witten et al., 2009) and assume that the variance matrix of Y t is treated as diagonal matrix, which has shown to be effective and efficient for optimization. The solution for V in each iteration step is as follows:\nIt is straightforward to verify that Equation (10) is convex but non-smooth because of L21-norm and Fused Lasso regularization term. The basic idea to solve this problem is to use a smooth function to approximate the original non-smooth objective function. In this study, we use the Nesterov's accelerated proximal gradient (APG) algorithm (Beck and Teboulle, 2009; Chen et al., 2009) to solve our optimization problem, which is shown in the Algorithm 1.\nFirst, we separate Equation (10) into a smooth part Equation (11) and a non-smooth part Equation (12) as follows:\nWe define the approximation function Equation (10) as follows, which is composited by the above smooth part and non-smooth one:\nwhere jj \u00c1 jj 2 F denotes the Frobenius norm, rf V i \u00f0 \u00de denotes the gradient of f V \u00f0 \u00de on point V i at the ith iteration, and l is the step size. Finally, the update step of Nesterov's APG is defined as:\nThe key of APG algorithm is how to solve the update step efficiently. In addition, according to the technique used in Chen et al. (2009) , instead of performing gradient descent based on V i , we compute the search point as:\nwhere\nFor more details about the solution of L21-norm and Fused Lasso problem, please refer to the previous work (Jie et al., 2016; Liu et al., 2010) ."}, {"section_title": "Results and discussions", "text": ""}, {"section_title": "Results on simulation data", "text": "In this section, we present a simulation study to evaluate the potential power of our proposed TGSCCA method. The procedure of simulation generation is similar to that in Chen et al. (2012) and Fang et al. (2016) . We first generated one canonical vector u with p' non-zero entries and successive canonical vector v k with q' nonentries, where v k\u00fe1 \u00bc v k \u00fe Dv \u00f0Dv $ N 0; 0:1 \u00f0 \u00deand \u00f0k \u00bc 1; 2; 3\u00de\u00de. Each non-zero variable in u and v 1 was sampled independently from a uniform distribution in the range of \u00c02; \u00c00:5 \u00bd [\u00bd 0:5; 2. And then, we randomly generated a latent variable h with normal distribution N\u00f00; r h \u00de for each sample, where r h is the signal to noise level. For the data matrix X and Y, the features were simulated from Gaussian distribution N\u00f0uh; r e I p \u00de and N\u00f0v k h; r e I q \u00de, respectively. We set N \u00bc 100, p \u00bc 100, q \u00bc 50, p'\u00bc30, q'\u00bc20, r h \u00bc 0:1. To validate the effects on the performance, we varied the noise level r e from 0.1 to 0.5 to generate simulation data 1 and simulation data 2, respectively.\nIn our experiments, 5-fold cross-validation strategy is adopted to evaluate the effectiveness of our proposed method. All the regularization parameters are optimally tuned using a grid search from the range of {0.01, 0.02, 0.05, 0.08, 0.1, 0.2, 0.5, 0.8, 1} by another nested 5-fold cross-validation on the training set.\nWe compare SCCA (denoted as sparse canonical correlation analysis to detect associations between SNP loci and imaging features at each time-point), GSCCA (denoted as group sparse canonical correlation analysis to detect associations between SNP loci and longitudinal imaging phenotypic features jointly across all time-points only via L21-norm), and TGSCCA (denoted as temporally-constrained group sparse canonical correlation analysis to detect associations between SNP loci and longitudinal imaging features jointly across all adjacent time-points via L21-norm and fused penalty).\nThe performance on each dataset is assessed with correlation coefficient between X and Y, which are widely used in measuring performances of association analysis. The average results of correlation Algorithm 1 Input: SNPs X \u00bc \u00bdx 1 ; . . . ; x n ; . . . ;\nWhile not converge do 1: Calculate the diagonal matrix D, where the k-th element is 1=2jju k jj 1 ; 2: Update u by Equation (8); 3: Scale u so that jjXujj 2 2 \u00bc 1; 4: Computed the search point Q i according to Equation (15); 5:Find the smallest\ncoefficients on 5-fold testing data are calculated respectively on Simulation 1 and Simulation 2. As shown in Figure 2 , joint longitudinal association methods (including GSCCA and TGSCCA) outperform SCCA consistently and significantly in the metrics of correlation coefficients on both simulations. It is worth noting that TGSCCA is comparable with GSCCA due to the low noises in Simulation 1, while TGSCCA is more robust to the data with high noises in Simulation 2. Furthermore, we show the estimated canonical weights from different methods. As shown in Figure 3 , the overall profiles of the estimated u and v values from TGSCCA are consistent with the ground truth on both Simulation 1 and Simulation 2, whereas SCCA is only capable of identifying inconsistent signals at different time-points. Although GSCCA can almost capture the same signals on u as TGSCCA, from the unsmooth patterns across the longitudinal case, it may be affected by noises and then draw false discoveries on v without the induced temporalconstraint. From the above results, it is observed that TGSCCA can identify not only the signal locations but also strong correlations, which has certain superiority compared with other methods."}, {"section_title": "Results on real imaging genetic data", "text": ""}, {"section_title": "ADNI dataset", "text": "Real imaging genetics data used in the preparation of this article were obtained from the ADNI database (adni.loni.usc.edu). The ADNI was launched in 2003 as a public-private partnership, led by Principal Investigator Michael W. Weiner, MD. The primary goal of ADNI has been to test whether serial MRI, positron emission tomography (PET), other biological markers, and clinical and neuropsychological assessment can be combined to measure the progression of MCI and early AD. For up-to-date information, see www.adni-info.org.\nThe genotyping and longitudinal imaging data of 114 non-Hispanic Caucasian participants were downloaded from the ADNI website. The demographic information is summarized in Table 1 . Specifically, the time points examined in this study for MRI T1weighted imaging and cognitive assessments (i.e., MMSE and ADAS-Cog) included baseline (BL), Month 06 (M06), Month 12 (M12) and Month 24 (M24). We aligned the preprocessed imaging data [i.e., voxel based morphometry (VBM)] to each participant's same visit scan, and then created normalized gray matter density maps from MRI data in the standard Montreal Neurological Institute (MNI) space as 2 \u00c2 2 \u00c2 2 mm 3 voxels SPM software package (Ashburner and Friston, 2007) . One hundred and sixteen ROI level measurements of mean gray matter densities were further extracted based on the MarsBaR AAL atlas (Tzourio-Mazoyer et al., 2002) . After removal of cerebellum, the imaging measures of 90 ROIs were used as phenotypes in our experiments. For the genotyping data, we included 85 SNPs within 620k base pairs of the APOE gene boundary based on the ANNOVAR (http://annovar.openbioin formatics.org) annotation. For input in this association study, each SNP value was coded in an additive fashion as 0, 1, 2, indicating the number of minor alleles."}, {"section_title": "Improved association between risk SNP loci and longitudinal imaging ROI markers", "text": "In the real data experiments, we also use 5-fold cross-validation strategy to evaluate the effectiveness of our proposed method. Similar to the previous simulation study, we determine the values of regularization parameters by nested 5-fold cross-validation on the training set. The parameters are tuned in the range of {0.01, 0.02, 0.05, 0.08, 0.1, 0.2, 0.5, 0.8, 1}.\nIn current studies, we compare our proposed joint longitudinal imaging genetic strategies (including GSCCA and TGSCCA) with conventional SCCA method. For measuring the association performance of the compared methods, the average values of Pearson correlation coefficients on 5-fold test sets are calculated to eliminate the bias. As shown in Figure 4 , the performances of longitudinal strategies with joint detections (including GSCCA and TGSCCA) are more stable than the conventional SCCA, which treats imaging genetic associations at each time-point independently. As expected, TGSCCA can achieve the best correlation coefficients so that it consistently outperform SCCA and GSCCA. These results demonstrate that the usage of temporal information across adjacent time-points can help improve the performances of association between genotypes and longitudinal imaging phenotypes."}, {"section_title": "Identification of risk SNP loci", "text": "Besides improving association performance, one major goal of this study is to identify some vital SNP loci and imaging phenotypic markers for disease progression in MCI research. Therefore, finding genetic risk factors and imaging ROIs helps scientists better understand how the disease develops and identify possible treatments to study. We aim to present the selected features on the SNP loci and imaging ROIs, whose annotations are shown on the X-axis from top and bottom panels in Figure 5 . It shows all comparisons of absolute weight maps for top 10 loci from APOE SNPs associated to top 10 brain ROIs with longitudinal analysis respect to different methods.\nFor detecting genetic factors, as shown on top panels in Figure 5 , the locus rs76692773 and rs2075649 (Lin et al., 2016) are the top hits by all methods. However, compared with SCCA, the joint longitudinal detections (including GSCCA and TGSCCA) can discover consistent and clear patterns across all time-points, which indicate our proposed method performs stable in longitudinal imaging genetic associations. It is worth noting that the best-known risk genetic loci rs429358 has not been identified by all methods (including our proposed TGSCCA). It warrants further investigation to confirm whether the eminent risk factor rs429358 is truly not associated with longitudinal VBM phenotypes in the MCI progression. In addition, as the association solution relies on the linear combination of all loci, an individual one might not have a direct influence to the correlation, i.e., it might modulate the influence of another locus. Consequently, these genetic factors selected in this association study should also warrant further investigation for replication in independent and larger cohorts."}, {"section_title": "Identification of longitudinal imaging ROI markers", "text": "For detecting brain imaging ROIs, as shown on bottom panels in Figure 5 , the conventional SCCA method identifies some irregular imaging ROIs at different time-points, which are not able to serve screening target over the course of MCI progression. While using joint longitudinal detection strategies, we can obtain clear patterns on the feature panels. For example, right parahippocampal gyrus and right superior parietal gyrus are the two top hits in joint detections (including GSCCA and TGSCCA), which are in accordance with previous findings (Jacobs et al., 2012; Shen et al., 2010) . In addition, the top ROIs selected for progression across all timepoints by TGSCCA can be treated as increasingly stable markers, which are also accordance with the fact that the grey matter atrophy of these ROIs is severe in MCI (Driscoll et al., 2009) . Therefore, compared with SCCA and GSCCA, our proposed TGSCCA can tolerate noises to some extent so that the weight maps of each selected ROI across different time-points are very smooth. This further indicates the advantage of using the temporal-constrained smoothness regularization."}, {"section_title": "Conclusion", "text": "In this article, we propose a novel TGSCCA framework to detect risk genetic factors and their correlated longitudinal phenotype markers for a progressive disease (i.e., MCI). This approach explicitly captures the consecutive changes between phenotypes from adjacent time-points by incorporating the group sparsity constraint and fused penalty into the objective function. We also present an effective iterative algorithm to solve the optimization problem. We apply the proposed method on the simulation data and ADNI cohort [including progressive mild cognitive impairment (pMCI), stable MCI (sMCI) and NC participants]. The experimental results show that our proposed TGSCCA model can identify stronger associations than conventional SCCA and GSCCA. Besides the improved association performance, in real imaging genetic data, our model can also detect the risk SNP loci and clearly consistent brain ROIs across all time-points, which provides valuable information to help understand the genetic basis of brain structural change over the progression of MCI and AD.\nAs an interesting future direction, this TGSCCA method can be applied to investigate the potential mechanism of other imaging phenotypes (e.g., fluorodeoxyglucose positron emission tomography (FDG-PET) and Florbetapir F 18 amyloid PET data) (Hao et al., 2016) and biomarkers such as cerebrospinal fluid and plasma from (Fagan et al., 2014) . Therefore, all kinds of biomarker outcomes learned from trajectories across the course of disease can be evaluated, and the findings may have the potential to help with neurodegenerative assessments in clinical practices.\nIn this initial study, the proposed TGSCCA can be successfully applied for longitudinal imaging genetics study on a candidate gene set. However, when the datasets contain more features, it becomes more challenging to identify truly relevant ones. Thus, an interesting future direction could be to develop an improved TGSCCA model by exploring non-convex penalty terms that have been shown to be more effective than L1 based terms in terms of feature selection via sparse learning. In addition, this general framework can be extended and applied to some other interesting fields such as brain-perceived analysis (Connolly et al., 2016) and gene expression analysis on multiple data sources (Allahyar and de Ridder, 2015; Bunte et al., 2016; Omranian et al., 2016) , allowing for generating new insights."}]
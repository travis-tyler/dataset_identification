[{"section_title": "Abstract", "text": "2( )[0000\u22120003\u22121672\u22129149] , Maria del C. Vald\u00e9s-Hern\u00e1ndez 2[0000\u22120003\u22122771\u22126546] , and\nAbstract. We propose a novel approach named one-time sampling irregularity age map (OTS-IAM) to detect any irregular texture in FLAIR brain MRI without any human supervision or interaction. In this study, we show that OTS-IAM is able to detect FLAIR's brain tissue irregularities (i.e. hyperintensities) without any manual labelling. One-time sampling (OTS) scheme is proposed in this study to speed up the computation. The proposed OTS-IAM implementation on GPU successfully speeds up IAM's computation by more than 17 times. We compared the performance of OTS-IAM with two unsupervised methods for hyperintensities' detection; the original IAM and the Lesion Growth Algorithm from public toolbox Lesion Segmentation Toolbox (LST-LGA), and two conventional supervised machine learning algorithms; support vector machine (SVM) and random forest (RF). Furthermore, we also compared OTS-IAM's performance with three supervised deep neural networks algorithms; Deep Boltzmann machine (DBM), convolutional encoder network (CEN) and 2D convolutional neural network (2D Patch-CNN). Based on our experiments, OTS-IAM outperformed LST-LGA, SVM, RF and DBM while it was on par with CEN."}, {"section_title": "Introduction", "text": "Magnetic resonance imaging (MRI) aims to facilitate identifying brain pathologies, like T2-FLAIR white matter hyperintensities (WMH) that are commonly found in patients with dementia/Alzheimer's Disease (AD), stroke and multiple sclerosis. It is believed that WMH are associated with the progression of dementia [10] . However, detecting brain pathology automatically in MRI using computers is challenging as MRI appearance varies depending on studies, scanners and protocols.\nSupervised machine learning algorithms such as support vector machine (SVM), random forest (RF) and convolutional neural networks (CNN) are usually used for automatic detection of brain pathology and have been tested in many studies [3, 6] . However, manual labels of brain pathology needed for training process are not always available and usually expensive to produce as they have to be performed by an expert (i.e., physician). Furthermore, the quality of the manual label itself depends and varies according to expert's skills which creates another question about reproducibility in different sets of data. These variations usually can be quantified by using intra-/inter-observer evaluations, but it does not solve the subjectivity problem.\nUnsupervised machine learning algorithms which work without manual labels do not have the aforementioned dependencies. Some examples of these methods are Lesion Growth Algorithm from Lesion Segmentation Tool toolbox (LST-LGA) [8] and Lesion-TOADS [9] which were developed for unsupervised detection of hyperintensities, the main brain tissue's irregular textural characteristic in T2-FLAIR images. Unfortunately, performances of these methods are limited compared to supervised methods [6] .\nA newly unsupervised method named irregularity age map (IAM) was proposed in [7] , and it was reported that IAM works better than LST-LGA, which is still the baseline and state-of-the-art method for unsupervised detection of WMH. However, the IAM has undergone only a limited evaluation, as the original study only used 20 cross-sectional MRI data, its performance was not compared against supervised machine-learning methods and it took 2.9 hours to process a single MRI volume with only 35 axial slices. In this study we propose a 13.4 times faster version of IAM named OTS-IAM, which could be implemented on GPU, evaluate it on longitudinal samples and compare its performance with state-of-the-art supervised and unsupervised methods.\nIn summary, our main contributions in this study are: "}, {"section_title": "One-Time Sampling Irregularity Age Map", "text": "Like the original IAM, one-time sampling irregularity age map (OTS-IAM) is influenced by a previous work in computer graphic [1] in which a novel way of calculating age map in texture image was proposed. Age map quantifies irregular textures into a map of probability values between 0 and 1, dubbed as age values. The same approach of generating age map for brain MRI was then proposed and named irregularity age map (IAM) in [7] which reported that IAM works well as an unsupervised method for WMH detection. To calculate age map for MRI, four important steps need to be performed: 1) brain masks preparation, 2) patch generation, 3) age value calculation and 4) final age map generation. These steps are visualised in Fig. 1 . Brain masks are essential because OTS-IAM works by comparing brain tissues, so non-brain tissues such as skull, cerebrospinal fluid (CSF), veins and meninges need to be excluded. To exclude these non-brain tissues, intracranial volume (ICV) and CSF masks are needed. In this study, ICV mask is generated by using optiBET [4] while CSF mask is generated by using an in-house method/protocol. There is no pre-processing step before computation of OTS-IAM other than the generation of these two masks. We here introduce a postprocessing step to exclude the non-white matter area of the brain and improve the quality of the final result. This added step uses the normal appearing white matter (NAWM) binary mask, which was generated by using FSL-FAST [11] .\nPatch generation generates two sets of patches; source patches, generated by dividing an MRI slice into non-overlapping grid-patches, and target patches, generated by randomly-sampling all possible overlapping patches. The assumption of this step is; if we successfully sample target patches mostly from normal brain tissues, which contain regular textures, and calculate distance values between a source patch and a set of target patches, then irregular textures located within the source patch will produce high absolute distance values. In this study, we use four different sizes of source/target patches; 1 \u00d7 1, 2 \u00d7 2, 4 \u00d7 4 and 8 \u00d7 8. Unlike previous studies [1] [7] which use all possible target patches, we here use a set of randomly sampled target patches to speed up the computation.\nAge value calculation is the core of the OTS-IAM where a distance value called age value is computed by using the function defined below. Let s be a source patch and t a target patch, the age value of the two patches d is:\nwhere \u03b1 = 0.5 in this study. Both maximum and mean values of the subtracted patch are used to include maximum and average differences between source and target patches in the calculation. Note that source/target patches are matrices in the size of either 1 \u00d7 1, 2 \u00d7 2, 4 \u00d7 4 or 8 \u00d7 8. Also, note that each source patch will be computed against a set of target patches, so each source patch has a set of age values. To get the final age value for one source patch, the corresponding set of age values is sorted in ascending order and, then, the mean of the first 100 age values is calculated. The rationale is simple; the mean of the first 100 age values produced by irregular source patches is still comparably higher than the mean of the first 100 age values produced by normal source patches. All final age values from all source patches are then normalised from 0 to 1 real values to create an age map of one MRI slice. The final age map generation consists of three sub-steps, which are blending four age maps from age value calculation, penalty and global normalisation. Blending of four age maps is performed by using the following formulation:\nwhere \u03b1 + \u03b2 + \u03b3 + \u03b4 is equal to 1 and map 1 , map 2 , map 4 and map 8 are age maps from 1 \u00d7 1, 2 \u00d7 2, 4 \u00d7 4 and 8 \u00d7 8 source/target patches. In this study, \u03b1 = 0.65, \u03b2 = 0.2, \u03b3 = 0.1 and \u03b4 = 0.05 as weight blending parameters. Before the blending, age maps resulted from different size of source/target patches are up-sampled to fit the original size of MRI slice and then smoothed by using Gaussian filter. The blended age map is then penalised using formulation below:\nwhere p i is voxel from the blended age map, v i is voxel from the original MRI and p o is the penalised voxel. Lastly, all age maps from different slices of MRI are normalised together to produce 0 to 1 probability values. Some important notes on OTS-IAM's computation are: 1) source and target patches are of the same size at the same time, 2) the centre of source/target patches needs to be inside the ICV and outside of the CSF masks at the same time to be included in the age value calculation, 3) if a slice does not have any source patch is skipped to accelerate the computation and 4) there is no indication of OTS-IAM decreasing performance by using only a subset of target patches (i.e., randomly sampled target patches)."}, {"section_title": "One-Time Sampling IAM vs. the Original IAM", "text": "While the original IAM has been reported to work well on WMH detection, its computation takes a considerable amount of time owed to the nature of doing one sampling for each source patch. For the sake of clarity in this study, we named this scheme multiple-time sampling (MTS) scheme. The original IAM has a MTS scheme as it pre-establishes the condition that every target patch should not be too close to the source patch (i.e., location-based condition). The MTS scheme makes every source patch to have its own set of target patches, so extra time to do sampling for each source patch is unavoidable.\nTo accelerate the overall IAM's computation, we propose here the one-time sampling (OTS) scheme for IAM, where target patches are randomly sampled only once for each slice, abandoning the location-based condition of the MTS. In other words, age values of all source patches from one slice will be computed against the same set of target patches. We call this combination of OTS and IAM one-time sampling IAM (OTS-IAM).\nOTS scheme also enables the possibility of GPU implementation for IAM where the number of target patches randomly sampled from a slice is limited to 2,048 samples. In comparison, the original IAM, which runs on CPU, uses an iterative sampling approach of high number of target patches (i.e., 10%-75% of all possible target patches in an MRI slice), which cannot be applied on GPU because of GPU's limited memory storage and management capabilities. Fixed number of target patches in power of two allows GPU implementation, especially facilitating GPU memory allocation, for OTS-IAM computation."}, {"section_title": "MRI Data, Other Machine Learning Algorithms and Experiment Setup", "text": "A set of 60 T2-Fluid Attenuation Inversion Recovery (T2-FLAIR) MRI data from 20 subjects of the ADNI database was used for DSC evaluation where every one of them either has absence or mild presence of vascular pathology. Each T2-FLAIR MRI volume has dimension of 256 \u00d7 256 \u00d7 35. Data used in this study were obtained from the ADNI [5] public database 3 . We compare performances of OTS-IAM with other machine learning algorithms that are commonly used for WMH segmentation; namely the original IAM, Lesion Growth Algorithm from Lesion Segmentation Tool (LST-LGA), SVM, RF, DBM, convolutional encoder network (CEN) and CNN. LST-LGA is the current state-of-the-art for unsupervised hyperintensities detection, so it is used as a direct comparison for IAM/OTS-IAM. The rests are representations of supervised conventional machine learning algorithms (i.e., SVM and RF) and supervised deep learning algorithms (i.e., DBM, CEN and CNN). All of them are commonly used for WMH detection/segmentation. Due to page limitation, we could not further elaborate the usage of these algorithms. However, all experiment setup for these algorithms, such as training/testing and algorithm's configurations, follow [6] for reproducibility reason.\nFor simplicity and reproducibility, automatic WMH detection results are compared with manual labelling of WMH by using Dice similarity coefficient (DSC) [2] . DSC measures spatial coincidence between ground truth and automatic segmentation results. Higher DSC score means better performance, and the DSC score itself can be computed as follow:\nwhere T P is true positive, F P is false positive and F N is false negative. Table 1 . Algorithm's information and experiment results based on DSC metric for each tested algorithm. Abbreviations: \"S/US\" for supervised/unsupervised, \"Deep Net.\" for deep neural networks algorithm, \"Y/N\" for Yes/No, \"T2F/T1W\" for T2-FLAIR/T1-weighted, \"TRSH\" for optimum threshold and \"Train/Test\" for training/testing time. Note that \"Speed up\" is used only for IAM's instances and compared to the original IAM. Table 1 shows the overall results for all tested methods. From Table 1 , we can see that all IAM configurations (i.e., IAM-CPU, OTS-IAM-CPU and OTS-IAM-GPU) outperformed LST-LGA by large margins. GPU implementation of OTS-IAM also successfully speeded up IAM's computation by more than 17 times. Note that testing time listed in Table 1 excludes registrations and brain masks generation processes. DSC curves of some algorithms tested in this study are shown in Fig. 2 . Whereas, Fig. 3 (left) shows visualisation of age map on MRI with large burden of hyperintensities while Fig. 3 (right) shows visualisation of age map generated from T1-weighted sequence. Fig. 3 (right) particularly shows that OTS-IAM could be used on different sequences of MRI. Table 1 also shows that performances of IAM and OTS-IAM not only outperformed LST-LGA but also some other supervised machine learning algorithms, which are SVM, RF and DBM. Furthermore, OTS-IAM-GPU also slightly outperformed CEN, a supervised deep neural networks algorithm. These comparisons can be seen more easily from DSC curves depicted in Fig. 2 ."}, {"section_title": "Result", "text": "Based on our repetitive experiments, smaller number of randomly-sampled target patches used in OTS-IAM does not reduce the quality of the result, but rather improve it instead. The GPU implementation of OTS-IAM uses a fixed number of 2,048 target patches instead of 10%-75% of all possible target patches as per the original IAM and the CPU implementation of OTS-IAM (i.e., OTS-IAM-CPU). This shows that the OTS scheme is not only able to accelerate computation time of IAM but also the quality of IAM's result. Fig. 3 . Visualisation of OTS-IAM's results on MRI with large burden of hyperintensities (left) and on T2-FLAIR and T1-weighted of MRI after thresholding (right). Notice how each area of hyperintensities has its own level of damage. These are unlabelled MRI data from ADNI dataset."}, {"section_title": "Discussion", "text": "Through this study, we have demonstrated the use of the newly proposed method OTS-IAM to automatically detect irregular texture without any human supervision or manual labelling. In this study, OTS-IAM successfully detected irregular textures of hyperintensities in T2-FLAIR and also hypointensities in T1weighted ( Fig. 3) . OTS-IAM works on texture level, not intensity level, where the size of texture patches (i.e., source and target patches) can be adjusted easily as needed, including 3D patches instead of 2D patches.\nBased on our experiments, incorporation of one-time sampling (OTS) scheme to IAM not only speeded up IAM's computation but also improved IAM's performance. There was no indication of performance degradation in the use of a subset of all possible target patches where uniformed random sampling was applied. The use of limited number of target patches for the GPU implementation of OTS-IAM (i.e., only 2048 target patches) strengthened this argument. It would be very interesting to know the minimum number of target patches needed to further speed up IAM's computation without any performance degradation.\nAs an unsupervised method, OTS-IAM works independently from any subjective human expertise which usually influences supervised machine learning algorithms. The results also shows that all IAM instances outperformed LST-LGA, the state-of-the-art of unsupervised hyperintensities detection, by large margins. OTS-IAM also outperformed some of supervised machine learning algorithm tested; SVM, RF, DBM and CEN.\nIn the future, OTS-IAM might be used not only for irregular texture detection but also for other purposes. For example, OTS-IAM could be used to provide unsupervised labels of hyperintensities for pre-training step of supervised deep neural networks algorithms. By the help of OTS-IAM, the most tedious and expensive step of producing manual labels of hyperintensities could be minimised and thousands of hyperintensities age maps could be produced automatically.\nTrust (Grant No. BRO-D.FID3668413) (MCVH) are gratefully acknowledged. Data collection and sharing for this project was funded by the Alzheimer's Disease Neuroimaging Initiative (ADNI) (National Institutes of Health Grant U01 AG024904) and DOD ADNI (Department of Defense W81XWH-12-2-0012)."}]
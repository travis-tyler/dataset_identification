[{"section_title": "Introduction", "text": "Outbreaks of the COVID-19 pandemic have been causing worldwide socioeconomic and health concerns since December 2019, putting high pressure on healthcare services. SARS-CoV-2, the causative agent of COVID-19, spreads efficiently and, consequently, the effectiveness of control measures depends on the relationship between epidemiological variables, human behaviour, and government intervention to control the spread of the disease 3, 4 . Different attempts to model the virus outbreaks in many countries have been made, involving mechanistic models 5, 6 , and extensions based on susceptible-infected-recovered (SIR) systems [7] [8] [9] . Countries have also put together task forces to work with COVID-19 data and their indirect impact on the population, economy, banking and insurance, and financial markets 2, 10-12 . In addition, funding agencies have put together rapid response calls worldwide for projects that can help dealing with this pandemic. However, further investment is still needed to foment priority research involving SARS-CoV-2, so as to establish a high level coordination of essential, policy-relevant, social and mental health science 13, 14 .\nThis pandemic is associated with high basic reproduction numbers 15, 16 , spreading with great speed since a significant number of infected individuals remain asymptomatic, while still being able to transmit the virus 17 . In the UK, for example, it is estimated that approximately 4.4% of people who tested positive for SARS-CoV-2 overall required hospitalisation, increasing to 17 \u2212 27% in the group of persons aged 65 years or older. A pressing concern here is how to avoid bringing healthcare systems to a collapse 17, 18 . Knowing how the outbreak is progressing is crucial to predict whether or when this will happen, and therefore to plan and implement measures to reduce the number of cases so as to avoid it.\nPolicies for reducing the number of infected people such as social distancing and movement restrictions have been put in place in many countries, but for many others a full lockdown may be very difficult (if not impossible) to implement. This also depends heavily on the country's political leadership, socioeconomic reality, and epidemic stage 1, 19 . In this context, accurate short-term forecasting would prove itself invaluable, especially for systems on the brink of collapse and countries whose governments must consider trade-offs between lockdowns and avoiding full economical catastrophe.\nThe main problem is that not only is this disease new, but there are also many factors acting in concert resulting in a seemingly unpredictable outbreak progression. Forecasting with great accuracy under these circumstances is very difficult. Here we propose a new modelling framework, based on a state-space hierarchical model, that is able to generate forecasts with very good accuracy for up to seven days ahead. To aid policy making and effective implementation of restrictions or reopening measures, we provide all results as an R Shiny Dashboard, including week-long forecasts for every country in the world whose data is collected and made available by the European Centre for Disease Prevention and Control (ECDC)."}, {"section_title": "Results", "text": "Our model displayed an excellent predictive performance for short-term forecasting. We validated the model by fitting it to the data up to 13-May-2020, after removing the last seven time points (from 14-May-2020 until 20-May-2020), and compared the forecasted values with the observed ones ( Figure 1A ). We observe that it performs very well, especially for the first six days ahead ( Figure 1B ). Even though performance falls substantially for the seventh day ahead, with a concordance correlation between observed and forecasted values close to 0.5, there are still many countries for which the forecasted daily number of new cases is very close to the observed one. We carried out this same type of validation study using data up to 6-May-2020 and up to 29-Apr-2020, and the results were very similar, with a concordance correlation between observed and forecasted values greater than 0.75 for up to five days ahead (see Supplementary Materials). Figure 1 . A Logarithm of the observed y it versus the forecasted daily number of cases y * it for each country, for up to seven days ahead, where each day ahead constitutes one panel. The forecasts were obtained from the autoregressive state-space hierarchical negative binomial model, fitted using data up to 13-May-2020. The first day ahead corresponds to 14-May-2020, and the seventh to 20-May-2020. Each dot represents a country, and the sixteen countries shown in Figure 2 are represented by blue triangles. We add 1 to the values before taking the logarithm. B Observed accuracy, concordance correlation coefficient (CCC) and Pearson correlation (r) between observed (y it ) and forecasted (y * it ) values for each of the days ahead of 13-May-2020.\nThe autoregressive component in the model has a direct relationship with the pandemic behaviour over time for each country (see Supplementary Materials). It is directly proportional to the natural logarithm of the daily number of cases, given what happened in the previous day. Therefore, it is sensitive to changes and can be helpful detecting a possible second wave. See,"}, {"section_title": "2/22", "text": "for example, its behaviour for Ireland, Spain, Italy and France -it shows that the outbreak is decaying, however it may still take time to subside completely ( Figure 2 ). On the other hand, in Iceland the outbreak has ended, according to the estimated autoregressive component. In China and South Korea, however, even though it appears that the outbreak has come to an end, our results show that a second outbreak could begin, and hence countries must be very cautious when relaxing restrictions. In the UK and the United States, it seems as if the outbreak is taking a long time to subside, and in Brazil and Russia it has not even reached its peak yet. The estimates for the model parameters suggest that about 10% of the number of reported cases can be viewed as contributing to extra variability, and possibly may consist of outlying observations (see the model estimates in the Supplementary Materials). These observations may be actual outliers, but it is likely that this is a feature of the data collection process. In many countries, the data that is recorded for a particular day actually reflects tests that were done over the previous week or even earlier. This generates aggregated-level data, which is prone to exhibiting overdispersion, which is accounted for in our model, but for some observations this variability is even greater, since they reflect a large number of accumulated suspected cases that were then confirmed. There is also a large variability between countries in terms of their underlying autoregressive processes (see the estimates for the variance components in the Supplementary Materials). This corroborates the fact that countries are dealing with the pandemic in different ways, and also may collect and/or report data differently.\nWe propose clustering the countries based on the behaviour of their estimated autoregressive parameter over the last 60 days ( Figure 3 ). This gives governments the opportunity to see which countries have had the most similar recent behaviour of the outbreak, and study similar or different measures taken by these other countries that may help determine policy. We observe, for example, that Brazil and Russia have been experiencing a very similar situation recently; the same can be said about France, Germany, Italy and Spain. Our R Shiny dashboard displays up-to-date results in terms of forecasts and also country clustering, and can be accessed at https://prof-thiagooliveira.shinyapps.io/COVIDForecast. Through the dashboard, users can choose to highlight a different number of clusters, which may provide different insights. "}, {"section_title": "Discussion", "text": "Our modelling framework allows for forecasting the daily number of new COVID-19 cases for each country and territory for which data has been gathered by the ECDC. It introduces statistical novelty in terms of modelling the autoregressive parameter as a function of time. This makes it highly flexible to adapt to changes in the autoregressive structure of the data over time. In the COVID-19 pandemic, this translates directly into improved predictive power in terms of forecasting future numbers of 4/22 daily cases. Our objective here is to provide a simple, yet not overly simplistic, framework for country-level decision-making, and we understand this might be easier for smaller countries when compared to nations of continental dimensions, where state-level decision-making should be more effective 20 . Moreover, the model can be adapted to other types of data, such as number of deaths, and also be used to obtain forecasts for smaller regions within a country. A natural extension would be to include an additional hierarchical structure taking into account the nested relationship between cities, states, countries and ultimately continents, while also accommodating the spatial autocorrelation. This would allow for capturing the extra-variability introduced by aggregating counts over different cities and districts.\nWe remark that one must be very careful when looking at the forecasted number of cases. These values must not be looked at in isolation. It is imperative that the entire context is looked at and that we understand how the data is actually generated 21 . The model will obtain forecasts based on what is being reported, and therefore will be a direct reflection of the data collection process, be it appropriate or not. When data collection is not trustworthy, model forecasts will not be either. Our estimated number of outlying observations of approximately 10% is relatively high, and when looking at each country's time series we observe that countries that display unusual behaviour in terms of more outlying observations are usually related to a poorer model predictive performance as well. This suggests that the data collection process is far from optimal. Looking at the full context of the data is therefore key to implementing policy based on model forecasts.\nAs self-criticism, our model may possibly be simplistic in the sense that it relies on the previous observation to predict the next one, but does not rely on mechanistic biological processes, such as SEIR-type models 5, 22, 23 . These types of models allow for a better understanding of the pandemic in terms of the disease dynamics, and are able to provide long-term estimates 6 . However, as highlighted above, our objective is short-term forecasting, which is a task that is already very difficult. Long-term forecasting is even more difficult, and we believe it could even be speculative when dealing with its implications pragmatically. A more tangible solution to this issue is to combine the short-term forecasting power of our proposed modelling framework with the long-term projections provided by mechanistic models, so as to implement policy that can solve pressing problems efficiently, while at the same time looking at how it may affect society in the long run. We acknowledge all models are wrong, including the one presented here. We have showed, however, that it provides very good forecasts for up to a week ahead, and this can help inform on country reopening policies. Even though the model performs very well, we stress the importance of constantly validating the forecasts, since not only can the underlying process change, but also data collection practices change (to either better or worse). Many countries are still not carrying out enough tests, and hence the true number of infections is sub-notified 24 . This hampers model performance significantly, especially that of biologically realistic models 5 .\nThere is a dire need for better quality data 21 . This is a disease with a very long incubation period (up to 24 days 25 ), with median value varying from 4.5 to 5.8 days 26 , which makes it even harder to pinpoint exactly when the infection was actually transmitted from one person to the other. Furthermore, around 97.5% of those who develop symptoms will do so in between 8.2 to 15.6 days 26 . The number of reported new cases for today reflects a mixture of infections that were transmitted at any point in time over the last few weeks. The time testing takes also influences this. One possible alternative is to model excess deaths when compared to averages over previous years 27, 28 . This is an interesting approach, since it can highlight the effects of the pandemic (see, e.g., the insighful visualisations at Our World in Data 29 , and the Finantial Times 30 ). Again, this is highly dependent on the quality of the data collection process not only for COVID-19 related deaths, but also those arising from different sources. Many different teams of data scientists and statisticians worldwide are developing different approaches to work with COVID-19 data 3, 9, 16, 31 . It is the duty of each country's government to collect and provide accurate data. This way, it can be used with the objective of improving healthcare systems and general social wellbeing.\nThe developed R Shiny Dashboard displays seven-day forecasts for all countries and territories whose data are collected by the ECDC, and updated clustering of countries based on the last 60 days. This can help governments currently implementing or lifting restrictions. It is possible to compare government policies between countries at similar stages of the pandemic to determine the most effective courses of action. These can then be tailored by each particular government to their own country. The efficiency of measures put in place in each country can also be studied using our modelling framework, since it easily accommodates covariates in the linear predictor. Then, the contribution of these country-specific effects to the overall number of cases can serve as an indicator of how they may be influencing the behaviour of the outbreaks over time.\nGovernment policies are extremely dependent on the reality of each country. It has become clear that there are countries that are well able to withstand a complete lockdown, whereas others cannot cope with the economic downfall 19 . The issue is not only economic, but also of newly emerging health crises that are not due to COVID-19 lethality alone, but to families relying on day-to-day work to guarantee their food supplies. For these countries, there is a trade-off between avoiding a new evil versus amplifying pre-existing problems or even creating new ones. In such circumstances, it is indeed very difficult to create a one-size-fits-all plan, which makes it even more vital to strive for better data collection practices.\nWe hope to be able to contribute to the development of efficient short-term response to the pandemic, for countries whose healthcare systems are at capacity, and countries implementing reopening plans. By providing a means of comparing recent"}, {"section_title": "5/22", "text": "behaviour of the outbreak between countries, we also hope to provide a means to opening dialogue between countries going through a similar stage, and those who have gone through similar stages before."}, {"section_title": "Data acquisition", "text": "The data was obtained from the European Centre for Disease Prevention and Control (ECDC), and the code is implemented such that it downloads and processes the up-to-date data from https://www.ecdc.europa.eu/en/geographical-distribution-2019-ncovcases. We remove, however, the data from the current day, since it can be updated by the ECDC. We assumed non-available data to be zero prior to the first case being recorded for each country. Whenever the daily recorded data was negative (reflecting previously confirmed cases being discarded), we replaced that information with a zero. This is the case for only nine out of 29,610 observations as of the 20th of May 2020.\nAccording to the ECDC, the data on number of cases is based on reports from health authorities worldwide (up to 500 sources), which are screened by epidemiologists for validation prior to being recorded in the ECDC dataset."}, {"section_title": "Modelling framework", "text": "We introduce a class of state-space hierarchical models for overdispersed count time series. Let Y it be the observed number of newly infected people at country i and time t, with i = 1, . . . , N and t = 1, . . . , T . We model Y it as a Negative binomial first-order Markov process, with\nThe mean is modelled on the log scale as the sum of an autoregressive component (\u03b3 it ) and a component that accommodates outliers (\u2126 it ), i.e.\nTo accommodate the temporal correlation in the series, the non-stationary autoregressive process {\u03b3 it } is set up as\nwhere \u03b7 it is a Gaussian white noise process with mean 0 and variance \u03c3 2 \u03b7 . Differently from standard AR(1)-type models, here \u03c6 it is allowed to vary over time through an orthogonal polynomial regression linear predictor using the time as covariate, yielding\nwhere P q (\u00b7) is the function that produces the orthogonal polynomial of order q, with P 0 (x) = 1 for any real number x; \u03b2 q are the regression coefficients and b b b i is the vector of random effects, which are assumed to be normally distributed with mean vector 0 and variance-covariance matrix \u03a3 b = diag \u03c3 2 b 0 , . . . , \u03c3 2 b Q . By assuming \u03c6 it varying by country over time, we allow for a more flexible autocorrelation function. Iterating (1) we obtain\nwhich is equivalent to a country-specific AR(1) process. On the other hand, if \u03c6 it = \u03c6 i = \u03b2 0 , then \u03b3 it = \u03c6 t\u22121 \u03b3 i1 + \u03c6 t\u22122 \u03b7 i2 + \u03c6 t\u22123 \u03b7 i3 + . . . + \u03c6 \u03b7 it\u22121 + \u03b7 it , which is equivalent to assuming the same autocorrelation parameter for all countries.\nFinally, to accommodate extra-variability we introduce the observational-level random effect\nwhere \u03bb it \u223c Bernoulli(\u03c0) and \u03c9 it \u223c N(0, \u03c3 2 \u03c9 ). When \u03bb it = 1, then observation y it is considered to be an outlier, and the extra variability is modelled by \u03c3 2 \u03c9 . This can be seen as a mixture component that models the variance associated with outlying observations."}, {"section_title": "6/22", "text": "To forecast future observations y * i,t+1 , we use the median of the posterior distribution of Y i,t+1 |Y it . This is reasonable for short-term forecasting, since the error accumulates from one time step to the other. We produce forecasts for up to seven days ahead.\nWe fitted models considering different values for Q. Even though the results for Q = 3 showed that all \u03b2 q parameters were different from zero when looking at the 95% credible intervals, we opted for Q = 2 for the final model fit, since it improves convergence of the model, as well as avoids overfitting by assuming a large polynomial degree, while still providing the extra flexibility introduced by the autoregressive function (2) . This can change, however, as more data becomes available for a large number of time steps."}, {"section_title": "Model validation", "text": "We fitted the model without using the observations from the last seven days and obtained the forecasts y * it for each country and day. We then compared the forecasts with the true observations y it for each day ahead, by looking initially at the Pearson correlation between them. We also computed the concordance correlation coefficient 32, 33 , an agreement index that lies between \u22121 and 1, given by\nwhere \u03c1 t is the Pearson correlation coefficient (a measure of precision), and C t is the bias corrector factor (a measure of accuracy) at the t\u2212th day ahead. \u03c1 t measures how far each observation deviated from the best-fit line while C b \u2208 (0, 1] measures how far the best-fit line deviates from the identity line through the origin, defined as\nis a scale shift and u = (\u00b5 1 \u2212 \u00b5 2 )/ \u221a \u03c3 1 \u03c3 2 is a location shift relative to the scale. When C b = 1 then there is no deviation from the identity line."}, {"section_title": "Model implementation", "text": "The model is estimated using a Bayesian framework, and the prior distributions used are\nWe used 3 MCMC chains, 2,000 adaptation iterations, 50,000 as burn-in, and 50,000 iterations per chain with a thinning of 25. We assessed convergence by looking at the trace plots, autocorrelation function plots and the Gelman-Rubin convergence diagnostic 34 .\nAll analyses were carried out using R software 35 and JAGS 36 . Model fitting takes approximately seven hours to run in parallel computing, in a Dell Inspiron 17 7000 with 10th Generation Intel Core i7 processor, 1.80GHz\u00d78 processor speed, 16GB RAM plus 20GB of swap space, 64-bit integers, and the platform used is a Linux Mint 19.2 Cinnamon system version 5.2.2-050202-generic."}, {"section_title": "Clustering", "text": "We used the last 60 values of the estimated autoregressive component to perform clustering so as to obtain sets of countries that presented a similar recent behaviour. First, we computed the dissimilarities between the estimated time series\u03b3 \u03b3 \u03b3 i between each pair of countries using the dynamic time warp (DTW) distance 37, 38 . Let M be the set of all possible sequences of m pairs preserving the order of observations in the form r = ((\u03b3 i1 ,\u03b3 i 1 ), . . . , (\u03b3 im ,\u03b3 i m )). Dynamic time warping aims to minimise the distance between the coupled observations (\u03b3 it ,\u03b3 i t ). The DTW distance may be written as\nBy using the DTW distance, we are able to recognise similar shapes in time series, even in the presence of shifting and/or scaling 38 ."}, {"section_title": "7/22", "text": "Then, we performed hierarchical clustering using the matrix of DTW distances using Ward's method, aimed at minimising the variability within clusters 39 , and obtained ten clusters. Finally, we produced a dendrogram of the results of the hierarchical clustering analysis, with each cluster coloured differently so as to aid visualisation."}, {"section_title": "Code availability", "text": "All code and datasets are made available as Supplementary Materials, and updated versions can also be downloaded from https://github.com/Prof-ThiagoOliveira/covid_forecast.\nWe produced a Shiny app displaying the latest forecasts for the next seven days that is updated twice a week, and can be accessed at https://prof-thiagooliveira.shinyapps.io/COVIDForecast. Table 1 displays parameter estimates for the model fitted to the data up to 19-May-2020. Figure 4 -5 depicts the two additional forecast validation procedures we have carried out. Figure 6 displays density plots for the sampled posterior distributions for each model parameter. Figures 7-15 Table 1 . Parameter estimates and associated 95% credible intervals (CI) for the fitted autoregressive hierarchical state-space negative binomial model. \u03b2 0 , \u03b2 1 and \u03b2 2 are the fixed effects associated with the time orthogonal polynomials of order 0, 1 and 2, respectively; \u03c3 b 0 , \u03c3 b 1 and \u03c3 b 2 are the standard deviations of the random effects associated with the time orthogonal polynomials of order 0, 1 and 2, respectively; \u03c3 \u03b7 is the standard deviation of the random autoregressive process; \u03c0 is the probability of an observation being an outlier and \u03c3 \u03c9 is the standard deviation of the mixture component \u03c9 it ; \u03c8 is the dispersion parameter of the negative binomial distribution. Figure 4 . A Logarithm of the observed y it versus the forecasted daily number of cases y * it for each country, for up to seven days ahead, where each day ahead constitutes one panel. The forecasts were obtained from the autoregressive state-space hierarchical negative binomial model, fitted using data up to 29-April-2020. The first day ahead corresponds to 30-April-2020, and the seventh to 06-May-2020. Each dot represents a country, and the sixteen countries shown in Figure 2 are represented by blue triangles. We add 1 to the values before taking the logarithm. B Observed accuracy, concordance correlation coefficient (CCC) and Pearson correlation (r) between observed (y it ) and forecasted (y * it ) values for each of the days ahead of 29-April-2020. Figure 5 . A Logarithm of the observed y it versus the forecasted daily number of cases y * it for each country, for up to seven days ahead, where each day ahead constitutes one panel. The forecasts were obtained from the autoregressive state-space hierarchical negative binomial model, fitted using data up to 06-May-2020. The first day ahead corresponds to 07-May-2020, and the seventh to 13-May-2020. Each dot represents a country, and the sixteen countries shown in Figure 2 are represented by blue triangles. We add 1 to the values before taking the logarithm. B Observed accuracy, concordance correlation coefficient (CCC) and Pearson correlation (r) between observed (y it ) and forecasted (y * it ) values for each of the days ahead of 06-May-2020. Figure 15 . Posterior means of the autoregressive component \u03b3 it (solid lines) and associated 95% credible intervals (shaded areas) for 18 countries from the pool of 210 countries and territories in the data, from 1-Jan-2020 until 20-May-2020."}]
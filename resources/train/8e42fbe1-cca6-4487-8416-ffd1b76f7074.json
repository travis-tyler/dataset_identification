[{"section_title": "Abstract", "text": "Abstract. We develop a novel statistical model, called multiscale adaptive regression model (MARM), for spatial and adaptive analysis of neuroimaging data. The primary motivation and application of the proposed methodology is statistical analysis of imaging data on the two-dimensional (2D) surface or in the 3D volume for various neuroimaging studies. The existing voxel-wise approach has several major limitations for the analyses of imaging data, underscoring the great need for methodological development. The voxel-wise approach essentially treats all voxels as independent units, whereas neuroimaging data are spatially correlated in nature and spatially contiguous regions of activation with rather sharp edges are usually expected. The initial smoothing step before the voxel-wise approach often blurs the image data near the edges of activated regions and thus it can dramatically increase the numbers of false positives and false negatives. The MARM, which is developed for addressing these limitations, has three key features in the analysis of imaging data: being spatial, being hierarchical, and being adaptive. The MARM builds a small sphere at each location (called voxel) and use these consecutively connected spheres across all voxels to capture spatial dependence among imaging observations. Then, the MARM builds hierarchically nested spheres by increasing the radius of a spherical neighborhood around each voxel and combine all the data in a given radius of each voxel with appropriate weights to adaptively calculate parameter estimates and test statistics. Theoretically, we first establish that the MARM outperforms classical voxel-wise approach. Simulation studies are used to demonstrate the methodology and examine the finite sample performance of the MARM. We apply our methods to the detection of spatial patterns of brain atrophy in a neuroimaging study of Alzheimers disease. Our simulation studies with known ground truth confirm that the MARM significantly outperforms the voxel-wise methods."}, {"section_title": "Introduction", "text": "Anatomical and functional magnetic resonance imaging (MRI) are powerful tools for understanding the neural development of neuropsychiatric disorders, substance use disorders, and normal brains. Specifically, anatomical MRI has been widely used to segment the cortical and subcortical structures (e.g., hippocampus) of the human brain in vivo and to generate various morphological measures of their morphology for understanding neuroanatomical differences in brain structure across different populations [1] . Functional MRI (fMRI) has been widely used to understand functional integration of different brain regions in response to specific stimuli and behavioral tasks and detecting the association between brain function and covariates of interest, such as diagnosis, behavioral tasks, severity of disease, age, or IQ [2, 3, 4] .\nMuch effort has been devoted to developing voxel-wise methods for analyzing various imaging measures including cortical thickness using numerical simulations and theoretical reasoning. The voxel-wise methods for analyzing imaging data are often sequentially executed in two steps. The first step involves fitting a general linear model (LM) (or a linear mixed model (LMM)) to imaging data from all subjects at each voxel and generating a statistical parametric map of test statistics (or p-values) [5, 6] . The second step is to calculate adjusted pvalues that account for testing the hypotheses across multiple brain regions or across many voxels of the imaging volume using various statistical methods (e.g., random field theory (RFT), false discovery rate, or permutation methods) [7, 8] . Most of these methods have been implemented in existing neuroimaging software platforms, such as SPM (http://www.fil.ion.ucl.ac.uk), among many others.\nThe voxel-wise approach based on the LM (or LMM) and RFT has several obvious limitations for the analyses of imaging data, underscoring the great need for methodological development. (i) The voxel-wise approach essentially treats all voxels as independent units [9] , whereas neuroimaging data are spatially correlated in nature and spatially contiguous regions of activation with rather sharp edges are usually expected. (ii) The initial smoothing step before the voxelwise approach often blurs the image data near the edges of activated regions and thus it can dramatically increase the numbers of false positives and false negatives [11, 12, 13, 9] . (iii) The voxel-wise approach is also based on a strong assumption that after an image warping procedure, the location of a voxel in the images of one person is assumed to be in precisely the same location as the voxel identified in another person--an assumption that is demonstrably false.\nSpatially modeling imaging data in all voxels of the 3D volume (or 2D surface) represents both computational and theoretical challenges. Spatial dependencies were commonly characterized using conditional autoregressive (CAR) or Markov random field (MRF) priors, but estimating spatial correlation for the 3D volume, in which the number of voxels ranges from ten thousands to more than 500,000 voxels, is computationally prohibited. Moreover, given the complexity of imaging data, it can be restrictive to assume parametric spatial correlation such as CAR and MRF for the whole 3D volume (or 2D surface). Another method, called ROI analysis, is to model the imaging data from all voxels within multiple regions of interest (ROIs) [14] . The ROI method based on anatomically defined ROIs only models the spatial correlation among these ROIs [14] , so it essentially ignores the spatial correlation structure in the neighboring voxels within each ROI.\nMoreover, the ROI method is also based on a strong assumption that all voxels in the same ROI are homogeneous, and this assumption is largely false.\nThis paper aims to develop and apply a multiscale adaptive regression model (MARM) for the joint analysis of neuroimaging data with behavioral and clinical variables, and then to demonstrate its superiority over the voxel-wise approach using simulated and real imaging data. The MARM is a spatial, hierarchical and adaptive procedure. The MARM builds a small sphere at each voxel and use these consecutively connected spheres across all voxels to capture local and global spatial dependence among imaging observations. The MARM also builds hierarchically nested spheres by increasing the radius of a spherical neighborhood around each voxel and combine all the data in a given radius of each voxel with appropriate weights to adaptively calculate parameter estimates and test statistics. Thus, the MARM explicitly utilizes the spatial information to carry out statistical inference, while avoiding explicitly estimating spatial correlation. The hierarchical nature of the MARM can dramatically reduce the computational complexity in computing parameter estimates. The adaptive feature of the MARM can efficiently utilize all available information in the neighboring voxles to increase the precision of parameter estimates and the power of test statistics.\nThe MARM represents a novel generalization of the propagation separation (PS) approach, which was originally developed for nonparametric estimation of regression curves or surfaces [11, 12] , in several aspects. The MARM provides a general framework for carrying out statistical inference on imaging data, whereas the PS is applied to smooth the images of parameter estimates obtained from the voxel-wise approach based on classical linear models [9] . As shown in Section 2, it is inadequate to directly use the PS approach to smooth the images of parameter estimates, which are obtained from the voxel-wise method, for most regression models, such as nonlinear regression. Compared to the parametric assumptions in the PS method for the LM, the MARM is solely based on the pseudo-likelihood function, and thus it avoids specifying any parametric distribution for imaging data. This feature is desirable for the analysis of real neuroimaging data, including brain morphological measures, because the distribution of the univariate (or multivariate) neuroimaging measurements often deviates from the Gaussian distribution [15] . We also establish the theoretical properties of the MARM, which differs substantially from those of the original PS approach, which were developed for nonparametric estimation of regression curves or surfaces based on observations from the exponential family model [12] . Particularly, we show that the MARM outperforms the voxel-wise method theoretically. Section 2 of this paper presents the MARM just described and establishes the associated theoretical properties. We establish the consistency and asymptotic normality of the adaptive estimators and the asymptotic distribution of the adaptive test statistics for the MARMs. In Section 3, we conduct simulation studies to examine the finite sample performance of the MARMs. Section 4 illustrates an application of the proposed methods in a neuroimaging dataset. We present concluding remarks in Section 5."}, {"section_title": "Multiscale Adaptive Regression Model", "text": ""}, {"section_title": "Data Structure and Model Formulation", "text": "Suppose we have 2D surfaces or 3D volumes of MRI measures and clinical variables from n subjects for i = 1, \u00b7 \u00b7 \u00b7 , n. MRI measures might be the shape representation of the surfaces of cortical or various subcortical regions, the determinant of the Jacobian matrices based on the deformation fields estimated by the registration algorithm, functional MRI signals, or diffusion tensors and their associated invariant measures, such as fractional anisotropy [1] . Clinical variables might include pedigree information, time, demographic characteristics (e.g., age, gender, height), and diagnoses, among others. Thus, for the i\u2212th subject, we ob- Our primary scientific interest in the analysis of neuroimaging data is to identify important brain regions to characterize the neural development of neuropsychiatric disorders, substance use disorders, and normal brains. Statistically, we often use {Y i,D : i = 1, \u00b7 \u00b7 \u00b7 , n} as responses and establish their association with a set of covariates x i , such as age and gender. This requires the specification of the conditional distribution of\nFor MRI measures from the cross-sectional studies, it is natural to assume the independence across all subjects, that is given by\nThus, we only need to specify p(Y i,D |X i ) for each subject. However, even for a single observation within each cluster, the number of voxels in each brain region varies from thousands to more than 500,000 voxels, and at each voxel, the dimension of Y i (d) can be univariate or multivariate, thus totaling a billion or more data points in an entire study. In addition, imaging data Y i,D are spatially correlated in nature, and thus given the large number of voxels on each brain structure, it is statistically challenging to directly model the spatial correlations among all pairs of points [14] .\nThe voxel-wise approach essentially assumes that\nwhere\nNote that we use the pseudo density to emphasize the possible misspecification of p(\ncomprises many statistical models such as the LM. For instance, for univariate measure, the LM assumes that\n2 ), and\nand the Gaussian assumption are questionable in many applications [15] . Moreover, since the voxel-wise approach does not account for the fact that imaging data are spatially correlated and contain spatially contiguous regions of activation with rather sharp edges, it may lead to the loss of power in detecting statistical significance in the analysis of imaging data.\nWe formally introduce the multiscale adaptive regression model as follows. It is first assumed that for a relatively large radius r 0 ,\nwhere N (d, r 0 ) denotes the set of all voxels in a spherical neighborhood of a voxel d with radius r 0 . That is, we can approximate the joint distribution of Y i,D by the product of the joint distributions of\nfor relatively large r 0 preserves the neighboring correlation structure in the imaging data (see the panel (a) in Figure 1 for an illustration). Moreover, since the spherical neighborhoods for all voxels are consecutively connected, equation (2) can capture a substantial amount of spatial information in the imaging data. Note that the right hand-side of equation (2) is essentially a composite likelihood [16, 17] . Second, we consider the specification of p(\nSince our primary interest is to make statistical inference about \u03b8(d), we avoid specifying spatial correlations among all the "}, {"section_title": "p({Y", "text": "where \u03c9(d, d ; h) is a weight function of two voxels and a radius h that characterizes the similarity between the data in voxels d and d . We require that \u03c9(d, d ; h) be independent of i just for simplicity. In imaging data, voxels, which are not on the boundary of regions of activation, often have a neighborhood in which \u03b8(d) is nearly constant. This assumption reflects the fact that imaging data are spatially correlated and contain spatially contiguous regions of activation with rather sharp edges. Incorporating this assumption leads to\nEquation (4) \nAt each iteration, the computation involved for the MARM is of the same order as that for the voxel-wise approach. Thus, this multiscale method provides an efficient method for adaptively exploring the neighboring areas of each voxel. Since this multiscale method sequentially includes more data at each voxel, it will adaptively increase the statistical efficiency in estimating \u03b8(d) in a homogenous region and decreases the variation of the weights \u03c9(d, d ; h). This multiscale method distinguishes MARM from the composite likelihood methods proposed in the literature [16, 17] ."}, {"section_title": "Estimation and Hypothesis Testing at a Fixed Scale", "text": ""}, {"section_title": "At a fixed scale h, we consider the weighted maximum likelihood estimates of \u03b8(d) across all voxels d \u2208 D for given weights \u03c9(d, d ; h). The weighted quasilikelihood function n (\u03b8(d); h, \u03c9) is given by", "text": "The maximum weighted quasi-likelihood (MWQL) estimate of \u03b8 i\u015d\nWe use the Newton-Raphson algorithm to calculate\u03b8(d, h) by iteratin\u011d\nwhere \u2202 \u03b8(d) and \u2202 2 \u03b8(d) denote, respectively, the first-and second-order partial derivatives with respect to \u03b8(d) evaluated at\u03b8(d, h) (t) . In practice, to stabilize the Newton-Raphson algorithm, we may approximate \u2212\u2202\nThe Newton-Raphson algorithm stops when the absolute difference between consecutive\u03b8(d, h) (t) s is smaller than a predefined small number, say 10\n\u22972 , in which a \u22972 = aa T for any vector a. Our choice of which hypotheses to test was motivated by either a comparison of brain structure across diagnostic groups or the detection of a change in brain structure across time [1] . These questions usually can be formulated as the testing of linear hypotheses about \u03b8(d)\nwhere \u03bc = R\u03b8(d), R is a r \u00d7 k matrix of full row rank and b 0 is an r \u00d7 1 specified vector. We test the null hypothesis H 0,\u03bc : R\u03b8(d) = b 0 using the score test statistic\nTo test whether H 0,\u03bc holds in all voxels of the region under study, we consider the false discovery rate (FDR) method [10] ."}, {"section_title": "Adaptive Estimation and Testing Procedure", "text": "We develop an adaptive estimation and testing (AET) procedure for MARM. (1, 2) , say c h = 1.25. At each voxel d, we calculate\u03b8(d, h 0 ) and W \u03bc (d, h 0 ) , which are the same as those from the voxel-wise approach. We then set s = 1, and h 1 = c h .\nIn the weights adaptation step (ii), we compute adaptive weights \nIn the estimation step (iii), we calculate\u03b8(d, h s ) and W \u03bc (d, h s ), which are defined in equations (7) and (10), respectively, at voxel d for the sth scale.\nIn the memory step (iv), we set\u03b8(\nwhere \nIn the stopping step (v), when s = S, we compute the p-values forW \u03bc (d, h), apply FDR to detect significant voxels and then stop, otherwise set h s+1 = c h h s , increase s by 1 and continue with the weight adaptation step (ii). The maximal step S can be taken to be relatively small, say 6, such that the largest spherical neighborhood of each voxel only contains a relatively small number of voxels compared with the whole volume.\nRemark 1. The memory step in equation (11) differs substantially from that in the PS approach [12] . Equation (11) is exactly a stochastic approximation algorithm [18] . The sequence {1/s : s = 1, \u00b7 \u00b7 \u00b7} is introduced to cancel out the noise introduced in each iteration. Putting more weight 1/s at the beginning is very appealing in imaging analysis, because use of a local approximation often decreases the estimation error in the first few steps of the procedure and starts to slowly increase the estimation error as h s gets large. In addition, compared with the memory step in the PS approach, we use the distance between\u03b8(d, h s ) "}, {"section_title": "Simulation Study", "text": "We only presented one set of Monte Carlo simulations to examine the finite sample performance ofW \u03bc (d, h) with respect to different scales h at the levels of a single voxel and an entire brain region with known ground truth.\nWe applied a simulation model to automatically simulate realistic intraindividual deformations associated with tissue atrophy or growth on brain images from two groups [19] . We chose a specified location and a fixed radius in the white matter and then simulated spherical atrophy for all 20 subjects in each group (see Figure 2 ). The growth rates for each subject in the first and second groups were generated from N (0.95, 0.01) and N (1, 0.01), respectively.\nWe used simulated deformations and images with the known ground truth to demonstrate the superiority of the MARM over the voxel-wise approach. The true deformation area was highlighted in red (see the panel (a) of Figure 2 ). We applied the MARM with c h = 1.25, S = 6 and computed the p-values ofW \u03bc (d, h) across the 3D volume at each iteration. Note that the results obtained from h 0 = 0 correspond to those from the voxel-wise approach. Our results show a clear advantage of the MARM in detecting an accurate group difference as we increase the bandwidth h of the spherical neighborhood (compare the panels (b) and (c) of Figure 2 ). We calculated the ratio of voxels within the true deformation regions, whose p-values are smaller than 0.0001. The ratios for h 0 and h 6 are 49% and 68%, respectively. That is, the MARM based on h 6 leads to 19% improvement compared with the traditional voxel-wise approach with h 0 = 0."}, {"section_title": "Real Data Analysis", "text": "Alzheimer's disease (AD) is the most common form of dementia in people over 65 years of age. MRI has been used to develop imaging-based biomarkers for AD, measure spatial patterns of atrophy, and their evolution with disease progressions. We used a subset of a large MRI dataset obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (www.loni.ucla.edu/ADNI). Our dataset includes 90 subjects, including 45 cognitively normal individuals The T1-weighted MRIs were preprocessed in six consecutive steps. These steps included (i) alignment to the AC-PC plane; (ii) removal of extra-cranial material (skull-stripping); (iii) tissue segmentation into grey matter (GM), white matter (WM), and cerebrospinal fluid (CSF) using a brain tissue segmentation method proposed; (iv) high-dimensional image warping to a standardized coordinate system, a brain atlas (template) that was aligned with the MNI coordinate space; (vi) formation of regional volumetric maps, named RAVENS maps, for GM, WM, and CSF using tissue preserving image warping.\nWe identify the spatial patterns of brain atrophy in Alzheimer's disease (AD) via the analysis of the RAVENS maps of GM and WM obtained from the ANDI dataset. To control for the effects of covariates (diagnosis, age, weight, and gender), we considered model y i (d) = x T i \u03b2 + i (d) for respective RAVENS maps at each voxel. The x i = (1, x 1i , x 2i , x 3i , x 4i ) T is a 4 \u00d7 1 vector, in which x 1i is Age/10, x 2i is gender, x 4i denotes the weight, and x 4i denotes the diagnosis (1 AD and 0 CN). We applied the AET procedure with c h = 1.25 and S = 6 to carry out the statistical analysis. Figure 2 shows a clear advantage of the MARM in detecting more significant and smoothly area for the group differences between CN and AD as the bandwidth h increases. We observed the significant difference between CN and AD in the hippocampus and the entorhinal cortex."}, {"section_title": "Discussion", "text": "We have developed the MARM for spatial and adaptive analysis of imaging data. We have used simulation studies and real data to show that the MARM significantly outperforms the classical voxel-wise approach. Many issues still merit further research."}]
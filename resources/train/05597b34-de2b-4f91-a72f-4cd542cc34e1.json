[{"section_title": "Abstract", "text": "Abstract-Neuroimaging datasets keep growing in size to address increasingly complex medical questions. However, even the largest datasets today alone are too small for training complex models or for finding genome wide associations. A solution is to grow the sample size by merging data across several datasets. However, bias in datasets complicates this approach and includes additional sources of variation in the data instead. In this work, we combine 15 large neuroimaging datasets to study bias. First, we detect bias by demonstrating that scans can be correctly assigned to a dataset with 73.3% accuracy. Next, we introduce metrics to quantify the compatibility across datasets and to create embeddings of neuroimaging sites. Finally, we incorporate the presence of bias for the selection of a training set for predicting autism. For the quantification of the dataset bias, we introduce two metrics: the Bhattacharyya distance between datasets and the age prediction error. The presented embedding of neuroimaging sites provides an interesting new visualization about the similarity of different sites. This could be used to guide the merging of data sources, while limiting the introduction of unwanted variation. Finally, we demonstrate a clear performance increase when incorporating dataset bias for training set selection in autism prediction. Overall, we believe that the growing amount of neuroimaging data necessitates to incorporate data-driven methods for quantifying dataset bias in future analyses."}, {"section_title": "", "text": "Abstract-Neuroimaging datasets keep growing in size to address increasingly complex medical questions. However, even the largest datasets today alone are too small for training complex models or for finding genome wide associations. A solution is to grow the sample size by merging data across several datasets. However, bias in datasets complicates this approach and includes additional sources of variation in the data instead. In this work, we combine 15 large neuroimaging datasets to study bias. First, we detect bias by demonstrating that scans can be correctly assigned to a dataset with 73.3% accuracy. Next, we introduce metrics to quantify the compatibility across datasets and to create embeddings of neuroimaging sites. Finally, we incorporate the presence of bias for the selection of a training set for predicting autism. For the quantification of the dataset bias, we introduce two metrics: the Bhattacharyya distance between datasets and the age prediction error. The presented embedding of neuroimaging sites provides an interesting new visualization about the similarity of different sites. This could be used to guide the merging of data sources, while limiting the introduction of unwanted variation. Finally, we demonstrate a clear performance increase when incorporating dataset bias for training set selection in autism prediction. Overall, we believe that the growing amount of neuroimaging data necessitates to incorporate data-driven methods for quantifying dataset bias in future analyses."}, {"section_title": "I. INTRODUCTION", "text": "As neuroimaging is joining the ranks of a \"big data\" science with more and larger datasets becoming available [25] , the issue of dataset bias is becoming prevalent. In general, bias refers to statistics that are systematically different from the population parameters. In a collection of unbiased datasets, similar results should be achieved by running independent analyses on each dataset and it would be straightforward to pool subjects across datasets without introducing unwanted variation. Further, models learned on one dataset would naturally generalize to other datasets. However, in practice, neuroimaging datasets are subject to various types of biases. These include subject selection, acquisition method, and processing biases. While efforts have been made and are still ongoing to improve image processing to limit the impact of dataset bias in the outcome (e.g., volume or thickness measurements), substantial bias still remains [10] , [13] , [14] , [15] , [23] .\nSelection bias stems from the fact that subjects included in the study do not represent the overall population. Examples are (i) the recruitment of particular target groups, e.g., young adults; (ii) the recruitment of a particular disease group; or (iii) an over-representation of more educated participants in convenience samples. While the first two are potentially related to the study objective and can be controlled for, the third one is more difficult to control and also seems to appear in epidemiological studies [25] . A second bias stems from the image acquisition, where magnetic field strength, manufacturer, gradients, pulse sequences and head positioning cause variations in the images. While standardization efforts are undertaken for instance by the ADNI [12] , variation related to the scanner remains [14] , and it is questionable if a further standardization is in the manufacturer's interest. Finally, there is processing bias in image segmentation and registration, which is in part related to acquisition bias. The type of segmentation method and the selected parameters can largely influence the outcome. Further, head motion, voxel size and image noise can cause bias in segmentation results.\nIn this paper, we first detect the magnitude of dataset bias present in large neuroimaging studies. Instead of trying to remove the bias, we propose to incorporate it in the analysis, which requires to quantify it first. To this end, we introduce two dataset metrics: the Bhattacharyya distance in feature space and the age prediction error for quantifying model generalization by including a variable from subject demographics. In addition to operating on the level of datasets, we also look at a more fine-grained analysis on acquisition sites. Based on the dataset metric, we create an embedding of neuroimaging sites to visualize the similarity among them. Finally, we demonstrate the benefit of composing a training set based on the dataset metric for autism prediction."}, {"section_title": "II. DATA", "text": "We work on MRI T1 brain scans from 15 largescale public datasets: ABIDE I+II [5] , ADHD200 [20] , ADNI [12] , AIBL [6] , COBRE [19] , CORR [30] , GSP [4] , HBN [1] , HCP [27] , IXI 1 , MCIC [9] , NKI [22] , OASIS [17] , and PPMI [18] . All datasets were processed with FreeSurfer [7] version 5.3. We keep only one scan per subject from longitudinal or test-retest datasets. After exclusion of scans with processing errors and incomplete meta data, we work with scans from 12,207 subjects (6,827 male; 8,126 controls; mean age: 33.5 (sd=23.9)). Demographics per dataset are reported in Table I. III. NAME THAT DATASET In order to evaluate the impact of dataset bias, we play the game Name That Dataset on neuroimaing data that was originally proposed by Torralba and Efros [26] on natural images. The task is to predict the dataset a scan is coming from solely based on image measurements. Fig. 1 illustrates the performance for classifying the 15 datasets for different image features. A random forest classifier with default settings was used for the prediction [3] . The splitting of training and testing dataset is done under consideration of the dataset. The performance of image-based classifiers increases logarithmically with the amount of training data. If no dataset bias was present, the prediction accuracy should be close to random chance (6.7% for 15 datasets). As not all datasets have the same size and have different distributions of age and sex, we compare to results of a classifier trained on age and sex as baseline. With only 0.1% of the data used for training, volume measures perform similar to prediction with meta data. As we increase the amount of training data to 70%, the accuracy increases over 73.3% for the combination of volume and thickness features, which perform better than each of them alone. Compared to 42.2% for age and sex, this illustrates that there is a strong bias in the datasets that cannot be explained 1 http://brain-development.org/ixi-dataset/ by basic demographics. We focused the analysis on selecting only healthy controls, because we thought that the inclusion of patients would facilitate the classification. However, the results are similar, as shown for the combination of volume and thickness in Fig. 1 .\nFrom the confusion matrix, we see that datasets with a similar population result in higher confusion, e.g., between ABIDE I, ABIDE II, and ADHD200. Single site datasets like HCP are very homogeneous and do therefore show almost no confusion with any of the other datasets. In contrast, multi-site datasets like CORR that also cover a wide age range, show high confusion with other datasets. Overall, however, high classification accuracy and the strong diagonal indicate that datasets possess unique, identifiable characteristics.\nThe lesson learned from this experiment is that even when working with image-derived values that represent physical measures (volume, thickness), there is still substantial bias in datasets, although techniques like atlas renormalization [11] were employed to improve consistency across scanners. Of course, much of the bias can be attributed to the different goals of the studies, like the inclusion of subjects from different age groups. However, even when focusing on datasets that cover a similar age range, we observe a high accuracy. While we are not aware of previous attempts on trying to Name That Dataset, our results echo concerns raised in previous studies. In a large ENIGMA study of over 15,000 subjects on brain asymmetry [10] , it was reported that dataset heterogeneity explained over 10% of the total observed variance per structure. On the ADNI, with an optimized MPRAGE imaging protocol across all sites [12] , the intra-subject variability of compartment volumes for scans on different scanners was roughly 10 times higher than repeated scans on the same scanner [14] . Similarly, previous studies reported on a drop of accuracy when training on different datasets [29] or working with multi-site data [21] ."}, {"section_title": "IV. QUANTIFYING DATASET COMPATIBILITY", "text": ""}, {"section_title": "A. Compatibility Metrics", "text": "Having shown the presence of dataset bias, our next aim is to define metrics that quantify their compatibility. Given data sources A and B, the metric m(A, B) expresses the compatibility among them. As first metric, we propose to compute the Bhattacharyya distance between data sources. To this end, we estimate multivariate normal distributions N A and N B , respectively, and compute the Bhattacharyya distance between them m(A, B) = d B (N A , N B ) . the distributions corresponds to the number of imagederived measures, where we use brain structure volumes in our experiments.\nAs second metric, we propose to compute the age prediction error, which includes a variable from subject demographics (age). We train an age regression model on the source set A and predict on the target set B.\nSince we know the chronological age on the target set, we compute the average mean age prediction error, \u03b5(A, B). To have a symmetric metric, we set m(A, B) = 1 2 (\u03b5(A, B) + \u03b5(B, A)). Age estimation has previously been used for modeling healthy aging and differentiating it to abnormal aging in dementia [8] , [2] and has the advantage, in contrast to other prediction tasks, that age is a commonly available variable. We use random forest regression on volume measures for the age regression. While the Bhattacharyya distance is measuring the similarity of image features, the age prediction error expresses how well one data source is suited for training a model that is deployed on a second dataset."}, {"section_title": "B. Site Embedding", "text": "To investigate the similarity across datasets, we create an embedding based on the metrics. However, many of the large neuroimaging datasets are multisite datasets, i.e., scans were acquired at different scanning sites. Some initiatives like the ADNI put major efforts in the standardization of scans across sites. Other multi-site datasets like ABIDE [5] retrospectively aggregate data that was independently acquired from laboratories around the world. To study the variation in such datasets, we perform an analysis of variance (ANOVA) on the ABIDE I dataset with age, age squared, sex, diagnosis, and site as variables. For putamen, amygdala, and nucleus accumbens, the percentage of variance explained by site is 20.9%, 23.7%, and 32.7%, respectively, while the total variance explained from all variables ranged between 32.9% to 38.7%. Site is therefore the major source of variation, several times higher than age, sex, or diagnosis. Based on these results, we will operate on the level of sites, instead of datasets, in the following.\nWe compute the metric m between all pairs of sites in our data, where we limit the analysis to sites with more than 25 subjects to have enough samples for a reliable estimation. Based on the pair-wise age prediction across all sites, we use the resulting distance matrix in t-SNE [16] for visualizing the similarity of sites. Fig. 2 shows the embedding, where the age prediction error was used as metric and the perplexity in t-SNE was set to 5. We only show results for the age prediction error in this experiment because it yielded a clearer separation of datasets. We compare both metrics in section IV-C.\nIt is striking to see that some sites are more similar to sites from other datasets than to sites from the same dataset. We observe four clusters. Cluster I contains all sites from ADNI and AIBL, representing old subjects. Cluster II consists of sites from IXI, NKI, COBRE, and OASIS, which include subjects from a very wide age range. Cluster III has younger subjects mainly in their twenties, including GSP and HCP, together with many sites from ABIDE and CORR. Cluster IV mainly contains children and adolescents, e.g., HBN and sites from ABIDE. In Fig. 3 , we show the same embedding as in Fig. 2 but with the label color according to the age. It is natural to see that the major variations are due to age, due to its predominant impact on brain morphology [24] , [28] . Within those clusters age is relatively homogeneous so that other factors like field strength and manufacturer can play a role. All in all, we believe that such an embedding of the majority of neuroimaging datasets is of great value to clarify the relationship between different datasets. In addition, it could be used to guide the combination of data from sites, while limiting the introduction of unwanted variation."}, {"section_title": "C. Incorporate Bias in Training Set Selection", "text": "We demonstrate the benefits of the compatibility metric for the classification of autism, where we only operate with the ABIDE I + II datasets because the other datasets do not contain autistic subjects. To this end, we select one site for testing and we compose the training set based on the metric m. The rationale is that sites that are close to the target site will be better suited for training a classifier than sites that are very distant. In details, we sample the training set from the source dataset that consists of all sites, except for the testing site. We encourage the selection of samples from sites that are near by setting the probability of the sample being selected proportional to exp(\u2212m (A, B) ), the negative exponential of the site metric. As baseline, we use a uniform distribution, which corresponds to random sampling. Fig. 4 illustrates the autism classification accuracy for the two largest sites in ABIDE I and ABIDE II, respectively. We observe that selecting the training set with either of the two metrics outperforms the random selection, and further that the computation of the distance with age prediction yields the best results.\nNoteworthy, the selection algorithm is driven by image measurements. This makes it on the one hand very versatile, as it can be easily applied to image archives with T1-weighted MRI scans. On the other hand, by directly operating on the output, this models all of the previously discussed biases. "}, {"section_title": "V. CONCLUSION", "text": "On a large collection of datasets with 12,207 individuals, we have illustrated that dataset bias has a strong influence on neuroimaging measures. We have quantified dataset compatibility with metrics based on the age prediction error and the Bhattacharyya distance. Computation of the metric between all pairs of neuroimaging sites enabled the creation of an embedding, which illustrated that sites across datasets can be more similar than sites within datasets. Finally, we demonstrated the advantages of incorporating dataset bias for training set selection in autism prediction, where age prediction outperformed Bhattacharyya distance. Overall, we believe that the growing amount of neuroimaging data necessitates to incorporate data-driven methods for quantifying dataset bias in future analyses. "}]
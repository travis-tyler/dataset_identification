[{"section_title": "Abstract", "text": "Species occurrence and its dynamic components, extinction and colonization probabilities, are focal quantities in biogeography and metapopulation biology, and for species conservation assessments. It has been increasingly appreciated that these parameters must be estimated separately from detection probability to avoid the biases induced by nondetection error. Hence, there is now considerable theoretical and practical interest in dynamic occupancy models that contain explicit representations of metapopulation dynamics such as extinction, colonization, and turnover as well as growth rates. We describe a hierarchical parameterization of these models that is analogous to the state-space formulation of models in time series, where the model is represented by two components, one for the partially observable occupancy process and another for the observations conditional on that process. This parameterization naturally allows estimation of all parameters of the conventional approach to occupancy models, but in addition, yields great flexibility and extensibility, e.g., to modeling heterogeneity or latent structure in model parameters. We also highlight the important distinction between population and finite sample inference; the latter yields much more precise estimates for the particular sample at hand. Finite sample estimates can easily be obtained using the state-space representation of the model but are difficult to obtain under the conventional approach of likelihood-based estimation. We use R and WinBUGS to apply the model to two examples. In a standard analysis for the European Crossbill in a large Swiss monitoring program, we fit a model with year-specific parameters. Estimates of the dynamic parameters varied greatly among years, highlighting the irruptive population dynamics of that species. In the second example, we analyze route occupancy of Cerulean Warblers in the North American Breeding Bird Survey (BBS) using a model allowing for site-specific heterogeneity in model parameters. The results indicate relatively low turnover and a stable distribution of Cerulean Warblers which is in contrast to analyses of counts of individuals from the same survey that indicate important declines. This discrepancy illustrates the inertia in occupancy relative to actual abundance. Furthermore, the model reveals a declining patch survival probability, and increasing turnover, toward the edge of the range of the species, which is consistent with metapopulation perspectives on the genesis of range edges. Given detection/non-detection data, dynamic occupancy models as described here have considerable potential for the study of distributions and range dynamics."}, {"section_title": "INTRODUCTION", "text": "Species distribution and patch occupancy are fundamental concepts in biogeography, landscape ecology and metapopulation biology and are also of considerable interest in the conservation and management of animal and plant species. Moreover, studies of factors that influence occurrence and distribution, such as habitat or landscape structure, are the focus of many ecological investigations. However, in surveys of most species it is not possible to observe occurrence without error. That is, a species may go undetected where it is present yielding a false negative (detection) error. For instance, in breeding bird surveys in North America and Switzerland, only ;76% and 89%, respectively, of all avian species present were estimated to be detected in a year (Boulinier et al. 1998b, Ke\u00b4ry and Schmid 2006) . Thus, explicit attention to imperfect detection in animal sampling is necessary in order to obtain summaries of occurrence or distribution that have a clear conceptual interpretation. The problem of estimating occurrence probability, proportion of area occupied, or ''site occupancy,'' of a species subject to imperfect detection is a problem that has received considerable attention recently (Bayley and Peterson 2001 , Ke\u00b4ry 2002 , Mac-Kenzie et al. 2002 , Nichols and Karanth 2002 , Royle and Nichols 2003 , Tyre et al. 2003 , Wintle et al. 2003 , Gu and Swihart 2004 , Pellet and Schmidt 2005 , Royle and Link 2005 , Schmidt 2005 , Weir et al. 2005 . Site occupancy models are becoming widely adopted in Manuscript received 21 April 2006; revised 17 November 2006; accepted 6 December 2006. Corresponding Editor: F. He. 3 E-mail: aroyle@usgs.gov many survey and monitoring activities due to, at least in part, the ease of establishing surveys based on presence/absence (or rather, detection/non-detection) data, that such models facilitate an explicit accounting for detectability of the species in question, and the extensibility of the site occupancy modeling framework. In addition, site occupancy models can be used as a framework for estimating or modeling abundance either in a model-based framework Gaston 2000a, b, Royle and or if the area of sample units approximates the home range of individuals. This greatly extends the range of their application. A basic class of models can be developed (e.g., MacKenzie et al. 2002) under the assumption that the occupancy status of sample sites does not change across replicate (temporal) samples, i.e., that sites are closed to local extinction and colonization events. While such models are sufficient for many applications, there exists considerable interest in dynamic attributes of metapopulations. For example, colonization and extinction are central to metapopulation theory (Hanski 1999) and overlap and turnover are important summaries of community similarity and stability , b, Doherty et al. 2003a . Thus, one important extension of the site occupancy modeling framework is to the situation in which a site's occupancy status may change through time, i.e., to the situation in which the metapopulation system is ''open'' to local extinction and colonization events. MacKenzie et al. (2003) provided a general characterization of open models, and described a likelihood-based framework for inference about model parameters. Under these open models, the metapopulation system is assumed to be closed within, but not across primary periods. The primary periods have been colloquially referred to as ''seasons,'' and the models are commonly referred to as ''multi-season'' occupancy models. Here we adopt the adjective dynamic as being more descriptive because it reflects the fact that the models explicitly incorporate the metapopulation dynamical processes of extinction and colonization. Conversely, the term ''multi-season'' can equally well apply to a model that does not explicitly acknowledge these dynamic processes, i.e., one that has a time-varying occupancy probability, in which occupancy status is assumed to be independent across time.\nIn this paper, we describe a hierarchical, or statespace, representation of dynamic models for site occupancy in which the model for the observed detection/non-detection data is expressed as the product of two component models, first a submodel for the data conditional on the latent (unobserved or partially observed) process, and, secondly, a submodel for the latent occupancy process. We refer to this representation of the model as the state-space representation, as it is conceptually equivalent to that found in time series and similar settings (Jones 1993 , Berliner 1996 .\nWhereas classical likelihood-based solutions to the problem (e.g., MacKenzie et al. 2003 ) carry out inference by removing the latent state process from the model by marginalization, we retain the state process as this representation yields itself naturally to several important extensions, such as the incorporation of random effects to accommodate spatial or temporal variation and structure in model parameters. In addition, inference in many applications of site occupancy models does not focus on some larger statistical population of sites, but rather on the particular sample of sites at hand. This is an instance wherein estimation of finite sample quantities is of interest, and it has perhaps not been widely appreciated in the ecological community that this is an inference problem distinct from the estimation of the parameters in a larger population. Explicitly accounting for a finite sample results in greatly improved precision of estimators and is easily achieved with a state-space formulation of dynamic occupancy models. While we believe this hierarchical representation of dynamic site occupancy models yields a more general formulation of such models, it is also a simple and natural way to express the models, and a Bayesian analysis of the hierarchical parameterization can be achieved directly with popular software for Bayesian analysis (WinBUGS).\nWe provide examples using avian survey data from the Swiss Survey of Common Breeding Birds, and an example with North American Breeding Bird Survey (BBS) data on Cerulean Warblers in which the model allows for spatial heterogeneity in parameters among sites. While such models have great biological appeal, they have not been explicitly addressed in the literature because of the absence of a practical framework for the analysis of these complex models. Therefore, we also include scripts to fit several versions of our models using freely available software."}, {"section_title": "SAMPLING DESIGN AND THE DYNAMIC MODEL", "text": "We consider data obtained from repeated presence/absence surveys of i \u00bc 1, 2, . . . , R spatial units (patches or ''sites''). We suppose that each site is surveyed j \u00bc 1, 2, . . . , J times within each of t \u00bc 1, 2, . . . , T primary periods and that each site is closed with respect to its occupancy status within but not across primary periods. A typical case would be surveys repeated several times both within the breeding season of a species and over several years. This situation is that for which the ''robust design'' (Pollock 1982 , Kendall et al. 1995 , Williams et al. 2002 has been developed in conventional capture-recapture applications, and has also been exploited by MacKenzie et al. (2003) for developing site occupancy models for open populations.\nDenote the observed occupancy status of site i for survey j within primary period t as y j (i, t). We suppose that y j (i, t), j \u00bc 1, 2, . . . , J are independent and identically distributed for each site (i) and primary period (t). Let z(i, t) denote the true occupancy status of unit i during primary period t, having possible states ''occupied'' (z \u00bc 1) or ''not occupied'' (z \u00bc 0). One parameter of interest is the probability of site occupancy (or the probability of occurrence) for period t, w t \u00bc Pr(z(i, t) \u00bc 1). Changes in occupancy over time can be parameterized explicitly in terms of local extinction and colonization processes, analogous to population demographic processes of survival and recruitment. Let / t be the probability that an occupied site ''survives'' (i.e., remains occupied) from period t to t \u00fe 1, i.e., / t \u00bc Pr(z(i, t \u00fe 1) \u00bc 1 j z(i, t) \u00bc 1). Local extinction probability (e t ) in the parameterization used by MacKenzie et al. (2003) , is the complement of / t , i.e., e t \u00bc 1 \u00c0 / t . In metapopulation systems, local colonization is the analog of the recruitment process. Let c t be the local colonization probability from period t to t \u00fe 1, i.e.,"}, {"section_title": "State-space representation", "text": "This model is naturally formulated as a state-space model, in which we express the model by its two component processes: a submodel for the observations conditional on the unobserved state process, i.e., y (i, t) j z(i, t) and, secondly, a submodel for the unobserved or partially observed state process z(i, t); i \u00bc 1, 2, . . . , t \u00bc 1, 2, . . . . The classical likelihood formulation of this problem exploits an identical model structure, but removes the latent indicators of occupancy from the likelihood by integration. In adopting a Bayesian framework for analysis and inference (described in Bayesian Analysis), retention of the latent variables in the model does not pose any difficulty. This is attractive since for many inference problems, retaining the latent z(i, t)'s in the model is necessary because they are fundamental to the object of inference. Discussion of specific examples when this is the case is given in Metapopulation summaries, below.\nState model.-The state model has a simple formulation in terms of initial occupancy probability, i.e., at t \u00bc 1, which we will designate w 1 , local survival probability, / t f g T\u00c01 t\u00bc1 , and the recruitment (colonization) parameters c t f g T\u00c01 t\u00bc1 . The initial occupancy states are assumed to be iid Bernoulli random variables, denoted as\nwhereas, in subsequent periods z\u00f0i; t\u00dejz\u00f0i; t \u00c0 1\u00de\n; Bernoulli z\u00f0i; t \u00c0 1\u00de/ t\u00c01 \u00fe \u00bd1 \u00c0 z\u00f0i; t \u00c0 1\u00dec t\u00c01 f g \u00f02\u00de\nfor t \u00bc 2, 3, . . . , T. Thus, for a site that is occupied at t \u00c0 1 (i.e., z(i, t \u00c0 1) \u00bc 1), the survival component in Eq.\n2 is operative (the first component of the Bernoulli success probability), and z(i, t) is a Bernoulli outcome with probability / t\u00c01 . Conversely, if a site is not occupied at time t \u00c0 1, then the recruitment component in Eq. 2 becomes operative and z(i, t) is a Bernoulli outcome with parameter c t\u00c01 . The expressions in Eqs. 1 and 2 define the state process model. Generalizations, where / and c may be structured spatially or temporally, for instance, are described later.\nObservation model.-The observation model, specified conditional on the latent process fz(i, t)g, is given by y j \u00f0i; t\u00dejz\u00f0i; t\u00de ; Bernoulli\u00bdz\u00f0i; t\u00dep t :\nThus, if a site is occupied at time t, the data are Bernoulli trials with parameter p t . If a site is unoccupied at time t, then the data are Bernoulli trials with Pr( y(i, t) \u00bc 1) \u00bc 0. Obvious generalizations to accommodate structure in p can be obtained directly. For example, in many applications, sampling covariates are measured during each survey such as search effort, weather, or other environmental conditions. In this case, the observation model is Bernoulli with index z(i, t)p it and covariate effects are modeled on a suitable transformation of p it ."}, {"section_title": "Metapopulation summaries", "text": "The primary parameters of the dynamic occupancy model are the initial occupancy probability, w 1 , the survival probabilities / t f g T\u00c01 t\u00bc1 , the colonization probabilities c t f g T\u00c01 t\u00bc1 and the detection probabilities fp t g. In addition, a number of derived parameters are of interest. First of all, the occupancy probability at t can be computed recursively according to\nfor t \u00bc 2, . . . , T. MacKenzie et al. (2003) defined the growth rate as\nNichols et al. (1998a) define ''turnover'' as ''the probability that an occupied quadrat picked at random is a newly occupied one.'' That is, turnover is the probability Pr(z(t \u00c0 1) \u00bc 0 j z(t) \u00bc 1). Bayes' rule yields an expression for this in terms of previously defined model parameters:\nfor t \u00bc 2, . . . , T. The denominator here is equal to w t , by Eq. 3. One useful summary of the dynamical system is the equilibrium occupancy probability (Hanski 1994 , MacKenzie et al. 2005 Brander et al 2007) , i.e., the stable-state (occupancy) distribution. This is related to local survival and colonization according to\nThis is the leading element of the dominant eigenvector of the state transition matrix. When c and / are year specific, the associated collection of year-specific values of w eq provide a convenient summary of occupancy dynamics, e.g., w \u00f0eq\u00de t\u00fe1 =w \u00f0eq\u00de t summarizes the change in equilibrium occupancy as a result of the change in survival and colonization from t to t \u00fe 1."}, {"section_title": "Finite sample estimation", "text": "It is perhaps not widely understood that there is a distinction between estimation of population parameters (e.g., the probability that a site is occupied, occupancy), and estimation of finite-sample manifestations of those quantities such as the number of occupied sites in the actual sample Royle 2005, MacKenzie et al. 2005 : section 4.5).\nSite occupancy parameters, w t , as defined previously, are population averages and associated estimates apply to a theoretically infinite population of sites from which the sample of size R was drawn. However, given a sample of R sites, the actual proportion of sample sites occupied is a function of the latent state variables:\nwhere ''fs'' is for finite sample. While the expected values of the two quantities may be equivalent, the uncertainty of the point estimates will typically be very different (we demonstrate this in an example, below). Finite-sample equivalents of occupancy or of other quantities can easily be computed as functions of the state-variables, z, whereas estimation of such quantities is difficult in the conventional framework of MacKenzie et al. (2002 MacKenzie et al. ( , 2003 . For example, the estimator of sample growth rate is\nand the sample turnover rate is\nOne of the main benefits of the state-space parameterization of occupancy models is that it permits the construction of these finite-sample estimators, as functions of the latent z(i, t) variables. That some of the z(i, t) are unobserved does not pose any difficulty in estimating w \u00f0fs\u00de t and related quantities using common methods of Bayesian analysis based on Markov chain Monte Carlo (MCMC). Using MCMC, one obtains a Monte Carlo sample of each model parameter, and each latent variable, from the target posterior distribution. The Monte Carlo samples are then used to obtain the desired summaries of the posterior distribution, such as the mean, standard deviation, or quantiles used to construct confidence intervals. Details are provided in Estimation by Markov chain Monte Carlo. Conversely, estimation and inference of these finite-sample estimands is difficult using conventional likelihood-based methods. Typically, one must resort to empirical Bayes estimators of such quantities (Dorazio and Royle 2005) .\nThe distinction between w t and w \u00f0fs\u00de t has to do primarily with the scope of inference. If one is interested in the particular sites for which data were collected, then the estimator should be the finite-sample estimator of the proportion of occupied sites. Conversely, if one is interested in a (much) larger collection of sites from which the sampled sites are representative (e.g., randomly selected), then the estimator w t is appropriate. While the distinction may seem subtle or esoteric, there can be very important consequences. If the scope of inference is restricted to the sites for which data are available, we can expect the variance of the estimate of the proportion of occupied sites to be much smaller because some of the occupancy state variables were observed, and they do not contribute to the variance of the estimated total (number of occupied sites). In other words, in Eq. 5, some of the z(i, t) are known (i.e., at sites where the species was observed) and so the variation of this quantity is less than that of R independent Bernoulli trials. This problem of estimating sample quantities is analogous to classical small-area estimation and the estimation of random effects common throughout statistics (Laird and Ware 1982, Robinson 1991) .\nIn European Crossbill: Variation among years we illustrate the distinction between population quantities and their finite-sample manifestations with a brief example using data on the crossbill from the Swiss Survey of Common Breeding Birds."}, {"section_title": "BAYESIAN ANALYSIS", "text": "The simple conditional specification of the dynamic site occupancy model yields easily to Bayesian analysis using conventional methods of Markov chain Monte Carlo (MCMC). MCMC implementation can be achieved using Gibbs sampling (Geman and Geman 1984) , which is based on drawing samples of each unknown quantity (i.e., parameters and latent variables) from their ''full-conditional'' distributions, i.e., the distribution of a parameter conditional on all other unknown quantities and the data. For the dynamic occupancy models, the Gibbs sampler is remarkably simple when certain natural prior distributions are used. Details are provided in the Appendix for the case where survival and colonization probabilities are allowed to vary by primary period. For the applications described subsequently, we use the freely available software package WinBUGS 1.4. (Gilks et al. 1994) to conduct the analyses, and we provide the WinBUGS model specification for those examples."}, {"section_title": "Implementation in WinBUGS", "text": "While the simple structure of the MCMC algorithm outlined in the Appendix is potentially useful, in practice, the dynamic model can be implemented easily in the popular software package WinBUGS, with little more effort required than providing a ''pseudo-code'' description of the model. For example, the WinBUGS model specification for a model in which all parameters vary by year, say fw 1 , p t , / t , c t g, is given in the Supplement, along with code for calculation of the yearspecific occupancy probabilities, growth rates, and also the (finite) sample occupancy rates.\nFor the analysis in the example of the next section, the data were organized in the free software package R version 2.2 (Ihaka and Gentleman 1996, R Development Core Team 2005) and WinBUGS 1.4 was executed in batch mode using the R add-on library R2WinBUGS."}, {"section_title": "APPLICATIONS", "text": "We provide two examples of dynamic site occupancy models. First is a basic example, part of which could as well be done by conventional likelihood methods in the widely used programs PRESENCE or MARK. Secondly, we provide a more complicated example for which likelihood analysis is not straightforward. We consider an occupancy analysis of Cerulean Warblers (Dendroica cerulea) from the North American Breeding Bird Survey (BBS) using models in which demographic parameters are regarded as spatially and temporally varying random effects."}, {"section_title": "European Crossbill: Variation among years", "text": "We consider data from the Swiss Survey of Common Breeding Birds (Monitoring Ha\u00a8ufige Brutvo\u00a8gel; MHB) over four years (2001) (2002) (2003) (2004) for the European Crossbill (Loxia curvirostra). This program has been conducucted annually since 1999 by the Swiss Ornithological Institute (Schmid et al. 2004 , Ke\u00b4ry et al. 2005 , Ke\u00b4ry and Schmid 2006 . A systematic random sample of 267 1-km 2 quadrats across Switzerland is surveyed three times during the breeding season (15 April-15 July) on a quadrat-specific, irregular, transect route averaging 5 km using the territory mapping method (Bibby et al. 1992) . The Crossbill is a medium-sized (34 g) pine-seedeating finch widespread in Switzerland. Its abundance and occurrence depend greatly on the cone set of conifers, and in mast years, Crossbills appear irruptively in many regions where otherwise they do not occur or are scarce. This species may have the greatest dynamics in site occupancy among all regular Swiss breeding birds.\nWe fitted the model in which each of site survival rate, colonization and detection probability were year specific, and computed the year-specific occupancy, growth, and turnover rates. The WinBUGS model specification is given in the Supplement. Posterior summaries were based on 20 000 MCMC iterations after discarding 2000 samples as ''burn-in.'' The canonical parameter estimates and certain derived parameters, as well as both population and finite sample occupancy estimates are given in Table 1 .\nThere were large interannual changes in Crossbill occupancy in Switzerland with strong growth between 2001-2002 and 2002-2003 The high turnover rates confirm the highly erratic occupancy pattern of the Crossbill. Detection probability, p, did not change much across years, and this insight might be useful in the interpretation of surveys that do not correct for variations of detection probability. These results indicate that in the Swiss program, the number of quadrats found occupied by the crossbill may be a somewhat valid index to true occupancy by that species. Note: For the column headings, q x is the 100 3 xth percentile of the posterior distribution.\nIn comparing the annual estimates of w t for the four years, along with the estimated proportion of sample sites occupied (i.e., w \u00f0fs\u00de t ), we note that the point estimates are equivalent (to within Monte Carlo error), though this need not generally be the case when the posterior distribution of these quantities is asymmetric. The main difference is that the finite-sample estimates are typically about 50% more precise, e.g., the 95% posterior interval for w 1 is (0.190, 0.300), whereas the interval for w \u00f0fs\u00de 1 is (0.222, 0.271). In Table 2 , we have also provided both estimates of turnover: the population estimate s t , in Eq. 4, and also the finite population estimator, s \u00f0fs\u00de t given by Eq. 7. As before, the finitesample point estimate is not very different from the population analog, but it is much more precise."}, {"section_title": "Cerulean Warblers: Heterogeneity among sites", "text": "Here we consider data on Cerulean Warbler (Dendroica cerulea) from the North American Breeding Bird Survey (BBS) using 40 years of data , and 446 BBS routes covering substantially all of the Cerulean Warbler range. For more details on the species and the data see Link and Sauer (2002) and Thogmartin et al. (2004) and the references therein. Cerulean Warblers are experiencing population declines throughout most of their range and there has been considerable attention focused on assessing the nature and cause of such declines. Here, we develop a model of route level occupancy. Following Boulinier et al. (1998b) and Nichols et al. (1998a, b ) (among others), we use detection/non-detection observations at the observation level which yields 50 replicate observations (subsamples) per route. The use of spatial subsamples as replicates yields a definition of occupancy as a route-level attribute (Nichols et al. 1998a, b) , i.e., relevant to the aggregation of spatial subsamples.\nModels with so-called ''individual heterogeneity'' are of some interest in classical population size estimation problems (Dorazio and Royle 2003) , and have been considered also in the context of site occupancy models (Royle 2006) . In the present situation, we expect that heterogeneity in parameters among sites should exist due to geographic variation in abundance across the species' range. For example, survival probability should be higher in regions of relatively higher abundance. The abundance-induced mechanism underlying heterogeneity (and also correlation among parameters) was also used in multi-species occupancy by Dorazio and Royle (2005) . Various other ecological hypotheses could be developed that imply structure among parameters of the model. Indeed, a recent focus in metapopulation studies has been on the spatial structuring of metapopulations (Gonza\u00b4lez-Meg\u0131\u00b4as et al. 2005 , Johnson 2005 .\nWe consider a model for the Cerulean Warbler data which allows for heterogeneity among sites in all model parameters (detection, survival, and colonization probabilities), in addition to fixed year effects. Specifically, we suppose that\nwhere (u i , v i ) are the site effects, assumed to be normal with standard deviations r / and r c . The parameters a t and b t are the fixed year effects for each year interval t \u00bc 1, 2, . . . , T \u00c0 1. The observation model is y j \u00f0i; t\u00dejz\u00f0i; t\u00de ; Bernoulli\u00bdz\u00f0i; t\u00dep i;t and we have assumed a similar site and year-effects structure on the logit-transform of p i,t . Specifically, the logit-transformed p i,t is additive in year and site effects:\nwhere c t are the fixed year effects and w i ; Normal(0, r 2 p ). For the fa t , b t , c t g parameters, we assume priors that are customarily regarded as being suitably vague. Specifically, logit \u00c01 (a t ) ; Uniform(0, 1), and similarly for b t and c t . Standard inverse-gamma priors were assumed for the inverse of all variance components. The WinBUGS model specification is given in the Supplement.\nThe MCMC algorithm was used to obtain 100 000 posterior draws of model parameters after a 10 000 burn-in period. Every third draw was retained for summarization. Posterior summaries of some model parameters are displayed in Table 2 . In this table, the year-specific parameters a t and b t are summarized by their inverse-logits, e.g., / \u00c3 t \u00bc expfa t g/(1 \u00fe expfa t g), for Notes: For the column headings, q x is the 100 3 xth percentile of the posterior distribution. For parameters that are year specific, the minimum, median, and maximum values are given. The realized change in occupancy from year t to t \u00fe 1 is k \u00f0fs\u00de t .\nthe minimum, median, and maximum values of a t across the 39 annual periods.\nThe network of sampling locations, when viewed as a metapopulation, is characterized by very high survival probabilities across years (/ \u00c3 med \u00bc 0.874), relatively low colonization probabilities (c \u00c3 med \u00bc 0.321), but considerable spatial heterogeneity (among routes) in both survival (Fig. 1) and colonization probability (Fig. 2) . Annual changes in occupancy as measured by the sample growth rate (Eq. 6) were fairly stable. Disregarding the first six years which were highly variable and imprecise due to small sample sizes, occupancy growth rate has ranged from 0.851 (1997) to 1.174 (1981) with the median growth rate of 0.99 occurring in 1973. There appears to be little systematic change in occupancy on the sample of 446 BBS routes. This suggests that the distribution or range of Cerulean warblers is fairly static which is not necessarily inconsistent with previous findings that the ''average count'' is decreasing throughout most of the Cerulean range Sauer 2002, Thogmartin et al. 2004 ). This is apparently not being accompanied by a contraction in apparent range (when range is determined by the collection of BBS routes).\nThe posterior probability of detecting Cerulean Warblers on a hypothetical ''new'' route, given that the route is occupied, was computed for each year from 1 \u00c0 (1 \u00c0 p t ) 50 , where p t is obtained by integrating the expression\nover the posterior distribution of c t and also the posterior predictive distribution of w i , which is Normal(0, r 2 p ). The resulting posterior means are depicted in Fig. 3 .\nWe note that the detection probability has declined over time, from about 0.85 in 1966 to 0.55 in 2005, consistent with decreasing average local population sizes under the model described by Royle and Nichols (2003) .\nIt is the ecologists' never-ending passion to explain such variation as depicted by Figs. 1 and 2 explicitly. Models allowing for spatial heterogeneity can help elucidate metapopulation effects. For example, the mean across years of the 446 site-specific survival probabilities (/ it ) are plotted as a function of distance from the center of the range in Fig. 4 (top panel) . The corresponding plot of site-specific colonization (omitted) was less pronounced. This structure is manifest also in the derived parameters, yielding a corresponding increase in turnover probability (Fig. 4, lower panel) toward the periphery of the range. These observations are consistent with niche centered notions about the determination of ranges. At the range edge conditions may not allow a positive population growth rate (Crozier 2004) , and this may also be associated with lower survival and greater turnover of occupied areas (Mehlman 1997) . The turnover result is also consistent with that reported by Doherty et al. (2003a) and Karanth et al. (2006) (see Discussion) ."}, {"section_title": "DISCUSSION", "text": "Occupancy and distribution are important state variables in biogeography, metapopulation biology, landscape ecology, and conservation biology. In addition, the components of change in occupancy, i.e., probabilities of colonization and survival, and derived quantities such as rates of growth or turnover are all a primary focus in many such studies. However, a pervasive problem in all such studies is our acute inability to observe occupancy status of patches or spatial sample units free of error. It has been shown (Moilanen 2002 ) that zero detection error of occupancy is the most critical assumption for metapopulation models and is also essential for habitat suitability and other species distribution models (Gu and Swihart 2004) . A likelihood-based framework for modeling occupancy dynamics (local extinction, colonization) in the presence of imperfect detection was described by MacKenzie et al. (2003) .\nIn this paper, we propose a natural and more general state-space formulation of dynamic occupancy models. In this formulation, the model is described by two component models: one for the latent (unobserved, or only partially so) occupancy state variable (the ''process model'') and another for the observations conditional on the state variable (the ''observation model''). Both constituent models have remarkably simple forms, yielding a clear segregation of parameters governing ecological processes of interest from those which are responsible for dealing with nuisance sampling artifacts. The resulting conditional probability structure of the state-space formulation is ideally suited for Bayesian analysis, and implementation of these models is easily achieved in the freely available software package Win-BUGS.\nThe state-space formulation of the model yields several important inferential advantages over the likelihood-based approach described by MacKenzie et al. (2003) . First, it yields a generic, flexible and practical framework for modeling individual (''site'') effects, or other latent structure in parameters (e.g., random year effects), in dynamic occupancy models. Similar problems are of some interest in more conventional demographic models (Burnham and Rexstad 1993 , Cam et al. 2001 , 2004 of animal populations, but flexible and practical solutions to the analysis of such models have proven to be elusive.\nSecond, although the main object of inference may be the parameters of the process model (i.e., local extinction and colonization probabilities), sometimes summaries of the partial realization of the latent process itself will be of interest. One example is the number of occupied sites from among those that were sampled, a summary that is distinct from the site occupancy parameter, the distinction being that of random variables and realizations of random variables. There can be a large difference in precision between estimators of population parameters, and those of sample occupancy summaries, with sample quantities typically being estimated more precisely. The distinction between the population and finite-sample quantities has generally been disregarded in the literature, both in the development of methods, and also applications where the distinction might be important. The finite-sample estimator would generally be preferred when the number of sample sites is small, or the sample constitutes a large fraction of available sites, or when their selection was non-random, arbitrary, or opportunistic such that they are not representative of the population of potential sample sites. In this case, generalizing the inference to a large, theoretically infinite, population might be unwarranted, whereas interpreting the sample occupancy as a detection-bias adjusted ''index'' to metapopulation structure might be adequate for some practical purposes.\nFinally, the state-space approach generalizes recent advances in species distribution models. Hierarchical models have recently been described for analysis of species distributions (e.g., for an example with plants see Latimer et al. [2006] ), where the true occupancy and detection in response to variations in sampling effort are dealt with at different levels of the hierarchy of a spatial model. These models outperformed more conventional, non-spatial and non-hierarchical models such as GLMs and GAMs in terms of the prediction of observed occurrences. The model framework we describe here generalizes in two dimensions these static occupancy models. First, variation in sampling intensity is modeled explicitly via incorporation of detection probability and hence, not relative but absolute patterns in occurrence are modeled. And second, the dynamic process of colonization and extinction that is at the root of any change in occupancy patterns can be studied directly. In addition, all advantages of hierarchical models (Latimer et al. 2006 ) such as spatially correlated random effects for the parameters can be incorporated as well.\nAnalysis of quadrat occupancy dynamics over four years for the Crossbill fully confirmed the erratic population dynamics of that species and enabled to decompose the overall changes in occupancy into contributions of patch survival and patch colonization probability. We note here that the crossbill does not display a classical metapopulation where patches are separated by unsuitable or inferior habitat. Instead, it could perhaps be called a sampling metapopulation, that is, spatially separate samples are drawn from a more or less continuous distribution. Therefore, the scope of inference would be the population of all possible quadrats and in the crossbill example, the population estimates for occupancy and dynamic parameters are more appropriate than the finite sample estimates of these quantities. However, for instance in the case of a classical metapopulation consisting of an amphibian occupying a series of ponds, the desired scope of inference might be exactly this set of ponds. Consequently, use of the finite sample estimators for these quantities would bring great benefits in terms of precision.\nIn the Cerulean Warbler, we found fairly low turnover in general. That the range extent is rather static contrasts with the earlier finding of a population decline Sauer 2002, Thogmartin et al. 2004) . It may indicate that most of the decline has taken place at high density areas in the interior of the range. This pattern has been found for a majority of declining American bird species (Rodriguez 2002) . From a survey design standpoint, it shows that abundance is more sensitive to population changes than occupancy. In addition, there was greater instability in site occupancy, i.e., declining survival probabilities and increasing turnover, toward the range edge. This result is consistent with findings by Doherty et al. (2003a) and Karanth et al. (2006) , who both used methods that account for imperfect species detection. For example, Doherty et al. (2003a) found that, for groups of species classified as being interior or edge-ofrange, local extinction probabilities (among species) were higher at the edges than the interiors. They also noted that such differences are artificially magnified if imperfect detection is not taken into consideration in the estimation. The distinction of our study, however, is that we demonstrate this result ''organically,'' i.e., by fitting a model to the particular species in question. Both Doherty et al. (2003a) and Karanth et al. (2006) generate replication by defining a pool of species that are all assumed to have the same survival and colonization probabilities. More specifically, the community dynamics modeling problem is represented as a conventional population capture-recapture problem, wherein species identity takes the role of an individual animal. The model used by them for estimation allows for heterogeneity in detection probability among species (so-called ''model M h ''). Our result also concurs with a similarly greater variability in abundance at the edge of ranges (Williams et al. 2003) . Altogether, these patterns provide support for a metapopulation view of range limits (Lennon et al. 1997, Holt and Keitt 2000) .\nThe state-space formulation of dynamic occupancy models yields a flexible and practical framework for modeling spatial and temporal variation in occupancy dynamics. Analysis of these models is easily implemented in the freely available software WinBUGS. We believe that where multi-year detection/nondetection data are available, dynamic occupancy models as described here have an enormous potential for the study of distributions and range dynamics of animals, plants and diseases."}]
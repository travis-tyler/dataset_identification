[{"section_title": "Abstract", "text": "We present an Alzheimer's detection study based on a global shape description of hippocampal surface models. With global descriptors forming our bag of features, Support Vector Machine classification of 49 Alzheimer(AD) and 63 elderly control subjects yielded 75.5% sensitivity and 87.3% specificity with 82.1% correct overall in a leave-one-out test. We show that our description contributes new information to simpler shape measures. Armed with a rigid shape registration tool, we also present a way to visualize variation in global shape description as a local displacement map, thus clarifying the descriptors' anatomical meaning. V V C 2009 Wiley-Liss, Inc."}, {"section_title": "INTRODUCTION", "text": "Variation of hippocampal shape is known to correlate with some neurodegenerative diseases. This fact has motivated several approaches to quantifying hippocampal shape in anatomical studies. Since we think of an object's shape as separate from size, position and orientation, shape quantification must be made invariant to these factors. Generally, two approaches have been used.\nIn the first of these, shape measures are tied to particular locations on the hippocampus (Yushkevich et al., 2006) , (Styner and Gerig, 2001 ). These methods lend themselves to immediate visualization. It is easy to see which regions of the shape contain meaningful variation. The disadvantage of this approach is the need to normalize the data with respect to those factors that are not intrinsic to shape. In other words, one must first bring hippocampal models into register and align them in space. This normalization step introduces additional noise to the data. Also, in recent years a great multitude of ways to spatially register shapes has been developed and each one can lead to a slightly different result.\nIn the second approach, a global shape description is used instead. Examples of this include spherical moments, spherical harmonics, etc. (Kazhdan et al., 2003; Niethammer et al 2007) . Although these measures are entirely intrinsic to the object's shape and require no registration, it is usually not possible to reconstruct a surface from them or relate them to particular regions where the variation occurs. For this reason they have not been widely used in anatomical studies since their inception.\nThe present study combines these two approaches. The first part presents global shape description as a viable alternative in detecting Alzheimer's disease (AD). The second shows a way to visualize meaningful variation in global description locally. We base our description on invariant properties of spherical harmonics (SPH). Such a description has already been proposed in the graphics community (Kazhdan et al., 2003) and prior hippocampal anatomy studies (Gutman et al., 2007) . To validate our description's ability to discriminate between patients and controls, we use a linear Support Vector Machine (SVM) classifier with leave-one-out testing. Finally, taking those features of our description which are most effective in separating patients from controls, we reconstruct each hippocampal model from a mixed spherical harmonic spectrum. In this mixture, only those components which are selected for SVM are kept from the original individual model, while the rest are taken from the population's average shape. By analyzing local distance between the average shape and each mixed reconstruction, we detect regions of the hippocampal shape most affected by the selected global descriptors."}, {"section_title": "MATERIALS AND METHODS", "text": ""}, {"section_title": "Data", "text": "Our data set consists of 112 1.5T T1-weighted magnetic resonance imaging (MRI) scan images from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database, with 49 AD patients and 63 controls, age and gender-matched (mean age: 76.14, 76.76, P 5 0.609). Initially, structural MRI images are automatically converted into binary hippocampal masks with the help of the recent Auto Context Model (Morra et al., 2008) . ACM uses a few hand-traced hippocampi as a training set for AdaBoost to create a voxel-level classification function. We then convert the masks to a signed distance function and apply topology-constrained mean curvature flow following Han's topologypreserving geometric deformable model algorithm (Han et al., 2003) . Following triangle mesh extraction and minor processing (Garland and Heckbert, 1997) , a quick visual check is done on each mesh to ensure that the original masks correspond to a hippocampal shape."}, {"section_title": "Global Description", "text": "After extracting triangle mesh models of our hippocampi, we generate an invariant description of each shape. This generation consists of three steps: (1) spherical conformal parameterization following (Gu et al., 2004) , (2) computing SPH coefficients of each surface with the help of a spherical FFT (Healy et al., 1996) , (3) computing shape invariants from SPH coefficients.\nTo preserve rotational invariance of our description we require that the spherical parameterization map a rotated object onto a sphere such that the new spherical image is a rotated version of the original (these two rotations needn't be the same, although they usually are.) This is the motivation for choosing the global conformal map. Once spherically mapped, the surfaces are represented by the three inverse maps f x , f y , f z : S 2 ?R. Spherical harmonics are functions f : S 2 ? C which form a countable orthonormal basis for square-integrable functions on the sphere; they are expressed explicitly as It is easy to show that such a descriptor is invariant to rotation if one also assumes the rotation-preserving property of the spherical map above (Gutman et al., 2008b) . By setting the zero-order coefficient to zero we achieve translational invariance. Essentially, the l-th shape descriptor is the L 2 norm of the Euclidean distance from the surface to the average value (fx(0,0), f\u0177(0,0), f\u1e91(0,0)) of the spherical map, projected onto the l-th order invariant subspace of L 2 (S 2 ). Note that the average value will only coincide with the center of mass if the mapping is equiareal. For a conformal map, it is closer to the head of the hippocampus."}, {"section_title": "Support Vector Machines", "text": "Linear SVM (Cortes and Vapnik, 1995) seeks an optimally separating hyperplane to distinguish two classes within a feature space. Given {x i , c i } i51 n data points and their class c i , linear SVM minimizes jjwjj 2 \u00fe C P n i\u00bc1 n i constrained by c i \u00f0w \u00c1 x i \u00c0 b\u00de ! 1 \u00c0 n i , where n i are the slack variables, measuring the degree of a data point's misclassification, and w are the weights defining the hyperplane. A datum's classification is defined by the sign of the SVM score (w\u00c1x i 2b). In this study, we use Joachims' svmPerf package, described in (Joachims, 2006) .\nShape invariants form our feature space. We compute spherical harmonics, and consequently the shape description, up to a bandwidth l < 256. Since we have a left and a right hippocampus, we have a total of 510 features. Though far smaller than the initial sets of locally-based models, this is still too large to train a good model given our number of subjects. Feature selection is needed.\nFeature selection is a problem encountered in many SVM classification studies, and a wide array of literature on the subject exists (Guyon and Elisseef, 2003) . The most used selection method in AD studies seems to be optimal thresholding of SVM weights with cross-validation within the training set (Vemuri et al., 2008) . For now we have instead chosen simple t-statistic threshold as selection criteria. Thus, for each test subject the t-statistic is computed anew and the same threshold is used for each new test."}, {"section_title": "Visualization", "text": "Although no spatial registration is required for our shape measures, it is needed for visualization. We require that the shapes are registered by a rigid rotation of their spherical maps, as that ensures that the shape's global description does not change. Many such methods exist, and we have chosen one based on spherical cross-correlation (Gutman et al., 2008a) . The idea then is to create an average shape based on the newly found local correspondence and rigid spatial alignment. Once a point-wise correspondence between each hippocampal model and the average has been established, it is possible to reconstruct each individual shape with any desired mixture of averaged and individual SPH coefficients. Thus it is possible to visualize the local effect of each shape descriptor by keeping only those coefficients which contribute to a particular descriptor from the individual surface, while taking the rest from the average. Visualizing a point-wise distance between the average and each mixed reconstruction gives an idea of which regions of the surface contribute the most to each descriptor.\nTo make our visualization as objective as possible, the initial correspondence is established using a target subject that is not used in any subsequent analysis, or classification. Each hippocampal model is then spatially aligned to this subject using the rigid quaternion transform. A different shape average is computed for each test subject, leaving the subject's model out of the computation. The mixed-to-average distance of each individual shape is then itself averaged and displayed.\nPerhaps the most interesting part of this work is the visualization of a meaningful variation in global description as local variation. The ability to represent an individual hippocampus as a mixture of average and individual shape effectively allows for a representation that minimizes meaningless shape variation while maximizing variation that has some significance for disease detection. Using such a representation could potentially have clinical uses; for example, it could make visualizationbased diagnosis by nonexperts possible.\nWhen comparing our visualization results with those based on local measures Thompson et al., 2004) , it is important to keep in mind that they are unlikely to be identical. For example, Wang uses a pairwise displacement map as a measure of local atrophy after a large diffeomorphism-based registration and rigid alignment. In both local and global approaches we can expect some degree of noise to contribute to the true effect. Since our noise occurs in the spectral domain, unlike the studies above, the effect of our noise can be quite different. It is also important to keep in mind that we are measuring different things. First, in change over time is compared between the two groups, whereas we compare shape difference at a single point in time. Second, we measure the effect of certain spectral components on the overall shape, making our visualization a much less direct way to see disease effects. Locally-based studies measure spatial differences more directly."}, {"section_title": "RESULTS", "text": "Before using our shape description for classification it was important to ascertain whether its theoretical invariance holds in practice. For all its advantages, the conformal map has one significant shortcoming: its large area distortion. We illustrate this in Figure 1 . Regions of extreme Gaussian curvature which protrude are mapped to very small regions on the sphere and suffer from undersampling. This could potentially cause our shape description to lose its invariance. Figures 1 and 2 illustrate the effect a random rotation of a surface has on its invariants. In the first hundred orders, error is within 2%. More importantly, the greatest error of the invariants selected for SVM classification (see below) is within 0.5%.\nFor each training set in the leave-one-out test, we selected a feature if its t-statistic exceeded a threshold. After testing a few subjects, we noticed that the best overall accuracy is achieved with 6.7 t min 6.9, and set it globally to 6.8. This yielded between 6 and 14 features, depending on which subject was left out. All selected features s(l) were of order 37 l 58. Our margin/error coefficient C was set to 1,000. All features were normalized with respect to standard deviation (differently for each excluded subject) and translated so that min(x) 5 2max(x). The transformation was saved and applied to the remaining subject. The result was 75.5% sensitivity and 87.3% specificity for a total correct rate of 82.1% (AD considered positive).\nBy comparison, hippocampal volume gave 67.3% sensitivity and 76.2% specificity in a leave-one-out test, with 72.3% correct overall. To combine our best features into one measure, we ran SVM on the entire data set with the same t min and C and obtained each subject's SVM score. In regression, SVM score correlated slightly better with Mini-Mental State Examination (MMSE) and Clinical Dementia Rating Sum of Boxes (CDR) scores than volume: for MMSE, R vol 2 5 0.253, R SVM 2 5 0.291; for CDR, R vol 2 5 0.276, R SVM 2 5 0.295, P < 0.001 for all. Since all our selected discriminating features came from the right hippocampus, consistent with a locally-based study on this data (Morra et al., 2008) , we ran the same tests using only right HP volume. We found it is a worse predictor than combined volume in all cases. To measure how much new information is contained in our shape description compared with volume, we ran a linear regression on combined volume and SVM score. Results are shown in Figure 3a . Figure 3b shows the ROC curve of our SVM model, total volume and the combined model. SVM is superior to volume for the entire range of sensitivities.\nThe six descriptors that were selected in every case were of order l 5 39, 41, 46, 48, and 58. Our mixed reconstructions were based on coefficients of these orders (Figs. 4 and 5) . The average mixed-to-average distance is displayed on the overall average surface in Figure 6 . Thresholding surface regions based on a peak histogram displacement value gives an idea of which surface parts contribute the most to these harmonics (Fig. 7) ."}, {"section_title": "DISCUSSION", "text": ""}, {"section_title": "Comparison to Other Work", "text": ""}, {"section_title": "Methodology and Results", "text": "While achieving modest classification results compared to some recent AD studies, our global description appears to FIGURE 1.\nUndersampling: The original 20K triangle surface (left) and its sampled version (right). Note the undersampling. A rotation in space will lead to slightly different sampling density in the tail, which will cause the description to be different."}, {"section_title": "FIGURE 2.", "text": "The surface from figure 1 was rotated by ZYZ Euler angles (151.8, 75.6, 259.5), re-parameterized, and re-sampled. We show the relative error in descriptors |s(l)-s'(l)/ s(l)| vs. l, where l is the order of the descriptor.\ncontain shape information that is not captured by simpler measures like volume. This is apparent in the low correlation between our description's SVM score and hippocampal volume and in the ROC curve. In most AD classification studies to date, volume-based features, such as gray matter probability maps, are used with SVM to predict diagnosis (Vemuri et al., 2008; Kloppel et al., 2008) . In the best ones, overall leave-oneout accuracy was 89-96% (Silverman and Thompson, 2006) .\nMore relevant to the current study, some recent works instead classified disease according to hippocampal shape-based features (Kim et al., 2005; Li et al., 2007) , with point-wise displacements forming the feature set. Li et al., used patch-averages of local displacement vectors projected onto the average normal. SVM was then applied to these local features to separate AD subjects from controls. Using hand-traced surfaces, the best leave-one-out accuracy reached 94.9%.\nDavies et al. studied effects of Schizophrenia using the minimal distance length approach to statistically align hippocampal parameterizations in (Davies et al., 2003) . For classification, Linear Discriminant Analysis (LDA) is used to find the discriminate vector in the feature space for distinguishing diseased subjects from controls. The work is compared to the SPHARM technique (Brechb\u00fchler et al., 1995) with both approaches yielding a Student's t-statistic for the group difference of less than 2.3 along the discriminate vector. Classification rates are not reported, but the authors claim that an SVM classifier on this feature space yielded practically the same results.\nAn interesting study by Gorczowski et al. (Gorczowski et al., 2007) recently appeared on classification using multi-object com- plexes. Their approach is advantageous to ours in that it takes into account the relative position of several subcortical structures with respect to each other, while we can only combine several shape invariants from every structure individually. This study, however, acknowledged that the classification results are improved when pose is eliminated from the feature space and only structure-intrinsic features (here, radii of m-reps developed by Gerig, Styner and coworkers) are used. Though the validation method is more robust than ours, the accuracy is inferior: 75%.\nA unifying aspect of the studies above is their emphasis on locally-based features: in each case a feature corresponds to either a voxel or a point on the surface. While this facilitates visualization, it may not take full advantage of some pattern a shape exhibits globally. Shenton et al. (2002) perhaps comes closest to our approach in that he uses two nonlocal shape features to classify Schizophrenia subjects and controls. This study does indeed use a spherical harmonic representation, specifically SPHARM, to align the left and flipped right amygdala-hippocampal surfaces for each subject. However, once the shapes are aligned, the study again returns to a simple spatial measurenot spherical harmonics or any features derived from them-to classify the shapes. Two asymmetry measures, volume difference and mean square distance with the volume normalized, are used in an SVM classification. A good accuracy of 87% is achieved."}, {"section_title": "Limitations", "text": "Our study was slightly biased since the same small subgroup we used in setting the selection threshold was used in classification testing. Although our shape measures separated patients from healthy subjects substantially better than hippocampal volume, other AD classification studies have had better results with volume alone, including one that used the ADNI dataset (Chupin et al., 2008) . Since using volume for classification is straight-forward, it is hard to point to our classification tech- Average displacement map. Displacements are computed from each mixed reconstruction and the average surface. Darker areas correspond to greater displacement; hence, these areas contribute more to the discriminant harmonics."}, {"section_title": "FIGURE 7.", "text": "Dark spots correspond to regions above a peak histogram value from figure 6. These regions contribute the most to the discriminant harmonics.\nnique as the cause of such discrepancy. More likely, this is because our hippocampal segmentation produces lower-quality models than the hand-traced models used in other studies. Better segmentation techniques will likely lead to better classification results by this method.\nSince the number of features in these studies is much larger than in the present article, a very robust feature selection is required as a preprocessing step before SVM can give reasonable results. The usual and evidently quite reliable means of doing this is the recursive feature elimination (RFE), as in (Li et al., 2007; Vemuri et al., 2008; Kloppel et al., 2008) . Here, an SVM model is iteratively trained and at each step the weakest (least-weighted) feature is removed. This is repeated until the classification rate or the particular cost function of the SVM model stop improving. Though this method is SVM-centric and well-suited for the problem, it is more expensive than our simple feature selection technique. Our na\u00efve selection may in part explain why our accuracy is inferior to some of the best results in the above studies."}, {"section_title": "Future Work", "text": "It would be interesting to do a cross-validation study to see whether mixed reconstruction increases discriminative power of locally-based features. For example, one could break a dataset in two parts, use one to find discriminate aspects of a global description and create mixed reconstructions of subjects in the other. Ideally, an SVM-based feature selection would be used.\nFor an objective comparison, the average shape used for reconstructing the second data set would be taken entirely from the first set.\nIn contrast, we can expand our bag of features by incorporating scalar maps that are intrinsic to the surface. For example, incorporating mean curvature and conformal factor would create a brand new description and at the same time allow for mixed reconstructions, since it is possible to uniquely reconstruct a conformally mapped surface based only on those two features. Again, so far the only scalar map we have used is distance to surface average value."}, {"section_title": "CONCLUSIONS", "text": "We have presented an alternative means of disease classification based on a global description of hippocampal shapes. In experiments, our method's accuracy, though respectable, remained inferior to some of the best reported AD classification results. However, the novelty of the information contained in our measures means that our feature set may well be useful in complementing existing classification methods. In contrast, our visualization of a global description appears to be the first of its kind. Although admittedly simple to do, it gives a new interpretation of a global description. Our mixed reconstructions allow us to deliberately reduce meaningless shape variation while preserving variation that is of interest to the researcher."}]
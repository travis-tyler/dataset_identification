[{"section_title": "Abstract", "text": "There are several issues with causal discovery from fMRI. First, the sampling frequency is so low that the time-delayed dependence between different regions is very small, making time-delayed causal relations weak and unreliable. Moreover, the complex correspondence between neural activity and the BOLD signal makes it difficult to formulate a causal model to represent the effect as a function of the cause. Second, the fMRI experiment may last for a relatively long time period, during which the causal influences are likely to change along with certain unmeasured states (e.g., the attention) of the subject which can be written as a function of time, and ignoring the time-dependence will lead to spurious connections. Likewise, the causal influences may also vary as a function of the experimental condition (e.g., health, disease, and behavior).\nIn this paper we aim to develop a principled framework for robust and time-or condition-specific causal discovery, by addressing the above issues. Motivated by a simplified fMRI generating process, we show that the time-delayed conditional independence relationships at the proper causal frequency of neural activities are consistent with the instantaneous conditional independence relationships between brain regions in fMRI recordings. Then we propose an enhanced constraint-based method for robust discovery of the underlying causal skeletons, where we include time or condition as an additional variable in the system; it helps avoid spurious causal connections between brain regions and discover time-or conditionspecific regions. It also has additional benefit in causal direction determination. Experiments on both simulated fMRI data and real data give encouraging results.\nThere are several issues with causal discovery from fMRI. First, the sampling frequency is so low that the time-delayed dependence between different regions is very small, making time-delayed causal relations weak and unreliable. Moreover, the complex correspondence between neural activity and the BOLD signal makes it difficult to formulate a causal model to represent the effect as a function of the cause. Second, the fMRI experiment may last for a relatively long time period, during which the causal influences are likely to change along with certain unmeasured states (e.g., the attention) of the subject which can be written as a function of time, and ignoring the time-dependence will lead to spurious connections. Likewise, the causal influences may also vary as a function of the experimental condition (e.g., health, disease, and behavior).\nIn this paper we aim to develop a principled framework for robust and time-or condition-specific causal discovery, by addressing the above issues. Motivated by a simplified fMRI generating process, we show that the time-delayed conditional independence relationships at the proper causal frequency of neural activities are consistent with the instantaneous conditional independence relationships between brain regions in fMRI recordings. Then we propose an enhanced constraint-based method for robust discovery of the underlying causal skeletons, where we include time or condition as an additional variable in the system; it helps avoid spurious causal connections between brain regions and discover time-or conditionspecific regions. It also has additional benefit in causal direction determination. Experiments on both simulated fMRI data and real data give encouraging results."}, {"section_title": "Introduction", "text": "The brain connectivity study is a crucial step to understand how the brain works. It has received much attention, where the term \"connectome\" is primarily used to describe the wiring diagram of the brain [20] . The development of new technologies, e.g., fMRI, provides us an invasive way to scan the whole brain activities, and hence gives us an opportunity to study the connectome on a macroscale. Here we are mostly interested in studying the effective connectivity from fMRI data, that is, the causal interactions between brain regions. However, in this paper we mainly focus on the skeleton of he causal network.\nThe causal connections in the brain may change with stimuli, tasks, states, the attention of the subject, etc. More specifically, it is widely known that one of the basic properties of connectome is its time-dependence [9] . The timevarying property can be seen as an effect of some confounders which change over time. In principle, failing to consider the influence from the confounders leads to marginalizing the true causal network (which includes the confounders) over the confounders, and this will result in spurious connections between brain regions. Meanwhile, several other difficulties occur when people start to analyze the effective connectivity on fMRI data [14] . First, fMRI is an indirect measure of neural activities, where the mapping from neural activities to BOLD signals is highly complicated. Second, the delays in BOLD response vary across regions and subjects, and are difficult to measure. Third, the fMRI signal has low time resolution (usually much lower than the time scale of causal influences in neural activities), causing the time-delayed causal relations weak and unreliable. Because of a number of issues, some researchers are suspicious of the possibility of causal discovery from fMRI data [12] .\nPreviously, most work on the effective connectivity studies focused on Granger causality (GC) analysis [15] , dynamic causal modeling (DCM) [5] , or conditional independence test based on partial correlations [17] . None of these methods tackles the time-dependent causal influences, and implicitly they all assume that there are no unobserved confounders. Among these three, DCM and partial correlation give more convinced results than GC [17] . DCM requires precise knowledge about the biophisical system and the identifiability of the complex model, and usually has difficulties in real applications [4] . Conditional independence tests based on partial correlations assume the causal relations are linear, which is challengeable for fMRI data. Several pieces of work considered the time-varying issues; they usually use sliding window methods [2] . The causal influences are assumed to be fixed on each window, which may be too restrictive, and the sample size on each window is much smaller, which may cause large estimation errors.\nIn this paper, we show that conditional independence can be used to derive the causal skeletons, and propose a nonparametric method to tackle the influence of the confounders L, which can be written as functions of certain confounder indicators, denoted by C, which include time, conditions, tasks, and stimuli. Essentially, we directly include such confounders L into the system; although they are unknown, by modeling them as functions of the confounder indicators, we can directly learn the (undirected) causal network including L. This view, together with appropriate nonparametric conditional independence test methods and proper constraints on the smoothness of the influence from confounder indicators, helps us directly recover which regions are directly connected to the confounders and find the intrinsic causal structure. That is, compared to the method which does not include L in the system, this effectively avoids spurious causal connections and identifies the confounder-indicator-specific regions.\nOur contribution consists of:\n1. Although it is difficult to formulate a structural equation model to represent the causal process for fMRI and do model-based causal discovery, we show that the conditional independence relationships in fMRI provide reliable information for causal discovery. 2. The causal relations between brain regions often change across different states and subjects, and even the confounder influence smooth in time. We show that causal discovery on simply merged data without considering the effect of the states, subjects or time leads to spurious connections between brain regions. We propose a scheme to avoid them. In addition, we show that if the external influences act as pure causes or pure effects, we can further determine the direction of many causal connections by orientation propogation. This generalizes previous methods for causal discovery from changes [10, 22] . 3. Moreover, this provides a way to discover the regions which are directly connected to C, i.e., the regions that are directly influenced by L or directly cause L. For fMRI group analysis, we further present a scheme to discover group-specific and subject-specific regions and distinguish between them.\n2 Causal Processes of Neural Activities and Instantaneous Conditional Independence Relations in fMRI\nWe first give a simplified generative model for fMRI to explain the causal relations in fMRI, which will motivate our robust and specific causal skeleton discovery method. We note that the proposed method applies to more general situations than the specific case considered by the model. For the sake of simplicity, we only consider the activities of three neuron populations on the time scale around 10ms, denoted byX t ,\u1ef8 t , andZ t , and we assume the following causal connections between them:X t \u2192\u1ef8 t \u2192Z t . In particular, we assume that the causal influences follow a vector autoregressive (VAR) model; the coefficients might be time-or condition-dependent, influenced by confounders such as anxiety and attention [12] , which can be written as functions of confounder indicators C:\nwhere E X,t , E Y,t and E Z,t are i.i.d. noise terms, the process {E X,t } independent from {X t }, {E Y,t } independent from {X t }, {E Z,t } independent from {\u1ef8 t }, and a i (C t ), b i (C t ) and c i (C t ) are assumed to be smooth in C t , which may be time, condition, etc.\nNext we model the relationship between neural activities and the fMRI signals. Although it is yet largely unknown, the state-of-the-art models posit that neural activities trigger a small increase in local oxygen consumption counterbalanced by a large increase in incoming blood flow [1] . This generates a transient increase in the local concentration of oxygenated blood, which can be measured with functional imaging through the BOLD effect. According to [7] , the effect of this mechanism effectively smooths the underlying neuronal fluctuations, possibly together with a nonlinear distortion, including haemodynamic saturation and refractoriness. Here let us consider an approximation to this procedure by applying a low-pass filter, then systematic subsampling and finally applying a nonlinear distortion. We first apply a low-pass filter h(t) on the neuronal activities to simulate the haemodynamic response, i.e.,X t = h(t) * X t ( * is convolution), and then eq. (1) becom\u0113\nWe then do systematic subsampling on high-resolution dataX t ,\u0232 t , andZ t according to the repetition time (TR) in the real experiments. We further make two assumptions.\n1. All those coefficients a i (C t ), b i (C t ) and c i (C t ) change smoothly over time such that they can be considered as constants within the length of the filter h(t)."}, {"section_title": "Moreover, h(t)", "text": "is a low-pass filter such that the convoluted signals change slowly in time, i.e., h(t) * X t\u22121 \u2248 h(t) * X t =X t and h(t)\nThe finally generated data are obtained by applying nonlinear distortion f on subsampledX t ,\u0232 t , and\u0232 t , i.e., X t = f (X t ), Y t = f (Z t ), and Z t = f (Z t ), to represent the effect such as saturation. Eq. (2) then implies\nAs the systematic subsampling factor k increasing, the time-delayed dependence between X t , Y t , and Z t becomes weaker; however, from equations 3, we can see that we have the instantaneous conditional independence relationship X t \u22a5 \u22a5 Z t | {Y t , C t }, where C t denotes the confounder indicator variable (time, condition, etc.). Note that even with random delays, which are usually about 50ms [8] , the above conditional independence relations still approximately holds. Fig. 1 gives such an illustration. Although it seems difficult to find a functional causal model for the fMRI signals [17] , the above conditional independence relationship is consistent with the causal information implied by the original VAR model (1) .In contrast, if we simply merge the data and ignore C, the conditional independence graph may contain spurious connections. For instance, suppose that the data were generated according to Figure 2(a) ; the conditional independence graph on the merged data contains spurious connections X 1 \u2212 X 4 and\nThe underlying causal graph implied by (3).\nWe can see that the information C can be viewed as a quantity underlying the confounder for the observed processes to capture the time-varying causal influences, as well as the smooth influence from unobserved confounders. Under the faithfulness assumption, we will derive X \u22a5 \u22a5 Z | {Y, C}, and then find underlying the causal skeleton between the underlying neural populations. However, if we ignore the influence from C, we will get the spurious connection between X and Z.\nAlternatively, one may discover the causal structure from the data for each value of C independently, and then find the causal connections that change with C by comparing the discovered individual causal graphs. This approach suffers from several issues. First, the data points used to learn each causal structure is usually not enough, leading to difficulties in structure learning, especially large type II errors in conditional independence tests. Second, many conditional independence tests are involved, and correcting multiple test is needed. Third, in this way we can asymptotically detect the change in the causal structure, but fail to detect the change in the causal influence with the same causal connection. Fourth, it does not indicate which variables are directly influenced by or influence C. Note that the variables whose distribution changes with C are not necessarily directly connected to C; for instance, X 3 in Figure 2 (a) depends on C, but it is not directly influenced by C. The estimated graph on merged data (without considering C), which corresponds to only one conditional independence relationship,\nperform causal discovery from fMRI by making use of conditional independence constraints. Throughout this paper, we assume the causal Markov condition and the faithfulness assumption [18, 13] , which guarantee the correspondence between the conditional independence relationships in the data and the underlying causal structure. In this section we propose an enhanced constraint-based method for robust and specific discovery of the causal skeleton. As illustrated in Figure 1 , we add an addition variable to capture C-specific information; recall C may include time T , condition, state, etc. Since the effect of C is unknown and could be very nonlinear, one has to adopt a flexible conditional independence test. Here we use the kernel-based conditional independence test (KCI-test [26] ) to capture the influence from C in a nonparametric way.\nSuppose that we have n observed brain regions, and we represent the measured fMRI signal as X i with i = 1, 2, \u00b7 \u00b7 \u00b7 , n. The procedure for robust and specific causal skeleton discovery is as follows.\n1. Build a complete undirected graph G C on the variable set {X i } \u222a C, i = 1, 2, \u00b7 \u00b7 \u00b7 , n."}, {"section_title": "(Specific discovery)", "text": "Test for the marginal and conditional independence between X i and C. If they are independent given a subset of the observed variables, remove the edge between X i and C in G C . Let S C denote the set of variables that are always dependent on C, i.e., C-specific variables."}, {"section_title": "(Robust discovery)", "text": "Test for the marginal and conditional independence between X i and X j . If they are independent given a subset of {X k | k = i, k = j} \u222a C, remove the edge between X i and X j in G C . Note that if both of X i and X j belong to S C , variable C is always included in the conditioning set. Now Let us consider the conditional independence property of the undirected graph G C by our approach. For simplicity, suppose that C has only two possible values, 0 and 1.\n1 Denote by G 1 and G 2 the Directed Acyclic Graphs (DAGs) that generated the data for C = 0 and C = 1, respectively. G C be the skeleton on the variables {X i } \u222a {C} discovered by our approach, and let G be the undirected graph after removing C and all connections from C from G C . We have the following results.\n1. If G 1 and G 2 are independence equivalent (which means that hey have the same skeletons and the same sets of v-structures), then G has the same skeleton (and the same sets of v-structures) as G 1 and G 2 .\n2. Otherwise, G is a minimal superset of G 1 and G 2 , in the sense that it encodes the conditional independence relationships shared by G 1 and G 2 ."}, {"section_title": "This is because", "text": "for each possible value of c; as a consequence, the conditional independence relationship shared by G 1 and G 2 are entailed in G C . Figure 3(a,b,c,e) gives such an illustration.\n(d) PDAG derived from GC , assuming C is a cause. (e) Output of PC on merged data. Figure 3 : An example of the individual causal graphs for different values of C, the asymptotically discovered undirected graph G C , the PDAG (partially directed acyclic graph) after orientation propagation which assumes C is a cause, and the asymptotically discovered graph on merged data by the PC algorithm [18] (without considering C as a variable in the system).\nWe have the following remarks regarding the conditional independence test methods and practical settings. 1) The influence from C (especially from time T ) is usually very nonlinear. In the above procedure, we have to use a flexible conditional independence test. Otherwise, say, if we use the partial correlation test, the influence from C cannot be removed, such that in Fig. 1 X and Z are (linearly) conditionally dependent given Y and C. 2) Here we assume that compared to filtered version of the neural states underlying the fMRI data, the confounders change more slowly over time. To incorporate such prior information, in KCI-test, we set a lower bound of the kernel width for C when C denotes time information. 3) By extending this framework, one can do heirarchical modeling to find group-specific and subject-specific regions (see Supplementary Material)."}, {"section_title": "Additional Benefit in Causal Direction Determination", "text": "In this section, we will see that introducing the additional variable C into the causal system does not only allow robust discovery of the skeleton of the causal structure, but also provides much benefit in determination of causal directions. Let us start with a simple case with only two variables, X and Y . Suppose that our enhance constrain-based method gives the skeleton C \u2212 X \u2212 Y . Then we have several possibilities.\n1. If Y \u22a5 \u22a5 C, then it is a V-structure, and we have C \u2192 X \u2190 Y , which gives the causal direction between X and Y ."}, {"section_title": "If the only conditional independence relationship is", "text": "If we further have the prior knowledge that the condition or a smooth function of C can not be effect, 2 then only the first possibility is allowed, and the causal direction between X and Y is determined, which is X \u2192 Y . In Figure  3 (d), X 1 \u2192 X 2 and X 3 \u2192 X 4 were obtained this way.\nThis procedure contains the methods proposed in [10, 22] for causal discovery from changes are special cases of our approach. When discovering causal information from (distribution) changes (e.g., from nonstationary data or multiple data sets), one implicitly assumes that the selection variables are actually root variables in the associate causal graph, as we modeled here. The above procedure is more principled, in the sense that it, based on V-structure and orientation propagation, directly follows the classical constraint-based causal discovery. It also tells us that if C is also an effect of some variables, which is known as a bias selection process, discovering causal information from changes is not straightforward (see, e.g., [19] )."}, {"section_title": "Experimental Results", "text": "We evaluated the performance of our proposed approach on both simulated fMRI data and real fMRI data."}, {"section_title": "Simulations", "text": "Firstly, we applied our approach on simulated fMRI data, which enables us to evaluate the robustness of our approach with known ground truth. We generated the simulated fMRI time series according to the DCM forward model [6] , which includes a bilinear model of neural dynamics and an empirically validated hemodynamic model to describe the transformation of neural activities to BOLD response; more specifically, the neural dynamics is described as follows,\nwhere x = {x i } describes the neural dynamics of each region, u = {u j } the external input, A the fixed coupling among regions in the absence of external input, B j the change in the coupling induced by the j th input, K the influence of the external input to the regions, and \u03b1 controls the lags between nodes. The detailed settings on the above parameters were shown in the supplementary S 2 . For the details of the hemodynamic model and its parameter settings, refer to [6] . It is known that the hemodynamic processes vary across brain areas and subjects, resulting in different lags between neural activities and the BOLD responses, we therefore added randomness into the balloon model parameters on each region to model the random lags. Finally, we added some Gaussian noise onto each region as the measurement noise. The time resolution for the neural activities is 5ms, and then the BOLD data was sampled every 3s (T R = 3s) with 600 time points for each realization. The simulations comprised of 50 realizations; for each realization, we put variations on A, B, C, the parameters of balloon model, and the random noise. Figure 4 shows a basic setting of the network topologies, where we modeled the external input to the nodes u 1 as random square wave [17] , and the external input to the connections with different kinds of functions, e.g., exponential decay, square wave, and smooth changes. Since the study on how are the causal connections between brain regions changing is very limited, here we tried to represent it with different functions to model different possible scenarios. We tested our enhanced constraint-based method on 50 realizations, where the time information T is included into the system. Figure 5(a) gives the False Positive (FP) rate and False Negative (FN) rate at significance level 0.03. We compared our enhanced constraint-based method with the original constraintbased method (also with KCI test, but without considering the effect from T ) and the original constraint-based method with partial correlation test. It is obvious that our approach can effectively reduce spurious connections which are induced by the time-varying connections, that is, it greatly reduces the FP rate, while at the same time increases the FN rate only slightly. Figure 5(b-d) show the causal skeleton estimated by the three approaches. Since there is a bit variation across realizations, here we gave the causal connections which exist in more than 70% of all the realizations. (a) Estimation error.\n(c) Original constraint-based method with KCI test "}, {"section_title": "Experiments on Real Data", "text": "Visual Cortex Data This fMRI dataset was recorded under conditions of homogeneous visual stimulation (Ganzfeld) from four subjects. Eyecaps and projectors were used to produce a uniform red visual stimulus in the scanner. The subjects were instructed to report their subjective percept using five buttons which corresponded to \"red, \"grey, \"fade-out, \"black-out and hallucination. The various perceptual states switched spontaneously, each epoch typically lasting few to tens of seconds [3] . We analyzed fMRI BOLD activity from four distinct visual areas V 1 , V 2 , V 3 and V 4 , that were localized using an independent retinotopy scan. Here we are interested in detecting intrinsic causal connections between regions, and furtherquestion whether they are modulated by subjective percept. The two cortical hemispheres were analyzed separately.\nFirstly, to analyze intrinsic causal connectivity, we included time information T in the graph to capture time-dependent connections and confounder influences. Then we applied our enhanced constraint-based method to it.\nSecondly, in order to detect regions that are directly causally influenced by changes in subjective percept, we included an additional state variable C(C = 1, 2, 3, 4, 5) that corresponded to the five perceptual-states. We tested independence between V i (i = 1, 2, 3, 4) and C by the proposed specific causal discovery.\nWe found that V 1 s directly connected with the state variable in 6 of all 8 analyzed cortical hemispheres, whereas the ratio decreased in higher areas (V 2 : 2/8, V 3 : 1/8, andV 4 : 0/8). From these results, we conclude that V 1 has the largest contribution in modulating the percept within the analyzed visual network. Here the robust state variable dependence in V 1 may arise from changes in bottom-up input (retina, LGN), changes in top-down input (e.g. frontal lobe), or changes in V 1 activity itself.\nFurthermore, by our enhanced constraint-based method we found that the intrinsic causal skeleton, V 1 \u2212 V 2 \u2212 V 3 \u2212 V 4 , exist consistently on all hemispheres, while V 1 \u2212 V 3 , V 1 \u2212 V 4 and V 2 \u2212 V 4 appeared only once. Interestingly, it coincides with anatomical connectivity among adjacent visual areas.\nAlzheimer Disease Data To further demonstrate the effectiveness of our method, we also apply the proposed specific causal discovery on Alzheimers disease Neuroimaging Initiative (ADNI) dataset (adni.loni.usc.edu), which was acquired from a wide range of academic institutions and private companies. It was processed by Automated Anatomical Labeling-AAL atlas [23] which includes 90 regions (cerebellum excluded). More details of data acquisition and preprocessing can be found in [27] . Here we aim to find those brain regions which are directly impaired by AD, among all brain regions. To As an illustration of the performance of our method, we just randomly selected four subjects for each groups (Alzheimers disease-AD and Normal Controls-NC).\nPrevious works on this problem mainly focused on the correlation-based method, such as functional connectivity alterations [21] . However, the causality among those affected brain regions are less studied. Here we tried to find the AD-directly-related regions by merging the subjects from two groups, and including an additional variable C in the graph as the disease indicator; that is, C = 1 if the subject is normal control and otherwise C = 2. By testing for marginal dependence (which can be considered as an enhanced correlation-based method), we found that there are 42 regions which are dependent on the disease (at the significance level 0.05). The proposed specific causal discovery approach reported that there are 13 regions which are directly connected AD. They are superior frontal gyrus, dorsolateral (right hemisphere), inferior frontal gyrus, triangular part (left hemisphere), olfactory cortex (right hemisphere), gyrus rectus (left hemisphere), gyrus rectus (right hemisphere), hippocampus (right hemisphere), amygdala (right hemisphere), superior occipital gyrus (left hemisphere), superior occipital gyrus (right hemisphere), angular gyrus (left hemisphere), superior temporal gyrus (right hemisphere), inferior temporal gyrus (left hemisphere), and inferior temporal gyrus (right hemisphere). This result includes most well recognized regions related with AD, such as hippocampus, temporal regions and frontal areas [24] ."}, {"section_title": "Conclusion and Discussions", "text": "Motivated from the generation process of the fMRI recordings, this paper advocates that the instantaneous conditional independence relationships between brain regions can be used to discover causal information from fMRI, although it is difficult to specify the cause-effect relationship. We have proposed an enhanced constraint-based approach to causal discovery from fMRI, by including the confounder indicators C, which may be time, condition, state, .etc, into the system, and performed nonparametric conditional independence test. This gives us a way to discovery robust causal skeleton and C-specific brain regions.\nWe also noted that if C is purely a cause, we have additional information to determine parts of the causal directions.\nThis work can be extended in several directions. Recently, it has been shown that with properly defined functional causal models or structural equation models (e.g., the linear, non-Gaussian causal model [16] , nonlinear additive noise model [11] , and post-nonlinear causal model [25] ). It is not obvious whether such models are able to approximate the causal process in fMRI and give reliable causal directionality. A line of our future research is to investigate what type of models is able to approximate the causal process in fMRI or make use of the nonstationary of the fMRI signals in a clever way, towards discovery of a fully directed causal structure for fMRI. Moreover, we are trying to reconstruct the influence from C, e.g, how are the causal influences change with C."}]
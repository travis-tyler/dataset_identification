[{"section_title": "Abstract", "text": "Feature selection\nMany neuroimaging applications deal with imbalanced imaging data. For example, in Alzheimer's Disease 24 Neuroimaging Initiative (ADNI) dataset, the mild cognitive impairment (MCI) cases eligible for the study are 25 nearly two times the Alzheimer's disease (AD) patients for structural magnetic resonance imaging (MRI) modality 26 and six times the control cases for proteomics modality. Constructing an accurate classifier from imbalanced data is 27 a challenging task. Traditional classifiers that aim to maximize the overall prediction accuracy tend to classify all 28 data into the majority class. In this paper, we study an ensemble system of feature selection and data sampling 29 for the class imbalance problem. We systematically analyze various sampling techniques by examining the efficacy 30 of different rates and types of undersampling, oversampling, and a combination of over and undersampling 31 approaches. We thoroughly examine six widely used feature selection algorithms to identify significant bio-32 markers and thereby reduce the complexity of the data. The efficacy of the ensemble techniques is evaluated 33 using two different classifiers including Random Forest and Support Vector Machines based on classification accu-34 racy, area under the receiver operating characteristic curve (AUC), sensitivity, and specificity measures. Our exten-35 sive experimental results show that for various problem settings in ADNI, (1) a balanced training set obtained with 36 K-Medoids technique based undersampling gives the best overall performance among different data sampling tech-37 niques and no sampling approach; and (2) sparse logistic regression with stability selection achieves competitive 38 performance among various feature selection algorithms. Comprehensive experiments with various settings 39 show that our proposed ensemble model of multiple undersampled datasets yields stable and promising results. 40"}, {"section_title": "", "text": "U N C O R R E C T E D P R O O"}, {"section_title": "23", "text": "Many neuroimaging applications deal with imbalanced imaging data. For example, in Alzheimer's Disease 24 Neuroimaging Initiative (ADNI) dataset, the mild cognitive impairment (MCI) cases eligible for the study are 25 nearly two times the Alzheimer's disease (AD) patients for structural magnetic resonance imaging (MRI) modality 26 and six times the control cases for proteomics modality. Constructing an accurate classifier from imbalanced data is 27 a challenging task. Traditional classifiers that aim to maximize the overall prediction accuracy tend to classify all 28 data into the majority class. In this paper, we study an ensemble system of feature selection and data sampling 29 for the class imbalance problem. We systematically analyze various sampling techniques by examining the efficacy 30 of different rates and types of undersampling, oversampling, and a combination of over and undersampling 31 approaches. We thoroughly examine six widely used feature selection algorithms to identify significant bio-32 markers and thereby reduce the complexity of the data. The efficacy of the ensemble techniques is evaluated 33 using two different classifiers including Random Forest and Support Vector Machines based on classification accu-34 racy, area under the receiver operating characteristic curve (AUC), sensitivity, and specificity measures. Our exten-35 sive experimental results show that for various problem settings in ADNI, (1) a balanced training set obtained with tion of the disease (Bartzokis, 2004; Vlkolinsk\u1ef3 et al., 2001) . Early diag-59 nosis of AD is critical to prevent or delay the progression of the disease."}, {"section_title": "60", "text": "Future treatments could then target the disease in its earliest stages, 61 before irreversible brain damage or mental decline has occurred."}, {"section_title": "62", "text": "There are many studies which aim to capture the elusive biomarkers 63 of AD for preclinical AD research (Sperling et al., 2011) . Several genetic, Apart from the internal and external solutions, evaluation of 195 the classifier for imbalanced datasets has always remained a big 196 challenge (Elkan, 2003) . Provost and Fawcett (2001) proposed the Costing which yielded better results than random sampling methods."}, {"section_title": "204", "text": "However, the greatest disadvantage of internal level solutions is that 205 they are very specific to the classification algorithm. On the other\nhand, the external or data level solutions are classifier independent, 207 portable, and therefore more adaptable. In this work, we focus on devel-208 oping and evaluating ensemble models based on data level methods."}, {"section_title": "209", "text": "While ubiquitous and important, imbalanced data analysis has 210 not received enough attention in the neuroimaging field, at least 211 for the ADNI dataset. This paper aims to fill this gap by studying an 212 ensemble technique to tackle the class imbalance problem in the 213 ADNI dataset. The resampling approaches that we studied include 214 random undersampling and oversampling (He and Garcia, 2009; Jo and 215 Japkowicz, 2004; Liu et al., 2009c; Van Hulse et al., 2007; Yen and 216 Lee, 2006) , SMOTE oversampling (Chawla et al., 2002) , and K-Medoids 217 based undersampling. We extended our study by varying rates of under-218 sampling and oversampling independently, and a combination of differ-219 ent rates of oversampling and undersampling to generate balanced 220 training sets. In AD research, it is crucial to determine a few significant (Jack et al., 2008) oversampling (Drummond and Holte, 2003; Japkowicz, 2000a) . In 379 addition to these basic resampling approaches, different rates of 380 resampling and combination resampling approaches were also explored 381 in our study."}, {"section_title": "382", "text": "Detailed ensemble procedure"}, {"section_title": "383", "text": "The mathematical formulation of the problem statement and the 384 solution is defined as follows:"}, {"section_title": "385", "text": "Set of feature selection algorithms:\nSet of class-imbalance handling approaches:\nS \u00bc Different types and rates of data re\u2212sampling techniques f g"}, {"section_title": "390 391", "text": "Set of classification algorithms:\nAn ensemble system is defined as follows: For any set X, |X| is defined as the cardinality of the set."}, {"section_title": "398", "text": "Hence there were |F| \u00d7 |S| \u00d7 |C| ensemble systems studied in this 399 paper for a given prediction task as illustrated in Fig. 1 the cluster center is repeated 10 times and the set of cluster centers 3 Matlab's ttest2 function was used. 4 We used the Feature Selection package in Zhao et al. (2011) .\nwhich gives the minimum cost is selected. "}, {"section_title": "446", "text": "The efficacy of different ensemble systems was compared using var-"}, {"section_title": "447", "text": "ious performance metrics including accuracy, sensitivity, specificity,"}, {"section_title": "448", "text": "and area under the ROC curve (AUC). These metrics are defined as 449 follows: Fig. 1 . Illustrating the proposed ensemble system for imbalance data classification. In this proposed model, a training and a testing set is derived from the given data using data points from both majority and minority classes as illustrated in the top rectangle (solid line) of the figure. Different data resampling techniques are applied to the training set to generate a \"resampled training set\" on which a feature selection algorithm is applied to select relevant features resulting in a reduced dimension training set. Subsequently a classification algorithm is applied to generate a prediction model which is tested on the test set to evaluate its efficacy. The steps shown in double blue bordered rectangle are repeated for each feature selection algorithm and prediction model. The steps in dotted black bordered rectangle are repeated for each data resampling technique. combined to achieve a balanced training set (Chawla et al., 2002) ."}, {"section_title": "486", "text": "In Section 3.2 we studied such an approach and compared it with Table 1 ). The bar labeled \"Complete\" represents the data available for analysis. The \"Train\" bar represents training data taken from both classes for different resampling approaches and \"Test\" bar represents the test data. A dataset is formed by combining a training set and a test set (test set is kept fixed between different sampling approaches, and it need not be balanced)."}, {"section_title": "a) No Sampling b) Random Undersampling c) Random Oversampling", "text": "Fig. 3. Illustrating three different sampling approaches used in an ensemble system for an experimental setup for predicting control cases (marked by blue, for training and red, for testing asterisk symbols) from AD cases (marked by orange, for training and green, for testing asterisk symbols) using proteomics modality (refer to Table 1 ). Each class is divided into a training and test set in a ratio of 9:1. X-axis represents 10 cross folds and Y-axis represents samples. (a) Depicts actual or no sampling scenario where training data is unbalanced with respect to the two classes. (b) Depicts undersampling scenario where training set is balanced by removing data points from the majority class as shown by the sparse orange columns for each cross fold compared to other two cases. (c) Depicts oversampling scenario where minority class is duplicated as shown by extra length of blue columns for each cross fold. Note that only one dataset is shown for each cross fold, but 30 datasets were used except in training for no sampling case. Stolfo, 1998)."}, {"section_title": "494", "text": "In the following tables and figures, \"(\u2212)\" is used to represent the 495 negative class, whereas \"(+)\" is used to represent the positive class."}, {"section_title": "496", "text": "\"RF Avg\" and \"SVM Avg\" represent averaged performance measures \nand \"RF MajVote\" and \"SVM MajVote\" represent majority voting 498 performance measures using RF and SVM classifiers. Table 4 and the classification results are given in Table 5 . Tables 6 and   543 7 represent data distribution and prediction performance, respective-544 ly, of the classical NC/AD prediction task using proteomics features."}, {"section_title": "545", "text": "The data and the performance measures of NC/AD task using MRI 546 features are summarized in Tables 8 and 9 , respectively. In this and performance measures for this task using proteomics features."}, {"section_title": "551", "text": "The MRI counterparts of this task are given in Tables 12 and 13 ."}, {"section_title": "552", "text": "From these six classification tasks, we conclude that the K-Medoids 553 undersampling approach dominated the overall efficacy of the 554 ensemble system more than any other factor."}, {"section_title": "555", "text": "Comparison with a combination scheme \nmodels and majority voting was more effective than simple averaging."}, {"section_title": "598", "text": "These results are compared in Fig. 7 ."}, {"section_title": "599", "text": "Comparing different rates of data resampling undersampling approach increased the specificity by more than 51%."}, {"section_title": "631", "text": "The results for majority performance metrics are illustrated in Fig. 9 ."}, {"section_title": "632", "text": "Comparison with a multi-classifier learning approach was trained on each of these subsets and the minority training set. \nLater, these classifiers were stacked together to build a final ensemble 642\nclassifier. In our study on ADNI data for NC/MCI prediction task using 643 proteomics modality, we studied Chan and Stolfo's approach. We "}, {"section_title": "656", "text": "The results are summarized in Table 19 sensitivity and 65% specificity when assessed on the full set of non-converters (Davatzikos et al., 2010; Fan et al., 2008; Liu et al., 823 2011; Shen et al., 2011; Yang et al., 2011 Relief-F based on relevance of features using k-nearest neighbors,"}, {"section_title": "854", "text": "Gini Index based on measure of inequality in the frequency distribu- Forest algorithm and decision boundary based Support Vector Fig. 6 . The bar labeled \"Complete\" represents the data available for analysis. The \"Test\" bar represents the test data and the remaining bars in between represents the training data taken from both classes at different resampling rates. For brevity bar labels are abbreviated, for example 10% SMOTE oversampling of minority class and 90% K-Medoids undersampling of majority class is labeled as \"S10_K90\". A train-test dataset is formed by combining a train set and a test set (test set is kept fixed between different sampling approaches, and it need not be balanced).\nMachine classifiers. The key evaluation criteria used were accuracy Comparison of different sampling approaches using top 10 proteomics features obtained by SLR + SS and T-Test, averaged across 10 cross folds, in terms of accuracy, sensitivity t15:3 and specificity, and AUC. The best value in each column for each performance metric is underlined to compare different sampling approaches and highest value in each row is highlighted t15:4 in bold to compare feature selection algorithms and classifiers. OS% refers to SMOTE oversampling percentage and US% corresponds to K-Medoids undersampling percentage. Results t15:5 obtained without resampling approach are indicated by row (0%,0%), (0%,100%) refers to complete undersampling, and (100%,0%) corresponds to complete oversampling. et al., 2010a; Stein et al., 2010b) and our surface multivariate"}, {"section_title": "892", "text": "TBM studies (Wang et al., 2011 the line of equality [18] . GI measures the ability of a feature to Fig. 8 . The bar labeled \"Complete\" represents the data available for analysis. The \"Test\" bar represents the test data and the remaining bars in between represents the training data taken from both classes at different resampling rates. For brevity bar label are abbreviated, for example \"S30_K0\" corresponds to 30% SMOTE oversampling of minority class and no undersampling majority class. A train-test dataset is formed by combining a train set and a test set (test set is kept fixed between different sampling approaches, and it need not be balanced). Information Gain (IG) is also known as information divergence, 1002 Kullback-Leibler divergence, or relative entropy. Information gain is com-1003 monly used as a surrogate for approximating a conditional distribution in 1004 classification setting (Cover and Thomas, 1991) . It represents the Fig. 9 . NC/MCI majority voting classification performance comparison of SVM classifier, averaged across 10 cross folds, using top 10 features from SLR + SS for different rates of data sampling. Note the decreasing sensitivity-specificity gap as the rate of undersampling is increased. Complete undersampled dataset (labeled as S0_K100) showed least gap. Generation of classification models for imbalanced data using Chan and Stolfo (1998) approach. The majority class (represented by orange colored rectangles in the figure) is evenly divided into minority class sized non-overlapping subsets.\nTable 19 t19:1 t19:2 NC/MCI: Comparison of undersampling approach using top 10 proteomics features obtained by SLR + SS and T-test, averaged across 10 cross folds, in terms of accuracy, sensitivity and t19:3 specificity, and AUC. The best value in each column for each performance metric is underlined to compare different sampling approaches and highest value in each row is highlighted in t19:4 bold to compare feature selection algorithms and classifiers. Chan US refers to undersampling using Chan et al. (Chan and Stolfo, 1998) Fig. 11 . NC/MCI majority voting classification performance comparison of SVM classifier for different undersampling approaches, averaged across 10 cross folds, using top 10 features from SLR + SS for different rates of data sampling depicting efficacy of K-Medoids and random undersampling approach over Chan and Stolfo proposed solution (Chan and Stolfo, 1998) ."}]
[{"section_title": "Abstract", "text": "Accurate prediction of disease trajectories is critical for early identification and timely treatment of patients at risk. Conventional methods in survival analysis are often constrained by strong parametric assumptions and limited in their ability to learn from high-dimensional data, while existing neural network models are not readily-adapted to the longitudinal setting. This paper develops a novel convolutional approach that addresses these drawbacks. We present MATCH-Net: a Missingness-Aware Temporal Convolutional Hitting-time Network, designed to capture temporal dependencies and heterogeneous interactions in covariate trajectories and patterns of missingness. To the best of our knowledge, this is the first investigation of temporal convolutions in the context of dynamic prediction for personalized risk prognosis. Using real-world data from the Alzheimer's Disease Neuroimaging Initiative, we demonstrate state-of-the-art performance without making any assumptions regarding underlying longitudinal or time-to-event processes-attesting to the model's potential utility in clinical decision support."}, {"section_title": "Introduction", "text": "In Alzheimer's disease-the annual cost of which exceeds $800 billion globally [1] -the effectiveness of therapeutic treatments is often limited by the challenge of identifying patients at early enough stages of progression for treatments to be of use. As a result, accurate and personalized prognosis in earlier stages of cognitive decline is critical for effective intervention and subject selection in clinical trials. Conventional statistical methods in survival analysis often begin by choosing explicit functions to model the underlying stochastic process [2] [3] [4] [5] [6] [7] . However, the constraints-such as linearity and proportionality [8, 9] in the popular Cox model-may not be valid or verifiable in practice.\nIn spite of active research, a conclusive understanding of Alzheimer's disease progression remains elusive, owing to heterogeneous biological pathways [10, 11] , complex temporal patterns [12, 13] , and diverse interactions [14, 15] . Hence Alzheimer's data is a prime venue for leveraging the potential advantages of deep learning models for survival. Neural networks offer versatile alternatives by virtue of their capacity as general-purpose function approximators, able to learn-without restrictive assumptions-the latent structure between an individual's prognostic factors and odds of survival.\nContributions. Our goal is to establish a novel convolutional model for survival prediction, using Alzheimer's disease as a case study for experimental validation. Primary contributions are threefold: First, we formulate a generalized framework for longitudinal survival prediction, laying the foundation for effective cross-model comparison. Second, our proposal is uniquely designed to capitalize on longitudinal data to issue dynamically updated survival predictions, accommodating potentially informative patterns of data missingness, and combining human input with model predictions. Third, we propose methods for deriving clinically meaningful insight into the model's inference process. Finally, we demonstrate state-of-the-art results in comparison with comprehensive benchmarks."}, {"section_title": "Problem formulation", "text": "Let there be N patients in a study, indexed i \u2208 {1, ..., N }. Time is treated as a discrete dimension of fixed resolution \u03b4 > 0. Each longitudinal datum consists of the tuple (t, x i,t , s i,t ), where x i,t is the vector of covariates recorded at time t, and s i,t is the binary survival indicator. Let random variable T i,surv denote the time-to-event, T i,cens the time of right-censoring, and T i = min{T i,surv , T i,cens }. Per convention, we assume that censoring is not correlated with the eventual outcome [16] [17] [18] . Let the complete longitudinal dataset be given by X = { (t, x i,t , s i,t )\n. Then we can define X i,t,w = (t , x i,t , s i,t ) t \u2208T where T = {t : t \u2212 w \u2264 t \u2264 t} (1) to be the set of observations for patient i extending from time t into a width-w window of the past, where parameter w depends on the model under consideration. Given longitudinal measurements in X i,t,w , our goal is to issue risk predictions corresponding to length-\u03c4 horizons into the future. Formally, given a backward-looking historical window (t \u2212 w, t], we are interested in the failure function for forward-looking prediction intervals (t, t + \u03c4 ]; that is, we want to estimate the probability\nof event occurrence within each prediction interval. Observe that parameterizing the width of the historical window results in a generalized framework-for instance, a Cox model only utilizes the most recent measurement; that is, w = 1. At the other extreme, recurrent models may consume the entire history; that is, w = t. As we shall see, the best performance is in fact obtained via a flexible intermediate approach-that is, by learning the optimal width of a sliding window of history.\n3 MATCH-Net We propose MATCH-Net: a Missingness-Aware Temporal Convolutional Hitting-time Network, innovating on current approaches in three respects. Dynamic prediction: Existing deep learning models issue prognoses on the basis of information from a single time point [19] [20] [21] [22] [23] [24] [25] [26] [27] [28] [29] , potentially discarding valuable information in the presence of longitudinal data. We investigate temporal convolutions in capturing heterogeneous representations of temporal dependencies among observed covariates, enabling truly dynamic predictions on the basis of historical information. Informative missingness: Current survival methods rely on the common assumption that the timing and frequency of covariate measurements is uninformative [18, 30] . By contrast, our model is missingness-aware-that is, we explicitly account for informative missingness by learning correlations between patterns of missingness and disease progression. Human input: Instead of issuing predictions solely on the basis of quantitative clinical measurements, we optionally incorporate clinicians' most recent diagnoses of patient state into model estimates to examine the incremental informativeness of subjective input. Each innovation is a source of gain in performance (see Section 4; further details in the appendix).\nMATCH-Net accepts as input a sliding-window of observed covariates X i,t,w , as well as a parallel binary mask of missing-value indicators Z i,t,w taking on values of one to denote missing covariate measurements. In addition, the network optionally accepts a one-hot vector r i,t describing the most recent clinician diagnosis of Alzheimer's disease progression. Starting from the base of the network, the convolutional block first learns representations of longitudinal covariate trajectories by extracting local features from temporal patterns. After each layer, filter activations from the auxiliary branch are concatenated with those in the main branch. Then, the fully-connected block captures more global relationships by combining local information. Finally, the output layers produce failure estimate\u015d\nfor pre-specified prediction intervals, where \u03c4 max is the maximal horizon desired. This convolutional dual-stream architecture explicitly captures representations of temporal dependencies within each stream, as well as between covariate trajectories and missingness patterns in association with disease progression. This accounts for the potential informativeness of both irregular sampling (i.e. intervals between consecutive clinical visits may vary) and asynchronous sampling (i.e. not all features are measured at the same time) [31, 32] . This also encourages the network to distinguish between actual measurements and imputed values, reducing sensitivity to specific imputation methods chosen. The final architecture uses convolutions of length l = 5\u03b4, with more filters per layer in the main branch.\nLoss function. With the preceding notation, the negative log-likelihood of a single empirical result s i,t+\u03c4 and model estimateF i (t + \u03c4 |t, w) in relation to some input window X i,t,w is given by\nwhere \u03b8 denotes the parameters of the network. The total loss function is then computed to simultaneously take into account the quality of predictions for all prediction horizons \u03c4 , all times t available along each patient's longitudinal trajectory, and all patients i \u2208 {1, ..., N } in the survival dataset:\nwhere \u03c4 i = min{t i \u2212 t, \u03c4 max } accounts for failure or right-censoring. This is a natural generalization of the log-likelihood in [24] to accommodate longitudinal survival. Weight function \u03b1(i, t, \u03c4 ) allows trading off the relative importance of different patients, time steps, and prediction horizons. First, this allows standardizing patient contributions with \u03b1(i, t, \u03c4 ) \u221d 1/t i , thereby counteracting the bias against patients with shorter survival durations. Second, in the context of heavily imbalanced classes, this allows up-weighting positive instances-that is, input windows that correspond to actual failure."}, {"section_title": "Experiments", "text": "The Alzheimer's Disease Neuroimaging Initiative (ADNI) study data is a longitudinal survival dataset of per-visit measurements for 1,737 patients [1] . The data tracks disease progression through clinical measurements at 1 /2-year intervals, including quantitative biomarkers, cognitive tests, demographics, and risk factors. Our objective is to predict the first stable occurrence of Alzheimer's disease for each patient. Further information on the dataset, preparation, and training can be found in the appendix.\nBenchmarks. We evaluate MATCH-Net against both traditional longitudinal methods in survival analysis and recent deep learning approaches; the former includes Cox landmarking and joint modeling methods, and the latter includes static and dynamic multilayer perceptrons and recurrent neural network models. Performance is evaluated on the basis of the area under the receiver operating characteristic curve (AUROC) and the area under the precision-recall curve (AUPRC), both computed with respect to prediction horizons \u03c4 . Five-fold cross validation metrics are reported in Table 1 .\nPerformance. MATCH-Net produces state-of-the-art results, consistently outperforming both conventional statistical and neural network benchmarks. Gains are especially apparent in AUPRC scores-improving on the MLP by an average of 15% and on joint models by 16% across all horizons, and by 27% and 26% for one-step-ahead predictions. To understand the sources of improvement, we observe a 4% gain in AUPRC from introducing the sliding window mechanism (MLP to S-MLP), a 9% gain from incorporating temporal convolutions (S-MLP to S-TCN), and a further 2% gain from accommodating informative missingness (S-TCN to MATCH-Net). In addition, including the most recent clinician diagnosis results in a further 17% gain (further details located in the appendix). Visualization. From the preceding, we observe the largest gains by introducing convolutions. While this is consistent with our motivating hypothesis that convolutions are better able to capture temporal patterns, clinicians often desire a degree of transparency into the prediction process [35, 36] . We adopt the partial dependence approach in [37] to understand the input-output relationship, as well as examining the utility of convolutions. For each observed covariate d, we want to approximate how the estimated failure function varies based on the value of x d t,w . We define the dependence\nwhere\nt,w = X t,w . By evaluating Equation 6 on the values x d t,w present in the data, the influence of each covariate can be measured by estimating its slope. For a global picture of what impact each feature and time step has on the model's predictions, we compute the influence for all features to produce an average saliency map [38, 39] highlighting the effect of convolutional layers. All else equal, absent convolutions we see that having worse covariate values any time step almost invariably has an upward impact on risk (i.e. negative impact on survival). On the other hand, with temporal convolutions we see that having worse covariate values at earlier time steps may result in a downward impact on risk (i.e. positive impact on survival), suggesting that convolutions may better facilitate modeling relative movements (e.g. sudden declines) than simply paying attention to levels. Further visualizations for added perspective on input-output relationships are found in the appendix."}, {"section_title": "APPENDIX Example use", "text": "While various settings may benefit from MATCH-Net as a matter of clinical decision support, we illustrate one possible application within the context of personalized screening. Figure 3 shows the historical risk trajectory and forward risk estimates for a randomly selected ADNI patient. During the first seven years of bi-annual visits, the patient exhibits cognitively normal behavior, and the MATCHNet risk estimates-computed via measured biomarkers and neuropsychological tests-reflect this steady clinical state (see historical trajectory in blue). In fact, as of precisely seven years of follow-up, the predicted 30-month forward risk remains less than 10% (see predicted trajectory in orange). However, two clinical visits later, when the patient returns for regular checkup and clinical measurements, the projected 30-month forward risk jumps to over 50% (see predicted trajectory in red). In this situation, the clinician is immediately alerted to the sudden increase in risk of dementia, and may decide to advise more frequent checkups, or to administer a wider range of tests and biomarker measurements in the immediate term to better assess the overall risk in light of the recent downturn. In fact, as it turns out in this case, the patient is indeed diagnosed with Alzheimer's disease at t = 10 years, shedding light on MATCH-Net's potential as an early warning and subject selection system. "}, {"section_title": "Related work", "text": "The first study to investigate neural networks formally in the context of time-to-event analysis was done by [19] . By swapping out the linear functional in the Cox model for the topology of a hidden layer, their nonlinear proportional hazards approach was extended to other models for censored data, such as [4] and [20] . In 2016, [21] were the first to apply modern techniques in deep learning to survival, in particular without prior feature selection or domain expertise. While previous studies following [19] 's model generally produced mixed results [22, 23] , [21] demonstrated comparable or superior performance of multilayer perceptrons in relation to conventional statistical methods.\nInstead of predicting the hazard function as an intermediate objective, [24] first proposed-and [25] further developed-an alternative approach to predict survival directly for grouped time intervals. In 2017, [27] combined the use of the Cox partial likelihood with the goal of predicting probabilities for pre-specified time intervals. Inspired by the work of [26] on multi-task logistic regression models for survival, they generalized the idea to deep learning via multi-task multilayer perceptrons.\nRecently, [29] and [28] in 2018 proposed learning the distribution of survival times directly, making no assumptions regarding the underlying stochastic processes-in particular with respect to the time-invariance of hazards. By being process-agnostic, [29] demonstrated significant improvements over existing statistical, machine learning, and neural network survival models on multiple real and synthetic datasets. In the context of Alzheimer's disease, [40] studied the use of medical image sequences for classifying patient progression. More pertinently, [34] used recurrent networks to forecast disease trajectories with ADNI data, but relied on the explicit assumption of exponential distributions. Finally, building on these developments, one of the main contributions of this study is the use of temporal convolutions for dynamic survival prediction-while making no assumptions, and allowing the associations between covariates and risks to evolve over time (see Table 2 )."}, {"section_title": "Details on dataset", "text": "We are primarily interested in the clinical status for each patient at any given time. An official diagnosis is recorded at each patient's visit, and consists of two attributes. First, each diagnosis may be either stable or transitive. The former consists of stable diagnoses of normal brain functioning (\"NL\"), mild cognitive impairment (\"MCI\"), or Alzheimer's disease (\"AD\"), and the latter consists of preliminary diagnoses indicating transitions between these categories, which may take the form of either conversions or reversions. Conversions indicate a forward progression in the disease trajectory, and reversions indicate a regression back towards an earlier stage of the disease. Patients may remain in stable or transition diagnosis states for any duration at a time. The average patient who receives a transition diagnosis is observed to persist in that state for one year, while some patients do not exit this state until almost 5 years have elapsed. Patients who receive a transition diagnosis may not actually be confirmed with a subsequent stable diagnosis; in fact, less than half of the transition diagnoses for dementia were confirmed by a stable diagnosis at the next step, and almost one quarter are never followed by a stable diagnosis at any point until right-censoring. In addition, patients often actually undergo reversion transitions back towards earlier stages of the disease; in fact, over 5% of the study population receive reversion diagnoses at some point in time.\nNote on class imbalance. The per-patient failure rate is 14% (243 patients out of the total 1,737). However, given the online nature of the sliding window mechanism in training and testing, the effective fraction of observations with positive event labels for any prediction horizon is around 2%. "}, {"section_title": "Data preparation", "text": "Since the ADNI dataset is an amalgamation from multiple related studies, most features are sparsely populated. Features with less than half of the entries missing are retained, leaving 18 numeric and 4 categorical features (see Table 3 ); the latter are represented by one-hot encoding, resulting in 16 binary features. Consistent with existing Alzheimer's studies, patients are aligned according to time elapsed since baseline measurements [41] [42] [43] . Timestamps are mapped onto a discrete axis with a fixed resolution of \u03b4 = 1 /2-year intervals; where multiple measurements qualify for the same destination, the most recent measurement per feature takes precedence. Original measurements were made at roughly 1 /2-year intervals, so we observe that the average absolute deviation between original values and final timestamps amounts to an insignificant 4 days (i.e. less than 2% of each interval).\nWhere measurements are missing, values are reconstructed using zero-order hold interpolation. In addition, due to the fixed-width nature of the sliding window, the input tensor X i,t,w for initial prediction times t < w \u2212 \u03b4 correspond to left-truncated information t \u2212 w + \u03b4 < 0; feature values are therefore extrapolated backwards for all intervals of the form [\u2212w + \u03b4, \u2212\u03b4]. Note that regardless of the imputation mechanism, information on original patterns of missingness-due to truncation, irregular sampling, and asynchronous sampling alike [31, 32] -is preserved in the missing-value mask Z i,t,w provided in parallel to the network. Finally, to improve numerical conditioning, all features are normalized with empirical means and standard deviations from the training set data."}, {"section_title": "Training procedure", "text": "Training begins with input tuple (X, Z, R), where\n, and terminates with a set of calibrated network weights \u03b8. The network is trained until convergence, up to a maximum of 50 epochs. Training loss is only computed for event labels corresponding to actual recorded clinical visits (i.e. timestamps with recorded covariate values); neither imputed nor forward-filled labels are included. Analogous to our total loss function definition, the convergence metric is the sum of performance scores across all prediction tasks,\nwhere \u03b2(\u03c4 ), \u03b3(\u03c4 ) optionally allow trading off the relative importance between the two measures and different horizons. In this study we simply use the unweighted sum, although any convex combination would be valid. Empirically, results are not meaningfully improved by favoring one metric over the other. Elastic net regularization is used, and validation performance is computed every 10 iterations. For early stopping, validation scores serve as proxies for generalization error. Positive instances are oversampled to counteract class imbalance. To augment training data, artificial labels for dummy events of the form \u03c4 = 0 are generated, and positive labels are filled forward for all horizons \u03c4 > \u03c4 0 where \u03c4 0 corresponds to the first failure for that example. Patients diagnosed with Alzheimer's at baseline (20%) are excluded from testing and validation, since survival is undefined in those cases. For Cox landmarking, we use the implementation in [44] for interval-censored data, fitting a sequence of proportional hazards regression models for observation groups. Optimal groupings are determined by exhaustive search in 1 /2-year increments. Preliminary feature-selection is performed by stepwise regression for the best candidate model, using the implementation of [45] . For joint modeling, we adopt the common two-stage method in [46] , first fitting linear mixed effects sub-models for significant variables, then fitting landmarking models based on mean estimates from the sub-models. In both cases, consistent with literature, time is defined as years since initial follow-up [41] [42] [43] .\nFor all neural network models, hyperparameter optimization is carried out via 100 iterations of random search(see Table 4 ). In addition, activation functions are also searched over for gating units in recurrent network cells. Model selection is performed on the basis of final composite scores-as in Equation 7-for each candidate. We use 5-fold cross validation to evaluate performance, stratified at the patient level-that is, patients are randomly selected into datasets for training (60%), validation (20%), and testing (20%), with the ratio of positive patients (i.e. those for which at least one sliding window contains at least one outcome of failure) to negative patients is kept uniform across folds."}, {"section_title": "Further analysis", "text": "In addition, we utilize output scatters to aid our understanding of the input-output relationship. We use MC dropout to generate average responses by explicitly varying one input feature at a time [47] in equation 6. This is done by either (1) varying only the final value of the measurement within the sliding window, or by (2) varying all values of the measurement the same time. While the latter gives insight into how the response changes with respect to a difference in levels, the former sheds light on how the response is affected by a sudden change instead. Interestingly in the case of temporal convolutions, for multiple features ( Figure 5 shows the MMSE and CDRSB features as examples) the response is actually stronger to final value changes. This effect is not present in any feature for multilayer perceptrons. In light of the performance of convolutional models, this is consistent with our hypothesis that they appear able to learn more complex temporal patterns than multilayer perceptrons; in this case, these results suggest that a patient who experiences a sudden decline in certain features is expected to fare worse than one who has always scored just as poorly all along. "}, {"section_title": "Sources of gain", "text": "While the advantage of using multilayer perceptrons over traditional statistical survival models has been studied (see [29] for example), here we account for the additional sources of gain from our design choices. Table 5 "}]
[{"section_title": "Abstract", "text": "In this paper we develop a Bayesian bivariate spatial group lasso model for multivariate regression analysis applicable to studies examining the influence of genetic variation on brain structure. Our model is motivated by an imaging genetics study of the Alzheimer's Disease Neuroimaging Initiative (ADNI), where the objective is to examine the association between images of volumetric and cortical thickness values summarizing the structure of the brain as measured by magnetic resonance imaging (MRI) and a set of 486 SNPs from 33 Alzheimer's Disease (AD) candidate genes obtained from 632 subjects.\nA bivariate spatial process model is developed to accommodate the correlation structures typically seen in structural brain imaging data. First, we allow for spatial correlation in the imaging phenotypes obtained from neighbouring regions on the same hemisphere of the brain. Second, we allow for correlation in the same phenotypes obtained from different hemispheres (left/right) of the brain. To do this we employ a proper bivariate conditional autoregressive spatial model for the errors in a bivariate spatial regression model. In addition to spatial correlation, we encourage sparsity in the regression coefficients relating each SNP to the brain imaging phenotypes by assigning a group lasso prior and using the corresponding Gaussian scale-mixture representation to * The authors wish it to be known that the first two authors should be regarded as joint First Authors.\n\u2020 Corresponding Author: nathoo@uvic.ca. We implement the new model, the new algorithms, and Bayesian FDR for this model in a new a release of the R package bgsmtr for imaging genetics. This package is available for download on the Comprehensive R Archive Network (CRAN). In our motivating imaging genetics study of the ADNI database we fit both the proposed spatial model and a non-spatial group-sparse multi-task regression model based on previous work. We show that the new spatial model demonstrates superior performance and thus the use of a spatial model is practically useful for our application."}, {"section_title": "INTRODUCTION", "text": "We consider multivariate multiple regression modeling within the context of imaging genetics where interest lies in uncovering the associations between genetic variations and neuroimaging measures as quantitative traits (QTs). This problem has received a great deal of attention recently and is challenging because it combines the analysis of neuroimaging data with genetic data (see e.g., Vounou et al., 2010; Stein et al., 2010; Silver et al., 2010; Inkster et al., 2010; Hibar et al., 2011; Ge et al., 2012; Thompson et al., 2013; Stingo et al., 2013; Zhu et al., 2014; Hibar et al., 2015; Huang et al., 2015; Huang et al., 2017; Lu et al., 2017) . Recent reviews of statistical issues in this area are discussed in Liu and Calhoun (2014) and Nathoo et al. (2018) .\nThe neuroimaging measures can serve as endophenotypes for neurological disorders such as Alzheimer's disease (AD). AD has been considered widely as an application in imaging genetics with many recent studies focussing on the ADNI database. As described in Szefer et al. (2017) , the estimated heritability of late-onset AD is 60 -80 percent (Gatz et al., 2006) . The largest susceptibility allele is the 4 allele of APOE (Corder et al. 1993) , which may play a role in 20 to 25 percent of AD cases. The remaining heritability of AD may be explained by many additional genetic variants and these may have a small effect.\nData analysis within this setting can range from studies considering a specific candidate region of interest (ROI) within the brain and a specific candidate genetic marker in the simplest case, to massive brain-wide genome-wide analyses in the most challenging case. In our work, we consider the intermediary setting where interest lies in assessing the association between a moderate number of brain imaging phentoypes (e.g., 111 ROIs in Vounou et al., 2010; 12 ROIs in Wang et al., 2012; 93 ROIs in Zhu et al., 2014; 56 ROIs in Greenlaw et al., 2017) and with the number of SNPs ranging from between a few hundred to a few thousand. Within this setting a multivariate model with regression matrix jointly characterizing the associations between all ROIs and genetic markers is feasible; although, as detailed in the aforementioned references, we still face a challenging multivariate potentially high-dimensional regression problem. Greenlaw et al.(2017) recently proposed a Bayesian group sparse multi-task regression model where the primary focus is the use of a new shrinkage prior based on a product of multivariate Laplace kernels developed following the ideas of Park and Casella (2008) and Kyung et al. (2010) .\nThe specific prior developed in Greenlaw et al.(2017) is motivated by the penalized multi-task regression estimator proposed by Wang et al. (2012) . This development is an effort to move from point estimation to Bayesian credible intervals in a generalization where the mode of the posterior distribution in the model of Greenlaw et al. (2017) is exactly the estimator proposed by Wang et al. (2012) .\nWhile Greenlaw et al. (2017) demonstrate the advantage of uncertainty quantification in their imaging genetics application to the ADNI study, their model makes a simplifying assumption for the covariance matrix of the imaging phenotypes, where the first level of their model assumes:\nwhere y = (y 1 , . . . , y c ) T denotes the vector of imaging phenotypes for subject , where = 1, . . . , n; W is the regression matrix; x = (x 1 , . . . , x d ) T , where x denotes the vector of genetic markers for subject . The assumed covariance structure ignores spatial correlation as well as bilateral correlation across brain hemispheres. By the latter we mean correlation in similar structures on opposite hemispheres of the brain (e.g., a priori we expect the volume of the right hippocampus to be correlated with the volume of the left hippocampus).\nWe develop a new model that allows for this type of correlation by adopting a proper bivariate conditional autoregressive process (BCAR; see, e.g., Gelfand and Vounatsou, 2003; Jin et al., 2005) for the errors in the regression model. While spatial models for functional magnetic resonance imaging (fMRI) and other neuroimaging modalities have been developed to a large extent (see, e.g., Penny et al., 2005; Bowman, 2005; Bowman et al., 2008; Derado et al., 2013; Teng et al., 2018a; Teng et al., 2018b) , to our knowledge there has been very little development of explicitly spatial models for imaging genetics. One exception is the mixture model developed by Stingo et al. (2013) where an Ising prior, a binary Markov random field, is used for Bayesian variable selection.\nOur model is rather different in both its aims and structure as it is based on a continuous bivariate Markov random field that is specified at the first level of the model for the imaging data directly.\nTypically, models incorporating multivariate CAR specifications are used for modelling observations (in the case of a proper CAR model) or spatially-varying parameters when multiple observations or parameters appear at each spatial site. For our application the use of this process is non-standard in the sense that we do not model multiple observations at each site, but rather, we pair corresponding observations on opposite hemispheres of the brain and use the bivariate spatial process to model a combination of the bilateral correlation across the left and right brain hemispheres as well as the spatial correlation within each hemisphere. As a matter of fact for the MRI data considered in our application the bilateral correlation is the stronger signal in the observed data and so it is important to account for it.\nFor the bivariate spatial model we use a separable BCAR process as it is reasonable in our application to assume (as it might be in many neuroimaging studies) that the spatial structure on the two hemispheres of the brain is similar. Non-separable multivariate spatial models (see, e.g., Gelfand and Banerjee, 2010; MacNab 2016) could be adopted for more flexibility allowing the spatial structure on the two hemispheres to be different; however, we do not expect that this additional flexibility would be useful in the current context. This spatial process is combined with a group Lasso prior for the regression coefficients, where each group corresponds to a single row of W. Each row in this case represents the associations between a given SNP and the phenotypes across all ROIs. We employ a bivariate Gaussian scale mixture representation of a group Lasso prior in order to facilitate Bayesian computation.\nTo compute the posterior distribution we develop two algorithms, both of which are implemented in our R package bgsmtr for imaging genetics regression modelling. The first is a Gibbs sampling algorithm and the second is a faster mean-field variational Bayes (VB) approximation to the posterior distribution (see e.g., Ormerod and Wand, 2010; Nathoo et al., 2013; Teng et al., 2018a; Teng et al., 2018b) . Within the context of hierarchical models for spatial data, mean-field VB inference has been considered by Ren et al. (2011) . In addition to the computation of the posterior distribution, the bgsmtr package now incorporates Bayesian FDR procedures (Morris et al., 2008) for SNP selection. This can be used alongside or as an alternative to SNP selection based on credible intervals.\nThe overall contribution of our work is four-fold. First, we develop an explicitly spatial model for imaging genetics based on the BCAR process. Second, we develop both an MCMC algorithm and a mean-field VB algorithm for approximating the posterior distribution. Third, we incorporate Bayesian FDR procedures for SNP selection within the new spatial model. Fourth, our new developments are implemented in the latest version of the bgsmtr R package that is available for download on CRAN.\nThe remainder of this paper is structured as follows. In Section 2, we present our new spatial model that has been motivated by the ADNI-1 study. Computation of the posterior distribution and SNP selection is discussed in Section 3. In Section 4 we apply our new model to our motivating application examining data from the ADNI-1 study, examining 56 structural brain imaging phenotypes, 486 SNPs from 33 genes, and 632 subjects. The paper concludes with a discussion in Section 5."}, {"section_title": "BAYESIAN SPATIAL REGRESSION MODEL", "text": "Let y = (y 1 , . . . , y c ) T and x = (x 1 , . . . , x d ) T denote the imaging measures at c ROIs and the genetic data respecitvely for subject , = 1, . . . , n, where x j \u2208 {0, 1, 2} represents the number of minor alleles of the j th SNP for subject . The regression model takes the form E(y ) = W T x , = 1, . . . , n, where W has dimensions d \u00d7 c and W ij represents the association between the i th SNP and the j th ROI imaging phenotype.\nOur model is developed for settings where the imaging data are symmetric with the same measures collected on each hemisphere of the brain. This is true when the neuroimaging data are considered at the voxel level and it is also the case for the study considered here where we analyze MRI data from the ADNI-1 database preprocessed using the FreeSurfer V4 software. The\nFreeSurfer software is used to conduct automated parcellation to define volumetric and cortical thickness values from the 28 ROIs considered in Shen et al. (2010 ), Szefer et al. (2017 , and Greenlaw et al. (2017) on each hemisphere leading to c = 56 brain measures in total.\nAs described in Szefer et al. (2017) , potential confounders in the analysis are population stratification and APOE genotype. Since true population structure is not observed, a set of principal coordinates from multidimensional scaling are used to derive proxy variables for population stratification in the data. We also adjust for APOE genotype, since it can account for the population stratification in the data, over and above the principal components or principal coordinates (Lucotte et al. 1997 ).\nThe response imaging measures at each brain ROI are first adjusted for the ten principal coordinates, as well as for dummy variables representing APOE genotype, using weighted ordinary least squares regression. The residuals from each regression are then used as the adjusted neuroimaging phenotypes (Szefer et al., 2017) .\nli ) be the brain summary measures obtained at the i th ROI in the left hemisphere (L) and the right hemisphere (R). Then y = (y 1 , . . . , y c/2 ) is the imaging data ordered so that left-right imaging phenotype pairs are adjacent in the response vector. There are thus c/2 ROIs on each hemisphere and we let A denote a c/2 \u00d7 c/2 symmetric neighborhood matrix which in the simplest case can have binary elements, where A ij = 1 indicates that ROI i and j are neighbors i = j, or more generally A ij \u2265 0 and A ii = 0, i = 1, . . . , c/2. The bgsmtr R package allows the user to specify the neighborhood matrix A or in the absence of user input takes A ij to be the average of the absolute value of the sample correlation between ROI i and ROI j, where the average is taken over left/right hemisphere. The regression model then takes the form\nand the model for the errors is a mean-zero multivariate normal distribution of dimension c, which can be specified through a set of c/2 compatible bivariate conditional\nli ) , specified as follows:\nwhere \u03c1 \u2208 [0, 1) characterizes spatial dependence with \u03c1 = 0 corresponding to independence across all ROI pairs and \u03a3 is a 2 \u00d7 2 matrix where \u03ba = \u03a3 12 / \u221a \u03a3 11 \u03a3 22 \u2208 (\u22121, 1) quantifies within pair dependence, and with \u03ba = 0 corresponding to independence within ROI pairs. As far as we are aware, this spatial model for neuroimaging data is one of the first to explicitly model dependence across brain hemispheres in addition to accounting for local spatial dependence.\nUnder this new specification the first level of the regression model takes the following form:\nwhere\nFor the regression coefficients, we let\n2 , and we adopt a shrinkage prior based on a bivariate scale mixtureW\nwhere \u03c1 and \u03bb 2 are tuning parameters controlling spatial dependence and regression sparsity respectively. These can be varied across a coarse grid and selected using information criteria. In our application we select these parameters using the WAIC as recommended in similar contexts by Greenlaw et al. (2017) and Nathoo et al. (2016) . Alternatively, \u03c1 can be fixed at a default value of \u03c1 = 0.95 corresponding to a relatively high level of spatial correlation when this is a reasonable assumption, and \u03bb 2 can be varied over a range of values with the number of active SNPs recorded for each such value. The results can then be summarized based on a desired or expected level of sparsity. The remaining hyperparameters v and S are set at v = 2 and S = I to yield a prior that is somewhat vague, and they can be varied as part of a sensitivity analysis."}, {"section_title": "COMPUTATION AND SNP SELECTION", "text": ""}, {"section_title": "Bayesian Computation", "text": "Bayesian inference for our proposed model is based on the posterior distribution P (\u0398|Y), where Algorithm 1 Gibbs Sampling Algorithm 1. Set tuning parameters \u03bb 2 and \u03c1.\n2. Initialize W , \u03a3, \u03c9 2 and repeat steps (3) - (6) below to obtain the desired Monte Carlo sample size after burn-in.\n3. For k = 1, ..., d, update W (k)T as:\n4. Where:\n5. Update \u03a3 as:\nwhere:\nwhere:\nAlgorithm 2 mean-field Variational Bayes Algorithm 1. Set tuning parameters \u03bb 2 and \u03c1.\n2. Initialize q (W ) , q (\u03a3) , q (\u03c9 2 ) and cycle through steps (3) -(5) below until the increase in the lower bound L(q) is negligible.\n3. For k = 1, ..., d, update\nwhere:\nAs a faster albeit more approximate approach to computing the posterior distribution, we also develop a mean-field VB algorithm. As opposed to Monte Carlo sampling, variational inference is based on solving an optimization problem. The approximation q(\u03b8) to the posterior distribution P (\u03b8|Y) is based on constructing and optimizing a lower bound on the marginal likelihood P (Y).\nAssuming that q(\u03b8) has the same support as P (\u03b8|Y), the log-marginal likelihood can be written\nHere, KL(q||p) denotes the Kullback-Leibler divergence from q to p and the final inequality is true since KL(q||p) \u2265 0. The approximation to P (\u03b8|Y) by q(\u03b8) is obtained by restricting q(\u03b8) to a manageable class of distributions and maximizing the lower bound F(q, Y) (which is equivalent to minimizing KL(q||p)) over that class. In the case of mean-field VB, the restriction of q(\u03b8) is to a product form q(\u03b8) = J j=1 q j (\u03b8 j ). In the specific context of our model the assumed product form is a follows\nwhere W (k) is the k th row W .\nWe maximize the functional F(q 1 , . . . , q J , Y) over the q j 's using a coordinate ascent procedure.\nThe update steps for this procedure take the form (see, e.g., Ormerod and Wand, 2010) \nwhere the expectation is taken with respect to q \u2212i (\u03b8 \u2212i ) = l =i q l (\u03b8 l ). This leads to a set of update equations related to the EM algorithm (Beal, 2003) that are iterated until convergence to a local optimum. These update equations are presented in Algorithm 2 and their derivations are detailed in the Supplementary Material (Web Appendix B). On convergence the approximation to the posterior distribution is based on (4) as well as the solutions\nwhere the statistics\nobtained as the output of the iterative Algorithm 2."}, {"section_title": "Bayesian FDR", "text": "The Bayesian FDR procedure applied in our work for SNP selection follows the approach developed in Morris et al. (2008) , but it has been adapted and implemented for the current spatial model. We assume that we have N samples W Given this value, we compute a posterior tail probability for the i-th SNP at region j as p ij = P r(|W ij | > c * |Y), i = 1, . . . , d; j = 1, . . . , c, which can be approximated by\nij | > c * and we replace any p ij = 1 with 1 \u2212 (2N ) \u22121 . Given these posterior tail probabilities and a desired global FDR-bound \u03b1, we denote by \u03c6 \u03b1 the corresponding threshold chosen so that a SNP-region pair (i, j) is selected if p ij > \u03c6 \u03b1 . The cut-off \u03c6 \u03b1 can be com- "}, {"section_title": "ADNI-1 STUDY OF MRI AND GENETICS", "text": "We apply our spatial model as well as the group sparse multi-task regression model of Greenlaw et al. (2017) to MRI and genetic data collected from n = 632 subjects from the ADNI-1 database.\nThe response measures are obtained by preprocessing the MRI data using the FreeSurfer V4 software which conducts automated parcellation to define volumetric and cortical thickness values from the 28 ROIs considered in Shen et al. (2010 ), Szefer et al. (2017 , and Greenlaw et al. (2017) on each hemisphere of the brain, leading to c = 56 brain measures in total. These ROIs are chosen based on prior knowledge that they are related to Alzheimer's Disease and are described in detail in Table 2 of Greenlaw et al. (2017) . (2012), with the exception that we require a more conservative genotyping call rate of at least 95% (Ge et al. 2012 ).\nWe fit our new spatial model to these data using both Algorithm 1 (Gibbs sampling) and Algorithm 2 (VB). In addition, we fit the model developed in Greenlaw et al. (2017) FDR as a function of the tuning parameter \u03bb 2 for both Gibbs sampling and VB. As expected, the curves are monotone decreasing but it is interesting to note that their shapes differ when comparing the algorithms. In particular, VB selects a larger number of SNPs at all values of \u03bb 2 . This suggests that the VB algorithm is a fairly rough approximation since MCMC is a gold standard and it has associated consistency guarantees (Robert and Casella, 2004) . The VB algorithm is thus best suited for obtaining starting values to initialize the MCMC, and it can also be used as a tool to gain some initial insight (based on the mean-field approximation) into the data while the MCMC sampler runs to completion. This is useful because the MCMC sampler requires a relatively long run time, and the VB algorithm can be used initially (requiring 30 minutes in our study) while the MCMC sampler runs (requiring 50 hrs in our study). For the values of the tuning parameters selected by WAIC (\u03c1 = 0.8, \u03bb 2 = 10, 000) the average number of SNPs selected per ROI is 2, while more than half of the ROIs have no SNPs selected. In total, 75 SNPs across all 56 ROIs are selected and these are listed in Table 1 by MCMC is a proper subset of the set selected by VB. In addition, the subset of SNPs and phenotypes also selected by the approach of Greenlaw et al. (2017) where the marginal posterior 95% credible interval is used for SNP selection are also highlighted in bold in Table 1 Considering all three approaches, the most consistent signal is found at the APOE gene, where all three methods select SNP rs405509 and find associations with right-Midtemporal (thickness of the middle temporal gyrus), right-Supramarg (thickness of the supramarginal gyrus), right-MeanFront (mean thickness of Fusiform, parahippocampal, and lingual gyri, temporal pole and transverse temporal pole), and finally right-MeanLatTemp (mean thickness of the Inferior temporal, middle temporal, and superior temporalgyri). It is pertinent to note that this SNP is the only APOE SNP contained within the set of 486 targeted SNPs included in our study. It is also interesting to note that the selected associations for this SNP all correspond to ROIs in the right brain hemisphere.\nThe associated point estimates and 95% credible intervals for the four ROIs are given in Table 1, for both the spatial and original model. Both models yield very similar posterior summaries and all of these indicate a positive association between the imaging phenotypes and the number of APOE rs405509 minor alleles. Another consistent signal is found at the ACE gene with SNP rs4311, which is found associated with 12 ROIs. We note that all but one of these ROIs is in the right hemisphere, and three of these ROIs (all of which are in the right hemisphere) are in common with the ROIs selected for this SNP by Greenlaw et al. (2017) .\nIn Figure 3 Examining Figure 3 , two ROIs stand out has having a relatively broad genetic signal that persists even as the tuning parameter increases from \u03bb 2 = 1000 to \u03bb 2 = 10, 000. These are LeftSupramarg (thickness of the left supramarginal gyrus) and Left-SupTemporal (thickness of the left superior temporal gyrus). For the case where \u03bb 2 = 1000 phenotype Left-Supramarg is associated with 188 SNPs (top panel of Figure 3 ) and this decreases to 24 SNPs (bottom panel of Figure 3) when \u03bb 2 = 10, 000. When \u03bb 2 = 1000 phenotype Left-SupTemporal is associated with 188 SNPs and this decreases to 23 SNPs when \u03bb 2 = 10, 000. This is to be compared with the average number of SNPs selected over all ROIs when \u03bb 2 = 10, 000 which is just 2."}, {"section_title": "CONCLUSION", "text": "We have developed a spatial multi-task regression model for relating genetic data to multivariate imaging phenotypes. The model uses a shrinkage prior with group penalization for the coefficients of each SNP (rows of W) in the regression structure and the error structure for the imaging phenotype is based on a proper bivariate conditional autoregressive model, which allows for both spatial correlation as well as bilateral correlation across brain hemispheres. Ours is one of the first explicitly spatial hierarchical models for imaging genetics and neuroimaging to account for both spatial correlation and bilateral correlation. The new model along with Bayesian FDR procedures and both VB and Gibbs sampling algorithms are implemented in the latest version of the bgsmtr R package.\nWith regards to the two computational algorithms, we recomend that the approximate VB procedures be used to initialize the MCMC algorithm and also to obtain an initial insight into the data while the MCMC sampler runs. It appears that VB combined with Bayesian FDR tends to be too liberal in selection of SNPs, and in our application the SNP-ROI pairs selected by MCMC + Bayesian FDR are a proper subset of that selected by VB + Bayesian FDR.\nOur analysis of the ADNI-1 data found a consistent signal from APOE SNP rs405509 as well as ACE SNP rs4311. In both cases phenotypes in the right hemisphere of the brain seem to be favored. In terms of having a broad genetic signal, the thickness of the left supramarginal gyrus and the thickness of the left superior temporal gyrus seem to be associated with the largest number of SNPs.\nWhile our current methodology is best suited for situations where the analysis is focussed on a relatively small set of targeted SNPs (no more than a few thousand) and a moderate number of ROIs (no more than 100), these are settings in which a full multivariate model fomr imaging genetics can be specified and fit. Extending applicability of the methodology to settings with massive numbers of genetic and neuroimaging variables is an avenue for future work. Divide and conquer strategies such as the consensus Monte Carlo algorithm (Scott et al., 2016) as well as splitting up the brain into a smaller number of sub-regions might lead to feasible implementations for such settings. Their design and implementation for imaging genetics should prove to be a substantial challenge.\nSzefer, E., Lu, D., Nathoo, F., Beg, M. F., Graham, J. et al. (2017) Bayesian FDR at \u03b1 = 0.05. SNPs and phenotypes in bold correspond to those also chosen using 95%\ncredible intervals and the model of Greenlaw et al. (2017) .\nContinued on next page Table S1 -Continued from previous page\nContinued on next page Table S1 -Continued from previous page The full conditional distribution of W (k)\nThe full conditional distribution of W (k) , k = 1, . . . , d is expressed as\nwhere\nSince we already have the full conditional distribution, the mean field approximation for variational bayes can be derived as:\nWe still can see that q((W (k)T )) is still MVN with\nAlso, we can find that:\nThen, we can also compute:\nFull conditional distribution of \u03a3:"}]
[{"section_title": "Abstract", "text": "Examples of control problems occurring during flight tests of fighter aircraft are well documented. In many cases, the cause of the problem could be characterised as inadequate modelling or other inappropriate treatment of the aeroelastic effects on the vehicle dynamics and/or the flight-control design. However, such problems are not restricted to just aircraft. Especially long and slender bodies, such as (small) conventional launch systems, may suffer from an unwanted coupling between the rigid body and its flexible modes. In addition, due to fuel consumption during the flight, the change in atmospheric environment, and aerodynamic effects, the entire flight profile should be examined, rather than a single worst-case point, to identify the stability and controllability performance of the launch vehicle. The current research treats the launch vehicle as a flexible beam with lumped masses to account for the subsystems and fuel, using a three-dimensional assumedmodes method with longitudinal and lateral effects. Sloshing is added to the system as a spring-mass-damper, where the liquid oxidiser and fuel are modelled separately. Multiple discrete flight points are considered for aeroelastic analysis at different stages of the ascent profile. These individual points are analysed as quasi-static and quasi-steady inputs for a continuous flight trajectory simulation. The stability and controllability for the entire flight under the influence of wind gust and turbulence is estimated based on this simulation. While simulating the manoeuvres with the sloshing model included it became apparent that the (very) simple PD controller was not able to stabilise the vehicle. Results concerning the influence of sloshing can therefore not be shown. The development of a more robust adaptive controller is currently on its way, and it is expected that this non-linear controller will be better suited to handle the strong non-linearities of the combination of flexibility, sloshing and a demanding wind environment. * Assistant Professor, Section Astrodynamics and Space Missions, e.mooij@tudelft.nl, Associate Fellow AIAA. \u2020 Master Lecturer, dgransden@laurentian.ca."}, {"section_title": "I. Introduction", "text": "From the early days in aeronautical engineering, where wing divergence and control reversal were among the problems to solve for aircraft design, to dynamic flutter calculations to avoid wing failure, static and dynamic aeroelasticity issues have caused many control challenges and even loss of (fighter) aircraft during high-speed manoeuvring. 1 However, aeroelastic effects are not restricted to aircraft alone. Especially long and slender bodies, such as (small) conventional launch systems, may suffer from an unwanted coupling between the rigid body and its flexible modes. However, this is not an isolated problem. Due to fuel consumption during the flight, the change in atmospheric environment and flight conditions, as well as aerodynamic effects, the entire flight profile should be examined rather than a single worst-case point, to identify the stability and controllability characteristics of the launch vehicle. The potential motion of a volume of (liquid) fuel and oxidiser, a phenomenon known as sloshing, further complicates the situation. The dynamic effect due to sloshing is not constant, since the liquid mass as well as the tank filling grades change significantly during the flight.\nThe stability of aeroelastic bodies, such as missiles and launchers, has been studied since the 1960s 2, 3, 4 and invariably focussed on the interaction between rigid and flexible modes, and the response to wind gust and turbulence, or the impact of aeroelasticity on control-system stability margins, e.g., the work covered in Ref. 5 . Even though the models for the flight dynamics are non-linear and derived with a Lagrangian approach, the analysis models are often linearised, see, for instance, Refs. 6 and 7. However, in some cases, the non-linear model is used to study the elastic dynamic effects on the trajectory. 8 Aerodynamics models used vary from engineering methods, such as slender-body theory, 9 to linear quasi-steady piston theory, 10 or processed data from CFD analyses. 6, 8 In many studies, though, details in vehicle and model data are not published, which makes it hard to reproduce the analysis results.\nThe coupling effects between the rigid body and its flexible modes should not only be studied in the detailed design phase, but preferably at an early stage, such that information about stability and controllability can be fed into the structural-design process, and vice versa, information about aeroelasticity can be used in the analysis of flight performance, and the design and analysis of the control system. In the conceptual design phase, one wants to refrain from detailed finite element (FE) or computational fluid-dynamics (CFD) modelling, especially when many of the design choices on shape, layout and sub-systems have not yet been made.\nPrevious work focussed on the effect of aeroelasticity on launch vehicle stability, controllability, and controller performance in a single point during the ascending flight, 11 as well as the additional effect of wind gust and turbulence during the trajectory from lift off to burnout of the first stage, taking transient effects into account. 12 That work will now be extended to include slosh dynamics, and also now a (pseudo-)transient analysis is performed from launch to first-stage burn out to determine the stability margins and controllability issues due to turbulence and wind gusts. Results for the case with slosh included are compared with a benchmark case without slosh to assess its effect.\nAs a reference, the two-stage PacAstro launcher for small payloads up to 225 kg has been selected for its availability of some geometrical and structural data a . The launcher is treated as a flexible beam with lumped masses to account for the subsystems and the fuel. Modelling of the slosh motion is done for oxidiser and fuel separately, with one tank each per stage of the selected two-stage launcher.\nThe layout of this paper is as follows. Section II will discuss the slosh-dynamics model, whereas in Sec. III, the state-space model is formulated. This is done in two parts, i.e., first the model that combines the rigid-body modes with the flexible-body modes and the employed engine-swivel model is summarised, and second the slosh dynamics is introduced, including the coupling with the model of the flexible launcher. The analysis of the stability and controllability of the launcher is presented in Sec. IV. Section V, finally, concludes this paper."}, {"section_title": "II. Slosh Dynamics Model", "text": "A detailed analysis of slosh dynamics would require extensive CFD calculations that can predict the motion of the liquid. However, coupling the equations of motion of a flexible space vehicle to the equations of motion of a continuous liquid is too computationally heavy for ordinary design analyses, especially in the preliminary design phase when many runs have to be executed. It is therefore more practical to replace the liquid conceptually by an equivalent linear mechanical system, and thus include the dynamic effects of sloshing in the launcher control and stability analysis. The two most commonly used mechanical motion models are that of a spring-mass-damper and a (damped) pendulum, attached at a time-dependent location inside the tanks. Formulations for either model are dependent on the shape of the tank, e.g., being cylindrical, rectangular, spherical or tear drop. Circular cylindrical tanks are widely used in launch vehicles and spacecraft, and are thus the preferred tank shape for the mechanical model.\nIn the current study, the slosh model for a cylindrical tank (partially) filled with fuel or oxidiser will be a PacAstro was a US transportation service company, formed in 1990, to provide low-cost transportation of small satellites to Low Earth Orbit for approximately $5 million per launch using proven technology. ? Unfortunately, the launcher never came to operation despite several engine tests and three launch contracts, due to the lack of development funding. The company ceased to be in 1997. based on a mass-spring system. The main parameters to evaluate the state-space model to be discussed in the next section are the eigenfrequency, \u03c9 s,j , of the j th slosh mode and the corresponding damping factor, \u03b6 s,j . These parameters are a function of the (time-dependent) filling grade of the tanks, as well as the type of liquid through its density. Additional parameters are the slosh mass, m s,j , and slosh-mass location, x s,j . Abramson, in Refs. 13 and 14, as well as Dodge in Ref. 15 , provide a simple model to calculate n s eigenfrequencies for different tank shapes, including the cylindrical one.\nLet the geometry of the cylindrical tank be defined by its height, h, and diameter, d. A volume-based filling grade of x f ill means that the actual liquid level is equal to h = x f illing h. Figure 1 shows a schematic of the slosh-mass configuration for the lateral-induced motion. Indicated in the figure are the first two slosh modes, represented by a damped mass-spring system with mass m s , spring stiffness, k s , and damping, c s . The mass m 0 is a static mass, i.e., that portion of the liquid that does not move. At some point in time, though, when the tank has significantly emptied, all remaining liquid can slosh and m 0 has become zero.\nThe eigenfrequency \u03c9 s,j is defined to be:\nwith k s,j being the equivalent spring stiffness for mode j, and m s,j the mass of the moving part of the liquid. k s,j and m s,j are given by:\nIn the above equations, \u03be j are the roots of specific Bessel functions, 14 and are for n s = 5 given by \u03be 1 = 1.841, \u03be 2 = 5.331, \u03be 3 = 8.536, \u03be 4 = 11.706, and \u03be 5 = 14.864, respectively. Values for higher modes can be approximated by \u03be j+1 \u2248 \u03be j + \u03c0.\nThe portion of the liquid that moves has a distance to the current tank centre of mass of\nwhereas the location and mass of the non-moving part are:\nThe total mass of the liquid, m liq , is, of course, a function of the filling grade, the geometry of the tank, and the liquid density, \u03c1 liq . For the cylindrical tank, this is:\nFor the current study, the first stage of the PacAstro has an LOX tank b (h = 5.73 m, d = 1.8288 m, \u03c1 LOX = 1070 kg/m 3 ) and a fuel tank with RP1 (h = 2.96 m, d = 1.8288 m, \u03c1 RP 1 = 805 kg/m 3 ). The oxidiser and fuel flows are constant (\u1e41 LOX = 134.1 kg/s and\u1e41 RP 1 = 55.9 kg/s, based on an oxidiser/fuel mixture ratio of 2.4), which means that the filling grade is linearly decreasing with burn time.\nAs an example, the first four slosh modes as a function of filling grade, x f illing , are shown in Fig. 2 for the LOX tank of the first stage. The total LOX mass at lift off (filling grade of the tank is 100%) is m LOX1 = 17,482.2 kg. This mass can be divided into a so-called static mass, m 0 , that does not move and a slosh mass, m s , contained in multiple modes, where most slosh mass is concentrated in the first mode. From Fig.  2 (a) it can be seen that the first mode's slosh mass is about 1,170 kg, with the other three modes making up 35.2, 8.4 and 3.2 kg, respectively. For flight control, it is therefore justified that the primary motion of concern is the first lateral slosh mode of the liquid surface. Figure 2 (b) shows the natural frequencies that are constant for a large range of the filling grade (typically from 20% upwards). The steady state values are 4.44 rad/s, 7.56 rad/s, 9.57 rad/s and 11.20 rad/s for increasing modes. These frequencies are all relatively close together, although, as mentioned, the effect of the higher modes is almost negligible due to the very small slosh mass involved. For lower filling grades, there is a steep decline of about 60% in natural frequency, but also the corresponding slosh mass is reduced significantly -the slosh mass of the first mode decreases from around 1,160 kg (from 100% down to 20% filling grade) to 990 kg at 10% and 650 kg at 5%. Of course, the slosh mass cannot be regarded in isolation; the static liquid mass is about 15,000 kg for a full tank, which is, of course, significantly larger. However, the motion of an 1,160-kg slosh mass is expected to affect the launcher's stability and controllability.\nLast, but not least, in Fig. 2 (c) the location of the slosh masses with respect to the filled tank's centre of mass is shown. By definition, the slosh mass is located above this centre of mass (see Fig. 1 ), whereas the static mass is located below. That is, until the tank is emptied so far that all liquid is sloshing. That means that m 0 has become zero, which happens at a filling grade of x f illing \u2248 33%. The first mode's mass location moves under the local centre of mass; the higher-modes' slosh masses are still located above. The last element to be discussed is the damping of the slosh modes. Since we established that only the first slosh mode is of importance, only a single formulation for the damping ratio is required. In the 1960s, when a major launcher development took place, many experimental tests were conducted to establish the key parameters (m s , \u03c9 s , k s , h s , and damping properties) for simple geometrical tank shapes, see, for instance the work by Stephens et al. 16 or the references provided in Refs. 13 and 15. Due to limited computational power, several analytical approaches were developed. It was found that viscous effects in the liquid are the dominating ones, and based on the experimental data damping values can be given in functional form as 15\nwhere \u03b6 s is the damping ratio c and Re is a dimensionless parameter analogous to an inverse Reynolds number:\nwith r being the tank radius, g the acceleration due to gravity, and \u03bd the kinematic viscosity of the liquid. The experimental study by Stephens et al. 16 found the following correlation for the primary slosh mode:\nc The damping ratio can be considered as a percentage of the critical damping ratio (\u03b6 s,crit = 1) of the amplitude of the free surface oscillation 5 of 20\nAmerican Institute of Aeronautics and Astronautics Re. The values for the kinematic viscosity that we will use are \u03bd = 0.164\u00b710 \u22126 m 2 /s for liquid oxygen at 100 K and 200 bar e , and 2.166\u00b710 \u22126 m 2 /s for RP-1 at 293 K and 1 bar. 21 Using the same geometry and mass data as before, for full first-stage LOX and fuel tanks the damping factors are \u03b6 s,LOX = 0.0002 (0.02%) and \u03b6 s,RP \u22121 = 0.0007 (0.07%), which are in the same range as those published in Ref. 20 ."}, {"section_title": "III. Pitch-Plane State-Space Model", "text": ""}, {"section_title": "A. Flexible Launcher", "text": "To investigate the stability and control characteristics of flexible launchers, for a first analysis it suffices to consider the (linearised) pitch-plane motion only. In Ref. 11, a state-space model describing the error dynamics of a flexible launcher has been derived, of which the configuration is shown in Fig. 3 . For that error-dynamics model, input is a modal description as a function of current mass, the normal-load and pitchmoment distribution, and, of course, the flight conditions. The mass matrix is created using a consistent formulation for a linearised beam element. Furthermore, the launcher is assumed to move with a steadystate velocity u 0 , and the local deformation is determined by the combination of thrust, T , gravity, mg d , aerodynamic normal force, N , and aerodynamic pitch moment, M .\nIn its general form, the system equation of this state-space model is given b\u1e8f\nwith A and B being the the system and control matrix, respectively. Due to the different nature of groups of state variables, it makes sense to partition A and B into sub-matrices representing the rigid-body motion, the engine dynamics, and the flexible-body motion, thereby identifying the coupling terms between the different sets. The corresponding state-space matrices are then written as: Dennehy 20 verified that the empirically computed 1-g minimum slosh mode damping value for the Orion Nitrogen Tetroxcide oxidiser tank was 0.0003 (0.03%), whereas the one for the Monomethyl Hydrazine fuel tank was 0.0006 (0.06%). Using K = 0.83 for the full LOX and RP-1 tank gives comparable values, so this value for K will therefore be employed here. 2. E for the engine states\u03b5 T (angular acceleration),\u03b5 T (angular velocity) and \u03b5 T (the angular position or swivel angle). These states originate from the assumption that the engine is modelled as an electrohydraulic servo system, represented by a third-order transfer function;\n3. F for the flexible-body states\u03b7 i and \u03b7 i for mode i. The total number of states in this group depends on how many bending modes n f are taken into account.\nThe state vector, x, is thus given by\nThe only control is the commanded swivel angle, so u = \u03b5 T,c . In Ref. 11 each of the sub-matrices has been derived, and the final result is stated here as starting point for the development to include the slosh dynamics. The rigid-body sub-matrices (including coupling terms), A RR , A RE and A RF , are given by:\nu0 C Nqq S ref mu0\nwith, for i = 1, ..., n f :\nIn the above equations, m and I yy are the (current) mass and moment of inertia of the launcher, m e and I e the mass and moment of inertia of the engine, and \u2206L cm,e is the distance from gimbal point to centre of mass of the engine. C N\u03b1 and C Nq are the normal-force gradients with respect to \u03b1 and q, and C m\u03b1 and C mq are the corresponding pitch-moment gradients. Due to the bending of the launcher frame, local aerodynamic force and moment effects are introduced through the gradients C N\u03b7 i , C N\u03b7 i , C q,\u03b7i and C m\u03b7 i , details of which are provided in Ref. 11 . Finally, \u03c6 i (x) and \u03c3 i (x) are the modal-mass normalised i th bending shape and slope at location x, in this case the engine location x e . The engine is considered to be an electro-hydraulic servo system, approximated by a third-order system, 17 with defining parameters \u03c9 e and \u03b6 e , the natural frequency and damping of the engine dynamics, and a gain, K e , an amplification factor that improves the response (time). So, the engine sub-matrix, A EE is defined to be:\nf Pitch-plane translational motion is defined by u 0 and the vertical velocity, w. However, to study the rotational motion for a single point in the trajectory, it makes more sense to use the angle of attack, \u03b1, which can be derived from the (small) w through the relation\n7 of 20\nAmerican Institute of Aeronautics and Astronautics\nwhere the corresponding coupling matrices are zero, i.e., A ER = A EF = 0. Each bending motion depends on the generalised force for that specific motion. This generalised force is found by multiplying all the external loads with the eigenvector of that mode. As before, the external loads are a function of the bending motion and the position along the vehicle. Note that the subscripts i and j below both indicate a flexible mode, up to the maximum of n f . So, for A FR , A FE and A FF we have:\nwith\nwith\nwith, for i = j:\na \u03b7i,\u03b7j = a \u03b7i,\u03b7j = 0 and for i = j\nAmerican Institute of Aeronautics and Astronautics Lastly, to complete the model description, the components of B are stated:\nand"}, {"section_title": "B. Slosh Dynamics", "text": "The liquid motion in the fuel and oxidiser tanks will introduce perturbing accelerations that affect the motion of the launcher. Besides the actual slosh dynamics, sloshing will introduce coupling effects with the rigid translational and rotational motion, as well as with the flexible-body dynamics. Frosch and Vallely (1967) defined a model for the Saturn AS-501/S-1C flight-control-system design that includes these effects, 18 so that will be the setup that is followed here as well. In their original formulation, the rigid-body translation is described by the (vertical) motion of the centre of mass, i.e., the velocity w and position z. In the linearised model described in the previous section, w is normalised with u 0 and replaced by \u03b1; because the rigid position of the centre of mass is considered constant, the corresponding differential equation for\u017c is therefore not required. In Fig. 4 the updated configuration of the flexible launcher is shown, with two slosh masses, m s,1 and m s,2 , for the RP-1 and LOX tanks of the first stage, and two for the second stage (m s,3 and m s,4 ).\nThe changes to be made to update the state-space model presented in the previous section are the following:\u03b1 = \nThe dynamics of the i th flexible mode, modelled as a damped harmonic oscillator, is given by:\nwith \u03c6 i (x s,j ) being the shape of the i th flexible mode at the j th slosh location. Each slosh mode is also modelled as a damped harmonic oscillator, so for the j th mode it holds that:\ndamped oscillator slosh mode j z s,j + 2\u03b6 s,j \u03c9 s,j\u017cs,j + \u03c9 2 s,j z s,j = rigid-body coupling\nAfter inspecting the above equations it is clear that the slosh dynamics couples the equations in such a way that they cannot be directly written in the state-space form of Eq. (11) . Rather, the appearance of state derivatives on the right-hand side of Eqs. (24)-(26) will lead to a formulation of the form \nwhere in Eq. (32), the terms 2\u03b6 f,i \u03c9 f,i\u03b7i and \u03c9 2 f,i \u03b7 i have been included in f \u03b7 (t, x, u), as they are already present in A FF , Eq. (21).\nIn Eqs. (12)-(13), A and B have been partitioned into contributions of the rigid body, the engine, and the flexible body, including the coupling terms. With the inclusion of slosh, A and B can be partitioned into: \nThe slosh masses and engine dynamics are uncoupled, so therefore A ES = A SE = B S = 0. The remaining sub-matrices read:\nThe acceleration terms on the left-hand side of Eqs. (30)-(33) will go into E, where it is noted that for the missing derivatives a \"1\" will appear on the diagonal -without the slosh coupling E would be the identity matrix. The resulting matrix is: \nThe matrix E is the coupled mass matrix, which has to be inverted each time step due to the time dependency of the slosh masses, m s,j , and slosh-mass locations, z s,j , (affecting s,j ), whenever oxidiser/fuel is used."}, {"section_title": "of 20", "text": "American Institute of Aeronautics and Astronautics "}, {"section_title": "IV. Results", "text": ""}, {"section_title": "A. Nominal Model", "text": "The focus of the paper is the complete launch trajectory until first-stage burnout. Because the stability and controllability aspects of a flexible launcher in a wind environment will be studied, it suffices to generate a reference trajectory, representative for only the case under consideration. Therefore, a relatively simple flight model is chosen, 11, 12 sufficient to generate a rigid-body driven trajectory, along which the coupling between the rigid body, the engine dynamics, and the flexible and slosh modes will be analysed. Target condition for the PacAstro at first-stage burnout is a required velocity of 2,300 m/s at an altitude of 65 km. A typical launch trajectory consists of a brief vertical rise (\u2206t rise = 11 s, where the flight-path angle remains 90 \u2022 ), followed by a transition turn at constant pitch rate,\u03b8 c = -0.55 \u2022 /s, and concluded by a gravity turn until burnout. For the purpose of the current study, this can be achieved under the assumptions of a non-rotating, flat Earth, constant gravitational acceleration, g 0 , and zero lift. In Figs. 5(a) and 5(b), the reference trajectory of the PacAstro until first-stage burnout (t f = 126 s, h f = 67.7 km) is plotted with some key parameters. Figure 5(a) shows an almost linear increase in velocity with altitude. The dynamic pressure peaks atq = 43.5 kPa at around h = 11.1 km (time of maximum dynamic pressure (TMDP), t = 63 s, M = 1.83). The Mach number and Reynolds number -used for the aerodynamics calculations -follow a corresponding profile, dictated by the atmospheric properties. In Fig. 5(b The normalised bending modes, necessary to find the in-flight bending deformations of the longitudinal axis, were calculated in Matlab R using an in-house finite element mesher and solver, and three bending modes corresponding to ignition, TMDP, and burnout, are shown in Fig. 6 . At t = 0 s, the four lowest initial natural frequencies are 5.2, 16.2, 29.7, and 40.0 Hz, respectively, whereas their variation as a function of the flight time is shown in Fig. 7 . Including the sloshing mainly affects the first bending mode when the tanks are full; at t = 0 s the natural frequency is about 11% higher, with marginal effect on the higher modes. At TMDP (tank filling grade about 40%), \u03c9 f,1 changes from 37.3 rad/s (5.9 Hz) to 41.5 rad/s (6.6 Hz), whereas the higher modes are affected only up to 2%, but this increases when the tanks empty out more. "}, {"section_title": "B. Stability and Control Analysis", "text": "To begin the discussion, in Fig. 8 the eigenvalues along the trajectory from lift-off till first-stage burnout are shown, for the two cases without and with sloshing. In the top plot of Fig. 8(a) the eigenvalues for the rigid body are shown, indicating a stable, complex mode and an unstable real mode. The latter is most unstable at lift off, which, in combination with the turbulence-induced angle of attack may pose a problem. The complex mode becomes more stable after lift off with increasing dynamic pressure. However, after the maximum dynamic pressure has reached (t = 63 s), this mode destabilises with the decreasing dynamic pressure, which is a common phenomenon. Towards burnout of the first stage, this mode becomes marginally damped, primarily due to the combination of mass properties and low dynamic pressure. During the flight, the unstable mode becomes less and less unstable, at burnout it has become (almost) indifferent. This mode is dominated by perturbations in the pitch angle.\nIn the middle plot of Fig. 8(a) the eigenvalues of the first two flexible modes are shown. Both modes follow a similar pattern (as do all the flexible modes, as can be seen in the bottom plot). During the flight the modes are all stable. However, due to the changing aerodynamics the modes become less stable, with a maximum (negative) real value of the eigenvalue around t = 73 s, 10 s after the maximum dynamic-pressure peak. Despite the induced aerodynamics due to the launcher deformation, it is not expected that this will lead to instabilities of the controller.\nIn case the effect of sloshing is included, there is a significant change in the rigid-body eigenmodes ( Fig.  8(b) ): the aperiodic mode has become stable throughout the flight, although it follows a similar pattern as before. Until TMDP it becomes more and more stable and then destabilises again, but does never become unstable. The periodic eigenmode, on the other hand, is now always unstable and may become a challenge for the controller. In the middle plot the two flexible modes are shown (note that in the analysis with sloshing only two flexible modes have been included versus the five for the case without sloshing). At first sight, the patterns seem to be the same, but in the case with sloshing the real parts of the eigenvalues are a bit smaller (in absolute sense), indicating that the flexible modes are less stable than before.\nFinally, in the bottom plot the two slosh modes for the oxidiser and fuel tank are shown. The RP-1 eigenmodes are aperiodic for a long portion of the flight, starting at lift off. One mode is stable and one unstable, until at t \u2248 114 s the mode becomes that of an indifferent oscillator (this is the small portion around the origin of the plot). The LOX eigenmodes are periodic throughout and marginally stable. The period of oscillation decreases with flight time, until close to burnout the periodic mode briefly splits into two aperiodic modes.\nThe next step in the analysis is to look at the closed loop stability. In earlier research, 11 it was found that a simple PD controller could stabilise the launcher. Since the current analysis only aims to identify the difference in controllability and stability when sloshing is included, the same controller will be applied. We assume a feedback law with proportional and derivative gains of K p = 2.8 (on \u03b8) and K d = 0.9 s (on q). This was based on a closed-loop rigid-body requirement of 3 rad/s \u2264 \u03c9 r \u2264 8 rad/s, with a damping factor 13 of 20\nAmerican Institute of Aeronautics and Astronautics of \u03b6 \u2248 0.7, and designed for the point of maximum dynamic pressure (t = 63 s) g . The Bode plot for the elastic system without slosh is given in Fig. 9(a) for the moment of maximum dynamic pressure. It shows that the elastic mode may pose a problem when controlling high-frequency oscillations due to, for instance, turbulence. It is clear that perturbations will be amplified, while controlling an error in the pitch angle (by using the engine swivel angle). However, in case the deformations remain small, the problems will most likely remain limited. At its natural frequency of 37.3 rad/s, the bending mode spikes. The second bending mode spikes at a frequency around 105 rad/s, and will probably have marginal to no effect on the control.\nThe situation changes drastically when slosh is included ( Fig. 9(b) ). Apart from the two low-frequency \"double spikes\" of the oxidiser (z s,lox ) and fuel (z s,f uel ) themselves, the sloshing has a significant effect on all other states. In terms of gain and phase margins, G m and P m , the system has changed as follows (the values are given for the slosh case, with the no-slosh values in between brackets). For the engine and the first flex mode the gain margin has significantly lowered and for the engine also the frequency is low, which may interfere with the control. For \u03b8 the gain margin has even become negative. In the last part of this section we will look at the transient response, and how these gain and phase margins affect the controllability. This will be done for the structurally damped system.\nFor the stability analysis a horizontal-wind field is assumed, as well as turbulence. The resulting wind vector is translated into an angle of attack perturbation that is forced on the system dynamics. The horizontal wind as a function of altitude is taken from Ref. 2, and shown in Fig. 10 , the left plot. The corresponding induced angle of attack is indicated as well, and plotted in relation with the angle of attack required for the transition turn, \u03b1 f light . It may be clear that the induced \u03b1 wind represents a significant perturbation. Not only will this increase the load on the controller, but also the aerodynamic properties of the launcher will be affected. In Fig. 11 the variation of C * N\u03b1 and C * m\u03b1 is shown. As the aerodynamic model is valid up to Mach numbers of M = 5, only the relevant altitude range is shown, as well as the corresponding Mach and Reynolds numbers. This variation in aerodynamics will be included in evaluating the state-space models. For Mach numbers larger than 5, the current option is to keep the aerodynamic configuration constant, which is a reasonable approximation for higher Mach numbers.\nBesides a steady-state wind also turbulence that affects the angle of attack is considered. The turbulence is modelled with Dryden spectral densities, as a white noise passing through a linear, rational filter. 22, 23 Parameters used are a scale length at medium/high altitudes of L w = 1100 m, a gust intensity of \u03c3 w = 1.73 m/s, and a probability of exceedance of high-altitude intensity of 10 \u22123 (moderate conditions). The model is evaluated as a function of altitude, h, and flight velocity, u 0 , and will, in this case, produce a noisy wind component in the Z-direction, \u2206w. As before, this can be converted to an equivalent angle-of-attack perturbation of \u2206\u03b1 t = \u2206w u0 . This perturbation is added as a forcing function to the state-space model, by creating a second input and extending the input matrix B with a copy of the first column of A (the one associated with \u03b1). As such, the system will respond to \u2206\u03b1 t as it would to \u03b1. It is noted that the turbulence parameters are kept constant and should be interpreted as average values for the altitude range up to 20 km. Above 20 km the turbulence intensity reduces significantly, 23 and also the increased launcher velocity reduces the effect on the angle of attack. Therefore, \u2206\u03b1 turb = 0 \u2022 for h > 20 km.\nIn Fig. 12 the (vertical) turbulence wind velocity is shown, as well as the induced \u2206\u03b1 turb . Due to the 15 of 20\nAmerican Institute of Aeronautics and Astronautics low velocity at the beginning of flight, the turbulence induces a larger angle of attack than further in the trajectory. The angle-of-attack perturbation restricts to a few degrees close to lift off, and less than 1 \u2022 above 5 km altitude.\nThe first response tests that will be executed are two pitch manoeuvres of \u2206\u03b8 c = 2 \u2022 , one before reaching the maximum dynamic pressure (t cmd = 40 s), and one after (t cmd = 70 s). Duration of the maoeuvres is set to 15 s. The results are shown in Figs. 13 and 14 . In both cases the response is stable, and reasonable considering the controller has not been optimised yet. It is obvious that the turbulence has a significant perturbing effect on the controller. The response could be further improved, as the engine swivel is not yet saturated, by fine-tuning the controller.\nTo further address the controller performance -and at the same time show the versatility of the methodology -the transition turn that takes place after the vertical rise is simulated. This is achieved by applying a commanded pitch rate of\u03b8 c = -0.55 \u2022 /s, beginning at t 1 = 11 s and ending 38.5 s later (t 2 = 49.5 s). Figure 15 shows the response for the cases without and with turbulence. Without controller optimisation, the response is acceptable. The transition turn is well within the capabilities of the controller/actuator combination. At the scale of the pitch angle, the effect of turbulence is not really visible, as it induces only a small pitch-angle perturbation of about \u00b10.5 \u2022 . The swivel, on the other hand, shows a more visible difference. The high-frequency turbulence requires a much larger control.\nGiven the maximum swivel angle of \u03b5 T = \u00b1 6 \u2022 , filtering of the measurements in the feedback control loop should be considered, which could be achieved by implementing a sliding-mode filter, see for instance, Ref. 24 .\nTowards the end of the simulation, \u03b5 T gets saturated. The reader is reminded of the fact that a linearised model is used, and that a 20 \u2022 deviation from the equilibrium state can only be achieved (and sustained) by a large actuator command. In a realistic (non-linear) scenario, the actuator command would be zero, once the turn has been completed.\nThe last test executed is one where a defect in the engine swivel is simulated. At t = 20 s the swivel executes a 1 \u2022 sinusoidal motion with a period of 20 s. During this time, no attitude control is performed, which will resume only after the swivel is back to equilibrium position, and a reset period of 5 s has been enforced. This defect induces a significant perturbation in \u03b8, i.e., 2 \u2022 for the case without turbulence, and 5.5 \u2022 when there is turbulence. For the latter case, the swivel is briefly saturated when the controller kicks back in. Where the control is smooth in the absence of turbulence (after a minor activation oscillation), a strongly oscillating control is required to compensate for the error that is further perturbed by turbulence. However, in any case the pitch angle returns to its zero-degree equilibrium value. While simulating the same manoeuvres with the sloshing model included it became apparent that the (very) simple PD controller was not able to stabilise the vehicle. Results concerning the influence of sloshing can therefore not be shown. The development of a more robust adaptive controller is currently on its way, and it is expected that this non-linear controller will be better suited to handle the strong non-linearities of the combination of flexibility, sloshing and a demanding wind environment."}, {"section_title": "V. Conclusions and Recommendations", "text": "In this paper, the main focus was to study the effect of flexibility and engine dynamics on the controllability and stability of conventional launchers, using a simplified linearised model of the pitch-plane rotational dynamics, and a reusable state-space model was reevaluated at each point along the ascent trajectory. In this way, a (pseudo-)transient analysis was performed. Input to the state-space model are a modal description (as a function of current mass), normal-load and pitch-moment distribution (as a function of Mach and Reynolds number, angle of attack, and centre of mass location), and of course, the flight conditions along the reference trajectory. A second step involved the analysis of the effect of sloshing of the stability and controllability, and the interaction with the flexibility. The sloshing model is based on a damped mass-spring system, and has been modelled separately for the oxidiser and fuel tanks of the PacAstro launch vehicle. From the analysis of the slosh modes it has been concluded that only the first slosh mode is of importance.\nThe analysis of the eigenmodes of the system shows that sloshing has a significant impact on the openloop stability of the system. The aperiodic eigenmode of rigid-body motion has turned from unstable to stable, but the periodic eigenmode, on the other hand, is now unstable throughout the flight. With respect to the flexible modes, even though they are stable, they have become less so after including sloshing. The eigenmodes for the fuel tank are aperiodic for a long portion of the flight, starting at lift off. One mode is stable and one unstable, but towards first-stage burnout the mode becomes that of an indifferent oscillator (this is the small portion around the origin of the plot). The LOX eigenmodes are periodic throughout and marginally stable. The period of oscillation decreases with flight time, until close to burnout the periodic mode briefly splits into two aperiodic modes.\nStabilising the system with a simple PD controller and inspecting the gain and phase margins, shows that sloshing has a significant effect and may pose a problem for the control system. This has been confirmed during the simulation of several manoeuvres in the presence of wind gust and wind turbulence. To begin with the flexible launcher and no sloshing, pitch manoeuvres of 2 \u2022 are executed before and after the time of maximum dynamic pressure for 15 s. Both manoeuvres are stable, although turbulence will cause a significant perturbation on the controller. The second simulation shows the versatility of the methodology (and without having to optimise the controller), as the transition turn is simulated after the vertical rise. A pitch rate of \u22120.55 \u2022 /s is commanded between t = 11 s and t = 50 s. The responses with and without turbulence are derived and both are acceptable, given that the controller is not optimised. The engine swivel angle shows a higher perturbation; therefore, a proper designed estimator to smoothen the signals should be considered.\nFinally, a defect in the engine swivel is considered. At t = 20 s, the engine executes a 1 \u2022 sinusoidal motion with a period of 20 s, during which no attitude control was performed. The defect produced perturbations, which, for the turbulence model, caused brief saturation of the engine swivel when control was returned. In both situations without and with turbulence, the engine swivel is briefly saturated and some oscillatory control (albeit not diverging) was necessary to compensate for the defect; however, once controlled, the pitch angle returned to its equilibrium value.\nWhile simulating the same manoeuvres with the sloshing model included it became apparent that the (very) simple PD controller was not able to stabilise the vehicle. Results concerning the influence of sloshing can therefore not be shown. The development of a more robust adaptive controller is currently on its way, and it is expected that this non-linear controller will be better suited to handle the strong non-linearities of the combination of flexibility, sloshing and a demanding wind environment.\nAppendix A. Pac Astro Mass Properties and Geometry "}]
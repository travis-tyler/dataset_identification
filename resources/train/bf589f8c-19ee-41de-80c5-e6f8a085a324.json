[{"section_title": "Abstract", "text": "A central aim of ecology is understanding the mechanisms of community assembly. To address this problem, community assembly is often modeled as a sampling process, in which species are selected from a pool of available species, possibly with effects of interspecific interactions, habitat filtering, and other ecological mechanisms. However, the fundamental stochastic sampling process by which species are selected from the pool remains unexplored. Here we demonstrate the distinctness of four canonical sampling processes, the Bernoulli, Plackett-Luce, multinomial, and fractional multinomial processes. Each process can be affected by ecological mechanisms or it can occur in their absence.\nAlthough all four of the processes are a priori plausible and the first two are widely used in ecological models, we show that the multinomial and fractional multinomial processes broadly underlie community assembly.\nUnderstanding how communities are structured and assembled constitutes a central aim of community ecology (1-4). Over ecological timescales, community assembly is often consid-"}, {"section_title": "", "text": "ered a sampling process, in which species are selected from a pool of species inhabiting the surrounding areas (5, 6) . This process may be affected by dispersal limitation, habitat filtering, interspecific interactions, and other ecological mechanisms. Extensive research has focused on assessing the relative roles of these mechanisms (7) (8) (9) (10) . However, a fundamental question is which of the many possible general sampling processes govern the selection of species from the pool. Remarkably, this question seems to have received no explicit attention. In this paper, we systematically consider four canonical sampling processes of community assembly with respect to phylogeny, and although all four are reasonable a priori, we show that two of them are widely supported by data.\nAssessing the fundamental sampling processes of community assembly has important implications: it provides a key baseline for inferring effects of classical ecological mechanisms (e.g., competition and facilitation) from non-experimental data, and it can allow perturbations to communities to be detected and mitigated. Furthermore, an understanding of community assembly processes is important for developing conservation strategies (11) and formulating approaches for controlling infectious diseases (12) .\nTwo of the sampling processes that we consider have implicitly been widely used in previous models of community assembly: the Plackett-Luce process and a dependent Bernoulli process (13, 14) . They are not equivalent, although this seems not to have been noted previously. The third process, the multinomial, is well known (15) but unused in community assembly, and the last process, the fractional multinomial, was described recently (16) . These latter two processes are best supported by ecological data.\nAll four processes posit the existence of a species pool (the set of species that can potentially colonize a community) and phylogenetic information about that pool (17, 18) . In the first process, the Plackett-Luce (19) process, (i) each species in the pool has an initial probability of being selected, (ii) after the first species is selected, the probabilities of the remaining species are modified to reflect the fact that the first species can no longer be selected, and (iii) additional species are subsequently selected, with modifications to the probabilities at each step to reflect that previously selected species are unavailable for selection (13) . This process is analogous to drawing marbles (species), possibly with unequal and dependent probabilities, without replacement from an urn (the pool). Effects of habitat filtering are reflected in heterogeneous probabilities (e.g., species A is twice as likely to colonize as species B), while effects of interspecific interactions are reflected in the modifications of the probabilities (e.g., species A is less likely to be drawn if species B is already drawn; an absence of interspecific interactions is modeled by normalizing the remaining probabilities after each draw).\nIn the second process, the dependent Bernoulli process, each species in the pool has a probability of occurrence, and its outcome (occurs or does not occur) is a Bernoulli random variable (14) . This process is analogous to flipping biased coins, potentially non-independently, to determine which species are present. Heterogeneous probabilities again reflect effects of habitat filtering. Dependence among the random variables reflects effects of interspecific interactions; an absence of interspecific interactions is modeled by independence of the random variables.\nThe third process, the multinomial process, has not been widely applied in community ecology. Let a unit be an arbitrary taxonomic or functional grouping (e.g., genus or family). In the multinomial process, (i) species are drawn sequentially and (ii) the probability of belonging to each unit in the pool is specified on each draw. Effects of habitat filtering are reflected in the probabilities for the initial draw. Absence of interspecific interactions is modeled by keeping the unit probabilities constant for all draws as in sampling with replacement; while presence of interactions is modeled by modifying the probabilities (e.g., the probability of drawing the second species from unit A might decrease if the first species was drawn from that unit).\nThe fourth sampling process, until recently not previously considered in community ecology, nor to our knowledge in any other context (16) , will now be defined. Together with the multinomial, it explains remarkably well patterns observed in ecological data. Define ij as the event that the ith and jth species to arrive in the community share the same unit and ij as the event that they do not. For a community with three species, the absence of interspecific interactions is modeled by\nand P ( 31 | 21 ) = P 31 | 21 .\nThis process is unchanged under effects of habitat filtering, but in the presence of effects of competition or facilitation, each equivalence in (1) -(3) becomes \"less than\" or \"greater than,\"\nrespectively. For communities with more than three species, relations analogous to (1) - (3) hold when interspecific interactions are absent, and competition or facilitation have analogous effects on these relations. This process can be shown to be equivalent to a multinomial process in which, by analogy to fractal dimensions, units are fractional. For this reason, we will refer to this process as the fractional multinomial process. Examples of all four processes are given in the Online Supplementary Material.\nThe four processes are non-equivalent. To demonstrate this, let I be a multiset that gives the number of species in each unit in a community; i.e., I is an integer partition. \nwhere c = 3, a \u2208 [0, 1/2] \u222a {1}, and \u03c8 is a set partition of species, as identified by order of arrival, into units (16) . Thus, P ({2, 1}) = 3a(1 \u2212 a). This result generalizes to arbitrary c \u2208 N,\nAdditionally, (4) implies that conditional on c species occurring,\nwhere f ({i 1 , i 2 , ..., i |I| }) is the number of set partitions with units of sizes i 1 , i 2 , ..., i |I| (16).\nHence, for any pair of integer partitions I 1 and I 2 , each process defines a function z(\u03b8) \u2261 (P \u03b8 (I 1 ), P \u03b8 (I 2 )), where \u03b8 is a vector of possible parameter values (e.g., occurrence probabilities). Examining the images of these functions reveals that all four of the processes are distinct from one another ( Figure 1 ).\nA priori, theoretical considerations do not indicate which of the processes should occur in ecological communities; assembly could follow any of the possible patterns specified by these four models. To address this question, we investigated the consistency of the four processes with two large data sets: the Barro Colorado Island 50Ha vegetation census (\"BCI\") (20) (21) (22) and the North American Breeding Bird Survey (\"BBS\") (23) . For the BCI data, we divided the 50Ha plot into 1.75m quadrats and treated each quadrat as a site. For the BBS data, we reasoned that assembly processes may differ regionally, and that they should be most distinguishable in communities that are close to equilibrium; i.e., communities of non-migratory species. Hence, we considered separately the data from two representative bird conservation regions, and we performed analyses for permanent resident species. We used data only from highly-rated routes, treated each stop along each route as a site, and employed taxonomic information from the most recent AOU checklist. For all data sets, we performed analyses at three taxonomic resolutions: order, family, and genus. For each data set and at each taxonomic resolution, we compared the empirical distributions of I with fitted distributions derived from each sampling process (see Online Supplementary Material).\nIn all cases, except when units were defined as orders for the BBS data, the multinomial and fractional multinomial processes were most consistent with the data. They accounted for a remarkable proportion of variation in the observed frequencies of I (median R 2 > 0.999;\nminimum R 2 = 0.98), were strongly favored over the Plackett-Luce and Bernoulli processes in an AIC analysis (24) , and unlike these other two processes, were never rejected in likelihood ratio goodness-of-fit tests ( Table 1 ). The fractional multinomial process was favored over the multinomial process in two out of seven cases by a likelihood ratio test; in the other cases, there was insufficient power to distinguish between the processes. When units were defined as orders for the BBS data, all models were inappropriate (R 2 \u2248 0 in all cases, p < 0.0001 in goodness of fit tests). This demonstrated that the aforementioned close fits were not a trivial artifact of the fitting procedure.\nNumerous studies have examined whether communities are consistent with \"random\" sampling from species pools, with the intent to use deviations from \"randomness\" as a means for assessing the effects of interspecific interactions, habitat filtering, and other ecological processes (8, 17, 18) . Unlike these studies, the present study evaluated which of four possible fundamental sampling processes governed community assembly. These sampling processes can occur in both the presence and absence of the aforementioned ecological phenomena, and they provide an overarching framework for modeling community assembly as a selection process from species pools.\nThe analyses required three assumptions: first, that data from different sites were independent; second, that data were identically distributed; and third, that interspecific interactions did not affect the assembly processes. All of these assumptions were surely violated to some extent (25, 26) , but the extremely close fits for the multinomial and fractional multinomial processes suggest that these violations were negligible; we were able to clearly show that these two processes governed community assembly from among the other two possibilities.\nThe analyses indicate that the fractional multinomial process, and potentially the multinomial process, underlie community assembly very broadly. The data sets that we examined were at disparate spatial scales (10 1 to 10 3 m) and for disparate taxa (plants and birds), yet they were both highly consistent with the two processes. Analyses of other data sets, not presented here, bolster this conclusion. Differing results are likely to provide important insight into ecological phenomena, environmental heterogeneity, and new sampling processes.\nWhy might the multinomial and fractional multinomial process be so prevalent? The fractional multinomial process specifies only general independence properties for the sampling process [equations (1) to (3)], unlike the other processes, which posit different and more narrowly specified properties. Although all of the processes are plausible, the unique generality of the fractional multinomial process may account for its prevalence.\nSampling processes are of great practical importance. Most existing models of community assembly assume either the Plackett-Luce or Bernoulli process, and these are used as if they were interchangeable (13, 14) . However, the nature of the underlying process can have profound implications: it can constrain the ecological phenomena that can be observed, as well as the inferences and predictions that can be made. By explicitly considering sampling processes, it will be possible to make more effective inferences in ecology (16) .\nMost research on community assembly has focused on specific \"assembly rules\" and the influence of ecological mechanisms on the assembly process (1, 7, 17, 18) . Until now, the sampling process by which communities assemble has received no explicit attention; rather, in modeling community assembly, sampling processes have been implicitly assumed. Our results indicate that assembly occurs via two heretofore unconsidered processes: the multinomial and fractional multinomial processes. Further research on these sampling processes will elucidate additional fundamental mechanisms of community assembly."}, {"section_title": "Online Supplementary Material Example: Computing Distributions", "text": "This section presents an example of how to compute the distributions predicted by the four sampling processes. A species pool of five species is assumed in the example. Species 1, 2, and 3 are in genus A, and species 4 and 5 are in genus B. A lack of interspecific interactions is also assumed; that species are drawn independently. The Plackett-Luce process posits that species are drawn sequentially, and that each species in the pool has a specified probability of being selected on the first draw. Denoting the probability for species i by p i , we have the constraint that p 1 + p 2 + p 3 + p 4 + p 5 = 1 (one of the five species must be picked on the first draw). The probability of observing the partition {2, 1} is given by\nwhere\nand for any set E, S(E) is the set of all permutations of E. The Bernoulli process posits that species i has a probability of occurring here denoted q i . Hence, 0 \u2264 q i \u2264 1, and the probability of {2, 1} is\nTo compare the binomial process to the other processes, it is necessary to compute the probability of {2, 1} conditional on observing 3 species; i.e., dividing (8) by the probability of observing 3 species. The multinomial process posits that species are drawn sequentially, and that each species has a specified probability of belonging to each genus in the pool. Letting r j denote the probabilities associated with genus j, we have the constraint r A + r B = 1 and the\nThe fractional multinomial has a single parameter a, and regardless of the composition of the pool, P ({2, 1}) = 3a(1 \u2212 a), with a \u2208 [0, 1/2] \u222a {1}."}, {"section_title": "Process Non-equivalence", "text": "This section details how we plotted the images of z(\u03b8) \u2261 (P \u03b8 (I 1 ), P \u03b8 (I 2 )) for each process, where \u03b8 is a vector of parameter values, and I 1 and I 2 are integer partitions. The plots of these images are shown in Figure 1 . For the fractional multinomial process, the images are parametrically defined curves, which can be plotted routinely. For the other processes, our strategy was to find boundary points, from which we could easily interpolate the shapes of the images. \nand\nIf 5 or fewer species are sampled from a pool of fewer than 11 species, closed form expressions can be found for P \u03b8 (I) on \u0398. These are generally polynomials and quotients of polynomials with several hundred to several thousand terms. We were able to programmatically generate string expressions for these polynomials, and then minimize\nfor values of (x 0 , y 0 ) using simulated annealing in Mathematica. We accepted (P \u03b8 (I 1 ), P \u03b8 (I 2 ))\nWe considered values of (x 0 , y 0 ) along 0.01 increment (multinomial process) and 0.05 increment grids (Bernoulli and Plackett-Luce processes). Code was written in Visual Basic 6.0 and Mathematica 6.0, and is available from J.L."}, {"section_title": "Data Analysis", "text": "The primary aim of our data analyses was to assess which sampling process (Plackett-Luce, Bernoulli, multinomial, or fractional multinomial) was most consistent with the data. We used four measures for making this assessment: The first measure was R 2 , the proportion of variation in the observed frequencies of I attributable to the process. Following (27), we defined R 2 as\nwhere f ij is the observed frequency of partition i given the presence of j species,f ij is the frequency predicted by the maximum likelihood fit of the model, f \u00b7j is the total number of partitions observed with j species, and \u03c6(j) gives the number of partitions of j species. We used R 2 as a general measure of goodness of fit: if R 2 was less than 0.5, we took this as evidence that assumptions of site independence and similarity were violated or that the sampling process was inappropriate. The second measure that we used was a likelihood ratio goodness-of-fit test.\nA significant result from this test also provided evidence that assumptions were violated or the sampling process was inappropriate. We primarily employed the third and fourth measures to distinguish which of the four processes was most appropriate. When the processes had different numbers of parameters, we used AIC; when they had the same number of parameters, we used a likelihood ratio test.\nAll of these measures require maximizing the likelihood function for each process. In our analyses, we assumed that the observations at different sites were independent and identically distributed. (As discussed in the text, the analyses were robust to this assumption.) Under this assumption, the Plackett-Luce and Bernoulli model have as many parameters as there are species in the pool (\u2248 100 to 1000). The multinomial process has as many parameters as there are units in the pool (\u2248 25), and the fractional multinomial has one parameter.\nBecause of the complexity of the first three models, we were unable to maximize the likelihood functions reliably, despite extensive efforts. Hence, we pursued two alternative approaches. The first approach was to find an upper bound for the likelihood functions. The upper bound that we used is given by:\nThis bound is useful for comparing AIC values, but not for computing values of R 2 or performing goodness-of-fit tests. Specifically, for the AIC, if a model has k parameters and the upper bound for the likelihood function is \u03bb , then a lower bound on the AIC value is \u22122 log(\u03bb )+2k.\nThe second approach was to find maximum likelihood estimates for simpler versions of the processes. The simpler versions that we considered were:\n1. The Plackett-Luce process, assuming that all species are equally likely to be selected. The numbers of species in the units in the pool were free parameters.\n2. The Bernoulli process, assuming that all species are equally likely to occur. As above, the numbers of species in the units in the pool were free parameters.\n3. The multinomial process, assuming that species are equally likely to be drawn from each unit. The number of units is a free parameter.\nFor these simpler models, we were able to calculate R 2 and p-values from likelihood ratio goodness of fit tests. We also calculated upper bounds on AIC. If a simplified model fit extremely poorly (e.g., R 2 \u2248 0 and p \u2248 0), we judged that the full model was likely to fit poorly too. Tables 2 and 3 and 3707 for bird conservation regions 5 and 16, respectively), the simplified Plackett-Luce and Bernoulli processes were always rejected in goodness-of-fit tests. When units were defined as orders, the multinomial and fractional multinomial processes were also rejected, and all processes had very low values of R 2 , indicating that none were appropriate. In the other cases, the full multinomial and fractional multinomial models were again favored by AIC, and the fractional multinomial had the highest values of R 2 . Overall, the multinomial and fractional multinomial processes were generally favored by the data. Table 2 for a full description. "}, {"section_title": "Detailed Results", "text": ""}, {"section_title": "Tables and Figures", "text": ""}]
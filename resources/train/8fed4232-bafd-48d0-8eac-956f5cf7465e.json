[{"section_title": "Abstract", "text": "The hippocampus is one of the first brain structures affected by Alzheimer's disease (AD). While many automatic methods for hippocampal segmentation exist, few studies have compared them on the same data. In this study, we compare four fully automated hippocampal segmentation methods in terms of their conformity with manual segmentation and their ability to be used as an AD biomarker in clinical settings. We also apply error correction to the four automatic segmentation methods, and complete a comprehensive validation to investigate differences between the methods. The effect size and classification performance is measured for AD versus normal control (NC) groups and for stable mild cognitive impairment (sMCI) versus progressive mild cognitive impairment (pMCI) groups. Our study shows that the nonlinear patch-based segmentation method with error correction is the most accurate automatic segmentation method and yields the most conformity with manual segmentation (\u03ba = 0.894). The largest effect size between AD versus NC and sMCI versus pMCI is produced by FreeSurfer with error correction. We further show that, using only hippocampal volume, age, and sex as features, the area under the receiver operating characteristic curve reaches up to 0.8813 for AD versus NC and 0.6451 for sMCI versus pMCI. However, the automatic segmentation methods are not significantly different in their performance."}, {"section_title": "Introduction", "text": "The hippocampus is part of the limbic system and is located in the temporal lobe, medial to the inferior horn of the lateral ventricle. It plays an important role in spatial navigation and consolidation of information from short-term to long-term memory. Hippocampal neuronal degeneration and dysfunction has been vastly studied in a large number of neurodegenerative diseases and mental health disorders such as Alzheimer's dementia (Braak and Braak, 1991) , posttraumatic stress disorder (Bremner et al., 1997) , major depressive disorder (Kempton et al., 2011) , schizophrenia (Nelson et al., 1998) , and epilepsy (Wieshmann et al., 1997 ).\nAlzheimer's disease (AD) is the most common cause of dementia (Sperling et al., 2011) . The global burden of AD is approximately 25 million people worldwide and is predicted to quadruple in prevalence by 2050 due to aging of the population (Brookmeyer et al., 2007) . As with most neurodegenerative diseases, early detection, before too much degeneration of brain tissue occurs, may be crucial for effective treatment.\nA quantitative measure of the atrophy pattern can be obtained by segmenting different anatomical structures in magnetic resonance (MR) images. Many recent studies have focused on hippocampal atrophy as one of the first AD biomarkers, since the hippocampus is easier to segment than other medial temporal lobe structures (Chupin et al., 2009; Cuingnet et al., 2011; Coup\u00e9 et al., 2012) and is highly sensitive to AD-related atrophic patterns (Jack et al., 1997) . Manual segmentation of anatomical structures is often considered the gold standard for volumetric assessment. However, it is a laborious, time-consuming task (taking between 30 and 120 min for hippocampal segmentation) and suffers from both inter-and intra-rater variability. To overcome these limitations, several semi-and fully automated methods have been developed for hippocampal segmentation Fischl et al., 2002; Collins and Pruessner, 2010; Chupin et al., 2009; Duchesne et al., 2002; Hu et al., 2011) (for a recent review, see Dill et al. (2015) Medial temporal lobe anatomy presents automatic segmentation procedures with many nontrivial problems, the most important of which is the striking similarity in the intensity distributions of different anatomical structures such as the amygdala, hippocampus, and entorhinal cortex. As a result, different brain structures cannot be differentiated based solely on intensity information (Fischl et al., 2002) . Furthermore, the high anatomical variability, low contrast, small size, and discontinuous boundaries of the hippocampus render its segmentation extremely difficult without the use of prior information (Fischl et al., 2002) .\nSemi-automated methods use manual intervention as a first step in defining seed points or bounding boxes (Chupin et al., 2007 ). Yet, even such a simple intervention can pose a major challenge given the size of the databases used in clinical studies (e.g., the Alzheimer's Disease Neuroimaging Initiative, ADNI, http://www.adni.loni.usc.edu).\nTo fully automate the segmentation procedure, some methods attempt to integrate shape information using appearance-based strategies (Duchesne et al., 2002; Hu and Collins, 2007) . Others combine both level-set shape representation and statistical gray level information (Yang and Duncan, 2004; Hu et al., 2011) . Template-based segmentation (or label propagation) is one of the major categories in structural segmentation due to its efficacy and accuracy. In these methods, single (Barnes et al., 2008) , probabilistic or multiple templates (Heckemann et al., 2006; Aljabar et al., 2009; Collins and Pruessner, 2010; Coup\u00e9 et al., 2011) are used to spatially label the desired structure through a label propagation step. FreeSurfer, a wellknown segmentation tool (Fischl et al., 2002) , uses both probabilistic template priors and intensity features from each anatomical structure to complete the structure identification using a classifier.\nUsing only a single template can be suboptimal for several reasons: First, the template may not be the best match to represent the target image; this type of error may be more pronounced in a diseased population. In addition, certain types of registration errors may be unavoidable, and any labeling error resulting from imperfect manual segmentation may also affect the segmentation procedure (Aljabar et al., 2009) .\nMulti-template methods combine multiple templates to decrease these types of errors. These methods define each voxel label by combining the labels derived from multiple templates using a decision-making approach such as majority voting (Aljabar et al., 2009; Collins and Pruessner, 2010; Coup\u00e9 et al., 2011) . They are further improved by the use of similar templates from a template library in segmenting a new subject. Multi-template methods implicitly benefit from shape priors by using fine nonlinear registration. However, this improvement comes at the expense of high computational burden. Furthermore, these methods weight each template equally and are therefore highly susceptible to registration error and template choice. Recently, inspired by nonlocal means image-denoising techniques, a patch-based segmentation method has been shown to reduce computational burden while preserving the segmentation accuracy, accomplished by weighting each expert label based on the intensity similarity with the to-be-segmented patch . Patch-based methods have become extremely popular in medical image segmentation and have been employed in brain structure segmentation Rousseau et al., 2011; Xiao et al., 2015) , lesion segmentation (Guizard et al., 2015; Roy et al., 2015) , and segmentation of cardiac MR images (Bai et al., 2015) . Different images can be efficiently represented based on patches of a training library, and patch-based segmentation methods serve as an example of a dictionary learning problem. A recent method approached image segmentation based on discriminative dictionary learning and sparse reconstruction (Tong et al., 2013) . However, patch-based methods are not without their shortcomings. For example, the image similarity index over a small patch may not be the optimal descriptor for the overall structure. The two approaches (multi-template and patch-based) can be combined to take advantage of both implicit shape priors of the non-linear registration and the robustness of patch-based methods to segmentation errors .\nDespite the progress achieved by these different methods, segmentation errors and mislabeled voxels remain unavoidable. Wang et al. (2011) presented a machine learning approach to find and correct mislabeled voxels, which can be used as a post hoc correction for any automatic segmentation method. For a given image, their classifier investigates the automatic segmentation for the mislabeled voxels and corrects them. In addition, they showed that a patch-based method with nonlinear registration can be further enhanced using this correction technique, producing the most accurate segmentation strategy developed thus far .\nQuantitative comparison of the various automatic segmentation methods poses some difficulties. The reported results may be affected by varying image acquisition parameters, different manual structure segmentation protocols, different gold standards, and different metrics. While manual segmentation is used as the gold standard for automatic segmentation methods, there are diverse ways of segmenting anatomical structures. This inconsistency between expert priors greatly affects the comparison of different segmentation methods. A reliable protocol for manual segmentation is crucial for a valid comparison.\nTo address the issues identified above, this study compares four different automatic hippocampal segmentation methods, based on a well-defined manual segmentation protocol, using the same dataset. We improve upon the four methods using error correction (Wang et al., 2011) and then compare the resulting eight segmentations. We also evaluate the power of these techniques to be used as an AD biomarker. We characterize some of the factors that lead to more accurate segmentation and further investigate whether this accuracy improves the ability of hippocampal volumetry to distinguish between different AD clinical groups."}, {"section_title": "Materials and methods", "text": "Among the different automatic hippocampal segmentation approaches reported in a recent review from Dill et al. (2015) , multitemplate segmentation strategies appear to be the most accurate, with Dice's kappa values ranging from 0.72 to 0.91. Three of the four methods compared in this study are multi-template segmentation methods. The first two methods (ANIMAL with template library and label fusion; patch-based segmentation using expert priors) were selected from the most successful and accurate segmentation methods, with reported Dice's kappa values of 0.88 (Collins and Pruessner, 2010; Coup\u00e9 et al., 2011) . The third method (multi-atlas labeling with population-specific template and nonlocal patch-based label fusion) is an enhancement to Coup\u00e9 et al. (2011) using fine nonlinear registration, with a Dice's kappa of 0.89 .\nWe compared the three multi-template methods (Collins and Pruessner, 2010; Coup\u00e9 et al., 2011; Fonov et al., 2012 ) using a common training and testing dataset, manually segmented using the protocol presented in Pruessner et al. (2000) . Use of a common dataset avoids the inhomogeneity that might be imposed on comparative studies that evaluate different datasets. A fourth automatic segmentation method, FreeSurfer (a well-known freely available tool) (Fischl et al., 2002) , has shown better results in terms of agreement with manual segmentation in comparison with both FSL/FIRST (Morey et al., 2009 ) and IBASPM (Tae et al., 2008) . Therefore, we also compare hippocampal segmentation derived from FreeSurfer with manual segmentation. Finally, since the wrapper-based error correction technique (Wang et al., 2011) can be applied to any host segmentation strategy Dill et al., 2015) , we applied the error correction technique (Wang et al., 2011) to all four compared methods.\nIn the second part of the study, we estimated the power of each technique to differentiate between groups based on hippocampal volume. The methods were compared based on their ability to differentiate between AD and normal control (NC) groups (diagnosis ability) and between groups of subjects with stable versus progressive mild cognitive impairment (MCI) (prognosis ability). In this study, progressive MCI (pMCI) refers to MCI subjects who converted to AD during three years of follow-up, and stable MCI (sMCI) refers to subjects who maintained their MCI status. We measured effect size and classification performance, the latter measured by area under the receiver operating characteristic (ROC) curve."}, {"section_title": "Datasets", "text": "Data used in the preparation of this article were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (http:// www.adni.loni.usc.edu). The ADNI was launched in 2003 as a publicprivate partnership. The project is the result of efforts of many coinvestigators from a broad range of academic institutions and private corporations led by Michael W. Weiner, MD, as principal investigator. The primary goal of the ADNI has been to test whether serial MR imaging, positron emission tomography (PET), other biomarkers, and clinical and neuropsychological assessment can be combined to measure the progression of mild cognitive impairment (MCI) and early AD (for more information, visit http://www.adni-info.org)."}, {"section_title": "Experiment 1", "text": "To validate the different approaches to hippocampal automatic segmentation, we selected sixty 1.5T images from the baseline ADNI scans. Selection was based on age, sex, handedness, and years of education, so that the groups in different clinical stages (NC (n=20), MCI (n=20), and AD (n=20)) were comparable in terms of age, sex, and median years of education (see table 1 ). This dataset was used for training for all the selected methods, except for FreeSurfer, both without and with error correction. In FreeSurfer, the segmentation was performed based on its default training dataset. However, the labels are corrected (in FreeSurfer with error correction) based on the dataset of 60 images described above."}, {"section_title": "Experiment 2", "text": "For the clinical grouping and power analysis study, we selected all the ADNI-1 baseline visit 1.5T T1 MR images. The demographic information can be found in Table 2 .\nAs stated above, the entire ADNI-1 1.5T dataset was used to investigate the power of the segmented structure's volume to act as an AD biomarker. We used two classification experiments (NC vs AD, and sMCI vs pMCI) to evaluate biomarker performance using a LOO procedure."}, {"section_title": "Preprocessing", "text": "All selected images went through a preprocessing pipeline, consisting of denoising (Coup\u00e9 et al., 2008) , N3 inhomogeneity correction (Sled et al., 1998) , linear intensity normalization based on histogram matching between the image and the average template, and affine registration to ICBM152 template space with 1 \u00d7 1 \u00d7 1 mm 3 resolution (Collins et al., 1994 ) using a population-specific template from the ADNI-1 database . Lastly, all the images were coarsely aligned, and image intensities were normalized within each image and among the whole database Fonov et al., 2012; Collins and Pruessner, 2010) ."}, {"section_title": "Manual segmentation", "text": "The hippocampi were manually segmented on the first experimental dataset (60 subjects from ADNI-1) using the manual segmentation protocol presented in Pruessner et al. (2000) . The labels were segmented on linearly transformed stereotaxic volumes. We used the same preprocessed dataset as the direct input for all the automated segmentation methods to facilitate the comparison. The tracings were performed by expert raters. Raters were blinded to the hemisphere (images were randomly flipped left-right) and to the group (the filenames did not identify the subject as NC, MCI, or AD)."}, {"section_title": "Automatic segmentation methods", "text": ""}, {"section_title": "FreeSurfer", "text": "FreeSurfer is a suite of tools for analysis of human brain data obtained from MR images and includes automatic segmentation of many macroscopically visible brain structures (Fischl, 2012) . The tool performs subcortical structure segmentation using the method presented in Fischl et al. (2002) . First, each image is linearly aligned with an average template. A frequency histogram of possible structures (defined by the spatial template prior) is used to compute the probability of a given anatomical label occurring at a given location. The prior of a given spatial arrangement of different labels is also incorporated into the segmentation.\nThe segmentation procedure is considered an anisotropic nonstationary Markov random field. The probabilistic labels and corresponding predicted image intensities are priors, and the intensity similarity between the target image and the atlas is a likelihood term (Fischl et al., 2002) . In this study, we used version 5.3.0 of FreeSurfer, which is freely available from https://surfer.nmr.mgh.harvard.edu/."}, {"section_title": "ANIMAL with template library and label fusion", "text": "The ANIMAL segmentation method (Collins and Evans, 1997; Collins et al., 1995) is enhanced with a multi-template strategy (Collins and Pruessner, 2010) . The enhanced version benefits from a library of templates and label fusion of their corresponding propagated labels, while the original ANIMAL method uses a single nonlinear averaged template. In ANIMAL, the target image is nonlinearly warped to a template, which is manually segmented by an expert. The structural voxel labels are propagated back to the corresponding voxel in the target space using the inverse of the estimated nonlinear transformation. However, the average template might not be representative of the anatomy of all subjects. To take into account anatomical variability, ANIMAL with template library and label fusion uses n most similar templates (using normalized mutual information as the similarity metric) from a template library. Then, an ANIMAL segmentation is performed using each of these templates. The final label is determined based on a majority voting step between the n labels assigned to each voxel. The number of templates used for training is n=11, as suggested in the original paper (Collins and Pruessner, 2010) . Throughout the rest of this paper, we refer to this method as ANIMAL with label fusion. A. Zandifar et al. NeuroImage 155 (2017) 383-393 Patch-based segmentation using expert priors The first patch-based approach to segment brain structures was proposed in Coup\u00e9 et al. (2011) . The algorithm attempts to determine a desired label for a voxel in the target image based on similar patches of neighborhood voxels in the template library. This label fusion step uses a nonlocal means estimator that weights each of the template patch labels using an intensity-based similarity metric with the target patch. Finally, the target patch's label is defined by thresholding the weighted average of its similar patches from the template library. Rigid registration is only used in the segmentation procedure. The implementation is described comprehensively in Coup\u00e9 et al. (2011) . Throughout the rest of this paper, we refer to this method as the patch-based method.\nMulti-atlas labeling with population-specific template and nonlocal patch-based label fusion\nThis method is a combination of the previously described patchbased segmentation method with a population-specific nonlinear template construction . When creating a population-based average model, all individual templates (and their labeled structures) are nonlinearly aligned (Avants et al., 2008) to the average model. In this segmentation method, each target image is then nonlinearly warped to the average template space, and the patch-based segmentation algorithm is applied. Finally, the inverse of the nonlinear transformation is used to warp the labels back to the subject's native space. Since this method offers an enhancement to the patch-based method by incorporating a nonlinearly aligned template library, throughout the rest of this paper, we refer to this method as the nonlinear patch-based method.\nA learning-based wrapper method to correct systematic errors in automatic image segmentation Wang et al. (2011) presented a method that learns the pattern of mismatch between automatic segmentation labels and their corresponding manual segmentations. The method uses a classification technique in which the classifier is trained by a set of automatically labeled voxels and their corresponding manual segmentation. For an unseen image, the method corrects the mislabeled segmentation using the learned pattern. Both intensity and neighborhood information are used as features to train an AdaBoost learner (Freund and Schapire, 1995) . We applied error correction to the four previously described methods. For error correction, we used version 1.9 of the freely available online implementation of the method, which can be found here http://www.nitrc.org/projects/segadapter. All hyperparameters were set based on the original paper (Wang et al., 2011) . Throughout the rest of this paper, we refer to the corrected version of each method as the method with error correction."}, {"section_title": "Validation schema Experiment 1", "text": "To investigate segmentation accuracy, we used a leave-one-out (LOO) procedure to validate the methods. Specifically, for each subject in the 60-subject dataset, the methods were trained with the other remaining 59 subjects and their corresponding labels. For testing, the automatic segmentation of the one subject is compared with its corresponding manual segmentation."}, {"section_title": "Metrics Experiment 1", "text": "\u2022 Dice's kappa metric Volumetric overlap between each automatic segmentation method (i.e., FreeSurfer, ANIMAL with label fusion, patch-based, nonlinear patch-based, and nonlinear patch-based with error correction) and manual segmentation is measured using Dice's kappa similarity index (Zijdenbos et al., 1994) . The kappa index for two segmented labels is computed as follows:\nwhere M and A represent a set of manually and automatically labeled voxels, respectively. V(. ) is the volume operator, while \u2229 represents set intersection. The value of \u03ba varies between 0 and 1, where 1 indicates the complete overlap between the manual segmentation and that of the automatic method. Dice's kappa similarity metric is computed by comparing the segmentation from each automatic method with the manual segmentation for both left and right hippocampi. Since FreeSurfer uses a different anatomical definition of the hippocampus for training, we expect its \u03ba values will not be as high as those for the other methods.\n\u2022 Intraclass correlation coefficient\nWe used the regression coefficient and the intraclass correlation coefficient (ICC) to show the similarities between automatically and manually segmented volumes (Shrout and Fleiss, 1979) . \nwhere m and SD are the mean and standard deviation, respectively.\n\u2022 Receiver operating characteristic curve\nTo assess the performance of each method in detecting the clinical state of single subjects, we trained and tested a linear discriminant analysis (LDA) classifier to assign the subjects to different groups. We used the LDA classifier in two different classification tasks: to assign subjects to either the AD or NC group and to either the sMCI or pMCI group. For this problem, we used a simple linear classifier fed with mean hippocampal volumes along with age and sex as features. We used scikit-learn (Pedregosa et al., 2011) , a Python-based implementation of LDA, and all the hyperparameters were set to their default values. The classification task is evaluated based on ROC curves, which are calculated through a LOO cross-validation procedure. Since separate training and test datasets are used in this framework, classification analysis yields a more conservative performance evaluation than Cohen's d effect size."}, {"section_title": "Experiment 1: results", "text": ""}, {"section_title": "Dice's kappa metric", "text": "The \u03ba distribution is shown for the left and right hippocampus respectively in Fig. 1 and is summarized numerically in Table 3 . The nonlinear patch-based segmentation method with error correction yields the highest median \u03ba (\u03ba = 0.894 and 0.894 for the left and right hippocampus, respectively). These values are among the highest Dice's kappas reported in the literature (Dill et al., 2015) . A two-way repeated measures ANOVA, with segmentation method and the hemisphere in which the structure is located as independent variables, shows that the differences between the \u03ba values for different methods are significant, while no significant difference was observed when considering either left or right hemisphere. A post hoc paired Wilcoxon test with Bonferroni correction for multiple comparisons shows that the nonlinear patch-based method with error correction has the most overlap with manual segmentation, and the difference is statistically significant. The pairwise comparison further shows that all the differences are significant (p < .01), except between FreeSurfer with error correction and ANIMAL with label fusion both with and without error correction, as well as between the patch-based method with error correction and the nonlinear patch-based method. The same pattern was observed for both left and right hippocampi. The test shows that the difference between each method and its corresponding error corrected version is statistically significant. Furthermore, the large bias of FreeSurfer was expected due to a different anatomical definition of the hippocampus in its training phase. Fig. 2 shows the volumetric correlations between manual segmentation and the different automatic segmentation methods. In this study, we consider the raters (automatic and manual segmentation methods) to be fixed effects. The results show that the nonlinear patch-based method, with and without error correction, shows the highest correlation with manually segmented volumes for both the left and right hippocampi. The ICC values can be found in Table 4 for both left and right hippocampi for each method."}, {"section_title": "Volumetric correlation", "text": "A two-way repeated measures ANOVA of manually and automatically segmented hippocampal volume difference, with segmentation method and hemisphere as independent variables, shows that volumetric differences are significant for between-methods, but not between the left and right hemispheres. A post hoc paired Wilcoxon test with Bonferroni correction for multiple comparisons shows that the difference between the volumes measured by automatic and manual segmentation is insignificant for all methods, except for FreeSurfer, for which there was a significant difference when compared with manual segmentation and with all other methods (p < .001).\nBland-Altman plots (Fig. 3, Table 5 ) show that FreeSurfer oversegments the structure and furthermore has a tendency to oversegment larger hippocampi more so than smaller ones. An opposite tendency was observed for ANIMAL with label fusion. That method has a slight bias toward undersegmenting, and undersegmentation is more dominant for larger hippocampi, while smaller ones tend to be oversegmented. No significant pattern of difference between small and large hippocampi was observed in either of the other two methods. The plots show that error correction can be considered a bias correction technique, since the magnitude of the mean bias is reduced for each method. Error correction is more successful when applied to methods with large bias, such as FreeSurfer, whereas in the case of the methods with small bias, such as the patch-based techniques, error correction showed little improvement to segmentation performance. However, the variance of the pattern of differences between automatic and manual segmentations is still observable after the correction step has been applied."}, {"section_title": "Experiment 2: results", "text": ""}, {"section_title": "Dataset selection", "text": "Each method has a different number of failures; hence, we limited A. Zandifar et al. NeuroImage 155 (2017) 383-393 our analysis to the datasets which have successfully passed all the segmentation methods. The largest number of failures belongs to FreeSurfer (see Table 6 ). We further excluded the 60 subjects (20 AD, 8 pMCI, 12 sMCI, 20 NC) of the first dataset. The final dataset consists of 135 patients with Alzheimer's disease, 152 pMCI, 215 sMCI, and 178 normal controls, for which the demographic information can be found in Table 7 ."}, {"section_title": "Hippocampal volume as an AD biomarker", "text": "The effect size between the AD and NC groups for each method is given in Table 8 . A prognosis study was also completed, where the effect size was measured between the sMCI and pMCI groups (see Table 9 ). Effect size was measured as the mean of 200 bootstrapped copies of the dataset. Hippocampal volumes are corrected for age and sex. A paired t-test with Bonferroni correction for multiple comparisons was performed to show significant differences. Based on a conventional operational definition of Cohen's d, small, medium, and large effect sizes were defined as d < 0.5, d 0.5 < < 0.8, and d > 0.8, respectively. All investigated methods show large effect sizes between the AD and NC groups and medium effect sizes between the sMCI and pMCI groups (see Table 9 ). Hippocampal volumes are all reported in the population-specific average template stereotaxic space to correct for brain volume. For the AD versus NC experiment, the methods from worst to best (in terms of Cohen's d) are ANIMAL with label fusion (d=1.3228), ANIMAL with label fusion and error correction (d=1.3765), FreeSurfer (d=1.4886), the nonlinear patch-based method (d=1.5076), the patch-based method with error correction (d=1.5104), the nonlinear patch-based method with error correction (d=1.5134), the patch-based method (d=1.5793), and FreeSurfer with error correction (d=1.6921). ANIMAL with label fusion (d=1.2356), ANIMAL with label fusion with error correction (d=1.2492), FreeSurfer (d=1.3917), the patch-based method (d=1.4222), the nonlinear patch-based method (d=1.4273), the patch-based method with error correction (d=1.4326), the nonlinear patch-based method with error correction (d=1.4337), and FreeSurfer with error correction (d=1.4880). A pairwise t-test with Bonferroni correction for multiple comparisons shows that FreeSurfer with error correction works significantly better than the other methods to distinguish between AD and NC (p < .005). For the sMCI versus pMCI experiment, the methods from worst to best are ANIMAL with label fusion (d=0.4565), ANIMAL with label fusion and error correction (d=0.5040), the patch-based method with error correction (d=0.5450), the nonlinear patch-based method with error correction (d=0.5481), the nonlinear patch-based method (d=0.5551), FreeSurfer (d=0.5919), the patch-based method (0.5988), and FreeSurfer with error correction(d=0.6683). In both experiments a pairwise t-test with Bonferroni correction for multiple comparisons shows that FreeSurfer with error correction works significantly better than the other methods to distinguish in both experiments (p < .001). For the sMCI versus pMCI experiment, the methods from worst to best are ANIMAL with label fusion (d=0.4600), ANIMAL with label fusion and error correction (d=0.4620), the nonlinear patch-based method (d=0.5532), the patch-based method with error correction (d=0.5502), the patch-based method (d=0.5545), the nonlinear patch-based method with error correction (0.5605), FreeSurfer (d=0.6006), and FreeSurfer with error correction(d=0.6117). No pairwise significant difference was observed between the nonlinear patch-based method with error correction and FreeSurfer, nor between FreeSurfer with and without error correction, though these methods were significantly better than the others (p < .005). Although some of the differences between methods are significant, those differences are very small."}, {"section_title": "Hippocampal volume as an AD biomarker: ROC curve", "text": "We used the LDA classifier with LOO cross-validation to classify all the baseline data. Two similar experiments were run on AD versus NC subjects and stable MCI versus progressive MCI groups (See Fig. 4) . The area under the ROC curve (AUC) values are summarized in Table 10 . A Cochran's Q test, followed by a post hoc pairwise McNemar test with Bonferroni correction for multiple comparisons, shows there is no significant difference between the methods in terms of classification performance for AD versus NC, nor for sMCI versus pMCI. Furthermore, we observed no significant difference using the volume of left and right hippocampi as separate features. "}, {"section_title": "Discussion", "text": "Achieving a fair comparison of the accuracy of different automatic segmentation methods is not a trivial task. The quality of the MR images segmented, the segmentation protocol itself, inter-and intrarater variability, and specificity of the participant groups can all affect the reported accuracy (Collins and Pruessner, 2010) . For example, mean hippocampal volume decreases with age (Pruessner et al., 2001) , which can affect overlap-based statistics like Dice's \u03ba. In this study, we compared three different automatic hippocampal segmentation methods using the same testing dataset and manual segmentation protocol (Pruessner et al., 2000) . We then compared the three methods to the"}, {"section_title": "Or iginal Segmentation", "text": "Cor rected Segmentation hippocampal segmentation of the well-known FreeSurfer tool (Fischl et al., 2002) . We also applied an error correction technique to each automatic segmentation method using the same library of manual labels for correction (Wang et al., 2011 ). Dice's \u03ba metric is a measure of volumetric overlap, which means that it can be affected by both registration and segmentation errors. In our comparison, the nonlinear patch-based method with error correction showed the best median \u03ba value. The use of nonlinear registration enables better alignment than that accomplished by the linear patch- Mean column shows mean value of differences; SD column shows standard deviation of differences. based method. The intensity-based patch-based method shows promising results in its ability to capture structural variability , and applying the wrapper error correction method (Wang et al., 2011) further improves the segmentation. The other methods show proper alignment with manual segmentation as well. The results showed that the key factor affecting higher \u03ba values is registration. However, the linear patch-based method, despite its use of simple linear alignment of scans to the template, shows acceptable results in terms of the Dice's \u03ba metric. The FreeSurfer method does not use the population-based specific template. Its probabilistic template is based on a young, healthy population and thus is perhaps not a fair representation of the test database under study here. This distinction partially explains the oversegmentation pattern in the FreeSurfer segmentation: We observed that FreeSurfer oversegments larger hippocampi more than it does smaller ones, whereas ANIMAL with label fusion undersegments the larger hippocampi while oversegmenting the smaller ones. FreeSurfer's pattern of oversegmentation has been observed in Pipitone et al. (2014) as well. As FreeSurfer uses its own atlas to define the hippocampus, it is not surprising that it differs from the segmentation derived from Pruessner's protocol. The error correction method could successfully correct the bias in FreeSurfer results; yet, the variance pattern persists. Considering the bias toward oversegmentation observed in FreeSurfer, a wrapper error correction technique such as that used in this paper (Wang et al., 2011 ) is suggested to render the segmentation compatible with the population under study. Specifically, this addition becomes critically important when the population has anatomical characteristics that differ from the FreeSurfer template, which is derived from young, healthy adult population. The ICC ratio, as a measure of volume similarity between the gold standard (manual segmentation) and each automatic segmentation, shows the benefit of the patch-based intensity-driven strategy in segmentation. Considering both the ICC and \u03ba values, the results demonstrate that fine nonlinear registration combined with the patchbased strategy of segmentation is highly successful. A similar strategy won the MICCAI 2012 segmentation challenge . Fig. 2 shows the improvement for the patch-based methods from linear to nonlinear registration; the algorithm is further enhanced when the error correction strategy is applied.\nThe error correction strategy improves segmentation accuracy (in terms of agreement with manual labeling) for all four methods. Since FreeSurfer has the largest bias in comparison with the other automatic methods, it benefits the most from the bias correction technique; the improvement for all the other methods is slight. The methods already work well in accordance with manual segmentation and show only a very small bias before applying the correction. Furthermore, the variance of the methods does not improve even after applying the correction (see Fig. 3 ). A similar pattern was observed in the original paper (Wang et al., 2011) . Error correction performance is highly sensitive to its hyperparameters, such as the search boundary or the patch size around each voxel. For the sake of harmonization, in this study, we used the default parameters from the original paper (Wang et al., 2011) . It is possible to further tune the error correction method for each individual method separately, but such adjustments are out of the scope of this paper.\nWe computed Cohen's d effect size as a measure of how well each method differentiates between different clinical groups. Our study shows that Cohen's d is large for all the automated segmentation methods for AD/NC between-group analysis. That is, all eight methods can detect the hippocampal volume reduction for the AD group compared with the NC group. This observation confirms the idea that the hippocampus is affected by the disease neurodegeneration pathway.\nWith the prognosis experiment, we attempted to differentiate between sMCI and pMCI clinical groups. All methods showed medium effect sizes in this experimental setting; that is, the between-group mean difference is much smaller compared with the difference between the AD and NC groups. Considering the huge impact early detection of AD can have for treatment, this study has important clinical implications. The results of this study aligns with previous work (Sperling et al., 2011) showing that hippocampal atrophy on volumetric MR images is informative in separating the different clinical groups.\nWe further used a linear classifier to classify the subjects to AD or NC groups (diagnosis study) and to sMCI or pMCI groups (prognosis study). The methods are compared based on the area under the ROC curve (AUC), and results show that the methods do not differ in terms of classification performance in either the diagnosis or prognosis experiments.\nFreeSurfer has been shown to be fairly successful in previously published clinical studies. Considering the quality of FreeSurfer segmentations, we hypothesize that this difference can be explained by one or a combination of the following points. First, as observed in Fig. 2 , FreeSurfer has the tendency to bias the segmentation by oversegmenting the volume in general, with larger volumes showing a greater degree of oversegmentation in relation to smaller volumes. Second, oversegmentation in FreeSurfer is partially explained by the use of a different training population. We expect larger hippocampal volumes for a young, healthy population, which is exactly the population from which FreeSurfer's template is derived. While this may explain the oversegmentation tendency due to differences in MR image intensities, it does not explain the bias toward oversegmenting larger hippocampi. FreeSurfer tends to oversegment larger hippocampi more so than smaller ones, which has led to stronger group differences for disease studies. The pattern is still observable after error correction is applied.\nRecently, an effort has been made to harmonize different protocols for manual hippocampal segmentation (Boccardi et al., 2011 (Boccardi et al., , 2013 . The harmonized protocol (HarP) is highly similar to the manual segmentation protocol by Pruessner, which is used in this manuscript (Pruessner et al., 2000) . We have already run a comparison between the HarP and Pruessner's protocol (Zandifar et al., 2015) . The result showed no significant difference in terms of the effect size between clinical groups using these two protocols. However, segmentation accuracy measures (e.g., Dice's kappa) are higher for Pruessner's protocol. We hypothesized that the higher values could be in part due to the protocol's use of three-dimensional tracing versus twodimensional tracing for HarP labels, where boundary smoothness may not be ensured (Zandifar et al., 2015) . A detailed comparison between the two manual segmentation protocols would be worthwhile and should be considered in the future."}, {"section_title": "Limitations", "text": "We faced some limitations in conducting this study. First, FreeSurfer was used with its default settings, which may bias the results against it. We applied the error correction method to partially correct for the bias due to different training datasets. Although we included only the subjects that passed quality control for all processing pipelines, it is important to note that the experiments (AD:NC and sMCI:pMCI) are biased towards FreeSurfer. Indeed, for the 101 (=31+24+45) subjects that failed the FreeSurfer pipeline (see Table 6 ), it was not possible to estimate hippocampal volume. That is, greater than 12% of the test set should receive a random classification (or be considered missing data) in a forced-choice design, which would greatly reduce the advantage when using FreeSurfer hippocampal volumes for both AD:NC and sMCI:pMCI experiments.\nFor the second experiment, it would have been worthwhile to compare the performance of the automatic methods with manual segmentations. However, because manually segmenting the hippocampus on the entire ADNI dataset would be such a lengthy and laborious undertaking, we limited the comparison to the automatic methods."}, {"section_title": "Conclusion", "text": "We conclude that the four automatic methods tested all show acceptable conformity with manual segmentation. Nonlinear registration is the key factor to obtaining good spatial alignment with the manual segmentation. The patch-based strategies perform well, with good correlation with manual segmentation. Our second experiment demonstrated that all four automatic methods can be used as a proper substitute for costly manual segmentation in a clinical setting. All the effect sizes for diagnosis setting were found to be large, while all methods compared showed a medium effect size in prognosis settings. Overall, the patch-based method enhanced with nonlinear registration and the error correction technique (Wang et al., 2011) shows the most promising results among the different methods conducted in our experiments."}]
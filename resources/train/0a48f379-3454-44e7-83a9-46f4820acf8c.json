[{"section_title": "Abstract", "text": "This article provides a review of Bayesian model averaging as a means of optimizing the predictive performance of common statistical models applied to large-scale educational assessments. The Bayesian framework recognizes that in addition to parameter uncertainty, there is uncertainty in the choice of models themselves. A Bayesian approach to addressing the problem of model uncertainty is the method of Bayesian model averaging. Bayesian model averaging searches the space of possible models for a set of submodels that satisfy certain scientific principles and then averages the coefficients across these submodels weighted by each model's posterior model probability (PMP). Using the weighted coefficients for prediction has been shown to yield optimal predictive performance according to certain scoring rules. We demonstrate the utility of Bayesian model averaging for prediction in education research with three examples: Bayesian regression analysis, Bayesian logistic regression, and a recently developed approach for Bayesian structural equation modeling. In each case, the model-averaged"}, {"section_title": "", "text": "estimates are shown to yield better prediction of the outcome of interest than any submodel based on predictive coverage and the log-score rule. Implications for the design of large-scale assessments when the goal is optimal prediction in a policy context are discussed."}, {"section_title": "Keywords", "text": ""}, {"section_title": "Bayesian model averaging, large-scale assessments, education", "text": "The distinctive feature that separates Bayesian statistical inference from its frequentist counterpart is its focus on describing and modeling all forms of uncertainty. The primary focus of uncertainty within the Bayesian framework concerns background knowledge about model parameters. In the Bayesian framework, all unknowns are described by probability distributions designed to encode background knowledge about parameters; and because parameters are, by definition, unknown, Bayesian inference encodes background knowledge about parameters in the form of prior distributions.\nAs with frequentist model building, another goal of Bayesian statistical analysis is model choice. Two popular methods are the Bayesian information criterion (BIC; Kass & Raftery, 1995; Schwarz, 1978) and the deviance information criterion (DIC; Spiegelhalter, Best, Carlin, & van der Linde, 2002) . In both cases, a set of models are compared, and the model with the lowest BIC or DIC value is chosen for summary and discussion.\nWithin the Bayesian framework, parameters are not the only unknown elements. In fact, the Bayesian framework recognizes that models themselves possess uncertainty insofar as a particular model is typically chosen among a set of competing models that could also have generated the data. Quoting Hoeting, Madigan, Raftery, and Volinsky (1999) , Standard statistical practice ignores model uncertainty. Data analysts typically select a model from some class of models and then proceed as if the selected model had generated the data. This approach ignores the uncertainty in model selection, leading to over-confident inferences and decisions that are more risky than one thinks they are. (p. 382) In practice, model uncertainty often goes unnoticed, and the impact of this uncertainty can be quite profound. Although a number of methods exist in the Bayesian literature to aid in improving model prediction, including sensitivity analyses via posterior predictive checking (Gelman, Meng, & education for all. Many of the stated targets under Goal 4 focus on reducing the gender gap in quality education, and, in particular, Goal 4.6 focuses on achieving literacy and numeracy for men and women (http://www.un.org/ sustainabledevelopment/).\nDeveloping optimal predictive models would allow education researchers and policy makers to assess cross-country progress and forecasts toward Goal 4.6 using, among other data sources, large-scale cross-sectional and longitudinal educational data such as the Early Childhood Longitudinal Study (ECLS-K; National Center for Educational Statistics (NCES), 2001), the Program for International Student Assessment (PISA; e.g., Organization for Economic Cooperation and Development (OECD), 2010), or the Trends in International Mathematics and Science Study (TIMSS; e.g., Mullis, 2013) . Large-scale assessments provide a unique lens on the antecedents, mediators, and outcomes of education policies and practices. Although applications of advanced statistical models to these types of data are, of course, not new, a review of the extant literature indicates that these models have not been applied to educational data with the explicit goal of obtaining models exhibiting optimal predictive performance for education research, evaluation, or policy purposes."}, {"section_title": "Purpose and Organization of this Article", "text": "The purpose of this article is to provide a general review of Bayesian model averaging with applications to common statistical models applied in educational research, evaluation, and policy analysis. Our focus is on traditional methods of Bayesian model averaging that make use of readily available software applied to real data in order to demonstrate the gain in predictive accuracy when applying Bayesian model averaging for optimizing predictive performance. It should be noted, however, that Bayesian model averaging is still an active field of methodological development.\nThe organization of this article is as follows. In the next section, we discuss the model choice problem. Next, we outline the method of Bayesian model averaging with an additional discussion of Occam's window and the MC 3 algorithm, following closely the work of Madigan and his colleagues (Hoeting et al., 1999; Madigan & Raftery, 1994; Raftery et al., 1997 ). We then demonstrate Bayesian model averaging with three examples: Bayesian linear regression, Bayesian logistic regression, and Bayesian structural equation modeling (BSEM). This article next discusses some additional technical considerations, a brief discussion of frequentist approaches to model averaging, and finally, implications for large-scale assessment designs when the goal is to optimize prediction. The last section of this article concludes. All analyzes are conducted within the R programming environment (R Core Team, 2017) , and all data and code are available at http://bise.wceruw.org/index.html"}, {"section_title": "The Method of Bayesian Model Averaging", "text": "Following Madigan and Raftery (1994) , consider a quantity of interest such as a future observation. We will denote this quantity as U. Next, consider a set of competing models M k , k \u00bc 1; 2; . . . ; K that are not necessarily nested. The posterior distribution of U given data y can be written as a mixture distribution,\np\u00f0M k jy\u00de is the posterior probability of model M k written as:\nthe first term in the numerator on the right-hand side of Equation 2 is the probability of the data given model k, also referred to as the integrated likelihood written as:\np\u00f0q k jM k \u00de is the prior distribution of the parameters q k under model M k (Raftery et al., 1997) . The PMPs can be considered mixing weights for the mixture distribution given in Equation 1 (Clyde & Iversen, 2015) . The second term p\u00f0M k \u00de on the right-hand side of Equation 2 is the prior model probability for model k, allowing each model to have a different prior probability based on past performance of that model or a belief regarding which of the models might be the true model. The denominator of Equation 2 ensures that p\u00f0M k jy\u00de integrates to 1.0, as long as the true model is in the set of models under consideration. A review of this latter issue is reserved for the Discussion section of this article."}, {"section_title": "Connections to Bayes Factors (BFs)", "text": "An important feature of Equation 2 is that p\u00f0M k jy\u00de captures the posterior (postdata) uncertainty in a given model and will likely vary across models.\nHerein lies the problem of model selection; given the choice of a particular model, the analyst effectively ignores the uncertainty in other models that could have generated the data. Of course, Equation 2 could be used as a method for model selection, simply choosing the model with the largest PMP. However, to settle on a particular model still ignores the uncertainty inherent in the choice problem. Yet another common approach for model selection is the BF which provides a way to quantify the odds that the data favor one hypothesis over another (Kass & Raftery, 1995) . A key benefit of BFs is that models do not have to be nested. To motivate the BFs, consider two competing models, denoted as M k and M l , that could be nested within a larger space of alternative models. Let q k and q l be the two parameter vectors associated with these two models. These could be two regression models with a different number of variables or two SEMs specifying very different directions of mediating effects. The goal is to develop a quantity that expresses the extent to which the data support M k over M l . One quantity could be the posterior odds of M k over M l , expressed as:\nThe first term on the right-hand side of Equation 4 is the ratio of two integrated likelihoods. This ratio is referred to as the BF for M k over M l , denoted here as BF kl . In words, our prior opinion regarding the odds of M k over M l , given by p\u00f0M k \u00de=p\u00f0M l \u00de, is weighted by our consideration of the data, given by p\u00f0yjM k \u00de=p\u00f0yjM l \u00de.\nA connection between the BF in Equation 4 and the PMP in Equation 2 has been pointed by others (see, e.g., Clyde, 1999) . Specifically, when examining more than two models, and assuming equal prior odds, then the BF for M k over M l can be written as:\nAssuming that we fix the first model M 1 as the baseline model, Equation 2 can be reexpressed as:"}, {"section_title": "Computational Issues", "text": "As pointed out by Hoeting et al. (1999) , Bayesian model averaging is difficult to implement. In particular, they note that the number of terms in Equation 1 can be quite large, the corresponding integrals are hard to compute (though possibly less so with the advent of Markov chain Monte Carlo [MCMC] sampling), the specification of p\u00f0M k \u00de may not be straightforward, and choosing the class of models to average over is also challenging.\nTo address the problem of computing Equation 3, the Laplace method, which has been used productively for the computation of BFs (Kass & Raftery, 1995) , can be used, and this will lead to a simple BIC approximation under certain circumstances (Raftery, 1996; Tierney & Kadane, 1986) ."}, {"section_title": "1", "text": "The problem of reducing the overall number of models that one could incorporate in the summation of Equation 1 has led to two interesting solutions. One solution is based on the so-called Occam's window criterion (Madigan & Raftery, 1994 ) and the other is based on MCMC model composition (MC 3 )\nOccam's window. To motivate the idea behind Occam's window, consider the problem of finding the best subset of predictors in a linear regression model. 2 Following closely the discussion given in Raftery, Madigan, and Hoeting (1997) , we could initially start with very large number of predictors, but perhaps the goal is to narrow down this initially large set of predictors to a small number of predictors that provide accurate predictions. As noted in the earlier quote by Hoeting et al. (1999) , the concern in drawing inferences from a single \"best\" model is that the choice of a single set of predictors ignores uncertainty in model selection. Occam's window provides an approach to Bayesian model averaging that reduces the subset of models under consideration.\nThe algorithm proceeds in two steps (Raftery et al., 1997) . In the first step, models are eliminated from Equation 1 if they predict the data much less well than the model that provides the best predictions based on a \"caliper\" value C chosen in advance by the analyst. The caliper C sets the \"width\" of Occam's window. Formally, consider again a set of models M k , k \u00bc 1; :::; K. Then, the set A 0 is defined as:\nIn words, Equation 7 compares the model with the largest PMP, max l fp\u00f0M l jy\u00deg, to a given model, p\u00f0M k jy\u00de. If the ratio in Equation 7 is greater than the chosen value C, then it is discarded from the set A 0 of models to be included in the model averaging. Notice that the set of models contained in A 0 is based on BF values. The set A 0 now contains models to be considered for model averaging. In the second, optional, step, models are discarded from A 0 if they receive less support from the data than simpler submodels. Formally, models are further excluded from Equation 1 if they belong to the set:\nAgain, in words, Equation 8 states that there exists a model M l within the set A 0 and where M l is simpler than M k . If a complex model receives less support from the data than a simpler submodel-again based on the BFthen it is excluded from B. Notice that the second step corresponds to the principle of Occam's razor (Madigan & Raftery, 1994) .\nWith\nStep 1 and Step 2, the problem of Bayesian model averaging is simplified by replacing Equation 1 with:\nIn other words, models under consideration for Bayesian model averaging are those that are in A 0 but not in B. Formally, A \u00bc A 0 \\B. Madigan and Raftery (1994) then outline an approach to the choice between two models to be considered for Bayesian model averaging. To make the approach clear, consider the case of just two models M 1 and M 0 , where M 0 is the simpler of the two models. This could be the case where M 0 contains fewer predictors than M 1 in a regression analysis. In terms of logposterior odds, if the log-posterior odds are positive, indicating support for M 0 , then we reject M 1 . If the log-posterior odds is large and negative, then we reject M 0 in favor of M 1 . Finally, if the log-posterior odds lies in between the preset criterion, then both models are retained."}, {"section_title": "MC", "text": "3 . The goal of MC 3 is the same as that of Occam's window-namely-to reduce the space of possible models that can be explored in a Bayesian model averaging exercise. Following Hoeting et al. (1999) , the MC 3 algorithm proceeds as follows. First, let M represent the space of models of interest; in the case of linear regression, this would be the space of all possible combinations of variables. Next, the theory behind MCMC allows us to construct a Markov chain fM\u00f0t\u00de; t \u00bc 1; 2; . . . ; g which converges to the posterior distribution of model k, that is, p\u00f0M k jy\u00de.\nThe manner in which models are retained under MC 3 is as follows. First, for any given model currently explored by the Markov chain, we can define a neighborhood for that model which includes one more variable and one less variable than the current model. So, for example, if our model has four predictors x 1 , x 2 , x 3 , and x 4 , and the Markov chain is currently examining the model with x 2 and x 3 , then the neighborhood of this model would include fx 2 g, fx 3 g, fx 2 ; x 3 ; x 4 g, and fx 1 ; x 2 ; x 3 g. Now, a transition matrix is formed such that moving from the current model M to a new model M 0 has probability 0 if M 0 is not in the neighborhood of M and has a constant probability if M 0 is in the neighborhood of M. The model M 0 is then accepted for model averaging with probability, min 1; pr\u00f0M 0 jy\u00de\notherwise, the chain stays in model M."}, {"section_title": "Gauging Predictive Performance in Bayesian Model Averaging", "text": "A key characteristic of statistics is to develop accurate predictive models (Dawid, 1984) . Indeed, as pointed out by Bernardo and Smith (2000) , all other things being equal, a given model is to be preferred over other competing models if it provides better predictions of what actually occurred. Thus, a critical component in the development of accurate predictive models is to decide on rules for gauging predictive accuracy-often termed scoring rules. Scoring rules provide a measure of the accuracy of probabilistic forecasts, and a forecast can be said to be \"well-calibrated\" if the assigned probabilities of the outcome match the actual proportion of times that the outcome occurred. The development of accurate predictive models has, arguably, been overlooked in education where the goal has been instead an orientation toward finding well-fitting models, particularly in the context of SEM (e.g., Kaplan, 2009) .\nA number of scoring rules are discussed in the literature (see, e.g., Gneiting & Raftery, 2007; Jose, Nau, & Winkler, 2008; Merkle & Steyvers, 2013a; Winkler, 1996) ; however, for this article, we will primarily evaluate predictive performance using the 90% predictive coverage criterion (Hoeting et al., 1999) and the log of the percentage predictive coverage for continuous outcomes referred to as the log score. Predictive coverage is used productively in frequentist and Bayesian settings and is assessed using the proportion of predicted observations that fall in the corresponding 90% prediction interval. For this article, the predictive coverage criterion is implemented via the R routine \"predict\" in the program \"stats\" (R Core Team, 2017) . For the prediction of a dichotomous outcome, it is common to use the Brier (1950) score defined as:\nwhere over each forecast instant t, f t is the probabilistic forecast and o t is the observed event (1 if the forecasted event took place, 0 otherwise). Both the log score and the Brier score are so-called proper scoring rules insofar as the score is maximized (or minimized in the case of the Brier score) when the reported forecast probability is the same as true probability. In both cases, the log score is a local and strictly proper scoring rule that assesses the quality of the prediction by providing a numerical score based on the accuracy of the match between the predictive distribution and the actual obtained values. The log score is strictly proper in the sense that it is unique (see, e.g., Gneiting & Raftery, 2007; Merkle & Steyvers, 2013b , for more detail)."}, {"section_title": "Case Study 1: Bayesian Model Averaging for the Linear Regression Model Using PISA 2009 Data and Model", "text": "The first case study make uses of the same data set and linear regression model as used by Kaplan (2014) except here we focus on relative predictive performance. The data set was collected from PISA 2009-eligible students in the United States (OECD, 2009). The sample size was 4,924 after listwise deletion which was then was split into a model averaging set (n \u00bc 2,462) and a predictive testing set (n \u00bc 2,462). For this regression example, the outcome, reading proficiency (READING), was regressed on a set of background, attitudinal, and reading strategy variables. Background variables included FEMALE (male \u00bc 0, female \u00bc 1), immigrant status (NATIVE), language that the students use (SLANG: coded 1 if the test language is the same as language at home, 0 otherwise), and a measure of economic, social, and cultural status of the students (ESCS). Variables measuring reading attitudes were enjoyment of reading (JOYREAD) and diversity in reading (DIVREAD). Measures of student reading strategies were memorization strategies (MEMOR), elaboration strategies (ELAB), and control strategies (CSTRAT This model serves as the initial model for Bayesian model averaging and can be defined as:\nIt should be noted that neither the model in Equation 12 nor the models in Case Studies 2 and 3 below contain interaction terms. This was done for simplicity and ease of communicating the central purpose of BMA. However, BMA can incorporate interaction terms, but it is important to proceed with caution. We mention the issue of using interaction terms within BMA in the Discussion section."}, {"section_title": "Method", "text": "For Bayesian model averaging, we used the \"bicreg\" function within the R package BMA (Raftery, Hoeting, Volinsky, Painter, & Yeung, 2015) setting Occam's window to 20. The BMA program utilizes the Laplace approximation described above and is computationally quite fast even for fairly large regression models. For model parameters, we used the default in the BMA package-namely, the unit information prior. Following Raftery (1998, pp. 3-6) , the unit information prior is a weakly informative prior that is diffused over the region of the likelihood where parameter values are considered mostly plausible but not overly spread out. This is accomplished by forming the prior based on the maximum likelihood estimate of the parameter mean, with variance equal to the expected information matrix for one observation. The prior on the model space is 1=M, where M is the number of models.\nThe Bayesian regression model was estimated using the Gibbs sampler as implemented in the \"MCMCregress\" function within the \"MCMCpack\" package (A. D. Martin, Quinn, & Park, 2013) . We used improper uniform priors for the regression coefficients and precisions. In addition, the variance of the disturbance term was set to have a noninformative inverse-gamma distribution with shape and scale of 0.001. This analysis used 100,000 iterations, with 5,000 burn-in iterations and a thinning interval of 10.\nCase Study 1 also compared the predictive performance of a Bayesian model averaging regression to Bayesian and frequentist regressions based on the initially specified regression model. For comparison of predictive performance, we used a measure of 90% prediction coverage, which is the percentage of the observations in the prediction set that fall in their corresponding 90% prediction interval (Hoeting et al., 1999) . Table 1 presents four regression models selected by BMA. Based on the full model in Equation 12, BMA selected four models (Models 1-4) after narrowing down the number of models via Occam's window. The four models are shown in descending order in term of the PMPs and accounts for 100% of the total PMP. Note that the best model (Model 1) accounts for only 76% of the total PMP indicating a fair amount of uncertainty remaining in the model selection. The black dots represent predictors that appear in the respective models. Of the nine predictors in the full model, only five predictors (ESCS, JOYREAD, MEMOR, ELAB, and CSTRAT) appear across all four models. We compared results from Bayesian model averaging to results from a single Bayesian regression analysis of the initial model in Table 2 (labeled \"Bayes Reg.\"). Some differences between two results are indicated. For example, the variable NATIVE under Bayesian model averaging has no effect on READING while having a negative effect under the Bayesian regression model. In addition, Bayesian model averaging shows weak evidence for DIVREAD's effect on READING with only 14.6% of the proportion of the nonzero posterior probability of the coefficient (D. Wang, Zhang, & Bakhai, 2004) . Bayesian regression, however, indicated DIV-READ as an important predictor.\nAs with the linear regression example in Case Study 1, we used noninfomative priors for the logistic regression model for Case Study 2. For Bayesian model averaging, we utilize the \"bicglm\" function within the R program BMA (Raftery et al., 2015) with Occam's window set to 20. The Bayesian logistic regression model was estimated using the Gibbs sampler as implemented in the \"MCMClogit\" function within the R package \"MCMCpack\" package (A. D. Martin et al., 2013) . We specify noninformative priors by setting the means for all regression coefficients to 0 and the precisions of all regression coefficients to 0.01 (variance \u00bc 100). This specification results in highly diffused priors for all coefficients. The variance of the disturbance term was set to have a noninformative inversegamma distribution with shape and scale of 0.001. The analysis used 100,000 iterations, with 5,000 burn-in iterations, a thinning interval of 50, and a Metropolis tuning of 0.25.\nWe focus our attention on SEMs among observed variables. Following the notation by Kaplan and Lee (2015, see also; Kaplan & Depaoli, 2012; Kaplan, 2009 ), a SEM can be specified as follows. Let\nwhere y is a vector of manifest endogenous variables and x be a vector of observed exogenous variables with covariance matrix F. Further, let \u03b1 is a vector of structural intercepts, B is a matrix of structural regression coefficients relating the observed variables y to other observed endogenous variables, \u0393 is a matrix of structural regression coefficients relating the endogenous variables to observed exogenous variables x, and \u03b6 is a vector of structural disturbances with covariance matrix C assumed to be diagonal.\nConjugate priors for SEM parameters. To specify prior distributions on all model parameters, we follow the notation of Kaplan and Depaoli (2012) and arrange the model parameters as sets of common conjugate prior distributions. Parameters with the subscript norm follow a normal distribution, while those with the subscript IW follow an inverse Wishart distribution. Let \u03b8 norm \u00bc f\u03b1; B; \u0393g be the vector of free model parameters that are assumed to follow a normal distribution, and let \u03b8 IW \u00bc fF; Cg be the vector of free model parameters that are assumed to follow the inverse Wishart distribution. Formally, we write:\nwhere m and O are the mean and variance hyperparameters, respectively, of the normal prior. For blocks of variances and covariances in X and C, we assume that the prior distribution is inverse Wishart, that is,\nwhere R is a positive definite matrix, and d > q \u00c0 1, where q is the number of observed variables. Different choices for R and d will yield different degrees of \"informativeness\" for the inverse Wishart distribution.\nThe \"BMASEM\" algorithm. Following closely the recent paper by Kaplan and Lee (2015) , our approach to Bayesian model averaging for SEMs draws on the fact that path diagrams within the SEM tradition can be seen as special cases of so-called directed acyclic graphs (DAGs), the latter having been developed by Pearl (2009) . Bayesian model averaging over DAGs has also been discussed in Madigan and Raftery (1994) ; however, a review of the extant literature indicates that Bayesian model averaging over DAGS has not been utilized in education and not fully developed for SEM. In this section, we describe the full algorithm used to conduct Bayesian model averaging for SEMs for Case Study 3. The general steps of the algorithm are as follows: (a) specify an initial model of interest recognizing that this may not be the model that generated the data; (b) starting with the initial model represented as a DAG, implement a search over the DAG to reduce the space of models to a reasonable size while maintaining the distinction between exogenous, mediating, and endogenous variables; (c) obtain the PMPs for each model; (d) obtain the weighted average of structural parameters over each model, weighted by the PMPs; and (e) compare predictive performance of the Bayesian model averaging SEM to the initially specified BSEM by computing the reduced form of the models and calculating the log score and/or the predictive coverage (Kaplan & Lee, 2015) .\nModel selection via the up and down algorithm. We apply the search algorithm first suggested by Madigan and Raftery (1994) and implemented by Kaplan and Lee (2015) that they refer to as the \"up and down algorithm.\" Starting with an initial model, the algorithm first executes the \"down\" algorithm, wherein each model in the set is compared with its submodels. If there is a model with no submodel in the down algorithm, then model comes under consideration for the \"up\" algorithm. Thus, the up algorithm is carried out only when a set of models under consideration for the up algorithm exist after the down algorithm is completed. Occam's window and Occam's razor are employed in the up and down algorithm to select the submodels which predict as well as the best model. The details of the algorithm are given in Kaplan and Lee (2015) .\nAveraging over SEM parameters. A set of K possible SEMs \u00f0k \u00bc 1; 2; :::; K\u00de in the set A are chosen through the up and down algorithm. With this set, the PMPs are obtained using a BIC approximation as:\nwhere DBIC is the difference of BIC of M k and the maximum of BICs of all the models in the set. The PMPs are used as weights to obtain posterior means of parameters across all the models in the set. In other words, posterior means of the model parameters are the averaged parameters of the posterior distributions for the set of selected models, weighted by their PMPs. The posterior mean for a parameter q under model M k , given the data D, can be written as (see Kaplan & Lee, 2015) :"}, {"section_title": "Regression Results", "text": ""}, {"section_title": "Prediction Results for the Regression Model", "text": "When comparing models in terms of 90% predictive coverage and the logscore rule, Bayesian model averaging yielded a more liberal predictive coverage (96%) compared to the best model from BMA, the Bayesian regression model, or the frequentist regression model as shown in Table 3 . It is important to point out that although the predictive performance in this example is somewhat liberal, a small simulation based on this model with 10,000 replications revealed the mean predictive coverage interval was 0.79-0.98 and centered at 0.90. This small simulation study highlights the importance of supplementing Bayesian prediction with a frequentist calibration. This fusing of Bayesian modeling and frequentist calibration has been discussed generally by Little (2006) and in the context of BMA by Draper (1999) ."}, {"section_title": "Case Study 2: Bayesian Model Averaging for the Logistic Regression Model Using ECLS-K 1998 Data and Model", "text": "For this case study, we use data from Kaplan and Chen (2012) who studied Bayesian model averaging in the context of propensity score analysis. The data set was randomly sampled from the Early Childhood Longitudinal Study Kindergarten cohort of 1998 (NCES, 2001, ECLS-K) . For this example, we model whether full-day or partday kindergarten attendance can be predicted by 14 variables based on Bayesian model averaging and Bayesian logistic regression. The sample size was 1,000 where 538 children were in full-day programs (FULL-DAY \u00bc 1) and 462 children in part-day programs (FULLDAY \u00bc 0). The sample was evenly divided into a model averaging set (n \u00bc 500) and a predictive testing set (n \u00bc 500). Those predictors included GENDER, RACE, mother's employment status (MEMP), child's age at kindergarten entry (AGEENT), child's age at first nonparental care (AGEFRS), primary type of nonparental care (PRIMNW), both parent language to child (LANGUG), number of siblings (NUMSIB), family composition (FAMIL), mother's employment between child's birth and kindergarten (MEMPBK), number of nonparental care arrangement (NUMPRK), social economic status (SES), parent's expectation of child's degree (EXPECT), and how often parent reads to child (READ).\nThe full logistic regression model we were interested in was:"}, {"section_title": "Logistic Regression Results", "text": "Based on the full logistic regression model in Equation 13, the BMA program selected 11 models, and the best 5 selected models are shown in Table 4 . The five models account for 84% of the total PMP. Model 1 accounts for only 44% of the total PMP thus showing that a large amount of uncertainty still exists in the model selection process. In this case study, only two predictors, PRIMNW and FAMIL, appear in the best five models.\nFrom Table 5 , we see that the differences between the Bayesian model averaging model and Bayesian logistic model (labeled \"Bayes Log. Reg.\") are large. With the exception of PRIMNW and FAMIL, the remaining 12 predictors showed little or weak relationships to FULLDAY in the Bayesian model averaging model. The Bayesian logistic regression model, however, indicated two more important predictors: MEMP and MEMPBK."}, {"section_title": "Prediction Results for the Logistic Regression Model", "text": "We also assessed the predictive performance of the Bayesian model averaging logistic model and compared it to the predictive performance of the Bayesian and frequentist logistic models. To compare predictive performance based on the binary dependent variable, FULLDAY, the Brier (1950) score was adopted. For this study, the Brier score is defined in Equation 11. We see from Table 6 that although the differences are quite small, the Brier score is lowest for the Bayesian model averaging logistic regression model indicating better predictive performance compared to the best model selected by BMA, the single Bayesian logistic regression model, or the frequentist regression model. J\u00f6reskog, 1973) . In addition to these founding concepts, the first generation of SEM witnessed important methodological developments in handling nonstandard conditions of the data. These developments included methods for dealing with nonnormal data, missing data, and sample size sensitivity problems (see, e.g., Kaplan, 2009 ). The second generation of SEM could be broadly characterized by another merger: This time, combining models for continuous latent variables developed in the first generation with models for categorical latent variables (see B. Muth\u00e9n, 2001 ). The integration of continuous and categorical latent variables into a general modeling framework was due to the extension of finite mixture modeling to the SEM framework. This extension has provided an elegant theory, resulting in a marked increase in important applications. These applications include, but are not limited to, methods for handling the evaluation of interventions with noncompliance (Jo & Muthen, 2001 ), discrete-time mixture survival models (B. Muth\u00e9n & Masyn, 2005) , and models for examining unique trajectories of growth in academic outcomes (Kaplan, 2003) . A parallel development to first and second generation SEM has been the expansion of Bayesian methods for complex statistical models, including SEMs. Early papers include J. K. Martin and McDonald (1975) , Lee (1981) , and Scheines, Hoijtink, and Boomsma (1999) . Lee (2007) provides a review and extensions of BSEM. The increased use of Bayesian tools for statistical modeling has come about primarily as a result of progress in computational algorithms based on MCMC sampling. The MCMC algorithm is implemented in software programs such as WinBugs (Lunn, Thomas, Best, & Spiegelhalter, 2000) , Mplus (L. K. Muth\u00e9n & Muth\u00e9n, 1998 , and various packages within the R archive (R Core Team, 2017), such as \"rjags\" and \"rstan.\""}, {"section_title": "Data and Model", "text": "Case Study 3 used the same data set as used for Case Study 1 but selected 8 of the 10 variables including ESCS, GENDER, NATIVE, MEMOR, ELAB, CSTRAT, JOYREAD, and READING for SEM. The model of interest is illustrated in Figure 1 . The first three background variables were exogenous variables and the rest five variables were endogenous variables. Of those endogenous variables, three reading strategy variables were indicators for JOYREAD which was an indicator for READING. The sample size was 4,979 after the list-wise deletion. The sample was then split into a model averaging set (n \u00bc 2,489) and a predictive testing set (n \u00bc 2,490). For SEM Bayesian model averaging, we used the R package BMASEM which is available at http://bise.wceruw.org/publications.html. In the BMA-SEM program, the value of 100 was chosen for Occam's window, and the model in Figure 1 was used as a starting model for the model comparison in the down algorithm. A BSEM based on Figure 1 was estimated with noninformative conjugate priors for all model parameters was conducted using \"rjags\" (Plummer, 2016) , \"coda\" (Plummer, Best, Cowles, & Vines, 2006) , and \"MCMCpack\" R packages. The MCMC algorithm for this case study was set to 500,000 iterations, with 5,000 burn-in iterations, a thinning interval of 50 from two chains starting at different locations in the posterior distribution.\nPredictive performance for Bayesian model averaging SEM. We compared the predictive performance of Bayesian model averaging under SEM to the predictive performance based on the initially specified BSEM. Kaplan and Lee (2015) estimated the predictive performance of the model under Bayesian model averaging by transforming the structural form of the model into the reduced form where the endogenous variables are on the left side of the equation and the exogenous variables on the right side. The structural form was given in Equation 14 and can be rewritten as:\nAssuming that \u00f0I \u00c0 B\u00de is nonsingluar,\nwhere P 0 is the vector of reduced form intercepts, P 1 the vector of reduced form slopes, and \u03b6 \u00c3 the vector of reduced form disturbances with variance matrix, C \u00c3 . With the structural form of the model transformed into the reduced form, we can obtain and compare predicted values in a manner similar to Case Study 1. Specifically, the comparison procedure is as follows (Kaplan & Lee, 2015) :\n1. Randomly divide the data set into a model-averaging set and a predictive testing set. 2. Fit a single BSEM and Bayesian model averaging SEM to the model-averaging data. 3. Convert the structural form of the model to its reduced form. 4. Predict the final dependent variable in the reduced form for the predictive testing data with the result of the reduced form of the BSEM and Bayesian model averaging. 5. Compare their predictive performance based on 90% of predictive coverage."}, {"section_title": "SEM Results", "text": "Based on the model in Figure 1 , the algorithm used in the BMASEM package selected four models for C \u00bc 100, resulting four models which accounted for 100% of the total PMP. Note again, that the best model in terms of the BIC has a PMP of 0.69, again indicating a relatively high degree of posterior model uncertainty. Table 7 displays the selected model for this example. Table 8 presents the results from the Bayesian model averaging SEM and the BSEM. There were four regressions set to 0 in the initial model including MEMOR on NATIVE and JOYREAD on ESCS, GENDER, and NATIVE. With the exception of JOYREAD on NATIVE, the remaining three regressions appeared in best model based on the BIC. On the contrary, the regression of ELAB on GENDER which was in the original model does not appear in the best model. Note. PMP \u00bc posterior model probability. ESCS \u00bc measure of economic, social, and cultural status of the students; JOYREAD \u00bc enjoyment of reading; DIVREAD \u00bc diversity in reading; MEMOR \u00bc memorization strategies; ELAB \u00bc elaboration strategies; CSTRAT \u00bc control strategies; BIC \u00bc Bayesian information criterion; NATIVE \u00bc immigrant status. Table 9 presents the prediction results for the BSEM example. As predicted by the theory of Bayesian model averaging, we observe modestly better predictive performance in terms of 90% predictive coverage and the log-score rule under Bayesian model averaging compared to Bayesian and frequentist approaches."}, {"section_title": "Discussion", "text": "We divide our Discussion section into four parts. First, we discuss some remaining important technicalities. Second, we discuss some limitations of BMA. Third, we discuss a frequentist approach to model averaging. Last, we discuss the importance of model averaging for large-scale assessment design."}, {"section_title": "Some Remaining Technicalities", "text": "Throughout this article, a subtle assumption was invoked but not discussed; namely, that the true model, say, M T was one of the models in the set of models M k , k \u00bc 1; 2; :::; K. This assumption is referred to as the M-closed framework discussed in Bernardo and Smith (2000) and Clyde and Iversen (2015) . The M-closed framework can be contrasted with the M-completed framework and the M-open framework. In the M-closed framework, it makes sense to assign prior probabilities that M T is in the space of models. In fact, this is the framework that underlies the standard approach to BMA discussed in this article; prior probabilities are assigned to the set of models (typical the indifference prior 1=M) encoding ones belief that each model is equally likely to be the true model. The application of the indifference prior is the conventional default in the BMA software program used in this article (Raftery et al., 2015) . In the M-completed and M-open frameworks, M T is not in the set of models M k , which are simply considered proxies to be compared. As such, the assignment of prior probabilities makes less sense and the question comes down to how models are to be chosen and averaged if the true model does not exist within the set of possible models. Following Bernardo and Smith (2000, p. 385) , in the M-completed framework, the analyst has entertained a true model M T , but that this true model lies outside the set of models M k , k \u00bc 1; 2; :::; K being considered. The set of models M k is enumerated for purposes of scientific communication and is evaluated in light of the true model M T . By contrast, in the M-open framework, the analyst does not even entertain the existence of M T and so here again, it does not make sense to assign prior probabilities. The range of models M k is enumerated for comparison purposes but not with reference to the existence of a true model per se. The distinction among these modeling frameworks is quite important, and indeed, recent work by Clyde and Iversen (2015) have used a decision-theoretic framework that allows BMA within the M-open framework. Future research should be directed toward examining Clyde and Iversen's framework for BMA in the context of large-scale educational survey research."}, {"section_title": "Practical Limitations of Bayesian Model Averaging", "text": "Bayesian model averaging is not without a set of limitations that must be considered if it is to be employed in practical applications. First, BMA is sensitive to problems of collinearity. Following Draper's (1999) commentary on Hoeting et al. (1999) , a problem with the indifference prior suggested by Hoeting et al. (1999) arises when two models are essentially identical in terms of their predictions. This can occur in models with nearly collinear sets of variables. In this case, as Hoeting et al. point out, assuming an indifference prior across the models results in placing twice as much weight on a single model, of which there are two slightly different versions. Draper (1999) shows this issue with the following example. Consider a model M 1 of some outcome variable y and predictors x 1 , x 2 , and a predictor x 3 which is collinear with x 2 . Then, being forced to ignore x 3 , a researcher using an indifference prior on the model space would weight each model by 1/4-namely, M 1 \u00bc {no predictors, x 1 , x 2 , (x 1 , x 2 )}. However, if another researcher includes x 3 , this would lead to weights 1/8 for each model M 2 \u00bc {no predictors, x 1 , x 2 , x 3 , (x 1 , x 2 ), (x 1 , x 3 ), (x 2 , x 3 ), (x 1 , x 2 , x 3 )}. The problem is that the last two models in M 2 will fail to be estimated because of the collinear variable x 3 , and this variable will have to be dropped. This will lead to a third model M 3 with weights 1/6-namely, M 3 \u00bc {no predictors, x 1 , x 2 , x 3 , (x 1 , x 2 ), (x 1 , x 3 }, which will then result in putting weights f1=6; 1=6; 1=3; 1=3g on M 1 . As a result of this issue, some thought needs to be given regarding the use of collinear variables in BMA with respect to model weights. Although to our knowledge, the issue of collinearity has not been studied directly within BMA, it seems that an initial examination of collinearity diagnostics (e.g., Belsley, Kuh, & Welsch, 2005) prior to employing BMA is warranted.\nA second practical issue with BMA is the inclusion of interaction terms. It was noted earlier that the case studies used in this article did not employ interaction terms, although interaction terms can be used in BMA. Specifically, the problem with interaction terms in BMA, as pointed out by Montgomery and Nyhan (2010) and Raftery, Hoeting, Volinsky, Painter, and Yeung (2015) , is that averaging over interaction terms is problematic if a model is included in which one of the main effects involved in the interaction is dropped. This assumes that the main effect was 0, and if this assumption is false, then the interaction term will be incorrectly estimated. In the case where models are enumerated within BMA for theoretical purposes (as opposed to simply traversing the space of possible models), then Montgomery and Nyhan (2010) advocate averaging over the subset of models that include the main effects and interactions because this will lead to posterior distributions that are theoretically consistent and correctly estimated. In addition, Clyde (2003) pointed out that when models contain interaction terms, specifying independent priors across the model space may not be appropriate."}, {"section_title": "Non-Bayesian Approaches to Model Averaging", "text": "It should be noted that issues of model averaging and predictive performance are not restricted to the domain of Bayesian statistics. A considerable amount of theoretical and practical work has focused on frequentist approaches and data mining approaches to model averaging and predictive performance (see, e.g., Hjort & Claeskens, 2003; Strobl, 2013; Strobl, Malley, & Tutz, 2009; H. Wang, Zhang, & Zou, 2009) . One approach to frequentist model averaging that bears a strong resemblance to BMA is based on the use of Akaike weights. Akaike weights have been discussed in Wagenmakers and Farrell (2004) and H. Wang, Zhang, and Zou (2009) . In essence, Akaike (1973 Akaike ( , 1985 weights are transformations of the Akaike information criterion (AIC), such that they can be interpreted as conditional probabilities for each model under consideration. Akaike weights have the advantage of allowing a more nuanced choice among models when the difference between an AIC value for one model versus the AIC for the best model (lowest AIC) is small. A clear difference between the use of Akaike weights and BMA is the absence of priors on the model space or parameter space in the frequentist case.\nNevertheless, it is crucial that future research provides detailed comparisons of these methods in terms of predictive performance."}, {"section_title": "Implications for Large-Scale Assessment Design", "text": "The subject-matter motivation for this article concerned using BMA for prediction with large-scale educational assessments. Although our examples in this article and elsewhere (Chen & Kaplan, 2015; Kaplan & Chen, 2012 , 2014 demonstrate the potential of using BMA for educational policy analysis, additional research and development are required before BMA can be fully implemented for building predictive models with large-scale educational assessments. Specifically, an important feature of large-scale assessments such as TIMSS, PISA, or ECLS concerns the complexities of the sampling design. For example, following Kaplan and Kuger (2016) , the nature of the sampling design for PISA ensures that the sample of students for a given country is chosen in such a way as to accurately represent the national population of 15-year-olds for that country. However, within countries, the selection probabilities to attain national representativeness might be different and so survey weights along with Bayesian hierarchical modeling need to be employed to ensure that each sampled student represents the appropriate number of students in the PISA-eligible population within a particular country. If the goal is to develop optimal predictive models in the context of education policy using large-scale assessment data, it is crucial that the nuances of the survey design be addressed. Because model averaging is, by definition and practice, a model-based methodology, future research will require focusing on model-based rather than designed-based inference (see, e.g., Little, 2004) .\nIn addition to addressing the complex sampling design of large-scale educational assessments, it is necessary to address the design and implementation of the assessment instruments themselves. This is particularly important when the goal is to develop optimally predictive models for achievement outcomes because the implementation of the achievement tests in assessments such as PISA and TIMSS uses so-called matrix sampling designs. Matrix sampling designs yield \"designed missing data\" insofar as no student receives all of the test items. To obtain broad content coverage, a student will receive a subset of items not all of which are in common with the subset of items received by another student. As a result, precision is sacrificed for content coverage and individual scores cannot be reported. Instead of providing a single score for each student, a set of plausible values for each student are provided that represent the set of plausible scores from a distribution of scores derived from a so-called conditioning model (see von Davier, 2013) . It is essential that these scores are analyzed correctly in terms of obtaining point estimates and standard errors, and rules have been developed by Rubin (1987) to properly analyze plausible values. For Bayesian model averaging to be correctly utilized in large-scale educational assessments, the methodology must be extended to handle plausible value methodology."}, {"section_title": "Conclusion", "text": "The typical practice of statistical modeling for educational research and policy analysis has been to specify, estimate, and test a specific model of interest; examining the fit of the model to the data; and examining the statistical significance of parameters of interest. The development of predictive statistical models in the domain of education research has, arguably, received somewhat less attention. The question of using a model for some purpose beyond assessing model fit leads to a consideration of the accuracy of a model's predictions and this focus on predictive accuracy is a central feature of Bayesian statistics-arguably more central than the traditional ideas of goodness of fit. Indeed, the BF, BIC, and the DIC focus our attention on choosing models based on considering posterior predictive accuracy. If the goal of model building is one of predictive accuracy, then attachment to one's specific model is of less importance. Thus, we are less concerned about the fit of a theoretical model and more concerned about finding a model that will predict well.\nIn the Bayesian framework, Bayesian model averaging is known to yield models that perform better than any given submodel on the criteria of predictive accuracy. This is due to the fact that not all models are equally good as measured by their PMPs-yet all models contain some useful information. By combining models while at the same time accounting for model uncertainty, we obtain a \"stronger\" model in terms of predictive accuracy.\nTo conclude, the purpose of this article was to demonstrate a well-known and useful approach to model averaging in the Bayesian domain with the goal of improving the predictive accuracy of common statistical models. We concur with the famous quote by Box and Draper (1987) , \"All models are wrong, but some are useful\" (p. 424), but we add that even though models capture only a small portion of the data generating process, each model retains a degree of useful information. In particular, beyond capturing the data generating process, a model's usefulness lies in its predictive capacity. Here, then, Bayesian model averaging provides an approach to optimizing the predictive utility of a large number of otherwise wrong models. Nevertheless, for this didactic article, we show that the theory of Bayesian model averaging works as expected, yielding models with better predictive performance than any given submodel including the initial model of interest. As always, the full benefit Bayesian model averaging will rest on its application to practical problems where prediction is of high priority."}, {"section_title": "Declaration of Conflicting Interests", "text": "The author(s) declared no potential conflicts of interest with respect to the research, authorship, and/or publication of this article."}, {"section_title": "Funding", "text": "The author(s) received no financial support for the research, authorship, and/or publication of this article."}, {"section_title": "ORCID iD", "text": ""}, {"section_title": "Chansoon Lee", "text": "http://orcid.org/0000-0002-3669-3019 Notes 1. The Laplace method of integrals is based on a Taylor expansion of a function f \u00f0u\u00de of a q-dimensional vector u. The approximation is Z e f \u00f0u\u00de du ' 2\u00f0p\u00de q=2 jAj 1=2 expff \u00f0u \u00c3 \u00deg, where u \u00c3 is the value of u at which f attains its maximum, and A is minus the inverse of the Hessian of f evaluated at u \u00c3 . Following Raftery (1996, p. 253) , when the Laplace method is applied to Equation 3, we obtain the approximation p\u00f0yjM k \u00de ' \u00f02p\u00de qk jA k j 1=2 p\u00f0yjq k ; M k \u00dep\u00f0q k ; M k \u00de, where q k is the dimension of q k , q k is the posterior model of q k , and A k is minus the inverse of the Hessian of logfp\u00f0yjq k ; M k \u00dep\u00f0q k jM k \u00deg, evaluated at the posterior modeq k . 2. The notion of \"best subset regression\" is controversial in the frequentist framework because of concern over capitalization on chance. However, in the Bayesian framework with its focus on predictive accuracy, finding the best subset of predictors does not present a problem. 3. Note that it is not technically proper to use only one plausible value in a statistical analysis. A direction of future research will require developing Bayesian model averaging when analyzing multiple plausible values. 4. Note that in the case where there is only one element in the block, the prior distribution is assumed to be inverse-gamma, that is, \u03b8 IW *IG\u00f0a; b\u00de."}]
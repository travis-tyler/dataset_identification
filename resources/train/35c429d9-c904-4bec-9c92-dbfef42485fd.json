[{"section_title": "", "text": "brain function analysis. Image segmentation involves partitioning an image into non-overlapped regions, which are homogeneous in regard to specific criterions, such as tissue texture or intensity level. If the image is indicated as 'I', the segmentation problem consists in estimating a set \u2208 that can be used to build an image 'I' satisfying the condition:\nClassification is a particular case of segmentation where the restriction for spatial connectivity for all points belonging to a given n is removed. The resulting sets in this case are called classes. The classification accuracy is highly influenced by the class number estimation, which may be very complicated. A reproducible classes labeling may also be a hard task without previous knowledge about the images.\nNumerous algorithms with different degrees of success have been proposed to classify brain tissues into gray matter (GM), white matter (WM) and cerebrospinal fluid (CSF). This includes atlas-free techniques or methods relying on the use of an atlas. A couple of existing principal approaches are based on histogram threshold determination (Suzuki and Toriwaki 1991) , cluster analysis (Simmons et al 1994) , a prior information about anatomy (Joliot and Mazoyer 1993) , Bayesian classification (e.g. Markov Random field model) (Chang et al 1996) and deep learning-based approaches (Moeskops et al 2016 , Dolz et al 2017 , Chen et al 2018 , Wachinger et al 2018 . An overview of brain MRI classification algorithms can be found in recent reviews on the topic (Clarke et al 1995 , Cabezas et al 2011 , Selvaraj and Dhanasekaran 2013 , Gonzalez-Villa et al 2016 , Helms 2016 . Some of these techniques produce good results but fail in some regions where the contrast is low, such as medial temporal lobe region and cerebellum where the arbor vitae (WM) and GM interfaces are difficult to classify.\nCurrently, different software packages are available to the neuroimaging community. These tools commonly contain a set of preprocessing steps, such as skull stripping, data denoising and bias field correction, in addition to performing automated brain tissues classification. Among them, the statistical parametric mapping (SPM) toolbox (Ashburner et al 1995) developed by the Wellcome Trust Centre for Neuroimaging, University College London (UK), FMRIB's Software Library (FSL) software package (Smith et al 2004 , Woolrich et al 2009 , Jenkinson et al 2012 developed by the Analysis Group at Oxford Centre for functional MRI of the brain (FMRIB) and the K-means clustering algorithm (Spath 1985 , David and Vassilvitskii 2007 , Seber 2008 are the most widely used. Most of the proposed methods usually take as input one channel gray scale data, which may limit features that we can use to classify image pixels and may be inadequate to maintain fine description compared to other color spaces.\nIn this work, we introduce a novel method combining pseudo-multispectral color transformation, a set of preprocessing techniques for contrast enhancement and an iterative and optimized K-means clustering to improve brain tissue classification even in the presence of low signal to noise ratio (SNR) and high partial volume effect. The performance of the proposed algorithm using both simulated and in vivo human studies with frequently used evaluation metrics was assessed. A detailed comparison with SPM, FSL and K-means algorithms was also performed."}, {"section_title": "Theory", "text": ""}, {"section_title": "Multispectral color transformation", "text": "Color models or color spaces indicate the colors in a benchmark way by using a coordinate system and a subspace in which each color is represented by a single voxel of the coordinate system. Gray and binary color spaces are commonly used by image processing methods (Gonzalez et al 2004 , Cui et al 2005 . The contrast between brain tissues in some regions is, however, very low, e.g. cerebellum (WM and GM interfaces). Consequently, well-known techniques almost fail and wrong classifications might occur. Furthermore, additional filtering may smooth the data and lead to spatial resolution loss. To address this issue, we considered appropriately enhancing the amount of information passed to the classifier. To this end, the first step consists in transforming the T1-weighted MPRAGE images to multispectral data containing three different images (channels), rather than classifying using single image information (e.g. gray scale image). In other words, each voxel in the initial image was represented in three different coordinate spaces. Firstly, the gray scale image was converted to an RGB color image, which employed the RGB color space consisting of three bands: red, green and blue. Consequently, each pixel will be represented by an n-valued vector instead of one, where n is the number of bands, for instance, a three-value vector [r,g,b] in case of color images. Secondly, the RGB images are converted to CIE XYZ space and then to CIE LAB space by applying a number of mathematical operations described in Rhyne (2016) . These routines convert images back and forth from RGB to CIE LAB color spaces by rescaling the image color spaces. These numerical functions implemented in C (Insight Segmentation and Registration Toolkit ITK) or in Matlab code (MathWorks Inc., Natick, MA) are available as open source software. We should keep in mind that the transformation between the two spaces is not unique. The resulting CIE LAB may be scaled differently if a slightly different coefficients or transformation parameters are used during processing. Therefore, we strongly recommend the use of the implemented default conversion parameters. The International Commission on Illumination (CIE) color spaces were the first well defined mathematical quantitative connections between wavelength distributions in the electromagnetic visible spectrum, and physiologically perceived colors in the human color vision (S\u00e8ve 1996) . The CIE LAB color space (also known as CIE L * a * b* or sometimes abbreviated simply as 'Lab' color space) is a color-space introduced in 1976 by the CIE, considered as an enhanced version of CIE XYZ tristimuls color space. For more detailed description, we refer interested readers to (Lindsey and Wee 2007) . It describes color in three numerical values, 'L' for brightness and 'a*b*' for green-red and blue-color components. The L*a*b term may also express the difference in color compared to that of a gray surface of the same clarity. Figure 1 illustrates the pseudo-multispectral color transformation scheme. In RGB images, each separated color plane contains some saturated pixels that represent the highest concentration of pure red, green or blue values. As the color becomes mixed with other colors, low intensity pixels appear. We should keep in mind that color space transformation only transforms image color spaces and no tissue classifications is yet performed."}, {"section_title": "Root and square function (RSF) approach", "text": "Poor image quality may challenge the classification process. Therefore, image enhancement remains a necessary step prior to data classification and segmentation. These improvements include correcting the data for unwanted noise, skull stripping and contrast enhancement. This can be achieved using a number of denoising approaches, such as the use of conventional to more advanced filters, nonlinear filtering approaches (Cui et al 2005) , anisotropic nonlinear diffusion filtering (Weickert et al 1998) , wavelet denoising and Markov random field modeling (Xie et al 2002) and more recently hybrid spatial-frequency domain filtering (Arabi and Zaidi 2018) . Denoising the images without a priori knowledge of the noise distribution may, however, compromise image quality by smoothing the edge interface between gray and WM regions, thereby leading to contrast losses between fine structures, which, in turn, can present major challenges for accurate classification and segmentation of these regions (Mohan et al 2014) .\nContrast enhancement methods are divided into two main approaches: direct and indirect Woods 2002, Russ 2011) . In direct approaches, the image contrast is displayed then enhanced by means of some transformation functions, such as the dynamic range of the display device (Gonzalez and Woods 2002) . Conversely, indirect methods involve performing contrast stretching using linear and nonlinear functions (Xu et al 2010, Jafar and Darabkh 2011) , histogram equalization and specification (Iqbal et al 2007) and gray level grouping (Chen et al 2006) . Overall, contrast enhancement has advantages and drawbacks. It may improve global image quality, however, it usually fails to enhance local details or can lead to noise amplification (Mohan et al 2014) .\nTo overcome these problems, we propose a new real time approach to enhance the image contrast especially in WM, GM and CSF interfaces entitled RSF. The RSF is based on the following principle:\n(1) where x n is the intensity of the nth voxel and \u03b1 is a real positive number (\u03b1 > 1). The principle tells us that the distance between two neighboring intensities is smaller than the distance between their intensities to the \u03b1 power. Thus, the image contrast enhancement may be performed by applying RSF on the MR image as described below:\nwhere IM RSF is the enhanced image, x n is the intensity of the nth MR image voxel, \u03b2 is a positive integer number. In this study, \u03b2 is iteratively computed to achieve the best WM, GM and CSF distribution separation. The RSF was applied on CIE LAB channels, which enhances the interfaces sharpness between the three brain tissues, especially in regions with low SNR without noise amplification."}, {"section_title": "Data clustering", "text": "Before clustering, the brain tissue was extracted out of the structural image using the brain extraction tool (BET) (Smith 2002) . As first clustering, an iterative and non-deterministic K-means clustering was applied for image classification. Initially, the number of brain tissue classes was randomly chosen and set to be maximal (>5 classes). The K-means clustering algorithm clusters the enhanced three channel CIE LAB data around centroids computed as the mean value of clustered points so as to minimize the within-cluster sum of squares as follows:\nwhere \u00b5 i is the mean of data points x within S j partitions, k is the number of clusters and N is the enhanced 3D channel images (N is one of the three channels in CIE LAB color space). After assigning each data point x to the nearest cluster using the Euclidian distance measure, the algorithm computes its membership function \u03c8(C j | x) in each cluster S j . This function defines the proportion of x that belongs to the j th cluster C j . For a minimal distance between the centroids and the data points, \u03c8(C j | x) = 1, otherwise the function is null. K-means computes the cluster centroids again and updates the \u00b5 j :\nwhere n denotes the number of image voxels. The algorithm repeats the classification with decreasing k until the cluster labels of the image do not change anymore. As K-means is inherently a non-deterministic algorithm, the final cluster labels assigned to WM, GM and CSF may change after classifying the same data several times. To make the algorithm converge, a second clustering is performed using only one iteration with the previously computed cluster centroids \u00b5 j as initial parameter. To evaluate our clustering, an error measurement is plotted versus different proposed number of clusters k and the plot elbow was then located. Elbow happens at the most extreme diminution in error measurement. The gap criterion formalizes this approach by estimating the elbow location as the number of clusters with the largest gap value. Whereof, the optimal number of clusters occurs at the solution with the largest local or global gap value within a tolerance range (Tibshirani et al 2011) . The gap criterion is defined as:\nwhere n is the sample size, k is the cluster number and W k is the pooled within-cluster dispersion measurement computed as follow:\nwhere n is the number of data points in cluster k, and D i is the sum of the pairwise Euclidian distances for all points in cluster k. The expected value E * n {log (W k )} was determined by Monte Carlo sampling from a reference distribution, and log(W k ) was computed from the sample data. The optimal number of clusters was evaluated and reached based on the gap criterion and the corresponding centroids distribution. The centroid distribution was modeled beforehand using a set of 20 human brain data. Each brain tissue class (GM, WM and CSF) belongs to a specific distribution template. Once the optimal k was defined, the previously estimated brain tissue classes that were set randomly earlier are reassigned, and adjusted to the new optimal classes. As input, the algorithm takes a T1-weighted MPRAGE image and provides as output a label map of GM, WM and CSF."}, {"section_title": "Materials and methods", "text": ""}, {"section_title": "Simulated and in vivo human MRI studies", "text": "The algorithms described in this work are evaluated using both simulated and real MR images."}, {"section_title": "Simulated brain MR images", "text": "We used numerical 3D-T1 MR images (197 \u00d7 233 \u00d7 189 voxels of 1 mm 3 isotropic resolution) with their corresponding numerical brain atlas templates, where the volumes of the GM, WM and CSF are known beforehand (ground truth). The numerical atlas templates were obtained from the Pediatric MRI Data Repository created by the NIH MRI Study of Normal Brain Development. The data are corrupted with Gaussian noise, resulting in Rician-distributed image data, to allow the evaluation of classification algorithms under circumstances of different SNRs. The introduced noise increases the shape complexity, especially near the WM, GM and CSF interfaces, which degrades the contrast between the different brain tissues."}, {"section_title": "In vivo human brain MR images", "text": "The second dataset used in this work consists of 3D in vivo human MR brain data from 20 normal subjects provided by the open access series of imaging studies (OASIS) project. This is an initiative aiming at making brain MRI data sets freely available to the neuroimaging community (Marcus et al 2007) . T1-weighted MPRAGE data with the following parameters: flip/TE/TR/TI = 10/4/9.7/20ms and in plane resolution of 1mm 2 , with slice thickness of 1.25 mm and image size of 256 \u00d7 256 \u00d7 128 were used to assess the accuracy of the proposed algorithm as compared to other classification approaches."}, {"section_title": "Comparison with other classification methods", "text": "The proposed approach was compared to three other algorithms belonging to different categories of brain MRI classification techniques, namely FSL (FMRIB, Oxford, UK), SPM8 and K-means clustering, all implemented in Matlab (MathWorks Inc., Natick, MA)."}, {"section_title": "SPM8", "text": "SPM is an academic software toolkit designed for the analysis of brain imaging data sequences, implemented in MatLab. Brain tissues classification from MRI is performed from the intensity distribution of the image and prior information for the respective tissue classes (Ashburner and Friston 2000) . Bayesian rules are used to assign the probability to each voxel belonging to each tissue class based on the combination of the likelihood of belonging to that class and prior probability maps. Creation of tissue probability maps is performed in the International Consortium for Brain Mapping/Montreal Neurological Institute (ICBM/MNI) space (Mazziotta et al 1995) , the maps are derived from a large number of subjects. The registration of MR images to be classified with tissue probability maps is also performed to create probability distribution of each tissue class. Thus, SPM classification is probabilistic in the way a probability of belonging to each tissue type is assigned to each voxel. All classifications are performed using SPM version 8. The tool provides as output a WM, GM and CSF probability maps with voxel values between 0 and 1. Each voxel is counted as member of the particular tissue type for which it exhibits the highest probability.\nAn update of SPM8 (SPM12) is available since few years bringing a number of improvements to the software package. Both implementations are based on the same algorithm (Ashburner and Friston 2005) , though the newer version makes use of additional tissue classes enabling multi-channel segmentation. Additional MRI scans originating from the OASIS project (Marcus et al 2007) are added to the maximum probability tissue labels library that SPM relies upon for performing the segmentation task. Since OASIS data were also used in our study for the comparative evaluation of the different classification methods, the use of SPM8 was not considered in our comparison assessment."}, {"section_title": "FSL 5.0", "text": "FSL was developed by the Oxford Centre for functional MRI of the brain at Oxford University (FMRIB) and is composed of a series of independent tools that can be used separately or together. FSL is one of the most extensively used libraries in neuroimaging data analysis (Smith et al 2004) . FSL includes a tool called FAST (FMRIB's Automated Segmentation Tool) that performs brain tissue classification. Skull stripped images using BET are provided as input data. FAST segmentation is based on a hidden Markov random field model and an expectation-maximization algorithm (Zhang et al 2001) . In this work, the default settings for FAST classification were adopted to derive three tissue probability maps for WM, GM and CSF."}, {"section_title": "K-means algorithm", "text": "K-means clustering is a popular method used to divide n data points into k clusters. The result is a set of k centers located at the centroid of the partitioned data points. In this work, we used the K-means algorithm described in (Spath 1985 , Seber 2008 . A skull stripped T1-weighted MPAREG image using BET is provided as input data. Initial K classes set to be equal to 3 and 20 iterations are performed to reach algorithm convergence. The classification with K-means results in three binary images corresponding to WM, GM and CSF distributions. Figure 2 illustrates the PMC algorithm pipeline."}, {"section_title": "Evaluation metrics", "text": "Evaluation of the proposed classification method was performed using a couple of evaluation metrics and methods, also used to compare the technique to prior methods. To assess the qualitative and quantitative performance of all mentioned algorithms, we performed an objective, empirical and supervised classification comparison (Zhang et al 2008) . Thereby, we selected some of the widely used metrics by the MRI community involving comparison to ground truth reference images. For simulation studies, the ground truth images are numerical brain atlas templates, where the volumes of WM, GM and CSF are known beforehand. The ground truth of in vivo human MR images was obtained using the simultaneous truth and performance level estimation (STAPLE) algorithm (Warfield et al 2004) . The latter considers a collection of classifications and performs a probabilistic estimate of the hidden true classification (ground truth) and a measure of the performance level achieved by each algorithm. All classifiers' results are given to STAPLE as input for the ground truth estimation. In the following derivation, the classification result was indicated as R and ground truth as G."}, {"section_title": "Spatial overlap", "text": "The Jaccard index (JI), also known as the Jaccard similarity coefficient is a metric used for comparing the similarity and diversity of sample sets (Tan et al 2006) . Measuring the Jaccard similarity coefficient between two data sets was calculated by dividing the number of features that are common to all by the total number of features across the two datasets (Halkidi et al 2001 , Niwattanakul et al 2013 :\nwhere TP is true positive, FP is false positive and FN is false negative proportion. The JI ranges between 0 indicating no spatial agreement and 1 for a perfect spatial overlap."}, {"section_title": "Normalized volume comparison", "text": "Volumetric measures of cerebral region volumes are more and more used for diagnostic purposes and classification method comparisons. Variations in individual head dimension may be corrected by normalization with utilization of total intracranial volume (TIV) measurement. The TIV was used to correct for voxel size fluctuations for cross-sectional or longitudinal studies. It has been shown that normalization of structure volumes with TIV reduces inter-individual variation (Whitwell et al 2001) . Thus, regional brain WM, GM and CSF volumes are more comparable when normalized for TIV."}, {"section_title": "Accuracy", "text": "The accuracy is a different representation of the relative difference brought to 100%. The percentage accuracy was calculated as the mean over all image voxels using the normalized volumes as follows:\nThe best performance is achieved at 100%. Alternatively, the computed volume is either overestimated or underestimated."}, {"section_title": "Results and discussion", "text": "PMC takes as input a T1-weighted MPRAGE images and provide as output three binary images corresponding to brain WM, GM and CSF spatial distributions. As shown in figure 1 , the T1-weighted MPRAGE image was converted into three bands RGB images and then into CIE LAB space. The classification procedure is highly influenced by the choice of MR image color space. In general, RGB color space gives a high degree of detail, but it is not consistent with normal human perception. Therefore, the RGB space was converted to CIE XYZ and then into CIE LAB color space by applying a pseudo-color transformation matrix. The intention of CIE LAB color space is to create a space that can be derived via simple formulas from the RGB or XYZ spaces but is more perceptually uniform. More perceptually uniform than other spaces means that a change of the same amount of color should produce a change of about the same visual importance. Consequently, a small change in contrast between GM and WM especially in region with low contrast appears important and detectable. Figure 3 illustrates the RSF impact on enhancing the image contrast. The upper raw shows an original T1-weighted MPRAGE coronal slice converted to a CIE LAB space and enhanced using RSF; the lower raw shows the corresponding histograms before and after applying RSF. One can notice that CIE LAB transformation increases the amount of pixels belonging to GM and WM classes. The distance between the two intensity histograms remains, however, the same while the CSF distribution remains unchanged. Applying RSF on the CIE LAB channels increases the distance between all distributions which equally separates the three tissue histograms. RSF enhancement makes low contrast regions (e.g. cerebellum) appear sharper by increasing signal intensity gaps near tissue interfaces. Because RSF does not act as a spatial or frequency filter, the contrast is enhanced without modifying or losing any structural information. The performance of the four classification techniques was evaluated both qualitatively and quantitatively using simulated and in vivo human MR images."}, {"section_title": "Simulation study", "text": "As mentioned earlier, the simulated data were corrupted with Gaussian noise to allow all algorithms evaluation under the circumstance of different SNRs. Figure 4 depicts simulated data with high and low SNR and the corresponding classification maps using the four mentioned algorithms.\nPMC performance may be considered as the result of the algorithm's capability to reliably estimate the real tissues spatial distribution. After increasing data dimensionality by converting each voxel into three different spectral spaces and enhancing the contrast by applying RSF; the classifier computes the intensity distribution and then initializes the centroids with random k values. The procedure was repeated until the cluster labels do not change anymore. Then data points are clustered based on the distance of their intensities from the centroids. The algorithm repeats the classification with the previously computed centroids as initial parameters to converge the cluster labeling. Once the classification converges, the optimal cluster number was computed based on silhouette plot and gap criterion. The algorithm then reclusters the data by grouping all points with the nearest centroids. The iterative version of the algorithm allowed fast and robust tissue classification. The accuracy of all methods computed using equation (8) as a function of image SNR is presented in figure 5 . A Gaussian noise was added to achieve a SNR of 10%, 20%, 30%, 40%, 50%, 60% and 70%. The PMC technique yields a better WM, GM and CSF classification for all image SNRs. In the second position, SPM provides good tissues classification accuracy with a small WM overestimation (+10%) and small GM underestimation (\u221210%) with increasing SNR. K-means performs slightly better than FSL in classifying the three brain tissues. Figure 6 shows a boxplot of brain tissue volumes compared to the original atlas template volumes (Orig). All volumes were normalized to the TIV. Brain WM volumes are accurately recovered when classifying with PMC and SPM (\u00b12%). For both GM and CSF, PMC provides a better results than the other methods in recovering the original volume within a volume precision of \u00b11%. K-means and FSL perform similarly, with an evident wide variation around the mean and median value for K-means. Figure 7 shows the JI as a function of image SNR levels. The JI represents the spatial overlap measurement between the segmented volumes and the binary templates. This measure is complementary to accuracy or volume metrics providing information about the spatial distribution correctness of the classified tissues. In the presence of low SNR (<20), the best WM spatial distribution was achieved using PMC. With increasing SNR, PMC still outperforms all techniques (JI = 0.9) followed by SPM, K-means and FSL, respectively. For the GM, all methods provide similarly a good overlap with a small superiority for PMC at low SNR levels and for SPM and FSL at high SNR levels. The best JI for CSF was achieved using K-means (JI = 0.7) followed by FSL, PMC and SPM. Accurate CSF classification remains difficult to achieve. Noteworthy, most research has instead focused on GM and WM classification. This is probably due to the minor importance of CSF for surgical planning and activation studies (Zaidi et al 2006) . In the presented results, despite middling JI, which reflects a mediocre spatial overlap, PMC yielded a high accuracy in volume estimation (\u00b11%) compared to other methods. In summary, the results of the simulation studies seem to suggest that the PMC algorithm outperforms in most cases SPM, FSL and K-means algorithms in classifying brain tissue into WM, GM and CSF, especially in the presence of high noise levels (table 1). PMC robustness against noise variation may be due to the combination of contrast enhancement achieved by RSF and color transformation and the prior centroids distribution map for each class label that help to attribute noisy voxels to the right brain class. The combination of these enhancement parameters acts like a prior atlas spatial distribution that SPM and FSL rely upon, but appears more robust in attributing noisy and corrupted voxels to the correct tissue class."}, {"section_title": "In vivo human studies", "text": "As described earlier, we applied the mentioned methods to segment 20 normal subjects provided by OASIS (Marcus et al 2007) . The images were preprocessed to remove non-brain tissues (skull stripping) and a binary mask was provided with the data. PMC, FSL and K-means used the same skull stripped MPRAGE images. Skull (a) Simulated noise free brain data with and corresponding classifications using the four algorithms. (b) Simulated brain data with SNR = 10 and corresponding classifications using the four algorithms. At low SNR (SNR = 10), one can observe that the resulting templates are significantly corrupted. Owing to the high noise content, tissue misclassifications may occur. PMC shows a significant superiority over the three other methods in preserving an accurate WM, GM and CSF estimation (black arrows). Kmeans and FSL result in WM overestimation whereas SPM overestimates the GM. SPM ability to accurately remove the skull in the presence of high noise level remains the most efficient compared to BET (orange arrows) which may need an additional parameters adjustment. In the presence of good SNR (SNR = 20) or noise free data, the four methods mostly achieve a good classification. FSL and K-means tend to overestimate the WM especially in the cerebellum region (arbor vitae) whereas PMC and SPM show a similar visual accuracy. (c) Simulated brain data with SNR = 20 and corresponding classifications using the four algorithms. Phys. Med. Biol. 64 (2019) 145005 (16pp) stripping in SPM can be performed by segmenting the anatomical image, and using a thresholded version of the sum of grey and WM probability maps to mask out the non-intracranial tissue (Boesen et al 2004) . Figure 8 shows classified WM from MPRAGE brain MRI using the four mentioned algorithms. One can notice that all classification approaches provide different results especially in regions suffering from low contrast, e.g. interfaces between cerebellum GM and WM (see arrows). Based on visual comparison, PMC and K-means performed the closest classifications to the original one. The cerebellum arbor vitae (WM) appears well recovered when using PMC and K-means compared to FSL and SPM. Figure 9 illustrates the same results for GM classification. The best performance was achieved by the utilization of PMC, where the separation gap between the cerebellum and the occipital lobe was well delineated (see arrows). SPM and FSL provided sensitively the same classification but failed in recovering the mentioned gap. K-means tends to highly overestimate the whole brain GM. Figure 10 demonstrates the same trend for CSF classification. PMC and FSL exhibited the best CSF classification. SPM overestimated CSF volume especially near the exterior surface of the brain. K-means totally failed and showed the worst classification scenario. As mentioned earlier, reference MRI data were required to further extend our validation through quantitative analysis and compare empirical and supervised classification using in vivo human MR images (Zhang et al 2008) . The ground truth MRI classification was obtained using the STAPLE algorithm (Warfield et al 2004) . The STAPLE approach uses a set of classified images to calculate the probability of the true one, and computes the performance of each classifier using an expectation-maximization algorithm. Figures 11 and 12 show accuracy and JI computed for all classification techniques, respectively. The quantitative results confirm the visual aspects observed on simulation studies (figures 8-10). Brain WM classification was accurately yielded by PMC and K-means. Conversely, the latter was underestimated using FSL and SPM. GM was exclusively well classified by PMC in term of accuracy and spatial overlap (accuracy ~100%, JI \u223c 0.95). The best brain CSF classification was achieved by PMC and FSL. K-means tends to extremely underestimate CSF volume, when SPM overestimates it.\nFigures 13-15 depict representative slices of classified WM, GM and CSF tissues from T1-weighted MPRAGE image when using the four segmentation algorithms compared to the ground truth STAPLE templates. One can notice that considerable tissues classification enhancement was achieved using PMC compared to the other methods. A small residual difference appears near the ventricle but remains negligible. FSL and SPM show similar results in classifying WM and GM with a slight superiority for FSL near corpus callosum and medulla regions. Similar observations are also made for CSF classification between FSL and SPM, with a small superiority for FSL at the very edge of the brain.\nAs reported in previous studies (Boesen et al 2004 , Zaidi et al 2006 , skull-striping may influence classification accuracy. Consequently, CSF misclassification by SPM near external brain edges may be counted as the result of SPM ability to overestimate the intracranial volume by including some dura mater and cranium when removing the skull. SPM skull stripping, however, remains more accurate and insensitive to noise compared to FSL skull stripping if BET procedure was set to run under the default settings (Kasiri et al 2010) . We highlight that using the same skull striping process introduces a comparison bias even if the gap between SPM and FSL may be reduced. K-means classification performs worse than the other three algorithms; most of its errors are located along the brain tissue interfaces and brain edges. Overall, even in the presence of higher data complexity, the results of the in vivo MRI studies seem to indicate that the PMC approach achieves a high classification accuracy compared to widely used algorithms, such as FSL and SPM if not often surpasses them (table 2) .\nOverall, PMC was designed to enhance the weaknesses of each algorithm evaluated in this work. K-means was shown to be good for WM classification but fails for CSF and GM, illustrating K-means suitability for homogeneous regions with high intensities classification (e.g. WM). As an enhanced K-means version, PMC delineates the WM with the same accuracy but at the same time improves GM and CSF delineation. Likewise, the GM and WM are miss-classified with both SPM and FSL likely due to the low contrast between both compartments around tissue interfaces (e.g. cerebellum). PMC overrides this issue by combining high contrast multispectral image generation with enhanced K-means classification. Prior studies have provided comparisons of tissue classification algorithms including those implemented in SPM and FSL (Bouix et al 2004 , Huang et al 2006 , Tsang et al 2008 . Tsang et al (2008) evaluated SPM5 and FSL version 4.0 using three different datasets. For both simulation and in vivo human MR images, we obtained sensitively the same performance with a slight superiority for our proposed algorithm. This is probably due to the implementation of more sophisticated and optimized computational methods.\nThe balance between algorithm complexity and performance scores have to be taken into account when evaluating a classification algorithm. Notwithstanding, algorithms requiring large data preprocessing procedures may often be simplified, it is not necessarily true that complex algorithms would always provide better performance (Zaidi et al 2006) . Unjustified additional complexity may make algorithms appear like a black box and thus hard to implement or understand. The PMC approach presented in this work to classify brain tissues was by far the simplest and fastest method compared to FSL or SPM.\nPMC is the outcome of a combination of an enhanced and optimized K-means classifier scheme with a color transformation and contrast enhancement technique to improve the performance of the basic K-means clustering algorithm and at the same time, maintain its fast convergence rate. Thus, with some additional optimizations, it can be used in clinical and research settings. "}, {"section_title": "Conclusion", "text": "A number of algorithms have been proposed for the classification of brain tissues. However, the complexity of the problem leaves an open area for improvement. In this work, we proposed a promising approach to improve previous techniques widely employed by the neuroimaging community. While most algorithms performed quite satisfactorily, PMC classifier was found to be more accurate on average. PMC shows a promising approach suggesting the potential improvement of automatic brain tissue classification by extracting a maximum of image information from a single acquisition using pseudo-multispectral transformations, while attaining improved contrast by applying a set of efficient preprocessing methods and an enhanced fast, iterative and unsupervised K-means clustering. This approach can overcome the low SNR and low contrast, due to partial volume effects, often present in some brain regions, e.g. the cerebellum arbor vitae and near the medial temporal lobe region. In addition, it is well known that the presence of normal appearing white matter lesions (NAWMLs) may influence WM, GM and CSF estimations in non-demented and demented older adults (Kim et al 2008) . In future work, we plan to apply PMC to analyze all available normal aging and Alzheimer's Disease datasets available from OASIS and Alzheimer's disease neuroimaging initiative (ADNI), and utilize it as prior step for NAWM lesion extraction."}]
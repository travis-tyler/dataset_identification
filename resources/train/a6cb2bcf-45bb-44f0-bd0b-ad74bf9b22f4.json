[{"section_title": "Abstract", "text": "Abstract. The analysis of manifold-valued data requires efficient tools from Riemannian geometry to cope with the computational complexity at stake. This complexity arises from the always-increasing dimension of the data, and the absence of closed-form expressions to basic operations such as the Riemannian logarithm. In this paper, we adapt a generic numerical scheme recently introduced for computing parallel transport along geodesics in a Riemannian manifold to finite-dimensional manifolds of diffeomorphisms. We provide a qualitative and quantitative analysis of its behavior on high-dimensional manifolds, and investigate an application with the prediction of brain structures progression."}, {"section_title": "Introduction", "text": "Riemannian geometry is increasingly meeting applications in statistical learning. Indeed, working in flat space amounts to neglecting the underlying geometry of the laws which have produced the considered data. In other words, such a simplifying assumption ignores the intrinsic constraints on the observations. When prior knowledge is available, top-down methods can express invariance properties as group actions or smooth constraints and model the data as points in quotient spaces, as for Kendall shape space. In other situations, manifold learning can be used to find a low-dimensional hypersurface best describing a set of observations.\nOnce the geometry has been modeled, classical statistical approaches for constrained inference or prediction must be adapted to deal with structured data, as it is done in [4, 5, 11, 13] . Being an isometry, the parallel transport arises as a natural tool to compare features defined at different tangent spaces.\nIn a system of coordinates, the parallel transport is defined as the solution to an ordinary differential equation. The integration of this equation requires to compute the Christoffel symbols, which are in general hard to compute -e.g. in the case of the Levi-Civita connection-and whose number is cubic in the dimension. The Schild's ladder [5] , later improved into the Pole ladder [7] when transporting along geodesics, is a more geometrical approach which only requires the computation of Riemannian exponentials and logarithms. When the geodesic equation is autonomous, the scaling and squaring procedure [6] allows to compute exponentials very efficiently. In Lie groups, the Baker-Campbell Haussdorff formula allows fast computations of logarithms with a controlled precision. In such settings, the Schild's ladder is computationnally tractable. However, no theoretical study has studied the numerical approximations or has provided a convergence result. In addition, in the more general case of Riemannian manifolds, the needed logarithm operators are often computationally intractable.\nThe Large Deformation Diffeomorphic Metric Mapping (LDDMM) framework [1] focuses on groups of diffeomorphisms, for shape analysis. Geodesic trajectories can be computed by integrating the Hamiltonian equations, which makes the exponential operator computationally tractable, when the logarithm remains costly and hard to control in its accuracy. In [12] is suggested a numerical scheme which approximates the parallel transport along geodesics using only the Riemannian exponential and the metric. The convergence is proved in [8] .\nIn this paper, we translate this so-called fanning sheme to finite-dimensional manifolds of diffeomorphisms built within the LDDMM framework [2] . We provide a qualitative and quantitative analysis of its behavior, and investigate a high-dimensional application with the prediction of brain structures progression. Section 2 gives the theoretical background and the detailed steps of the algorithm, in the LDDMM context. Section 3 describes the considered application and discusses the obtained results. Section 4 concludes."}, {"section_title": "Theoretical background and practical description", "text": ""}, {"section_title": "Notations and assumptions", "text": "Let M be a finite-dimensional Riemannian manifold with metric g and tangent space norm \u00b7 g . Let \u03b3 : t \u2192 [0, 1] be a geodesic whose coordinates are known at all time. Given t 0 , t \u2208 [0, 1], the parallel transport of a vector w \u2208 T \u03b3(s) M from \u03b3(t 0 ) to \u03b3(t) along \u03b3 will be noted P t0,t (w) \u2208 T \u03b3(t) M. We recall that this mapping is uniquely defined by the integration from u = t 0 to t of the differential equation \u2207\u03b3 (u) P t0,u (w) = 0 with P t0,t0 (w) = w where \u2207 is the LeviCivita covariant derivative.\nWe denote Exp the exponential map, and for h small enough we define J w \u03b3(t) (h), the Jacobi Field emerging from \u03b3(t) in the direction w \u2208 T \u03b3(t) M by:"}, {"section_title": "The key identity", "text": "The following proposition relates the parallel transport to a Jacobi field [12] :\nProposition. For all t > 0 and w \u2208 T \u03b3(0) M, we have:\nProof. Let X(t) be the time-varying vector field corresponding to the parallel transport of w, i.e. such that\u1e8a i + \u0393 i kl X l\u03b3k = 0 with X(0) = w. At t = 0, in normal coordinates the differential equation simplifies into\u1e8a i (0) = 0. Besides, near t = 0 in the same local chart, the Taylor expansion of X(t) writes\nNoticing that the ith normal coordinate of Exp\nis therefore tw i , and we thus obtain the desired result.\nSubdividing [0, 1] into N intervals and iteratively computing the Jacobi fields "}, {"section_title": "The chosen manifold of diffeomorphisms", "text": "The LDDMM-derived construction proposed in [2] provides an effective way to build a finite-dimensional manifold of diffeomorphims acting on the d-dimensional ambient space R d . Time-varying vector fields v t (.) are generated by the convolution of a Gaussian kernel k(x, y) = exp\nThe set of such vector fields forms a Reproducible Kernel Hilbert Space (RKHS).\nThose vector fields are then integrated along \u2202 t \u03c6 t (.) = v t [\u03c6(.)] from \u03c6 0 = Id into a flow of diffeomorphisms. In [10] , the authors showed that the kernelinduced distance between \u03c6 0 and \u03c6 1 -which can be seen as the deformation kinetic energy-is minimal i.e. the obtained flow is geodesic when the control points and momenta satisfy the Hamiltonian equations :\nwhere K c(t) is the kernel matrix. A diffeomorphism is therefore fully parametrized by its initial control points c and momenta \u03b1. Those Hamiltonian equations can be integrated with a Runge-Kutta scheme without computing the Christoffel symbols, thus avoiding the associated curse of dimensionality. The obtained diffeomorphisms then act on shapes embedded in R d , such as images or meshes. For any set of control points c = (c i ) i\u2208{1,..,n} , we define the finite-dimensional\n., n} of the vector fields' RKHS. We fix an initial set c = (c i ) i\u2208{1,..,n} of distinct control points and define the set "}, {"section_title": "Summary of the algorithm", "text": "We are now ready to describe the algorithm on the Riemannian manifold G c ."}, {"section_title": "Algorithm", "text": "(iv) Compute the transported momenta\u03c9 k+1 according to equation (2) :\n(v) Correct this value with \u03c9 k+1 = \u03b2 k+1\u03c9k+1 +\u03b4 k+1 \u03b1 k+1 , where \u03b2 k+1 and \u03b4 k+1 are normalization factors ensuring the conservation of \u03c9 Vc = \u03c9\nAs step of the scheme is illustrated in Figure 1 . The Jacobi field is computed with only four calls to the Hamiltonian equations. This operation scales quadratically with the dimension of the manifold, which makes this algorithm practical in high dimension, unlike Christoffel-symbol-based solutions.\nStep (iv) -solving a linear system of size n cp -is the most expensive one, but remained within reasonable computational time in the investigated examples. Fig. 1: Step of the parallel transport of the vector w (blue arrow) along the geodesic \u03b3 (solid black curve). J w \u03b3 is computed by central finite difference with the perturbed geodesics \u03b3 \u03b5 and \u03b3 \u2212 , integrated with a second-order Runge-Kutta scheme (dotted black arrows). A fan of geodesics is formed.\nIn [8] , the authors prove the convergence of this scheme, and show that the error increases linearly with the size of the step used. The convergence is guaranteed as long as the step (ii) is performed with a method of order at least two. A first order method in step (iii) is also theoretically sufficient to guarantee convergence. Those variations will be studied in Section 3.3.\n3 Application to the prediction of brain structures Exploiting the fanning scheme described in Section 2.4, we can paralleltransport any set of momenta along any given reference geodesic. Figure 2 illustrates the procedure. The target shape is first registered to the reference geodesic : the diffeomorphism that best transforms the chosen reference shape into the target one is estimated with a gradient descent algorithm on the initial control points and momenta [2] . Such a procedure can be applied generically to images or meshes. Once this geodesic is obtained, its initial set of momenta is parallel-transported along the reference geodesic. Taking the Riemannian exponential of the transported vector at each point of the geodesic defines a new trajectory, which we will call exp-parallel to the reference one.\nAs pointed out in [5] , the parallel transport is quite intuitive in the context of shape analysis, for it is an isometry which transposes the evolution of a shape into the geometry of another shape, as illustrated by Figure 3 ."}, {"section_title": "Data and experimental protocol", "text": "Repeated Magnetic Resonance Imaging (MRI) measurements from 71 subjects are extracted from the ADNI database and preprocessed through standard pipelines into affinely co-registered surface meshes of hippocampi, caudates and putamina. The geometries of those brain sub-cortical structures are altered along the Alzheimer's disease course, which all considered subjects finally convert to.\nTwo subjects are successively chosen as references, for they have fully developed the disease within the clinical measurement protocol. As illustrated on Figure 2 , a geodesic regression [3] is first performed on each reference subject to model the observed shape progression. The obtained trajectory on the chosen manifold of diffeomorphisms is then exp-parallelized into a shifted curve, which is hoped to model the progression of the target subject.\nTo account for the variability of the disease dynamics, for each subject two scalar coefficients encoding respectively for the disease onset age and the rate of progression are extracted from longitudinal cognitive evaluations as in [11] . The exp-parallel curve is time-reparametrized accordingly, and finally gives predictions for the brain structures. In the proposed experiment, the registrations and geodesic regressions typically feature around 3000 control points in R 3 , so that the deformation can be seen as an element of a manifold of dimension 9000."}, {"section_title": "Estimating the error associated to a single parallel transport", "text": "To study the error in this high-dimensional setting, we compute the parallel transport for a varying number of discretization steps N , thus obtaining increasingly accurate estimations. We then compute the empirical relative errors, taking the most accurate computation as reference.\nArbitrary reference and target subjects being chosen, Figure 4 gives the results for the proposed algorithm and three variations : without enforcing the conservations at step (v) [WEC], using a Runge-Kutta of order 4 at step (ii) [RK4], and using a single perturbed geodesic to compute J at step (iii) [SPG] . We recover a linear behavior with the length of the step 1 N in all cases. The SPG variant converges much slower, and is excluded from the following considerations.\nFor the other algorithms, the empirical relative error remains below 5% with 15 steps or more, and below 1% with 25 steps or more. The slopes of the asymptotic linear behaviors, estimated with the last 10 experimental measurements, range from 0.10 for the RK4 method to 0.13 for the WEC one. Finally, an iteration takes respectively 4.26, 4.24 and 8.64 seconds for the proposed algorithm, the WEC variant and the RK4 one. Therefore the initially detailed algorithm in section 2.4 seems to achieve the best tradeoff between accuracy and speed in the considered experimental setting. Table 1 gathers the predictive performance of the proposed exp-parallelization method. The performance metric is the Dice coefficient, which ranges from 0 for disjoint structures to 1 for a perfect match. A Mann-Witney test is performed to quantify the significance of the results in comparison to a naive methodology, which keeps constant the baseline structures over time. Considering the very high dimension of the manifold, failing to accurately capture the disease progression trend can quickly translates into unnatural predictions, much worse than the naive approach."}, {"section_title": "Prediction performance", "text": "The proposed paradigm significantly outperforms the naive prediction three years or later from the baseline, thus demonstrating the relevance of the expparallelization concept for disease progression modeling, made computationally tractable thanks to the operational qualities of the fanning scheme for highdimensional applications."}, {"section_title": "Conclusion", "text": "We detailed the fanning scheme for parallel transport on a high-dimensional manifold of diffeomorphisms, in the shape analysis context. Our analysis unveiled the operational qualities and computational efficiency of the scheme in high dimensions, with a empirical relative error below 1% for 25 steps only. We then took advantage of the parallel transport for accurately predicting the progression of brain structures in a personalized way, from previously acquired knowledge."}]
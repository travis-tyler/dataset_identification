[{"section_title": "Abstract", "text": "Abstract. Anatomical changes like brain atrophy or growth are usually not homogeneous in space and across spatial scales, since they map dierently depending on the anatomical structures. Thus, the accurate analysis of volume changes from medical images requires to reliably localize and distinguish the spatial changes occurring at dierent scales, from voxel to regional level. We propose here a framework for the sparse probabilistic scale-space analysis of volume changes encoded by deformations. Our framework is based on the Helmoltz decomposition of vector elds. By scale-space analysis of the scalar pressure map associated to the irrotational component of the deformation, we robustly identify the areas of maximal volume changes, and we dene a consistent sparse decomposition of the irrotational component. We show the eectiveness of our framework in the challenging problem of detecting the progression of tumor growth, and in the group-wise analysis of the longitudinal atrophy in Alzheimer's disease."}, {"section_title": "Introduction", "text": "Modeling the structural changes of organs and tissues is an important goal of medical image analysis. Anatomical changes like brain atrophy or growth are usually not homogeneous in space and across spatial scales, since they dier for dierent anatomical structures. For instance, Alzheimer's disease leads to cortical thinning, which is local and detectable at millimiter scale on the gray matter ribbon, as well as regional or global matter loss, which involves entire anatomical regions like hippocampi or brain ventricles. Thus, the accurate analysis of anatomical changes requires to reliably localize and distinguish the spatial support of changes occurring at dierent scales, from voxel to regional level.\nData used in preparation of this article were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (www.loni.ucla.edu/ADNI). As such, the investigators within the ADNI contributed to the implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. This work was partially funded by the European Research Council (ERC advanced Grant MedYMA)"}, {"section_title": "hal-00845758, version 1 -17 Jul 2013", "text": "Author manuscript, published in \"Medical Image Computing and Computer Aided Intervention (MICCAI) (2013)\"\nScale-space analysis of image data is a classical topic in computer vision, and dierent applications have been proposed in the eld of medical imaging. The main issue when working with medical images concerns the statistical assessment of spatial areas of meaningful signal. For instance, in [10] Gaussian eld theory was used to dene a sparse set of statistically signicant regions of activation across spatial scales in PET images.\nAnatomical changes can be detected by non-linear registration, which models the dierences between pairs of images as dense deformation elds in the image space. Analysis of dense deformation elds is usually challenging due to the high dimensionality of the data. For this reason, methods have been proposed for estimating deformations by considering dierent spatial scales [7] , by enforcing spatial sparsity [1] , or by combining the approaches to provide sparse scale-space registration [8] . Even though these approaches provide a richer description of the deformations, the interpretation of the results is still challenging. In fact, registration does not provide a statistical measure for assessing the signicant locations of the estimated anatomical changes, and might thus lack robustness.\nA dierent approach for the study of deformations consists in analyzing the encoded spatial changes posterior to the registration, for instance by voxel-byvoxel statistical analysis of associated Jacobian determinant. Jacobian analysis is however local, not very robust, and prone to multiple comparison problems.\nHelmoltz decomposition parameterizes a given deformation as the sum of irrotational and divergence-free components [2] . The irrotational component is a dense vector eld which encodes the local volume changes associated to the deformation, and therefore which completely describes the estimated atrophy and growth processes. The irrotational component is the gradient of a scalar apparent pressure map, whose topological analysis enables the identication of areas of local volume changes. This idea was used in [4] to localize the areas of relevant brain atrophy in Alzheimer's disease (AD) from a set of extremal pressure points. In this case the extremal points were manually selected according to prior knowledge of the typical AD atrophy pattern. This is normally not possible when studying other biological processes, like the evolution of brain tumors, where regions of potential volume change are usually unknown. Moreover, the approach proposed in [4] is not very robust, since the identication of local extremal pressure points is very sensitive to the image noise, and critically depends on the considered spatial scale.\nThese points are the local sources and sinks of the volume changes associated to the deformation. This contribution provides the robust identication of locations of maximal volume change, and is detailed in Section 3.1.\nCritical Regions Associated to Probabilistic Extremal Pressure Points. Given the probabilistic extremal points we identify the areas of maximal volume changes (critical regions) associated to the deformation. This step, detailed in Section 3.2, enables to robustly estimate the critical regions consistently with respect to the irrotational component.\nSparse Description of the Velocity from the Critical Regions. We use the critical areas to nally decompose the irrotational eld in a sparse set of components (Section 3.3). This last contribution enables a fully consistent and simple sparse decomposition of the volume changes encoded by the deformation.\nApplication: modeling tumor evolution and group-wise atrophy in Alzheimer's disease. In Section 4 we prove the eectiveness of our framework in the challenging problem of detecting and localizing progressing tumor growth in the brain, and in the group-wise modeling of the longitudinal atrophy in Alzheimer's disease.\nThis way, C k depends on the proximity to the maximal point \u00b5 k P(C k |\u00b5 k ), conditioned by the probability of \u00b5 k to be maximal across scales P(\u00b5 k |\u03c3). We compute P(\u00b5 k |\u03c3) as the cumulative probability of the value of \u00b5 k in a 4D neighborhood of (P n (x)) centered in \u00b5 k . The term P(C k |\u00b5 k ) is instead computed from the Bayes formula as\nwhere P(C k ) is assumed uniform and constant across scales, and P(\u00b5 k |C k ) is the probability of \u00b5 k to be maximum given the neighborhood C k . We express it as:\nwith d(x) = \u00b5 k \u2212 x, and < a, b >= a a 2 b b 2 . Equation (1) states that the region C k is composed of points close to maximal points \u00b5 k , and oriented along the ow lines of P k generated by \u00b5 k ."}, {"section_title": "Contributions and paper's structure", "text": "In this work we propose a fully automatic probabilistic framework for the sparse scale-space analysis of the volume changes encoded by deformations.\nSince we focus on the study of volume changes, our framework is based on the irrotational eld obtained by the Helmoltz decomposition. The irrotational eld is the gradient of a scalar pressure eld. Our contributions are as follows:\nScale-space analysis of extremal pressure point. We introduce a probabilistic framework for the scale-space identication of local extremal pressure points."}, {"section_title": "Topology of Pressure Fields and Volume Changes in Deformations", "text": "Our framework is based on non-linear transformations parameterized by stationary velocity elds, provided for instance by the LCC-logDemons registration algorithm [5] . Consider a deformation exp(u). Following [4] we can decompose the stationary velocity eld u according to the Helmoltz decomposition as the sum of an irrotational and of a divergence-free component u = \u2207P + \u2207 \u00d7 A. The divergence-free component describes the rotational part of the velocity which is not associated to volume changes. The irrotational velocity eld v = \u2207P is the gradient of an apparent scalar pressure eld P , which encodes the volume changes associated to u. In fact, local volume changes are associated to local variations of the pressure P .\nScale-Space Analysis of Extremal Pressure Points Critical points of local maxima and minima of the pressure eld are respectively local attractors and generators of the irrotational velocity eld, and therefore characterize area of contraction and expansion. Each local extremum denes an area of maximal volume change, called critical region, which is a peak or a basin for the pressure eld, and which is characterized by respectively maximum inwards or outwards ux of the irrotational eld across its boundaries (Figure 1) . From the divergence theorem we know that the integral over basins and peaks of the divergence of the irrotational velocity eld is respectively negative or positive.\nhal-00845758, version 1 -17 Jul 2013 3 Scale-Space Identication of Critical Areas Let v = \u2207P be an irrotational velocity eld, and let the pressure P be zero outside the image boundaries. We consider a set of increasing local Gaussian neighborhoods G \u03c3 k . Let G 0 * P = P and lim n\u2192\u221e G \u03c3 k * P = 0, and consider the following partition of P through convolutions P = k (G \u03c3 k \u2212G \u03c3 k+1 ) * P = k P k . The P k obtained by the dierence of Gaussians (DoG) operator are the bandpass ltering of P at scale \u03c3 k \u2212\u03c3 k+1 . DoG is used in classical scale-space analysis as enhancement operator for blob detection, which are dened by identifying the maximal points in scale-space q = argmax (k,x) (P k (x)) [6] .\nIn the present study we want to robustly detect the scale-space extremal points (maxima and minima) in the presence of potentially noisy data. For this purpose we propose a probabilistic framework for assessing the uncertainty of the position of such local extrema."}, {"section_title": "Probabilistic Scale-Space Detection of Extremal Pressure Points", "text": "We dene here a probabilistic framework for the reliable denition of scalespace extremal pressure points. Let (P n (x)) be the 4D scale-space associated to a pressure eld P at the set of scales \u03c3 = {\u03c3 k \u2212\u03c3 k+1 }. Let C k be the probabilistic region at the scale level k for the location of the maximal point \u00b5 k . We set:"}, {"section_title": "Critical Regions Associated to Probabilistic Extremal Pressure Points", "text": "Now that we have robustly identied the signicant locations of extremal pressure points across scales, we are interested in detecting the critical regions generated by such points. In particular, since extremal points are sources (resp. sinks) of the irrotational eld, the critical regions are pressure basins (resp. peaks) characterized by maximum ux of the irrotational eld across their boundaries.\nLet consider the area C k such that P(C k |\u03c3) > 0.6, i.e. the signicant area at the scale k for the critical point \u00b5 k . Let v k = \u2207P k be the irrotational eld associated to the scale level k 4 , and let M \u00b5 k be the region containing C k for which the ux of v k is maximum. In [9] it was shown that M \u00b5 k is the limit of the evolution of the surface \u2202C k according to\nwhere n is the normal to \u2202C k . The region M \u00b5 k can be therefore obtained from C k by iterating the above formula to convergence through a classical gradient descent approach."}, {"section_title": "Sparse Description of the Velocity from the Critical Regions", "text": "Given a scale level k, the critical regions M 4 We note that v = \u2207P = \u2207(\nhal-00845758, version 1 -17 Jul 2013 "}, {"section_title": "Application", "text": "We provide two very dierent applications of the proposed framework. First, we apply it to the modeling of the group-wise longitudinal atrophy in Alzheimer's disease (AD). The aim is to localize the key anatomical regions of AD atrophy at dierent scales, from local (cortical thinning) to regional level, for instance for the hippocampal atrophy. Second, we use our framework for detecting and localizing tumor growth that occurs after the patient has been treated. In this case, scalespace analysis enables to separate those changes which are more persistent and directly related to the tumor process, from those more subtle ones which are indirectly related to the tumor or induced by the treatment, like local atrophy or swelling of ventricles/sulci.\nThe following results were obtained by considering \u03c3 0 = 0mm, and \u03c3 k = \u03c3 k\u22121 + 0.5mm, k = 1, . . . , 16.\nModeling Group-Wise Atrophy in AD. We selected 30 patients aected by AD from the ADNI dataset. For each subject the baseline brain 3D T1 structural image was registered to the one-year follow-up with the log-Demons algorithm.\nSubject specic irrotational elds were transported in a common reference space by using a method proposed elsewhere [3] , and the corresponding pressure components were analyzed with the proposed framework. Figure 2A shows the group-wise average of the transported irrotational elds.\nIn Figure 2B we show the scale-space group-wise average critical areas obtained hal-00845758, version 1 -17 Jul 2013 Avastin suppresses characteristic intensity changes in T1 and T2 MRI, which limits the usefulness of traditional change detection methods that rely on the detection of advancing edema or tumor core boundaries.\nScale space analysis of the tumor evolution is shown in Figure 3 , indicating and localizing signicant volume changes. We nd more persistent volume changes corresponding to shrinkage in the tumor core area (blue), and to decompression of tissue surrounding the tumor following the successful therapy (red) ( Figure 3B) . Moreover, the present analysis is able to capture the shift of the midline axes towards the right hemisphere, which is detectable at smaller scales, as well as the local atrophy at the brain boundaries/sulci (green arrows). In the given case we do not nd indications of recurring growth, but only indications of stable disease.\nhal-00845758, version 1 -17 Jul 2013"}, {"section_title": "Conclusions and Perspectives", "text": "Scale-space analysis of the irrotational velocity eld provides a new and interesting instrument for the analysis of atrophy processes, for instance to distinguish critical regions which are characteristic of a given scale from those which remain persistent across scales. Our experimental results showed how this framework can be already successfully applied to clinical problems for robustly dierentiate volume changes across spatial scales. The proposed robust analysis of critical regions denes the relevant areas of action of the irrotational velocity, and provide thus a topologically consistent and sparse description of the deformation.\nThe present study is a step towards the consistent topological analysis of deformations. For example, one can dene a tree-like structure of the pressure eld, where each level of the tree is a given spatial scale, and the branches connect critical regions which are nested across scales. This way, topology of deformations can be studied with Morse-Smale or graph theory.\nFinally, the presented work can be extended to the analysis of sequences of deformations, for instance for detecting anatomical changes in time series of several images. For this purpose, the consistent extension of the presented framework to 5-dimensional data (space+scale+time) is required."}]
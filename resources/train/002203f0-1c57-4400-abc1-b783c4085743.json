[{"section_title": "Abstract", "text": "Abstract-We present a novel 3-D deformable model-based approach for accurate, robust, and automated tissue segmentation of brain MRI data of single as well as multiple magnetic resonance sequences. The main contribution of this study is that we employ an edge-based geodesic active contour for the segmentation task by integrating both image edge geometry and voxel statistical homogeneity into a novel hybrid geometric-statistical feature to regularize contour convergence and extract complex anatomical structures. We validate the accuracy of the segmentation results on simulated brain MRI scans of both single T1-weighted and multiple T1/T2/PD-weighted sequences. We also demonstrate the robustness of the proposed method when applied to clinical brain MRI scans. When compared to a current state-of-the-art regionbased level-set segmentation formulation, our white matter and gray matter segmentation resulted in significantly higher accuracy levels with a mean improvement in Dice similarity indexes of 8.55% (p < 0.0001) and 10.18% (p < 0.0001), respectively. Index Terms-3-D image segmentation, brain segmentation, deformable models, geodesic active contour."}, {"section_title": "M", "text": "AGNETIC resonance (MR) has become the main modality for brain imaging that facilitates safe, noninvasive assessment and monitoring of patients with neurodegenerative diseases such as Parkinson's disease, Alzheimer's disease (AD), epilepsy, schizophrenia, and multiple sclerosis (MS) [1] - [6] . The ability to diagnose and characterize these diseases in vivo using MR image data promises exciting developments both toward understanding the underlying pathologies, as well as conducting clinical trials of drug treatments. One important biomarker that is often used to assess patients with neurodegenerative disease is brain tissue volume. The typical rate of global brain atrophy in MS patients has been shown to be 0.6%-0.8% annually, which is two to three times the normal atrophy rate [7] . Evidence has shown that white matter (WM) and gray Manuscript received August 20, 2008 ; revised December 11, 2008 . First published March 27, 2009 ; current version published June 12, 2009 . This work was supported in part by the Natural Sciences and Engineering Research Council (NSERC) Parts of the data used in the preparation of this article were obtained from Alzheimer's Disease Neuroimaging Initiative (ADNI) database. As such, investigators within ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. Asterisk indicates corresponding author.\n* A. Huang is with the Department of Electrical and Computer Engineering, University of British Columbia (UBC), Vancouver, BC V6T 1Z4, Canada (e-mail: alberth@ece.ubc.ca).\nR. Abugharbieh is with the Department of Electrical and Computer Engineering, University of British Columbia (UBC), Vancouver, BC V6T 1Z4, Canada (e-mail: rafeef@ece.ubc.ca).\nR. Tam is with the Department of Radiology, University of British Columbia (UBC), Vancouver, BC V6T 1Z4, Canada (e-mail: roger@msmri. medicine.ubc.ca).\nDigital Object Identifier 10.1109/TBME. 2009.2017509 matter (GM) atrophy at different rates, and each correlates differently to disability [8] - [10] ; thus, accurate measurement of the WM and GM brain tissues can provide valuable quantitative indicators of disease progression and, potentially, treatment outcomes [7] , [11] . Thus, the main goal of this paper is to introduce an automatic algorithm for robust WM, GM, and cerebrospinal fluid (CSF) segmentation to facilitate accurate measurement of brain tissues. Previously, to measure various tissue volumes in MRI head scans, manual WM and GM segmentations were often performed by skilled experts. Manual segmentation, however, is extremely time-consuming, mostly limited to 2-D slice-based segmentation, and prone to significant intra-and interrater variability [12] . In particular, manual segmentation cannot be practically and efficiently performed in situations where precise measurements on a large number of scans are required, such as in clinical trials. Therefore, a fully automatic, highly accurate, and robust tissue segmentation technique that provides systematic quantitative analysis of tissue volumes in brain MRI is an invaluable tool in many studies of neurodegenerative diseases. A wide variety of methods have been proposed for automating the segmentation process over the past decade that provided either semi-or fully automated frameworks for the segmentation of brain tissues. A review of some of these methods can be found in [13] and [14] .\nOne popular family of brain tissue segmentation methods is based on normalizing the brain scans by registering (or aligning) them to a predefined atlas of brain tissues. One example is the popular statistical parametric mapping (SPM) technique, which relies on voxel-based morphometry (VBM) [15] . A number of extensions to the original SPM technique have been proposed. For example, SPM is utilized to initialize an expectation-maximization (EM) segmentation framework [16] , which has been extended to nonrigid registration [17] . Although such atlas-based methods are typically robust to artifacts such as acquisition noise and distortions, concerns and discussion [18] - [20] have ensued regarding the use of templates from one population when analyzing data from another population. For example, morphing patient scans with pathologically enlarged ventricles to match a normal template could potentially distort the surrounding tissues in an unpredictable manner. Such structural differences might lead to systematic biases and misregistration errors that are difficult to quantify [19] . Such concerns introduce yet another level of complications arising from image registration and atlas generation procedures that add to the already nontrivial segmentation problem, especially in the presence of anomalies such as tumors, lesions, and tissue atrophy.\nA second family of brain tissue segmentation methods assigns a label for each tissue based on image statistics either by clustering [21] or by modeling the brain tissue intensity distributions as a finite mixture of distributions such as EM [22] , maximum a posteriori (MAP) [23] , simulated annealing [24] , and Gaussian mixture modeling (GMM) [25] . Other approaches incorporate additional regional information, which is lacking from these statistical methods, into their segmentation framework. Such methods extend clustering or EM by integrating with fuzzy connectedness [26] , topological constraints [27] , Gibbs random field (GRF) [28] , and hidden Markov random field (HMRF) [29] in the segmentation task. A common difficulty with many of these methods, particularly the random field approaches, is the requirement for proper parameter settings in a supervised setting.\nA third family of brain tissue segmentation methods is based on utilizing geometric information such as deformable models or active contours [30] that delineates region boundaries using a minimization of an energy functional [31] , [32] . Deformable models employing level sets [33] provide an effective implicit representation rather than explicit parameterization of the evolving contour. However, a common problem of directly applying the active contour approach in segmenting brain MR images is leakage through weak or noisy edges that are ubiquitous, especially for edge-based deformable models, e.g., geodesic active contour [34] , which describe the evolution of propagating curve as a function of image gradient features. Some researchers incorporated image statistics into their deformable models in various segmentation applications by utilizing coupled surface principle [35] , [36] and fuzzy logic [37] , [38] to achieve better stability. Others employed a region-based model [39] by utilizing regional homogeneity in a curve evolution perspective and a hierarchical implementation on brain pathology images [40] . More recently, tissue segmentation was performed and quantitatively evaluated [41] - [43] by using the multiphase 3-D level set segmentation (M3DLS) algorithm [41] . M3DLS utilizes a multiphase extension [44] of the region-based deformable model [39] based on the Mumford-Shah functional [45] by iteratively deforming two closed curves separating four regions. This minimal partitioning approach assumes piecewise constant or piecewise smooth data and optimizes a sum of terms, including the lengths and areas for the two closed curves, and the sums of square intensity differences from the means for all four separated regions. This minimization is also performed in a level set framework [33] implicitly. Further extending this model to Nphase allows separation of 2 N regions but the number of classes to be segmented is limited to two to the power of the number of closed curves defined. Moreover, complexity increases as more level sets are required and the rate of convergence is typically slow [46] .\nIn this paper, we propose a MR brain tissue segmentation approach that integrates both geometric and statistical image features into an edge-based deformable model formulation to achieve accurate segmentation results. By utilizing this novel hybrid image feature, we present one solution to the challenging problem of stabilizing the active contour. Similar existing work used a topology preservation principle enforced at nonsimple points in a geometric deformable model [47] , or a curve shortening prior for smoothness in a level set framework to minimize leakage [40] , [48] . Here, we do not explicitly apply any smoothness and topological constraints (e.g., topology preservation at nonsimple points) to the geometric deformable models but rather rely on the proposed hybrid feature to regularize the level sets. Other approaches used prior knowledge such as a distance penalizing term in the level set function between two boundary classes [35] , a fuzzy decision system on contour distance to an anatomical target or atlas [37] , or a dissimilarity measure between the contour and a shape model in the energy term [49] . Here, we demonstrate our proposed approach in segmenting complex anatomical structures such as WM, GM, and CSF without a priori knowledge. Hence, the proposed approach is truly automated and data-driven in both statistical and geometric sense. Furthermore, we compare the segmentation performance of our proposed edge-based level set method to the region-based M3DLS approach [41] on real clinical MRI scans. We demonstrate the improved WM, GM, and CSF segmentation accuracy and robustness when using the proposed method.\nThe paper is organized as follows: In Section II, we introduce our novel hybrid geometric-statistical feature implemented on the edge-based geodesic active contour formulation. Our modified deformable model is then used to design a new automated 3-D brain tissue segmentation algorithm for both single and multiple MR sequence data. In Section III, we present quantitative and qualitative results and analysis obtained on simulated and real clinical MRI images, as well as comparisons to results reported by using M3DLS. We then conclude in Section IV."}, {"section_title": "II. METHODS", "text": "In this section, we present our 3-D brain segmentation method that integrates both geometric and statistical features in an edgebased geodesic active contour framework. We describe the proposed model in its general form. We then present a segmentation framework for brain MRI for both single and multiple MR sequence data."}, {"section_title": "A. Edge-Based Deformable Model", "text": "In this study, we utilize the geodesic active contour model [34] rather than the region-based formulation [39] due to its computation soundness and extendibility. The geodesic model delineates region boundaries by describing the evolution of a curve or surface C from an initial position C 0 as finding the minima of the Riemannian curve distance\nwhere g is a general feature function, |\u2207I| is the gradient norm of intensity I, and q is the parameterization of the curve C. The right side of the equation describes the parameterized curve C(q) such that the Euclidean length of C can be represented as L(C) = |C (q)|dq = ds, where ds = |C (q)|dq is the Euclidean arc length or the Euclidean metric. Note that this geodesic formulation of the active contour relies on g, the speed and halting feature for the evolving surface in 3-D applications derived based on the geometric gradient feature of an image. Generally, g is chosen as a positive-valued function of the intensity gradient as in (2), where\u00ce is a smoothed version of I and \u03c1 = 1 or 2 [34] . Other similar monotonically decreasing functions, such as the sigmoid function (3) with parameters \u03b1 (width of intensity window) and \u03b2 (center of intensity window) are also often utilized [50] .\nThe value of this feature function determines the propagation of the surface by searching for the minimal Riemannian distance. An ideal edge would ultimately have a feature value of zero at all the pixel points along this boundary. However, propagation relying solely on edge feature is typically sensitive to noisy and weak edges that are frequently observed in medical images. In particular, with the presence of complex anatomical structures, it is often impossible to automatically and accurately derive the desired geometric edge term to prevent contour leakage into the surrounding regions. Consequently, achieving accurate segmentation results with edge-based geodesic active contour requires either user intervention or careful adjustment of parameters such that the ideal boundary is minimal. This process is subjective and ideal parameters are often difficult to derive for a fully automated segmentation framework."}, {"section_title": "B. Proposed Hybrid Geometric-Statistical Feature", "text": "We propose to transform the feature function g in the traditional geodesic active contour formulation into a hybrid feature function by incorporating geometric image features with voxel statistics to help automate and regularize the evolving contours. The minimization of the active contour is thus represented by (4)\nwhere for gray-scale intensity MR images, P (I|\u03a6) represents the probability distribution function of a mixture model (5) from which voxel statistics are drawn, assuming that all voxels are identically and independently distributed and the image is to be described with K class labels.\nwhere P (k) represents the prior probability of the class label k and P (I|\u03a6 k ) is the conditional density function of the kth class given \u03a6, the parameter set of the distribution. We employ Gaussian distributions as\nwhich require a parameter set \u03a6 = {\u00b5, \u03c3}, where \u00b5 and \u03c3 are the mean and standard deviation. This parameter estimation problem for GMM is solved by applying the EM algorithm [51] to the image intensity histogram. The design of g in (4) utilizes both a geometric term and a statistical term. Geometrically, the presence of strong image gradients indicates significant structural content. As a result, the contour propagation speed slows to a halt. On the other hand, a lack of edge features often indicates the presence of a homogeneous region. Statistically, high voxel probability indicates a high likelihood of the voxel belonging to the class of interest, warranting a fast contour propagation. If the voxel likelihood is reduced, the contour propagation is slowed down accordingly. The contribution of voxel likelihood to the contour propagation exhibits an inverse behavior to that of image gradients. Since both geometric and statistical features are essential to the contour stability, they can be combined into a single hybrid feature function by modeling the aforementioned behavior as\nwhere the first term is the traditional geometric feature as in (3) and the second term models the inverse behavior of voxel likelihood to image gradients using an inverse sigmoid function with magnitudes between \u22121 and 1. Complementarily, these two components in the new hybrid feature help regularize the evolving contour in both the geometric and statistical sense. The minimization of (4) is then achieved by computing the EulerLagrange equation [34] d dt\nwhere \u03ba is the Euclidean curvature, N is the inward unit normal, and C 0 is the initial curve or surface, and performing steepest gradient search (9) , to deform C toward a minima\nwhere {\u03c8, c, \u03b5} are the free parameters introduced to govern curvature, propagation, and advection strengths, respectively. With the designed hybrid feature, the algorithm uses only the propagation term. Other terms are shown here for completeness. This curve evolution equation is then embedded in a level set function u and solved for the steady state solution:\nThe numerical implementation is based on the curve evolution algorithm via level sets [33] , which utilizes an upwind piecewise continuous approximation scheme to provide a numerically stable solution in the presence of singularities.\nAs summarized in Table I , the rationale behind using this new hybrid feature is to enable handling of situations where the image gradient is high (small sigmoid(|\u2207I|) value) and the posterior probability of voxel is low, in which the voxel is considered to be a significant feature but lies outside of the desired region. We, therefore, aim to steer the contour slowly away from this voxel by assigning a small negative feature value. On the other hand, if the posterior probability is high, this indicates a significant feature within the desired region; therefore, a small positive feature value is assigned. In contrast, if the image gradient is low (large sigmoid(|\u2207I|) value) and the posterior probability is low, the voxel is considered to be a weak gradient feature that lies outside of the desired region, warranting a large negative feature value such that contour can be quickly steered away from that region. If the posterior probability is high, a homogeneous area in the desired region is indicated, and is rewarded with a large positive feature value for fast contour expansion. In summary, the proposed hybrid feature provides an adaptive active contour propagation based on local information reflecting both geometry and statistical homogeneity."}, {"section_title": "C. Segmentation of Brain MRI", "text": "Based on the proposed active contour model, we develop a fully automated 3-D brain tissue segmentation algorithm for MR images. The segmentation procedures (Fig. 1) are a generalization and extension of earlier work [52] . We first present the proposed algorithm for T1-weighted (T1w) MRI scans, which are most often used for brain tissue segmentation due to the generally high WM and GM contrast and the reduced effects of WM lesions in patients with neurodegenerative diseases. We later extend the proposed method to simultaneously incorporate additional MR sequence data, such as T2-weighted (T2w) and PD-weighted (PDw) images, in addition to T1w.\nTo segment the brain tissues, we first estimate the GMM parameters such that each mixture distribution represents one single class. Based on these estimated distributions, the normalized posterior probability of each voxel is calculated. We derive the hybrid geometric-statistical feature as described above by combining both the voxel statistics and the image gradient information. To initialize the active contour, we first introduce a voxel threshold t s on the posterior probability to further regularize this contour initialization by effectively removing voxels outside of the desired region boundaries due to noise or partial volume artifacts. Based on the thresholded masks, we form the skeleton representation using standard 2-D morphological sequential thinning (3 \u00d7 3 kernel) and sequential pruning (3 \u00d7 3 kernel) [53] iteratively until no further changes occur. This is done slice-by-slice in 2-D as morphological operations are performed on discrete numbers of voxels, and to do this in 3-D on anisotropic scans would require resampling of the acquired data, which would potentially introduce additional artifacts. The hybrid feature and the contour initialization are determined individually for each tissue to be segmented, and each contour is then propagated independently. After the contours converge, minor overlaps and gaps occurred between the individually evolving contour boundaries are re-assigned to a single label by comparing the individual z-scores, the difference between voxel intensity to the sample mean normalized by the sample standard deviation, of all tissue classes. A brief description of the algorithm is described as follows:\nStep 1: Given raw MRI scan U .\nStep 2: Preprocess with intensity inhomogeneity correction, noise filtering, and brain extraction to obtain V .\nStep 3: Calculate gradient norm |\u2207I| of pixel intensity I in V .\nStep 4: For k = 1 to K, tissue class labels: 1) determine the GMM distribution parameter set by using EM: \u03a6 k = {\u00b5 k , \u03c3 k }; 2) for each I, calculate normalized probability P (I|\u03a6 k ).\nStep 5: For k = 1 to K, tissue class labels: 1) derive hybrid geometric-statistical feature: g k (I) = g(|\u2207I|, P (I|\u03a6 k )); 2) derive initial contour C 0,k by thresholding P (I|\u03a6 k )\nat t S = 0.1 and skeletonizing; 3) propagate curve C k from C 0,k on g k (I) until convergence to obtain class label image L k (I). In step 5, the performance gain by setting t s > 0 is demonstrated in Table II, "}, {"section_title": "D. Extension to Multiple MR Sequence Data", "text": "To further demonstrate the flexibility of the proposed segmentation approach, we extend our method so that information from multiple MR sequences with different contrast properties can be incorporated when the data is available. Assuming registered images, we first replace the geometric feature component in the proposed hybrid active contour feature (7) with the multidimensional vector gradient norm derived from all available data sequences. To derive the statistical active contour feature term, the GMM parameters and the voxel statistics are individually estimated for each contrast modality m given M input modalities. Since our main goal is to improve the ability to differentiate between various tissue labels, we derive an pairwise intensity contrast term C m i,j as a ratio of absolute intensity difference between the EM estimated means \u00b5 of labels i and j over the observed intensity range of [I Max . . . I Min ] (11) and then normalize (12) .\nThis intensity contrast factor is used as an optimized weighting factor to linearly combine individual posterior probability, P (I |\u03a6 m k ) as in (13) , for label k in modality m to form a new posterior probability. This is done by using all relevant pairwise contrast terms, defined between label k and all others. This ensures that the MR sequence with greater contrast receives a greater weight with respect to other lower contrast MR modalities used. Equation (13) shows how the final posterior probability is computed as a function of the means and variances of each tissue and modality. In the case where tissues at different modalities exhibit equal variances, more emphasis is placed on the scan that possesses the greater difference between the expected values of the tissues of interests, thereby facilitating separation. In the other case where the differences in the sample means are equal, the differences in variance are taken into account inherently in the individual posterior probability terms. The resulting probability replaces the posterior probability derived from single contrast input in the segmentation procedure."}, {"section_title": "E. Data Preprocessing", "text": "We employed the nonparametric nonuniform intensity normalization (N3) algorithm [54] for intensity inhomogeneity correction using default parameter settings (width of deconvolution kernel = 0.15, number of iterations = 50, sampling factor = 4, characteristic distance = 200 mm, stopping criteria = 0.001). All scans were then noise filtered using an edge-preserving Perona-Malik anisotropic diffusion filter [55] (number of iterations = 4, conductance = 3.0) to further enhance the image signal-to-noise ratio. Brain masks were generated using the provided ground truths consistent with other published methods to facilitate direct comparisons, or alternatively, many methods are also available for this brain extraction task [56] - [58] . For the clinical datasets where the ground truths are not available, the brain masks were generated with the brain extraction tool (BET) [56] using default parameter settings."}, {"section_title": "III. RESULTS AND DISCUSSION", "text": "We applied our proposed segmentation to both simulated and real clinical MRI scans, and demonstrated in the following sections: 1) the accuracy of the proposed segmentation method on simulated T1w brain MRIs; 2) the segmentation improvement on multiple MRI sequences; 3) the accuracy of the proposed method on real clinical MRI scans of normal adults; and 4) the qualitative performance of the proposed methods on clinical MRI scans of MS and AD patients.\nWe first validated our proposed method on 18 simulated T1w BrainWeb [59] MRI images (with 0%/1%/3%/5%/7%/9% noise, 0%/20%/40% inhomogeneity, 181 \u00d7 217 \u00d7 181 dimension, 1 \u00d7 1 \u00d7 1 mm 3 spacing). We also performed multisequence segmentation based on six T1w/T2w/PDw MRI triplets (with 0%/1%/3%/5%/7%/9% noise, 0% inhomogeneity). Second, 18 real high-resolution clinical T1w MRI scans from the Internet Brain Segmentation Repository (IBSR) [60] (coronally acquired, 256 \u00d7 128 \u00d7 256 dimension, 0.837 \u00d7 0.837 mm 2 to 1 \u00d7 1 mm 2 in-plane spacing, 1.5 mm slice thickness) were also segmented. For both datasets, the \"ground truth\" is known for comparisons. For the BrainWeb dataset, the ground truth is the phantom atlas used to generate the simulated scans, whereas for the IBSR dataset, the ground truth is the provided expert-guided manual segmentation label for each of the clinical scans. Lastly, from the MS MRI Research Group (MS/MRI), real clinical 1.5 T spoiled gradient (SPGR) MRI scans (axially acquired, 256 \u00d7 256 \u00d7 120-160 dimension, 0.937 \u00d7 0.937 \u00d7 1.50 mm 3 spacing) were taken at multiple sites. Real clinical 1.5 T magnetization prepared rapid gradient echo (MP-RAGE) MRI scans (sagittally acquired, 256 \u00d7 256 \u00d7 166 dimension, 0.937 \u00d7 0.937 \u00d7 1.20 mm 3 spacing) were also obtained from the AD Neuroimaging Initiative (ADNI) of the LONI image data archive (IDA) [61] initiated by the National Institute on Aging (NIA), the National Institute of Biomedical Imaging and Bioengineering (NIBIB), the Food and Drug Administration (FDA), private pharmaceutical companies, and nonprofit organizations. These clinical scans were segmented and qualitatively evaluated. For all experiments, the parameters for the level set evolutions are set at {\u03c8 = 0.0, c = 1.0, \u03b5 = 0.0} to reinforce propagation and effectively remove boundary attraction and smoothness regularizations. The convergence criteria for the gradient descent optimization is defined as either less than 0.5% root-mean-square change in the level set function or, if not achieved, a maximum of 100 iterations reached.\nThe average surface distance between the ground truth and the computed segmentation was computed for each test scan by approximate nearest neighbor searching [62] . In addition, the Dice similarity index [63] was also chosen for the quantitative evaluation of the 3-D brain segmentation results to facilitate direct comparisons to other published results Dice similarity index :\nWe denote the true positives, true negatives, false positives, and false negatives as T + , T \u2212 , F + , and F \u2212 , respectively, between the known ground truth and the segmentation results. We compared our segmentation results with those of the M3DLS method [41] ."}, {"section_title": "A. Segmentation Validation Using Simulated Brain MRI", "text": "We first validated a three-class (WM, GM, and CSF) segmentation using the proposed method on the simulated T1w brain MRI data. Segmentation was performed using the traditional geometric feature only, the statistical feature only, and the proposed hybrid feature on all 18 datasets with varying noise and intensity inhomogeneity levels. For the edge-only level set evolution, the parameter set {\u03c8 = 2.0, c = 1.0, \u03b5 = 4.5} was used to enforce a stronger smoothness constrain; otherwise, contours leaking through weak edges were often observed. For the statistical feature term only, the parameter set {\u03c8 = 0.0, c = 1.0, \u03b5 = 0.0} was used, same as the hybrid approach. Qualitative results in Fig. 2 demonstrated very good resemblance between the provided phantom label and the segmentation results based on the hybrid feature. Table III shows that, on average, over all noise and inhomogeneity levels, the proposed method achieved consistently accurate segmentation results for both WM and GM with similarity indexes of 93.71% (\u03c3 = 2.11%, average distance = 0.27mm) and 92.59% (\u03c3 = 2.40%, average distance = 0.30mm). Segmentation of structures such as CSF by using the proposed approach also achieved considerable (>70%) similarity of 77.75% (\u03c3 = 6.15%, average distance = 2.24 mm). The CSF results were not as stable as WM and GM mainly due to the much smaller structural volume, leading to increased sensitivity to estimation errors in the active contour initialization and feature derivation. Nonetheless, the overall segmentation results were on par if not better than other previously published results [16] , [27] , [64] .\nTo statistically evaluate the differences of segmentation results between the proposed hybrid approach, and the contours based on geometric-only and statistical-only features, we calcu- Fig. 2 . Qualitative segmentation performance of two simulated T1w brain images showing the provided phantom label, raw images and the segmentation results obtained by using the proposed hybrid feature. We show three slices for both the best case (0% noise, 0% inhomogeneity) and worst-case (9% noise, 40% inhomogeneity) scenarios. White, light gray, and dark gray colors represent, respectively, the WM, GM, and CSF classes in the tissue and phantom labels. We note the results from the hybrid approach resemble the phantom for both the best and worst input scenarios. lated the p-values (p < 0.05 indicates a statistically significant difference in the group means). Compare to results from using only the traditional geometric feature, the proposed hybrid approach achieved significantly higher similarity indexes and reduced surface distance across all scans. On average, the proposed method achieved increased similarity indexes of 5.36% (p = 0.0002) in WM, 7.23% (p < 0.0001) in GM, and 9.30% (p < 0.0001) in CSF segmentation results with reduced surface distance of 3.99 mm (p < 0.0001) in WM, 0.27 mm (p < 0.0001) in GM, and 4.86 mm (p < 0.0001) in CSF. Compare to results from using only the statistical feature, the proposed hybrid approach only achieved slightly better similarity indexes. However, we observed that, on average, the proposed method was able to significantly reduce the average surface distance by 4.44 mm (p < 0.0001) in WM and 3.79 mm (p < 0.0001) in CSF. These results showed that using the geometric term alone was highly sensitive to image artifacts and require contour regularization, and using the statistical term alone caused the contours to deviate from the true edges. Only when incorporating both features we can evolve the contour in the appropriate statistical space while maintaining high geometric relevance at the same time. Processing a single BrainWeb volume takes approximately 55 min (dual 3.20 GHz Xeon PC with 3.25 GB memory) to 75 min (3.60 GHz Pentium4 PC with 2 GB memory), comparable to the processing time required by other conventional techniques."}, {"section_title": "B. Segmentation Improvement Using Multiple MR Sequences", "text": "We next performed a three-class (WM, GM, and CSF) segmentation using the proposed method on the simulated T1w/T2w/PDw brain MRI data. Segmentation was performed on six datasets with varying noise levels and 0% intensity inhomogeneity. Qualitative results in Fig. 3 illustrated very good resemblance between the provided phantom label and the segmentation results. Table IV demonstrates the quantitative  segmentation accuracies. On average, over all noise levels, TABLE III  QUANTITATIVE EVALUATION OF SEGMENTATION RESULTS OBTAINED BY USING THE GEOMETRIC FEATURE, THE STATISTICAL FEATURE, AND THE PROPOSED HYBRID APPROACH ON 18 SIMULATED T1W BRAINWEB SCANS Fig. 3 . Qualitative segmentation performance of a multiple simulated MR sequence (T1w, T2w, PDw) brain images showing the provided phantom label, raw images (0% noise, 0% inhomogeneity), and the segmentation results obtained by using the proposed approach. White, light gray, and dark gray colors represent, respectively, the WM, GM, and CSF classes in the tissue and phantom labels. We show three slices for the test case and note improved segmentation results on multiple MR sequence.\nthe proposed method achieved consistently accurate segmentation results for WM, GM, and CSF with similarity indexes of 96.24% (\u03c3 = 1.13%, average distance = 0.15 mm), 94.14% (\u03c3 = 1.24%, average distance = 0.24 mm) and 81.57% (\u03c3 = 2.82%, average distance = 1.56 mm), respectively. When compared to the experiment on single simulated T1w brain images, segmentation using multiple MR sequence data provided an average improvement in similarity indexes of 1.29% (p = 0.0479), 0.44% (p = 0.4627), and 3.55% (p = 0.1403) for WM, GM, and CSF, respectively. The segmentation improve- Table III (column 1) shows that with only T1w scans as inputs, the differences between the T + and T \u2212 were 7.77%, 8.67%, and 24.09%, respectively, for WM, GM, and CSF, whereas with T1w, T2w, and PDw inputs (Table IV) , these differences were much reduced to 2.84%, 0.24%, and 6.95%."}, {"section_title": "C. Segmentation Comparisons Using Clinical MR Scans of Normal Adults", "text": "We applied the proposed method to segment 18 clinical IBSR brain images. The images were segmented using a three-class (WM, GM, and CSF) segmentation. The qualitative results are shown in Fig. 4 . The tissue labels were then postprocessed due (IBSR #08) showing the raw images, the expert-guided manual segmentation label, and the segmentation results obtained by using the traditional edge feature and the proposed hybrid approach. We show three slices for the three-class segmentation case and the postprocessed case. White, light gray, and dark gray colors represent, respectively, the WM, GM, and CSF classes in the segmentation labels. We note the good resemblance between the segmentation results and the raw image, and between the postprocessed results and the expert-guided manual segmentation labels.\nto a known limitation of the provided manual segmentation labels. It has been reported previously [41] that the expertguided manual segmentation label contains much of the cortical CSF being mislabeled as GM. We have confirmed this with our own observations. As observed from Fig. 4 , we note that the original segmentation results matched closely with what can be visually observed from the raw images. However, this observation did not correspond well to the provided expertguided manual segmentation label due to the existing limitation. If quantitative evaluation was to be performed on this result, both GM and CSF would produce much lower accuracies than what were actually present.\nTo enable a valid comparison by retaining only the ventricular CSF for comparison, we employed the following postprocessing scheme:\nStep 1: Re-assign segmented CSF labels close to (\u22645 mm) any background labels as GM.\nStep 2: Define a rectangular region of interest (30% of the mask width in the superior-inferior orientation and 50% for both left-right and anterior-posterior) around the brain mask centroid. Apply 2-D morphological thinning (3 \u00d7 3 kernel) [65] on CSF pixels outside the region of interest in coronal slices, and singly links are removed.\nStep 3: Identify the largest 3-D connected component as the desired ventricular CSF. Apply 3-D morphological dilation (3 \u00d7 3 \u00d7 3 kernel) to this final mask, and re-assign all original CSF labels outside as GM. This postprocessing scheme allowed us to generate results comparable to the provided manual label. We show in Table V that the results obtained by using the proposed method achieved similarity indexes of 87.55% (\u03c3 = 2.92%, average distance = 0.54 mm), 93.18 (\u03c3 = 0.92%, average distance = 0.38 mm), and 77.39% (\u03c3 = 11.15%, average distance = 3.12 mm) for WM, GM, and CSF, respectively, averaged across the 18 images tested. To statistically compare the segmentation however, our proposed approach achieved considerable (>70%) similarity. Furthermore, the segmentation results achieved by M3DLS were conservative with low true positives. This can be mainly attributed to the fact that the optimization functional in M3DLS modeled each class as piecewise constant by taking only the intensity square differences from the means. However, variations within each segmented class are not considered, such that if, intrinsically, WM contains significantly larger intensity variance than GM, voxels belonging to WM would potentially be mislabeled as GM if the voxel intensities are closer to the estimated GM mean. This lead to undersegmentation in WM (undersegmentation in GM is attributed to the known limitation in the manual labels), and M3DLS is required to postprocess the segmentation results by incorporating an additional morphological dilation step [42] . On the other hand, by integrating both geometric and statistical features into an edge-based deformable model, the proposed hybrid approach captures both the image edge geometry and the voxel statistical homogeneity, and achieved higher segmentation accuracies with less additional computation complexity."}, {"section_title": "D. Segmentation Performance Using Clinical MR Scans of MS and AD Patients", "text": "Lastly, we applied the proposed method to segment clinical MRI brain scans of MS and AD patients. The images were segmented using a three-class (normal appearing WM, GM grouped with diseased WM, and CSF) segmentation. The qualitative results are shown in Fig. 5 , demonstrating that the proposed approach appears stable on clinical scans. Fig. 5(a) shows a typical clinical MRI scan of a MS patient, whereas Fig. 5(b) illustrates an example scan of a MS patient with enlarged lateral ventricles. Both scans were segmented without any gross misclassifications. In addition, we demonstrated segmentation results from an MRI scan where the brain extraction step inaccurately included part of the eyes in the brain mask in Fig. 5(c) . This error in the brain mask did not seem to cause visible problems for the algorithm in the adjacent brain tissue. Furthermore, Fig. 5(d) and (e) shows segmentation results of scans from an AD patient one year apart. We again noticed visibly consistent segmentation in the tissue labels in the presence of tissue atrophy/ventricle enlargement over time. In our T1w test scans, the intensity difference between GM and diseased WM is subtle, and separating these two class types is likely not possible without additional MRI sequences that are more sensitive to WM pathology, such as PDw or T2w, or relying on prior probability maps such as those derived from a training set. We have left these experiments for future work. In its current form, the proposed method can potentially be used for the assessment of disease severity by providing stable and consistent segmentations of CSF and normal appearing WM."}, {"section_title": "IV. CONCLUSION", "text": "We proposed a 3-D brain MR segmentation method based on deformable models and demonstrated accurate and stable brain tissue segmentation on single as well as multiple MR sequence scans. The main contribution of our work is that we employed a geodesic active contour formulation by integrating both image geometry and voxel statistics into a hybrid geometric-statistical feature, which acts as a stabilizing regularizing function for the extraction of complex anatomical features such as WM, GM, and CSF. We validated our technique first by using both single and multiple simulated brain MRI sequence data. Improved segmentation accuracy and robustness were shown in results from the proposed hybrid approach against those using individual geometric or statistical features only. Furthermore, on real clinical MRI datasets, we also demonstrated improved accuracy over a state-of-the-art approach, the region-based M3DLS. We also demonstrated consistent and robust results when segmenting MRI scans of both MS and AD patients.\nIssues identified for possible future work include enhancing the statistical distribution estimation process by using complex intensity distribution estimation methods such as nonparametric and partial volume models, and extending additional segmentation classes, hierarchy or feature cues for segmentation of anomalies such as WM lesions or tumors. "}]
[{"section_title": "Abstract", "text": "This paper presents a general methodology for high-dimensional pattern regression on medical images via machine learning techniques. Compared with pattern classification studies, pattern regression considers the problem of estimating continuous rather than categorical variables, and can be more challenging. It is also clinically important, since it can be used to estimate disease stage and predict clinical progression from images. In this work, adaptive regional feature extraction approach is used along with other common feature extraction methods, and feature selection technique is adopted to produce a small number of discriminative features for optimal regression performance. Then the Relevance Vector Machine (RVM) is used to build regression models based on selected features. To get stable regression models from limited training samples, a bagging framework is adopted to build ensemble basis regressors derived from multiple bootstrap training samples, and thus to alleviate the effects of outliers as well as facilitate the optimal model parameter selection. Finally, this regression scheme is tested on simulated data and real data via cross-validation. Experimental results demonstrate that this regression scheme achieves higher estimation accuracy and better generalizing ability than Support Vector Regression (SVR)."}, {"section_title": "Introduction", "text": "High-dimensional pattern classification has been increasingly used during the past decade as a means for quantifying and detecting spatially complex and often subtle imaging patterns of pathology from medical scans. It aims to provide sensitive and specific diagnostic and prognostic indicators for individuals, as opposed to analyzing statistical group trends and differences (Lao et al., 2004; Thomaz et al., 2004; Cox and Savoya, 2003; Davatzikos et al., 2006 Davatzikos et al., , 2008 Davatzikos et al., , 2009 Fan et al., 2007; Kloppel et al., 2008; Liu et al., 2004; Vemuri et al., 2008 Vemuri et al., , 2009a Golland et al., 2002) . However, classification is a dichotomous process, i.e. it assigns an individual to one category of two or more. Many pathologies and diseases present a continuous spectrum of structural and functional change. For example, AD pathology is known to progress gradually over many years, sometimes starting decades before a final clinical stage. It is therefore important to estimate continuous clinical variables that might relate to disease stage, rather than categorical classification. Furthermore, the ability to predict the change of clinical scores from baseline imaging is even more important, as it would estimate disease progression, and then improve patient management. Towards this goal, this paper investigates high-dimensional pattern regression methods.\nSome regression methods have been established in recent imaging literature (Duchesne et al., 2005 (Duchesne et al., , 2009 Ashburner, 2007; Davis et al., 2007; Formisano et al., 2008) . Duchesne et al. (2005 Duchesne et al. ( , 2009 ) proposed a multiple regression approach to build linear models to estimate yearly Mini Mental State Examination (MMSE) changes from structural MR brain images. The features used in these models were extracted from intensities of structural MR brain images and deformation fields with Principal Component Analysis (PCA) techniques. Unfortunately, the linear model derived from multiple regression is not always reliable in capturing nonlinear relationships between brain images and clinical scores, especially with limited training samples of high-dimensionality. Davis et al. (2007) presented a manifold kernel regression method for estimating brain structural changes caused by aging. Actually this study addressed the converse problem, i.e. the problem of finding an average shape as a function of age, whereas we try to predict a continuous variable from a structural or functional imaging measurement, a problem that is hampered by the sheer dimensionality of the feature space.\nKernel methods have recently attracted intensive attention. In particular, Support Vector Machines (SVM), have become widely established in classification problems because of their robustness in real applications (Cox and Savoya, 2003; Fan et al., 2007 Fan et al., , 2008 . Due to SVM's success in classification, it has been used for regression (Harris Drucker et al., 1996; Musicant, 2000, 2002; Smola and Sch\u00f6lkopf, 2004) as well. However, support vector regression has some disadvantages that become especially NeuroImage 50 (2010) [1519] [1520] [1521] [1522] [1523] [1524] [1525] [1526] [1527] [1528] [1529] [1530] [1531] [1532] [1533] [1534] [1535] pronounced in high-dimensional problems. In particular, typical application of SVR to medical images leads to a very large number of support vectors, thereby potentially limiting the generalization ability of the classifiers and regressors. This problem is particularly prominent in regression, which requires much larger training sets than classification, since it estimates a continuous variable. In order to overcome this limitation, a sparser regression method, called Relevance Vector Regression (RVR) has been proposed in Tipping (2001) , which effectively uses L 1 sparsity instead of L 2 that is used in SVM, and hence leads to significantly sparser models that are likely to generalize well. Ashburner has used RVR to predict subject age (Ashburner, 2007) . Formisano et al. (2008) applied SVM on classification and Relevance Vector Machine (RVM) on regression of brain responses by using PCA features extracted from functional MRI time series. Unfortunately, in Formisano et al. (2008) , there was no systematic evaluation and comparison between SVM and RVM, especially for regression problem. Within our proposed framework, RVR and SVR are investigated by comparing their sparseness, generalization ability and robustness on both simulated and real data.\nDue to the curse of dimensionality, dimensionality reduction and feature extraction are necessary, even though RVM is a very sparse model with good generalization ability. PCA has been commonly used to linearly reduce dimensionality Thomaz et al., 2004; Formisano et al., 2008) . However, PCA is not always able to identify localized abnormal regions of pathology, which limits the power of classifiers or regressors. To address this problem, we use an adaptive regional clustering method previously discussed in Fan et al. (2007) . Compared with global features extracted by PCA, spatial regional measures potentially offer a better way to capture spatial patterns of structure and function, especially in diseases that have regional specificity. Moreover, regional features are constructed to have strong discriminative power. Based on these regional features, we use RVM to construct regression models. To improve stability of the training process, a bagging framework is adopted to build ensemble regression models to facilitate optimal parameter selection. From the experimental results utilizing different feature extraction methods, regional feature-based RVR is found to be an effective regression method that yields robust estimation of continuous clinical variables with reasonable diagnostic accuracy and good generalization ability.\nIn the next section, we introduce the proposed methods in detail. In Data and applications, the simulated data and real data from different clinical applications are described. In Experimental result analysis, we verify the proposed method by extensive experiments and comparisons with SVR via other common feature extraction techniques. A set of conclusions drawn from the extensive discussions of experimental results, and possible work for further improvements are presented in Discussion and conclusion."}, {"section_title": "Methods", "text": "Our machine learning framework is presented in Fig. 1 , which includes three key steps: (1) the first step depends on the specific application and involves calculation of certain features of interest from the original images. In many neuroimaging applications, we are interested in measuring spatial patterns of brain atrophy of growth. Therefore, we first design Tissue Density Maps (TDMs), as commonly done in the neuroimaging literature (Ashburner and Friston, 2000; Davatzikos et al., 2001; Fan et al., 2007) . Based on TDMs, an adaptive regional clustering method is then applied to capture informative regional features, and then a subset of features with top-ranking correlation power to interested regression problem are selected from the original regional clusterings; (2) RVM is then used to construct efficient and sparse regression models; (3) A bagging framework is used to build ensemble regressors in order to improve model stability, as well as facilitate optimal parameter selection for regression models with the limited training data."}, {"section_title": "Feature extraction and selection", "text": "Medical imaging offers a wealthy information of spatial, temporal and multiparametric measurements of structure and function. However, the resultant feature space is too large for robust and fast pattern analysis, especially when only limited samples are available. With this in mind, the essential step in an imaging-based machine learning framework is to find a suitable representation of highdimensional data by means of dimensionality reduction. The ideal representation has to be in a low-dimensional feature subspace while keeping as much information as necessary to estimate the variables of interest. More importantly, feature extraction needs to be robust to measurement noise and preprocessing errors, and should be easily extended to other applications. To address these challenges, we use an adaptive regional feature clustering method, and then investigate its discrimination ability and its robustness by comparing it with three benchmarks among dimensionality reduction methods: Linear Discriminant Analysis (LDA) and PCA, and also nonlinear manifoldlearning approach (Hotelling, 1933; Fisher, 1936; Tenenbaum et al., 2000) ."}, {"section_title": "Adaptive regional feature clustering", "text": "This feature extraction algorithm is developed in a similar way to an adaptive regional clustering method, which has been successfully used in classification of brain images (Fan et al., 2007) . The difference is that, during the brain region generating procedure, our method is to consider the similarity of correlation coefficients between voxel-wise measures and continuous clinical scores being regressed, instead of class labels. Fig. 1 . A bagging framework of regression using RVM.\nIn particular, for a brain MR scan, we first calculate three TDMs corresponding to gray matter (GM), white matter(WM) and cerebrospinal fluid (CSF) respectively, as commonly done in neuroimaging (Davatzikos et al., 2001 ) in order to quantify regional tissue volumes. The correlation coefficients on voxel u between TDMs and continuous clinical variables can be represented as:\nwhere j denotes the jth training sample; i = 1, 2, 3 represents GM, WM and CSF respectively; f j i (u) is a morphological feature of tissue i from the jth sample in the location u, and f i u \u00f0 \u00de is the mean of f j i (u) over all samples; r\u00afis the mean of all clinical variables r j . A watershed segmentation algorithm is then applied to the correlation map computed above, adaptively generating spatial clusters adaptively (Vincent and Soille, 1991; Grau et al., 2004) . Once these regional clusters are obtained, features can be computed from them. For example, the sum of tissue density maps represents the volume of the respective tissue within that cluster; the average image intensity within a cluster would be used for functional or molecular images. Note that we seek the maximal regional cluster size that maintains a strong correlation with the variable being estimated. With this we aim at better robustness and generalization of the estimators to be built from these features. Even though an individual voxel could display a very strong correlation with the clinical variable being estimated, it is unlikely that this same voxel will be a good feature for other samples. Larger clusters are more likely to represent true biological processes and to lead to robust and generalizable models."}, {"section_title": "Feature selection", "text": "Although the number of generated clusters is much smaller than the number of original voxels, measures from some regions are still irrelevant or redundant for regression. This requires a feature selection method to select a small subset of regional clusters in order to improve generalization performance of regression.\nIn this paper, we employ a common feature-ranking method based on correlation coefficients as calculated by Formulation (1). Generally, the feature ranking method computes a ranking score for each feature according to its discriminative power, and then simply selects top ranked features as final features. Considering the correlation coefficient has been successfully employed as a feature ranking criterion in a number of applications (Guyon and Elisseeff, 2003; Fan et al., 2007) , the absolute value of leave-one-out correlation coefficient is used here to rank features. We set the number of features as one less than the total number of training samples. Reverse feature elimination methods, like the one employed in Fan et al. (2007) , are likely to further improve feature selection, albeit at the expense of significantly higher computational load."}, {"section_title": "Relevance vector regression", "text": "In high-dimensional pattern regression, the most challenging task is to find a suitable model with good generalization and accurate estimation performance from small-sample data sets (relative to the dimensionality of input images). SVM is a popular method with a simple implementation and high estimating accuracy in many realworld applications (Vapnik, 1998 (Vapnik, , 2000 Cox and Savoya, 2003; Fan et al., 2007 Fan et al., , 2008 . It uses a kernel function to find a hyperplane that minimizes the deviation from the actually obtained targets for all training data. Despite its success, SVM has some limitations: firstly, it is not a very sparse model, because the number of support vectors typically grows linearly with the size of training samples. Secondly, the basis functions must be continuous symmetric kernels with a positive real coefficients under Mercer's conditions. Thirdly, SVM does not output the probability distribution of the estimated variable, and therefore does not provide an estimate of the error variance. These limitations have been overcome by RVM (Tipping, 2001) , which is formulated in a Bayesian estimation theory. RVM provides probabilistic prediction with a conditional distribution that allows the expression of uncertainty in estimation and prediction (Tipping, 2001) . Furthermore, RVM can employ arbitrary basis functions without having to satisfy Mercer's kernel conditions. SVM obtains sparsity by using the L 2 -norm as a regularizer defined in a reproducing kernel Hilbert space of the kernel functions. In contrast, the sparsity of RVM is induced by the hyperpriors on model parameters in a Bayesian framework with the Maximum A Posteriori (MAP) principle. L 1 -norm like regularization used in RVM provides significantly fewer basis functions, which is often important for good generalization. The reason is that L 1 -norm encourages the sum of absolute values, instead of squares of the L 2 -norm, to be small, which often drives many parameters to zero. L 1 -norm also has a greater resistance against outliers than L 2 -norm, since the effect of the outliers with a large norm is exaggerated by using L 2 -norm. Table 1 summaries these differences between RVM and SVM.\nRVM, originally introduced in the machine learning literature (Tipping, 2001 ), aims to find out the relationship between input feature vectors x = {x n } 1 N and the corresponding target values t = {t n } 1 N :\nwhere \u025b n is the measurement noise, assumed as independent, and to follow zero-mean Gaussian distribution, i.e., \u025b n \u223c N (0,\u03c3 2 ); y(x); is assumed as a linear combination of basis functions \u03d5(x, x n ) with the form:\nWhere W = (\u03c9 0 ,\u03c9 1 ,\u03c9 2 ,\u2026,\u03c9 N ) T is a weight vector. Assume t n is drawn from a Gaussian distribution with mean y(x n ) and variance \u03c3 2 , then\nwhere \u025b is a noise vector with elements \u025b n ; \u03a6 N\u00d7(N+1) is the design matrix, wherein \u03a6 ij = \u03d5(x i , x j ), i = 1,\u2026, N; j = 0,\u2026,N, and \u03d5(x i , x 0 ) = 1. Assuming statistical independence of the samples, t n , the maximum likelihood estimate for W is given by:\nwhich is known as the common least square estimate, and suffers from over-fitting. To over-come this problem, a desired constraint on the model parameters W is necessary. Therefore, sparsity-inducing hyperprior within a principled Bayesian MAP methodology is introduced to provide such constraint, which not only leads to smooth function estimate, but also drives many weight parameters into zeros. For more details, see Appendix A, \"Further details of relevance vector learning\".\nBagging framework for building ensemble regression models\nAs described earlier, a fundamental challenge for pattern regression by machine learning algorithms lies in the small size and the high dimensionality of the input data. Samples of small size, relative to the input dimensionality, are typically insufficient to extract discriminative features with good generalization ability when the underlying patterns are complex, i.e. require many variables to be described effectively. Hence, features extracted from limited training data sets often lead to \"unstable\" regression models, where small changes in the samples result in large changes in regression performance, even though RVR is known to be very sparse. In order to improve the stability of regression, we use bagging (bootstrap aggregating)-based RVR, which has been successfully applied in brain image classification (Fan et al., 2008) .\nGiven a set of bootstrap samples {L 1 , i = 1,\u2026l} generated from the training set, and a number of base models {f 1 , i = 1,\u2026l} from {L 1 , i = 1,\u2026l}, a bagging regression model can be constructed:\nwhere \u2211 i=1 l a i = 1, and a i \u2265 0, i = 1, \u2026 l, are weighting factors for base models. The weights can be simply set as 1/l, or values reflecting the performance of base models. It has been shown both empirically and theoretically that bagging improves the Mean Squared Error (MSE) for \"unstable\" regression models whereas it remains roughly the same for \"stable\" ones (Breiman, 1996a) . Furthermore, if the bootstrap samples are generated by leaving out part of the training data, the left-out data can be used to estimate the performance of base models, which can be subsequently used to select the optimal parameters of learning algorithms (Breiman, 1996b) . This is a valuable byproduct of bagging, besides its primary purpose to increase estimation accuracy, especially in the applications with limited samples.\nTo generate multiple versions of the training set, a leave-k-out bootstrap sampling scheme is used in this paper due to the limited availability of training data. For a training set with n samples, A succession of different bootstrap training sets are generated and each of them has (n-k) samples. Based on each bootstrap training set, a RVR model, denoted as the base regressor, is trained based on the extracted features. Then RVR parameters are determined by optimizing the performance of base models on the left-out training data. The optimal regressors are then applied to the test samples. In current work, Gaussian Radial Basis Function (GRBF) is used to map the original features to the infinite-dimensional kernel space. MSE is used to measure the performance of a regression model:\nwhere (x i \u204e , t i \u204e , i = 1,2,\u2026n \u204e ) is the testing set."}, {"section_title": "Data and applications", "text": "To evaluate the regression performance of bagging based RVR, we use images from two sources: simulated data and real data."}, {"section_title": "Simulated data", "text": "Simulations allow us to generate images with local thinning in a precisely known relationship. To simulate atrophy of the brain cortex, we simulated twenty shapes {S n , n = 1, \u2026 20}, each of which represents an individual subject with increasing level of thinning in some regions. In practice, the regions and atrophy rates might be different from one subject to another. Towards this goal, for each shape S n , we create ten \"follow-up\" images that have region shrinkage within three different areas according to pre-specified rates. Therefore, we totally have two hundred images with their corresponding target values: {I nj , T nj , n = 1, \u2026 20, j = 1, \u2026 10}. This simulation process is detailed next:\nStep 1: Based on the initial shape, create twenty different shapes by applying small random geometrical transforms: {S n , n = 1,\u202620};\nStep 2: For each shape S n , randomly select the locations of the center of three areas, and assign the respective size of each of them; thereby generate three regions {R i , i = 1, 2, 3} to represent the areas of pathology (thinning in this case);\nStep 3: For each region R i , define a 10-dimensional vector {V ij = (v i,1, \u2026,v i,10 )} associated with increasing thinning rates, and 0 \u2264 v i,1 b \u2026 b v i,10 b 1; then implement morphological operations on each region until the given rates are met;\nStep 4: Define the exact (actual) value of the target variable for each image as follows:\nwhere m is constant coefficient, AreaR 1 , AreaR 2 and AreaR 3 represent these three regional sizes, respectively. It will be tested whether our algorithm can accurately discover the relationship between the images and target variables (regressors), without knowing the regions R 1 , R 2 and R 3 or the actual relationship in Eq. (8). Fig. 2 illustrates an example of the thinning simulation in detail."}, {"section_title": "Real data", "text": "Real data are brain MR images from the Alzheimer's Disease Neuroimaging Initiative (ADNI) (ADNI, 2004; Jack et al., 2008) . They are standard T1-weighted MR images acquired using volumetric 3D MPRAGE with 1.25 \u00d7 1.25 mm in-plane spatial resolution and 1.2 mm thick sagittal slices from 1.5T scanners. To ensure consistency among scans, all downloaded images were preprocessed by GradWarp (Jovicich et al., 2006) , B1 non-uniform correction , and N3 bias field correction (Sled et al., 1998) . General information is detailed under the ADNI website.\nThe goal of regression is to discover the potential relationship between brain atrophy patterns and clinical stage of the disease, the latter being linked to some clinical variables. The proposed method is measured by two continuous clinical scores: MMSE and Boston Naming Testing (BNT), which are reliable and frequently used in the evaluation of Alzheimer's disease (Modrego, 2006; Petersen et al., 2001; Tombaugh and McIntyre, 1992) . The total scores for the MMSE and BNT range from 0 to 30, and the lower scores indicate more severe cognitive impairment.\nSince the follow-up interval of ADNI is 6 months, to get robust and stable regression results, at least two follow-up scans besides baseline scanning are required during sample selection. However, the ADNI dataset has more Mild Cognitive Impairment (MCI) patients than AD and Cognitively Normal (CN) subjects. To avoid underweight the relatively fewer samples with very high or very low clinical score, we uniformly sample the cases from the entire range of clinical variables. Note that, only baseline scans are used in experiments, but in order to remove the noise that is commonly encountered in measuring the MMSE scores, the mean of all the measured scores from baseline and each follow-up scanning is taken as the corresponding regressor for each subject. We have two reasons for doing this. Firstly, the individual cognitive evaluations are known to be extremely unstable and depend on a number of factors unrelated to the underlying brain pathology; secondly, the proposed methodology emphasizes the prediction ability of the regressor at baseline rather than from longitudinal scans. Despite that the baseline scan with the averaged clinical variables is not the optimal way, it was one of the best solutions we found to remove random variations in the cognitive measures, especially in the study with short clinical follow-up period.\nIn this paper, 23 AD patients, 74 patients with MCI and 22 CN subjects are included for MMSE, while 22 ADs, 31 MCIs and 16 CNs for BNT. More participant information is shown in Table 2 . We also provide the lists of these samples with Tables 5 and 6 in the Appendix C."}, {"section_title": "Experimental result analysis", "text": ""}, {"section_title": "Simulated clinical stage estimation", "text": "Simulated shapes were first employed to evaluate the performance of RVR by using four feature extraction methods via leave-10-out cross-validation. As indicated in Simulated data, there were 200 images (20 subjects, each of them has ten follow-up images) in simulated data, 190 images (19 subjects) of which were used to construct four feature subspaces based on regional clusters. The training data and testing data (10 images) were then projected to these subspaces for their corresponding feature extraction. This process was repeated 20 times, each time leaving out 10 different samples. For each time, regression models were trained using Gaussian kernel-based RVR, and model parameters were optimized by bagging framework with the second leave-10-out cross validation (each time 10 training samples from the same subject were left out to create a training subgroup L i ).\nTo get suitable RVR models, different kernel sizes were tested to determine the appropriate range, in which the optimal regression performance can be achieved robustly. Firstly, a wide range from 2 to 1024 was scanned in order to find out the suitable kernel sizes for our regression problem, and then the ranges around these sizes were refined to select the relatively stable sizes. From the middle graph of Fig. 3 , MSEs ranging from 0.002 to 0.014 were taken as kernel sizes varied from 2 to 1024. The lowest MSE was obtained when kernel size was 512. To avoid local minima, four kernel sizes (16,128,512 and 1024) were selected for further refinement, and the corresponding MSEs are illustrated respectively in the small graphs of Fig. 3 . Obviously, although regression accuracy fluctuates greatly at the smaller values of kernel sizes (graph 1), in the other three ranges, the regression accuracy curves are very smooth (graphs 2, 3 and 4). Especially during the range from 412 to 592, MSEs are lower than 0.002. It can thus be concluded that, RVM is a stable regression model within a reasonable range of kernel sizes. In general, avoiding the relatively smaller kernel sizes is advisable since they lead to overtraining. For comparison purposes, GRBF-kernel based SVR with \u025b-insensitive loss function was also tested by the same leave-10-out crossvalidation procedure, as we described in the RVR case. Besides kernel function parameters, two more SVR parameters, namely C and \u025b, were optimized within the bagging framework based on the training data. C is the tradeoff parameter between the smoothness of the SVR function and the training error, and \u025b is the error insensitivity parameter, i.e., the training error below \u025b will be treated as zero (Vapnik, 2000; Smola and Sch\u00f6lkopf, 2004) . In the training process, the performance of base regression models was evaluated within the bagging framework, with respect to different parameters (Chang and Lin, 2001) . From the regression results summarized in Table 3 , regional feature-based regression got the highest correlation and the smallest estimation error. Meanwhile, regression by means of LDA and PCA features overall achieved reasonable accuracy, while ISOMAP features performed the worst.\nThe detailed regression results are illustrated by Fig. 13 in Appendix B, in which the first row shows the estimated scores by SVR and RVR respectively with regional features. The other three rows summarize the regression results based on LDA, PCA and ISOMAP features, where RVR is shown on the left side and SVR on the right. Note that, the regression lines are shown with black solid lines.\nIn order to verify the validity of our learning algorithm, a discriminative direction method is applied to display the changing regional features found by the regressor (Golland et al., 2002) . This method provides a group difference map, indicating the degree that each regional feature participates in regression estimation. A leaveone-out validation is performed in our experiments for testing the generalizability of RVR, and the group difference will be evaluated by averaging all group difference maps obtained from all leave-oneout cases. First, for each relevance vector in each leave-one-out case, we investigate its corresponding projection vector in the highdimensional space. The rule is to follow the steepest gradient of regressor from small to large values. The difference between this relative vector and its corresponding projection vector reflects the changes on the selected regional features. These features become typical when a normal brain gradually changes to the respective configuration with disease progression. Second, an overall group difference vector can be obtained by summing up all regional differences calculated from all relative vectors. Finally, the group difference vector is mapped to its corresponding brain regions in the template space and subsequently added to other leave-one-out repetitions. Referring to Fig. 4 , our regression algorithm captures the significant features of brain image with the increasing regressor value, similar with our pathology areas simulated in Stimulated data."}, {"section_title": "Clinical stage estimation GM based regression with ADNI data", "text": "Since RVR showed high estimation accuracy and robustness with simulated data, similar experiments were carried out using clinical images from ADNI. Images were first preprocessed into tissue density maps as described in Davatzikos et al. (2001) . Aiming to improve the robustness of local TDMs, a 8-mm full-width at halfmaximum Gaussian smoothing was applied to all the images in the experiments. For simplicity, only gray matter after tissue segmentation was used to investigate regression performance of the methods mentioned above. Different from simulated data, leaveone-out cross-validation scheme was performed to test RVR performance on real data. For 119 samples selected from ADNI data, 118 samples were taken as training set for feature extraction and bagging-based model building, and the one left was chosen as testing sample to evaluate regression performance. This process was repeated 119 times, and each time ensemble regressors were trained by bagging framework via the second leave-10-out cross-validation within the training set.\nWe compared our method with SVR based on different feature extraction approaches in the same experiment setting. As illustrated in Fig. 5 , there are four rows with double columns to show estimated MMSEs by RVR and SVR combining regional features, LDA, PCA and ISOMAP features, respectively. Although estimation performance was not as good as that of simulated data, we still obtained the promising results for real data. The best result was adaptive regional featurebased RVR with correlation 0.73868.\nFor BNT score, although the best estimation accuracy was also obtained by RVR and regional features as shown in Fig. 6 , the overall regression performances for BNT was lower than those for MMSE. Even in the best case, the correlation coefficient between estimated BNT and measured BNT was only 0.58908. This inferior performance might be due to the comparatively small size of samples used for BNT, which are too limited to ensure efficient feature extraction and stable model parameter selection (there are 119 samples in MMSE set, but only 69 in BNT set). No matter which feature extraction method was applied, RVR always obtained more accurate estimation with higher correlation than SVR. The reason is likely to be that fewer Relevance Vectors (RVs) are used in RVR, and thus RVR has better generalization ability, which leads to more accurate estimation, especially when only limited training samples are available. To further investigate the generalization ability of RVR and SVR, we designed the following experiment: we initially chose 10 training samples from MMSE- based ADNI data, then added 10 new samples each time and recorded the number of RV and Support Vectors (SVs) after the learning process. Regional clusters and LDA features were selected for these experiments. The generalization performance of RVR/SVR under regional and LDA features is summarized in Fig. 7 , in which the blue curves correspond to RVR while the red curves are for SVR. It is evident from the figures that, for both regional and LDA features, the number of RVs/SVs increases with the changes of the number of training samples. However, the number of RVs is always smaller than that of SVs, especially for smaller sample sizes. This just confirmed the theoretic analysis of sparsity expected from these two regression methods. Experimental results also demonstrate that the number of RVs with LDA-based features is always smaller than that of regional features. Theoretically, LDA feature-based regression should result in better generalization ability since it needs fewer RVs. Nevertheless, LDA feature-based regression got inferior estimation performance while regional feature-based regression obtained lower MSE and higher correlation coefficient (Fig. 5) . The reason might be that regional feature clusters could be more informative, since AD pathology tends to have a regional distribution."}, {"section_title": "GM, WM and CSF based regression", "text": "AD is associated with brain volume loss of gray matter, but white matter and CSF might also carry significant information. In this section, we tested RVR on the combined tissues of GM, WM and CSF by the same experiment setting as we did with GM alone. As can be seen from Fig. 8 , RVR with regional features has the highest correlation and lowest MSE, followed by SVR with regional features. Regarding all experimental results in Simulated clinical stage estimation and GM based regression with ADN data, regional feature-based regression is superior to regression methods based on other feature extraction schemes. It proved that adaptive regional clustering is the best feature extraction method for both RVR and SVR in our experiments.\nTo compare the performance between GM-based regression and three tissue (GM, WM and CSF)-based regression methods in an organized way, Table 4 was constructed to record the numerical results appearing in Fig. 8 and Fig. 5 , where the best results of each category are marked in blue. For both RVR and SVR, there were marginal improvements with regression performance based on three tissues compared to GM only, possibly because any additional information gained from WM and CSF is either marginal or counterbalanced by the curse of dimensionality issue. The best correlation coefficients and MSE between clinically measured and estimated MMSE scores are 0.75775 and 10.8338 from three tissue-based RVR with regional features, while 0.73868 and 11.5445 for GM-based RVR.\nIn view of the superior performance of RVR, more detailed results from it are illustrated by Fig. 9 . For each different feature extraction method, histograms of MSE and correlation coefficients clearly indicate the better regression performance of RVR by using GM, WM and CSF than GM only, albeit the improvement is marginal. Another interesting result is that, when MMSEs range from 25 to 30 (most of them are the normal control cases), our proposed method is not sensitive to them, as shown in Figs. 5 and 8. The reason is likely to be that in those mostly normal subjects, variability in clinical scores can be attributed to measurement error and \"bad testing days,\" both of which are well known in this field. For MCI and AD patients, however, the decline in cognitive ability is due to a large extent to underlying pathology and brain atrophy, which is measured by our algorithm. However, regression using all three tissues improved the estimation accuracy of MMSE in this range (comparing the results as shown in Figs. 5 and 8 ). To account for this improvement in a detailed way, we plot the distribution histograms of estimated MMSEs by RVR from three tissues and GM, respectively. As illustrated by the purple rectangles in Fig. 10 (interval scale is 1) , we can see that most estimations for MMSEs ranging from 25 to 30 are around 26, as shown in the middle graph of Fig. 10 . In contrast, three tissue-based regression got a more even estimation distribution from 26 to 28, which means they are correctly estimated by comparing with the clinical measured MMSEs (the left graph of Fig.  10 ). These results indicate additional information can provide more structural patterns, and thus improve regression accuracy. We expect that this result will hold even more strongly for large sample sizes."}, {"section_title": "Predicting future decline from baseline scans", "text": "Patients with MCI are at high risk from conversion to AD; they generally tend to progress to AD at a rate of about 15% annually. Therefore, it is of great clinical interest to be able to predict which of the MCI individuals are likely to progress rapidly and decline cognitively, using their baseline exams. We address this problem in the following set of experiments, by attempting to predict future decline in MMSE, by applying our approach to baseline MRI scans.\nA large part of the available ADNI images are from patients who did not display significant cognitive decline, and would overwhelm the regression algorithm if all used in the current experiment. We therefore randomly selected a representative subset of individuals spanning the entire range of MMSE decline in a relatively uniform way. In other words we selected a mix of individuals from ADs and MCIs, who are supposed to display variable degrees of MMSE change. In particular, we ended up with 26 patient samples with stably degenerative variance during longitudinal study. Our cohort is composed of 16 MCI-converters (diagnosed as MCI at the baseline scanning, and then progressed to AD at 6-month follow-up), 5 MCInonconverters and 5 AD. A list of sample IDs could be found in Table 7 of Appendix C.\nAlthough feature ranking has been used to select the optimal regional features based on the correlation coefficients among brain regions, some redundant features can be inevitably selected, which ultimately decrease the regression results. Moreover, ranking-based feature selection method is subject to local optima, especially when the size of training samples is small. Therefore, we firstly used the proposed correlation-based feature ranking method to select the most relevant features, and then applied the RVR-based Recursive Feature Elimination (RVR-RFE) algorithm to further optimize the set of initial regional features for good regression performance. This algorithm was inspired by the Support Vector Machine-Recursive Feature Elimination (SVM-RFE) approach (Guyon et al., 2002; Rakotomamonjy, 2003; Fan et al., 2007) , which includes backward Table 4 Numerical results for three tissue-based regression, and only GM-based, by RVR and SVR, with four feature extraction methods. Fig. 9 . Histograms of MSEs and correlation coefficients for RVR with four different feature extraction methods performed on two information source: three tissues and GM only."}, {"section_title": "Data and methods", "text": ""}, {"section_title": "Features", "text": "and forward steps. During the backward sequential selection, at each time, one feature is removed to make the variation of RVR-based leave-one-out error bound smallest, compared to removing other features. To avoid missing informative features whose ranks are low, but perform well jointly with the top ranked features for regression, a forward sequential feature selection method is used for compensation. This step adds one feature back at a time. Each time the added feature makes the variation of RVR-based leave-one-out error bound smallest, compared with adding other features. The search space of the forward selection is limited to a predefined feature subset in order to obtain a solution with cheaper computation cost.\nIn each leave-one-out validation experiment, one subject was first selected as a testing subject, and the other subjects were used for the entire adaptive regional feature extraction, feature selection, and training procedure, as described in framework Fig. 1. Fig. 11 illustrates the results of estimating the change and the rate of clinical variable change.\nNote that the progression estimation results for MCI or AD patients are worse than the clinical stage prediction as discussed in Clinical stage estimation. The reason might be that, we have such assumption as follows on progression estimation: the rate of MMSE declines linearly along with brain volume atrophy for MCI and AD patients over longitudinal progression. Unfortunately, in our study, most samples are recorded within no more than three years, and also there are so many non-clinical factories that influence cognitive function testing, and all these factors will undermine the prediction results to some extent.\nThe group difference maps for all these clinical variable (MMSE, BNT and MMSE change) regression are shown in Fig. 12 , which shows the brain regions that collectively contributed to the regression. The color scale indicates the frequency that brain regions were used in bagging regression experiments with different ADNI data. These figures reveal that brain atrophy patterns highly correlated with clinical scores are complex. However, we can see that, most of the group difference locations are consistent with previous clinical findings and computational analysis, such as the hippocampus, which plays a crucial role in memory processes, and usually is taken as a biomarker of early AD."}, {"section_title": "Discussions and conclusion", "text": "This paper presented a general regression methodology by utilizing RVR with regional features to estimate continuous clinical variables from high-dimensional imaging patterns. The proposed method was validated on simulated datasets with known truth, where it was found to have excellent ability to estimate the relationship between the input patterns of atrophy and the output scalar score, when a very consistent relationship exists. It was also applied to data from the ADNI study.\nIn order to achieve a reasonably low dimensionality, a regional feature extraction methodology was used to sample spatial imaging patterns. Regions that correlated well with the estimated variables are sampled and integrated via a sparse regressor. Robustness and good generalization were achieved by a bagging methodology used on both the feature selection and the regression model construction. Alternative dimensionality reduction methods were also investigated, however the regional features provided the highest estimation accuracy.\nWe compared two pattern regression methods: RVR and SVR, which is a regression counterpart of the popular SVM classifier. RVR slightly outperforms SVR, and achieves robust estimation for different clinical variables. The best correlation between the estimated and the measured MMSE scores was around 0.73 obtained by using regional features. This correlation is as good as our expectation, in view of the significant noise present in cognitive measurements. Estimating BNT was quite promising, in the case of the limited data set. Our result also indicated that, pattern regression can predict future cognitive decline only by using baseline scans. Moreover, group difference maps could provide the most significant brain regions with respect to disease progression, which emphasizes the potential clinical importance of the proposed approach to find relatively early markers of structural brain changes.\nSome of the conclusions concerning these methods combining different feature extraction and model learning approaches are discussed next."}, {"section_title": "Discussion on feature extraction", "text": "\u2022 PCA features are good at capturing general variance of the data, however, they might miss directions with particularly good estimation value for the regressor, even though one would expect high variance along these directions. Moreover, PCA is unable to capture sufficient information from a small set of samples with extremely high-dimensional patterns, since it is limited by the number of samples. This is why PCA feature-based regression achieved acceptable performance when relatively larger training data sets were available (simulated data and MMSE estimation), but failed at BNT estimation.\n\u2022 LDA is a better way to extract discriminative information because of its discriminatory nature. However, a number of pattern categories involved in the construction of the feature space is required before feature extraction (each corresponding to a different range of the regressor). Generally, this parameter was fixed according to prior knowledge of the disease under study. Hence, the lack of automatic parameter selection in LDA influences the further regression accuracy and limits its applicability.\n\u2022 PCA and LDA have a common disadvantage that they assume data is linearly separable, however, this is not necessarily the case for most real-world problems. To address this problem, we tested a nonlinear manifold method, ISOMAP, but it did not work very well in most experiments. The reason is that, the success of ISOMAP depends on the correct computation of geodesic distances, which are approximated by the length of the shortest path between pairs of samples on a neighborhood graph. However, either K-NN or \u025b-neighbor approach is only valid when the training samples are dense enough. Undersampling of nonlinear manifolds results in erroneous connections when constructing the neighborhood graph, and finally lead to unstable manifold topology. In practice, for real image data, it is hard to preserve topological stability because of noise and outliers, especially for high-dimensional but limited sample. Consequently, ISOMAP failed in BNT estimation, and got the worst results in most experiments.\n\u2022 Different from PCA, LDA and ISOMAP, the regional clustering method computes volumetric measures by adaptively grouping brain voxels into different regions based on the spatial consistency of brain structure, which is determined by the correlation between voxel-wise features and the continuous clinical scores being regressed. Thus, in theory, regional features are more discriminative and robust to the impact of noise and registration errors. In practice, taking all the experimental results into account, regional features outperform these three popular feature extraction methods, even in the very limited case, BNT estimation. However, these regional features were initially selected one by one in sequence. Therefore, if a collection of regions of weak individual estimation value, but of high collective value, exists in the data, it might be missed. Fully multivariate construction and selection of features is an extremely difficult problem for high-dimensional machine learning setting. Some recent formulation using nonnegative matrix factorization might offer promising finding in the future (Batmanghelich et al., 2009) ."}, {"section_title": "Discussion on sparse model", "text": "A sparse model is also essential to get good generalization ability. To compare sparsity between SVR and RVR, many experiments were designed and analyzed in Experimental result analysis. From these experimental results, RVR was found to be a superior regression method with higher diagnostic power and better generalization ability. Although SVR achieved reasonably good performance both in simulated data and real data, it is less sparse than RVR. In practice, many more support vectors were used in SVR than relevance vectors were used in RVR, and the difference increased quickly as the size of training samples grew. The reason is that the parameters of RVR are optimized by the principled Bayesian formulation with hierarchical hyperprior distributions, which leads to significantly fewer relevance vectors, thereby improving generalization ability. As discussed in Simulated clinical stage estimation with Fig. 3 , our experiments also indicated that RVR is a stable regression method within a wide range of kernel sizes, in which estimation accuracy of continuous clinical scores varies smoothly. Even if discriminative regional features and sparse regression model are used, it is still difficult to build a robust regressor, since there are relatively few sample with high dimensionality. Although our sample sizes might be adequate for classification, they are very limited for regression, especially in the case of progression estimation. To improve the robustness of regression models, a bagging framework with cross-validation is used to facilitate model parameter optimization, and to model expected variations in the training and testing images. By combining the outputs of multiple regressors learned from the subsets of training data, bagging based regression method can efficiently remove the influence of outliers.\nIn summary, bagging-based RVR with regional features was found to be a superior regression method in our experiments. Although this regression scheme is developed based on AD imaging data, it can be adapted and extended to other imaging problems. In the future, we plan to try Boosting-based algorithms in model learning, which are supposed to reduce both the bias and variance of unstable methods. Moreover, feature selection method with lower computation cost and better representation ability should be investigated, which is generally believed as a better way to improve model accuracy.\nAppendix B. Regression results based on simulated data (Fig. 13 Table 7 ADNI subject IDs used in future decline prediction."}]
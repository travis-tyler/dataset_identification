[{"section_title": "Abstract", "text": "Using image-based descriptors to investigate clinical hypotheses and therapeutic implications is challenging due to the notorious \"curse of dimensionality\" coupled with a small sample size. In this paper, we present a low-dimensional analysis of anatomical shape variability in the space of diffeomorphisms and demonstrate its benefits for clinical studies. To combat the high dimensionality of the deformation descriptors, we develop a probabilistic model of principal geodesic analysis in a bandlimited low-dimensional space that still captures the underlying variability of image data. We demonstrate the performance of our model on a set of 3D brain MRI scans from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database. Our model yields a more compact representation of group variation at substantially lower computational cost than models based on the high-dimensional state-of-the-art approaches such as tangent space PCA (TPCA) and probabilistic principal geodesic analysis (PPGA)."}, {"section_title": "Introduction", "text": "Shape analysis is critical for image-based studies of disease as it offers characterizations of anatomical variability between different groups, or in the course of a disease. Analysis of shape changes can provide new insights into the nature of the disease and support treatment. For example, brain atrophy has been identified in patients affected by neuro-degenerative diseases such as Parkinson's, Huntington's, and Alzheimer's [5, 10] . When combined with other clinical information, characterization of shape differences between clinical cohorts and a healthy population can be useful in predicting disease progression. Landmarks [3] , distance transforms [6, 9] , and medial cores [11] are examples of image-based shape descriptors often used in medical image analysis. Most of these descriptors require informative feature points or a segmented binary image as input to the shape extraction procedure. In this paper, we focus on diffeomorphic transformations estimated from full images as a way to represent shape in a group of images [12, 14] .\nThe high-dimensional nature of the data (e.g., a 128 3 displacement grid as a shape descriptor for a 3D brain MRI) presents significant challenges for the statistical methods when extracting relevant latent structure from image transformations. The barriers for effective statistical analysis include (i) requiring greater computational resources and special programming techniques for statistical inference and (ii) numerous local minima. Two main ways of overcoming this problem via data dimensionality reduction have been recently proposed in the diffeomorphic setting. One is to perform statistical modeling of the transformations as a step that follows the estimation of deformations, for instance, by carrying out principal component analysis (PCA) in the tangent space of diffeomorphisms (TPCA) [14] . An empirical shape distribution can be constructed by using TPCA to estimate the intrinsic dimensionality of the diffeomorphic surface variation [12] . Later, a Bayesian model of shape variability was demonstrated to extract the principal modes after estimating a covariance matrix of transformations [7] . Alternatively, one could infer the principal modes of variation and transformations simultaneously. Principal geodesic analysis (PGA) generalized PCA to finite-dimensional manifolds and estimated the geodesic subspaces by minimizing the sum-of-squared geodesic distances to the data [4] . This enabled factor analysis of diffeomorphisms that treats data variability as a joint inference problem in a probabilistic principal geodesic analysis (PPGA) [17] . While these models were designed to find a concise low-dimensional space to represent the data, the estimation must be performed numerically on dense image grids in a high-dimensional space.\nIn contrast, we use the finite-dimensional representation of the tangent space of diffeomorphisms [18] to investigate shape variability using bandlimited velocity fields as a representation. We call this approach low-dimensional probabilistic principal geodesic analysis (LPPGA). We define a low-dimensional probabilistic framework for factor analysis in the context of diffeomorphic atlas building. Our model dramatically reduces the computational cost by employing a low-dimensional parametrization in the Fourier space. Furthermore, we enforce the orthogonality constraints on the principal modes, which is computationally intractable in high-dimensional models like PPGA [17] . We report estimated principal modes in the ADNI brain MRI dataset [8] and compare them with the results of TPCA and PPGA of diffeomorphisms in the full dimensional space. The experimental results show that the low-dimensional statistics encode the features of interest in the data, better capture the group variation and improve data interpretability. Moreover, our model requires much less computational resources."}, {"section_title": "Diffeomorphic Atlas Building with Geodesic Shooting", "text": "We first briefly review the mathematical background of diffeomorphic atlas building in the setting of large deformation diffeomorphic metric mapping (LDDMM) [1] with geodesic shooting [15, 16] .\nWe let J 1 ,\u22ef, J N be the N input images that are assumed to be square integrable functions\nWe use I to denote the atlas template and \u03d5 n to denote the deformation from template I to image J n . The time-varying deformation \u03d5 n (t, x) : t \u2208 [0,1],x \u2208 \u03a9 is defined as the integral flow of time-varying velocity field v n (t, x) in a reproducing kernel Hilbert space V:\nThe geodesic path of the deformation is uniquely determined by integrating the EulerPoincar\u00e9 differential equation (EPDiff) [18] with an initial condition of v n (t, x) at t = 0:\nwhere D is the Jacobian matrix and \u00f7 is the divergence operator. The operator is the inverse of a symmetric, positive-definite differential operator that maps a velocity field v n \u2208 V to a momentum vector m n \u2208 V* such that and . This process is known as geodesic shooting [15, 16] .\nWith a slight abuse of notation, we define \u03d5 n = \u03d5 n (1, \u00b7), v n = v n (0, \u00b7), allowing us to drop the time index in the subsequent derivations. Geodesic shooting (1) enables differentiation of the image differences with respect to the initial velocity field, leading to a gradient decent minimization of the energy function (2) where \u03c3 2 is the image noise variance. In this paper, we use , where \u0394 is the discrete Laplacian operator, e is the identity matrix, c is a positive scalar controlling smoothness, and \u03b1 is a positive regularity parameter. The notation (\u00b7,\u00b7) denotes the pairing of a momentum vector with a tangent vector, similar to an inner product.\nIt has been recently demonstrated that the initial velocity v n can be efficiently captured via a discrete low-dimensional bandlimited representation in the Fourier space [18] . We adopt this low-dimensional representation for statistical shape analysis."}, {"section_title": "Generative Model", "text": "We build our generative model in the discrete finite-dimensional space that represents bandlimited velocity fields. Elements of this space are complexvalued vector fields in the Fourier domain that represent conjugate frequencies:\n, where is the Fourier basis that maps from the frequency domain to the image domain.\nLet be a matrix in the Fourier space whose q columns (q < N) are orthonormal principal initial velocities in a low p-dimensional space (p \u226a d), \u039b \u2208 \u211d q\u00d7q be a diagonal matrix of scale factors for the columns of , and s \u2208 \u211d q be a vector that parameterizes the space of transformations. The initial velocity is therefore represented as in the lowdimensional space. Assuming i.i.d. Gaussian noise on image intensities, we obtain (3) "}, {"section_title": "Inference", "text": "We use alternating gradient accent to maximize the posterior probability (5) with respect to the model parameters and latent variables {s 1, \u22ef,s N }.\nBy setting the derivative of Q with respect to I and \u03c3 to zero, we obtain closed-form updates for the atlas template I and noise variance \u03c3 2 :\nTo estimate the principal initial velocity basis , the scaling factor \u039b, and the loading coefficients {s n }, we follow the derivations in [18] and first obtain the gradient of Q w.r.t.\nthe initial velocity as follows:\nZhang et al. Page 4 i.\nForward integrate the geodesic evolution equation (1) to generate time-dependent diffeomorphic deformation \u03c3 n (t,x)."}, {"section_title": "ii.", "text": "Compute the gradient at time point t = 1 as (6) iii.\nBackward integrate the gradient (6) to t = 0 to obtain .\nAfter applying the chain rule, we have the gradient of Q for updating the loading factor s n :\nThe gradients of Q w.r.t.\nare given as follows:\nUnlike the PPGA model [17] , we can readily enforce the mutual orthogonality constraint on the columns of Here, we choose to employ Gram-Schmidt orthogonalization [2] on the column vectors of in a complex inner product space."}, {"section_title": "Results", "text": ""}, {"section_title": "Data", "text": "To evaluate the effectiveness of the proposed low-dimensional principal geodesic analysis (LPPGA), we applied the algorithm to brain MRI scans of 90 subjects from the ADNI [8] study, aged 60 to 90. Fifty subjects have Alzheimer's disease and the remaining 40 subjects are healthy controls. All MRIs have the same resolution 128 \u00d7 128 \u00d7 128 with the voxel size of 1.25 \u00d7 1.25 \u00d7 1.25mm 3 . All images underwent skull-stripping, downsampling, intensity normalization, bias field correction, and co-registration with affine transformations."}, {"section_title": "Experiments", "text": "We first estimate a full collection of principal modes q = 89 for our model, using \u03b1 = 3.0, c = 3.0 for the operator with p = 16 3 dimensions of initial velocity , similar to the settings used in pairwise diffeomorphic image registration [18] . The number of time steps for integration in geodesic shooting is set to 10. We initialize the atlas I to be the average of image intensities, \u039b to be the identity matrix, s n to be the all-ones vector, and the initial velocity matrix to be the principal components estimated by TPCA [14] . We then compare the results with PPGA [17] and TPCA on the same dataset. In order to conduct a fair comparison, we keep all the parameters including regularization and time steps for numerical integration fixed across the three algorithms. To evaluate the model stability, we randomly select 50 images out of 90 and rerun the entire experiment 50 times.\nTo investigate the ability of our model to capture anatomical variability, we use the loading coefficients s = {s 1 ,\u22ef,s N } as a shape descriptor in a statistical study. The idea is to test the hypothesis that the principal modes estimated by our method are correlated significantly with clinical information such as mini-mental state examination (MMSE), Alzheimer's Disease Assessment Scale (ADAS), and Clinical Dementia Rating (CDR). We focus on MMSE and fit it to a linear regression model using the loadings for all 90 subjects in the training dataset as predictors. Similar analysis is performed on the results of PPGA and TPCA. Figure 1 visualizes the first three modes of variation in this cohort by shooting the estimated atlas I along the initial velocities (a i = {\u22122, \u22121, 0,1, 2},i = 1, 2, 3). We also show the log determinant of Jacobians at a i = 2 (regions of expansion in red and contraction in blue). The first mode of variation clearly shows that changes in ventricle size is the dominant source of variability in the brain shape. The algorithm estimates standard deviation of the image noise to be \u03c3 = 0.02. Figure 2 reports the cumulative variance explained by the model as a function of the model size. Our approach achieves higher representation accuracy than the two state-of-the-art baseline algorithms across the entire range of model sizes. Table 1 compares the regression results of our model and the two baseline algorithms using the first principal mode. The higher F and R 2 statistics indicate that our approach captures more variation of the MMSE score than the other models. Table 1 also reports run time and memory consumption for building the full model of anatomical variability. It demonstrates that our approach offers an order of magnitude improvement in both the run time and memory requirements while providing a more powerful model of variability."}, {"section_title": "Experimental Results", "text": ""}, {"section_title": "Conclusion", "text": "We presented a low-dimensional probabilistic framework for factor analysis in the space of diffeomorphisms. Our model reduces the computational cost and amplifies the statistical power of shape analysis by using a low-dimensional parametrization. This work represents the first step towards efficient probabilistic models of shape variability based on highdimensional diffeomorphisms. Future work will explore Bayesian variants of shape analysis. A multiscale strategy like [13] can be added to our model to make the inference even faster. Left: cumulative variance explained by principal modes estimated through our method (LPPGA) and baseline algorithms (PPGA and TPCA). Right: number of principal modes that explain 90% and 95% of total variance respectively. "}]
[{"section_title": "Abstract", "text": "Abstract-Resting-state functional Magnetic Resonance Imaging (rs-fMRI) holds the promise of easy-to-acquire and widespectrum biomarkers. However, there are few predictivemodeling studies on resting state, and processing pipelines all vary. Here, we systematically study resting state functionalconnectivity (FC)-based prediction across three different cohorts. Analysis pipelines consist of four steps: Delineation of brain regions of interest (ROIs), ROI-level rs-fMRI time series signal extraction, FC estimation and linear model classification analysis of FC features. For each step, we explore various methodological choices: ROI set selection, FC metrics, and linear classifiers to compare and evaluate the dominant strategies for the sake of prediction accuracy. We achieve good prediction results on the three different targets. With regard to pipeline selection, we obtain consistent results in two pipeline steps -FC metrics and linear classifiers-that are vital in the diagnosis of rs-fMRI based disease biomarkers. Regarding brain ROIs selection, we observe that the effects of different diseases are best characterized by different strategies: Schizophrenia discrimination is best performed in dataset-specific ROIs, which is not clearly the case for other pathologies. Overall, we outline some dominant strategies, in spite of the specificity of each brain disease in term of FC pattern disruption."}, {"section_title": "I. INTRODUCTION", "text": "Resting-state functional magnetic resonance imaging (rsfMRI) is a non-invasive and easy-to-acquire modality. It provides measurements of brain function that can characterize a wide range of phenotypic traits [1] . Indeed, it has been used to discriminate neurological diseases and psychiatric disorders [2] , but also to predict different mental states [3] and has even been used as a unique fingerprint for each individual [4] . FC is also a potential biomarker for early diagnosis and disease progression. For this, analysis pipelines are used to estimate the connectome from rs-fMRI, and then to build a classification model that predicts the clinical group from the resulting FC estimates. Such a pipeline has been introduced in [5] , where sparse FC network estimates are used to classify subjects with major depression disorder from healthy subjects. A fully-automated pipeline has been proposed recently to highlight autism biomarkers [6] from large and multi-site autism datasets. The setting of an effective analysis pipeline requires to tune many parameters, either in the feature extraction or in the classification, in order to have the best possible prediction. Setting pipeline parameters is not straightforward and typically results into huge variations across datasets. In addition, it is not known to what extent an optimal pipeline setting for a given dataset can be reused for another dataset, and if there are some dominant strategies.\nWe study in this paper whether parameters can be reliably selected to answer diverse clinical questions based on FC measurements obtained from three different datasets. Our aim is to overcome the heterogeneity in the data, related to image quality or to the disease under study, by outlining consistent effects across large resting state FC datasets related to various psychiatric disorders. We compare the impact of each pipeline step on the prediction accuracy on these datasets that target different disease characterizations. This gives us a better understanding on what choices should be made to establish accurate diagnosis models of neuropsychiatric disorders. "}, {"section_title": "II. METHODS: CONNECTIVITY ANALYSIS PIPELINE", "text": ""}, {"section_title": "A. ROIs definition", "text": "The first step of the pipeline aims at reducing the dimensionality of the problem by aggregating voxels into ROIs forming an atlas. We use two kinds of approaches: i) reference atlases previously defined on other structural or functional datasets, and ii) atlases directly learned from the data. The question underlying atlas selection is whether different brain disorders lead to a consistent choice, and whether genericity should be preferred to adaptive strategies. Because we want to study the connectivity between spatially contiguous ROIs and not between brain networks, we use a Random Walker approach to segment ROIs in the models composed of networks (i. e. all except AAL and Ward) as proposed in [7] . During this procedure, we remove spurious regions (size < 1900mm 3 ). An example of the atlases obtained through dictionary learning is presented in Fig. 2 .\nPredefined atlases: We select two reference atlases learned on structural MRI and one learned on functional MRI. Automated Anatomical Labeling (AAL) [8] is an anatomical atlas of 116 regions obtained on a single subject. HarvardOxford (HO) [9] is a probabilistic cortical segmentation of 48 bi-hemispheric regions performed on 40 subjects. We extract Step 1 defines brain ROIs using predefined reference atlases or data-driven methods.\nStep 2 extracts time series from each ROI.\nStep 3 estimates pairwise functional connectivity between ROIs, using correlation, partial correlation or tangent space embedding. In step 4, a classification model is built to predict groups with two linear classifiers, SVC ( 1 or 2 penalization) and ridge regression ( 2 penalization).\n90 ROIs to study spatially contiguous regions. Bootstrap Analysis of Stable Clusters (BASC) [10] is a multi scale functional atlas estimated using K-Means clustering on rsfMRI dataset that consists of 43 healthy individuals. We use the 64 network atlas, yielding 97 ROIs.\nRegions extracted from the data: We use four data exploratory methods to segment ROIs from fMRI: i) two clustering approaches: K-Means and hierarchical agglomerative clustering using Ward's algorithm [11] , and ii) two data decomposition methods, namely multi-subject Independent Component Analysis (ICA) [12] and Online Dictionary Learning (DictLearn) [13] . "}, {"section_title": "B. Time-series signals extraction", "text": "In this step, we extract a representative time-series for each ROI in each subject. For atlases composed of non-overlapping ROIs, we simply compute the average of the fMRI time series signals over all voxels within that specific region. For fuzzy overlapping ROIs, such as the components extracted by ICA and DictLearn, we use least squares regression method to compute signals over several overlapping ROIs. The signal of each region is then normalized, detrended and bandpassfiltered between 0.01 and 0.1 Hz."}, {"section_title": "C. Functional connectivity estimation", "text": "FC is defined as the covariance between signals from brain ROIs. Given that the time-series are too short to estimate the true covariance matrix, we use a regularized shrinkage estimation. We choose the Ledoit-Wolf estimator [14] because it is parameter free and an efficient implementation is available in the scikit-learn library [15] . With this covariance structure, we study three different connectivity measures: correlation, partial correlation (from the inverse covariance matrix) [16] and the tangent embedding parametrization of the covariance matrix [17] ."}, {"section_title": "D. Connectivity-based classification", "text": "In the final step of our pipeline, we predict a binary phenotypic status from FC. We extract the lower triangular part of the connectivity matrix as a set of features for the prediction task [3] . We consider the Linear Support Vector Classifier (SVC) with 1 and 2 regularization and the Ridge Classifier with 2 penalization."}, {"section_title": "III. EXPERIMENTS ON MULTIPLE DATASETS", "text": ""}, {"section_title": "A. Datasets", "text": "We experiment our classification pipeline on three rsfMRI datasets. Models built from connectivity features predict various clinical outcomes (neuro-degenerative and neuropsychiatric disorders, drug abuse impact). The first dataset is from the Center for Biomedical Research Excellence (CO-BRE) [18] . The pipeline predicts the schizophrenia diagnosis of the subjects. The second dataset is the Alzheimer's Disease Neuroimaging Initiative (ADNI) [19] . We discriminate Alzheimer's Disease (AD) from Mild Cognitive Impairment (MCI) group. The third dataset is the Addiction Connectome Preprocessed Initiative (ACPI) 1 , where we discriminate Marijuana consumers versus control subjects.\nAll rs-fMRI acquisitions are preprocessed using standard steps that include motion correction, co-registration to T1-MRI, normalization to the MNI template, Gaussian spatial smoothing (FWHM=5mm), and temporal detrending. All subjects were visually inspected and excluded from the analysis if they had severe scanner artifacts or head movements with amplitude larger than 2mm. The total number of subjects then selected from COBRE, ADNI, ACPI are 81, 137, 126 respectively (table I). "}, {"section_title": "B. Experiment design", "text": "Classification setting: Our approach is a binary classification to predict the phenotype status. We set a cross-validation framework by randomly shuffling and splitting populations over 100 runs into 75% for training the classifier and testing on the remaining 25%. In each fold, we preserve the percentage of samples between groups. For each split, we measure the Area Under the Curve (AUC) from the Receiver Operating Characteristics (ROC) curve. The final prediction scores (more than 10k scores: 63 types of pipelines \u00d7 3 datasets \u00d7 100 splits) obtained across all datasets are used in a post-hoc statistical analysis to evaluate the importance of each step in our prediction model.\nPost-hoc analysis setting: We use a full factorial Analysis of Variance (ANOVA), with three major factors of importance: the atlas (AAL, Harvard Oxford, BASC, K-Means, Ward, ICA, DictLearn), the connectivity estimator (correlation, partial correlation, tangent space), and the classifier (svc 1 , svc 2 , ridge). For each factor, we compare the significance of each choice and its effect (positive or negative) on the classification performance.\nSoftware used: We use SPM8 for preprocessing, Nilearn [20] for feature extraction, Scikit-learn [15] for classification, and Statsmodels [21] for post-hoc comparisons."}, {"section_title": "IV. RESULTS AND DISCUSSION", "text": "We study the impact of each pipeline step on the model accuracy, and its consistency over diverse clinical questions.\nTo measure the impact of the different options on the prediction scores relative to the mean prediction, we perform a fullfactorial analysis of variance (ANOVA) on prediction scores. In a linear model, each step of the pipeline is considered as a categorical variable and its contribution is given by its coefficient. Fig. 3 gives the results on each dataset (on the right) and a summary analysis on the pooled data (on the left). Error bars give the 95% confidence interval.\nAcross all datasets, 2 -penalized classifiers clearly outperform 1 penalization. In addition, using the tangent embedding as a connectivity measure gives a consistent improvement over correlations and partial correlation.\nWith regards to functional regions, the trend is not as clear. The analysis across datasets (Fig. 3 right) reveals that the most effective atlases are those learned on functional data (BASC, ICA, Dictionary Learning). However, further dataset-specific analyses (Fig. 3 left) reveal some discrepancies across the datasets. One of the most striking observation is the inability of Harvard-Oxford to discriminate typical controls and schizophrenic patients (CO-BRE dataset). As an anatomical atlas, it lacks some crucial functional regions. Table II gives the accuracy and best strategy for selection of brain ROIs per dataset. Conclusions vary. Schizophrenic subjects (COBRE) are most easily discriminated with functionaldata-driven ROIs, whereas no such effect is observed in the other datasets (ADNI or ACPI). Note however that prediction accuracy is lower in these datasets.\nBrain atlases learned with BASC, ICA, or DictLearn consistently obtain high scores across different clinical questions and datasets. On the opposite AAL, K-Means, Ward, HarvardOxford have very uneven performance levels across target variables and datasets. We stipulate that the benefits of BASC, ICA, and DictLearn are not only that they use functional information to capture regions, but also that they rely on a probabilistic or soft-assignment model. Indeed BASC is obtained via bootstrapped clustering, and ICA or DictLearn are linear decomposition models. Interestingly, BASC was extracted from another dataset not included in our study, yet it achieves relatively good performance. This suggests that some aspects of a good set of regions carry over from one cohort to another. Indeed, the DictLearn atlases extracted on our three cohorts show high similarities with regards to the large networks that they outlined (see Fig. 2 )."}, {"section_title": "V. CONCLUSION AND FUTURE WORK", "text": "In this paper, we presented a functional connectivity-based analysis pipeline to predict diverse behavioral targets from rsfMRI data. Our contribution lies in the systematic exploration of commonly used models for each step of the pipeline and in the study of the impact of these steps on the prediction. We show guidelines for classifier selection and covariance estimation: Rely on 2 classifiers; Use the tangent space embedding of the covariance matrix. The brain atlas selection in the pipeline does not give a clear trend. Overall, functionally driven regions with Dictionary Learning, group ICA or BASC atlas perform well across datasets.\nFurther work calls for exploring more datasets to confirm trends on best-performing methods, as well as detailed investi- gation of functional-connectivity differences across groups to give insights on disease biomarkers."}]
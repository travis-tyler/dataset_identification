[{"section_title": "Abstract", "text": "Owing to prominence as a research and diagnostic tool in human brain mapping, whole-brain fMRI image analysis has been the focus of intense investigation. Conventionally, input fMRI brain images are converted into vectors or matrices and adapted in kernel based classifiers. fMRI data, however, are inherently coupled with sophisticated spatio-temporal tensor structure (i.e., 3D space \u00d7 time). Valuable structural information will be lost if the tensors are converted into vectors. Furthermore, time series fMRI data are noisy, involving time shift and low temporal resolution. To address these analytic challenges, more compact and discriminative representations for kernel modeling are needed. In this paper, we propose a novel spatio-temporal tensor kernel (STTK) approach for whole-brain fMRI image analysis. Specifically, we design a volumetric time series extraction approach to model the temporal data, and propose a spatio-temporal tensor based factorization for feature extraction. We further leverage the tensor structure to encode prior knowledge in the kernel. Extensive experiments using real-world datasets demonstrate that our proposed approach effectively boosts the fMRI classification performance in diverse brain disorders (i.e., Alzheimer's disease, ADHD and HIV)."}, {"section_title": "Introduction", "text": "Many neurological disorders (e.g., Alzheimer's disease [1] , neuro-AIDS [2] ) are characterized in the early stages by latent ongoing brain injury. As a forefront Neuroimaging technique, functional Magnetic Resonance Imaging (fMRI) has been widely used for noninvasive interrogation of the brain. During the course of an fMRI experiment, a series of brain images are obtained in the resting state or while the subject performs a task tailored to activate a specific cognitive function. Over the last decade, machine learning classifiers, especially ker-nel method, e.g., Support Vector Machines (SVM), have been successfully employed on fMRI images for analysis of neurological status and diagnosis [3, 4] .\nIn this paper, we study the fMRI classification problem in the context of kernel modeling. Most work on fMRI classification focuses on analysis of specific brain regions of interest(ROI) [5] . However, ROI analysis is usually based on certain assumptions and may ignore additional valuable information in the image. Comparatively, whole-brain fMRI images provide comprehensive structural and functional information of the human brain, thus having higher exploratory power and lower bias [6, 7] . Typically, as shown in Fig. 1(a) , a wholebrain fMRI image sample consists of a discrete time series of 3D image volumes (scans), where each volume consists of hundreds of thousands of voxels. Each voxel contains an intensity value that is proportional to the strength of the Nuclear Magnetic Resonance (NMR) signal emitted at the corresponding location in the brain volume [8] . Therefore, an fMRI brain image sample can be naturally represented as a fourth-order tensor with 3D space \u00d7 time. How to appropriately utilize the information from such sophisticated spatio-temporal structure is a main issue in the kernel modeling task.\nMost of conventional kernel methods convert a tensor to a vector (or a matrix), which is then adapted in the kernel modeling [9, 10] . However, voxels are often highly correlated with the surrounding voxels in the brain volume. For example, the adjacent voxels, marked with red and blue color in Fig. 1(b) , exhibit similar patterns in Fig. 1(c) . This kind of tensor-to-vector (or tensor-to-matrix) conversion would cause the loss of structural information such as the spatial arrangement of voxel-based features, particularly given that fMRI data has high spatial resolution [11] .\nA common solution is to focus on the 3D spatial domain of the fMRI brain images [7, 12] . For instance, in [12] , the original 4D tensor of fMRI data is converted to a 3D tensor by averaging over the time dimension. Then the obtained 3D tensor is utilized in the kernel for classification. However, as shown in Fig. 1(c) , the signal in each voxel of the brain volume changes along with time. If the time series is averaged, the varying trend in the time series that reflects the brain activity will be lost. Some studies [13, 14] have focused on analyzing the fMRI time series of each individual voxel while ignoring structural information in the spatial domain. For instance, the multilinear decomposition model [13] analyzes the time profile of the voxel vector converted from the 3D tensor in the spatial domain.\nAlthough leveraging the spatio-temporal information is desired in building a predictive kernel method, it is very challenging due to the following three reasons:\nNoisy fMRI time series analysis: Due to hardware reasons and subject factors (e.g., thermal motion of electrons), there are often various nuisance components and random noise in fMRI signals, leading to a low signal-to-noise ratio (SNR) [11] . Since fMRI data has low temporal resolution, the signal of each voxel would not discriminatively change within a session of several time points, limiting ability to identify brain events in time frame. Furthermore, time shifts (delays), which occur naturally during the fMRI image acquisition process, should be taken into account while analyzing the data. How to filter the noise and extract discriminative information from the time series is critical in fMRI time series analysis.\nSpatio-temporal feature extraction: Since fMRI data reflect brain activity from the spatial domain and temporal domain, a good feature extraction method should be able to extract a compact and informative representation from both domains while considering their correlations. Note that the time shift factor discussed previously should also be taken into consideration.\nKernel modeling: As discussed above, the existing works do not differentiate the spatial domain and temporal domain. How to incorporate both the correlation and the discrepancy between both domains into knowledge encoding is crucial for kernel modeling.\nTo deal with the above challenges, in this paper, we propose a Spatio-Temporal Tensor Kernel (STTK) framework for whole-brain fMRI image analysis. Specifically, we first perform time series extraction to reduce the noise and filter out the less informative time points in the original volumetric time series. Then we utilize the shifted CANDECOMP/PARAFAC (SCP) [15] factorization for feature extraction of the spatio-temporal data. Finally, spatio-temporal structure mapping is performed for kernel generation. Empirical studies on realworld resting-state fMRI brain images demonstrate that our proposed approach can significantly boost the fMRI classification performance on divergent disease diagnosis (i.e., Alzheimer's disease, ADHD and HIV)."}, {"section_title": "Preliminaries", "text": "In this section we define some necessary notions and notations related to tensors and then present the problem formulation. Before proceeding, we introduce some basic notations that will be used throughout this paper. Tensors (i.e., multidimensional arrays) are denoted by calligraphic letters (A, B, C, \u00b7 \u00b7 \u00b7 ), matrices by boldface capital letters (A, B, C, \u00b7 \u00b7 \u00b7 ), vectors by boldface lowercase letters (a, b, c, \u00b7 \u00b7 \u00b7 ), and scalars by lowercase letters (a, b, c, \u00b7 \u00b7 \u00b7 ). The columns of a matrix are denoted by boldface lower letters with a subscript, e.g., a i is the ith column of matrix A. The elements of a matrix or a tensor are denoted by lowercase letters with subscripts, i.e., the (i 1 , \u00b7 \u00b7 \u00b7 , i n ) element of an n-th order tensor A is denoted by a i1,...,in . Z + is denoted by the set of positive integers. Additionally, we will often use Gothic letters (A, B, C, \u00b7 \u00b7 \u00b7 ) to denote general sets or spaces, regardless of their specific nature."}, {"section_title": "Tensor Algebra", "text": "Definition 1. (Tensor) An nth-order tensor is an element of the tensor product of n vector spaces, each of which has its own coordinate system. Definition 2. (Tensor product) Given order n and m tensors A \u2208 R I1\u00d7\u00b7\u00b7\u00b7\u00d7In and B \u2208 R I 1 \u00d7\u00b7\u00b7\u00b7\u00d7I m , their tensor product A \u2297 B is a tensor of order n + m with the elements\nNote that a rank-one tensor of order n is the tensor product of n vectors. Clearly, an important operation applicable to our analysis is the tensor product (also called the outer product). The tensor product generalizes from the Kronecker product, but results in another tensor rather than a block matrix, which naturally endows tensor with the structure of tensor product representations and tensor product spaces. The space is equipped with inner product and norm. I1\u00d7\u00b7\u00b7\u00b7\u00d7In is defined as the sum of the products of their elements:\nClearly, for rank-one tensors\nFor brevity, we denote"}, {"section_title": "Definition 4. (Norm)", "text": "The norm of a tensor A is defined to be the square root of the sum of all elements of the tensor squared, i.e.,"}, {"section_title": "Problem Formulation", "text": "In a typical fMRI classification task, we are given a collection of n training examples\nis the input fMRI sample with 3D space \u00d7 time tensor form, and y i is the class label of X i . The goal is to find a function f : X \u2192 Y that accurately predicts the label of an unseen example in X. In the kernel learning scenario, this problem can be formulated into the following optimization task:\nwhere C controls the trade-off between the empirical risk and the regularization term f 2 H , H is a set of functions forming a Hilbert space (the hypothesis space), and V is loss function that indicates how differences between y i and f (X i ) should be penalized.\nThe attractiveness of kernel methods lies in its elegant treatment of nonlinear problems and its efficiency in high dimension. Different kernel methods or kernel machines arise from using different loss functions. In this paper, we use the hinge loss function max{0, 1 \u2212 y i f (X i )} for support vector machine (SVM)."}, {"section_title": "Kernel Modeling", "text": "Two components of kernel methods need to be distinguished: the kernel machine and the kernel function. The kernel machine encapsulates the learning task, which usually can be formulated as an optimization problem. The kernel function encapsulates the hypothesis language, i.e., how to perform data transformation and knowledge encoding. By restricting to positive definite kernel functions, the optimization problem will be convex and solution will be unique. Throughout the paper, we take 'valid' to mean 'positive definite'.\nA kernel function \u03ba corresponds to the inner product in some feature space (a Hilbert space), which is in general different from the representation space of the instances. The computational attractiveness of kernel methods comes from the fact that quite often a closed form of 'feature space inner products' exists [17] . Instead of mapping the data explicitly, the kernel can be calculated directly. According to Mercer's theorem [18] , any valid kernel corresponds to an inner product in some feature space, and we can verify whether a kernel function is valid by the following Theorem [19] . Theorem 1. A function \u03ba defined on : X \u00d7 X is a positive definite kernel of H if and only if there exists a feature mapping function \u03c6 : X \u2192 H such that\nIn particular, an important property of positive definite kernels is that they are closed under sum, multiplication by a scalar and product [20] . By the representer theorem [21] , the solutions of Eq. (2.5) can be given by\nwhere c i \u2208 R are suitable coefficients, and \u03ba is a valid kernel of H.\nFrom the above discussions, it is clear that a good kernel should be data dependent. As noted in the introduction, fMRI data are inherently coupled with spatio-temporal tensor structure, involving time shift and have very low temporal resolution and SNR. To facilitate kernel learning for fMRI data, we propose a spatio-temporal tensor kernel (STTK) framework that takes both the correlation and discrepancy between spatial and temporal domains into account. This framework consists of three steps: (1) volumetric time series extraction for extracting discriminative information from the time series, (2) spatio-temporal feature extraction for obtaining a more compact and informative representation, and (3) tensor structure mapping for kernel generation."}, {"section_title": "Volumetric Time Series Extraction", "text": "In fMRI time series extraction, a key issue is to determine the energy level for different time points. Most of existing work focus on single-voxel analysis [13] , while they ignore the spatial correlations between voxels, which may lead to suboptimal outcomes. In this section we develop a volumetric time series extraction approach for fMRI time series. In particular, we show how the volumetric (spatial) correlations and the temporal varying properties can contribute to the energy levels. Given an fMRI example X \u2208 R I\u00d7J\u00d7K\u00d7T , let x i,j,k [t] = {x i,j,k , t = 1, \u00b7 \u00b7 \u00b7 , T } be a T -element time series of voxel x i,j,k , and X [t] is a volume of X at time point t. {E(t, X [t]), E(t, x i,j,k,t )} is the energy function of time point t, where E is separated by volume and voxel for computational purposes and E(t,\n)} correspond to the minima and the maxima to be defined later.\nThe choice of energy function plays a critical role in explaining how the knowledge transforms into meanings and contexts. The success of time series extraction strongly depends on the data knowledge encoded into the energy function. Two important points must be emphasized. First, in order to reduce the noise present in the measurement, new features should be used to describe voxels, rather than using the noisy voxel intensities as features. Second, due to the low temporal resolution, each voxel signal would not experience a discriminative changing within a short measurement time period. It is necessary to make a discriminant analysis along time prior to the volume measurements. Based on these two points, we propose the following three-step procedure:\nVoxel Energy Measurement: We first extract the maxima and minima (extrema) points for each voxel's time series using the extrema extraction method [22] , which is an effective and efficient technique for single-voxel time series extraction and noise removal [14] .\n, where p t and q t are the time indexes, T p and T q are the number of maxima and minma, repsectively. Then, for each voxel x i,j,k,t , we measure its energy by\nwhere the values of 1 and \u22121 mean 'importance', and 0 means 'no importance'. Volumetric Energy Measurement: We measure the energy of each volume by summing up the energies of all the voxels in it. In particular, we separately consider the maxima and minima voxels by\nVolumetric Time Series Extraction: We extract the time series from measured volumes based on E max and E min . Let ER t be the time series extraction rate defined by N/T , where N is the number of extracted time points. Given an extraction rate ER t , we first rank all the volumetric time points according to E max and E min respectively. Then we select the top-k time points from each of the two ranked time point sets and concatenate them, which forms the extracted time series, where k equals to ER t \u00d7 T /2.\nAs an illustration, Fig. 2 Figure 3 : CP factorization is a generalization of matrix factorization to tensors. The SCP model allows shifts to occur over the second mode such that for each index of the third mode the component of the second mode is shifted a given amount. performs the extraction based on the time varying volume series. Since the voxels of different regions in human brain are highly correlated and they usually collaboratively participate in a brain activity, their overall changing trend could better reflect the brain activity. By considering the time series of all the voxels in the volume, our extraction method incorporates both the spatial correlation of the volumetric voxels and the varying properties in the temporal domain into the analysis. Therefore, it can bring us more discriminative time series for fMRI brain image analysis."}, {"section_title": "Spatio-Temporal Feature Extraction", "text": "Tensors provide a natural representation for fMRI data, but there is no guarantee that such representation will be good for kernel learning. From the characteristics of tensor, we know that the essential information in the tensor is embedded in its multi-way structure. Thus, one important aspect of kernel learning for such complex objects is to represent them by sets of key structural features which are easier to manipulate. Most of the previous work use CANDECOMP/PARAFAC (CP) factorization (as shown in Fig. 3 ) for fMRI data analysis, but it cannot well capture the structural information of a spatio-temporal tensor. Recently, it was found that shifted CP (SCP) factorization [13] is particularly effective for extracting such spatio-temporal structure. It can simultaneously consider the inter-mode correlations and the time shift in fMRI data, yielding a more compact representation of fMRI data. Motivated by these observations, we utilize SCP factorization to further perform feature extraction.\nGiven a tensor X \u2208 R I\u00d7J\u00d7K\u00d7T , SCP factorizes it as (4.11)\nwhere R is the rank of the tensor X defined as the smallest number of rank-one tensors in an exact SCP factorization, and the superscript \u03c4 denotes that the time shift will be along the forth mode (see Fig. 3 for an example), and E is the residual.\nRemark that although SCP factorizes the data tensor, we can still recover the original data from the factorized results."}, {"section_title": "Tensor Structure Mapping", "text": "Let us now consider how the above feature extraction results can be exploited to induce a kernel. Suppose we are given the SCP factorization of\nrespectively. We assume the tensor observations are mapped into the Hilbert space H by\nNote that the projected tensor \u03c6(X ) has the same order with X , but each mode dimension is higher and it is even an infinite dimension depending on the feature mapping function \u03c6(.). Based on the definition of the kernel function, it is easy to find that the feature space is a high-dimensional space of the original space, equipped with the same operations. Thus, we can factorize tensor data directly in the feature space in the same way as in the original space. This is formally equivalent to performing the following mapping:\nIn this sense, it corresponds to mapping tensors into high-dimensional tensors that retain the original structure. More precisely, it can be regarded as mapping the original data into tensor feature space and then conducting the SCP factorization in the feature space.\nAfter mapping the SCP factorization of the data into the tensor product feature space, the kernel can be defined directly with the inner product in that feature space. Thus, we derive our STTK:\n(4.14)\nFrom its derivation, we know such a kernel can take the multi-way spatio-temporal structure flexibility into account. In general, the STTK is an extension of the conventional kernels in the vector space to tensor space, and each vector kernel can be used in this framework for fMRI classification analysis in conjunction with kernel machines. Our positive result can be viewed as saying that designing a good tensor kernel function is much like designing a good tensor structure in the feature space."}, {"section_title": "Experiments and Evaluation", "text": "In order to empirically evaluate the effectiveness of the proposed approach for fMRI classification, we test our model on real fMRI data and compare with several state-of-the-art kernel methods in fMRI study."}, {"section_title": "Data Collection and Preprocessing", "text": "In this work, we consider three real resting-state whole-brain fMRI image datasets as follows:\n\u2022 Alzheimer's Disease (ADNI) 1 : It contains fMRI images of 33 subjects, each with a series of 61\u00d773\u00d7 61 scans for 130 time points. These subjects are AD patients (positive) or normal people (negative).\n\u2022 Human Immunodeficiency Virus Infection (HIV) [23] : This dataset contains fMRI brain images of 83 subjects, each with a series of 61 \u00d7 73 \u00d7 61 scans for 255 time points. These subjects are early HIV patients (positive) or normal controls (negative).\n\u2022 Attention Deficit Hyperactivity Disorder (ADHD) 2 :\n1 http://adni.loni.usc.edu/ 2 http://neurobureau.projects.nitrc.org/ADHD200/ This dataset contains the resting-state fMRI images of 100 subjects, each with a series of scans for 58 \u00d7 49 \u00d7 47 voxels. Subjects are either ADHD patients (positive) or normal controls (negative). Different from previous datasets, the lengths of time series for different subjects in ADHD dataset are not the same, ranging from 74 to 257.\nIn the derived datasets, each 3D fMRI scan has the NIFTI format. We convert each scan to a 3D tensor using SPM8\n3 . Then we use SPM8 toolbox to preprocess these data, including images realignment, slice timing correction and normalization. We also perform spatial smoothing on these functional images with an 8mm FWHM Gaussian kernel for increasing signal-to-noise ratio (SNR). REST 4 is used afterwards for band-pass filtering (0.01-0.08 Hz) and linear trend removing of the time series."}, {"section_title": "Baselines and Metrics", "text": "In order to establish a comparative study, we use five kernel learning methods as baselines. We use the classification accuracy as the evaluation metric.\n\u2022 Factor kernel (FK) [9] : a matrix unfolding based tensor kernel. The constituent kernels are from the class of Gaussian RBF kernels.\n\u2022 sKL [10] : a kernel defined based on the symmetric Kullback-Leibler divergence, where the tensors are also unfolded into matrices, which has been applied to reconstruct 3D movement.\n\u2022 DuSK [12] : a tensor kernel based upon CP factorization. The authors average the fMRI data over the temporal dimension and apply DuSK on the obtained 3D fMRI data. For evaluation, we implement DuSK in both the 3D spatial data setting and the 4D spatio-temporal data setting, which are denoted as S-DuSK and ST-DuSK, respectively.\n\u2022 STTK: our proposed spatio-temporal tensor kernel. To evaluate the effectiveness of volumetric time series extraction, we employ STTK with and without volumetric time series extraction and denote them as STTK and STTK nonT E respectively. Specifically, to study the importance of temporal correlations of the fMRI brain images within the time series, we randomly permute the order of the time dimension of the fMRI data, and then apply our STTK to it. We denote this case as STTK permT .\nWe apply each kernel learning method in SVM and evaluate their performance. Specifically, we apply all C, \u03c3 C, \u03c3, R C, \u03c3, R C, \u03c3, R C, \u03c3, R C, \u03c3, R, ERt the six methods on ADNI and HIV datasets. For the ADHD dataset, the lengths of the time series are different for different subjects, while Factor kernel, sKL, ST-DuSK and STTK nonT E require dimensions of different samples must agree. Thus, we only apply SDuSK, STTK permT and STTK on ADHD dataset. We use LibSVM [24] , a widely used implementation of SVM, with Gaussian RBF kernel as the classifier. Table 1 summarized the compared methods. The optimal tradeoff parameter for all the methods is selected from C \u2208 {2 \u22125 , 2 \u22124 , . . . , 2 5 }, the kernel width parameter is selected from \u03c3 \u2208 {2 \u22125 , 2 \u22124 , . . . , 2 5 }, the optimal rank R is determined by grid search from {1, 2, . . . , 8}, and the time series extraction rate ER t is chosen from [0, 1]. Here we set the time series extraction rate ER t to be 0.2, i.e., only 20% of the time sequences will be kept. In the experiment, 5-fold cross validations are performed. We repeated this process for 50 times and report the average classification accuracy as the result."}, {"section_title": "Classification Performance", "text": "As shown in Table 2, our STTK method performs the best on all three datasets in terms of classification accuracy. Among the listed kernel methods, Factor kernel and sKL unfold the original tensor data into matrices while all the other methods preserve the spatial tensor structure during the learning process. As can be seen from the results, Factor kernel and sKL achieve a relatively lower accuracy on both the ADNI dataset and HIV dataset. This implies that unfolding tensor into matrices would lose the spatial structural information, leading to the degraded performance. Another observation is that DuSK achieves a quite high accuracy when applied in the three-dimensional spatial data setting, while the accuracy decreases to a great extent on the four-dimensional spatio-temporal fMRI data. This is majorly due to the fact that the time series of fMRI data are very noisy, involving time shift and with low SNR. Extending DuSK to the spatio-temporal domain without proper treatments would even damage its performance.\nComparatively, our proposed STTK properly encodes the prior knowledge of time series analysis with the spatio-temporal structural information into one tensor based kernel model. Therefore, the classification accuracy of STTK is much higher than that of STDuSK, especially on the ADNI dataset. Furthermore, by extracting the most significant features in the time series at an appropriate compression rate, our STTK can better discriminate the fMRI patterns with different medical status. Meanwhile, this volumetric time series extraction strategy enables us to analyze fMRI time series with different lengths (e.g., the ADHD dataset used in the experiment). The experimental results demonstrate the effectiveness and considerable advantages of our proposed methods in the fMRI study.\nAs can be seen in Table 2 , another notable result is that STTK permT achieves a much lower accuracy than STTK, which means the random permutation of the temporal sequential order of fMRI brain images degrades the classification performance. This implies that the temporal order of the fMRI brain images is very important for the classification. This is mainly because that the original varying trend of the fMRI time series reflects the sequential brain activity within the period. If the temporal order of the fMRI brain images is permuted, the original temporal correlation of the fMRI brain images would be damaged. This result also demonstrates that our STTK method captures the temporal correlation of fMRI data well."}, {"section_title": "Parameter Sensitivity", "text": "Although the optimal values of the parameters in our proposed STTK are found using cross-validation, it is of interest to see the sensitivity of STTK to the time series extraction rate ER t and the rank of tensor factorization R.\nWe first evaluate the classification performance of STTK with varying ER t . We vary ER t from 0.1 to 1.0 on ADNI and HIV datasets. For ADHD dataset, the lengths of time series for different subjects are quite different, varying from 74 to 257. We extract the same number of time points from each of them, and then compute the average extraction rate, and use it as the extraction rate for ADHD dataset. Since the average extraction rate reaches its maximum around 0.58 due to the different lengths of the time series, here we vary ER t from 0.1 to 0.5 for the evaluation on ADHD dataset. As shown in Fig. 4 , the value of ER t significantly impacts the classification accuracy. We can find that the accuracy declines when ER t > 0.2. This indicates, counterintuitively, keeping more time points (with higher ER t ) does not improve the accuracy; instead, it may even lead to a worse performance. As illustrated in Fig. 5 , the time series extracted with ER t = 0.5 and the one extracted with ER t = 0.7 contain many redundant time points, especially in the time interval [0, 70], which may degrade the performance. Although keeping even more time points might be helpful, as the accuracy starts to increase when ER t > 0.7, we can notice that the optimal results for all datasets are achieved when ER t = 0.2. This reflects the fact that fMRI time series are commonly noisy, containing many redundant time points that are insignificant for disease diagnosis. With an appropriate value of ER t , the volumetric time series extraction enables STTK to greatly filter the background noise, while preserving the most discriminative patterns in the fMRI time series.\nNext, we evaluate the sensitivity of STTK to the rank R of tensor factorization. We fix ER t at 0.2 which is the optimal value for each dataset, and vary R from 1 to 8 with a step size of 1. As shown in Fig. 4 , the rank parameter R has a significant effect on the classification accuracy and the optimal value of R depends on the datasets. In general, the optimal value of R lies in the range between 2 and 5, which may provide a good guidance for selection of the R in advance. How to determine the optimal rank for a specific tensor factorization method is beyond the scope of this paper and still remains an open research problem [25, 26] ."}, {"section_title": "Related Work", "text": "Our work relates to a vast literature on spatio-temporal data analysis, tensor analysis techniques, and kernel learning. We present a selection of such works below. Spatio-Temporal Data Analysis: Spatio-temporal data analysis has attracted considerable attention recently. Many models have been conducted to address the challenges in different contexts [27] . However, these models usually require domain knowledge since they make strong assumptions on the spatial and temporal correlation of the data. Some models have been used in the spatio-temporal fMRI brain image analysis [28] , while most of them treat spatial domain and temporal domain separately. For instance, in [29] , spatial analysis is performed via general linear modelling (GLM), while temporal analysis is done with a direct comparison of BOLD response estimates between regions. Tensor Factorizations: Our work is also motivated by recent advances in tensor factorization and its applications in the fMRI data analysis [30] . A comprehensive survey on tensor factorization can be found in [16] . One of the most commonly used one is CP factorization. In the spatio-temporal tensor setting, the shifted CP is more frequently used [13] , but for exploratory analysis. In this study, we employ it to facilitate kernel learning. Kernel learning: Several tensor based kernel methods have been recently investigated [9, 10, 17] . Most of them focus on learning kernel via matrix unfolding, thus only capturing the one-way relationship within the tensor data. The multi-way structures within tensor data are already lost before the kernel construction. The problem of how to build kernel directly on tensor data has not been well studied. A first attempt in this direction is related to CP factorization proposed in [12] , while it has the same drawback as CP factorization."}, {"section_title": "Conclusion", "text": "In this paper, we have introduced a spatio-temporal tensor kernel (STTK) modeling method, with an application to whole-brain fMRI classification. Different from conventional kernel methods, our approach exploits the inherent spatio-temporal structure to facilitate kernel learning, while considering both the correlation and discrepancy between the spatial domain and the temporal domain. STTK consists of three steps: (1) volumetric time series extraction for extracting discriminate information from the time series, (2) spatio-temporal feature extraction for obtaining a more compact and informative representation, and (3) tensor structure mapping for kernel generation. Empirical studies on real-world fMRI brain images demonstrate that our approach can significantly boost the fMRI classification performance in three different brain disorders (i.e., Alzheimer's disease, ADHD and HIV)."}]
[{"section_title": "Abstract", "text": "Classifying neurodegenerative brain diseases in MRI aims at correctly assigning discrete labels to MRI scans. Such labels usually refer to a diagnostic decision a learner infers based on what it has learned from a training sample of MRI scans. Classification from MRI voxels separately typically does not provide independent evidence towards or against a class; the information relevant for classification is only present in the form of complicated multivariate patterns (or \"features\"). Deep learning solves this problem by learning a sequence of non-linear transformations that result in feature representations that are better suited to classification. Such learned features have been shown to drastically outperform hand-engineered features in computer vision and audio analysis domains. However, applying the deep learning approach to the task of MRI classification is extremely challenging, because it requires a very large amount of data which is currently not available. We propose to instead use a three dimensional scattering transform, which resembles a deep convolutional neural network but has no learnable parameters. Furthermore, the scattering transform linearizes diffeomorphisms (due to e.g. residual anatomical variability in MRI scans), making the different disease states more easily separable using a linear classifier. In experiments on brain morphometry in Alzheimer's disease,\nA C C E P T E D M A N U S C R I P T\nand on white matter microstructural damage in HIV, scattering representations are shown to be highly effective for the task of disease classification. For instance, in semi-supervised learning of progressive versus stable MCI, we reach an accuracy of 82.7%. We also present a visualization method to highlight areas that provide evidence for or against a certain class, both on an individual and group level."}, {"section_title": "Introduction", "text": "1 Over the last two decades, Magnetic Resonance Imaging (MRI) has been widely adopted for studying the human brain and diseases affecting brain tissue. The neurodegenerative processes behind these diseases are still poorly understood. Previous studies show complex and multivariate patterns of tissue damage, such as in Alzheimer's disease (Jack et al., 2004; Dyrba et al., 2015; Zhang et al., 2011; Cuingnet et al., 2011; Young et al., 2013; Moradi et al., 2015; Arbabshirani et al., 2016) and brain damage induced by HIV-infection (Su et al., 2016) , compared to healthy controls.\nMachine learning techniques have been proven powerful in identifying such multivariate patterns in an approach to classify patients and controls. Deep learning is a machine learning methodology currently transforming fields such as speech recognition (Hinton et al., 2012; Chorowski et al., 2015; Bengio and Heigold, 2014) , image analysis (Xu et al., 2014) , natural language processing (Pennington et al., 2014) , high energy physics (Baldi et al., 2014) , among others. Data in these domains usually look like low dimensional measurements where neighboring elements are highly correlated. Convolutional neural networks exploit this correlation and scale to massive datasets."}, {"section_title": "A C C E P T E D M A N U S C R I P T", "text": "\n\n\n\n\n\n\nACCEPTED MANUSCRIPT classification and one semi-supervised learning task. The goal of the MCI classification task is to discriminate between progressive MCI (pMCI) scans and stable MCI (sMCI) scans. In this task, the goal is to predict whether an MCI patient will convert to an AD over a 3 year period (referred to as pMCI) or not (referred to as sMCI) (Moradi et al., 2015) . The MCI MRI scans we have in this sample include 164 pMCI and 100 sMCI scans besides other MCI scans not known as to which MCI state they belong (unlabeled MCI scans).\nRegarding the classification of the AD and healthy MRI scans, the subsample used for this task is composed of 200 AD and 231 healthy MRI scans. The number of ICA components in use in the ICA-based representation experiment is 17, as determined on a validation set. As in the corresponding AGEhIV, OASIS and small ADNI sample experiments, an angular resolution, L = 4, and number of wavelet scales, J = 4, are used to extract the scattering coefficients.\nA proportion of 60% of the data is used for training, and 20% of the data is used for validation and for testing. Results of the AD vs. healthy classification experiment are shown in the lower part of Table 3 . The classification accuracy achieved by the proposed scattering-based classifier is 84.9%, compared to stateof-the-art leading to corresponding accuracy of 82% by Moradi et al. (2015) .\nThe scattering-based classifier leads to state-of-the-art results on this sample of ADNI, better than the other two representations, and better than the result reported in Moradi et al. (2015) . We perform a single additional experiment to reduce the number of scattering coefficients by PCA. The first 20 principal components (PCs) were selected and given as an input to the SVM classifier, instead of the scattering features. This results not only in speeding up the classifier, but also in an improvement in the classification accuracy, as can be seen in Table 3 .\nResults of the ADNI MCI experiments are displayed in Table 5 . Data for the classification experiment consist of 164 pMCI and 100 sMCI MRI scans.\nBy applying a linear SVM classifier to the scattering coefficients of these scans, a classification accuracy of 73.5% is achieved, based on cross-validation (upper half of Table 5 ), compared to state-of-the-art accuracy on the same data ranging\nACCEPTED MANUSCRIPT from 66.0% to 69.2%, as reported in Table 3 in Moradi et al. (2015) .\nData for the semi-supervised learning (SSL) experiment consisted of 164 pMCI, 100 sMCI and 140 unlabeled MCI scans. The SSL algorithm we use on top of the scattering representation is a variation of semi-supervised SVM (Melacci and Belkin, 2011) where Laplacian SVM is efficiently trained in the primal with preconditioned conjugate gradient based on the L 2 hinge loss 2 . The learning accuracy resulting from using Laplacian SVM on the scattering coefficient representation is superior to the best SSL classification accuracy reported in Table 3 in Moradi et al. (2015) . It can also be noticed that adding unlabeled MRI data to data of both algorithms improves the learning accuracy over their fully supervised learning counterparts. Moradi et al. (2015) . The second experiment is an SSL experiment where the training data consist of unlabeled MCI MRI data in addition to data belonging to the pMCI and sMCI labels. Using a Laplacian SVM trained in the primal on top of the scattering representation leads to a higher accuracy than state-of-the-art by Moradi et al. (2015) . \n\n"}, {"section_title": "ACCEPTED MANUSCRIPT", "text": "The situation in classifying MRI data is starkly different however. Here we collect data with millions of features, but the number of patients often does not exceed a few hundred or a few thousand. Applying high capacity deep learning methods in healthcare applications is therefore highly challenging and prone to severe overfitting.\nIn this work, we will show that deep models can be applied successfully to the medical imaging domain by applying a fixed (i.e. not learned) feature transformation to the input data. In detail, we apply a 3-dimension (3D) translation invariant transformation referred to as a 3D scattering transform, which is also stable to actions of small diffeomorphisms, such as deformations, to MRI data. In order to compute the scattering coefficients, a convolution network is established by cascading wavelet transforms and modulus operators (Bruna and Mallat, 2011; Mallat, 2012) . The resulting 3D scattering representation of each data instance (MRI scan in our experiments), i.e. a vector containing multiscale and multi-direction co-occurrence information, is subsequently used for classification. The performed experiments aim to show that the 3D scattering representation has more discriminative power than the original data features and than features derived from independent component analysis (ICA), and that it performs well in the low data regime. Effectively, by avoiding learning these transformations altogether, we also avoid overfitting.\nOur main three contributions are as follows: First, we provide the first implementation of the feature representation referred to here as the 3D scattering transform, which is inspired by the 2D scattering transform proposed by Bruna and Mallat (2011) ; Mallat (2012) . Second, we provide state-of-the-art performance on the classification in three datasets. These include the comorbidity and aging with HIV (AGEhIV) study looking into long-term effects of Human Immunodeficiency Virus (HIV)-infection on the brain, and two studies into (progression to) Alzheimer's disease (AD), namely the Open Access Se- In the AD-studies, we will study gray matter volume, segmented in T1-weighted scans, while in the HIV-study we will assess white matter microstructure, measured with diffusion weighted MRI. Within the ADNI study, we will in more detail classify sub-classes with baseline data on Mild Cognitive Impairment (MCI) that will either progress into AD or remain stable. Third, we present a visualization method to highlight regions in the original MRI input that provide input for or against a certain class. This visualization method facilitates the understanding of how a particular classification decision is taken through the complex non-linear function resulting from the scattering transformation. Our method can visualize evidence on both the group and the individual level, and will be demonstrated on the ADNI-dataset.\nThe rest of the paper is organized as follows. Section 3 describes the 3D scattering transform, the relevant theoretical properties of this transform and the proposed visualization method. Empirical results on three MRI datasets on brain damage due to HIV (AGEhIV) and Alzheimer's disease (OASIS and ADNI) are presented in Section 4, followed by a conclusion.\nis performed in all the experiments where a portion of 60% of the data is reserved for training, 20% for validation and 20% for testing. Supervised learning is performed using a linear support vector machines (SVM) classifier. The learning algorithm used in the last experiment, which is a semi-supervised learning experiment performed on the ADNI dataset, is a Laplacian SVM. Finally, we will present our method of visualization of evidence for or against a class, on both the group and individual level. 60% training + 20% validation + 20% test. Supervised learning is performed using a linear support vector machines (SVM) classifier. The learning algorithm used in the last experiment, which is a semi-supervised learning experiment performed on the ADNI dataset, is a Laplacian SVM. Not shown is the introduced method of visualization of evidence for or against a class, on both the group and individual level, see section 2.5.\nwhere \u039b is an optional diagonal metric matrix that controls the aspect-ratio of the filter and x \u2208 R 3 . The Gaussian window of the complex Gabor wavelets is modulated by a frequency, \u03be \u2208 R 3 , which controls the frequency of the filter relative to the width \u03c3 of the Gaussian window. We use \u03be = ( 3\u03c0 4 , 0, 0). A wavelet \u03c8 j,\u03b8,\u03b2,\u03b3 at scale j and angles \u03b8, \u03b2 and \u03b3 is constructed from the mother wavelet by rotation and dilation:\nwhere R \u03b8,\u03b2,\u03b3 is a rotation matrix and a is a scale parameter. R \u03b8,\u03b2,\u03b3 is a matrix used to perform rotation in a 3D space with angles, \u03b8, \u03b2 and \u03b3 in directions x, y and z, respectively, assuming x-y-z 3D coordinates (Arfken, 1985) .\nFor notational convenience we define \u03bb = (j, \u03b8, \u03b2, \u03b3) and write \u03c8 \u03bb = \u03c8 j,\u03b8,\u03b2,\u03b3 .\nThe wavelet transform of a signal f : R 3 \u2192 R (e.g. an MRI scan) is then computed as\nwhere * denotes convolution.\nto j 2 in our case and in the classification problems in general), and then store averages of the resulting coefficients as part of the scattering representation.\nA final wavelet transform is applied, yielding |f * \u03c8 j1,\u03b81,\u03b21,\u03b31 | * \u03c8 j2,\u03b82,\u03b22,\u03b32 for all combinations of j 1 , j 2 , (\u03b8 1 , \u03b2 1 , \u03b3 1 ), (\u03b8 2 , \u03b2 2 , \u03b3 2 ) where j 2 < j 1 . After a final blurring and subsampling, we obtain the coefficients for the last layer.\nThe scattering transform of f consists of the computed coefficients Sf at each layer:\nScattering coefficients can distinguish complex image structures, e.g. corners and junctions, from edges as they yield co-occurrence information for any pair of scales j 1 and j 2 , and directions (\u03b8 1 , \u03b2 1 , \u03b3 1 ) and (\u03b8 2 , \u03b2 2 , \u03b3 2 ), where the subscript number indicates the order. Scattering coefficients are calculated only for scales j 2 < j 1 , because, as proven in Mallat (2012) , the energy in |f * \u03c8 j1,\u03b81,\u03b21,\u03b31 | * \u03c8 j2,\u03b82,\u03b22,\u03b32 is negligible at scales j 2 \u2265 j 1 . After averaging scattering coefficients, there is one scattering coefficient at order 0, which is the average of the original instance representation. The number of averaged scattering coefficients at orders 1 and 2 (most of the energy needed for classification lies in coefficients of orders 0, 1 and 2) depend on the number of wavelet scales J, and the resolution along each rotation axis \u03b8, \u03b2, \u03b3 that we denote by L. At layer 1, there are d 1 = JL 3 wavelets and hence equally many feature maps and output coefficients. For each of the JL 3 feature maps, the second layer wavelet transform is computed, but only for smaller scales. Hence, the number of coefficients at layer 2 is\nFor example, for L = 2, J = 4, number of wavelet coefficients at orders 1 and 2 can be calculated as follows:\nThus, the scattering transform representation of the original 3D MRI volume has dimensionality 417.\nSimilarly for L = 4, J = 4, the number of scattering coefficients at orders 1 and 2 can be calculated as follows:\nThus, input is transformed to approximately 2.5 \u00b7 10 4 dimensions in this case. Assuming a resolution of 2mm, the input dimensionality of an MRI-scan is approximately 10 6 . In this situation, the dimensionality would therefore be reduced by roughly two orders of magnitude.\n\n\nfeature to the voxel data. In Experiment B, MRI scanner is used as the class label, and HIV-status is added as a feature to the data. In these experiments we chose not to linearly regress out age, but rather add age as an additional feature to the voxel data, similar to the abovementioned covariates.\nThe number of ICA components was chosen by optimizing performance on the validation set and resulted in 9 components. For the scattering representation, parameters leading to the results displayed in Table 1 have also been determined on the validation set. The angular resolution is L = 4, while the number of wavelet scales used is J = 4, which leads to a total of 24,833 features, i.e. scattering coefficients. As mentioned in section 2.3, most of the energy required to capture discriminative information for classification lies in scattering coefficients of orders 0, 1 and 2. Therefore, all results obtained here are based on two scattering layers. To validate this choice, we performed an additional experiment using one, two and three layers of coefficients. The classification accuracies obtained were 58.0%, 75.1% and 75.0% respectively. Thus, involving scattering coefficients of order 3 leads to a massive increase in the number of used scattering coefficients without any performance gain. Both of these conclusions have as well been reached by Bruna and Mallat (2011); Bruna (2013) . Receiver operating characteristic (ROC) curves for the SVM classifier applied to the three representations of the HIV dataset are shown in Fig. 4(a) .\nFor the classification results arising from the ICA components vs. the scattering representation, the p-value for a paired Student's t-test is equal to p = 0.045, which means that the null hypothesis -being that the pairwise difference in the results between the two representations is not significant -is rejected at a standard significance level of p=0.05. The p-value of the raw form (original voxels) vs. the scattering representation is equal to p = 4.48 \u00d7 10 \u22124 .\nOut of the 24,833 scattering features, 12483 features have values smaller than 10 \u221214 , across all instances (MRI scans). By discarding such features and selecting the rest to be the input to SVM, identical accuracy results are obtained with a sped up run-time. We used a linear kernel for the results reported in \n\n\nAs can be seen in the figures, classification results of SVM over the scattering A C C E P T E D M A N U S C R I P T\nrepresentation are more accurate than the raw form and than the ICA-based representation.\nThe p-values of a paired T-test for the ADNI experiments are displayed in Table 4 . \ninstance, there is a pooling operation in scattering networks implemented as a subsampling step and there is also a nonlinearity implemented as the absolute value of the activities (instead of a rectified linear unit (ReLU)). The fact that features are extracted from every layer also has an equivalent in Convolutional Neural Networks (CNNs) called \"skip-connections\" (Graves, 2013; He et al., 2016; Huang et al., 2016 (Farabet et al., 2010; Matusugu et al., 2013; Ciresan et al., 2013; Behnke, 2003; Yaniv et al., 2015; Masci et al., 2013) , document recognition (LeCun et al., 1998) and medical signal processing (Graupe et al., 1988 (Graupe et al., , 1989 , among numerous other applications. However, the learned CNN transformations have mostly led to very good classification results in cases where a lot of data is available. Since learning the accompanying parameters necessitates the availability of significant amounts of data, a high risk of overfitting occurs when using deep learning\ntechniques in low-data regimes.\nThe proposed 3D scattering representation is a fixed representation with no learnable parameters, which is one of the reasons why it is much less prone to severe overfitting than CNNs in low-data regimes. The scattering transform is translation invariant and stable to small deformations. The scattering transform involves convolutions followed by an averaging step (can as well be seen as a mean-pooling step), and a supervised learner (classifier) is applied on top of it so that labels can be learned. As demonstrated by the experiments, the premise is that the scattering transform can be a better representation for the data in terms of explaining the important variations and discarding the rather unimportant variations, and this ultimately leads to better classification accuracy.\nWe have developed and implemented a feature extraction method based on three dimensional scattering transformations and tested it for its ability to discriminate HIV and Alzheimer's disease from healthy subjects and subjects with mild cognitive impairment. We have clearly shown that our proposed methodology achieves higher accuracy than the best competing methods, in particular an SVM applied to features extracted using ICA. We believe that one of the main reasons that scattering is successful in the neuroimaging domain is its stability against small deformations of the input image. Also its ability to detect differences in \"tissue textures\" may be important. We believe scattering representations are particularly useful in the high-dimensional but small-number-of-patients regimes that are typical in medical imaging. Yang et al. (2011) . The work in Gupta et al. (2013) , which is based on a high-data regime where a sparse auto-encoder was used to learn a set of bases from natural images, uses 755 ADNI MRI scans per class, compared to our 50 scans per class in our experiments, and they consequently achieve higher classification results. In the context of classifying progressive MCI, Moradi et al. (2015) showed that they classified beyond the state of the art. Here we show that the proposed scattering transform allows to further improve upon the classification. Still, our classification performance is not an outlier compared to earlier studies (Arbabshirani et al., 2016) , reducing the likelihood of possible overtraining. In the ADNI-dataset age effects were regressed out on voxel-level in a univariate way, whereas for the AGEhIV dataset we followed an alternative approach by adding nuisance variables as independent features. Thus, we have carried out different but equally valid approaches to handle this issue throughout the different performed experiments.\nVisualizing the classification result is of high clinical importance. In the current practice, a classification experiment is interpreted by studying the classifiers' weight vector. In this respect, previous work studied the interpretation of weight vectors in backward models (Haufe et al., 2013) , and provided an analytical approximation to permutation testing for running computationally efficient experiments (Gaonkar and Davatzikos, 2013) .\nWe propose a method that allows to study the probability of a single subjects' brain to be assigned to a specific class. When averaging over the progressive MCI group, as can be seen in Fig. 6 , we observed that the hippocampus, amygdala and entorhinal cortex were involved. These regions have been reported earlier in the context of predicting progression in MCI (Ye et al., 2012) and discriminating MCI from healthy controls (Desikan et al., 2009) . Atrophy in the enthorinal cortex has been shown to predicts cognitive decline in Alzheimer's disease (Velayudhan et al., 2013) . Hippocampal atrophy has been observed in A C C E P T E D M A N U S C R I P T\nearlier stages of Alzheimer research (Henneman et al., 2009 ). An additional strong effect that we observe in the precuneus and cingulate cortex has been shown to be associated to hypometabolism in MCI (Bailly et al., 2015) .\nAlthough we have not done so, we believe that regression problems could also benefit from applying the scattering transform to the data. This would provide a more natural embedding of regressing out covariates such as age and scanner. We have done this in a separate step and a univariate way, which is a limitation of our experiments.\nIn conclusion, we propose a scattering transform that proved to be highly effective in small datasets, under different experimental conditions and for multiple disease types. The classification can be visualized on both the individual and group level.\nA C C E P T E D M A N U S C R I P T\n"}, {"section_title": "The Scattering Representation", "text": "The introduced paradigm consists of two principal steps. The first is to transform all data instances from their MRI representation into the scattering representation by the 3D scattering transform. The second is to perform supervised (respectively semi-supervised in the last experiment) learning. A scheme of the phases of the paradigm is displayed in Fig. 1 . In the beginning, an initial procedure is performed to regress out the effect of age on the MRI scans. After estimating the age effect in a regression on the healthy controls, it is then regressed out of the data belonging to all classes. The 3D scattering transform is subsequently applied to all the age regressed MRI data, resulting in the scattering representation of each MRI dataset. A detailed description of the 3D scattering transform is provided throughout the rest of this section. Afterwards, learning is applied to the data in the scattering representation. Cross-validation"}, {"section_title": "The 3D Wavelet Transform", "text": "We will first review the wavelet transform, before describing in detail the structure of the scattering transform. The 3D wavelet transform (Mallat, 1999) expands a three-dimensional signal on a basis of rotated and dilated wavelets.\nWavelets are constructed from a Gabor mother wavelet \u03c8,\nA C C E P T E D M A N U S C R I P T"}, {"section_title": "The Scattering Transform", "text": "The 3D scattering transform is computed as a sequence of multi-directional and multi-scale wavelet transforms, interleaved with modulus nonlinearities.\nThe wavelet we use is a Gabor wavelet. The resulting computation is similar to a convolutional neural network, but does not have any learnable parameters, making it suitable for use in the low-data regime. At the first layer (layer 0), a Gaussian filter \u03c6 J (x) at scale J is applied leading to a blurred version of\nx (see Fig. 2 ). The averages of these subsampled coefficients are then stored as part of the scattering representation. Then, a wavelet transform is applied to the MRI scan f : the convolutions f * \u03c8 j1,\u03b81,\u03b21,\u03b31 are computed for all j 1 , \u03b8 1 , \u03b2 1 and \u03b3 1 in a fixed grid (see Fig. 2 ) before storing the averages of these coefficients as another part of the scattering representation. After computing the modulus, we again blur and subsample (see Fig. 2 ), this time at scale j q (j q is the scale of last wavelet applied, as we will indicate later, this is equivalent"}, {"section_title": "Linearization of Diffeomorphisms", "text": "In brain morphometry studies, the differences between healthy and diseased states, and between diseased sub-states, are assumed to be described by nonlinear deformations of the 3D volumetric data, which are mapped to modulated tissue probability maps that are to be compared.\nAn important step in the preprocessing is to remove any unwanted intensity variation, for instance due to anatomical misalignment between subjects by non-rigid registration. Such preprocessing will however not be able to remove all anatomical variations, such that residual misalignments will still be present in the data. Hence, it is important that the representation is stable to the actions of small diffeomorphisms (which explain most of the intra-class variability), while making the classes linearly separable.\nAs shown in Bruna and Mallat (2013) ; Mallat (2012) , the scattering transform is Lipschitz continuous to deformations. This means that for a signal f , a diffeomorphism \u03c4 acting on the signal as f \u03c4 (x) = f (x\u2212\u03c4 (x)), there is a constant C such that:\nHere S denotes the scattering transform and sup x |\u2207\u03c4 (x)| measures the magnitude of the deformation via the norm of the deformation gradient, \u2207\u03c4 (x) (Bruna and Mallat, 2013) . This result shows that the difference between the scattering transform of f and its transformed version f \u03c4 is bounded by a constant C times the norm of f times the magnitude of the deformation.\nIt follows from the Lipschitz continuity that the effect of a small diffeomorphism on the scattering representation is well-approximated by a linear map.\nAs we verify in our experiments, this ensures that linear classifiers are able to handle variability due to deformations well.\nThe idea of the Lipschitz continuity in the context of the scattering transform was first noted and illustrated in pages 2, 3 and 4 -starting from equation (2)in Mallat (2012) . The idea of the Lipschitz continuity in general can as well be found in Chapter 9 in O'Searcoid (2006) ."}, {"section_title": "Visualization of the 3D Scattering Transform", "text": "We propose a visualization method via which regions in the MRI scans providing evidence for or against a certain class can be highlighted. As such, the proposed visualization method provides insight into the decision making process of a linear classifier acting on the scattering representations of input MRIs.\nThe visualization method is based on the gradient of the learning function with respect to the input features of an input MRI scan. We thus aim to quantify the contribution of voxel values per individual subject to the classification boundary. These are furthermore averaged per class (patients or controls), resulting in distinct class mappings. Importantly, this approach differs from the commonly visualized classifier coefficients. To reduce noise effects in computing the gradients, we compute gradients by perturbing principal components (PCs) of the input data.\nMore formally, for an input data sample, x, and a discrete classification output (class), y, let the the learning function be G(x) = P (y|x), h k be the PCs of the input matrix (of the original voxels), k be indices over the selected PCs, and \u01eb k be small values used to perturb h k . Using Taylor's expansion, we can write:\nsince we can safely neglect terms of o(\u01eb 2 ). Also note that h k forms an orthonormal basis, for which the following holds:\nBased on Eq.'s (10) and (11), we get:\nAnd this can be the case with small values of \u01eb. Equation (12) The learning model, which in our case is an SVM classifier on top of the scattering representation, is expressed in this visualization methodology by G(x).\nUsing probabilities is one common way of expressing G(x), but is not necessary.\nWe use a function of the distance from the corresponding instance, x, to the boundary of the SVM, divided by the sum of the distances of all training instances belonging to the same class, to the boundary, to compute G(x) = P (y|x). This is valid since the farther an instance is from the boundary, the more certain it is that this is the right class for such instance. An alternative is to use Platt scaling, which is calibrated but it requires post-processing and a separate validation set."}, {"section_title": "Experiments", "text": "In our experiments, we will compare three different feature representations:\n1. The original voxel data, reshaped as 1D vectors.\n2. An independent component analysis (ICA) based representation, as implemented in the Group ICA for fMRI toolbox (GIFT) (Calhoun et al., 2009) after an initial Principal Component Analysis (PCA) mapping retaining 90% of the variance in the data.\n3. The scattering representation.\nThese will be computed on three brain MRI datasets, that will be explained in more detail in the following sections:\n1. The AGEhIV (comorbidities and aging in HIV) dataset, including scans of HIV-infected individuals and healthy controls. In this study, data have used as the unlabeled sample along with samples belonging to pMCI and sMCI. Adding these data is thought to improve the classification (Moradi et al., 2015) .\nThe classifier in use is an SVM with a soft margin. SVM is one of the most commonly used classification algorithms and it was demonstrated in previous works that it is more accurate than alternatives, e.g. Othman et al. (2011); Yang et al. (2011) . The dual form of soft margin SVMs (13), which is formulated into a quadratic programming problem, is solved using sequential minimal optimization (SMO) (Platt, 1999) ,\nwhere \u03b1 i for i = 1..., n denote Lagrange multipliers, and \u03b1 i = 0 for all training instances except the support vectors. The symbol K refers denotes the SVM\nLinear SVM (SVM with a linear kernel) is used in all the supervised learning experiments. Cross-validation is also applied to all the performed experiments.\nTraining is performed on only 60% of the available data, whereas 20% of the data is reserved for validation of the scattering parameters, namely number of orientations, L, and number of scales, J (respectively validation of number of independent components in case of the ICA representation), among other parameters. The test set consists of the remaining 20% of the data."}, {"section_title": "AGEhIV Dataset", "text": "The AGEhIV Cohort Study is an ongoing study on prevalence, incidence and risk factors of ageing-associated comorbidities and organ dysfunction among Grid (Shahand et al., 2014) . As a result, Fractional Anisotropy (FA) maps were computed. FA is sensitive to microstructural damage and therefore expected to be, on average, decreased in patients. Subjects were scanned on two 3.0\nTesla scanner systems, 121 subjects on a Philips Intera system and 39 on a\nPhilips Ingenia system. Patients and controls were evenly distributed over both scanners. More details on the study, data and preprocessing can be found elsewhere (Su et al., 2016) .\nWe perform two experiments on the AGEhIV dataset. In the main experiment, Experiment A, the class labels refer to the disease type, i.e. being diagnosed with or without HIV. The used MRI scanner is added as an additional\nA C C E P T E D M A N U S C R I P T"}, {"section_title": "OASIS Alzheimer Dataset", "text": "The Open Access Series of Imaging Studies (OASIS) dataset consists of highresolution T1-weighted MRI scans of 182 MRI scans, including 60 Alzheimer's patients and 122 healthy controls. These data were preprocessed using the Statistical Parametric Mapping software (SPM v12). This involved tissue segmentation into gray matter and white matter probability maps, followed by spatial normalization to a pre-defined standard template, in MNI152 space. The registration parameters for the normalization were calculated using the DAR-TEL non-linear approach in SPM. The non-linear warping was then applied to the gray matter and white matter segmentations separately to align them to the template, during which images were resampled to 1.5mm isotropic voxels, modulated by the extent of warping necessary in order to retain volumetric information and smoothed using a 4mm FWHM Gaussian kernel. The resulting volumes contain (120 \u00d7 144 \u00d7 120) voxels. Experimental results on the OASIS data are displayed in Table 2 . Out of the three representations, SVM applied to the scattering representation of the MRI scans achieves the highest accuracy. Receiver operating characteristic (ROC) curves for the SVM classifier applied to the three representations of the dataset are shown in Fig. 4(b) . For the classification results of the ICA-based representation vs. the scattering repre- "}, {"section_title": "ADNI Database", "text": "The Alzheimer's Disease Neuroimaging Initiative (ADNI) database where the training data are not too small."}, {"section_title": "Experiments on a Subset of Data", "text": "Focussing on the main theme of this work, which is to assess the scattering transform in small datasets, we initially work with a subset of 150 MRI scans consisting of 50 AD scans, 50 MCI scans and 50 healthy scans. The subjects were randomly chosen from each class, and they cover different sex and acquisition differences (recall that age has already been regressed out). Similar to previous works on the same dataset, we perform binary classification experiments consisting of all possible two-class combinations. We also perform an experiment combining AD and MCI scans (we refer to this composite class as The validation set consists of 10 AD, 10 MCI and 10 healthy scans, and the same goes for the test set.\nExperimental results on the ADNI dataset are displayed in Table 3 . Out of the three representations, SVM applied to the MRI scattering representation achieves significantly better performance than the raw form and the ICA-based representations. Table 3 are shown in Fig. 4(c-f) . Again, all experiments are SVM classification experiments applied to the three representations of the ADNI dataset."}, {"section_title": "Experiments on a Bigger Sample Size", "text": "The larger sample of ADNI used in this experiment consists of 835 MRI scans. One of the advantages of using this ADNI sample in particular is that -contrary to the majority of experiments performed on the ADNI dataset in the literature-it allows us to compare on common ground with a previous work on the data, since the same sample was used in the experiments performed in Moradi et al. (2015) . This sample consists of 200 Alzheimer's disease (AD) MRI scans, 231 healthy MRI scans and 404 MCI MRI scans. We perform two classification tasks and a semi-supervised learning task on this ADNI sample.\nThe first is a binary classification task of the AD vs. healthy MRI scans. Two MCI-based tasks are performed on the MCI subset of this ADNI sample, one"}, {"section_title": "Experiment", "text": ""}, {"section_title": "Discussion and Conclusion", "text": "In this paper, we propose a 3D scattering transform as a fixed representation with no learnable parameters, that can replace deep learning methods in paradigms where we do not have at disposal massive amounts of data points available for use. We present a visualization method of evidence for belonging to a certain class, both for individual cases and class averages. In our experiments we have extensively validated our method on different datasets, showing improved performance over currently established SVMs, also with ICA added as a dimensionality reduction step.\nThe scattering transform and deep learning are directly related (see Mallat (2012) ; Bruna and Mallat (2013, 2011) for an in depth explanation). For"}, {"section_title": "Highlights", "text": "\u2022 We have developed and implemented a feature extraction method based on the three dimensional (3D) scattering transform and tested it for its ability to discriminate diseased from healthy subjects and subjects with mild cognitive impairment.\n\u2022 We have clearly shown that our proposed methodology achieves higher accuracy than the best competing methods; in particular an SVM applied to features extracted using ICA.\n\u2022 The scattering transform linearizes diffeomorphisms (due to e.g. residual anatomical variability in MRI scans), making the different disease states more easily separable using a linear classifier.\n\u2022 In experiments on brain morphometry in Alzheimer's disease, and on white matter microstructural damage in HIV, scattering representations are shown to be highly effective for the task of disease classification.\n\u2022 We also present a visualization method to highlight areas that provide evidence for or against a certain class, both on an individual and group level."}]
[{"section_title": "Abstract", "text": "Abstract. This article is part of the model documentation of the MECO(n) system (MESSyfied ECHAM and COSMO models nested n-times). As part of the Modular Earth Submodel System (MESSy) the Multi-Model-Driver (MMD v1.0) was developed to couple on-line regional model instances into a driving model (see Part 2 of the model documentation). MMD comprises the message passing infrastructure required for the parallel execution (multiple program multiple data, MPMD) of different models and the communication of the individual model instances, i.e. between the driving and the driven models. Initially the MMD 5 library was developed for a 1-way coupling between the global chemistry climate model EMAC and an arbitrary number of (optionally cascaded) instances of the regional chemistry climate model COSMO/MESSy. Thus MMD (v1.0) provided only functions for unidirectional data transfer, i.e., from the larger scale to the smaler scale models.\nSoon, extended applications requiring data transfer from the small-scale model back to the larger scale model became of interest: e.g., the original fields in the larger scale model can directly be compared to the up-scaled small-scale fields to analyse 10 the gain by the original small-scale calculations, if the results are up-scaled. Secondly, the fields originating from the two different models might be fed into the same diagnostic tool, e.g. the on-line calculation of the radiative forcing calculated consistently with the same radiation scheme. Last but not least, enabling the 2-way data transfer between two models is the first important step on the way to a fully dynamically and chemically 2-way coupling of the various model instances.\nIn MMD (v1.0) interpolation between the basemodel grids is performed via the COSMO pre-processing tool INT2LM, 15 which was implemented as MMD submodel for on-line interpolation, specificially for mapping onto the rotated COSMO grid.\nA more flexible algorithm is required for the backward mapping. Thus, MMD (v2.0) uses the new MESSy submodel GRID for the generalised definition of arbitrary grids and for the transformation of data between them.\nIn this article we explain the basics of the MMD expansion and the newly developed generic MESSy submodel GRID(v1.0) and show some examples of the applications mentioned above.\nGeosci. Model Dev. Discuss.,"}, {"section_title": "Introduction", "text": "As fifth part of a paper series about the MECO(n) system and as such as a component of the ACP / GMD special issue 1 about the Modular Earth Submodel System (MESSy), this article documents a progress of the MESSy code development.\nMore specifically, the second generation of the Multi-Model-Driver (MMD v2.0) is introduced enabling the 2-way nesting between different model instances (basemodels). Thus this article describes a further development of the 1-way nesting system 5 presented in the second part of the paper series (Kerkweg and J\u00f6ckel, 2012b) . We achieve the nesting by coupling different models, thus our 2-way nesting is implemented as 2-way coupling of global and regional atmospheric models. Usually the term \"2-way coupling\" is used in the context of different Earth system compartment models, such as land, ocean or atmospheric models being connected within a comprehensive Earth System Model. Here, 2-way nesting through 2-way coupling is used to distinguish it from fundamentally different other nesting techniques, as for 10 instance local static grid refinement. For a number of atmospheric models grid refinement features exist. Usually, the grid resolution needs to be subdivided by a fixed factor: e.g., 3 for the WRF model (Moeng et al., 2007; Harris and Durran, 2010) or 2 for the ICON model (Zaengl et al., 2015) . These constraints minimise the interpolation error, at least for the horizontal interpolation. Additionally, these models, at least the two mentioned above, deal with the grid refinement areas as different, so-called \"patches\" within the same executable, i.e., they are coupled \"internally\" (see Kerkweg and J\u00f6ckel (2012b) for a 15 discussion of internal and external coupling). In contrast to this, the MECO(n) (MESSy-fied ECHAM and COSMO models nested n-times) system is implemented as an external coupling, i.e., a real 2-way nesting of the same or different basemodels (here COSMO/MESSy and EMAC).\nIn the MECO(n) system we follow this second approach for the following reasons:\n-Different basemodels, EMAC and COSMO/MESSy, are nested into each other, which in itself prevents the \"patches 20 approach\", i.e., it is necessary to couple the model instances externally.\n-Different COSMO/MESSy model instances are nested into each other using the same algorithms as for the EMAC-COSMO/MESSy nesting. The external coupling approach was favoured here, due to limitations of the Fortran95 namespace.\n-A nesting of COSMO/MESSy model instances employing different grids (e.g., rotated differently) is possible. This also 25 includes the possibility to realise an arbitrary resolution jump, i.e., the factor for the grid refinement is freely selectable, in contrast to the fixed factors of 2 or 3 as required by the ICON or the WRF model, respectively.\n-Due to the external coupling, prognostic variables are not necessarily all coupled back to the coarser model. Thus, 2-way nesting does not necessarily imply (full) feedback of the smaller to the coarse scale model. Consequently, the coupling can also be used to couple back diagnostic fields only. 30 course also be possible, but is not implemented. In the rest of the article, we will use the terms \"2-way coupling\" and \"2-way nesting\" synonymously for the approach chosen in the MECO(n) system. This article documents the development of the on-line coupled MECO(n) system, which central part is the MESSy software:\n\"The Modular Earth Submodel System (MESSy) is a software providing a framework for a standardized, bottom-up implementation of Earth System Models (or parts of those) with flexible complexity. \"Bottom-up\" means, the MESSy software provides 10 an infrastructure with generalized interfaces for the standardized control and interconnection (=coupling) of \"low-level ESM components\" (dynamic cores, physical parameterizations, chemistry packages, diagnostics etc.), which are called submodels."}, {"section_title": "MESSy comprises currently about 60 submodels (i.e., coded MESSy conform):", "text": "-infrastructure (= the framework) submodels (sometimes called generic submodels), -diagnostic, atmospheric chemistry and model physics related submodels."}, {"section_title": "15", "text": "The main design concept of MESSy is the strict separation of process description (=process and diagnostic submodels) from model infrastructure (e.g., memory management, input/output, flow control, ...).\nWithin MESSy, the operator splitting is formalized as the fundamental concept. Model codes are organized in 4 conceptual software layers: a basemodel of any level of complexity is complemented by a basemodel interface layer (BMIL). A further interface layer to the submodels (SMIL, submodel interface layer) makes it possible to keep process submodels as distinct 20 as possible in the submodel core layer (SMCL).(Cited from J\u00f6ckel et al., 2015; Baumgaertner et al., 2016, and Roeckner et al., 2006) . The ECHAM/MESSy Atmospheric Chemistry (EMAC) model is a numerical chemistry and climate simulation system that includes sub-models describing tropospheric and middle atmosphere processes and their interaction with oceans, land and human influences (J\u00f6ckel et al., 2010) . 5 COSMO is the regional weather prediction model of the Consortium for Small Scale Modelling (COSMO model, Steppeler et al., 2003; Doms and Sch\u00e4ttler, 1999 ) and the community model of the German regional climate research (Rockel et al., 2008) . By implementing the MESSy interface the COSMO model was expanded to a regional chemistry (climate) model (Kerkweg and J\u00f6ckel, 2012a; Mertens et al., 2016) . 6 The Community Earth System Model version 1.2.1 (CESM1) is a fully coupled climate model. CESM is sponsored by the National Science Foundation (NSF) and the U.S. Department of Energy (DOE). Administration of the CESM is maintained by the Climate and Global Dynamics Laboratory (CGD) at able a standardised expansion by additional or alternative process components (e.g. for physics or chemistry) and diagnostic components, which we call MESSy submodels.\nIn Part 2 of the MECO(n) model documentation the 1-way on-line coupled model system MECO(n) (MESSyfied ECHAM and COSMO models nested n-times) for which MMD was developed initially, was described in detail (Kerkweg and J\u00f6ckel, 2012b ). In the on-line coupled system MECO(n) an arbitrary number of COSMO/MESSy model instances are nested on-line 5 into one master model. This driving model can be either the global EMAC or a coarser COSMO/MESSy model instance.\nOn-line nesting means that the coupled models exchange their data via the computer memory, in contrast to the data exchange via files on disk in common off-line nesting procedures. The data exchange is implemented as client-server system, where the driving model acts as server providing the client model with the data required for the calculation of the inital and boundary fields used to drive the regional model.\nFor all non-prognostic variables only option (a) is possible.\nFor both option a weighting between the original value of the parent field (P) and the child model field (C) is applied:\nHere, i and j are the indices along the horizontal dimensions, k the index along the vertical dimension, and tlev indicates (if applicable) the respective time level.\nMoreover, the code of the desired infrastructure module following this design concept must be -well structured to support flexible expansions,\n-as simple as possible, to keep it maintainable,\n-efficient, i.e., show a good run-time performance and therefore, it must work in a parallel environment and scale appropriately, and\nUsers Guide, Introduction, Jones, 1998).\nSadly, SCRIP provides only algorithms for horizontal grid transformation. Thus two steps are required for the remapping of 3D data fields. First horizontal remapping via SCRIP was conducted, secondly, the vertical remapping is perrformed using NREGRID. Nevertheless, additional vertical interpolation schemes can be easily added if required in the future.\nNaturally, smaller scale models can resolve more processes explicitly. For 2-way applications the questions, if the aggregation of the subgrid-scale information provided by the smaller scale model to the larger scale model constitutes an added value for the larger scale model is still under debate. Most probably, the answer will differ for different processes. For some dynamical processes, e.g. the generation of Rossby waves or Hurricanes (see Sect. 4.3.2), the upscaling might result in an added value, as these phenomena originate from smaller scale disturbances.\nby the COSMO/MESSy instance. Therefore, the uncovered points are filled with the ozone field calculated by EMAC, as for the calculation of the radiative flux in EMAC, global, non-zero fields must be fed into the diagnostic routine. With this ozone field a second, diagnostic radiation call is performed using RAD. Two simulations are investigated:\n-REF: EMAC and COSMO/MESSy are using the same emission data set (MACCIty, Granier et al.,2011 ).\n-SENS: EMAC uses the MACCIty inventory, while COSMO/MESSy applies a DLR specific inventory. "}, {"section_title": "10", "text": "The Multi-Model-Driver (MMD v1.0) provides the software necessary for the data exchange from the server to the client model and for the calculation of the initial and boundary data. MMD consists of two parts: (1) a library which performs the data exchange between the model instances, and (2) MESSy submodels, which organise and process these data.\nIn addition to the functionalities provided by MMD v1.0, the update of MMD provides the possibility to exchange data in both directions during the time integration phase of a simulation. For the unidirectional data exchange the expanded INT2LM software was used to interpolate the data from the driving model grid to the target model grid. This software is a specialised software for the calculation of the initial and boundary data of the COSMO model. Therefore, a different software is required to interpolate the data from the finer to the coarser grid for the data sent from the client model to the server model. According to the MESSy philosophy of strict separation and generalisation, we therefore developed the new generic submodel GRID (v1.0), which is also documented in the present article. GRID is used for all grid mapping operations required during a simulation.\nThe library was extended by a few subroutines enabling the data transfer in both directions. The larger changes occured in the MESSy submodels, as the data processing routines for the back transfer of the data had to be implemented. In the following subsections an overview about the changes and additions made within these two parts of MMD are described. The MMD library Manual and the MMD User Manual in the Supplement provide all technical details about the implementation. between the different MPI-tasks. For longer simulations, check-pointing is required to be able to continue a simulation after hardware failures, for branching off sensitivity studies, and last but not least, it is required to split a simulation into parts, fitting into the typical time limits of a job scheduler on a super-computer. To enable check-pointing, one additional communication step occurs during the integration phase: for the synchronisation of the models w.r.t. the check-pointing, the parent model has to send the information whether the simulation will be interrupted after the current time step. This data exchange is implemented 30 as direct MPI communication using MPI_send and MPI_recv. As the routine MPI_alloc_mem, used to allocate the memory (buffer) required for the data exchange, can only be used in C (and not in Fortran95), some parts of the MMD library are written in C, however most parts are written in Fortran95 for consistency with the POINTER arithmetic used for the MESSy memory management (see J\u00f6ckel et al., 2010 ). The MMD library routines and their usage are described in detail in the \"MMD (v2.0) library manual\" (see Supplement).\n. To avoid artificial jumps in the data fields, a weight function is required, which gradually decreases from 1 in the core domain to zero towards the edge of the domain. The 25 weight function is implemented as a cosine function:\n10 e.g., in the case of the COSMO/MESSy model, only the data below the damping layer should be coupled back.\n-Additionally the time might also be considered as part of the grid, thus treatment of 4-D grids (i.e., 3-D in space + a time axis) might be considered.\n-depending on the application, different grid-transformations for different grid-types, such as -conservative remapping, and -(not necessarily conservative) interpolation.\nvative remapping scheme that is ideally suited to a coupled model context where the area-integrated field (e.g. water or heat flux) must be conserved. The second type of mapping is a basic bilinear interpolation which has been slightly generalized to perform a local bilinear interpolation. A third method is a bicubic interpolation similar to the bilinear method. The last type of remapping is a distance-weighted average of nearest-neighbor points. The bilinear and bicubic schemes can only be used with logically-rectangular grids; the other two methods can be used for any grid in spherical coordinates.\" (Quoted from: SCRIP\nCOSMO/MESSy and EMAC use different radiation schemes, this is one way of a consistent comparison.\nHere, results are shown from simulations using a setup as published by Mertens et al. (2016) . A COSMO/MESSy instance over Europe (0.44\n\u2022 resolution) was nested in the global EMAC domain. The ozone field calculated by COSMO/MESSy was sent back to EMAC using MMD. However, the ozone field coupled back from COSMO/MESSy is zero or undefined outside of the coupled region, i.e., the horizontal and vertical relaxation areas as well as those parts of the globe which are not covered\nIn Fig. 10 and 11 the results obtained with 2-way coupled COSMO/MESSy instances (right panels) are compared to those of the one-way coupled system (left panels). Deviations are validated using the HURDAT data set (Landsea and Franklin, 2013) , which is part of the International Best Track Archive for Climate Stewardship (IBTrACS (v03r04), Knapp et al., 2010, available at http://atms.unca.edu/ibtracs/ibtracs_v03r04/browse-ibtracs/).\nAlthough EMAC is nudged during the genesis phase, the development of ISAAC is not captured by EMAC, as there is no To develop a fully dynamical 2-way coupling for the MECO(n) system, the INT2LM routines need to be replaced by more generic routines to enable a fully consistent coupling in both directions."}, {"section_title": "20", "text": "In the next section we describe the new developments within MMD. As the data mapping between the different grids is central to this further development of MMD, Sect. 3 introduces the newly developed GRID submodel, which provides the required mapping functionalities. Some examples for 2-way data exchange are shown in Sect. 4.\n2 The Multi-Model-Driver (MMD v2.0)\nThe Multi-Model-Driver is the coupling software performing the data transfer between two independent basemodels running 25 within the same MPI environment. Appendix A of Kerkweg and J\u00f6ckel (2012b) provides an overview about different coupling approaches, especially the differences between internal and external coupling are discussed. Furthermore, Sect. 4 of Kerkweg and J\u00f6ckel (2012b) The coupling was implemented following a client-server approach. Therefore, in MMD (v1.0) all routines and modules have been named server (serv) or client (clnt) in accordance to the model using them. In MMD (v2.0) the routines and modules have been renamed to parent and child instead of server and client. This is reasonable, as the term server implies that this model is 5 sending the data. As in MMD (v2.0) data are sent in both directions, the terms parent and child for the coarser and the finer model, respectively, are better suited.\nMMD consists of two parts:\n1. a library performing the data tranfer, which is independent from the coupled models, and 2. the part for data provision and processing implemented as MESSy submodels.\nThe different weight coefficients are:\n-f mn is the relaxation strength. Its value is set in the parent namelist individually for each field.\n-f vw is a vertical weight function. It depends on the vertical index k. In most cases the domain coupled back from the child model does not cover the full height of the parent model\n-designed to cause an as small as possible memory foot print during operation.\nThe infrastructure submodel GRID 12 constitutes such an infrastructure model for MESSy providing the grid definition sturctures and transformation routines.\nFor a grid transformation, first the source and the target grid need to be defined. Second, the transformation between these grids can be calculated. These functionalities are implemented in GRID as follows: (J\u00f6ckel, 2006) and SCRIP (Jones, 1999) .\nThe next two parapraphs provide a short overview of the content of the generic MESSy submodel GRID. The \"GRID User\nManual\" in the Supplement provides detailed information about the usage of the GRID submodel. \nGRID_TRAFO comprises the in EMAC well established standard remapping tool NREGRID (J\u00f6ckel, 2006) and the SCRIP 14 software (Jones, 1999) . While NREGRID is restricted to mapping between orthogonal 2-D or 3-D grids, SCRIP provides transformations to / from curvi-linear or unstructured grids. Here, we use grid \"transformation\" as generic term for both, conservative remapping (or \"regridding\") as well as for (not necessarily conservative) interpolation.\nThe \"geo-hybrid grid\" structure provides all information required for the grid conversion. As each remapping software\nThe backbone of each model is its grid, e.g., for an atmospheric model, the horizontal domain is given by a definition of the longitudes and latitudes of the models grid midpoints and the grid corners. The vertical dimension is usually defined by a height or pressure based coordinate. As this grid (called \"basegrid\" in the following) is the reference for most submodels and processes, the basegrid is defined in the basemodel interface layer (BMIL) for the usage in all MESSy submodels. In case of MMD2WAY, MMD2WAY_CHILD utilises the basegrid as source grid for the mapping to the \"out-grid\".\nFor chemical models, especially the treatment of emissions is of interest. On the one hand, emissions, which depend on soil properties and/or on prognostic variables in the model (the so-called on-line emissions, because they are calculated during the simulation), can substantially differ between models with different resolution. One example are dust emissions, which depend on the 10m wind speed, soil properties and soil moisture (see Sect. 4.3.1). On the other hand, it is normally assumed, that even point and line emissions are instantly mixed within the grid box into which they are emitted. This leads to a higher dilution in 25 larger scale models. Especially in highly polluted regions this might influence the simulated chemical regime. Figure 5 illustrates, as a simple example, the effect on on-line calculated NO soil emissions (Kerkweg et al., 2006b ). These emissions strongly depend on the soil properties and thus differ substantially between the models. As a second example, the dry deposition velocities for ozone are displayed in Fig. 6 (Kerkweg et al., 2006a) . The features discussed for the pervious example appear here as well. Additionally, the ozone dry deposition velocities calculated by 5 COSMO/MESSy are much more evenly distributed in the Mediterranean region, while they are systematically smaller over Eastern Europe, which is most propably due to different soil properties in that region.\nTCs often originate as disturbances of the African Jet Stream, so-called African Easterly Waves (AEWs) over the African continent. In case of suitable conditions over the Atlantic, these AEWs have the potential to develop into TCs and finally to hurricanes. Therefore, forecasting the development, track and intensity of hurricanes requires both, a high model resolution to capture all the multi-scale interactions, prerequisite for the development of the initial TC, and a huge model domain capturing the African continent as well as the Atlantic ocean (e.g., Rappaport et al., 2009; Schwendike and Jones, 2010) ."}, {"section_title": "The MESSy submodel MMD2WAY", "text": "In addition to the library, the MMD software comprises a regular MESSy submodel as \"wrapper\". This submodel provides and 5 processes the data tranfered by the library. MMD (v1.0) contained two MESSy submodels: one for the server (MMDSERV) and one for the client (MMDCLNT). Here, the server controls the timing of the client model and \"serves\" the data, which is processed by the client. In the new MMD version, the client also provides data to the server model. As the difference between the models with respect to the data transfer is thus only the time control of the models, the server and client models have been renamed to parent and child models, thus omitting the impression that only the server acts as \"data server\". Thus 2. the fields required from the parent are read from the &CPL_CHILD_ECHAM or &CPL_CHILD_COSMO namelist in the mmd2way.nml namelist file for ECHAM or COSMO as parent models, respectively. The names of the parent fields are sent to the parent, and in both models pointers to the respective data fields and dimension informations are set.\n3. the exchange matrix, the so-called \"index list\", is set up. This index list provides the information, which grid box (index pair (i p ,j p ) on which parent parallel task (PE p ) exchanges data with which child grid box (i c ,j c ) on which child parallel 20 tasks (PE c ). For this, the child model has to define an \"in-grid\". This is a sub-area of the parent grid (i.e., it has the same rotation and the same mesh size) and completely overlays the child grid. Fig. 3 illustrates the relation between the different grids. Afterwards the data is transformed from the in-grid to the child grid using INT2COSMO 9 .\nDuring the integration phase, the MMD library sends the data from the parent model to the child model. The child model calculates the required initial and boundary conditions from the parent data and transforms additional data to the child grid."}, {"section_title": "25", "text": "This functionality for the 1-way coupling is kept the same in MMD (v2.0). In addition, MMD2WAY_PARENT and MMD2WAY_CHILD have been expanded for the data transfer from the child to the parent model. For most functionalities of the 1-way coupling a counterpart for the data transfer in the other direction could be implemented by keeping the same logic. Thus, a namelist (&CPL_PAR_CHILD) in the parent model namelist file mmd2way.nml determines, which fields are exchanged between the child and the parent model. In the initial phase of a model simulation this information is transferred to the child model. Both models set pointers to their corresponding data objects. Again, the child model has to define a grid, which is a subpart of the parent model grid (called \"out-grid\"), and it has to perform the data transformation from the child model grid to the out-grid. The decision to transform the data within the child model was taken in order to minimize the amount of data to be transferred between the models: as the parent model grid will usually be coarser resolved, data on this grid is exchanged via MMD. For the transformation from the child to the out-grid, the newly written MESSy infrastructure submodel GRID is used 5 (see Sect. 3). At the time being, only conservative remapping is implemented as transformation method. The intepolated data is sent to the parent model, where it is subsequently weighted (if requested) and assigned to the target parent model fields.\nFor the utilisation of the child data by the parent model, two methods are distinguished:\n0: the field is only used as input to the parent model, i.e., this field is independent of other model data objects. In this case, the memory is allocated by MMD2WAY_PARENT, and the transferred field is copied to this memory without any 10 further modifications.\n1: the field is used to modify an existing parent model field.\nUsing method 1, there are two options for modifying a prognostic variable of the parent model:\n(a) the value of the variable can be changed directly, or (b) the tendency of the variable can be modified.\n(NREGRID and SCRIP) relies on its specific structure grid information, GRID_TRAFO additionally provides routines to extract this as required by the respective mapping software, i.e., it provides the \"middleware\" or acts as \"wrapper\" for the established mapping software. The remapping algorithms automatically apply the correct conversion routines, depending on the associated structure components. While the core mapping algorithms differ, GRID_TRAFO provides unified interfaces for the conversion between different grids. The details are explained in the \"GRID User Manual\", which is part of the Supplement\n4 Example Applications using the 2-way coupled MECO(n) system As discussed above, two different types of vertical interpolation routines are used for the two directions in MMD (v2.0):\nfor the parent-to-child data transfer the spline interpolation of INT2LM is used, while GRID is employed for the child-to- parent data transfer. Additionally a height adjustment is required to adopt the 3D data to the different model topographies.\nThe current implementation yields different results for the two data transition directions, which currently prohibits a fully dynamical coupling of the two models over regions with large topographical height differences.\nNevertheless, the current implementation allows for some handy applications, e.g., data can be transferred on-line from the finer to the coarser grid to compare data on the coarse grid. A simple example is provided in Sect. \nAs an example, the development of a hurricane named ISAAC is analysed here. It originated in September 2000 as a TC from an AEW at the West coast of Africa. The National Hurricane Center classified it as a hurricane for the first time on 23 September 12 UTC, before it reached maximum intensity as a category 4 hurricane on 28 September 18 UTC (https://coast.noaa.gov/hurricanes/). Afterwards, its track turned to the north-east and after extratropical transition the system reached Great Britain readily identifable by strong wind gusts two days later.\nCode availability. The code as described is part of the Modular Earth Submodel System (MESSy), which is continuously further developed and applied by a consortium of institutions. The usage of MESSy and access to the source code is licenced to all affliates of institutions which are members of the MESSy Consortium. Institutions can be a member of the MESSy Consortium by signing the MESSy Memorandum of Understanding. More information can be found on the MESSy Consortium Website (www.messy-interface.org). The submodel GRID and the 2-way coupling code are part of the official MESSy distribution (code release v2.53 and younger). \nGeosci. Model Dev. Discuss., doi:10.5194/gmd-2017 Discuss., doi:10.5194/gmd- -87, 2017 Manuscript under review for journal Geosci. Model Dev. "}, {"section_title": "7", "text": "Geosci. Model Dev. Discuss., doi:10.5194/gmd-2017 Discuss., doi:10.5194/gmd- -87, 2017 Manuscript under review for journal Geosci. Model Dev. Discussion started: 25 April 2017 c Author(s) 2017. CC-BY 3.0 License.\nIn Eq. 2 it is assumed that the vertikal index k increases from top to bottom; k min is the height index of the top of the child domain, n k is the number of vertical layers the cosine function should cover.\n-f w is the horizontal weight function : This weight function is required to avoid artificial jumps at the borders of the area, where the fields are relaxed to the child variables. Currently, the user can choose between three different implementations by namelist:\nf w is set to 1 everywhere in the child domain. This option is for testing only, as it may lead to artificial jumps in the data.\n1: f w is implemented as the sum of two cosine functions:\ni max and j max are the number of grid points in the two horizontal directions, respectively. The exponent e is set by If the tendency is subject to change (i.e., method 1, option (b) is used), first the current value of the parent field (P) needs to be calculated from the values at previous time step plus the tendencies of the current time step. This field is modified according 25 to Eq. 1 and an additional tendency is calculated from the difference between the parent fields before and after the modification.\n3 The generic MESSy submodel GRID (v1.0)\nThe generic MESSy submodel GRID provides the basis for all required grid transformations during a MESSy simulation.\nIdeally, such an on-line transformation functionality is implemented as a central part of the models infrastructure, providing a common grid processing functionality. This includes the routines for grid definition, grid modification, and the transformation \u2022 regular grids, which are either orthogonal in geo-coordinates or rotated grids, and\n\u2022 irregular grids"}, {"section_title": "11", "text": ".\nThe 3-D spatial grids consist of one of the above mentioned horizontal grids and of a vertical dimension. The vertical axis can be defined in different ways, e.g., as height or pressure based coordinate."}, {"section_title": "The SubModel Core Layer of GRID", "text": "ESMs usually infer grids in spherical geometry. Three different grid types are distinguishable: (1) regular grids, which are orthogonal in geo-coordinates, (2) regular orthogonal rotated grids (i.e., curvi-linear in geo-coordinates), and (3) unstructured or irregularly geo-located grids.\nMost of the internal data types of GRID follow the netCDF data model. The hierarchical data structures follow mainly 10 those of NCREGRID (J\u00f6ckel, 2006) . The definition of the so-called \"geo-hybrid grid\" structure was extended and generalised for the usage in GRID. During a model simulation, the definition of an arbitrary number of geo-referencing grids and the transformations between those grids are possible. A grid is horizontally defined by geographical longitude and latitude and vertically by hybrid pressure coefficients. For different types of grids, different structures for the definition of the horizontal grid are specified. The GRID SMCL routines also comprise subroutines for the handling of the grid structures, i.e., routines for 15 initialising, copying, importing, exporting and printing a variable of the grid structure type. Beyond that, routines necessary for defining a grid, storing it in a concatenated list, locating an already defined grid within this list, and for comparing grids, are part of the GRID SMCL."}, {"section_title": "GRID_TRAFO", "text": "The main intention of the GRID_TRAFO submodel is to provide routines for the transformation of gridded geo-located data."}, {"section_title": "30", "text": "(doi:10.5194/gmd-0-1-2017-supplement).\n13 Note: The infrastructure submodel previously used in EMAC is named NCREGRID, while the remapping algorithm itself is called NREGRID. 14 Spherical Coordinate Remapping and Interpolation Package\nTo demonstrate the potential of the dynamical 2-way coupling between two COSMO/MESSy instances, a MECO (2) (grey and blue areas)."}, {"section_title": "NREGRID", "text": "The remapping algorithm NREGRID is a recursive algorithm, which is applicable to arbitrary orthogonal (including curvilinear) grids of any dimension. The algorithm does not apply a point-to-point interpolation, but a transformation based on overlapping volumes between the different grids. Details about the NREGRID algorithm have been published by J\u00f6ckel (2006) ."}, {"section_title": "SCRIP", "text": ""}, {"section_title": "5", "text": "As NREGRID is limited to the remapping between equally oriented orthogonal grids, the implementation of an algorithm able to transform between different curvi-linear or even unstructured grids became necessary. For this, the SCRIP software 15 (Jones, 1999) "}, {"section_title": "version 1.4 provided by the Los Alamos National Laboratory has been utilised. SCRIP (a Spherical Coordinate", "text": "Remapping and Interpolation Package) \"is a software package used to generate interpolation weights for remapping fields from one grid to another in spherical geometry. The package currently supports four types of remappings. The first is a conser-"}, {"section_title": "The BaseModel Interface Layer of GRID", "text": ""}, {"section_title": "Simple examples of added value through aggregated subgrid-scale information", "text": "Depending on their resolution, atmospheric models can resolve only certain processes, whereas others have to be parameterised."}, {"section_title": "Use of specific diagnostic tools: radiative forcing", "text": "To evaluate the radiative forcing for two MECO(n) instances consistently, the MESSy submodel RAD (Dietm\u00fcller et al., 2016 ) is used for the calculation of the radiative forcing of a nested COSMO/MESSy instance within the EMAC model. As"}, {"section_title": "Dust", "text": "Dust emissions are very sensitive to the model resolution, as they depend on the soil type and the wind velocity. Typically, dust emission schemes are developed for a specific model resolution and include scaling factors to adapt the emission scheme to other resolutions as good as possible.\nIn our example, we use a MECO (1) "}, {"section_title": "Hurricanes", "text": "Tropical cyclones (TCs), developing at the West coast of Africa over the tropical East Atlantic, are known to be precursors for hurricanes causing damages in the US (e.g., Ike, 2008; Dean, 2009 ) or over Europe (e.g., Helene, 2006 Katia, 2011) . Those"}, {"section_title": "24", "text": "Geosci. Model Dev. Discuss., doi:10.5194/gmd-2017 Discuss., doi:10.5194/gmd- -87, 2017 Manuscript under review for journal Geosci. Model Dev. "}]
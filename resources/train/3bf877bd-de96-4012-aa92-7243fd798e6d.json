[{"section_title": "Introduction", "text": "Alzheimer's disease (AD) is a progressive and irreversible brain degenerative disorder characterized by memory loss and cognitive impairment. At present, there are around 90 million people diagnosed with AD, and it is estimated that the number of AD patients will reach 300 million by 2050 (Zhan et al., 2015; Zhu et al., 2015) . To date, no effective drug treatments are available to cure AD, while the existing AD medicines can only ease symptoms or slow down its progression. Thus, the detection of AD at its early or prodromal stage is important for the prevention and intervention of its progression.\nFor example, mild cognitive impairment (MCI) is a prodromal stage of AD (Silveira M, 2015) . In the past few decades, neuroimaging technologies have been widely used to discover the relevant biomarkers in the human brain for AD and MCI diagnosis. Magnetic resonance imaging (MRI) is a non-invasive imaging technology that can produce detailed 3D anatomical images of internal body structures such as the brain, and has been widely used to help us understand anatomical and functional brain changes related to AD (Herrup, 2011; Jack et al., 2008; Jr et al., 2011) . In particular, structural MRI scans provide detailed information about the anatomical structures of the brain, which can help detect and measure brain atrophy patterns in AD.\nIn recent years, many machine learning models have been employed to analyze the MRI data for identifying biomarkers and deciphering the disease etiology (Cao et al., 2018; Cao et al., 2017; Cheng and Wang, 2017; Hosseini-Asl et al., 2016; Jr et al., 2011; Liu et al., 2018a; Liu et al., 2018b; Ortiz et al., 2016; Suk et al., 2015; Zhang et al., 2016; Zhang et al., 2017) . One common approach is to partition brain MRI scans into multiple regions of interest (ROIs) and extract ROI features such as volumes and shapes for AD diagnosis (Herrup, 2011; Suk et al., 2015; Zhang et al., 2011) . For example, Zhang et al. proposed to extract the volumetric features from 93 ROIs and train a support vector machine (SVM) classifier for AD diagnosis (Zhang et al., 2011) . A multi-task method was proposed to select the most discriminative features from 93 ROIs for multimodal classification of AD/MCI (Ye et al., 2016) . An approach was proposed to combine the marginal fisher analysis with norm-based multi-kernel learning to achieve the sparsity of ROIs, which could simultaneously select a subset of relevant brain regions and learn a dimensionality transformation (Cao et al., 2017) . A deep network with stacked autoencoder was employed on the ROI features to extract the latent high-level features for improving the performance of disease classification using neuroimaging data . A set of anatomical landmarks were detected from MRI to extract the morphological features for AD diagnosis Liu et al., 2018b; Zhang et al., 2016; Zhang et al., 2017) .\nRecently, deep learning networks, including convolutional neural networks (CNNs), have been widely used in image classification and computer vision (Chen et al., 2016; Liu et al., 2017; Liu et al., 2018b; Liu et al., 2014; Ng et al., 2015; Simonyan and Zisserman, 2014; Wang et al., 2017) . The deep 3D CNNs were used to extract the features of 3D medical images for classification (Hosseini-Asl et al., 2016) . A multi-task deep learning (MDL) method was proposed for joint hippocampal segmentation and clinical score regression using MRI scans (Cao et al., 2018) . Given the very high dimensionality of the brain MRI data, it requires huge computational resources and a large dataset to train a deeper CNN with robustness. Since the MRI datasets used for AD diagnosis are typically very small compared with the datasets used in computer vision, it remains a major challenge to train a deeper CNN model with a large number of parameters to be learned (Gray et al., 2011) . Recently, a classification scheme with an ensemble of deep learning architectures was proposed for early diagnosis of AD (Ortiz et al., 2016) . In this approach, the gray matter (GM) image of each brain was split into 3D patches according to ROIs defined by the Automated Anatomical Labeling (AAL) atlas, and different deep belief networks were trained with the patches of different ROIs and followed by an ensemble with a voting scheme for final prediction. Meanwhile, a landmark-based deep feature learning (LDFL) framework for AD diagnosis was proposed to use a CNN model for extraction of the patch-based representation from a set of anatomical landmarks Liu et al., 2018b) .\nAmong all brain ROIs, the hippocampus is one of the first affected regions in AD, and it is an important anatomical region in the AD etiology. In many MRI studies for AD diagnosis, people proposed to compute the shape and volume features from bilateral hippocampi (Amoroso et al., 2018; Beg et al., 2013; Chupin et al., 2009; Gerardin et al., 2009; Ho et al., 2011; Leung, 2010; Lindberg et al., 2012; Platero and Tobar, 2016; Shen et al., 2012; Xin et al., 2012) . Chupin el al. proposed a fully automatic method for hippocampal segmentation using probabilistic and anatomical priors and the hippocampal volumes were computed for AD diagnosis . A fast multiple-atlas segmentation method was proposed to measure hippocampal volume for discriminating AD/MCI patients from NC using MRI scans (Platero and Tobar, 2016) . However, the volumetric analysis only assesses global changes of the hippocampus and is limited by the variety of hippocampal volumes among different individuals. To alleviate this problem, shape analysis was often used to capture detailed hippocampal morphology for AD diagnosis (Beg et al., 2013; Gerardin et al., 2009; Lindberg et al., 2012) . It could unveil local atrophy of the hippocampus. In (Lindberg et al., 2012) , hippocampal shape analysis was performed by modeling the surface of 3D hippocampal structure using the spherical harmonic shape description (SPHARM).\nThere remain several problems with the existing hippocampal analysis methods. First, both hippocampal volumetric and shape analyses depend on accurate segmentation of the hippocampus. But it is still a challenging task to accurately segment the hippocampus due to its irregular shape and blurred boundary in MRI scans. Second, the hand-crafted features of hippocampal volumes and shapes may not be optimal for the subsequent analysis, which may affect classification performance in disease diagnosis. Third, using the hippocampus alone may not be sufficient for discriminating MCI from NC subjects. Other regions adjacent to the hippocampus such as the parahippocampus and amygdala are also affected in early stage of AD. Finally, the visual and texture features of MRI scans derived from the hippocampal region can be of great help for AD diagnosis (Ahmed et al., 2015; Xin et al., 2012) .\nTo address the above problems in the computer-aided AD diagnosis, we propose a new deep learning framework with a combination of multiple deep CNN models for simultaneous hippocampal segmentation and disease classification using MRI data. In our framework, we first construct a multitask deep CNN model for jointly learning hippocampal segmentation and disease classification. Then, a 3D Densely Connected Convolutional Network (3D DenseNet) model is developed with the inputs of 3D patches extracted based on the hippocampal segmentation results to learn rich features. Finally, the learned features by the multi-task deep CNN model and the DenseNet model are combined with a fully connected layer to yield a final classification of disease status. The proposed multi-model framework will be shown to outperform each single model method. Our method is evaluated for both hippocampal segmentation and disease classification, where we use the baseline T1-weighted structural MRI data from the ADNI database including 97 AD, 233 MCI, and 119 NC subjects. In addition, we also test our method on an additional dataset of 135 subjects from the ADNI MRI cohort with the EADC-ADNI Harmonized Protocol (HarP) for manual hippocampal segmentation (Boccardi et al., 2015) ."}, {"section_title": "Materials and methods", "text": "As shown in Fig. 1 , our proposed deep learning framework consists of two deep learning models. One model is a multi-task deep CNNs for jointly learning hippocampus segmentation and disease classification, which generates a binary segmentation mask of the hippocampus and learns features for disease classification. However, the learned features by the multi-task model are not sufficient for accurate disease classification. A 3D patch covering the hippocampus is extracted based on the centroid of the segmentation mask and input into a 3D DenseNet model that learns more relevant features for disease classification. Finally, a fully connected layer and a softmax layer are appended to combine the learned features from these models for final disease classification. In this study, two classes are considered in the classification task. The input of this framework is a large image patch covering the hippocampus. The outputs are the hippocampus mask as well as the prediction of disease status. "}, {"section_title": "Data source and preprocessing", "text": "The data were obtained from the ADNI database, which is publicly available on the website (http://www.loni.ucla.edu/ADNI). The ADNI was launched in 2003 by the National Institute on Aging (NIA), the National Institute of Biomedical Imaging and Bioengineering (NIBIB), the Food and Drug Administration (FDA), private pharmaceutical companies and non-profit organizations, as a $60 million, 5-year public-private partnership. The primary goal of the ADNI was to test whether serial MRI, Positron Emission Tomography (PET), other biological markers, and clinical and neuropsychological assessments could be combined to measure the progression of MCI and early AD.\nThe subjects were recruited from over 50 sites across the U.S. and Canada, gave written informed consent at the time of enrollment for imaging and genetic sample collection and completed questionnaires approved by each participating site's Institutional Review Board (IRB).\nWe randomly selected 449 participants, including 97 AD, 233 MCI, and 119 NC subjects, from whom the baseline T1-weighted MR imaging data and the pre-processed images are available in ADNI. Table 1 shows the demographic and clinical information of these subjects, where the CDR denotes the Clinical Dementia Rating and MMSE denotes the Mini-Mental State Examination. We used the MR images acquired with 1.5T scanners according to the ADNI acquisition protocol (Jack et al., 2008) . More detailed information about the image acquisition procedures is available on the ADNI website. All MR images were resampled to 256\u00d7256\u00d7256 voxels of size 1\u00d71\u00d71 mm\u00b3. They were skullstripped and cerebellum-removed after correction of intensity inhomogeneity using a nonparametric non-uniform intensity normalization (N3) algorithm (Sled et al., 1998; Wang et al., 2011) . With 12 degrees of freedom and the default parameters, we performed the affine registration to align all MR images to a template image using FMRIB Software Library (FSL) 5.0 from https://fsl.fmrib.ox.ac.uk/. Since directly labeling the hippocampus from scratch by radiologists would be time-consuming, FIRST from FSL (the FMRIB Software Library) (Morey et al., 2009 ) was used as a starting tool to obtain a rough segmentation. Three radiologists worked together to check the initial FIRST segmentation for each subject and reached a consensus after a discussion to produce a final segmentation by manual editing. Fig. 2 shows several examples of hippocampal segmentation results before and after correction together with their hippocampal image patches. Table 2 shows quantitative measures of hippocampal volumes (i.e., mean, standard deviation, and range) before and after manual correction for different groups of subjects. We can see that the mean and standard deviation of hippocampal volume are reduced after correction. Fig. 3 shows the scatterplots of left and right hippocampal volumes for the studied AD, MCI and NC subjects.\n(a) (b) (c) Fig. 2 . Examples of hippocampal image patches: (a) patches without segmentation labels, (b) patches overlaid with segmentation labels before manual correction, and (c) patches overlaid with segmentation labels after manual correction. Subj1, Subj2, and Subj3 are three example subjects randomly selected from the AD, MCI and NC groups respectively. The hippocampus is a small region located in the medial temporal lobe of the human brain. The number of voxels in the hippocampus is much smaller than those of background, which would result in a severe class-imbalance problem. After image preprocessing and affine registration, we crop each MR image into a 3D image patch with a bounding cube for each hippocampus. The bounding cubes are defined as 3D axes to extract 3D patches from MR images. The size of the bounding cube has some effects on hippocampus segmentation. Using a large bounding cube not only increases the computation cost but also may result in the class-imbalance problem. However, using a small bounding cube may lose important context information for hippocampal segmentation. To balance the tradeoff, we empirically set the optimal size of the bounding cube to 64\u00d748\u00d764 voxels. Based on the patches, we construct the deep learning model for hippocampal segmentation and disease classification in the following sections."}, {"section_title": "Multi-task deep CNN for joint hippocampal segmentation and disease classification", "text": "Different from the conventional methods that perform hippocampal segmentation and disease classification separately, we propose a multi-task CNN model for jointly learning hippocampal segmentation and disease classification. CNN is a special type of multi-layer neural network widely used in image classification and object detection (Krizhevsky et al., 2012; L\u00e9cun et al., 1998; Zhu et al., 2015) . A volumetric and fully CNN named \"V-Net\" was proposed for the prostate segmentation in MRIs (Milletari et al., 2016) . Motivated by the success of V-Net in prostate segmentation, we exploited a similar network structure to develop a multi-task deep CNN model for joint hippocampal segmentation and disease classification.\nA deep CNN has been formulated to learn residual functions at the convolutional stages to achieve fast convergence. We define two residual blocks as \"ResNet Block1\" and \"ResNet Block2\", consisting of 3D convolutional, batch normalization (BN), Parametric Rectified Linear Unit (PReLU) activation and dropout layers as shown in Fig. 4 . In ResNet Block1, a residual function is learned by a short connection: the input is added to the output of the second convolutional layer. ResNet Block2 consists of two convolutional layers and the input of each block is added to both the outputs of the second and third convolutional layers to learn the residual function. The kernels are trained with supervision from the batches of MRI data. Small kernels have fewer numbers of parameters to train for fast inference.\nLarge kernels learn much more complex patterns and have a stronger expressive power. This effect can be achieved by stacking more convolutional layers of small kernels. Therefore, the kernel size is set to 3\u00d73\u00d73 for all convolutions. The learned filters are convolved with the input image followed by a non-linear PReLU activation and a feature map is generated for each filter.\n(a) (b) Fig. 4 . The network architecture of (a) ResNet Block1 and (b) ResNet Block2, consisting of 3D convolution, PReLU, BN, and dropout layers.\nAs illustrated in Fig. 1 , this multi-task deep CNN model consists of two parts: shown on the left is a procedure of compressing feature maps, and shown on the right is a procedure of decompressing feature maps to their original patch size. The left compression part has two blocks of ResNet Block1 and two blocks of ResNet Block2 followed by down-sampling for each block, while the right decompression part comprises of two blocks of ResNet Block1 and one block of ResNet Block2 followed by up-sampling for each block. Table 3 lists the details of relevant parameters for the multitask deep network model. In the compression part, down-sampling is used to reduce the size of feature maps and increase the receptive field of features in the subsequent layers. It is implemented by convolution with the kernels of size 2\u00d72\u00d72 and stride 2. In the decompression part, the spatial support of the lower resolution feature maps is expanded to extract features and assemble the necessary information to generate a volumetric segmentation mask. The up-sampling by de-convolution is performed with the kernels of 2\u00d72\u00d72 and stride 2. Then, a convolutional layer with 1\u00d71\u00d71 kernel and stride 1 is performed to generate the outputs with the same size as the input patch, which are converted to probabilistic segmentation of the hippocampal regions by applying voxel-wise softmax. Finally, the threshold is set to 0.5 to convert the probabilistic output to a binary mask. As shown in Fig. 1 , the deep network outputs the hippocampal mask and disease status prediction.\nFor hippocampal segmentation of subject m, the optimization objective is to minimize the Dice loss function which evaluates the capability of our model to segment hippocampal voxels from the background:\nwhere N is the number of total voxels on the segmentation output; and are the predicted segmentation result and the ground truth label of voxel i, respectively; is a small value to prevent denominator from being zero. The Dice loss function can deal with situations where a strong imbalance exists between the numbers of foreground and background voxels (Sled et al., 1998) . As to classification, a fully connected layer is stacked to concatenate the outputs of the compression part and each layer of the decompression part, which integrates information from two sources to enhance classification accuracy. The loss function for classification of subject m is the categorical crossentropy loss to evaluate the difference between the predicted label and the ground truth label as follows:\nThe loss function for the multi-task deep CNN model is a weighted sum of the segmentation loss and classification loss, calculated as follows:\nwhere M is the total number of subjects; \" # and \" are the ground truth label and the predicted label for subject m. The parameter * \u2208 .0, 1/ is a weight to adjust for the losses in training the hippocampal segmentation and disease classification. During the training procedure of the multi-task deep CNN model, the segmentation task is more important than classification at the early stage while the classification task takes effect at the late stage when the segmentation objective function value converges. In our implementation, the value of * evolves throughout the training process. During the initial warm-up phase, * is set to 1 to emphasize on the segmentation task. Then it changes to 0.5 for multi-task training. In the final phase, * is set to 0 to focus on the classification task. The joint optimization of the multi-task network model is performed with the Adam method, and a backpropagation algorithm is used to calculate the network gradients. However, this may cause information loss when the input passes through many layers to reach the end of network. DenseNet is proposed to connect each layer to every other layer in a feed-forward fashion, which increases direct connections between the low and high level layers (Huang et al., 2016) ."}, {"section_title": "The deep 3D DenseNet model", "text": "Compared with traditional CNN, DenseNets have several advantages. First, they can alleviate the vanishing-gradient problem since there is a direct connection from the low to high-level layers. Second, feature propagation is strengthened to reuse the low-level features. Third, they can reduce the number of parameters. Table 4 shows the structure and parameters of our proposed 3D DenseNet model, consisting of a convolutional layer, 4 dense blocks, 3 transition layers, a global average pooling layer, and a softmax layer. First, a convolutional layer was added to the input layer with stride 2, followed by dense blocks.\nThen, the dense block uses dense connectivity through which the l-th layer receives the feature maps of all preceding layers (Huang et al., 2016) as follows:\nwhere .3 6 , 3 , , \u2026 , 3 48, / is the concatenation of feature maps from all previous layers into a single tensor, and 5 4 denotes a composite nonlinear transformation function of four consecutive operations:\nBN, PReLU, 3\u00d73\u00d73 convolution, and voxel-wise dropout. Dense block includes three dense layers with each layer consisting of one 1\u00d71\u00d71 and one 3\u00d73\u00d73 convolutional layers, two BN layers and two activation layers. Every dense layer receives the feature maps of all previous dense layers by shortcut connections. A transition layer, which consists of five consecutive operations: BN, PReLU, a 1\u00d71\u00d71 convolution, voxel-wise dropout and a 3\u00d73\u00d73 convolution with a 2\u00d72\u00d72 stride, is set between two dense blocks for feature map reduction. Following the last dense block, an average pooling and a softmax classifier are appended to reduce feature dimension and classify disease status. The subject labels are used through back-propagation for updating the weights of DenseNet. All layers of DenseNet receive direct supervision from loss function through shortcut connections. For training DenseNets, the initial weights for the whole network are uniform and Adam optimizer is adopted with a learning rate of 10-4, The network is stable after iteration of 120 epochs. The batch size is set to 64 and PReLU is used for each neuron of DenseNet. Dropout layers are used to alleviate the overfitting problem. The DenseNet models for the left and right hippocampi have the same structure but are trained individually with different patches for the classification task."}, {"section_title": "Final multi-model ensemble classification", "text": "The multi-task deep CNN model captures the multi-level features for joint hippocampal segmentation and disease classification, while the deep 3D DenseNet model learns the features from the image patches of the hippocampus for disease classification. To integrate these deep models, we further stack an extra fully connected layer above the concatenation of the learned features from deep models for disease classification. The DenseNet models and multi-task model are individually trained, and a fully connected layer followed by a softmax layer is finely tuned to make the final classification. They are implemented with Keras library in the framework of Tensorflow. We will show that the proposed multi-model deep network framework outperforms the single-model approaches."}, {"section_title": "Results", "text": ""}, {"section_title": "Datasets and implementation", "text": "The proposed deep learning framework was tested on the structural MRI data from the baseline visits of 449 ADNI participants consisting of 97 AD, 233 MCI, and 119 NC subjects. Both hippocampal segmentation and disease classification tasks were conducted for method evaluation. The classification task was tested to distinguish AD vs. NC and MCI vs. NC. We randomly divided the whole MRI data set into 5 folds and 5-fold cross-validation was used to train and test the proposed method. Each time, In our implementation, the trade-off parameter * in the loss function of our multi-task deep CNN framework evolved from 1 to 0 throughout the training process. We tested the segmentation and classification tasks by setting * to 1 or 0 for single task learning and setting * to 0.5 for multi-task learning. Shown in Table 5 and 6 is the comparison of the segmentation and classification results by setting different \u03b1's for single and multi-task learning as well as the proposed adaptive method. From the results, we can see the multi-task learning with fixed \u03b1 performs better than single-task learning for classification. The proposed adaptive method performs better than the single-task and multi-task learnings with fixed \u03b1 for both segmentation and classification. From Table 5 , we can see better segmentation results on NC subjects than AD subjects even though the training set includes AD subjects. This may be caused by the hippocampal atrophy of AD and its variation among different subjects, which introduces difficulties in both automatic and manual segmentations. "}, {"section_title": "Results on hippocampal segmentation", "text": "In this experiment, we tested the performance of the proposed framework on hippocampus segmentation in terms of DSC, PPV, SEN_S, and VE and compared the results with different parameter settings. We also performed empirical comparation with a few other competing methods. The inputs of our multi-task deep CNN framework were 3D image patches obtained by cropping MR images with a bounding cube for each hippocampus. The first experiment was to test the effects of various bounding cube sizes on the segmentation results. We gradually increased the bounding cube size from 48\u00d740\u00d748, 64\u00d748\u00d764 to 88\u00d780\u00d788 to test hippocampal segmentation. The results in Table 7 demonstrate that the segmentation performance is improved by increasing the cube size from 48\u00d740\u00d748 to 64\u00d748\u00d764 and is degraded by further increasing the cube size to 88\u00d780\u00d788. While a small boundary bounding cube might have limited context information, a large bounding cube could include unnecessary background voxels increasing both overfitting risk and computational burden.\nWith this observation, we set the bounding cube to 64\u00d748\u00d764 in the following experiments. Second, we compared the segmentation results of our method with other three methods including FSL and two deep learning-based methods (Cao et al., 2018; Thyreau et al., 2018) , denoted as \"FSL\", \"Thyreau's method\" and \"Cao's method\", respectively. FSL is a comprehensive library of analysis tools for fMRI, MRI and DTI brain images. The FIRST algorithm in the FSL library was used for hippocampal segmentation on our dataset. However, 27 subjects have large segmentation errors due to internal registration failure. In building the reference segmentation, these errors were manually corrected by the radiologists. For fair comparison, these subjects were removed for performance evaluation. Thyreau's method (Thyreau et al., 2018) (Cao et al., 2018) was proposed to construct a multi-task deep learning method for joint hippocampal segmentation and clinical score regression. For fair comparison, we rebuilt the multi-task deep network as in (Cao et al., 2017) , which were trained and tested on our data set. Fig. 6 shows the comparison of the segmentation results using different methods for three example subjects selected from the AD, MCI and NC groups of the test data, respectively. The original images, the segmented results of FSL, Thyreau's method, Cao's method, our method and ground truth are demonstrated in columns from left to right in Fig. 6 . From the original images, we notice that it is not easy to distinguish the hippocampal regions from the adjacent tissues due to the small difference between their intensity values. The segmented hippocampal regions obtained by our method appear to be smoother and more accurate than those by other methods. In addition, Table 8 (Boccardi et al., 2015) . This dataset consists of 135 subjects from the ADNI MRI cohort balanced by magnet field strength, age ranges, diagnosis, medial temporal atrophy, and scanner manufacturers. We used the MNC MR images and the nifti hippocampal labels released on their website (http://www.hippocampal-protocol.net/SOPs/index.php). First, we directly tested our trained segmentation model on this new dataset, denoted as \"Our model on the new dataset\". Second, we retrained and tested our segmentation model on this new dataset by 10-fold cross-validation strategy, denoted as \"Retrained model on the new dataset\". The comparison of results in Table 9 demonstrate that the performance is poor when our model is directly tested on the new dataset due to potentially different strategies for labeling the hippocampus. But the retrained model can work well on this new HarP dataset. "}, {"section_title": "Results on disease classification", "text": "Our proposed method by integrating the multi-task deep CNN and DenseNet models was tested on disease classification. The first experiment was to test the classification performances of DenseNet when compared to other deep networks such as the popular LeNet (L\u00e9cun et al., 1998) and VGGNet (Simonyan and Zisserman, 2014) . The LeNet network consists of 2 convolutional layers followed by 2 fully connected layers, while VGGNet consists of 13 convolutional layers and 3 fully connected layers.\nThus, VGGNet has a deeper architecture with significantly more layers than LeNet. They were implemented with the released codes by replacing the 2D convolutions with 3D ones. Table 10 compares the classification results of AD vs. NC and MCI vs. NC by different deep networks. We could see that our DenseNet outperformed LeNet and VGGNet. The second experiment was to test the effects of different patch sizes used to train DenseNet on the classification performance. The large patch covers more information near the hippocampus for classification. In our experiment, the patch size was gradually increased from 50\u00d740\u00d748 to 68\u00d750\u00d764. Table 11 shows the results of different patch sizes using DenseNet for classifying AD vs. NC and MCI vs. NC. We also compared the classification results obtained with the method combining multi-task deep CNN model and DenseNet, as shown in Table 12 . The comparison demonstrates the classification results are improved by increasing the patch size from 50\u00d740\u00d748 to 62\u00d748\u00d758. The large patch requires more memory and computational time for both training and testing. The patch of 62\u00d748\u00d758 was used to train DenseNets in our following experiments. It should be mentioned that this patch size is optimal based on the results of our dataset but it may not be optimal for other datasets.\nThe results show that there is no great difference in the AUC with the patch size over 62\u00d748\u00d758. For simplicity, the same patch size can be used for both hippocampus segmentation and disease classification. The third experiment was to test the classification performances of the multi-task deep CNN model, the DenseNet model and the combination model. Table 13 shows the results of three models for classifying AD vs. NC and MCI vs. NC. Fig. 7 (a) and (b) show the ROC curves of three models for classifying AD vs. NC and MCI vs. NC, respectively. The DenseNet model greatly outperformed the multi-task deep CNN model for disease classification, suggesting that the features learned by\nDenseNet is more important for disease classification. The combination model outperformed both the multi-task deep CNN and DenseNet models, indicating that the features of individual models could contain complementary information for disease classification. "}, {"section_title": "Comparison with other methods", "text": "We compared our proposed method to other existing methods based on structural MRI data. First, the proposed deep learning-based method was compared to other methods based on hand-crafted features such as the hippocampal volume, the GM volumes of ROIs and voxel-wise features used in some previous publications Liu et al., 2012; Zhang et al., 2011 ). An automatic method was proposed for hippocampal segmentation and hippocampal volumes were extracted for AD diagnosis . Instead of just focusing on hippocampal volumes, 93 ROIs were parcellated in the brain and their volumetric features were calculated to train SVM classifiers for AD classification (Zhang et al., 2011) . To capture fine-level features, the voxel-wise tissue densities were calculated for ensemble sparse classification of AD (Liu et al., 2012) . These features are hand-crafted from one-region, multi-region to voxel levels and are widely used for AD diagnosis.\nTo extract the hippocampal volumes, we used the segmentation masks obtained by the multi-task deep model. The volumes from the left and right hippocampi were normalized by the total intracranial volume for classification. For extraction of the ROI and voxel-wise features, we followed the same procedures as those in (Liu et al., 2012; Zhang et al., 2011) . We performed the tissue segmentation and nonlinear registration using the FAST model in the FSL package (Zhang et al., 2001) and the registration tool of HAMMER (Shen and Davatzikos, 2002) . FAST was used to segment the MRIs into three different tissues: GM, WM, and CSF, while HAMMER was used for the nonlinear image registration and mapping the image onto 93 manually labeled ROIs (Kabani et al., 1998) . For each labeled image, the normalized GM volumes from 93 ROIs were calculated as features for classification. After the image warping through HAMMER, the warped mass-preserving tissue volumes reflected the spatial distribution of tissues in an original brain and were used as the voxelwise features for classification. Furthermore, Lasso (Kim and Kim, 2004 ) was used to select the most discriminative ROI and voxel-wise features for classification. To evaluate the impact of features, the same preprocessing procedures were performed for each image, and the Multi-Layer Perceptron (MLP) model with two fully connected layers followed by a softmax layer was used for classification with different features.\nIn addition, one direct method is to build a deep DenseNet model on the whole brain image, which is denoted as \"Whole MRI DesnseNet\". The whole MR image of 256\u00d7256\u00d7256 voxels is too large to train the DenseNet model with our GPU GTX 1080 Ti because of the memory limit. Therefore, we removed the voxels of zeros values and down-sampled the images by 2, and finally obtained images of 98\u00d778\u00d776 voxels for training a DenseNet model. We also performed data augmentation by shifting the down-sampled image to train a robust model. Table 14 shows the comparison of classification performances with the above features as well as our proposed method. Fig. 8 (a) and (b) illustrate the ROC curves of our proposed method and other methods for classifying AD vs. NC and MCI vs. NC, respectively. It is worth noting that the results in Table 14 and Fig. 8 were obtained based on different feature extraction methods, not the design of classifier, so the results may be different from those reported in the literature. Furthermore, we have compared our classification results with those reported in the literature using the baseline sMRI data of ADNI, as shown in Table 15 . The compared methods include the conventional learning-based methods (Cao et al., 2017; Ye et al., 2016; Zhang et al., 2016) and deep learning-based methods (Korolev et al., 2017; Lian et al., 2018; Liu et al., 2014) , as briefly described as follows. In the conventional learning-based methods (Ye et al., 2016; Zhang et al., 2016) , the SVM classifier was used for classification with the engineered features from ROIs or landmarks. A multikernel learning was proposed to simultaneously conduct feature selection, manifold learning and oversampling with the ROI features for AD diagnosis (Cao et al., 2017) . The deep learning models such as\nResidual and plain 3D CNNs and stacked auto-encoders were investigated for AD and MCI diagnosis (Korolev et al., 2017; Liu et al., 2014) . A fully hierarchical convolutional network was proposed to identify discriminative patches and regions from the whole brain sMRI, upon which multi-scale features were jointly learned and fused to construct hierarchical classification models for AD diagnosis (Lian et al., 2018) . The results show that our proposed method based on hippocampal region obtained competitive performances when compared with the methods that use whole-brain sMRI. These empirical comparison studies validated the efficacy of our proposed method. It is worth noting that the different results may be caused not only by the methods and but also by different ADNI subjects and partitions of training and testing sets. (Azar et al.) .\nTraining a deep model is not an easy task as the current datasets for hippocampal segmentation and disease classification are relatively small compared to the computer vision tasks. To alleviate this challenge, the data augmentation by shifting three coordinates was used to improve the robustness of the model. Fig. 9 (a) and (b) show the loss curves of the multi-task deep model for both training and validation on hippocampus segmentation and disease classification, respectively, while Fig. 9 (c) shows the loss curves of DenseNet model for both training and validation on the classifications of AD vs. NC and MCI vs. NC. The results show that the loss curves of hippocampal segmentation converges after 40 epochs, while the loss curves of all disease classifications converge when the training epoch grows to 80. The loss convergence of AD vs. NC classification is faster than that of MCI vs. NC because the classification of MCI vs. NC is more challenging than that of AD vs. NC.\n(a) (b) (c) Fig. 9 . The loss curves of the multi-task deep model for (a) hippocampus segmentation and (b) disease classification, and (c) the loss curves of DenseNet model for classifying AD vs. NC and MCI vs. NC on both training and validation, denoted as \"AD vs. NC train\", \"MCI vs. NC train\", \"AD vs. NC val\", \"MCI vs. NC val\", respectively.\nAs for the computational complexity, the proposed deep learning combination method includes both the offline training and online testing stages. In the offline training stage, the computational cost includes training the multi-task deep CNN model and the DenseNet model, which take 0.93 hours and 1.40 hours in our experiments, respectively. Thus, it takes about 2.33 hours to train the whole combination model. In the online testing stage, it takes 0.29s and 0.85s on average to test the proposed algorithm for segmentation and classification of a given image, respectively, which demonstrates the usefulness of the proposed method in a real application. All the experiments were conducted on a PC with Ubuntu14.04-x64 and GPU NVIDIA GeForce GTX1080 Ti of 11 GB memory. The over-fitting problem was alleviated by using dropout techniques and data augmentation. The inverted dropout was used on the CNN layers, which performed the scaling at training time, leaving the forward pass at test time untouched.\nAlthough the proposed method can jointly learn the feature extraction and classification model to achieve optimal diagnosis performance, it has limitations in medical interpretation and characterization of the learned features relevant to disease (i.e., AD or MCI) for clinical application.\nThe learned features are limited in providing su cient clinical information for understanding brain abnormalities. To facilitate the interpretability, we adopted a visualization technique proposed in (Simonyan et al., 2013) based on computing the gradient of the class score for the input image. An image-specific class saliency map was generated to highlight the discriminative areas of a given image to disease classification. We generated the saliency maps of the hippocampus patches of all test images and then calculated the average of them for illustration as shown in Fig. 10 . The saliency maps indicate how the network learns the importance of corresponding areas in the prediction of disease status. The deeper the highlighted color is, the more relevant the covered region is to disease diagnosis. The highlighted areas were observed covering the regions that are important for AD diagnosis, such as hippocampus, amygdala, and parahippocampal gyrus, etc.. "}, {"section_title": "Conclusion", "text": "In this study, we proposed a new classification framework based on multi-model deep CNNs for jointly learning hippocampal segmentation and disease classification. First, a multi-task deep CNN model was constructed to jointly learn the features for hippocampal segmentation and disease classification. Based on the segmented hippocampal region, an additional 3D DenseNet was built to learn the rich and detailed image features for disease classification. Finally, the learned features from the multi-task CNN and DenseNet models are combined to classify disease status. The proposed framework can not only output the disease status, but also provide the hippocampal segmentation result. No tissue segmentation and nonlinear registration are required for MR image processing. The experimental results based on the ADNI dataset have demonstrated that our proposed approach has achieved promising performance for AD and MCI diagnosis. "}]
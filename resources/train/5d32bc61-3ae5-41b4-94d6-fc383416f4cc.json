[{"section_title": "Abstract", "text": "Abstract. We propose a method to predict the subject-specific longitudinal progression of brain structures extracted from baseline MRI, and evaluate its performance on Alzheimer's disease data. The disease progression is modeled as a trajectory on a group of di\u21b5eomorphisms in the context of large deformation di\u21b5eomorphic metric mapping (LDDMM). We first exhibit the limited predictive abilities of geodesic regression extrapolation on this group. Building on the recent concept of parallel curves in shape manifolds, we then introduce a second predictive protocol which personalizes previously learned trajectories to new subjects, and investigate the relative performances of two parallel shifting paradigms. This design only requires the baseline imaging data. Finally, coe cients encoding the disease dynamics are obtained from longitudinal cognitive measurements for each subject, and exploited to refine our methodology which is demonstrated to successfully predict the follow-up visits."}, {"section_title": "Introduction", "text": "The primary pathological developments of a neurodegenerative disease such as Alzheimer's are believed to spring long before the first symptoms of cognitive decline. Subtle gradual structural alterations of the brain arise and develop along the disease course, in particular in the hippocampi regions, whose volumes are classical biomarkers in clinical trials. Among other factors, those transformations ultimately result in the decline of cognitive functions, which can be assessed through standardized tests. Being able to track and predict future structural changes in the brain is therefore key to estimate the individual stage of disease progression, to select patients and provide endpoints in clinical trials.\nTo this end, our work settles down to predict the future shape of brain structures segmented from MRIs. We propose a methodology based on three building blocks : extrapolate from the past of a subject ; transfer the progression of a reference subject observed over a longer time period to new subjects ; and refine this transfer with information about the relative disease dynamics extracted from cognitive evaluations. Instead of limiting ourselves to specific features such as volumes, we propose to see each observation of a patient at a given time-point as an image or a segmented surface mesh in a shape space.\nIn computational anatomy, shape spaces are usually defined via the action of a group of di\u21b5eomorphisms [1, 16, 17] . In this framework, one may estimate a flow of di\u21b5eomorphisms such that a shape continuously deformed by this flow best fits repeated observations of the same subject over time, thus leading to a subjectspecific spatiotemporal trajectory of shape changes [8, 12] . If the flow is geodesic in the sense of a shortest path in the group of di\u21b5eomorphisms, this problem is called geodesic regression [4, 5, 8, 12] and may be thought of as the extension to Riemannian manifolds of the linear regression concept. It is tempting then to use such regression to infer the future evolution of the shape given several past observations. To the best of our knowledge, the predictive power of such a method has not yet been extensively assessed. We will demonstrate that satisfying results can only be obtained when large numbers of data points over extensive periods of time are available, and that poor ones should be expected in the more interesting use-case scenario of a couple of observations.\nIn such situations, an appealing workaround would be to transfer previously acquired knowledge from another patient observed over a longer period of time. This idea requires the definition of a spatiotemporal matching method to transport the trajectory of shape changes into a di\u21b5erent subject space. Several techniques have been proposed to register image time series of di\u21b5erent subjects [11, 18] . They often require time series to have the same number of images, or to have correspondences between images across time series, and are therefore unfit for prognosis purposes. Parallel transport in groups of di\u21b5eomorphisms has been recently introduced to infer deformation of follow-up images from baseline matching [10, 15] . Such paradigms have been used mostly to transport spatiotemporal trajectories to the same anatomical space for hypothesis testing [6, 13] . Two main methodologies have emerged: either by parallel-transporting the time series along the baseline matching as in [5] , or by parallel-transporting the baseline matching along the time series as in [14] . We evaluate both in this paper.\nIn any case, these approaches require to match the baseline shape with one in the reference time series. Ideally, we should match observations corresponding to the same disease stage, which is unknown. We propose to complement such approaches with estimates of the patient stage and pace of progression using repeated neuropsychological assessments in the spirit of [14] . These estimates are used to adjust the dynamics of shape changes of the reference subject to the test one, according to the dynamical di\u21b5erences observed in the cognitive tests.\nAmong the main contributions of this papers are : the first quantitative study of the predictive power of geodesic regression ; a new methodology for the prediction of shape progression from baseline ; the evaluation of its accuracy for two di\u21b5erent parallel shifting protocols ; new evidence of the utter importance of capturing the individual dynamics in Alzheimer's disease models. Section 2 sets the theoretical background and incrementally describes our methodology. Section 3 presents and discusses the resulting performances."}, {"section_title": "Method", "text": "Let (y j ) j=1,..,ni be a time series of segmented surface meshes for a given subject i 2 {1, ..., N}, obtained at the ages (t j ) j=1,..,ni . We build a group of di\u21b5eomor-phisms of the ambient space which act on the segmented meshes, following the procedure described in [3] . Flows of di\u21b5eomorphisms of R 3 are generated by integrating time-varying vector fields of the form v(t,\n.,ncp and (t) = [ k (t)] k=1,..,ncp are respectively the control points and the momenta of the deformation.\nWe endow the space of di\u21b5eomorphisms with a norm which measures the cost of the deformation. In the following, we only consider geodesic flows of di\u21b5eomor-phisms i.e. flows of minimal norm connecting the identity to a given di\u21b5eomor-phism. Such flows are uniquely parametrized by their initial control points and momenta c 0 = c(0), 0 = (0). Under the action of the flow of di\u21b5eomorphisms, an initial template shape T is continuously deformed and describes a trajectory in the shape space, which we will note t ! (c 0 , 0 ) (T, t). Simultaneously, we endow the surface meshes with a varifold norm k \u00b7 k which allows to measure a data attachment term between meshes without point correspondence [3] ."}, {"section_title": "Geodesic regression", "text": "In the spirit of linear regression, one can perform geodesic regression in the shape space by estimating the intercept T and the slope (c 0 , 0 ) such that (c 0 , 0 ) (T, \u00b7) minimizes the following functional :\nwhere R is a regularization term which penalizes the kinetic energy of the deformation. We estimate a solution of equation (1) with a Nesterov gradient descent as implemented in the software Deformetrica (www.deformetrica.org), where the gradient with respect to the control points, the momenta and the template is computed with a backward integration of the data attachement term along the geodesic [2] . Once an optimum is found, we obtain a description of the progression of the brain structures which lies in the tangent space at the identity of the group of di\u21b5eomorphisms. It is natural to attempt to extrapolate from the obtained geodesic to obtain a prediction of the progression of the structures."}, {"section_title": "Two methods to transport spatiotemporal trajectories of shapes", "text": "As it will be demonstrated in section 3, geodesic regression extrapolation produces an accurate prediction only if data over a long time span is available for the subject, which is not compatible with the goal of early prognosis.\nAs proposed in [10, 19] , given a reference geodesic, we use the Riemannian parallel transport to generate a new trajectory. We first perform a baseline matching between the reference subject and the new subject, which can be described as a vector in the tangent space of the group of di\u21b5eomorphisms. Two paradigms are available to obtain a parallel trajectory. [15] advises to transport the reference regression along the matching and then shoot. In the shape space, this generates a geodesic starting at the baseline shape ; for this reason, we call this solution geodesic parallelization, and is illustrated on Figure (A1) . On the other hand, [14] advocates to transport the matching vector along the reference geodesic and then build a trajectory with this transported vector from every point of the reference geodesic, as described on Figure (B1). We will call this procedure exp-parallelization.\nIn such a high-dimensional setting, the computation of parallel transport classically relies on the Schild's ladder scheme [9] . However, in our case the computation of the Riemannian logarithm may only be computed by solving a shape matching problem, resulting not only in an computationally expensive algorithm but also in an uncontrolled approximation of the scheme. To implement these parallel shifting methods, we use the algorithm suggested in [19] , which relies on an approximation of the transport to nearby points by a well-chosen Jacobi field, with a sharp control on the computational complexity. The same rate of convergence as Schild's ladder is obtained at a reduced cost."}, {"section_title": "Cognitive scores dynamics", "text": "The protocol described in the previous section has two main drawbacks. First, the choice of the matching time in the reference trajectory is arbitrary : the baseline is purely a convenience choice and ideally the matching should be performed at similar stages of the disease. Second, it does not take into account the pace of progression of the subject. In [14] , the authors propose a statistical model allowing to learn, in an unsupervised manner, dynamical parameters of the subjects from ADAS-cog test results, a standardized cognitive test designed for disease progression tracking. More specifically, they suppose that each patient follows a parallel to a mean trajectory, with a time reparametrization :\nwhich maps the subject time to a normalized time frame, where \u21b5 > 0 and \u2327 are scalar parameters. A high (resp. low) \u21b5 hence corresponds to a fast (resp. slow) progression of the scores, when a negative (resp. positive) \u2327 corresponds to an early decay (resp. late decay) of those scores. In the dataset introduced below, the acceleration factors (\u21b5 i ) i range from 0.15 to 6.01 and the time-shifts (\u2327 i ) i from 20.6 to 22.8, thus showing a tremendous variability in the individual dynamics of the disease, which must be taken into account. With these dynamic parameters, the shape evolution can be adjusted by reparametrizing the parallel trajectory with the same formula (2), as illustrated on Figures (A2) and (B2). "}, {"section_title": "Results", "text": ""}, {"section_title": "Data, preprocessing, parameters and performance metric", "text": "MRIs are extracted from the ADNI database, where only MCI converters with 7 visits or more are kept, for a total of N= 74 subjects and 634 visits. Subjects are observed for a period of time ranging from 4 to 9 years (5.9 on average), with 12 visits at most. The 634 MRIs are segmented using the FreeSurfer software. The extracted brain masks are then a nely registered towards the Colin 27 Average Brain using the FSL software. The estimated transformations are finally applied to the pairs of caudates, hippocampi and putamina subcortical structures.\nAll di\u21b5eomorphic operations i.e. matching, geodesic regression estimation, shooting, exp-parallelization and geodesic parallelization are performed thanks to the Deformetrica software previously mentioned. A varifold distance with Gaussian kernel width of 3 mm for each structure and a deformation kernel width of 5 mm are chosen. The time discretization resolution is set to 2 months.\nThe chosen performance metric between two sets of meshes is the Dice coefficient, that is the sum of the volumes of the intersections of the corresponding meshes, divided by the total sum of the volumes. We only measure the volume of the intersection between corresponding structures. The Dice coe cient is comprised between 0 and 1 : it equals 1 for a perfect match, and 0 for disjoint structures."}, {"section_title": "Geodesic regression extrapolation", "text": "The acceleration factor \u21b5 in equation (2) encodes the rate of progression of each patient. Multiplying this coe cient with the actual observation window gives a notion of the absolute observation window length, in the disease time referential. Only the 22 first subjects according to this measure have been considered for this section : they are indeed expected to feature large structural alterations, making the geodesic regression procedure more accurate. The geodesic regression predictive performance is compared to a naive one consisting in leaving the last observed brain structures in the learning dataset unchanged. Table 1 presents the results obtained for varying learning dataset and extrapolation extents. We perform a Mann-Whitney test with the null hypothesis that the observed Dice coe cients distributions are the same to obtain the statistical significance levels. The extrapolated meshes are satisfying only in the case where all but one data points are used to perform the geodesic regression, achieving a high Dice index and outperforming the naive one, by a small margin though and failing to reach the significance level (p = 0.25). When the window of observation becomes narrower, the prediction accuracy decreases and becomes worse than the naive one. Indeed, the lack of robustness of the -although standardsegmentation pipeline imposes a high noise level, which seems to translate into a too low signal-to-noise ratio after extrapolation from only a few observations. Figure 1 displays an extrapolated geodesic regression for a specific subject, with a large learning period of 72 months, and a prediction at 108 months from the baseline (Dice performance of 0.74 versus 0.65 with the naive approach)."}, {"section_title": "Non reparametrized transport", "text": "Among the 22 subjects whose regression-based predictive power has been evaluated in the previous section, the two which performed best are chosen as references for the rest of this paper. Their progressions are transported onto the 73 other subjects with the two di\u21b5erent parallel shifting methods.\nIn more details, for each pair of reference and target subjects, the baseline target shape is first registered to the reference baseline. The reference geodesic regression is then either geodesically or exp-parallelized. Prediction performance is finally assessed : the Dice index between the prediction and the actual observation, for the two modes of transport, are computed and compared to the Dice index between the baseline meshes and the actual observation -the only available information in the absence of a predictive paradigm.\nThe upper part of Table 2 presents the results. In most cases, the obtained meshes by the proposed protocol are of lesser quality than the reference ones, according to the Dice performance metric. The two methods of transport are essentially similarly predictive, although geodesic parallelization slightly outperforms the exp-parallelization for the M12 prediction. Exp-parallelization of the reference subject s0906 (first column) towards the subject s1080 (second column), giving predictions for ages 81.6, 82.6, 83.6, 84.6 and 85.6 (years). On the third column are added the target brain structures (red wireframes), segmented from the original images."}, {"section_title": "Refining with cognitive dynamical parameters", "text": "The two reference progressions are transported through geodesic and exp-parallelization onto all remaining subjects. After time-reparametrization, the obtained parallel trajectories then deliver predictions for the brain structures. Figure 3 displays a reference geodesic and an exp-parallelized curve. The predicted progression graphically matches the datapoints, and it can be noticed that the final prediction at age 85.6 (Dice 0.73) outperforms the corresponding one on Figure 2 , obtained without time-reparametrization (Dice 0.69).\nQuantitative results are presented in the lower part of Table 2 . At the exception of the M12 prediction, both protocols outperform the naive one. The M36, M48, M72 and M96 predictions are the most impressive ones, with p-values always lesser than 1%. This shows that the pace of cognitive score evolution is well correlated with the pace of structural brain changes, and therefore allows an enhanced prediction of follow-up shapes.\nNo conclusion can be drawn concerning the two parallel shifting methodologies, a single weak significance result being obtained only for the M12 prediction where the geodesic parallelization method slightly outperforms the expparallelization one with a Dice score of 0.888 versus 0.882."}, {"section_title": "Conclusion", "text": "We conducted a quantitative study of geodesic regression extrapolation, exhibiting its limited predictive abilities. We then proposed a method to transport a spatiotemporal trajectory into a di\u21b5erent subject space with cognitive declinederived time reparametrization, and demonstrated its potential for prognosis. The results show how crucial the dynamics are in disease modeling, and how cross-modality data can be exploited to improve a learning algorithm. The two main paradigms that have emerged for the transport of parallel trajectories were shown to perform equally well in this prediction task. Nonetheless, the exp-parallelization o\u21b5ers a methodological advantage in that the generated trajectories do not depend on a particular choice of point on the reference geodesic, in contrast with the trajectories obtained by geodesic parallelization. It takes full advantage of the isometric property of the parallel transport, and eases the combination with time-warp functions based on the individual disease dynamics.\nIn future work, more complex time reparametrization could be considered as in [7] . Finally, the robustness of the proposed protocol to the choice of reference subject has not been assessed. Such a choice could be avoided by constructing an average disease model as in [15] , or by translating for shapes the method of [14] . We may also use this framework to estimate a joint image and cognitive model to better estimate individual dynamical parameters of disease progression."}]
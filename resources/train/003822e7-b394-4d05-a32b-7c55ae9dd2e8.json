[{"section_title": "Abstract", "text": "Abstract. Longitudinal measurements of cortical thickness is a current hot topic in medical imaging research. Measuring the thickness of the cortex through time is normally hindered by the presence of noise, partial volume (PV) effects and topological defects, but mainly by the lack of a common directionality in the measurement to ensure consistency. In this paper, we propose a 4D pipeline (3D + time) using the Khalimsky cubic complex for the extraction of a topologically correct Laplacian field in an unbiased temporal group-wise space. The thickness at each time point is then obtained by integrating the probabilistic segmentation (transformed to the group-wise space) modulated by the Jacobian determinant of its deformation field through the group-wise Laplacian field. Experiments performed on digital phantoms show that the proposed method improves the time consistency of the thickness measurements with a statistically significant increase in accuracy when compared to two well established 3D techniques and a 3D version of the same method. Furthermore, quantitative analysis on brain MRI data showed that the proposed algorithm is able to retrieve increasingly significant time consistent consistent group differences between the cortical thickness of AD patients and controls."}, {"section_title": "Introduction", "text": "The extraction of 4D consistent measurements of thickness from anatomical structures is an important post processing step in neuroimaging. For example, changes in the thickness of the cerebral cortex are of interest in various diseases such as Alzheimer's and Huntington's disease, having the potential to provide a biomarker for diagnosis and neurodegeneration [1] . However, the reliable extraction of 4D consistent and sub-voxel accurate measurements of thickness from probabilistic segmentations is still an unsolved problem.\nIn order to provide accurate longitudinal measurements, we require that the measurement of thickness is preformed in a consistent direction and location on all time points. Thickness estimation methods, mostly developed for independent 3D time points, can be separated into surface-based and voxel-based techniques. Surface based methods [2] fit a triangulated mesh to the cerebral cortex, making them computationally expensive, especially due to topological constraints. Also, the parametrisation of the surface can be complex and curvature constraints and smoothness parameters can bias the thickness measurements [3] . Voxel-based methods on the other hand extract the value of thickness directly from the voxel grid and are computationally very efficient, but their accuracy is limited by the image resolution and the quality of the segmentation. Nonetheless, voxel based methods have been shown to preform as well as surface based methods [4] . Overall, voxel-based methods can be clustered into 3 subgroups: mathematical morphology [5] based methods use a combination of skeletonisation and region growing techniques in order to calculate the minimal Euclidean distance between points. Partial differential equation (PDE) based methods [6, 7, 8] solve the Laplace equation between the inner and outer surfaces as if they were charged conductors, resulting in isopotential electric field lines between them. The thickness is then equal to the sum of the lengths of the normals to these isolines. Even though certain topological constraints over the shape of the surfaces are theoretically required, Laplace equation based methods are normally used without enforcing them [8] . Finally, line integral based methods calculate thickness of the structure of interest by finding the direction that minimises the line integrals over its probabilistic segmentation at each voxel position. This method was recently extended to 4D [9] by finding a time consistent directionality between time-points. However, it still lacks topological consistency. In order to solve the problems regarding topology, [10] proposed a method that combines the features of all the above voxel-based methods in a unified, fully automated Khalimsky based thickness estimation algorithm, that is topologically correct and partial-volume aware. This method uses the properties of the Khalimsky grid and an iterative set of element collapse operations to correct the topology of the segmentation. The corrected segmentation is then used to create a multi-stage Laplacian field that encompasses the partial-volume containing areas. The streamlines of this Laplacian field are then integrated using a PDE based method with a spatially varying speed function that is dependent on the probabilistic segmentation.\nWe propose to extend the above described method [10] in order to encompass 4D consistency. Here, all the time points are registered to an unbiased temporal group-wise space and a group-wise segmentation is then obtained by means of a multivariate EM segmentation algorithm specifically designed for cortical thickness estimation [10] . A multistage Laplacian is then calculated on the temporal group-wise space, and the per time point values of thickness are then obtained by integrating over the single time point segmentations along the temporal group-wise derived streamlines."}, {"section_title": "Method", "text": ""}, {"section_title": "Proposed Pipeline", "text": "The pipeline of most 3D cortical thickness algorithms can be described in 3 steps:\n1. The image is segmented into several classes; 2. An implicit or explicit correspondence from one side of the cortex to the opposite side is then found using a multitude of methods; 3. Finally, the thickness is measured according to a specific metric. Any of these steps can be altered in order to introduce temporal consistency. However, altering steps 1 or 3 will directly affect the measurement of thickness, as either the segmentation or the thickness metric itself would be affected by a constraint. This can reduce the statistical significance of difference measurements between groups, leading to increased sample sizes. In order to maintain the sensitivity of the measurement intact but still achieve temporal consistency, we propose to constrain only the direction of the measurement, by changing step 2. The proposed 4D cortical thickness pipeline consists of five steps, as shown on Fig.1 . For the sake of simplicity, assume a series of skull stripped brain images acquired at 3 different time points. The five steps can the be described as:\n1. The images are segmented independently using a previously published voxel based probabilistic segmentation algorithm [11] specifically designed for cortical thickness. This segmentation will separate the brain into 5 classes: WM, cortical and deep GM and internal and external CSF. The cerebellum is removed within the same pipeline by atlas propagation. Here, the segmentations from the deep GM and internal CSF are added to the WM segmentation in order to create a class containing all the internal structures, simply called WM for the sake of clarity. 2. An unbiased group-wise registration is then created between all the time points. This iterative registration [12] process results in a transformation T t for each time point t to the average group-wise space. All the skull stripped images and respective segmentations are transformed to this space. 3. In order to create a group-wise segmentation, a multivariate version of the same algorithm [11] is used. Here, the segmentation model assumes that each label is not only a realisation of one image (time point) but a combined multivariate realisation of all time points, leading to a segmentation with a high level of cortical detail. 4. A topologically correct Laplacian field map is created using the group-wise segmentation as described in section 2.2 and 2.3. This Laplacian map has the directionality information derived from the group-wise segmentation. 5. This common directionality is then used at each time point to drive a PDE based thickness measure with a speed function proportional to the transformed segmentation modulated by the Jacobian of this transformation, as described in section 2.4\nThe topologically correct Laplacian field in step 4 constrains the time consistent direction of thickness measurement. This consistency is important as the correspondences between both sides of the cortex can change dramatically on simple 3D models due to sulci and gyri opening and closing."}, {"section_title": "Topology Preservation and the Khalimsky's Cubic Complex", "text": "Topology-preserving operations are used in many image analysis applications in order to transform an object while leaving its topological characteristics unchanged. Notwithstanding their simplicity, topology-invariant operations in the voxel space have some well-described problems regarding the minimality of the set and the existence of lumps [13] . Abstract complexes, like the Khalimsky space provide a sound topological basis for image analysis. Intuitively, a cubic complex can be seen as a space where every voxel is represented by a structure composed of a set of elements having various dimensions (e.g. cubes, squares, edges, vertices) put together according to some rules. Please refer to [13] for a complete formal description of the cubic complex framework. As shown in [10] , this abstract space provides a sound basis for digital topology and topology correction but also an interesting framework for the extraction of thickness measurements. In order to correct the topology, a series of collapse operations are used to transform a shape into another in a topologically invariant manner [10] . In short, this topology correction step can be described as a 4 step procedure involving Khalimsky based collapse operations, as shown in Fig. 2 . The first to steps can be described as a shrink wrap operation in the Khalimsky space in order to obtain a topologically correct WM segmentation. Then, the same operation is performed on the opposite direction in order to correct the topology of the CSF class."}, {"section_title": "Multi-Stage Laplace Equation on the Group-Wise Space", "text": "In order obtain a 4D consistent measurement of thickness at each time point, a unique association between two sides of the cortex is required. For this purpose, we use the Laplace equation, a second order partial differential equation (PDE), solved between two enclosed boundaries \u03a9 and \u03a9 in the group-wise space. The classic equation takes the form \u2207 2 \u03c6 = 0, with the value at \u03c6 \u03a9 and \u03c6 \u03a9 set up as boundary conditions. Similarly to [10] , instead of a single Laplacian field for all the pure voxels as in [6, 7, 8] , a multiple Laplacian field is solved. This obviates the problems regarding the estimation of surface normals for PV integration using ray casting [8] . A set of isolines is generated for each tissue type from the topologically correct group-wise segmentation. The Laplace equation is then solved between these four equipotential lines resulting in a smooth transition field traversing the cortex. The solution of this Laplace equation under an anisotropic voxel grid in the Khalimsky space is presented in [10] .\nFrom the resultant Laplacian field, the normals to the direction of the Laplacian isolines in the group-wise space, denoted by N GW , are calculated using finite differences."}, {"section_title": "Thickness Measurement at Each Time Point", "text": "In order to measure thickness, the length of the streamlines between the inner and outer surface has to be measured at each time point by integrating the vector field N GW on the group-wise space. Because digital topology is not preserved even under diffeomorphic transformations, each time point has to be deformed to the group-wise space using the previously computed group-wise transformation. In order to measure thickness, instead of the basic form partial differential equation proposed by Yezzi [7] , where the speed of the advancing front is assumed to be 1, we use a more generalised form of the PDE. Here\nfor an unknown function L t at time-point t and assuming that N GW and f t are known. In our case, and differently from [6, 7, 14, 8] , the value of f will be spatially varying and equal to the probability of belonging to the cortical GM modulated by the Jacobian determinant of the transformation,\nThis value will act as time cost and will make the value of L t equivalent to the time of arrival in a level-set framework. Modulation by the Jacobian determinant is necessary in order to take the voxel compression into account. Even though collisions of the advancing front might exist, they are not a problem due to the upwind nature of the integration and the existence of the group-wise vector field\nbe a function that measures the time of arrival (arc length of the streamline according to the time cost f t ) from the boundary of set F W Mpure on the group-wise space to a point in the object, and L t 1 (x,y,z) be the time of arrival from the boundary of set F CSFpure , again in the group-wise space, to the point in the object. The values of L0 and L1 are calculated using anisotropic finite differences, as described in [10] . The final value of thickness is then defined as T hick t = L0 t + L1 t . In order to reduce the bias of any further statistical analysis, the value of thickness is only calculated at mid-isopotential line on the group-wise Laplacian field. The ribbon containing the thickness measurements will thus have spherical topology (Euler characteristic of 2) and will be in the same space for all time points."}, {"section_title": "Experiments and Results", "text": "The experimental section of this paper is divided into two subsections. First, a digital phantom with time evolving ground truth thickness is used to assess the accuracy and sensitivity of the proposed algorithm compared to three 3D state-of-the-art methods. The proposed method is then applied to brain MRI data in order to assess group separation in terms of cortical thickness between Alzheimer's disease diagnosed patients and controls."}, {"section_title": "Phantom validation:", "text": "In order to evaluate if the proposed method can accurately retrieve the underlying thickness of an object, 7 folded 3D digital phantoms with spherical topology and known ground truth thickness were created (Fig. 3) , resulting in six high resolution isotropic images with 3 structures equivalent to WM, GM and CSF. The thickness of the object is changing with time from 5.2 to 3.6mm in order to simulate a thickness loss in an object over several time points. Note that the sulci will open after time-point 1. These high resolution phantoms were then down-sampled by 5 in order to simulate PV effect and the thickness of the down-sampled structures was then measured. We compare the proposed 4D method with the 3D version of the same algorithm, the method proposed by Jones et al. [6] and the method proposed by Acosta et al. [8] .\nResults show that all 3D methods are highly sensitive to temporal structural changes. When compared to the ground truth, the thickness change in time is overestimated, possibly due to sulci opening. The proposed method, on the other hand, uses a 4D consistent directionality derived from all the time-points, resulting in a much more accurate and precise thickness estimation. One should be cautious when reporting cortical thickness loss in time, as 3D methods can severely overestimate it. TP1  TP2  TP3  TP1  TP2  TP3  TP1  TP2  TP3  TP1  TP2 "}, {"section_title": "Brain MRI analysis:", "text": "To further investigate the temporal consistent of the proposed method, the thickness of the cortical layer was calculated on the ADNI dataset at 3 time points. The main purpose of this study was not to evaluate group separation between different groups but to assess their stability in time.\nFrom the full ADNI dataset, a subset of 60 age-and gender-matched subjects (30 AD and 30 controls ) were selected. Each subject has T1-weighted 1.5T MRI volumetric images acquired using a 3D MPRAGE sequence (typically 1.20 \u00d7 1.00 \u00d7 1.00mm) at 0, 12 and 24 months. Fig. 4 shows the progression of the distribution of the average value of thickness within the cortex at each time point, normalised to the average thickness over all time points. Due to the lack of time consistency, unexpected inversions of the thinning pattern occur on the 3D version of the algorithm. The 4D version of the algorithm shows a marked improvement regarding the stability of the thinning pattern. This leads to a reduction of the standard deviation of the thickness distributions within each group, increasing the statistical power. In order to compare the different groups (AD and controls) on a per area basis, the group-wise space was parcelated into different areas using the an anatomical atlas. The 3D method shows statistically significant differences in thickness (p < 10 \u22123 ) on both the temporal and parietal region. The frontal region is statistically significantly thinner (p < 10 \u22123 ) at both time-points 1 and 3 but it but does not achieve the significance threshold at time-point 2. On the other hand, the proposed 4D method shows statistically significant differences in thickness at the level p < 10 \u22125 in the middle and inferior temporal and parietal regions and p < 10 \u22123 in the frontal gyrus region in the first time point. From time point 2 onwards, the frontal region becomes significant at p < 10"}, {"section_title": "\u22125", "text": "and both the superior and occipital regions become statistically significant at p < 10 \u22123 . Due to the lack of 4D consistency in the segmentation, cortical lost might be over-estimated. In order to investigate this, future work will explore the use of a 4D segmentation step for improved consistency. We will also consider the use of the full Jacobian matrix for the modulation step instead of it's determinant."}, {"section_title": "Conclusions", "text": "In this paper we present a new method to extract 4D measurements of thickness from cortical segmentations. First, all the time points are registered to an unbiased and temporal consistent group-wise space. Then, a time consistent group-wise point-to-point correspondence is found by means of a multistage Laplacian field derived from a multivariate segmentation in the group-wise space. This common directionality is then used to calculate the thickness at each time point.\nExperiments on digital phantoms with known ground truth thickness show that the proposed method is more accurate and precise at retrieving true thickness values than other previously published methods, thereby reducing the overestimation of cortical thinning in the presence of sulci opening. Quantitative analysis on brain MRI data showed that the proposed algorithm is able to retrieve increasingly significant time consistent consistent group differences between the cortical thickness of AD patients and controls."}]
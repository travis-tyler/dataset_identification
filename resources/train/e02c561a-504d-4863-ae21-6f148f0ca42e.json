[{"section_title": "Abstract", "text": "Abstract"}, {"section_title": "Introduction", "text": "Neuroimaging studies the measurement of brain structures and functions and their changes during development, aging, learning, disease, and evolution [27] . Modern techniques analyze noninvasive neuroimaging data typically obtained from structural Magnetic Resonance Imaging (sMRI) and fluorodeoxyglucose positron emission tomography (FDG-PET) by using mathematical and statistical methods. A ubiquitous approach for neuroimaging research is population based analysis, e.g. voxel based morphometry (VBM) [46] [5] [45] [7] and tensor based morphometry (TBM) [16] [12] [44] . They are being widely used to identify differences in the local composition of brain tissue while discounting large-scale differences in gross anatomy and position [26] . VBM/TBM studies the brain abnormality by non-linearly registering the brain images and comparing the local differences among brain tissues and their functions voxel by voxel in order to obtain the statistical significance between groups and to discover the general trend of disease burden and progression. The past decade has witnessed a growing interest in developing new techniques to automatically quantify the abnormality of brain structure and functions, especially for the study of neurodegenerative diseases such as Alzheimer's disease (AD) [10] [40] .\nHowever, prior works (e.g. [38] ) have shown that the statistically significant voxels obtained from the group difference studies do not necessarily carry strong statistical power for computer-aided diagnosis (CAD). In clinical settings, doctors prefer single indices as biomarkers because single indices best quantify the brain structures and functions for individuals rather than in the group level which has less clinical effectiveness. A single neuroimaging index provides a practical reference for evaluating disease progression and for effective treatments. Yet the automated analysis of brain diseases (e.g. AD) based on single indices faces many challenges largely because these single indices can hardly represent the complicated shape or metabolic activity of the entire human cerebral cortex. Most researchers focus on developing indices from region of interest (ROI) study (e.g. [10] ). However, the ROI-based techniques require prior knowledge and precise segmentation which is a major limitation that could result in inconsistency across different studies [42] . In randomized clinical trials (RCT), the regulatory agencies prefer single valued outcome measure which does not require statistical correction for multiple regional comparisons. Moreover, functional imaging techniques such as FDG-PET often suffer from low resolution and noises, which prevents traditional methods from accurate analysis. Therefore, it is highly advantageous for clinical diagnosis and prognosis that we develop a unified, robust method that works on different modalities to quantify the shape of the cerebral cortex with a single index.\nWe have observed that after segmentation and normalization, 3D brain images can be treated as 3D probability distributions in the Euclidean domain, where (1) the intensity of each voxel is non-negative, (2) the total intensity is one, and (3) the distance between two voxels is the Euclidean distance. Therefore, the problem of comparing brain images can be converted to the problem of comparing the corresponding distributions. The Wasserstein distance, which is a numerical value, measures the similarity between two probability distributions in a given metric space. It is obtained by solving the underlying optimal transportation problem which is to measure the minimum cost for moving the total mass of one distribution to another. Thus, optimal transportation (OT) is often referred to as optimal mass transport (OMT) and so is the Wasserstein distance as the earth mover's distance. Recently, the Wasserstein distance has proved itself to be a robust shape descriptor for 3D surfaces. Rabin et al computed the Wasserstein distance on 3D surfaces to perform shape retrieval [31] . Solomon et al proposed the convolutional Wasserstein distance and explored many of its applications including shape interpolation and skeleton layout [36] . In [37] and [33] , the Wasserstein distance were applied to brain surfaces to find the correlation between IQ and brain shapes, and Alzheimer's disease and brain shapes, respectively. L\u00e9vy [25] generalized a surface optimal transportation algorithm to 3D and solved it with quasi-Newton method. ur Rehman et al [39] solved OT on the sMRI for 3D registration, which reveals the feasibility to compute the Wasserstein distance on 3D brain volumes.\nDespite of the convenience of using the Wasserstein distance to measure distributions, a limiting factor is the computational complexity of solving the optimal transportation problem. This is especially true when dealing with high dimensional distributions, and is the reason that ur Rehman et al [39] adopted GPU to improve efficiency. In practice, some methods seek to approximate the optimal transportation in order to avoid heavy computation, e.g. [36] [15] .\nIn this paper, we introduce a numerically efficient algorithm to compute the optimal transportation with Newton's method. Based on the algorithm, we propose a framework for indexing brain images. First, we normalize the images and re-discretize them in order to obtain their tetrahedral representations. Then, we compute the optimal transportation between the tetrahedral meshes and obtain the 3D Euclidean Wasserstein distance between them. Because of its properties as a metric and its sensitivity to the difference between two measures, the Wasserstein distance servers as a univariate neuroimaging index to distinguish between individual images and between images in the group level. We apply our framework on two modalities of brain imagessMRI and FDG-PET -and verify the Wasserstein distance as a univariate index in distinguishing Alzheimer's disease patients from cognitively normal people. Our results show that the Wasserstein distance is a highly stable feature and provides a relatively high classification accuracy of 82.30% on sMRI and 88.37% on FDG-PET with boosting.\nThe contribution of this research is threefold. First and foremost, we explore the potential of the Wasserstein distance as a univariate neuroimaging index in the analysis of both sMR and FDG-PET images. Second, we provide an alternative to score the changes in brain tissue and their functions from their appearance on brain images. We model the brain tissues and functions with their intrinsic geometric structure and obtain a shape distance between each pair. To our knowledge, this is the first time that a geometric approach has been proposed to quantify the whole brain change on FDG-PET. Third, we propose a framework based on the variational optimal transportation to compute the 3D Euclidean Wasserstein distances of brain images. The variational framework is efficient, which makes it advantageous for working with large-scale and high dimensional datasets."}, {"section_title": "Preliminaries", "text": "We first introduce the problem of optimal transportation in the context of brain image analysis. We also describe volumetric harmonic mapping in 2.2, which provides a convex canonical space for computing optimal transportation ."}, {"section_title": "Optimal Transportation", "text": "Suppose M (m, \u03bc) and N (n, \u03bd) are two metric spaces with probability measures.\nIn other words, \nFor simplicity, T opt is replaced by T in the rest of the paper. In the context of brain mapping under discrete settings, given two brain images M (m, \u03bc) and N (n, \u03bd), the problem becomes to find the OT, T : M \u2192 N , such that the cost is the minimum. And we call the minimum cost the Wasserstein distance between M and N , which is defined as: "}, {"section_title": "The cost c(\u00b7) is defined as the quadratic Euclidean distance between a voxel and its map, c(m, T (m)) = m\u2212T (m)", "text": "2 . The Wasserstein distance is a metric that quantifies the similarity of two domains which in our case are two brain images. The details of the optimal transportation problem and the properties of the Wasserstein distance can be found in [19] [23] [41] and [8] ."}, {"section_title": "Volumetric Harmonic Mapping", "text": "A tetrahedral mesh M can be regarded as a simplicial complex K under embedding f : |K| \u2192 R 3 . Suppose m i and m j are two adjacent vertices in the mesh, and f (m i ) and f (m j ) are their coordinates in R 3 . Then, our goal is to find the f that minimizes a string energy,\nis called the string constant. Different definitions of k determine different types of string energy. Suppose an edge (m i , m j ) is shared by n tetrahedra. Then we define the harmonic string constant as\nwhere l t is the length of the edge to which edge (m i , m j ) is against and \u03b8 t denotes the dihedral angle on that edge. Figure 1 depicts the geometric relations. The red line represents edge (m i , m j ) shared by several tetrahedra, two of which (one blue, one green) are shown in the figure. \u03b8 t , t = 1, 2 is the dihedral angle in Equation (4) and so is the edge length l t . Plugging Equation (4) into Equation (3) gives us the harmonic energy. We apply gradient descent to get f . [43] provides details on volumetric harmonic mapping. Briefly, we first compute a brain surface spherical tioned into different cells, each with a particle. Every measure point on the plane has a smaller distance to the particle of its own cell than to any other particle.\nconformal mapping. Using the sphere as a fixed boundary, we minimize the volumetric harmonic energy (Equation 3) and produce the volumetric harmonic mapping. After volumetric harmonic mapping, an arbitrary tetrahedral mesh will be harmonically mapped into a unit sphere. This is the initial condition to perform the discrete optimal transportation which requires a convex metric space."}, {"section_title": "Discrete Variational Optimal Transportation", "text": "Having introduced the optimal transportation problem in 2.1, given a discrete point set with a Dirac measure\n.., l, our goal is to find a discrete optimal transportation from a metric space M (m, \u03bc) \u2282 R n to the discrete point set (p, \u03bd) which partitions the metric space into polygons, forming a power Voronoi diagram. Figure 2 illustrates a Voronoi diagram on a 2D Euclidean plane. Black dots represent the measure (m, \u03bc) while the orange dots indicate the point set (p, \u03bd). We introduce a height vector h = (h 1 , h 2 , ..., h l ) and a piecewise linear convex function:\nThus, each Voronoi cell can be represented as:\nwhich is called a power Voronoi cell since we compute the\nThe gradient map \u2207u h : to [20] , there exists a unique height vector h such that the gradient map \u03bc(h) is measure preserving, i.e. w i (h) = v i and meanwhile minimized the quadratic transportation cost. Now, we define an energy function,\nEquation (7) is a convex function, which makes its optimization tractable via Newton's method. We follow the variational principle and derive gradient and Hessian matrix. The gradient of the energy is\nThe Hessian matrix can be computed from the power\na threshold , and a step \u03bb.\nCompute V with current (p, h). 5 Compute w(h) = {w i = m\u2208Vi \u03bc(m)}. 6 Compute \u2207E(h) using Equation (8). Compute H using Equation (9) . Voronoi diagram. Specifically, suppose two cells V i (h) and Figure 3 . The Hessian matrix of E(h) is given by\nBy Newton's method, at each step, we solve a linear system,\nand update the height vector h \u2190 h\u2212\u03bb\u03b4h until \u03b4h is below a pre-defined threshold. The step \u03bb is an empirical value. The initial value of h is set to h \u2190 (0, 0, ...0) T . Letting \u03d5 denote the optimal transportation map \u03d5 : M (m, \u03bc) \u2192 (p, h), we show the complete algorithm for computing the optimal transportation map \u03d5 in Algorithm 1. Figure 4 shows the overview of our framework. It shows the data flow from the brain images to its Wasserstein distance index. The flow before \"Projection\" is considered preprocessing which is introduced in 4.1. In 4.2, we talk about how to transform the 3D digitalized image into a tetrahedral representation. After that, we describe our approach to obtain a neuroimaging index for each brain volume via discrete optimal transportation (OT) in 4.3."}, {"section_title": "OT based Neuroimaging Index", "text": ""}, {"section_title": "Data Pre-processing", "text": "In this study, we focus on two modalities of brain images -structural magnetic resonance image (sMRI) and fluorodeoxyglucose positron emission tomography (FDG-PET) image. Due to different mechanism of these two modalities, we approach to pre-processing them in different ways and in here we describe them separately. sMRI The sMRI scans we use for each subject are T1-weighted which have been acquired at 1.5T. First, we linearly align all the images together using FLIRT [35] which is a linear image registration tool included in FM-RIB Software Library (FSL) [1] . After that, we use FreeSurfer [17] [2] to process all the images to obtain the segmented brain tissues (e.g. cerebral cortex) and statistics on the brain structure (e.g. average cortical thickness).\nFDG-PET The FDG-PET scans used in this research are processed as follows. First, we use the software toolkit Statistical Parametric Mapping (SPM) [30] [3] to linearly align the images into a common space. Second, we borrow a brain mask from SPM, manually exclude the brain stem and only keep cerebral cortex (because cerebral cortex is the object of this study), and then segment all the images with this cerebral mask. Third, we conduct spatial smoothing with a Gaussian kernel of the full width at half maximum (FWHM) equal to (8, 8, 8) in three directions (x, y, z)."}, {"section_title": "Re-discretization", "text": "The purpose of re-discretization is to replace the images with regularized tetrahedral meshes so that it is easier to perform shape transformation. In this study, we adopt the segmented brain volumes from the pre-processing phase and use FreeSurfer for sMRI and SPM on FDG-PET respectively to extract their surfaces. Then, we use TetGen [34] to generate the tetrahedral meshes from the surfaces.\nGiven a brain image and its corresponding tetrahedral mesh aligned together, we project the intensities of the images onto the meshes. Suppose, after the alignment, a voxel of the image is surrounded by several vertices of the mesh. First, for each voxel x of the image, we use ANN (Approximate Nearest Neighbor) library [29] to find its four nearest vertices, m = {m i }, i = 1, ..., 4, on the mesh. The number of the nearest points we count for projection is adjustable to the difference in the resolutions between the image and the mesh. After that, the intensity I(x) is dispensed from x to m i . The value \u03bc(m i ) that m i receives is determined by the Figure 6 : 3D Voronoi diagrams. As the same as in 2D scenario, the points in each 3D weighted Voronoi cell has the smallest weighted distance to its own particles than to any other particle. distance between that m i and x. In particular, we have:\nwhere\n2 denotes the Euclidean distance between x and v i . The closer vertex receives a larger value of intensity. This ensures the smoothness of the data. Another way of determining a i is through inverse barycentric method, but inverse barycentric could result in negative values if the \"center\" is outside the convex hull formed by neighbors, especially in the regions close to the cerebral cortex surface. A negative vertex feature does not have a physical meaning. Hence, we do not apply inverse barycentric method, although it is mathematically correct."}, {"section_title": "Discrete Optimal Transportation", "text": "Volumetric Harmonic Mapping In order to provide the convexity that the optimal transportation requires, we employ volumetric harmonic mapping which maps an arbitrary 3D tetrahedral mesh to a unit sphere. Figure 5 illustrates a brain mesh before and after the harmonic mapping. Colors indicate the intensities that have been projected from the original images as the result of re-discretization.\nDiscrete Optimal Transportation After building the common canonical space by volumetric harmonic mapping, we apply Algorithm 1 to compute the optimal transportation between desired brain meshes. Figure 6 (left) shows the resulting Voronoi diagram with 61 cells which is what we use in the experiments. After the optimal transportation, the size of each Voronoi cell has been adjusted so that each cell encloses the vertices with measures whose total value approximates the Dirac measure of the center of the cell. To show the shape of each Voronoi cell, we also draw the central 11 cells of the diagram (middle and right) with different colors. We implement our algorithm in C/C++ and we borrow Voro++ [32] to compute the 3D Voronoi diagram. We solve the linear system in Equation (10) 3D Euclidean Wasserstein Distance Recall Equation (2) defining the minimum cost brought by the optimal transportation. We call this minimal cost 3D Euclidean Wasserstein distance if the quadratic distance function is defined in the 3D Euclidean space where the brain meshes are embedded in. We describe our approach for computing the Wasserstein distance index in the rest of the paragraph. First, we build a template from a brain mesh. Specifically, we initialize an unweighted Voronoi diagram with point set, P (p, \u03bd) where \u03bd i = 0, \u2200i. The points are manually designed to be uniformly distributed in the canonical space which is the harmonic map of the brain mesh as shown in Figure 4 . After that, we calculate total mass of each Voronoi cell, which is the summation of the intensities of all the vertices in this particular cell, and assign it to the measure of the corresponding point. Because the total mass of the entire mesh is one, the newly generated point set is actually a Dirac measure. The point set will serve as the template for computing the optimal transportation between the brain mesh model and each other brain mesh M (m, \u03bc) using Algorithm 1. The Wasserstein distance is then computed by\nwhere\nBecause the Wasserstein distance measures the similarity between the measurement of different brain meshes, by comparing the distances from all the meshes to a common template, we will obtain a one dimensional distance space W , called the Wasserstein space. The origin is the Wasserstein distance between the template and itself and the coordinates serve as single indices representing the shape of all the brain volumes regarding to that template. "}, {"section_title": "Applications to FDG-PET and sMR Images for Alzheimer's Disease Analysis", "text": "In this section, we use four separate experiments to evaluate the performance of our indexing framework on sMR and FDG-PET images for the analysis of Alzheimer's disease. The test data come from Alzheimers Disease Neuroimaging Initiative (ADNI) (adni.loni.usc.edu) [22] [21] . We randomly selected 164 FDG-PET scans from ADNI-2 and 250 sMRI scans from ADNI-1 databases. The detailed cohort information is described in Table 1 . In the rest of the paper, we refer to FDG-PET as PET."}, {"section_title": "Timing and Numerics", "text": "All the tests were run on a 3.40 GHz Intel (R) Core (TM) i7-3770 CPU with 8.00 GB RAM. To achieve a threshold of 3.2 \u00d7 10 \u22123 (convergence) on a tetrahedral mesh with 18, 614 vertices, the average running time of our method for computing the Wasserstein distance between two tetrahedral meshes over 10 trials was 54.85 seconds with 176 iterations.\nStep \u03bb was 0.3. Table 2 summaries the timing and numerics. Our approach via Newton's method outperforms the traditional method based on gradient descent [39] . Both were tested without GPU or CPU multi-threaded acceleration -the performance can be further improved. The results provide us a practical foundation to study the Wasserstein distance as a univariate neuroimaging index."}, {"section_title": "Cross-sectional Study of AD on sMRI", "text": "To explore the practicality of our framework on sMR images as well as its robustness over large brain image datasets, we apply it to the ADNI-1 baseline dataset with 75 AD and 175 CN subjects, and compare the Wasserstein distance index with four frequently used single indices -hippocampal volume, average entorhinal cortex thickness, average cortical thickness and total grey matter volume [13] [6] [14] -in terms of their classification accuracies. To make them comparable, we use the minimum number of \"base classifiers\" -two base classifiers. One is based on an AD template and the other is based on a CN template.\nFirst, we randomly select 10 AD and 10 CN images and respectively average them into two templates, each for a group. Then, we compute the Wasserstein distances of each baseline image to these 2 templates. Thus each image will obtain 2 values. We regard these 2 values as a 2-dimensional feature and run linear discriminant analysis (LDA) on them. Finally, we use the statistics computed from FreeSurfer [17] to evaluate the performance of our proposed method. We conduct the classification with 10-fold cross-validation. Each time, we adopt 90% of the whole dataset with their true labels (AD or CN) to train a classification model and then apply this model to the remaining 10% to obtain the result. Figure 7 summarizes the performance of different indices. Among all the indices, the Wasserstein distance index achieves the highest accuracy of 82.30%. Since the Wasserstein distance index works on a large ADNI baseline dataset, we expect it as a potential index to be useful in assisting clinical diagnosis."}, {"section_title": "Cross-sectional Study of AD on FDG-PET", "text": "Prior research has shown strong evidence that PET is a valid prognostic marker of progression of Alzheimer's disease [28] . Geometric analysis of PET, however, has been limited due to low resolution and lack of anatomical information [24] [9] . Our framework regards each image as a probability measure and does not require the positional relation between adjacent voxels, which makes it applicable to PET images. We compute the Wasserstein distance between each two subjects. According to our previous discussion, in the group level, the subjects in the same cohort (AD or CN) may have similar brain functions compared to the brain functions of subjects in different cohorts. We test our hypothesis through classification between AD and CN.\nOur approach is inspired by AdaBoost [18] . To be detailed, each time we regard an image I i as a template and compute the Wasserstein distance w(I i , I j ) from itself to all others I j , j = i, and repeat the process over all the images. Therefore, each time we get a base classifier (14) where sign(I i ) \u2208 {1, \u22121} indicates the class of I i , which is the ground truth, and w i j is the Wasserstein distance between image I j and template I i . The final classifier is\nwhere w j represents the distance vector by computing the Wasserstein distances between image I j and all the templates including itself (but we exclude itself as the template when we compute the output of the classifier). Since we know the label (AD or CN) of the template, by setting a proper threshold, w threshold , we can obtain the labels of all the other images. Due to the small number of the data available to us, we consider that each base classifier equally contributes to the final classifier, i.e. \u03b1 i = 1 N , \u2200i. Figure 8 shows the Wasserstein distance matrix, w, a collection of all the distance vectors w j , each representing a column (or a row). The distances have been normalized to the range [0 1] for the purpose of visualization. By leveraging our approach to classify 23 AD patients and 20 CN subjects, we obtained an accuracy of 88.37% with sensitivity of 91.30% and specificity of 85.00%. The area under curve (AUC) is 97% as shown in Figure 9 .\nAn interesting point we can find from Figure 8 is that although the images labeled \"AD\" can be clustered by their Wasserstein distances very well, images labeled as \"CN\" are relatively not clustered together but rather distributed over the space. One explanation could be, that when people have Alzheimer's disease often associated with the decline in metabolic rate they form a similar pattern in terms of the Wasserstein distance. It is well known that AD is highly correlated to certain common regions across different subjects. We treat each brain volume as a distribution. Therefore, we hypothesize that the 3D distributions will become closer in terms of their pair-wise Wasserstein distances because the loss of the brain tissue (e.g. empty or almostempty voxels) during the progression of AD will gain more weights in the distribution. As a result, the Wasserstein distances between AD images become smaller but others do not have significant change."}, {"section_title": "Longitudinal Study of AD on FDG-PET: A Statistical Significance Test", "text": "Clinical findings have shown strong association between metabolic reduction and the cognitive decline among patients with AD [11] . Therefore, in the time domain, the Wasserstein distance measure between the PET images and the template should become smaller (assuming we have an AD template) since the distribution of the images becomes more similar to the template. In addition, the Wasserstein distances of the PET images labeled AD should decrease at a higher rate than the images of the CN subjects do.\nWe verify our hypothesis with a longitudinal experiment involving 30 AD patients and 30 CN subjects each having 2 scans spanning 2 years. First, for each PET image, we calculate its Wasserstein distance to every other PET image labeled \"AD\", and then average the results. This averaged Wasserstein distance will serve as a one-dimensional feature for the rest of the analysis. Second, for each subject with two PET scans, we record the change in the Wasserstein distance of the PET scan from initial visit to 2-year visit. Therefore, we hypothesize that for AD subjects, the change should be larger than that of CN subjects because AD patients have fast metabolic reduction in cerebral cortex as opposed to normal people whose cerebral metabolic activities do not show significant change. Figure 10 reveals the box plot of the longitudinal experiment. The one-side t-test yields a 5% significance with p-value = 1.13 \u00d7 10 \u22125 , which very well accords with our hypothesis. Our statistical results show that the proposed univariate index is a promising neuroimaging biomarker for tracking AD progression and measuring responses to interventions."}, {"section_title": "Conclusions", "text": "Optimal transportation has long been studied in the areas of computer graphics and vision where most research has been focused on 2D images and 3D surfaces. The complexity of the underlying optimization has been a challenge to researchers especially for high dimensional data, e.g. 3D volumes. Our proposed algorithm for computing variational optimal transportation provides a solution to process high dimensional data within reasonable time. We proposed a novel framework based on variational optimal transportation to compute the Wasserstein distance between brain images, and demonstrated the potential of the Wasserstein distance as a brain imaging index in characterizing neurodegenerative diseases. Our framework for indexing brain images provides a new perspective to analyze brain images. We solve the optimal transportation problem on different modalities of brain images for characterizing brain structures and metabolic patterns, and obtain promising results that verify our hypothesis: people with Alzheimer's disease tend to have similar brain structures and metabolic activity patterns in terms of their Wasserstein distances.\nThere are two open issues with our framework. One is to determine the optimal number of Voronoi cells used in optimal transportation. Using more cells will likely increase the accuracy of the mapping but will also boost the computational cost. Thus, it would be ideal to discover an optimal number of cells that balances efficiency and effectiveness. The other issue comes from the selection of templates. In 5.2, we adopt two templates instead of one because finding an ideal template for OT is extremely challenging and is still an open problem. If a non-typical volume (with smaller Wasserstein distances to most AD volumes but belongs to CN) is selected as the template, the predictions can be far from the truth and even the opposite.We choose to use two templates to reduce the bias. More empirical knowledge has to be discovered for building a high-quality template that can work alone for classification tasks.\nOur work provides a tool for solving the optimal transportation problem efficiently in high dimensional spaces and explores its applications to characterizing Alzheimer's disease on sMR and FDG-PET images. Future work could include solving the OT problem for even higher dimensional data, e.g. tensor images. Additionally, the use of the proposed index to other modalities, such as functional and diffusion MRI, may further improve pre-symptomatic diagnosis and treatment of neurodegenerative diseases."}]
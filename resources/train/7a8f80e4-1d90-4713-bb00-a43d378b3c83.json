[{"section_title": "Abstract", "text": "Abstract-Over the past decade, machine learning techniques and in particular predictive modeling and pattern recognition in biomedical sciences, from drug delivery systems to medical imaging, have become one of the most important methods of assisting researchers in gaining a deeper understanding of issues in their entirety and solving complex medical problems. Deep learning is a powerful machine learning algorithm in classification that extracts low-to high-level features. In this paper, we employ a convolutional neural network to distinguish an Alzheimers brain from a normal, healthy brain. The importance of classifying this type of medical data lies in its potential to develop a predictive model or system in order to recognize the symptoms of Alzheimers disease when compared with normal subjects and to estimate the stages of the disease. Classification of clinical data for medical conditions such as Alzheimers disease has always been challenging, and the most problematic aspect has always been selecting the strongest discriminative features. Using the Convolutional Neural Network (CNN) and the famous architecture LeNet-5, we successfully classified functional MRI data of Alzheimers subjects from normal controls, where the accuracy of testing data reached 96.85%. This experiment suggests that the shift and scale invariant features extracted by CNN followed by deep learning classification represents the most powerful method of distinguishing clinical data from healthy data in fMRI. This approach also allows for expansion of the methodology to predict more complicated systems."}, {"section_title": "I. INTRODUCTION", "text": "Alzheimers disease is an irreversible, progressive neurological brain disorder. It is a multifaceted disease that slowly destroys brain cells, causing memory and thinking skill losses, and ultimately loss of the ability to carry out even the simplest tasks. The cognitive decline caused by this disorder ultimately leads to dementia. For instance, the disease begins with mild deterioration and gets progressively worse as a neurodegenerative type of dementia. Diagnosing Alzheimers disease requires very careful medical assessments, such as patient history, a mini mental state examination (MMSE), and physical and neurobiological exams. In addition to these evaluations, resting-state functional magnetic resonance imaging (rs-fMRI) provides a non-invasive method of measuring functional brain activity and changes in the brain [13] . There are two important concepts regarding resting-state fMRI. First, because patients do not perform any tasks and there is no simulation, the procedure is more comfortable than a normal fMRI. Second, rs-fMRI data acquisition can be performed during a clinical scan, and most researchers are interested in brain network analysis and extraction from rs-fMRI data [8] [9] [11] [6] [2]. However, development of an assistive tool or algorithm to classify fMRI data and, more importantly, to distinguish brain disorder data from healthy subjects has always been of interest to clinicians. Any machine learning algorithm that is able to classify Alzheimers disease will assist scientists and clinicians in diagnosing this brain disorder. In this work, the convolutional neural network (CNN), which is part of the Deep Learning Network architecture, is utilized in order to distinguish Alzheimers brains from healthy brains and produce a trained, predictive model."}, {"section_title": "II. BACKGROUND AND ALGORITHMS", "text": ""}, {"section_title": "A. Data Acquisition and Preprocessing", "text": "In this work, 28 Alzheimer's disease (AD) patients and 15 normal control (NC) subjects (24 female and 19 male) with a mean age of 74.9 5.7 years were selected from the ADNI 1 dataset. The AD subjects'MMSEs were reported to be over 20 by ADNI, and normal participants were healthy, with no reported history of medical or neurological conditions. Scanning was performed on a Trio 3 Tesla, which included structural and functional scans. First, anatomical scans were performed with a 3D MP-RAGE sequence (TR=2s, TE=2.63 ms, FOV=25.6 cm, 256 x 256 matrix, 160 slices of 1mm thickness). Next, functional scans were obtained with an EPI sequence (150 volumes, TR=2 s, TE=30 ms, flip angle=70, FOV=20 cm, 64 x 64 matrix, 30 axial slices of 5mm thickness, no gap). The fMRI data were pre-processed using the standard 1 *Data used in preparation of this article were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at: http://adni.loni.usc.edu/wpcontent/uploads/how to apply/ADNI Acknowledgement List.pdf modules from the FMRIB Software Library v5.0 [10] . Preprocessing steps for the anatomical data involved the removal of non-brain tissue from T1 structural images using the Brain Extraction Tool. Preprocessing steps for the functional data included motion correction (MCFLRIT), skull stripping, and spatial smoothing (Gaussian kernel of 5-mm FWHM). Lowlevel noise was removed using high-pass temporal filtering ($sigma=90.0 sec). Functional images were then aligned to individual high-resolution T1-weighted scans, which were subsequently registered to the Montreal Neurological Institute standard space (MNI152) using affine linear registration and resampled at 2mm cubic voxels. The end results of the preprocessing step were 45x54x45x300 images, from which the first 10 slices of each image were removed, as they contained no functional information."}, {"section_title": "B. Deep Learning", "text": "Hierarchical or structured deep learning is a modern branch of machine learning that was inspired by the human brain. This technique has been developed based on complicated algorithms that model high-level features and extract those abstractions from data by using neural network architecture that is similar but much more complicated. Neuroscientists have discovered that the neocortex, which is a part of the cerebral cortex concerned with sight and hearing in mammals, processes sensory signals by propagating them through a complex hierarchy over time. This served as the primary motivation for developing deep machine learning that focuses on computational models for information representation which exhibits similar characteristics to those of the neocortex [1] [4] [3] ."}, {"section_title": "1) Convolutional Neural Networks (CNNs / ConvNets):", "text": "Convolutional Neural Networks that are inspired by the human visual system are similar to classic neural networks. This architecture has been specifically designed based on the explicit assumption that raw data is comprised of twodimensional images that enable us to encode certain properties and also reduce the amount of hyper parameters. The CNN topology utilizes spatial relationships to reduce the number of parameters that must be learned and thus improves upon general feed-forward back propagation training. Equation 1 demonstrates how Error is calculated in the back propagation step, where E is error function, y is the i th , j is the neuron, x is the input, l represents layer numbers, w is the filter weight with a and b indices, N is the number of neurons in a given layer, and m is the filter size.\nIn CNNs, small portions of the image (dubbed local receptive fields) are treated as inputs to the lowest layer of the hierarchical structure. One of the most important features of CNN is that the complex architecture provides a level of invariance to shift, scale and rotation, as the local receptive field allows the neuron or processing unit access to elementary features such as oriented edges or corners. The CONV layers parameters consist of a set of learnable filters. Every filter is spatially small but extends through the full depth of the input volume. During the forward pass, each filter is convolved across the width and height of the input volume, producing a 2D activation map of that filter. During this convolving, the network learns of filters that activate when they see some specific type of feature at some spatial position in the input. Next, these activation maps are stacked for all filters along the depth dimension, which forms the full output volume. Thus, every entry in the output volume can also be interpreted as an output of a neuron which only looks at a small region in the input and shares parameters with neurons in the same activation map [1] [4] [3] . A Pooling Layer is usually inserted between successive Convolutional Layers in ConvNet architecture. Its function is to reduce (down sample) the spatial size of the representation in order to control the amount of network hyper parameters, and hence to also control overfitting. The Pooling Layer operates independently on every depth slice of the input and resizes it spatially using the MAX operation. Recently, more successful CNNs have been developed, such as LeNet, AlexNet, ZF Net, GoogleNet, VGGNet and ResNet. The major bottleneck of constructing ConvNet architecture is the memory restrictions of GPU [1] [4] [3] . As is evident in Figure 3 , LeNet-5 was first designed by Y. LeCun et al. [4] , and this famous network successfully classified digits and was applied to hand-written check numbers. The application of this network was expanded to more complicated problems, and the hyper parameters were adjusted for new issues. However, more sophisticated versions of LeNet have been successfully tested. In this work, we addressed a very complicated binary classification of Alzheimers data and normal data. In other words, we needed a complicated network for two classes, which compelled us to choose LeNet-5 and adjust this architecture for fMRI data. The implemented network is shown in Figure 2 in detail. "}, {"section_title": "III. RESULTS AND DISCUSSION", "text": "The preprocessed fMRI 4D data in Nifti format was concatenated across z and t axes and then converted to a stack of 2D images in JPEG form using the neuroimaging packages Nibabel (http://nipy.org/nibabel/) and Python OpenCV (opencv.org). Next, images were labeled for binary classification of Alzheimers vs. normal data. The labeled images were converted to lmdb storage databases for high-throughput to be fed into a Deep Learning platform. The LeNet model which is based on Convolutional Neural Network architecture from Caffe DIGITS 0.2 -deep learning framework (Nvidia version) was used to perform binary image classification. The data were divided into three parts: training (60%), validation (20%), and testing (20%). The number of epochs was set to 30, and the batch size was 64, resulting in 126,990 iterations. The LeNet was trained by 270,900 samples and validated and tested by 90,300 images. In order to achieve the robustness and reproducibility of the deep neural network, the cross validation process was repeated five times (fivefold cross validation). This is presented in Table I . The mean of images was removed from data in the Deep Learning preprocessing step. In the training phase, loss of training and testing, as well as accuracy of the validation data, was measured. The learning rate fell dramatically following the 10th epoch and decreased slightly after the 20th epoch, as is shown in Figure 4 . The Deep\nLearning LeNet model successfully recognized the Alzheimers data from the normal control data, and the average accuracy rate reached 96.8588%, as is depicted in Figure 3 . The training and testing processes were performed on NVIDIA GPU Cloud Computing, which significantly improved the performance of the Deep Learning classifier. Most challenges in traditional medical image processing and analyses have involved the selection of the best and most discriminative features, which must be extracted from data, and the process of choosing the best classification method. One important advantage of Deep Learning methods, especially the Convolutional Neural Network used in this study, is the ability to contain those two characteristics simultaneously. It is possible to visualize the results of filters (kernels) in each layer. Figures 5, 6 and 7 illustrate some of the final filter results from different layers. CNN is a strong feature extractor because of its convolutional layers, which are able to extract high-level features from images. This deep learning method is also a powerful classifier because of its complicated network architecture. The present solution, which is based on fully advanced preprocessing steps followed by CNN classification, improved the accuracy of AD data classification from 84% using Support Vector Machine (SVM) reported in the literature [14] [5] [12] to 96.86%. However, deep learning solutions have very few problems, such as high algorithm complexity and expensive infrastructure."}, {"section_title": "IV. CONCLUSIONS", "text": "In this paper, we successfully classified AD data from normal control data with 96.86% accuracy using CNN deep learning architecture (LeNet), which was trained and tested with a massive number of images. This deep learning solution and the proposed pipeline not only open new avenues in medical image analyses, but also enable researchers and physicians to potentially predict any new data. It is also possible to generalize this method to predict different stages of Alzheimers disease for different age groups. Furthermore, this deep learning-based solution allows researchers to perform feature selection and classification with unique architecture. The rate of accuracy achieved in this work was very high, confirming that the network architecture was correctly selected. However, more complicated network architecture encompassing more convolutional neural layers is recommended for future work, and for more complicated problems. Statistics and visualization for second convolution layer of Alzheimer's Disease sample"}]
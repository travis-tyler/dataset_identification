[{"section_title": "Introduction", "text": "Near the ocean surface, intense turbulent mixing driven by shear (due to surface wind stress) and convection (due to heat loss from the ocean to the atmosphere) leads to a layer that is vertically quasi-uniform (i.e., has a near-zero vertical gradient) in temperature and density. Depending on whether the temperature or the density is being studied, this layer is termed the isothermal layer or the mixed layer, respectively. Beneath the isothermal (mixed) layer, there is a layer-the thermocline (for temperature) or the pycnocline (for density)-with a strong vertical gradient that restricts heat (buoyancy) exchange between the isothermal (mixed) layer and the deep layer below the thermocline/ pycnocline (Fig. 1) .\nThe isothermal (mixed) layer provides dynamic-thermodynamic links and mediates the exchange of mass, momentum, and heat between the atmosphere and the ocean; it is therefore a influence on the weather and the climate. This exchange depends on an important parameter, the isothermal layer depth (ILD, H T ) [or the mixed layer depth (MLD, H)], which determines the heat content and mechanical inertia of the layer. Temporal variability in H T (or H) is caused by many processes that occur in the isothermal Abstract Two distinct layers usually exist in the upper ocean. The first has a near-zero vertical gradient in temperature (or density) from the surface and is called the isothermal layer (or mixed layer). Beneath that is a layer with a strong vertical gradient in temperature (or density), called the thermocline (or pycnocline). The isothermal layer depth (ILD) or mixed layer depth (MLD) for the same profile varies depending on the method used to determine it. Also, whether they are subjective or objective, existing methods of determining the ILD do not estimate the thermocline (pycnocline) gradient. Here, we propose a new exponential leap-forward gradient (ELG) method of determining the ILD that retains the strengths of subjective (simplicity) and objective (gradient change) methods and avoids their weaknesses (subjective methods are threshold-sensitive and objective methods are computationally intensive). This new method involves two steps: (1) the estimation of the thermocline gradient G th for an individual temperature profile, and (2) the computation of the vertical gradient by averaging over gradients using exponential leap-forward steps. Such averaging can filter out noise in the profile data. Five existing methods of determining the ILD (difference, gradient, maximum curvature, maximum angle, and optimal linear fitting methods) as well as the proposed ELG method were verified using global expendable bathythermograph (XBT) temperature and conductivity-temperature-depth 1 3 (mixed) layer (surface forcing, lateral advection, internal waves, etc.); such variability is diurnal, seasonal, and interannual (e.g., Chu 1993; Chu et al. 1990, Chu and Garwood 1991) . Spatial variability in H T (or H) ranges from less than 20 m in summer to more than 500 m in winter at subpolar latitudes (Monterey and Levitus 1997) . Table 1 gives examples of the various methods/criteria that have been used to determine the ILD from the temperature profile. A single-gradient (near-zero) concept is often used to determine H T . The difference method requires the deviation of T from its value at a reference depth (z ref ) to be smaller than a certain fixed threshold value. The threshold applied varies from 1.0 \u00b0C (Lamb 1984; Rao et al. 1989; Obata et al. 1996) to 0.8 \u00b0C (Kara et al. 2000) , 0.5 \u00b0C (Wyrtki 1964 ), 0.2 \u00b0C (de Boyer Montegut et al. 2004 Oka et al. 2007; Chu and Fan 2010a, b) , and 0.1 \u00b0C (Sprintall and Roemmich 1999) . The reference level used varies from near to the surface (Wyrtki 1964 ) to a depth of 10 m (de Boyer Montegut et al. 2004; Sprintall and Roemmich 1999) . Kara et al. (2000) claimed that 0.8 \u00b0C is the optimal criterion after performing a statistical comparison between data in the NOAA National Centers for Environmental Information (NCEI) World Ocean Atlas (WOA) and a long-term time series of monthly ocean weather station observations.\nThe gradient method requires \u2202T/\u2202z to be smaller than a certain fixed value. This value has varied from 0.015 \u00b0C/m (Defant 1961) to 0.02 \u00b0C/m (Wyrtki 1964) , and \u22650.025 \u00b0C/m (Lukas and Lindstrom 1991; Chu et al. 2002) . A dual-gradient (changing from a near-zero to a non-zero gradient) concept is also used to determine H T . For example, taking the curvature to be largest at \u2212H T (Fig. 1) , i.e., leads to the maximum curvature method (Chu et al. 1997 (Chu et al. , 1999 (Chu et al. , 2000 Lorbacher et al. 2006) . However, as pointed out by Chu et al. (1999) and Chu (2006) , large errors may occur when using this method with noisy profile data, since the curvature method involves calculating the second derivative versus depth. Therefore, to improve the curvature method, Fan (2010a, b, 2011) developed the optimal linear fitting (OLF) and maximum angle methods to identify H T , which are capable of handling noisy profile data. However, these two methods are iterative and not as straightforward to use as methods developed previously (such as the difference, gradient, and maximum curvature methods). Given this diversity of methods for calculating H T , questions arise. What is the uncertainty in the results given by the existing methods/criteria? Can this uncertainty be quantified objectively? Is it possible to develop a new straightforward method that is capable of handling noisy profile data and yields H T values with low uncertainty? The purpose of the study reported in the present paper was to answer these questions. The rest of the paper proceeds as follows. Section 2 describes the expendable bathythermograph (XBT) dataset (572,504 profiles from 1990 to 2013) from the Global Temperature and Salinity Profile Program (GTSPP) and the conductivity-temperature-depth (CTD) dataset (847,560 profiles from 1961 to 2012) from the NCEI World Ocean Database (WOD). Section 3 discusses the uncertainty associated with and the capabilities of five existing methods of determining the ILD. Section 4 presents a new, highly capable exponential leap-forward gradient (ELG) method of identifying H T with low uncertainty. Section 5 shows the global seasonal ILD and its statistical characteristics (such as its standard deviation, skewness, and kurtosis) that were identified by applying the ELG method to the combined GTSPP/XBT and WOD/ CTD data. Section 6 shows the dynamical implications of those results. Section 7 presents the conclusions of this study. Appendices 1, 2, and 3 present MATLAB functions for computing the thermocline gradient, preparing for ELG, and determining H T using the ELG scheme, as well as an analytical temperature profile \"dataset\" that can be employed to practice the use of the MATLAB functions,"}, {"section_title": "Datasets", "text": "The WOD/CTD temperature (1961-2012, 847,560 profiles) and global GTSPP/ XBT (1990 XBT ( -2013 ,504 profiles) datasets were used to evaluate the five most commonly used methods [difference, gradient, maximum curvature, maximum angle, and optimal linear fitting (OLF)] listed in Table 1 . The WOD data have been made available to the public for many years by the NOAA National Centers for Environmental Information (NCEI) through the website https://www.nodc.noaa.gov/OC5/WOD/pr_wod.html. The primary goals of the GTSPP are to develop and maintain a global ocean temperature-salinity resource containing data that are both up-to-date and of the highest possible quality, and to make global measurements of ocean temperature and salinity quickly and easily accessible to (Sun et al. 2010) . Both real-time data (transmitted over the Global Telecommunications System, GTS) and delayed-mode data (received by the NCEI) are acquired and incorporated into a continuously managed database. The quality control procedures used in GTSPP were developed by Canada's Marine Environmental Data Service and published through the Intergovernmental Oceanographic Commission (IOC) (GTSPP Working Group 2010). Interested readers are also referred to http://www.iode.org for more detailed information. It should be noted that there is a fall-rate bias issue with older XBT probes and a pure thermal bias issue with the XBT data (Cheng et al. 2016) . The GTSPP preserves XBT data, probe type, and fall-rate equation information (when provided) in the continuously managed database. Two new codes were created to retain depth correction information in the GTSPP data. Interested readers are referred to Sun et al. (2009) , which can be downloaded from http://www.oceanobs09.net/proceedings/cwp/ cwp86/index.php. Both the WOD/CTD and the GTSPP/ XBT profiles are available in various resolutions, ranging from high (increments of about 1 m) to low (increments of much larger than 10 m).\n3 Capabilities of and uncertainty associated with the existing methods"}, {"section_title": "Q index", "text": "Let us represent an observational temperature profile from "}, {"section_title": "Skill score and Shannon information entropy", "text": "The ILD (or MLD) is well identified if Q \u2265 0.8, uncertainly identified if 0.8 > Q \u2265 0.5, and cannot be identified if Q < 0.5 (Lorbacher et al. 2006) . For a group of profiles (such as a temperature profile dataset), we can calculate the frequency of occurrence of Q values in each of these three intervals, i.e., can therefore be used as a threshold to identify a capable ILD-identification method. Now let the interval [0, 1] be divided into J subintervals of equal size (J = 50 in this work), and let p j be the frequency of occurrence of Q values in the j-th subinterval. The Shannon information entropy, which is commonly used to represent uncertainty, is defined as The larger the Shannon information entropy, the larger the uncertainty in H T . The five existing methods listed in Table 1 were used to calculate H T from the WOD/CTD and GTSPP/XBT data based on various criteria, and the Q value, skill score (S), and Shannon information entropy (E) were determined in each case (see Table 2 ).\nAccording to Table 2 , the uncertainty associated with the subjective methods evidently varies with the dataset used. The difference method has higher S values for GTSPP/XBT (0.65-0.75) than for WOD/CTD (0.43-0.68) and lower E values for GTSPP/XBT (3.09-3.31) than for WOD/CTD (3.29-3.39); it also gives its highest S values (0.75, 0.68) and lowest E values (3.09, 3.29) with a threshold of 0.2 \u00b0C and z ref = \u221210 m when using the (GTSPP/XBT, WOD/CTD) datasets. The gradient method has higher S values for WOD/CTD (0.72-0.75)\nthan for GTSPP/XBT (0.60-0.70); it also gives its highest S values (0.70, 0.75) and lowest E values (3.15, 3.03) with a threshold of 0.025 \u00b0C/m when using the (GTSPP/ XBT, WOD/CTD) datasets.\nThe objective methods yield lower uncertainty than the subjective methods, except for the maximum curvature method, which has low S values (0.55, 0.41) and high E values (3.46, 3.57) for both datasets. This is due to the calculation of the second derivative versus depth in this method. Excluding the maximum curvature method, the uncertainty associated with the objective methods varies slightly with the dataset used, i.e., the maximum angle and optimal linear fitting methods have comparably high S values for GTSPP/XBT (0.74, 0.80) and WOD/CTD (0.76, 0.78) and low E values for GTSPP/XBT (3.12, 2.96) and WOD/CTD (3.17, 2.85)."}, {"section_title": "Exponential leap-forward gradient (ELG) method", "text": "The two objective methods (maximum angle and optimal linear fitting) have high S values and low E values but are computationally intensive since iteration is needed. Here, we introduce a new exponential leap-forward gradient (ELG) method (i.e., an extended gradient method) of determining the ILD with a noise-filtering capability. Unlike the existing methods discussed above, the ELG involves two steps: (a) the estimation of the thermocline gradient (G th ) and (b) the determination of the ILD using the near-zero gradient method and G th ."}, {"section_title": "Thermocline gradient", "text": "Usually, ocean profile datasets are noisy near the surface, with unrealistically large gradients (Fig. 1) . To estimate the mixed layer gradient (near-zero) and the thermocline gradient (nonzero), it is necessary to determine the depth at which the minimum gradient occurs in the near-surface layer (z 1 ), i.e.,\nThe near-surface layer depth (\u221220 m) is chosen in such a way that it is deeper than any reference levels used in the difference method (0, \u22123 m, \u221210 m; see Table 1 ) but is not below the thermocline. This approach reduces the effect of noise near the ocean surface.\nThe minimum gradient at z 1 is the best representation of the mixed-layer gradient. The vertical temperature difference from this depth (z 1 ) to the bottom (z b ) of the profile,\n, is the temperature variability across the mixed layer, thermocline, and deep layer. Since the vertical gradient is strongest in the thermocline and weakest in the mixed layer, the main part of the thermocline can be considered to lie roughly between two depths, z (0.1) with T(z 1 ) \u2212 T(z (0.1) ) = 0.1T d and z (0.7) with T(z 1 ) \u2212 T(z (0.7) ) = 0.7T d (Fig. 1) .\nFor temperature profile data that follow the pattern shown in Fig. 1a , the thermocline gradient is easily calculated as (10) For temperature profile data that do not follow the pattern shown in Fig. 1a (i.e., noisy data The thermocline gradient (G th ) is estimated by finding the median of the above gradients, If the computed G th is very small, i.e., the thermocline vanishes and the mixed layer extends to the bottom of the profile (z b ). It should be noted that the gradient criterion in Eq. 13 is an order of magnitude smaller than the most commonly used gradient method listed in Table 1 ."}, {"section_title": "ELG scheme", "text": "Let the number of data points between z 1 and z (0.7) (Fig. 1) be N g , and let N = log 2 N g , with the bracket indicating the integer part of the real number inside. N is much smaller than N g . Starting from z 1 , the (N + 1) exponential leap-forward gradients (ELGs) are calculated at depths z k [between z 1 and z (0.7) ] (Fig. 2) :\nThe average value for (N + 1) gradients\nwhich effectively represents the gradient at depth z k and has the ability to filter out noise in the gradient calculation. Since G (z k ) \u2248 0 if z k is in the mixed layer and G (z k ) = G th if z k is in the thermocline, it is reasonable to use the midpoint between the two averages to separate the two layers (the mixed layer and the thermocline):\nThis method is called the exponential leap-forward gradient (ELG) method, and it yields the highest S values (S XBT = 0.83, S CTD = 0.82) and lowest E values (E XBT = 2.88, E CTD = 2.81) of any of the methods listed in Table 2 . To analyze the statistics at any grid point (grid resolution: 1\u00b0 \u00d7 1\u00b0) during the four seasons (JFM, AMJ, JAS, and OND), the H T data in a moving grid box with its center at the grid point were considered. For each season, the mean (Fig. 3) , standard deviation (Fig. 4) , skewness (Fig. 5) , and kurtosis (Fig. 6 ) of the ILD were calculated for two moving box sizes (5\u00b0 \u00d7 5\u00b0, 3\u00b0 \u00d7 3\u00b0) each containing at least five data points. The lack of any noticeable difference between the left and right panels in Figs. 3, 4 , 5, and 6 demonstrates that the calculated statistical parameters are not sensitive to the box size (either 5\u00b0 \u00d7 5\u00b0 or 3\u00b0 \u00d7 3\u00b0). The pattern of the mean H T (Fig. 3) is quite similar to that seen in an earlier study (Lorbacher et al. 2006) , with the most prominent feature occurring throughout the year in the equatorial Pacific: negative zonal gradients with shallow H T values (<40 m) in the east and deep H T values (>100 m) in the west. A broad tongue of shallow H T values occurs in the eastern equatorial Pacific during the first half of the year (Fig. 3a, b , JFM and AMJ). Such negative zonal gradients also occur in the equatorial Atlantic Ocean but they are much weaker. Evident seasonal variation is observed away from the equatorial (Fig. 3a) and vice versa in JAS (Fig. 3c) . In the northwestern Pacific at around 30\u00b0N, a band with H T < 75 m appears in the winter (Fig. 3a) and spring (Fig. 3b) from the west coast to 150\u00b0W, with deeper H T values occurring around that band (Fig. 3a, b , JFM and AMJ). This is due to the occurrence of the subtropical front under which the mixed layer remains shallow, even in strong winds that produce deep mixed layers north and south of the front. This band disappears in summer (JAS) and fall (OND), when H T < 40 m above about 23\u00b0N (Fig. 3c,  d ). In the southeastern Pacific west of Peru, a band with H T > 100 m appears in the winter (JAS, Fig. 3c ) near to 23\u00b0S, 100-130\u00b0W, and in spring (OND, Fig. 3d ), albeit with a much-reduced size. This band of deep H T disappears in the summer (JFM, Fig. 3a ) and fall (AMJ, Fig. 3b ).\nThe standard deviation of H T (Fig. 4) shows evident horizontal and seasonal variability, with weaker seasonal variation observed in the tropics (between 23\u00b0S and 23\u00b0N) than outside the tropics (north of 23\u00b0N and south of 23\u00b0S), where large values (>50 m) occur in winter and spring (JFM and AMJ in the Northern Hemisphere, JAS and OND in the Southern Hemisphere). The standard deviation of H T is largest in the Southern Ocean in winter and spring (Fig. 4c, d ) due to temporal gaps in the data. Once the seasonal thermocline has formed in the mid-latitudes, the variability of H T is less than 10 m in April-May-June, c July-August-September, and d October-November-December. White regions have undefined values due to the presence of insufficient data points (\u22644 points) in the 5\u00b0 \u00d7 5\u00b0 (or 3\u00b0 \u00d7 3\u00b0) grid box summer (JAS for the Northern Hemisphere, Fig. 4c ; JFM for the Southern Hemisphere, Fig. 4a) .\nMaps of the skewness of H T (Fig. 5) show more positive than negative values (prevailing positive skewness). The skewness presents weaker seasonal variation in the tropics than outside them. Outside the tropics, a vast area of high positive skewness (>1.4) occurs in hemispheric spring, smaller areas of alternate positive-negative skewness appear in hemispheric fall (Fig. 5b, d) , and small areas of alternate positive-negative skewness occur in winter (JFM) and summer (JAS). In the tropics, alternate positive-negative skewness occurs year-round with weak seasonal variation.\nThe kurtosis of H T (Fig. 6 ) exhibits large values (>6) in spring and a band structure along boundary currents such as the Kuroshio and Gulf Stream (AMJ, Fig. 6b) , as well as an eddy-like structure west of Australia at around 30\u00b0S (OND, Fig. 6d ). The kurtosis shows weaker seasonal variations in the tropics than outside them, where low kurtosis (<3.0) occurs in fall and high kurtosis in spring (Fig. 6b, d )."}, {"section_title": "Dynamical implications of the statistical parameters", "text": "Two distinct patterns in the mean, standard deviation, skewness, and kurtosis of the ILD are observed: weak seasonal variability in the tropics and strong seasonal variability outside them. These patterns are related to differences between these regions in their mixed-layer where w * is the ocean friction velocity (representing the surface wind stress), g is the gravitational acceleration, \u03b1 is the thermal expansion coefficient, Q 0 is the surface heat flux (positive in the downward direction), C 1 (\u2243 1.0) and C 2 (\u2243 0.2) are tuning parameters, and \u039b is the Heaviside function of (C 1 w 3 * \u2212 C 2 \u03b1gH T Q 0 ),\nWhen \u039b = 1, sufficient turbulent kinetic energy is generated at the surface (strong surface forcing) to entrain water from below into the mixed layer, thus deepening this layer (entrainment regime). The deepening rate is proportional to the surface forcing function F. When \u039b = 0, the turbulent kinetic energy generated at the surface is insufficient (weak surface forcing) to entrain water from below into the mixed layer, causing the depth of this layer to decrease (shallowing regime) to the Obukhov length scale L, There is strong seasonal variability in surface forcing in non-tropical regions, with strong heat loss at the April-May-June, c July-August-September, and d October-November-December. White regions have undefined values due to the presence of insufficient data points (\u22644 points) in the 5\u00b0 \u00d7 5\u00b0 (or 3\u00b0 \u00d7 3\u00b0) grid box surface (Q 0 < 0, upward heat flux) in hemispheric winter (i.e., strong surface forcing) and strong heat gain at the surface (Q 0 > 0, downward heat flux) in hemispheric summer (weak surface forcing). Strong surface forcing (large F) deepens the ILD (entrainment regime) and leads to a large mean ILD and negative skewness (a long tail towards small ILD, i.e., high probability in large ILD bins). Weak surface forcing decreases the ILD (shallowing regime) and leads to a small mean ILD and positive skewness (a long tail towards large ILD, i.e., high probability in small ILD bins). During the transition from winter (summer) to summer (winter), the surface forcing changes, leading to a shift from the deepening (shallowing) to the shallowing (deepening) regime, which increases the variability and leads to large standard deviation and kurtosis values. Tropical regions show weak seasonal variability in the surface forcing function, and thus present less seasonal variation in the statistical April-May-June, c July-August-September, and d October-November-December. White regions have undefined values due to the presence of insufficient data points (\u22644 points) in the 5\u00b0 \u00d7 5\u00b0 (or 3\u00b0 \u00d7 3\u00b0) grid box parameters (mean, standard deviation, skewness, and kurtosis of the ILD)."}, {"section_title": "Conclusions", "text": "We have utilized the skill score and Shannon information entropy to evaluate the abilities of five existing methods (difference and gradient methods with various criteria, maximum curvature, maximum angle, optimal linear fitting) to identify the ILD (H T ) based on the WOD/CTD temperature (1961-2012, 847,560 profiles) and global GTSPP/ XBT (1990 XBT ( -2013 ,504 profiles) datasets, as well as the uncertainty associated with each method. Using 0.75 as the threshold for the skill score, the most useful existing methods were found to be the difference method with criteria of \u0394T = 0.2 \u00b0C, z ref = \u221210 m for the GTSPP/XBT data, the gradient method with a criterion of 0.025 \u00b0C/m for the WOD/ CTD data, the maximum angle method for the WOD/ CTD data, and the OLF method for both the GTSPP/ XBT and WOD/CTD datasets. We also proposed a new exponential leap-forward gradient (ELG) scheme for determining H T with low uncertainty. Compared with the existing methods mentioned above, the ELG scheme yielded a higher skill score and lower Shannon information entropy. The global H T data obtained by applying the ELG method showed strong horizontal and seasonal variability. The calculated statistical parameters (the mean, standard deviation, skewness, and kurtosis of the ILD) exhibited strong seasonal variability in non-tropical regions, with large mean ILD values and negative skewness (a long tail towards small ILD, i.e., high probability in large ILD bins) in hemispheric winter, small mean ILD values and positive skewness (a long tail towards large ILD, i.e., high probability in small ILD bins) in hemispheric summer, and large values of standard deviation and kurtosis during the transition seasons due to strong seasonal variability of the surface forcing function, which leads to switching between the deepening and shallowing regimes. However, the statistical parameters presented weak seasonal variability in tropical regions due to weak seasonal variability in the surface forcing function. Furthermore, the calculated skewness and kurtosis showed non-Gaussian statistics for the ILD in the global ocean.\nIt should be noted that the isothermal (mixed) layer is considered to be vertically uniform in temperature (density), and the isothermal layer depth is generally larger than the mixed layer depth in the subarctic region. In other words, the salinity significantly influences the MLD in the subarctic region. There are areas where a mixed layer forms under the influence of both temperature and salinity even when there are no isothermal and isohaline layers. Therefore, numerous studies have been carried out to determine the MLD using both temperature and salinity (e.g., the identification of the barrier layer in the Sulu and Celebes seas; Chu et al. 2002) . Thus, determined MLD values should be interpreted carefully, taking into account aspects such as differences in ocean structure between the tropical, subtropical, and subarctic regions. (Table 3) . Applying each ILD identification method to one of the low-noise (0.05 \u00b0C) profiles (i.e., to 1 realization) and one of the high-noise (0.2 \u00b0C) profiles resulted in a wide range of H T values (Fig. 9) . When the low-noise profile was used, the H T identified using the difference method was quite close to 50 m with \u0394T = 0.1, 0.2, and 0.5 \u00b0C, and 5-6 m deeper at 55 m with \u0394T = 0.8 and 1.0 \u00b0C. When the gradient method was used, H T was close to 5 m for small gradients (0.015, 0.025 \u00b0C/m) and close to 50 m for a large gradient (0.05 \u00b0C/m). H T was 19 m when the maximum curvature method was used and around 50 m when the maximum angle, OLF, and ELG methods were employed. When the high-noise profile was used, the H T identified using the difference method was around 56 m with \u0394T = 0.5, 0.8, and 1.0 \u00b0C, 40 m with \u0394T = 0.2 \u00b0C, and 12 m with \u0394T = 0.1 \u00b0C. When the gradient method was used, H T was close to 5 m (for all gradients: 0.015, 0.025, and 0.05 \u00b0C/m); it was 19 m using the maximum curvature method, 35 m using the maximum angle method, 52 m using the optimal linear fitting method, and 49 m using the ELG method.\nQ values were obtained for each method with each profile using Eq. 3. Since only one profile (defined by Eqs. 20-22)-with or without added noise-was used each time, the skill score (Eq. 7) was not calculated.\nHistograms of H T and Q were constructed based on the results of applying each of the 15 ILD determination methods to the 1000 low-noise profiles (i.e., 1000 realizations; see Figs. 10, 12) and to the high-noise profile (see Figs. 11, 13) . The statistical results obtained for the lownoise profiles are listed in Table 4 , and those obtained for the high-noise profiles are shown in Table 5 ."}]
[{"section_title": "Abstract", "text": "Disease Neuroimaging Initiative, \"Adaptive Bayesian label fusion using kernel-based similarity metrics in hippocampus segmentation,\" J. Med. Imag. 6(1), 014003 (2019), doi: 10.1117/1.JMI.6.1.014003.\nAdaptive Bayesian label fusion using kernel-based similarity metrics in hippocampus segmentation David C\u00e1rdenas-Pe\u00f1a,* Andres Tobar-Rodr\u00edguez, German Castellanos-Dominguez, and Alzheimer's Disease Neuroimaging Initiative \u2020 Universidad Nacional de Colombia, Signal Processing and Recognition Group, Manizales, Colombia\nAbstract. The effectiveness of brain magnetic resonance imaging (MRI) as a useful evaluation tool strongly depends on the performed segmentation of associated tissues or anatomical structures. We introduce an enhanced brain segmentation approach of Bayesian label fusion that includes the construction of adaptive target-specific probabilistic priors using atlases ranked by kernel-based similarity metrics to deal with the anatomical variability of collected MRI data. In particular, the developed segmentation approach appraises patch-based voxel representation to enhance the voxel embedding in spaces with increased tissue discrimination, as well as the construction of a neighborhood-dependent model that addresses the label assignment of each region with a different patch complexity. To measure the similarity between the target and training atlases, we propose a tensor-based kernel metric that also includes the training labeling set. We evaluate the proposed approach, adaptive Bayesian label fusion using kernel-based similarity metrics, in the specific case of hippocampus segmentation of five benchmark MRI collections, including ADNI dataset, resulting in an increased performance (assessed through the Dice index) as compared to other recent works."}, {"section_title": "Introduction", "text": "Magnetic resonance imaging (MRI) is a dynamic and fastgrowing imaging modality that has been increasingly admitted in research and clinical applications such as detection of subtle or small brain abnormalities and identification of pathological structure conditions, 1,2 monitoring of disease progression, 3 and diagnosis of soft-tissue lesions and inflammatory foci. 4, 5 Nonetheless, in cases of neuroimaging, the effectiveness of MRI tools strongly depends on the performed segmentation of associated brain tissues or anatomical structures, for which qualitative expert assessments may become impractical because of increased time and human resource consumption. To name a few applications: the detection of subtle or small brain abnormalities and identification of pathological structure conditions, 1,2 monitoring of disease progression, 3 and diagnosis of soft-tissue lesions and inflammatory foci. 4, 5 Nonetheless, the effectiveness of MRI tools for neuroimaging applications strongly depends on the performed segmentation of associated tissues or anatomical structures.\nIn a first approach, brain tissue intensities can be assumed to be linearly separable, supporting the classification of tissues, having very different diamagnetic properties such as white matter, gray matter, and cerebrospinal fluid. Nevertheless, this assumption does not hold in the volume compartments with very similar magnetic susceptibility (as the hippocampus, basal ganglia, and putamen), producing a histogram overlapping that degrades automatic segmentation. 6 An effective way to overcome this issue is to incorporate the prior information about the expected location and structure of volume shapes using image templates or atlases, which are MRI pairs (intensity images joined to their label maps) that must be spatially warped to the target spatial coordinates. To encompass the inherent ambiguity of volume inhomogeneities, Bayesian algorithms are employed together with local intensity models, 7 resulting in a single spatial model prior. For instance, the unified segmentation approach simultaneously performs registration, filtering, and delineation of brain structures using a single probabilistic template together with Gaussian mixtures to model space-varying intensity. [8] [9] [10] To extract a broader anatomical heterogeneity, however, priors are to be collected from large human groups, which may incorporate high inter-and intrasubject variability of intensity distributions. 11 Modern segmentation approaches consider subject-specific atlas strategies to tackle the intrasubject variability, which demand the registration of available training MRI sets to a unique image. Hence, the full processing stage is carried out over the target coordinate space, but weighting the contribution of each training image. Thus, the most similar templates to the target image are engaged, applying different measures of proximity: active shape patterns, 12 manifold learning, 13 appearance models, 14 and probabilistic atlases. 15 All these metrics highly rely on the accuracy supplied by each applied pairwise image alignment that, in practice, is deteriorated by the misregistration artifact, increasing the computational cost that becomes huge for large training datasets.\nAiming at dealing with atlas misalignments, the pairwise agreement is computed between each atlas to the target using a template search strategy (nonlocal methods), for which the voxel labeling depends on the intensity similarity over a predefined neighborhood. To infer the tissue class, the similarity is computed between intensity patches centered at target and atlas voxels. Therefore, the patch-based approaches differ in the selected label fusion strategy. Thus, basic methods assign the labels using a weighted voting strategy ruled by patch similarity metrics measured over neighboring patches. 16, 17 Also, the hierarchical patch-based label fusion involves multiscale feature representation to characterize the local anatomical information, dynamically adjusting the patch size during the label procedure. 18 More elaborate approaches are spatially localized random forests, 19, 20 patchwise metric learning with multiscale features, 21, 22 probabilistic labeling following confidence maps, 23 and progressive labeling by multilayer dictionaries. 24 In attempting to undertake the space-varying labeling difficulty, however, these approaches demand a significant number of atlas voxels, therefore reducing the benefit of the voting strategies. 25 Although the above approaches attempt to undertake the space-varying labeling difficulty by increasing the number of atlas voxels, still many atlas voxels may cause a segmentation loss if they are neither representative for the query tissue nor suitably aligned with the target voxel. In either case, instead of reinforcing the labeling decision, the arisen uncertainty decreases the achieved performance.\nIn this paper, for the concrete case of hippocampus, we propose a brain tissue segmentation methodology that aims at selecting the most related atlases with a query, using more elaborate kernel-based similarity metrics and adapting the Bayesian model parameters to the spatial labeling complexity. The methodology, termed adaptive Bayesian label fusion using kernel-based similarity metrics (ABKS), comprises two stages: (i) an atlas selection strategy using a tensor-based similarity between the target and atlases at regions of interest (ROI) in an attempt to better the anatomical variability extraction from a pool of image collections, accurately fitting the target brain structure and enhancing the tissue delineation. (ii) Estimation of adaptive Bayesian models according to the neighborhood labeling complexity. In the cases of labels with low uncertainty, estimation relies on a maximum a posteriori classifier that is supplied by spatially varying priors at neighborhoods. Otherwise, a nonlocal patch scheme is applied with conditional distributions learned from structural information and uniform priors to tackle regions with high uncertainty. Further, the incorporated collectionwise agreement threshold delimits the neighborhood labeling complexity, ruling more accurately the segmentation model. To assess the benefit of the proposed methodology, we consider the popular segmentation of labeling the hippocampus from public MRI collections, showing that proposed ABKS approach achieves a Dice index similarity than the compared state-of-the-art approaches. The remainder of the paper is organized as follows: Sec. 2 introduces the proposed tissue segmentation approach, ABKS, explaining the ranking procedure of the training atlases in the template search strategy. Then, Sec. 3 describes the experimental setup validated on four publicly available datasets, providing results that are discussed in Sec. 4. Last, conclusions and future work are outlined in Sec. 5."}, {"section_title": "Methods", "text": ""}, {"section_title": "Bayesian Segmentation Using Atlas-Based Priors", "text": "Let X \u00bc fx r \u2236r \u2208 \u03a9g be a raw intensity image set, holding a measurement x r \u2208; R at location r defined over the spatial domain \u03a9. Provided a tissue class set C; \u00bc f1; : : : ; Cg, the image segmentation task intends to find the optimal partition, that is, it builds the label image set L \u00bc fl r \u2208 Cg by assigning a label l r to r'th spatial element, relying on its measured intensity x r . In image processing, Bayesian methods perform the optimal segmentation task determined as the partition that has the highest a posteriori probability, incorporating the anatomical information extracted from an available atlas (or prior image). Thus, the posterior conditional probability P\u00f0LjX \u00de (or segmentation probability) is expressed in terms of P\u00f0X jL\u00de, the conditional probability computed from the image X , given a segmentation set L as well as the corresponding prior probability P\u00f0L\u00de. So, the segmentation probability reads as follows:\nE Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 0 1 ; 3 2 6 ; 5 2 6 P\u00f0LjX \u00de \u221d P\u00f0X jL\u00deP\u00f0L\u00de:\n(1)\nUnder the assumption that all spatial elements are i.i.d., the segmentation probability of a given image can be expressed as P\u00f0LjX \u00de \u00bc Q r\u2208\u03a9 P\u00f0l r \u00bc cjx r \u00de, so that the maximum a posteriori criterion assigns a label l \u22c6 r as E Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 0 2 ; 3 2 6 ; 4 5 1\nwhere the conditional probability P\u00f0x r jl r \u00bc c\u00de describes the intensity distribution for class c at position r, and P\u00f0l r \u00bc c\u00de is the label prior probability regardless of its intensity. Considering that the tissue conditional probability locally follows a Gaussian distribution N \u00f0x r j\u03bc rc ; \u03c3 2 rc \u00de, both probability parameters are derived from an available atlas set, A \u00bc fX n ; L n \u2236n \u2208 \u00bd1; : : : ; Ng, as 7 E Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 0 3 ; 3 2 6 ; 3 1 1\nE Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 0 4 ; 3 2 6 ; 2 7 9\nE Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 0 5 ; 3 2 6 ; 2 5 2\nwhere \u03bc rc \u2208 R and \u03c3 2 rc \u2208 R \u00fe are the estimated mean and variance of tissue c at location r, and P\u00f0l n r \u00bc c\u00de is the probability that n'th atlas has the label c at r. Notation E n f\u00b7g stands for the expectation operator over variable n."}, {"section_title": "Atlas Selection by Similarity using", "text": "Tensor-Product Kernels\nDue to the anatomical variability between subjects, Eqs. (3)- (5) are biased toward the population average, hindering the segmentation performance. To overcome this issue, we introduce an atlas selection stage that allows computing the parameters of local Gaussians from the atlas subset with the largest similarity to the target image. That is, it holds that fX n ; L n \u2236k\u00f0X ; X n \u00de > \u03f5g, being k\u00f0X ; X n \u00de \u2208 R \u00fe a similarity\nJournal of Medical Imaging 014003-2 Jan-Mar 2019 \u2022 Vol. 6 (1) function between the target and n'th atlas. For the implementation of this stage, we consider our previous tensor-product kernel-based (TPK) similarity to build the atlas subset. 26 To this end, we extract the set of pairwise interslice kernel (ISK) relationships along each MR image axis into a set of kernel matrices fS \u03bd \u2208 R L v \u00d7L v \u2236\u03bd \u2208 fa; s; cgg, where L v is the number of slices across \u03bd'th axis, namely, axial (a), sagittal (s), and coronal (c). Relying on a positive-definite kernel function \u03ba\u00f0\u00b7; \u00b7\u00de, any intensity image is mapped into the symmetric matrix S \u03bd with elements s\nl is l'th slice of \u03bd'th axis. The resulting set of ISK relationships feeds the TPK similarity, combining the pairwise image similarity along each axis as E Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 0 6 ; 6 3 ; 6 0 8 k\u00f0X ;\nIn particular, both kernels follow the Gaussian function:\nE Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 0 7 ; 6 3 ; 5 5 3 \u03ba X \u00f0X\nE Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 0 8 ; 6 3 ;\nwhere notation k \u00b7 k F stands for matrix-based Frobenius norm. Then, the similarity function in Eq. (6) benefits of the anatomical changes on images to be compared across the axes. As a result, the combination of axiswise similarities allows ranking the atlases according to their similarity with the target image so that the closer each atlas is-the better its contribution to building the local probability distributions in Eq. (2)."}, {"section_title": "Adaptive Fusion Labeling in Neighboring Patches", "text": "Commonly, the estimation in Eq. (3) implies the existence of one-to-one relationships between the training dataset images. Nonetheless, the voxels, neighboring a boundary region B, hold mostly more uncertainty than the far voxels do, making the segmentation of voxels with less uncertainty (e.g., deep inside the structures) have lower computational effort. This means that the assumption of a one-to-one relationship does not hold entirely for the edges that belong to the tissues of interest, introducing several errors into the label fusion procedure.\nTo address above issue, we define the probability distribution models in Eqs. (3)- (5) for boundary and nonboundary regions. The nonboundary region is composed by voxels r where the maximum a priori probability [Eq. (3)] is larger than or equal to an introduced threshold \u03b1 \u2208 \u00f01\u2215C; 100%., i.e., max c E n fP\u00f0l n r \u00bc c\u00deg \u2265 \u03b1. On the contrary, all voxels that fail this condition (that is, having the largest label uncertainty) are assumed to belong to the boundary region. In either case of regions, estimation of the prior and likelihood function parameters are as follows:\nE Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 0 9 ; 6 3 ; 1 6 5 boundary regions\u2236 max\nE Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 1 0 ; 6 3 ;\nE Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 1 1 ; 3 2 6 ; 7 4 1\nE Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 1 2 ; 3 2 6 ; 7 2 8 nonboundary regions\u2236 max\nE Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 1 3 ; 3 2 6 ; 6 7 8\nE Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 1 4 ; 3 2 6 ; 6 5 1\nwhere N \u00f0r\u00de describes a cubic searching volume (or neighborhood) that is centered at r and limited in size by an included radius parameter \u03f5 \u03a9 \u2208 R \u00fe (neighborhood radius). The local intensity set X n r builds a patch of radius \u03f5 \u03b2 \u2208 R \u00fe that represents the r'th voxel. Further, P\u00bdd X \u00f0X q r X n s \u00dej\u03f5 \u03c6 is the probability that the patches X q r and X n s become similar within the threshold value \u03f5 \u03c6 \u2208 R \u00fe , employing the distance function d X \u00f0X q r X n s \u00de \u2208 R \u00fe . As a result, the agreement threshold \u03b1 selects the model according to the labeling complexity within the boundary and nonboundary regions. In the former case, we propose the uniform distribution as the priors to reduce the labeling errors related to a poor agreement between training atlases in Eq. (3). Moreover, the conditional distributions (computed from the neighborhood search and pairwise volume similarity) are incorporated to locate the most similar voxels across the atlas set, and therefore, the label of a targeted voxel is assigned more accurately. For the nonboundary regions, inside most of the atlases agree, a voxelwise probabilistic model reduces the computational cost, without compromising the tissue delineation."}, {"section_title": "Experimental Setup", "text": ""}, {"section_title": "MRI Datasets and Image Preprocessing", "text": "We evaluate the proposed approach of adaptive Bayesian label fusion using kernel-based similarity metrics in delineating the hippocampal tissue, appraising the following pipeline stages: (i) preprocessing of MRI scans using the ANTS tool to perform the affine-registration of all volumes into each target; (ii) subject-dependent atlas selection based on the TPK, ranking the atlases according to their similarity to the target in the RKHS space; (iii) construction of a spatial domain, aiming to gather all hippocampus-labeled voxels of the whole dataset within a region of interest and thus reducing the computational effort; (iv) tissue label estimation, relying on a nonlocal patch search over the sets of intensity and label images for boundary regions and point-to-point comparisons for nonboundary regions;\nFixing the acquisition parameters as shown in Table 1 , the discussed segmentation approach is tested on the following benchmark MRI collections:\n(a) SATA: This collection, publicly available, 27 had been created by the \"Multi-Atlas Labeling beyond the Cranial Vault: Workshop and Challenge\" for assessing the image segmentation of blind-folded data. We consider the training subset, which holds 35 T1 MR images and is equipped with the manually delineated hippocampus. During validation, the leave-one-out strategy provides the segmentation performance assessed by Dice similarity index d S \u2208 \u00bd0;100, defined as follows: E Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 1 5 ; 3 2 6 ; 7 5 2\nwhere \u03a9 H \u00bc fr \u2208 \u03a9\u2236l r \u00bc Hg holds the ground-truth voxels that belong to the hippocampus, and\u03a9 H \u00bc fr\u2236l r \u00bc Hg-the automatically labeled voxels. Notation \u2229 stands for the intersection set operator. The Dice similarity index measures the overlap between the estimated and manual segmentation label sets, rating 100 for fully matching regions and 0 for nonoverlap at all. Note that for comparison purposes, the above-processing pipeline of hippocampal segmentation is also performed for the following approaches: adaptive gradient distribution on the boundary map based on active contour models and multiatlas concept (AGDB), 33 hierarchical patchbased label fusion (HPBLF), 18 patch-based label fusion with discriminative dimensionality reduction (PLFDDR), 34 patch-based label fusion via matrix completion (PLFMC), 17 spatial confidence maps label fusion (SCMLF), 23 ensembling multiview convolutional neural network (9ViewEnsem-Net1), 35 embedding patch-based label fusion (EPLF), 36 and multiscale patch-based label fusion (MSPLF). 37 The latter one was implemented setting its parameters as it is suggested in the document."}, {"section_title": "Parameter Setting in Evaluating Segmentation Pipeline", "text": "In the beginning, we tune the kernel bandwidth [see Eqs. (7) and (8) (Fig. 1) . Then, the pairwise volume similarity values in Eq. (6) feeds the atlas selection stage, having as the main parameter the probability function that measures the voxel similarity across a patch domain as E Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 1 6 ; 3 2 6 ; 3 2 1\nwhere the RBF kernel width hyperparameter \u03b3 n is set, as suggested in Ref. 38 , as the minimal distance between the target patch X q r and the neighboring patches under consideration\n\u00fe is the structure similarity index that allows selecting the patches with similar contrast and luminance so that the exponential similarity calculation in exp\u00f0\u2212k \u00b7 k 2 F \u2215\u03b3 n \u00de is not performed over unlike patches, decreasing substantially the computational burden of the accomplished nonlocal patch search. The structure similarity index is given as 39 E Q -T A R G E T ; t e m p : i n t r a l i n k -; e 0 1 7 ; 3 2 6 ; 1 2 9\nwhere \u03bc z \u2208 R and \u03c3 z \u2208 R \u00fe are the mean and standard deviation of the intensity patch X q z centered at z \u2208 \u03a9, respectively. Practically, the performance of the proposed Bayesian segmentation depends on the accurate tuning of algorithm hyperparameters: global and local. The parameter tuning follows a two-staged grid search of the maximum average Dice index similarity, employing a leave-one-out scheme. In the first stage, we optimize both global parameters (number of atlases jAj and agreement threshold \u03b1) by fixing the local values of \u00f0\u03f5 \u03c6 ; \u03f5 \u03b2 ; \u03f5 \u03a9 \u00de \u00bc \u00f00.9; 2;3\u00de as recommended in Refs. 40 and 41. In the second stage, we search the optimal local parameters within \u03f5 \u03b2 \u2208 \u00bd2;3 (that is, 5 \u00d7 5 \u00d7 5 and 7 \u00d7 7 \u00d7 7 voxels) and \u03f5 \u03a9 \u2208 \u00bd2;7 (ranging from 5 \u00d7 5 \u00d7 5 till 15 \u00d7 15 \u00d7 15 voxels) by setting jAj and \u03b1 to above values. Figure 2 shows the average Dice index that is estimated on each considered MRI collection, at different values of agreement threshold. As seen, the optimal parameters are attained at: \u00f0jAj; \u03b1\u00de \u00bc \u00f018;65%\u00de; \u00f013;65%\u00de; \u00f011;53%\u00de; \u00f09;65%\u00de; \u00f08;53%\u00de for SATA, LONI, IBSR, HAMMERS, and ADNI subjects, respectively. Note that the performed Dice index values prove that the use of all available atlases hampers the segmentation performance.\nFor the second tuning stage, we searched the optimal local parameters within \u03f5 \u03b2 \u2208 \u00bd2;3 (that is, 5 \u00d7 5 \u00d7 5 and 7 \u00d7 7 \u00d7 7 voxels) and \u03f5 \u03a9 \u2208 \u00bd2;7 (ranging from 5 \u00d7 5 \u00d7 5 till 15 \u00d7 15 \u00d7 15 voxels) by fixing jAj and \u03b1 to above values. Figure 3 shows that the pairs achieving the best performance are \u00f0\u03f5 \u03b2 ; \u03f5 \u03a9 \u00de \u00bc \u00f02;6\u00de; \u00f02;5\u00de; \u00f02;3\u00de; \u00f02;4\u00de; \u00f02;6\u00de for SATA, LONI, IBSR, HAMMERS, and ADNI, respectively. In almost all cases, the Dice index increases as the neighborhood radius also rises, meaning that the misalignment produced by the affine registration demands the presence of a larger number of regions to achieve a set of similar patches. Nevertheless, d S decreases as \u03f5 \u03a9 becomes too large since more similar patches may be discovered across the adjacent structures. Regarding \u03f5 \u03b2 , though the computational cost rises, there is a very slight improvement in some cases as the patch radius increases because the large patches more adequately reflect the tissue properties. Summarizing, the resulting values of the calculated optimal parameters are as follows: \u00f0jAj op ;\u03b1;\u03f5 \u03a9 ;\u03f5 \u03b2 ;\u03f5 \u03c6 \u00de \u00bc \u00f018;65%; 6;2;0.9\u00de;\u00f013;65%;5;2;0.9\u00de;\u00f011;53%;2;3;0.9\u00de;\u00f09;65%;4;2;0.9\u00de; \u00f08;53%;6;2;0.9\u00de for SATA, LONI, IBSR, HAMMERS, and ADNI subjects, respectively. Note that the values of threshold and patch radius tend together, respectively, to \u03b1 \u00bc 65% and \u03f5 \u03b2 \u00bc 2 in most of the tested databases. In turn, in each one of the databases, diverse tuned values are accomplished by the number of atlases jAj op and neighborhood radius \u03f5 \u03a9 , which varies within a broad range (from 2 to 6) across databases in an attempt to compensate for the misalignment effect as reported in Ref. 41 .\nFor visual quality inspection of the segmented hippocampus, Fig. 4 shows the best (top row) and worst (bottom row) subjects of each database performed by the proposed method, marking in a green, blue, and red dots the places denote that are correctly labeled (true positives), undersegmented (false negatives), and oversegmented (false positives) voxels, respectively. As expected, most of the mistakes arise in those locations placed near to the tissue boundaries. Thus, for the best-segmented subjects, the proposed approach performs similarly in the four dataset sets in terms of true positives, false negatives, and false positives. In addition, the number of false positives is smaller than the false negatives implying that most of the errors are due to undersegmented voxels. On the contrary, errors in subjects with the lowest Dice lack consistency: the subject is oversegmented for SATA, IBSR, and ADNI; undersegmented for HAMMERS; and the errors are evenly distributed in the case of LONI.\nOverall, the reached results show that ABKS outperforms other approaches in almost all evaluated databases, as shown in Table 2 that displays the averaged Dice index of segmenting the left and right hippocampus, using the tuned parameter set. Hence, we hypothesize that combination of the atlas selection and adaptive fusion labeling enhances the hippocampal segmentation."}, {"section_title": "Discussion", "text": "To overcome the morphological variations and template-totarget misalignment, this work introduces a brain tissue segmentation approach, adaptive Bayesian label fusion using kernel-based similarity metrics -ABKS, that constructs adaptive target-specific probabilistic atlases to be ranked in the template search strategy, appraising the following stages: Atlas selection for dealing with segmentation of MRI data with high anatomical variability; patch-based voxel representation to enhance the voxel embedding in spaces with increased tissue discrimination, and construction of a neighborhood-dependent model that addresses the label assignment of each region with a diverse patch complexity. From the experiments performed on four popular MRI collections, the following remarks are worth being mentioned: Atlas selection through similarity measures enables segmentation with wide anatomical variability. Expressed in terms of pairwise TPK relationships, the morphological variability within each collection allows distinguishing cases of similarity, ranging from very related images to remarkably different volumes. Moreover, several distribution modes of atlases can be inferred relying on the presence of diagonal blocks with separate pairwise volume similarities in the kernel matrices. In the specific case of HAMMERS and IBSR collections, the modes may point to demographic particularities of imaged subjects as seen in Sec. 3.2. Still, the quality of the coarse registration constraints the introduced representation. Figure 2 evidences that the use of TPK takes advantage of this fact, ranking the atlases that contribute the most to the image labeling. As a result, the introduced atlas selection undertakes the anatomical variability of MRI collections by selecting the image subset that better matches to the morphological similarity of each target image, enhancing the labeling efficiency.\nWithin the Bayesian segmentation framework, the spatial priors of tissue modeling can be enhanced by the involved adaptive label fusion of neighboring patches, adjusting the patch and neighborhood radii properly. Using a baseline heuristic grid search, both ruling parameters are tuned in accordance to the voxel uncertainty that highly depends on its boundary proximity. Therefore, the segmentation performance tends to increase as the neighborhood radius also rises as clearly shown in Fig. 3 for LONI and SATA. This result suggests that the misalignment produced by the affine registration demands the presence of a more significant number of regions to achieve a set of similar patches. However, the segmentation performance tends to decrease as the neighborhood became too large due to more similar patches may be found within adjacent structures (such as in LONI and HAMMERS when the parameter is larger than 11 voxels). Note that the application of TPK-based similarity implies a tuned parameter set, which is specific for each database, making this issue the most challenging shortcoming for generalizing the obtained results over other MRI collections. As a result, the better performance at larger neighborhood radius implies that anatomical relationships must be searched in a broader region, and the patch size defines the shape variability to be encoded at each voxel.\nThe segmentation framework enhances the shape variability representation at separate levels of patch dimension, employing two complementary strategies: atlas selection (collecting global information) together with adaptive modeling (accumulating local information). Results in Table 2 prove that the atlas selection stage improves the multiatlas concept (AGDB) at determining the most relevant templates for labeling a query image. Regarding the patch-based approaches, proposed adaptive Bayesian model better decodes the local labeling complexity than SCMLF; and the conditional probability estimator for boundary regions enhances the local tissue modeling of HPBLF, SCMLF, and MSPLF. Therefore, we conclude that the introduced atlas selection together with adaptive fusion labeling enhances the hippocampal segmentation with performance values comparable with convolutional neural network approaches for filtering (EPLF) and labeling (9ViewEnsem-Net1)."}, {"section_title": "Conclusion", "text": "With the purpose of enhancing the brain tissue segmentation, this work introduces the ABKS approach that includes the construction of adaptive target-specific probabilistic priors using similarity-ranked atlases for dealing anatomical variability of collected MRI data. In particular, the segmentation approach appraises patch-based voxel representation to enhance the voxel embedding in spaces with increased tissue discrimination, as well as the construction of a neighborhood-dependent model that addresses the label assignment of each region with diverse patch complexity. To measure the similarity between the target and atlases, we propose a tensor-based kernel metric that also includes the labeling set. We evaluate the proposed approach on four benchmark MRI collections used for hippocampus segmentation, resulting in an increased segmentation Note: Boldface stands for the best performing approach.\nJournal of Medical Imaging 014003-7 Jan-Mar 2019 \u2022 Vol. 6 (1) performance (assessed through the Dice index) as compared to other recent works. Nonetheless, some remarks remain to be improved in the proposed segmentation approach. Thus, the incorporated atlas selection stage may not extract accurately enough a very wide heterogeneity from image collections as it is the case for the IBSR and HAMMERS databases, yielding over-or undersegmentation flaws as seen in Fig. 4 . Therefore, as a future work, the authors plan to extend the proposed segmentation approach to a wider class of brain structural variations, including abnormal masses of tissue, and MRI data with high demographical disparity (age, ethnicity, etc.). Another factor to be reflected is the effect of varying acquisition conditions."}, {"section_title": "Disclosures", "text": "No conflicts of interest, financial or otherwise, are declared by the authors."}]
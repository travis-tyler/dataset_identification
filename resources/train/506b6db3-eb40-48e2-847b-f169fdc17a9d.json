[{"section_title": "Abstract", "text": "Abstract. In this work a closed-form, maximum-likelihood (ML) estimator for the variance of the thermal noise in magnetic resonance imaging (MRI) systems has been developed. The ML estimator was, in turn, used as a priori information for devising a single dimensional noisecancellation-based image restoration algorithm. The performance of the estimator was assessed theoretically by means of the Cr\u00e1mer-Rao lower bound, and the effect of selecting an appropriate set of no-signal pixels on estimating the noise variance was also investigated. The effectivity of the noise-cancellation-based image restoration algorithm in compensating for the thermal noise in MRI was also evaluated. Actual MRI data from the LONI database was employed to assess the performance of both the ML estimator and the image restoration algorithm."}, {"section_title": "Introduction", "text": "Several methods for thermal noise variance estimation in magnetic resonance (MR) imagery have been proposed in the literature. A simple taxonomy classifies the methods in temporal, spatial, and spatio-temporal. On one hand, the temporal methods exploit the information of the same voxel at different frames in order to estimate and compensate for the noise. On the other hand, spatial methods utilize a single image and attempt to exploit the fact that uniform features must yield uniform regions in the acquired image.\nTemporal filtering techniques have the advantage of not comprising the spatial resolution of the images; however, the main disadvantage of such methods is the necessity of acquiring more than one image per slice of tissue under analysis [1] . Spatial filtering techniques have the main advantage of being simple, because they exploit heuristics such as the large number of pixels that receive no signal at all, hence their output signal must be uniformly zero; the thermal noise or some statistics of it may be estimated from such no signal pixels. The main disadvantage of spatial filtering is the reduction of spatial resolution in the filtered images. Examples of spatial approaches are maximum-likelihood (ML) estimators [2, 3] , histogram-based estimators [4] , and spatial filters such as Gaussian or Hanning masks [5] .\nIn this paper a closed-form, ML estimator for the variance of thermal noise in magnetic resonance imaging (MRI) systems has been derived by means of an algebraic trick and the knowledge on the distribution of the noise process. The estimator has been compared theoretically to other well-known noise variance estimators by means of the fundamental result called the Cr\u00e1mer-Rao lower bound (CRLB). The performance of the estimator has been also tested experimentally using simulated and actual MRI data, which was obtained from the Alzheimer's disease neuroimaging initiative (ADNI) project's database. Additionally, the ML estimator developed here was employed used as a priori information for developing a noise-cancellation-based image restoration algorithm, meaning that the images are be regarded as one dimensional signals for their processing. The image restoration algorithm is shown to be effective in rendering good-quality filtered images from a set of noisy MR data. Finally, it must be commented that the study conducted here is restricted only to the case of having: (i) magnitude-only MR images; and (ii) a single MR image.\nThe rest of this paper is organized as follows: in Section 2 images rendered by MRI systems are mathematically modeled and a ML estimator for the thermal additive noise corrupting the images is derived. In Section 2.4 the performance of ML estimator is assessed and compared to other classical estimator. In Section 3 an image restoration procedure based upon the technique of noise cancellation is presented as well. Finally, in Section 4 our conclusions are stated."}, {"section_title": "Estimation of the noise variance", "text": ""}, {"section_title": "Thermal noise in MRI", "text": "The complex MR image, X r (m, n), rendered by an MRI system is modeled by:\nwhere x(m, n) and N (m, n) are the magnetization distribution and the noisy component of the reconstructed signal, respectively. N (m, n) is considered a complex white random process, whose real and imaginary parts are pairwise independent Gaussian random variables (r.v.s) with zero mean and variance \u03c3 2 . To avoid the phase errors of MRI systems or simply because the complex image may not be available to the users, the so-called magnitude image is obtained after taking the magnitude of X r (m, n), [6] . Therefore, the typical model for a pixel in an MR image is given by:\nwhere the sub indexes R and I denotes the real and imaginary parts, respectively. Equation (2) shows that S(m, n) corresponds to a function of two r.v.s normally distributed. It is not hard to show that each pixel of the magnitude image is a r.v. following a Rician distribution with parameters a x (m, n) = |x r (m, n)| = x 2 R (m, n) + x 2 I (m, n) and \u03c3 2 , [4, [6] [7] [8] . Note that when no signal is present, i.e. x(m, n) = 0, S(m, n) follows a Rayleigh distribution [6] ."}, {"section_title": "Related work: Some thermal noise variance estimators", "text": "Noise variance estimation in MRI is performed using both the uniform regions of the noisy image and heuristics on the underlying probability density function (pdf) of the noisy data. Some commonly used variance estimators are:\n1. Histrogram's maximum of background noise (HMBN) estimator [9] : Derived based upon the fact that the maximum value of the Rayleigh distribution is attained when s(m, n) = \u03c3. If we consider that the histogram is an estimate of the actual pdf, then the HMBN estimator is given by \u03c3 2 HM BN = argmaxf S(m,n) (s), withf S(m,n) (s) an estimated pdf yielded using the uniform regions of an image.\n2. Total least-squares error (TLSE) of pdf fitting estimator [10] : Derived based on minimizing the TLSE of fitting the partial histogram of a noisy image with a (scaled) Rayleigh pdf, i.e.f Y (m,n) (y) = K exp (\u2212\u03bby), with \u03bb (2\u03c3 2 ) \u22121 and K k\u03bb a scaling factor. Clearly the resulting estimator is \u03c3 2 LS = (2\u03bb) \u22121 . 3. Conventional estimator. Derived exploiting the second moment of the Rayleigh pdf. The second moment of S(m, n) when no signal is present is E{S 2 (m, n)} = 2\u03c3\n2 . So, if it is estimated using the sample second moment of S(m, n) over a set of independent samples of S(m, n), then"}, {"section_title": "A closed-form ML estimator for thermal noise in MRI systems", "text": "In order to obtain a closed-form ML estimator for thermal noise in MRI systems we apply an algebraic trick which simplifies the derivation process. Let us define a new r.v. representing the magnitude squared of X r (m, n), i.e., Y (m, n) S(m, n) 2 . Since X r (m, n) follows a Rayleigh distribution (when no signal is present), then Y (m, n) follows an exponential distribution with parameter \u03c3 2 . From estimation theory, a closed-form ML estimator for an exponential distribution can be obtained in a straightforward manner, [11] . More precisely, the resulting estimator is\n, which is identical to the conventional estimator. From estimation theory, when ML estimator exists then it is unbiased and asymptotically minimum variance, thereby asymptotically achieving the CRLB, i.e., it attains asymptotically the best performance."}, {"section_title": "Performance assessment of the ML estimator", "text": "Under the simulation scenario, the precision and accuracy of the aforementioned estimators will be assessed drawing samples from Rayleigh r.v.s with known variances. In addition, the performance will be evaluated using real MRI data. The MR data was obtained from ADNI database and comprises a sequence of realizations of independent and identically distributed (iid) Rayleigh r.v.s. Such an experiment was repeated 5000 times so that we can compute both the average and the variance of the estimated noise variance. Results obtained are depicted in Fig. 1 , where it can be observed that the ML estimator yields, as expected, an unbiased estimate with the minimum variance. The estimator based upon the maximum value of the histogram is unbiased; however, the variance of the estimation increases as \u03c3 2 does it. Also, the TLSE-based estimator is a biased estimator, whose bias increases as \u03c3 2 does. In terms of accuracy, the TLSE achieves the minimum variance.\nScenario 2: Real data no-signal images. Here we have taken the first ten images from 002 S 1018. The first eight images contain slices of air, while the last two contain small areas with human body tissue. Notice that the slice thickness was taken fairly thin, so that the noise in the images was accentuated. Fig. 2 shows three images from 002 S 1018. Fig. 2(a) shows an no-signal image, and its histogram clearly shows the shape of a Rayleigh distribution. Fig. 2(b) shows almost the same phenomenon, where the small white circle at the lower center of the image represents pixels with some signal values. Due to the number of pixels having signal is small as compared with the no-signal pixels, we can say that the distribution of the image is approximately Rayleigh. Clearly, when tissue is present such as in Fig. 2(c) the assumption on a Rayleigh distribution is violated. In order to test if the parameters of the Rayleigh distribution for the thermal noise are stationary during the acquisition process, the noise variance is estimated at every image of the first ten images of 002 S 1018. Fig. 3a shows the results of the estimation process. In light of these results, it can be concluded that: (i) the statistics of the thermal noise does not change during the acquisition process; and (ii) the estimate of the ML estimator appears to be consistent along the images, while the other two estimates do not.\nScenario 3: Real data noisy images. The image shown in Fig. 2 (c) will be employed to estimate the noise variance. Since signal and noise are both present in the image, first we have to carefully select no-signal regions. In order to perform an automated estimation procedure we have adjusted a threshold value, \u03c4 , for the intensities in order to discriminate no-signal pixels. A priori, by inspecting the histogram the value \u03c4 = 300 seems to be an accurate value for no-signal pixels. The results obtained for this scenario are shown in Fig. 3b . Clearly, the selection of a right \u03c4 value is crucial for achieving estimation performance. Notice that after a certain value for \u03c4 the estimate achieved by the maximum of the histogram estimator is the same. Such situation is easily explained because increasing \u03c4 introduces in the histogram pixel values with less number of counts, hence the maximum value remains the same. Note also that the results given by the TLSE fit estimator are the worst in terms of precision. Moreover, if we do not properly select \u03c4 then estimated values can be totally wrong such as the negative value for the noise variance estimated when \u03c4 < 250. This is attributable to the fact that as \u03c4 increases the histogram departs from the shape of a Rayleigh pdf.\nNotice that the estimated values disagree with those obtained using a nosignal image. This is because some pixels with small signal values are regarded as no-signal pixels, and their inclusion in the histogram degrade the estimation process. To counteract for such problem, a region-of-interest-based estimation was performed. We have selected four squared regions outside of the patients head, corresponding to a 21% of the total number of pixels. Using such values the estimated noise variances are: \u03c3 2 HM BN = 5788, \u03c3 2 LS = 16634, and \u03c3 2 M L = 11040. Note now that those values are consistent with the ones computed using the image in Fig. 2(a) and (b)."}, {"section_title": "Image restoration", "text": "Typically, when the noise variance of the thermal noise is available, signal estimators can be constructed to render restored images. A common signal estimator is obtained exploiting the second moment of a Rician distribution, [4] :\nSuch estimator is valid for local regions where a common signal value was corrupted by the thermal noise.\nHere, we propose a new signal estimator based upon the technique of noise cancellation, which is commonly used in signal processing when one desires to recover signals corrupted by additive noise, [12] . The main motivation for implementing image restoration via a noise cancellation is that the whole processing it is performed in a pixel-by-pixel basis; no spatial resolution is compromised.\nFrom (2) we have that:\nwhere The rationale behind a noise-cancellation system is the following: If by designing an filter we are capable of producing\u1e90(m, n), a fairly good approximation of Z(m, n), then e(m, n)\n, which corresponds to a fairly good estimate of a 2 x (m, n). Suppose that an finite impulse response (FIR) filter with L coefficients, denoted as h 0 , h 1 , . . . , h L\u22121 , is designed to obtain\u1e90(m, n). Suppose also that independent samples of an exponential distribution, with parameter (2 \u03c3 2 ) \u22121 are available as well, and let us denote them as W (m, n). Given that the image processing will be conducted as a single-dimensional signal processing, then Y and W correspond to stacked versions of the images Y (m, n) and W (m, n). Thus, according to least squares theory we calculate the mean square error (MSE) of the estimate of a 2 x as: Restoration of noisy images: In the restoration process, the estimated value for \u03c3 given by the ML estimator we is fed to the noise-cancellation filter, so that a sequence of iid r.v.s exponentially distributed with parameter \u03bb = (2 \u03c3 2 M L ) \u22121 = 4.55 \u00b7 10 \u22125 is drawn. The single parameter that needs to be adjusted in the image restoration method is the number of filter coefficients L. Typically, such parameter is determined after some training procedure. In our case, the best results were achieved for L = 10, where by best results we mean that the quality of the images seems to be the best to the naked eye. It must be noted that such subjective assessment is employed only due to the absence of reference or clean images. In Fig. 4 we show a sample original image, its restored version using the proposed method as well as the difference image between the noisy and the restored image. We clearly see that the noise level in the restored image has decreased at expense of producing a low contrast image. From the difference image we can infer that no structure should be visible when we subtract the square of the magnitude of the noisy image to the square of the magnitude of the restored image. This is expected because the noise canceling system was designed to fulfill this criterion. However, for the difference of magnitudes considerable image structure is not captured by the whole filtering process."}, {"section_title": "Conclusions", "text": "Thermal noise variance estimation in MRI is commonly performed using heuristics about the presence or absence of MR signal, and next, using some simple generic estimator. Among all the estimators, the closed-form ML estimator developed here is the best choice because of both its statistical efficiency and its simple implementation. In MRI working with the magnitude squared of the data greatly simplifies the algebraic manipulation of the models. Moreover, working with the magnitude squared of the signal creates a simple framework to simulate thermal noise in MRI when solely magnitude images are available. However, such algebraic manipulation cannot eliminate the inherent non-linear behavior the magnitude images, ultimately leading to restored images of reduced performance compared to those achieved when data is squared."}]
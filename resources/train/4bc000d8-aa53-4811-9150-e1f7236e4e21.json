[{"section_title": "Abstract", "text": "Graphs are widely used as a natural framework that captures interactions between individual elements represented as nodes in a graph. In medical applications, specifically, nodes can represent individuals within a potentially large population (patients or healthy controls) accompanied by a set of features, while the graph edges incorporate associations between subjects in an intuitive manner. This representation allows to incorporate the wealth of imaging and non-imaging information as well as individual subject features simultaneously in disease classification tasks. Previous graph-based approaches for supervised or unsupervised learning in the context of disease prediction solely focus on pairwise similarities between subjects, disregarding individual characteristics and features, or rather rely on subject-specific imaging feature vectors and fail to model interactions between them. In this paper, we present a thorough evaluation of a generic framework that leverages both imaging and non-imaging information and can be used for brain analysis in large populations. This framework exploits Graph Convolutional Networks (GCNs) and involves representing populations as a sparse graph, where its nodes are associated with imaging-based feature vectors, while phenotypic information is integrated as edge weights. The extensive evaluation explores the effect of each individual component of this framework on disease prediction performance and further compares it to different baselines. The framework performance is tested on two large datasets with diverse underlying data, ABIDE and ADNI, for the prediction of Autism Spectrum Disorder and conversion to Alzheimer's disease, respectively. Our analysis shows that our novel framework can improve over state-of-the-art results on both databases, with 70.4% classification accuracy for ABIDE and 80.0% for ADNI."}, {"section_title": "", "text": "Disease prediction using graph convolutional networks: Application to Autism Spectrum Disorder and Alzheimer's disease Sarah Parisot "}, {"section_title": "Introduction", "text": "Large scale collaborative initiatives and consortiums, like the Alzheimer's Disease Neuroimaging Initiative (ADNI), the Enhancing NeuroImaging Genetics through Meta-Analysis (ENIGMA) consortium ( Thompson et al., 2014 ) and the International Neuroimag-ing Data-sharing Initiative (INDI), 4 acquire and share hundreds of terabytes of imaging, genetic, phenotypic and behavioural data in an effort to facilitate the discovery of novel biomarkers and better understand disease mechanisms. This ever-increasing volume of imaging and non-imaging information that is collected and shared among researchers stresses the need for computational models that are capable of representing potentially large populations, while exploiting all imaging modalities and additional data sources available.\nGraphs provide a powerful and intuitive way of modelling individuals (as nodes) and associations or similarities between them (as edges). In this setting, a node can represent a specific modality of a subject's acquired data or a series of acquisitions at a particu-lar time point, while the edge weights can be used to capture the similarities between each pair of nodes. Edges can also be nonweighted in this context, or binarised to indicate the absence or presence of association between two subjects/scans, which, however, limits their expressiveness. Graph-based models have been widely used for supervised (e.g. classification ( Tong et al., 2017b ) ) and unsupervised tasks (e.g. manifold learning ( Wolz et al., 2012; Brosch and Tam, 2013 ) and clustering ( Parisot et al., 2016 ) ) in population analysis, due to their capacity to accommodate complex pairwise interactions and ability to integrate non-imaging information. However, previous approaches have focused on summarising all available feature information via pairwise similarities and thus eliminated individual subject features and characteristics. For example, Tong et al. (2017b) proposed a non-linear population graph fusion approach that aims to combine complementary multi-modal information about the subjects, while Zhao et al. (2014) focused on the graph construction and proposed an improved local reconstruction strategy for graph-based label propagation in Alzheimer's disease classification. On the contrary, methods that solely rely on imaging feature vectors ( Cuingnet et al., 2011; Abraham et al., 2017 ) by training, for example, linear classifiers, are widely applied for classification analyses in large populations, but fail to capture interactions and similarities between subjects or their individual scans. A progressive method that seeks to learn an affinity matrix from the observed imaging features while validating it on the training data with known phenotype labels is proposed in Wang et al. (2017) , aiming to augment imaging with phenotypic information. Such analyses become more challenging and limited in performance when diverse imaging protocols are adopted for data acquisition within the same population, since they are more difficult to generalise."}, {"section_title": "Graph convolutional neural networks", "text": "The advent of Convolutional Neural Networks (CNNs) as powerful models that exploit both image features (e.g. intensities) and spatial context by means of neighbourhood information (e.g. regular pixel grid) to yield hierarchies of features, has led to their application in numerous different problems related to 2D and 3D images, like image segmentation ( Havaei et al., 2017 ) and classification ( Hou et al., 2016 ) , long before their recent reemergence ( Sahiner et al., 1996 ) . There is a direct analogy between an image segmentation task, where each pixel is to be assigned a label e.g. tissue of interest or background, and a subject classification task within a population e.g. for disease prediction. In the latter case, a subject along with its corresponding feature vector is equivalent to an image pixel with its intensity values for the different channels, while a graph constructed based on pairwise population similarities is equivalent to the pixel grid, for which the notion of proximity is more straightforward, since both describe the neighbourhood structure for convolutions. Nevertheless, the traditional widespread formulation of CNNs for regular domains cannot be directly extended to irregular ones. The description of the local neighbourhood structure and node ordering is not straightforward for irregular graph structures and these need to be properly defined to allow convolution and pooling operations ( Niepert et al., 2016 ) .\nThe first method dealing with neural networks on graphs was presented in Scarselli et al. (2009) . In this pioneering work, the authors devised a mapping function from graph space to an mdimensional Euclidean space, and proposed a supervised learning method to learn the parameters of their graph neural network (GNN) model. However, no convolution was considered in this model. The first work to introduce convolutional neural networks on graphs was described in Bruna et al. (2013) . Bruna et al. used concepts from the emerging field of signal processing on graphs ( Shuman et al., 2013 ) , giving rise to the spectral graph convolutional networks (GCNs). Spectral GCN is a generalisation of CNNs to irregular domains, which uses computational harmonic analysis to process signals observed on irregular graph structures ( Hammond et al., 2011 ) . The concepts borrowed from this field allow the extension of CNNs to irregular graphs in a principled way, by treating convolutions in the graph spatial domain as multiplications in the graph spectral domain. This kind of convolutions have several applications in computer vision, computer graphics and social network problems, among others, and have successfully been adopted to perform classification of documents in large citation datasets ( Kipf and Welling, 2016; Levie et al., 2017 ) . Alternative approaches, where convolutions are directly defined in the spatial domain, have also been proposed in the literature. In Masci et al. (2015) , for example, the authors define a local geodesic system of polar coordinates to extract patches, which are processed through a cascade of filters and activation functions. The so called geodesic convolutions are then used to construct graph convolutional networks which operate directly on the manifold. Another recent work by Simonovsky and Komodakis (2017) proposed to use filter weights conditioned on the edge labels, instead, and dynamically generate those for each input sample. This type of spatial convolutions on graphs are especially suitable for mesh structures, since they are local and allow to capture anisotropic patterns. A more detailed overview of such techniques is presented in Bronstein et al. (2017) . However, spectral convolutions are preferential in cases where the underlying graph structure is fixed, as spatial graph CNNs tend to require more engineering. In this work, we use the convolution approach described in Defferrard et al. (2016) , since it has shown outstanding performance for node classification tasks where the graph structure models different types of interactions between individuals within a population ( Kipf and Welling, 2016 ) ."}, {"section_title": "Graph-based models for disease prediction", "text": "Recently, the use of graph-based models has gained popularity in medical imaging applications, especially at a subject level. Kawahara et al. (2017) used a customised version of CNNs on structural connectivity matrices to predict neurodevelopmental outcomes in preterm infants, which operates on the graph spatial domain and, therefore, captures only 1-hop neighbours in the receptive field of each node. As an alternative, spectral methods have been used to learn a similarity metric between functional connectivity networks , which was applied for Autism Spectrum Disorder (ASD) and sex classification as well as manifold learning ( Ktena et al., 2018 ) . Spectral methods have also been explored for the prediction of visual tasks from MEG signals on a small number of subjects ( Guo et al., 2017 ) , while a bootstrapping strategy was used by Anirudh and Thiagarajan (2017) for ASD prediction. Finally, Lombaert et al. (2015) combine spectral theory with random forests to process brain surfaces using spectral representations of meshes. Their proposed Spectral Forests are applied to the brain parcellation problem.\nIn Parisot et al. (2017) , we proposed the first application of GCNs for group-level medical applications, more specifically for brain analysis in populations and diagnosis. We modelled populations as sparse graphs, where each node represents a subject and is associated with a feature vector extracted from imaging data. The edge weights encode the pairwise similarities between subjects and their features, and are obtained from auxiliary phenotypic data. This enables us to combine imaging and non-imaging data in a single framework. This population graph is fed as input to a GCN, which is trained in a semi-supervised manner from a subset of labelled nodes (e.g. of known diagnosis), aiming to classify the remaining, unlabelled nodes. The goal of the proposed method is to leverage the complementary non-imaging information available to explain the similarities between subjects within a graph structure and exploit the power of graph convolutions. Our main hypothesis is that integrating clinical expertise, i.e. non-imaging information that is known to be linked to specific pathologies, to model similarities between subjects can improve learned representations of image features and classification performance.\nContribution: This paper constitutes an extended version of our work in Parisot et al. (2017) . In this work, we provide a deeper analysis of the method and modelling choices, through a substantially extended experimental evaluation as well as an in-depth discussion. We explore the influence of each main component of the model and provide discussion on the implications of the obtained results. This extensive evaluation is carried out on the ABIDE and ADNI databases, two large and challenging datasets, with the aim to diagnose Autism Spectrum Disorder (ABIDE) and to predict conversion from Mild Cognitive Impairment (MCI) to Alzheimer's Disease (ADNI). Our evaluation on two different datasets aims to demonstrate the framework's versatility as it facilitates the incorporation of domain-specific knowledge in two different clinical settings, while at the same time showing consistent improvement with respect to baselines for both challenging problems.\nThe main contributions of the proposed work are:\n\u2022 An introduction of GCNs for population analysis in the medical imaging domain.\n\u2022 A novel formulation of subject classification as a graph labelling problem, integrating imaging and non imaging data.\n\u2022 A seamless integration of known non-imaging features, allowing to integrate clinical expertise to boost classification performance.\nIn addition, our extended version proposes the following enhancements with respect to the work introduced in Parisot et al. (2017) :\n\u2022 A complete sensitivity analysis for key parameters of the proposed GCN model \u2022 New feature selection strategies for the ABIDE database Our experiments show that exploiting GCNs with an accurate graph structure leads to significant improvements in classification accuracy, yielding state of the art results Arbabshirani et al. (2017) , Abraham et al. (2017) and Heinsfeld et al. (2018) for both ABIDE (70.4% accuracy) and ADNI (80% accuracy). The model implementation is publicly available at https://github.com/parisots/ population-gcn ."}, {"section_title": "Methods", "text": "An overview of the proposed method is shown in Fig. 1 . We consider a population of S subjects, each subject being described by/associated with a set of complimentary, phenotypic and demographic information (e.g. sex, age, acquisition site). The population comprises a set of N imaging acquisitions (structural or functional MRI are considered in this paper), with N \u2265 S , meaning that one subject can be associated with several acquisitions (longitudinal scans). Our objective is to predict the status of each subject (healthy control or disease) from the imaging data informed by the phenotypic information. The population is represented as a weighted sparse graph, G = {V, E, W } , where W is the adjacency matrix describing the graph's connectivity. Each acquisition A v is represented by a vertex v \u2208 V, corresponds to a subject S v and is associated with a C -dimensional feature vector x ( v ) extracted from the imaging data. The edges E of the graph model the similarity between the corresponding subjects and incorporate the phenotypic information. We model our diagnosis task as a node classification problem, where we aim to assign a label l \u2208 {0, 1} to each graph node which describes the diseased ( l = 1 ) or healthy status ( l = 0 ) of the subject. Even though we focus on binary classification in this work, the model can easily be extended for multi-class classification problems. We adopt a semi-supervised strategy, where all node features along with the population graph are fed to the GCN, while only a subset of the graph nodes is labelled during training and used for the optimisation process. Intuitively, the graph acts as a regulariser, 'encouraging' nodes connected with high edge weights to contribute more towards filtering the features of neighbouring nodes in a way that boosts label propagation performance."}, {"section_title": "Databases and preprocessing", "text": "We demonstrate the potential and versatility of the model using two large and challenging databases, namely the ABIDE and ADNI databases. Each of the databases comprises subject specific information that can be leveraged through our population graph structure.\nThe ABIDE database ( Di Martino et al., 2014 ) aggregates data from different international acquisition sites and openly shares neuroimaging (functional MRI) and phenotypic data of 1112 subjects. 5 We select the same set of 871 subjects used by Abraham et al. (2017) that met the imaging quality and phenotypic information criteria, comprising 403 individuals with ASD and 468 healthy controls. These subjects were regrouped based on location into 20 imaging sites. To ensure a fair comparison with the state of the art ( Abraham et al., 2017 ) we use the same preprocessing pipeline, the Configurable Pipeline for the Analysis of Connectomes (C-PAC) ( Craddock et al., 2013 ) , which involves skull striping, slice timing correction, motion correction, global mean intensity normalisation, nuisance signal regression, band-pass filtering (0.01-0.1Hz). The functional images were registered to a standard anatomical space (MNI152) to allow cross-subject comparisons. Subsequently, the mean time series for a set of regions extracted from the Harvard Oxford (HO) atlas ( Desikan et al., 2006 ) were computed and normalised to zero mean and unit variance. The HO atlas distributed with FSL 6 is based on anatomical landmarks and the version used in this work includes both cortical and subcortical (excluding left/right WM, left/right GM, left/right CSF and brainstem) ROIs, yielding 111 regions in total. The individual connectivity matrices M 1 , . . . , M N are estimated by computing the Fisher transformed Pearson's correlation coefficient between the representative rs-fMRI timeseries of each ROI in the HO atlas. The correlation matrices are, then, Fisher transformed to improve normality.\nThe ADNI database is the result of efforts from several academic and private co-investigators. 7 To date, ADNI in its three studies (ADNI-1, -GO and -2) has recruited over 1700 adults, aged between 55 and 90 years, from over 50 sites from the U.S. and Canada. In this work, a subset of 540 early/late MCI subjects that contained longitudinal T1 MR images and their respective anatomical segmentations was used. Our inclusion criteria were therefore: MCI diagnosis, available longitudinal T1 MR images and available corresponding segmentations as described in Ledig et al. (2015) . MCI often represents an intermediate stage between normal cognition and Alzheimer's disease. Therefore, the conversion from MCI to AD is more challenging to predict than distinguishing between HC and AD patients. In total, 1675 samples were available, with 289 subjects (843 samples) diagnosed as AD at any time during follow-up and labelled as converters. It should be noted that the AD diagnosis in the dataset comes from clinical evaluation only and is missing histopathological confirmation. As a result, the AD diagnosis should be referred to as \"probable AD\". For simplification purposes, we use the term AD to refer to probable AD in the remainder of this paper. Longitudinal information ranged from 6 to 96 months, depending on each subject. Acquisitions after conversion to AD were not included. As of 1 st of July 2016 the ADNI repository contained 7128 longitudinal T1 MR images from 1723 subjects. ADNI-2 is an ongoing study and therefore data is still growing. Therefore, at the time of a large scale segmentation analysis (into 138 anatomical structures using MALP-EM ( Ledig et al., 2015 ) ) only a subset of 1674 subjects (5074 images) was processed, from which the subset used here was selected.\nWith the ABIDE database , we aim to separate healthy controls from patients suffering from ASD. This database comprises data acquired at different sites and using different protocols, which results in a highly heterogeneous database where the acquisition protocol can strongly affect the comparability of subjects. Our goal with the ADNI database is to predict whether a patient with MCI will convert to AD, in other words, we aim to separate patients with stable MCI from those with progressive MCI. Our strategy is to intrinsically model/exploit the longitudinal aspect of the data within our graph structure, so as to highlight the importance and advantage of modelling the interactions between different input data."}, {"section_title": "Population graph construction", "text": "We provide an illustration of the construction of the population graph in Fig. 1 . This graph construction is a key aspect of the method, as an inappropriately constructed graph (i.e. a graph that does not accurately explain the similarity between subjects and their feature vectors) will fail to exploit the power of GCNs. Very inaccurate graph structures could even worsen performance compared to a simple linear classifier. Intuitively, this would equate to performing image convolutions on unrelated pixels (e.g. that are randomly spread across the image) instead of a local image patch. The two main decisions required to build the population model are : 1) the definition of the feature vector x ( v ) describing each graph node/acquisition, and 2) the connectivity of the graph, i.e. its edges E and their weights W , which models the similarity between nodes/subjects/scans and their corresponding features."}, {"section_title": "Feature vector", "text": "We extract the feature vector purely from imaging data, as would typically be the case for image based classification. Our objective is to demonstrate how classification using simple image features can be enhanced using complementary information in the graph structure.\nFor the ADNI dataset, we use the volumes of all C = 138 segmented brain structures, a type of feature which has been highly effective for prediction of Alzheimer's disease, due to the impact of the disease on the brain's structure and volume differences between healthy, MCI and AD populations ( Ries et al., 2008 ) .\nThere is increasing evidence that ASD is linked to disruptions in the functional and structural organisation of the brain Abraham et al. (2017) and Rudie et al. (2013) . As a result, we use functional connectivity derived from resting-state functional Magnetic Resonance Imaging (rs-fMRI) for ASD classification using the ABIDE dataset. More specifically, we use the vectorised functional connectivity matrices, i.e. the upper triangular elements of the square adjacency matrices, as feature vectors. This simple approach has had numerous successes for fMRI based classification, it was notably used in Abraham et al. (2017) , setting the state of the art on the whole ABIDE dataset at 67% with a simple linear classifier. Due to the high dimensionality of the connectivity matrix, we explore, alongside using the whole feature vector, different dimensionality reduction strategies to input a C dimensional feature vector to the network. Our different strategies, detailed in Section 2.3 , are recursive feature elimination using a ridge classifier, a simple autoencoder, a multilayer perceptron classifier and principal component analysis. It is worth noting that feature selection is not used for ADNI data, which has a much smaller and tractable feature vector size."}, {"section_title": "Graph edges", "text": "Similarly to pixel neighbourhood systems, the graph structure provides a broader field of view, filtering the value of a feature with respect to its neighbours' instead of treating each feature individually. It has to be carefully crafted so as to accurately model the interactions between feature vectors. Our hypothesis is that non-imaging complementary data can provide key information to explain the associations between subjects' feature vectors. The objective is to leverage this information, in order to define an accurate neighbourhood system that optimises the performance of the subsequent graph convolutions. Therefore, it is important to select the phenotypic measures which best explain similarities between the imaging data, or similarities between the subjects' labels.\nConsidering a set of H non-imaging phenotypic measures M = { M h } (e.g. subject's sex, or age), the population graph's adjacency matrix W is defined as follows:\nwhere, Sim ( S v , S w ) is a measure of similarity between subjects, increasing the edge weights between the most similar graph nodes;\n\u03b3 is a measure of distance between phenotypic measures. \u03b3 is defined differently depending on the type of phenotypic measure integrated in the graph. For categorical information such as subject's sex, we define \u03b3 as the Kronecker delta function \u03b4, meaning that the edge weight between subjects is increased if e.g. they have the same sex. Constructing edge weights from quantitative measures (e.g. subject's age) is slightly less straightforward. In such cases, we define \u03b3 as a unit-step function with respect to a threshold \u03b8 :\nBoth ADNI and ABIDE databases provide an extensive list of phenotypic features. In this work, we select three different phenotypic measures for each database that are considered relevant to the corresponding disease. For ABIDE, we consider acquisition site, sex and age as our three potential phenotypic measures. The ABIDE dataset is highly heterogeneous due to the fact that the data has been acquired at different sites, using diverse imaging protocols and scanners at each location. As a result, the imaging data is best comparable between feature vectors acquired at the same site, making acquisition site an essential non-imaging measure to introduce. Sex and age are also considered, since sex differences have been observed in several studies on ASD suggesting that females are affected less frequently than males ( Werling and Geschwind, 2013 ) , while there are age-related group differences in functional connectivity overall ( Kana et al., 2014 ) . Finally, we define the similarity measure as\nwhere \u03c1 is the correlation distance and \u03c3 determines the width of the kernel. The idea behind this similarity measure is that subjects belonging to the same class (healthy or ASD) tend to have more similar networks (larger Sim values) than subjects from different classes. The ADNI graph is also built using the subject's sex and age information. These measures are chosen because our feature vector comprises brain volumes, which can strongly be affected by age and sex. We also integrate genetic information, namely the presence of the APOE 4 allele, known to be a major risk factor for the development of Alzheimer's disease ( Mosconi et al., 2004 ) .\nLast but not least, the Sim ( A v , A w ) function plays a particularly important role in the ADNI set-up. It is designed here to leverage the longitudinal information, strongly highlighting that several acquisitions correspond to the same subject. While linear classifiers treat each entry independently, here we define:\nThis measure indicates the strong similarity between acquisitions of the same subject. The influence of each phenotypic and similarity measure will be investigated in our experiments section, so as to optimise the structure of our phenotypic graph. It should be noted that while handedness constitutes an important phenotypic measure associated to autism subtypes ( Soper et al., 1986 ), we could not integrate it in this study as this information was missing for a large number of subjects."}, {"section_title": "Feature selection strategies", "text": "As mentioned in Section 2.2 , the feature vector chosen for ABIDE classification (the vectorised fMRI connectivity network) has a high dimensionality (particularly with respect to the graph size of 871 nodes) which can negatively impact the performance of the algorithm and lead to overfitting issues. In Parisot et al. (2017) , we used a ridge classifier to perform Recursive Feature Elimination (RFE) with a fixed number of features C . It is an iterative process, where each iteration trains the ridge classifier on the training set with the current feature vector. The classifier's coefficients are used to sort the importance of the features and prune the ones with the smallest coefficient (i.e. the least discriminative) from the feature vector. This process iterates until the desired number of features is obtained. In this paper, we investigate 3 additional approaches as well as the influence of C .\nFirst, we use the well known Principal Component Analysis (PCA), which is very commonly used for dimensionality reduction purposes, using singular value decomposition to project the data to a space of lower dimensionality. PCA is not very adapted to our problem due to the much larger dimension of the feature vector compared to the number of samples (6105 vs 871).\nSecond, we use two simple models based on artificial neural networks, one supervised and one unsupervised. The first approach is a Multilayer Perceptron (MLP), a supervised feedforward neural network which consists of one hidden layer of size C . It is trained as a classifier using the ABIDE training data. The feature vector is obtained by extracting the C dimensional feature vector obtained at the MLP's hidden layer. The underlying idea is that the MLP will learn a representation of the data specifically for the classification task, similar to what is done using the RFE approach. However, even if we are using a shallow MLP with a single hidden layer, there is a strong possibility of overfitting due to our limited amount of training data. The MLP model is illustrated in Fig. 2 .\nAutoencoders are unsupervised neural networks that aim to learn a lower dimensional representation (a code) of an input data. It is made of an encoder (which learns the code) and a decoder (which reconstructs the input). It is trained by comparing the reconstructed input to the original data. Our autoencoder has tied weights and comprises one single hidden layer of size C with a sigmoid activation and a tanh activation at the output layer. We use the mean square error as a loss function for training. The autoencoder model is illustrated in Fig. 3 . "}, {"section_title": "Graph labelling using graph convolutional neural networks", "text": "In the previous section we described the construction of the population graph based on phenotypic measures, and feature selection strategies on the original imaging data. In this section, we present the concept of spectral graph convolutions that serves as building block for the final graph convolutional neural network model, and discuss the GCN's architectural details."}, {"section_title": "Spectral graph convolutions", "text": "The discretised convolutions commonly used in computer vision intrinsically exploit the regular grid-like structure of e.g. 2D or 3D images. As a result, their generalisation/application to irregular graphs is not straightforward. We propose to use a recent formulation relying on spectral theory and graph signal processing ( Shuman et al., 2013 ) .\nSpatial graph convolutions can be computed in the Fourier (spectral) domain as multiplications. The concept of graph Fourier transform (GFT) is introduced in Shuman et al. (2013) \nwhere \u03b8 \u2208 R N are the parameters of filter g \u03b8 ."}, {"section_title": "Following the work of Defferrard et al. (2016) , we restrict the class of considered filters to polynomial filters g \u03b8 ( )", "text": "k . This approach has two main advantages: 1) it yields filters that are strictly localised in space (a K -order polynomial filter is strictly Klocalised) and 2) it significantly reduces the computational complexity of the convolution operator. Indeed, such filters can be well approximated by a truncated expansion in terms of Chebyshev polynomials which can be computed recursively.\nIt should be noted that additional simplifications on graph convolution layers are proposed in Kipf and Welling (2016) with applications to citation networks. Nonetheless, this simpler approach was not adapted to our relatively smaller and more complex datasets, which required the less efficient, yet more powerful and expressive approach, described in Defferrard et al. (2016) ."}, {"section_title": "GCN model", "text": "Our model architecture is illustrated in Fig. 4 . The model is relatively simple and consists of a fully convolutional GCN with L hidden layers activated using the Rectified Linear Unit (ReLU) function. The output layer is followed by a softmax activation function. The graph is trained using the whole population graph as input. The training set comprises a labelled subset of graph nodes on which the loss function is evaluated and gradients are back propagated. The test set features (remaining unlabelled graph nodes) are observed during training, and influence the convolutions of labelled samples, making this a semi-supervised classification scheme. We further use a cross entropy loss function for the optimisation process. After training the GCN model, the softmax activations are computed on the test set, and the unlabelled nodes are assigned the labels maximising the softmax output."}, {"section_title": "Results", "text": ""}, {"section_title": "Experimental set-up", "text": "We evaluate our model on both the ADNI and ABIDE databases using a 10-fold stratified cross validation strategy. The use of 10 folds facilitates the comparison with the ABIDE state of the art ( Abraham et al., 2017 ) where a similar strategy is adopted. To provide a fair evaluation for ADNI, we ensure that all longitudinal acquisitions of the same subject are in the same fold (i.e. either the testing or training fold). GCN parameters that are not explored in this paper are fixed and chosen according to Parisot et al. (2017) , where they were optimised for the tasks considered here using a grid search. For ABIDE, we use: L = 1 , dropout rate: 0.3, l2 regularisation: 5 . 10 \u22124 , learning rate: 0.005, epochs: 150. The parameters for ADNI are: L = 6 , dropout rate: 0.02, l2 regularisation: 1 . 10 \u22125 , learning rate: 0.01, epochs: 200. Finally, graph construction variables \u03bb for ADNI similarity and \u03b8 for quantitative phenotypic measures are \u03bb = 10 and \u03b8 = 2 . In this section, we refer to the graph constructed from phenotypic data, as described in Section 3.4 , as the phenotypic graph. The default structures for experiments using the phenotypic graph are the ones used in Parisot et al. (2017) . The phenotypic measures used to build edges are SEX and AGE for ADNI, and SEX and SITE for ABIDE. Similarly, the default polynomial order is set to K = 3 ."}, {"section_title": "ABIDE feature selection strategy", "text": "We report the influence of the feature selection scheme on the ABIDE database for the four considered methods described in Section 2.3 , i.e. RFE, PCA, MLP and Autoencoder (AE). We train and evaluate a GCN using RFE, MLP and Autoencoder for C = { 250 , 500 , 1000 , 2000 } number of features. For PCA, we report results for C = { 250 , 500 } which correspond to approximatively 85% and 95% of explained variance. Last but not least, we report results for C = 6105 , which corresponds to using the whole feature vector as input. AE is trained for 100 epochs with a learning rate of 5 e \u22124 , while the scikit-learn ( Pedregosa et al., 2011 ) implementation with default parameters is used for MLP and PCA.\nResults are shown in Fig. 5 , reporting classification accuracy as well as Area Under Curve (AUC) for the 10 different cross validation folds. The first observation is the very poor performance of PCA as a feature selection strategy. As mentioned in Section 2.3 , this approach, although very popular and efficient for the dimensionality reduction task, is limited to finding a linear projection of the features to the lower-dimensional space. Therefore, it is not as expressive as a non-linear method, like the Autoencoder. Additionally, since the ABIDE dataset is highly heterogeneous, the variance captured in the training set is likely not as representative of the test set.\nMLP has the best performance with respect to other methods for 250 features but drops in performance when more features are added. This can be explained by the high tendency of the MLP classifier to overfit in our particular set up (notably due to our limited number of input samples). Features are learned from the training set, therefore optimised for classification of this specific subset of the data, which in turn, leads to overfitting when training the GCN model.\nAutoencoders do not have this tendency, and our AE model has the best performance for 500 and 10 0 0 features. RFE obtains the overall best performance for C = 20 0 0 features, and its performance increases as the number of features increase. The fact that AE is performing better at lower resolution can be explained by the fact that RFE loses more information (every time the number of features is reduced, the RFE eliminates new elements of the feature vector) while AE provides a more compact representation of the whole feature vector, reducing therefore information loss with respect to RFE. The better performance of RFE for 20 0 0 features can be explained by the fact that features are selected specifically for the classification task, while the autoencoder simply compresses the whole feature vector (which could notably exacerbate differences between sites), while at the same time being able to handle smaller database size contrarily to neural network models like the MLP. In the remainder of our experiments, we therefore use the RFE strategy with C = 20 0 0 features."}, {"section_title": "Influence of polynomial order K", "text": "In a separate experiment we explored the influence of the Chebyshev polynomial order, K , which was empirically fixed to K = 3 in our previous work for both ABIDE and ADNI databases. Kipf and Welling (2016) tested the performance of ChebNet on three citation networks for K \u2208 {1, 2, 3} and found that a different degree led to optimal performance for each dataset. We believe that this difference in performance with regards to K is related to intrinsic properties of the graphs. Here, we tested K \u2208 {1, 2, 3, 4, 5}, which corresponds to filters learned for neighbours K -hops away from the node at the centre of the receptive field.\nBoxplots for mean classification performance and area under curve across 10 folds on the ABIDE database are illustrated in Fig. 6 . We focus our attention to the phenotypic graph (using default phenotypic measures), which corresponds to the graph constructed taking into account SEX and SITE information, weighted by the feature correlation similarity. This graph structure was also chosen in Parisot et al. (2017) . The best average performance is achieved for K = 4 with accuracy 70.4% and AUC 0.75. However, this is only marginally better than the average performance achieved with K = 3 , where accuracy reaches 69.5% and same AUC. Performance seems to increase with K , starting with mean accuracy 65.8% for K = 1 , but then drops to 67.9% for K = 5 .\nA similar pattern is observed for the ADNI database, with results being summarised in Fig. 7 . Focusing again on the phenotypic graph based on longitudinal information and previously used in Parisot et al. (2017) , we can see that minimum performance is achieved with K = 1 yielding average classification 69.3% and AUC 0.76. Performance increases with K , leading to 78.3% accuracy and 0.84 AUC for K = 3 , while for K = 4 mean accuracy across 10 folds is 78.8% and AUC is 0.86. Similarly to the behaviour mentioned above for the ABIDE database, performance drops to 77.7% accuracy and 0.85 AUC for K = 5 and decreases even further for higher values of K . All the above indicate that the receptive field is still limited for K = 1 , while for K = 3 or K = 4 it expands enough to capture the neighbourhood structure around a node. Higher values of K likely enhance overfitting issues that arise from the limited amount of data used in comparison to tens of thousands of nodes deployed in other applications. The relationship between the optimal degree K and the diameter of the graph is yet to be explored and can lead to insightful conclusions about the degree that leads to better performance for different graph structures."}, {"section_title": "Graph construction strategy", "text": "As previously mentioned, since convolutions are parameterised on the Laplacian, the graph structure is expected to have a strong impact on semi-supervised classification performance. Therefore, we investigate the effect of different graph structures on average classification accuracy and area under curve across 10 folds. The explored graph structures include: (a) a k-nearest neighbours ( knn ) graph with k = 50 , 100 , 150 , 200 , where (dis)similarities between nodes are based solely on their associated feature information, (b) a binary complete graph, i.e. every node is connected to every other node with weight 1, (c) a complete graph weighted by the feature similarity between nodes ( all ), (d) a random graph with same edge density as the phenotypic graph but randomly rewired edges and (e) the default phenotypic graph structure where non-imaging information is used along with the feature similarity to construct the graph.\nFor the ABIDE dataset, performance for the different graph structures is summarised in Fig. 6 along with the influence of the polynomial order for each for these structures. As we can observe, the knn graphs are performing worse than all, complete, random and phenotypic for K = 1 with average accuracy 61.8% for k = 50 and 62.8% for k = 200 . Additionally all and complete graphs yield equivalent results in terms of classification accuracy (66.5%), slightly outperforming the random (65.6%) and phenotypic (65.8%) graphs and indicating that for the first-order polynomial, edge density is more important than the quality of the graph. However, the phenotypic graph is the one leading to the best performance compared to all other graphs for K = 3 and K = 4 (as wells as best overall) followed by the complete graph (67.3%) for K = 3 and all graph for K = 4 (68.3%). Interestingly, the performance achieved with the complete graph is equivalent to that of a linear classifier, as presented later in Section 3.6 , since all nodes contribute equally to filtering each node's features. The phenotypic graph is also outperforming all alternative graph structures for every K (ex- Fig. 7 . Comparison of baseline graph structures and polynomial degrees for ADNI dataset. Boxplots are generated for the performance (classification accuracy and area under curve) of each graph structure across 10 folds. cept for K = 1 ) by means of AUC, with the highest average AUC (0.75) achieved for K = 3 . It is also worth mentioning that the random graph and the knn graphs are the ones leading to the worst performance for K \u2265 2, since they fail to capture the complex associations/similarities between all available subjects and, thus, do not help leverage the power of graph convolutions.\nThe equivalent results for the ADNI database are presented in Fig. 7 . These results are slightly different from the ones presented above for the ABIDE database, since the phenotypic graph in this case is solely based on the longitudinal information and does not rely on the node features at all. Therefore, we observe a clearer 'superiority' of the phenotypic graph against all other graph structures for K \u2265 2. Apart from that, there is a negative trend in terms of classification performance for the knn and random graphs with increasing K , demonstrating that irrelevant graphs or graphs that eliminate connections between subjects yield worse performance for high K values. The best overall mean classification accuracy is achieved with the phenotypic graph for K = 4 (78.8%) with AUC 0.86, followed by the all (feature-based) graph with 69.0% accuracy and 0.75 AUC. The complete graph is also performing slightly worse than all graph (accuracy 68.0%, AUC 0.75), highlighting the fact that similarity-based edge weights are meaningful and help improve the quality of label propagation.\nAcross the two databases, we can observe that the meaningful phenotypic graph leads to the best performance compared to all baseline graph structures. This pattern is more prevalent for the ADNI database, in which case the phenotypic graph is featureindependent. The complete and all graph structures succeed the phenotypic graph, especially for higher order polynomial filters, indicating that this population-based framework can benefit from interactions between all nodes, even if the structure is not optimal."}, {"section_title": "Influence of the phenotypic measures", "text": "We showed in Section 3.4 that phenotypic measures (the default measures successfully used in our previous work ) led to the best graph construction when compared with alternative structures. In this section, we evaluate the performance of the model for different phenotypic graph configurations. Considering 3 different measures and a similarity function for each database, we investigate the influence of each measure on the overall classification performance by training multiple GCNs with different combinations of such measures and similarities. Results are reported for multiple initialisation seeds, so as to investigate the stability of the method with respect to the graph structure.\nThe default graph structure for ADNI uses the similarity link between same subjects, SEX and AGE. We, furthermore, integrate genetic information regarding the APOE4 gene. Results for multiple graph configurations using Similarity, sex, age or APOE4 measures are reported in Fig. 8 . The first observation is a sharp decrease of stability across seeds (i.e. sensitivity to initialisation/lack of convergence) as the overall performance of the graph decreases. We observe a 14% difference for worse performing graph and 5% for best performing graph. This suggests that a poor graph structure significantly decreases robustness and convergence. This is to be expected as an inadequate graph structure leads to defining inaccurate neighbourhood systems, which can strongly impact the accuracy of the convolutions. Generally, we observe that performance worsens when using AGE as a phenotypic measure, while all other measures increase performance. The similarity between same subjects significantly increases accuracy ( + 10% between SEX + APOE4 and SEX + APOE4 + Sim), but worsens when using poor graph structures (e.g sex or age only). Last but not least, we can see that adding the APOE4 measure increases results, leading to 2 graph structures that beat the performance of the default graph. Our best performance is obtained for Similarity + SEX + APOE4, corresponding to a 80% accuracy and 0.89 AUC.\nResults for the ABIDE database are reported in Fig. 9 . The default ABIDE graph is based on similarity between connectivity networks, SEX and SITE. In this experiment, we also introduce the AGE parameter. Contrarily to the ADNI database, we observe very little variation between graph structures with a 3% difference in accuracy between best and worse performing graphs. Similarly, the difference between different initialisation seeds is almost negligible. The best performing graph is the one used in Parisot et al. (2017) , i.e. the default graph, with an average accuracy over 10 seeds of 0.70 and 0.75. The similarity provides a small increase for almost all cases. SEX appears to provide a better accuracy than SITE, possibly due to the fact that the SITE based graph is highly disconnected. However, SITE provides better results in terms of AUC. Similarly to what was observed with ADNI, AGE consistently reduces the classification performance. This observation on both databases may be linked to the way that it is integrated in the graph, as it is the only phenotypic quantitative measure used in this paper.\nFinally, we compare two strategies to evaluate the overall performance between seeds: 1) averaging the accuracies obtained for all seeds and 2) ensembling the results using majority voting. We provide comparative results in Fig. 10 for both ADNI and ABIDE database. We can see that there is very little difference between both strategies for the ABIDE database and the best performing graphs of the ADNI database, while a significant increase in performance is obtained using ensembling of poor quality graphs which tend to have very unstable performances across seeds. The best performance is almost consistently obtained by ensembling. This suggests that the optimal strategy is to ensemble between multiple initialisations. However, the small variability between initialisations for good graph structures suggests that results are consistent across seeds and that one initialisation provides sufficient evaluation."}, {"section_title": "Comparison to other methods", "text": "Apart from investigating how the different components of the proposed framework impact semi-supervised classification performance, we further compared the GCN results to different wellestablished classifiers. These include a ridge classifier (using the scikit-learn library implementation ( Pedregosa et al., 2011 ) ), which showed the best performance amongst linear classifiers, a random forest classifier with 100 estimators and a multi-layer perceptron (MLP) classifier. We also add the performance reported in Parisot et al. (2017) using the GCN model (GCN) alongside the best performance obtained in this manuscript throughout our experiments (GCN (best)). This is to highlight the performance increase obtained in this paper, and for consistency purposes with Parisot et al. (2017) . For the MLP we used the same parameters as the GCN implementation, in terms of number of hidden layers, number of features, dropout, seed, learning rate and regularisation, and fixed the number of epochs to 200 for both datasets. Comparative boxplots across all folds between these three approaches, along with the previously used model and the best achieved result (in terms of accuracy) for the same seed through our extensive evaluation in this paper are shown in Fig. 11 for both databases.\nThe worst performance on the ABIDE database is observed for the random forest classifier with 61.0% average accuracy and 0.64 AUC. The ridge classifier is doing better than the MLP in terms of classification accuracy (65.3% vs 63.0%), but is outperformed by the MLP in terms of AUC (0.69 vs 0.71). The best overall performance observed with the GCN model is 70.4% accuracy and 0.75 AUC, outperforming the recent state of the art (66.8%) ( Abraham et al., 2017 ) . For the ADNI database, the worst performance is achieved with the ridge classifier (67.2% accuracy and 0.74 AUC), followed by the random forest classifier (68.8% and 0.74 AUC). The MLP classifier yields slightly improved results compared to these two classifiers with 70.4% mean classification accuracy and 0.77 AUC. GCN results for this database show a large increase in performance with respect to the competing methods, with an average accuracy of 80.0% and AUC of 0.88, higher than state of the art results ( Tong et al., 2017a ) , corresponding to a 9% increase over an MLP.\nFinally, regarding the GCN model, we observe a 4% increase in accuracy for the ADNI database using a better graph structure (integrating APOE4 gene information and eliminating AGE information) with respect to Parisot et al. (2017) . The ABIDE performance is stable, suggesting an optimal graph structure in Parisot et al. (2017) or a limitation inherent to the dataset."}, {"section_title": "Discussion", "text": "In this paper, we proposed a method for group-level population diagnosis that exploits the novel concept of spectral graph convolutions. We modelled populations as a sparse graph combining subject-specific imaging data and pairwise interactions described using phenotypic and other non-imaging information. This sparse graph is used to train a GCN in a semi-supervised manner for node classification, learning on a subset of labelled nodes and evaluating on the rest. Our experiments on two large and challenging databases (ABIDE and ADNI) confirm our initial hypothesis about the importance of contextual pairwise information for classification, as we obtain state of the art performance with 70.4% (ABIDE) and 80% (ADNI) accuracy, corresponding to increases of 5% and 9% with respect to classifiers using node features only. Our extensive evaluation analyses the different components of the model, including the feature selection method, polynomial degree and graph construction strategy. Exploring different graph structures and baselines, we show how our phenotypic graph formulation yields more accurate and stable results, as well as the impor- tance of choosing appropriate phenotypic measures to model the pairwise interactions.\nWhile our method is tested against multiple baselines, conditional random fields (CRF)/ Markov random fields (MRF) models also show interesting similarities with our approach. As in our setting, CRF models are cast as graph labelling problems and seek to increase classification performance by modelling pairwise interactions between graph nodes. Nonetheless, such approaches require substantial methodological decisions (definitions of node likelihood from a separate learning strategy, devising an optimisation strategy adapted to the considered graph structure and optimising parameters), making direct comparison not straightforward. Furthermore, CRF formulations model feature vectors and pairwise interactions sequentially, leading to a weaker model than our approach which learn end-to-end features representation informed by pairwise interactions.\nIn this paper, we cast the problem of AD and ASD diagnosis as a binary classification due to the annotations provided in the complete ABIDE and ADNI databases. However, it is well known that both diseases lie on a spectrum ( Mega et al., 1996; Volkmar et al., 2009 ) . One could therefore be seeking to carry out multi-class classification or to predict continuous outputs in such setting. This can be done easily using our framework by updating the output size and loss function to predict multi-class labels or carry out a regression task.\nThe ABIDE database is particularly challenging due to the fact that images are acquired at different sites with different protocols. This strongly reduces the comparability of image features from different sites. Our experiments suggest that an accuracy of approx. 70% could be an intrinsic limitation of the whole dataset. This observation aligns with the most recent works on the ABIDE dataset, reporting 68% ( Abraham et al., 2017 ) and 70% ( Heinsfeld et al., 2018 ) accuracies on the whole dataset (using leave one out cross validation for the latter). It is likely that increasing performance on this dataset would require models that can learn to eliminate this inter-site variability by capturing site-invariant class-discriminative patterns. It should be noted that significantly better accuracy results can be obtained when restricting analysis on one site only or when integrating cognitive test results.\nSpectral GCNs provide a powerful and principled way of performing convolutions on irregular graph structures. In this paper, we use Chebyshev polynomials, which have proven to be an excellent compromise between speed and accuracy. The recently introduced Cayley polynomials ( Levie et al., 2017 ) have shown a lot of potential and could provide further improvements of our results. Despite their many advantages, spectral GCNs have an important drawback, which is that they can only be applied to graphs of fixed structure due to their parametrisation on the graph Laplacian. While a small modification of the graph structure (e.g. replacing a node) is unlikely to alter performance, retraining the GCN will be a necessity for substantially modified graphs. This also poses a challenge when new subjects become available and need to be incorporated in the analysis, as the model will need to be trained from scratch. In situations where one expects highly variable graph structures, spatial GCNs ( Monti et al., 2016 ) should be considered.\nAnother limitation is the use of hand crafted features as node descriptors. The main advantage of deep learning is that the network learns itself an optimal feature representation of the raw input data for the task at hand. Ideally, one would want an end to end strategy, learning optimal node features from the input images or connectivity networks. This could potentially be achieved using the method proposed in Monti et al. (2017) for matrix completion, proposing a multi-graph convolution method. In our case, the second graph could be the input image data or connectivity networks. Despite their limited performance in our experiments, feature encoding using autoencoders or MLPs have the potential of providing better results than RFE. Here we use very simple models for both AE and MLP; therefore, their performance is likely to increase with appropriate parameter and model engineering. Nonetheless, the main limitation of those neural network based approaches compared to RFE is the limited amount of training data, especially for the smallest sites. Using additional data (for example using the recently released ABIDE II dataset) has the potential to increase the performance of such methods, and could also allow using adversarial techniques to learn a feature representation that is independent of the acquisition site. Last but not least, the weak performance of the considered learning based methods (AE, MLP, PCA) could be due to an excessing amount of data learning. Learning a representation from existing relationships within the dataset, and repeating the same process in the GCN network, amounts to double learning the data which could reduce performance. On the contrary, RFE does not learn a new representation of the feature vector.\nDevising an effective strategy to construct the population graph is essential and far from obvious. We have explored several graph structures in this paper and demonstrated how the graph can significantly affect classification accuracy. Our phenotypic graph construction strategy yielded the best performance, nonetheless, each graph edge comprises multiple types of information. Our experiments have shown that integrating the wrong or redundant phenotypic information (e.g. patient age in our case) has a strong negative impact on the results, while accurate measures with known links to the pathologies substantially increase performance. This is in accordance with our initial hypothesis that integrating nonimaging data that is known to influence the imaging data or subject's label yields better feature representations.\nAnother graph construction strategy could be a pure learning based approach, learning a graph structure from self-attention weights and using all potential phenotypic measures as features. An added value of such an approach could be the identification of new important phenotypic measures by exploration of learned attention weights. We could also consider attributed graph edges (i.e. a vector instead of a scalar weight) comprising all measures. Such a model could be exploited using a recent spatial GCN strategy ( Simonovsky and Komodakis, 2017 ) . The proposed framework could benefit from more sophisticated graph representation learning techniques, which can help the discovery of edge features and contribute to improved transfer-learning and node classification results ( Rossi et al., 2017 ) . One could also build multiple graph structures (e.g. one per phenotypic measure, or a mixture of phenotypic and knn graphs) and find a common Fourier base for convolutions via joint diagonalisation of the graphs' Laplacian matrices ( Eynard et al., 2015 ) .\nAmong the main limitations of this work one should consider the generalisation of this framework to unseen sites, e.g. in the ABIDE case. Since this is an application of transductive learning, generalisation to new unseen domains is expected to lead to performance decrease, especially if the training dataset is not large enough to capture population variability. Moreover, the way the ADNI graph is constructed, with multiple scans per subject being modelled as nodes and classified independently, is likely to introduce biases towards subjects with more visits available. Last but not least, highly class imbalanced problems constitute a scenario that would require further research. In this work, we performed two studies with relatively balanced data. However, in certain types of population studies (e.g. genome-wide predictions tasks ( Yones et al., 2017 ) ) one can find huge class imbalance ratios, in the order of 1:10 0 0 0. In the future, we would like to study how graph convolutions can be used to leverage the available annotated data towards improving prediction rate in highly class imbalanced problems."}]
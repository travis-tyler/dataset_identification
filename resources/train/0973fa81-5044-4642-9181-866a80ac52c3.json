[{"section_title": "Abstract", "text": "Abstract. The content-based retrieval of diffusion magnetic resonance (dMR) imaging data would enable a wide range of analyses on large databases with dMR images.This paper proposes a content-based retrieval framework for dMR images to explore the use of Diffusion Tensor Imaging (DTI) -derived parameters. The propagation graph algorithm is proposed for the query-centric retrieval of dMR subjects and the fusion of different features. The proposed framework was evaluated with ADNI database with 233 baseline dMR images. The preliminary results show that the proposed retrieval framework is able to retrieve subjects with similar neurodegenerative patterns."}, {"section_title": "Introduction", "text": "Diffusion MR imaging probes the diffusion of water molecules to investigate the architecture of the brain white matter [1, 2] . The introduction of the diffusion tensor model and the development of tractography techniques have allowed the reconstruction of the trajectory of major white matter bundles [16] .\nContent-based retrieval has been applied to many medical imaging modalities such as CT, MR and PET [14, 12, 5, 9] . The content-based retrieval of the dMR images [4] would be important for many applications, such as decision support, training and knowledge discovery. However the retrieval of brain dMR data is more challenging comparing to the traditional medical imaging modalities. Simply extracting the mean regional measurements, such as the mean diffusivity (MD) and the fractional anisotropy (FA), would be insufficient to represent the information in brain dMR, because the inter-region information should also be considered. Thus, a method is needed to combine the regional measurements as well as the brain connectome for brain dMR retrieval. Also, without proper feature encoding, the tasks related to raw dMR would pose a more intensive computational bottleneck in image querying than traditional MR due to the larger quantity of voxels required to index raw dMR images.\nTo explore the use of the DTI-derived parameters, we propose a content-based retrieval framework for brain dMR images which combines different DTI-derived metrics. Elastic Net (EN) [21] is used to filter the extracted features for specific problem domains in a supervised way. We used the Propagation Graph Fusion (PGF) [20, 13] to construct the affinity graph to index the stored subjects for query-centric retrieval. The affinity graphs constructed with different features are fused into a global graph for the multi-view content-based retrieval of dMR."}, {"section_title": "Methods", "text": ""}, {"section_title": "Preprocessing and Feature Extraction for Diffusion MR Data", "text": "Automatic brain masking is firstly applied to the dMR images. Diffusion tensors are estimated for each masked dMR brain using the least square approach [11] . The Automated Anatomical Labelling (AAL) atlas is wrapped to the subject to obtain the predefined brain ROIs [15] by registering the DWI baseline template to the target baseline volume. The mean regional measurements, including the number of tracts, the tract lengths, the tracts volume, the fractional anisotropy (FA) and the apparent diffusion coefficient (ADC), are calculated within each predefined ROI from the whole brain to represent the regional tracts density and the average water diffusivity. An example FA index slice is shown in Fig. 1-(a) . Whole-brain neural tractography is performed based on the estimated tensors using a deterministic algorithm [3] . The reconstructed fibres are filtered by the grey matter ROIs pair-wisely. The number of reconstructed fibres between each pair of AAL grey matter ROIs is stored in a symmetric matrix. The hyperparameters used in the preprocessing pipeline are consistent across different subjects. An example of the reconstructed matrix is shown in Fig. 1 -(b). For specific problem domains, such as disease determinant retrieval, Elastic Net is used to select features supervisely according to the pre-defined diagnostic labels [21] with only the normal cognitive (NC) and AD patients. It is reasonable to assume that affected brain ROIs of MCI patients are in a subset of the selected regions [7] ."}, {"section_title": "Subject-Centered Retrieval", "text": "Affinity Matrix Construction Assuming N v types of features have been extracted from N d images in the database D and denoting x i an image in the database and X the feature set, the neighbourhood of x i in the n th feature space is formed by itself and its k nearest neighbours, i.e., X\nThe Jaccard coefficient in Eq.(1) was used to establish the connections between subjects by measuring the neighbourhoods consistency as follow\nFor a query x q , its neighbourhood X searching of x q is performed by propagating the paths from x q to its k nearest neighbours x (n) q1 , . . . , x (n) q k . The neighbourhood search is recursively continued from each reached node in x (n) q1 , . . . , x (n) q k to their own k nearest neighbours. The propagation stops until there is no other neighbour to be discovered. The lengths of the paths between the query and the subject indicate the relevance. The connection weights with regard to a specific query are updated as\nwhere \u03b1 is a weight decay parameter to control the damping effect of the walk and t q (x\nis the number of iterations to reach the link (x\n. If a link is visited multiple times, we select the smallest t q for it.\nThe updated weights are saved in a\nThe Laplace smoothing is applied to A by adding 1/N d to each element to guarantee the non-zero values, because it reduces the coverage of the discoverable relevant subjects after the fusion of different features. A is then normalised to be row-stochastic.\nAffinity Matrix Fusion For each query with N types of features, N v affinity matrices A (1) , . . . , A (Nv) can be obtained. The geometric mean is used to fuse the N v matrices as follow An example of the affinity matrix fusion is illustrated in Fig 2. Our method requires A (n) (i, j) = 0, since otherwise the link (x\n(n) j ) will be disconnected regardless of the connections in other types of features. In this way, some potential candidates will be blocked. This problem is solved by Laplace smoothing during the affinity matrix construction. The weights in A * reflect the overall white matter affinity to the query. The PageRank algorithm is applied to derive the equilibrium distributions in A * [20] to re-rank the retrieved subjects according to their probabilities of relevance."}, {"section_title": "Experiments and Results", "text": "To evaluate the proposed dMR retrieval framework, 233 subjects with 3D axial brain dMR images were recruited from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database with ages ranging between 48 and 90 [10] . The subjects were divided into three groups with 61 normal cognitive (NC) subjects, 123 mild cognitive impairment (MCI) subjects and 49 Alzheimer's Disease (AD) subjects. For each image, the preprocessing of the dMR images, including tensor estimation, tractography and fibre filtering, were conducted with DSI studio (http://dsi-studio.labsolver.org) [19, 17, 18] . Some parameters used for the fibre tracking are listed in Table 1 . Step Size 0.68 Seed Number 10000\nLeave-one-out was used for evaluating the retrieval results. The tested case in each trial of leave-one-out was excluded in the feature select with EN. For each trial in leave-one-out, the Mean Average Precision (MAP) was obtained as\nwhere q is the query index, Q is the total number of queries, k is the rank in sequence of retrieved subjects, K q is the total number of retrieved subjects, p q (k) is the precision at cut-off k, rel q (k) is the relevance score of the k th retrieval result, and T q is the number of relevant subjects associated with the query. The relevance criteria were designed as shown in Table 2 . Table 2 . MAP Relevance Criteria used for retrieval evaluation [6] . Grid Search was used to obtain the hyper-parameters in the propagation graph fusion algorithm (the neighbourhood size k and the dampening factor in PageRank).The single-label and the overall MAP are presented in Table 3 . With the multiple types of features (the regional mean statistics and the fibre trackingbased features), we compared MAP of the simple feature vector concatenation (CONCAT) and the proposed propagation graph fusion algorithm (PGF). The features with/without EN filtering are also compared. Table 3 . The MAP results of the 233 dMR subjects obtained by the feature concatenation (CONCAT) and the propagation graph (PGF) algorithm using features with/without EN filtering (EN+*). The PGF algorithm with features filtered by EN (EN+PGF) performed the best MAP overall (66.46). The MAP results yielded by EN+PGF on individual labels were also more evenly distributed than EN+CONCAT which was challenging to achieve because of the imbalanced dataset. It was noticeable that without EN filtering, the PGF algorithm did not outperform the simple concatenation (CONCAT). The retrieval of dMR is highly dependent on the quality of the extracted features, which could be effected by many components along the preprocessing pipeline, such as imaging, correction, tensor estimation, tractography, template wrapping, etc. Thus the fibre tracking based features were approximated. The feature selection would filter out the noisy and biased neural patterns falsely revealed by the dMR features, enabling PGF to construct the local neighbourhoods with larger confidence. In Table 3 , the feature selection only used the data with NC and AD labels, since there were big overlaps between MCI and the other two groups."}, {"section_title": "MAP", "text": ""}, {"section_title": "Conclusion", "text": "In this paper we proposed a content-based retrieval framework for brain diffusion MR imaging data which retrieves subjects from the diffusion MR database regarding the affinity in the DTI-derived parameters. Different DTI features were derived and selected from the dMR data. The propagation graph fusion (PGF) algorithm was used to fuse the neighbourhoods obtained from different dMR features. The proposed framework was evaluated with the dMR data recruited from the ADNI database. We compared different possible settings of this dMR retrieval framework. The PGF algorithm with features selected by Elastic Net achieved the best performance according to the MAP of the AD diagnostic labels. This work indicated that DTI-derived parameters can be used to index the dMR databases for content-based retrieval in order to perform further analysis in regard to the neural changes."}]
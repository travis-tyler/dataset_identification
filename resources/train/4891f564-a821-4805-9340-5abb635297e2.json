[{"section_title": "Abstract", "text": "Abstract. Alzheimer's disease (AD) is characterized by a progressive decline in the cognitive functions accompanied by an atrophic process which can already be observed in the early stages using magnetic resonance images (MRI). Individualized prediction of future progression to AD, when patients are still in the mild cognitive impairment (MCI) stage, has potential impact for preventive treatment. Atrophy patterns extracted from longitudinal MRI sequences provide valuable information to identify MCI patients at higher risk of developing AD in the future. We present a novel descriptor that uses the similarity between local image patches to encode local displacements due to atrophy between a pair of longitudinal MRI scans. Using a conventional logistic regression classifier, our descriptor achieves 76% accuracy in predicting which MCI patients will progress to AD up to 3 years before conversion."}, {"section_title": "Introduction", "text": "Alzheimer's disease (AD) is characterized by a progressive decline of the cognitive abilities. Before being diagnosed as probable AD, patients usually go through a mild cognitive impairment (MCI) stage. The earliest signs of neurodegeneration can be observed using magnetic resonance images (MRI) already at the MCI stage [7] . Machine learning techniques have taken advantage of this fact to characterize individuals at different stages of the disease. Cuingnet et al. [6] presented a comparison of 10 methods for discrimination of healthy controls (HC) and AD patients with different degrees of neurodegeneration. The most common MRIbased features used for discrimination include tissue probability maps, cortical thickness, hippocampal morphometry or a combination of them [14] .\nAmong the personalized medicine approaches related to AD, the discrimination between patients that will remain stable in the MCI stage (i.e., s-MCI) and the ones that will progress to AD in the future (i.e., p-MCI) is possibly the one with most potential impact. Successful early identification of p-MCI patients opens up the possibility for improving clinical trials aimed at assessing preventive care treatments. Moradi et al. [9] specifically focused on the discrimination of p-MCI vs. s-MCI patients up to 3 years prior to conversion. Tong et al. [12] also identified p-MCI subjects depending on their similarity with a pre-defined dictionary containing both HC and AD subjects. This latter work was inspired by an hippocampal grading method by Coup\u00e9 et al. [4] (i.e., SNIPE) that assessed hippocampal abnormality based on local similarities to a pre-defined training library. The grade produced by SNIPE could discriminate s-MCI vs. p-MCI with high accuracy.\nThe structures in the medial temporal lobe (MTL), including the hippocampus, are among the first ones to be atrophied during the early stages of AD [11] . Strictly speaking, atrophy can only be measured using repeated acquisitions from the same subject over time (rather than using a single MRI, as in the above methods). Several approaches agree in finding atrophy rates in the MTL structures following the trend AD > MCI > HC [2, 3] . However, these approaches are not designed for personalized predictions at the individual level and can only reveal the general trends in the population.\nWe propose a novel method to describe, with a high level of detail, the atrophy patterns across a pair of MRI scans from the same subject at different time points. The proposed descriptor is suitable for being used by machine learning techniques for personalized medicine. Inspired by patch-based label fusion in multi-atlas segmentation [5] , our descriptor computes local patch-wise similarities between baseline and follow-up images. Therefore, one-to-many correspondences are used to encode local displacements. For the early prediction of AD, we feed the proposed high-dimensional descriptors extracted from the hippocampal region to a conventional logistic regression classifier.\nOther learning-based methods use longitudinal data to predict AD in the first stage of the pathology. Zhu et al. [15] proposed a constrained SVM specifically designed for longitudinal data. Jie et al. [8] proposed a constrained regression for the prediction of the evolution of cognitive scores in AD patients. The main difference between these methods and the proposed one is that the former ones propose longitudinally-aware classifiers that use conventional MRI images, whereas we propose longitudinally-specific descriptors that can be used by conventional classifiers."}, {"section_title": "Method", "text": "We present an atrophy descriptor between a pair of baseline B i and follow-up F i images for the i-th patient, aimed at capturing the subtle atrophy patterns discriminating s-MCI and p-MCI patients. In order to bring the pair of images into correspondence while still preserving the local differences due to atrophy, we affinely register the follow-up image to its baseline. We use the notation F \u2192B i to denote that the follow-up image has been registered to its corresponding baseline. In the case that we have more than one follow-up image per patient, we can divide the entire sequence into a set of pairs baseline / follow-up and treat them independently. The proposed method is divided in the following steps: (i) defining the region-of-interest (ROI), (ii) computing the patch-based similarity maps, (iii) building the atrophy descriptor and (iv) learning the classifier."}, {"section_title": "Region of Interest", "text": "We extract the high-dimensional atrophy descriptors from a ROI around the hippocampus. As shown in the literature, the hippocampus is among the first regions to be atrophied due to AD [11] and therefore it is a reasonable choice as ROI for early prediction of AD [5, 6] . We propagate the hippocampal ROI, denoted as \u2126, from a template image T onto each baseline B i using spatial warpings T T \u2192Bi obtained via non-rigid image registration. The hippocampal ROI in the template was computed by dilating (with a structuring element of 3 \u00d7 3 \u00d7 3) the hippocampal segmentation obtained through multi-atlas segmentation [5] . Fig. 1 shows the hippocampal ROI (in red) overlaid onto the template. Finally, let us denote as B i (x) , F \u2192B i (x) , x \u2208 \u2126 i , the pair of voxel intensities at corresponding location x within the ROI \u2126 i in the baseline and follow-up images of a given subject."}, {"section_title": "Patch-based Similarity Maps", "text": "We encode the atrophy patterns as one-to-many correspondences between each point in the baseline x \u2208 \u2126 i and the neighboring points in the follow-up x \u2208 N x , where N x is a cubic neighborhood of size s 3 around point x. This gives highdimensional information about local displacements undergone by each point between the two scans. We use the similarity between image patches to compute the local correspondences, where the patches centered at x and x in the baseline and follow-up images are defined respectively as P B i (x) , P F i (x ). In our experiments we use a patch size of 3 \u00d7 3 \u00d7 3.\nFor each subject, we compute a set of similarity maps W (j) i , j = 1 . . . s 3 , one for each offset in the cubic neighborhood N x , as follows:\nwhere N x (j) is the j-th offset in the cubic neighborhood and we use the exponential of the negative sum of squared differences as measure of patch similarity with a normalization constant Fig. 2 shows examples of similarity maps across each neighbor offset in a cubic 27-neighborhood. Fig. 2 . Each of the 27 tiles shows the similarity map for a different neighbor, with red and blue denoting higher and lower similarities, respectively. We have used a cubic neighborhood of size s 3 = 3 \u00d7 3 \u00d7 3 = 27. Tiles in each group of 9 are coherently placed according to their neighborhood offset within the sagittal plane. The three groups correspond to neighbors along the sagittal axis."}, {"section_title": "Atrophy Descriptors", "text": "The proposed atrophy descriptors are built by encapsulating the similarity maps W (j) i into feature vectors according to the following steps:\n1. We spatially align to a reference space the similarity maps, denoted asW T \u2192Bi (recall that similarity maps originally lie in the space of their baseline images). 2. To compensate for moderate registration errors, we smooth the warped similarities using a Gaussian kernel of width \u03c3. 3. We build the longitudinal atrophy descriptor for i-th subject, denoted as z i , by concatenating the similarities across ROI locations and neighbors, i.e., W (j)\n(in practice, we subsample the locations with a step size \u03c1 along each dimension in order to reduce redundancy and decrease the vector's length).\nThe length of the final vector is approximately |\u2126|\u00b7s 3 /\u03c1 3 . In our experiments we set \u03c3 = 1.0, s 3 = 27 and \u03c1 = 2."}, {"section_title": "Learning", "text": "Given the atrophy descriptors computed in the previous section in a population of training subjects {z i , i = 1 . . . n}, we learn a logistic regression classifier to predict the future outcome of each patient, denoted as y i = {\u22121, 1}, for s-MCI and p-MCI, respectively. Prior to learning, we select the most important features by training a random forest classifier with 1000 trees on the future outcome of each patient. As input to the logistic regression classifier, we only use the features with an importance above 0.5 \u00b7 \u00b5, where the importance is computed according how much a feature decreases the average impurity on the forest and \u00b5 is the average importance across features 6 . After the feature selection step, we train a logistic regression classifier by minimizing the empirical loss over our training data subject to some regularization constraint. We define the optimization as:\nwhere v and b are the parameters of the logistic regression classifier and z i is the vector of selected features from the i-th subject. The first term penalizes the classification errors and the second term, modulated by the scalar \u03bb, enforces the sparseness of the coefficients-vector v through the L 1 -norm. The sparsity regularization is suitable when the number of features is much larger than the number of training samples, as in our case. Given the atrophy descriptor extracted from a new testing subject z, first we obtain z by picking the most important features as determined during training and then we classify it as p-MCI or s-MCI according to the output of the function: sign (f (z ; v, b)), where f (\u00b7) is the learned logistic regression classifier."}, {"section_title": "Experiments", "text": "We evaluate our method in classification experiments between MCI patients that remain stable (i.e., s-MCI) and MCI patients that will progress to AD in the following 3 years (i.e., p-MCI). We use the same subset of ADNI 7 as in [9, 12] , containing 164 p-MCI and 100 s-MCI subjects 8 . We use the first scan (i.e., baseline, B i ) and second scan (i.e., follow-up F i ) of each subject in order to compute the atrophy descriptors. Images are corrected for inhomogeneities with the N4 algorithm [13] and their histograms linearly matched to a reference template [10] . Follow-up images F i are affinely registered to their respective baselines B i with ANTs [1] . Subsequently, also with ANTs, we compute non-rigid spatial transformations from the MNI152 template to each of the baselines T T \u2192Bi .\nFor each subject, we build the atrophy descriptors as follows:\n1. The hippocampal ROI is propagated from the template to each of the baselines B i , as described in Sec. 2.1. 2. Similarity maps W (j) i are computed using baseline and registered follow-up scans, as described in Sec. 2.2. 3. Atrophy descriptors z i are built after smoothing and subsampling the warped similarity mapsW\nAlternatively, we also compute more compact representations by decomposing the similarities at each point through PCA. We took the first 10 components explaining > 90% of the variance of the data. Table 1 shows the average classification accuracy obtained by logistic regression with the proposed atrophy descriptors in 10-fold cross-validation experiments (with and without PCA decomposition) for a range of regularization strengths \u03bb. Table 1 . Accuracy of the proposed method in 10-fold cross-validation classification of s-MCI and p-MCI subjects for increasing regularization strenghts. First row corresponds to the original proposed descriptor. Second row corresponds to the proposed descriptor with an additional PCA decomposition step.\nAs we can see in Table 1 , the additional PCA decomposition step degrades the discrimination accuracy, thus suggesting that some important information may be lost after the linear decomposition in the present application. Note that, even we only sacrifice 10% of the variance of the data in the PCA decomposition, we may also lose some structure imposed by the normalization of the similarities (i.e., similarities may not add up to one after the reconstruction).\nFor comparison, in Table 2 we show the results reported by state-of-the-art methods in s-MCI vs. p-MCI classification using MRI features (including some methods using the same dataset as ours).\nComparing results in Table 2 , we can see that our method achieves state-ofthe-art performance. Our results are directly comparable to [9, 12] , since we use the same dataset. It is worth noting that [9, 12] use the whole brain whereas we only use the hippocampal ROI. On the other hand, we use a pair of baseline and follow-up scans whereas [9, 12] AD classification [11] . As another difference, results of [4, 14] correspond to early prediction of up to 4 years before conversion, whereas our results (as well as those in [9, 12] ) correspond to prediction up to 3 years before conversion. The rest of longitudinal methods (i.e., [15, 8] ) use at least 4 follow-up scans for each subject, whereas we use only 1 baseline and 1 follow-up scan. Zhu et al. [15] discriminate between progression to AD at intervals 18, 12, 6 and 0 months with accuracies 0.76, 0.81, 0.83 and 0.84, respectively, hence the interval 0.76 \u2212 0.84 in the table."}, {"section_title": "Conclusions", "text": "We have presented a high-dimensional atrophy descriptor for early AD prediction using longitudinal MRI data. We achieve state-of-the-art performance by feeding our proposed descriptor to a conventional logistic regression classifier. Results suggest that our descriptor is suitable for capturing subtle atrophic patterns distinguishing s-MCI and p-MCI patients up to 3 years before conversion. Indeed, the hippocampal ROI is a suitable region for prediction in the early stages because it is among the first areas revealing atrophy due to AD [11] . Other methods have also focused in this ROI, achieving comparable performance to methods using the whole brain [4] . Effective ways to reduce the dimensionality should be explored in order to extend the use of the proposed descriptor to larger areas of the brain. Results in [15] suggest room for improvement in using the full sequence of follow-up scans (instead of the first 2 ones). Possible lines of future work include combining our descriptor extracted from full follow-up sequences with longitudinally-aware classifiers."}]
[{"section_title": "Abstract", "text": "Segmentation of brain structures from magnetic resonance (MR) scans plays an important role in the quantification of brain morphology. Since 3D deep learning models suffer from high computational cost, 2D deep learning methods are favored for their computational efficiency. However, existing 2D deep learning methods are not equipped to effectively capture 3D spatial contextual information that is needed to achieve accurate brain structure segmentation. In order to overcome this limitation, we develop an Anatomical Context-Encoding Network (ACEnet) to incorporate 3D spatial and anatomical contexts in 2D convolutional neural networks (CNNs) for efficient and accurate segmentation of brain structures from MR scans, consisting of 1) an anatomical context encoding module to incorporate anatomical information in 2D CNNs, 2) a spatial context encoding module to integrate 3D image information in 2D CNNs, and 3) a skull stripping module to guide 2D CNNs to attend to the brain. Extensive experiments on three benchmark datasets have demonstrated that our method outperforms state-of-the-art alternative methods for brain structure segmentation in terms of both computational efficiency and segmentation accuracy."}, {"section_title": "I. INTRODUCTION", "text": "Deep learning methods have achieved huge success in a variety of image segmentation studies, including brain structure segmentation from magnetic resonance (MR) scans [1] [2] [3] [4] [5] [6] [7] [8] [9] [10] [11] [12] [13] [14] . Previous works on the brain structure segmentation have favored volumetric segmentation based on 3D convolutional neural networks (CNNs) [1] [2] [3] [4] [5] [6] [7] [8] . These methods typically build deep learning models based on overlapped 3D image patches. In particular, DeepNAT was proposed to predict segmentation labels of 3D image patches under a hierarchical classification and multi-task learning setting [7] ; a 3D whole brain segmentation method was developed to segment the brain structures using spatially localized atlas network tiles (SLANT) [3] ; and a transfer learning method was developed to segment the brain structures by learning from partial annotations [2] . Although these 3D segmentation methods have achieved promising segmentation performance, they are computationally expensive for both model training and inference, and their applicability is potentially hampered by the memory limitation of typical graphics processing units (GPUs).\nIn order to improve the computational efficiency of deep learning models for the brain image segmentation, a variety of deep learning methods have been developed for segmenting 2D image slices of 3D MRI brain images [15] [16] [17] . Particularly, QuickNAT [15] was proposed to segment 2D brain image slices in multiple views (Coronal, Axial, Sagittal) using a modified U-Net framework [18] with densely connected blocks [19] . Furthermore, a modified version was developed to improve its performance [17] with a joint spatial-wise and channel-wise Squeeze-and-Excitation (SE) module that fuses both spatial and channel information within local receptive fields [20] . These 2D segmentation methods could segment a whole brain image in ~20 seconds on a typical GPU. However, the 2D segmentation methods ignore intrinsic 3D contextual information of 3D brain MR images, which could potentially improve the segmentation performance if properly utilized.\nMost deep learning-based brain structure segmentation methods focus on segmentation of coarse-grained brain structures, and it remains largely unknown if they work well for segmenting the MRI brain images into fine-grained structures. Whereas the fine-grained brain structure segmentation could provide richer neuroanatomy information than a coarse-grain brain structure segmentation in neuroimaging studies of brain development, aging, and brain diseases [21] , it is more challenging as the fine-grained structures are relatively small and with similar image appearances, especially for the 2D segmentation methods that do not utilize 3D contextual information.\nTo achieve fast and accurate segmentation of fine-grained brain structures from MR scans, we develop a deep neural network for segmenting 2D slices of MR scans by integrating 3D spatial and anatomical contexts in 2D CNNs, inspired by the success of deep learning with contextual information for image segmentation [9, 10, [12] [13] [14] . Particularly, anatomical context is encoded in 2D CNNs through an attention module with a global anatomy classification supervision and 3D spatial context is encoded in 2D multi-channel input of spatially consecutive image slices. Additionally, the segmentation network also integrates a skull stripping auxiliary task to guide the network to focus on the brain structures. The method has been compared with state-ofthe-art alternative deep learning methods in terms of computational efficiency and segmentation accuracy based on 3 data sets, consisting of 234 MR scans. (d) A Skull Striping Module to enforce the network to specifically focus on the brain. Particularly, 2D and 3D intrinsic features are obtained from each input and are concatenated as the input to a decoder and a context encoder. The context encoder utilizes the encoded anatomical context to predict a scaling factor which highlights brain structure-dependent variation in the encoded semantics by optimizing Anatomical Context Encoding Loss. Furthermore, an element-wise multiplication is applied to fused semantics (e) and skull stripping features (d) in order to generate the final prediction."}, {"section_title": "II. METHODS", "text": "We develop a deep learning method, referred to as Anatomy Context-Encoding network (ACEnet), for segmenting both coarsegrained and fine-grained anatomical structures from brain MR scans. ACEnet is a 2D network for segmenting brain MR scans slice by slice. As illustrated in Fig. 1-(a) , ACEnet is built upon a densely connected encoder-decoder backbone, consisting of 1) a 3D spatial context encoding module as shown in Fig. 1-(b) to integrate 3D spatial appearance information in 2D CNNs; 2) an anatomical context encoding module as shown in Fig. 1 -(c) to incorporate anatomical information in 2D CNNs with a classification loss of brain structures; and 3) a skull stripping module as shown in Fig. 1-(d) to guide 2D CNNs to attend the brain. Image features learned by these 2D CNNs are finally fused to segment brain structures as illustrated in Fig. 1 -(e). In the present study, we focus on image slices in coronal plane."}, {"section_title": "A. Network Backbone", "text": "The network backbone is an U-Net [18] with 4 densely connected blocks for both the encoder and the decoder, as illustrated in Fig. 1 -(a). Each dense block contains 2 padded 5 \u00d7 5 convolutions followed by a 1 \u00d7 1 convolution layer. Particularly, maxpooling layers are adopted in the encoder blocks and up-sampling layers are adopted in the decoder blocks. Skip connections are deployed between the encoder and the decoder blocks with the same spatial dimensions. To fuse both spatial-wise and channelwise information within local receptive fields, spatial and channel Squeeze-and-Excitation (sc-SE) [17] is applied to each encoder, bottleneck, and decoder dense blocks. The spatial Squeeze-and-Excitation (s-SE) block is proposed for 2D image classification tasks [20] , where the s-SE blocks concentrates on the class interdependencies to emphasize the important channels, while ignoring the less important ones. The channel Squeeze-and-Excitation (c-SE) block was introduced for image segmentation tasks [17] . Similar to s-SE blocks, c-SE blocks concentrate on the important spatial locations and ignore the irrelevant ones, where the global spatial information is specifically recalibrated. The spatial and channel excitations are fused by a Max-Out operation. The channel SE block contain a hyper-parameter , and in this setting, we set = 2 for all experiments as suggested in [17] . In this backbone setting, our goal is to learn image features for effective brain structure segmentation."}, {"section_title": "B. Spatial Context Encoding Module", "text": "To utilize 3D spatial information of MR scans in ACEnet, consecutive image slices are used as input to the spatial context encoding module, as illustrated in Fig. 1-(b) . The consecutive image slices are regarded as a stack of 2D images with dimensions of \u00d7 \u00d7 , where and are spatial dimensions of the 2D image slices and is the number of 2D image slices, rather than as a 3D volume with dimensions of \u00d7 \u00d7 \u00d7 1. Therefore, the input to the spatial context encoding module is of the same dimensions as the 2D input to the network backbone as illustrated in Fig. 1-(a) . Particularly, we set = 2 + 1, where is the consecutive 2D image slices stacked on top and bottom of the center slice that is the same input image slice to the 2D Dense-Unet backbone. Instead of directly implementing a 3D CNN module, which is computationally expensive, the spatial context encoding module acquires intrinsic spatial context information with less computation cost. This module adopts the same network structure as the encoder of the network backbone. The output of the spatial context encoding module is concatenated with the Dense-Unet encoder output as input to the anatomical context encoding module ( Fig. 1-(c) ) and the decoder."}, {"section_title": "C. Anatomical Context Encoding Module", "text": "The anatomical context encoding module is developed to integrate global anatomical information in ACEnet. As illustrated in Fig.  1 -(c), the output of the bottleneck part of the network is used as input to the anatomical context encoding module, consisting of an encoding layer, a fully connected layer, and an activation function. Instead of placing the anatomical context encoding module in either encoders from 2D or 3D inputs to extract features, we attach it to the network bottleneck that contains high level information learned from the data with a reduced dimensionality. The anatomical context is learned through the encoding layer and is then passed through the fully connected layer followed by a sigmoid activation function that detects the presence of specific brain structures in the input of 2D image slice. Particularly, the detection of the presence of specific brain structures in the input of 2D image slice is formulated as a classification problem with an anatomical context encoding loss (ACE-loss) to optimize the network under a direct supervision to specifically focus on the brain structures present in the 2D image slice under consideration, rather than all the brain structures to be segmented. We refer the output of the anatomical context encoder as encoded anatomical context.\nTo facilitate the semantic segmentation, the encoded anatomical context is utilized to extract the global semantic context represented by a scaling attention factor. This scaling attention factor, denoted by , is the output of a sigmoid function (\u2022), i.e. = ( ), where is the layer weight and is the encoded anatomical context. This scaling attention factor provides the network with the global anatomical context to squeeze the intensity ambiguity between brain structures with similar appearances, and to selectively highlight the learned feature maps associated with specific brain structures present in the input of 2D image slice. This scaling factor is also utilized to recalibrate the decoded output, calculated as = \u2a02 , where is the feature maps generated from the decoder and \u2a02 is the channel-wise multiplication. We refer to this recalibrated output as fused semantics."}, {"section_title": "D. Skull Stripping Module", "text": "In order to guide the brain structure segmentation network to focus on the brain structures, rather than non-brain structures such as nose and neck region, we include a skull stripping module as an auxiliary task to extract the brain from MR scans, as illustrated in Fig. 1-(d) . The skull stripping module learns informative features in a supervised manner with a skull stripping loss function. The learned image features are combined with the recalibrated output as illustrated in Fig. 1 -(e) to generate the brain structure segmentation labels."}, {"section_title": "E. Loss Function", "text": "We use three loss functions to train the network, including (i) a pixel-wise cross-entropy loss , (ii) a multi-class Dice loss , and (iii) an anatomical context encoding classification loss . The pixel-wise cross-entropy loss measures similarity between output segmentation labels and manual labeled ground truth [22] . Denote as the estimated probability of pixel belonging to class , and as ground truth labels, the pixel-wise cross-entropy loss is:\n= \u2212 \u2211 ( ) log( ( )). Particularly, frequencies of voxel-wise segmentation labels of the training could be used as class weights in the pixelwise cross-entropy loss [15] . Denote as class and its frequency in the training data, as the indicator function, as the segmentation mask and \u2207 as the 2D gradient operator, the class weight ( ) is computed as:\nThe multi-class Dice score is often used as an evaluation metric in image segmentation studies. In the present study, we include the multi-class Dice loss function to overcome class-imbalance problem [15, 16] , which is formulated as:\nThe anatomical context encoding loss is used to incorporate anatomical information in 2D CNNs so that the network focuses on specific brain structures present in the input of 2D image slice:\n, where as the number of classes of brain structures, is the ground truth that a specific brain structure is present in the input of 2D image slice, and ( ) is the predicted probability of the presence of that specific brain structure. This loss is adopted to learn the anatomical context as shown in Fig. 1-(c) .\nBoth and loss functions are applied to the skull stripping module for skull stripping as , and fused structural segmentation prediction as . Therefore, the overall loss is formulated as:"}, {"section_title": "F. Implementation Details", "text": "Our network takes a 2D image slice of 256 \u00d7 256 \u00d7 1and a 3D image volume of 256 \u00d7 256 \u00d7 (2 + 1) as inputs, all in coronal view. We employed a learning rate scheduling \"poly\" that is updated at each step as = \u00d7 (1 \u2212 ) [9] , where is the initial learning rate. We set power to 0.9 as suggested in [12] . We trained our model in two stages as detailed in Section IV-C. In the first stage, we chose an initial learning rate of 0.01 and 0.02 for segmenting coarse-grained structures and fine-grained structures respectively. In the second stage, we set the initial learning rate to 0.001 and 0.005 for segmenting coarse-grained structures and fine-grained structures respectively. Both pre-trained and fine-tuned model were trained for 100 epochs to converge. In both the stages, we utilized the SGD optimizer with a momentum of 0.9 and a weight decay rate of 1 \u00d7 10 \u22124 . The dropout rate of 0.1 was applied to each densely connected block [23] . All experiments were performed on a single NVIDIA TITAN XP GPU with 12GB of RAM. It took ~10 seconds to segment an MRI scans of 256 \u00d7 256 \u00d7 256 on a NVIDIA TITAN XP GPU."}, {"section_title": "III. EXPERIMENTAL DATASETS AND SETTINGS", "text": "We evaluated our method based on three public datasets with manually labelled coarse-grained or fine-grained brain structures, as detailed following.\n(i) 2012 Multi-Atlas Labelling Challenge (MALC): This dataset contains MRI T1 scans from 30 subjects with manual annotations for the whole brain, including 27 coarse-grained structures and 134 fine-grained structures [24] . This challenge dataset also provides a list of 15 training subjects and a list of 15 testing subjects. The same setting [15] was used in our experiments to train and evaluate deep learning segmentation models.\nBased on the 2012 MALC training scans, we generated an augmented training data set. Particularly, we applied deformable registration to warp the training images and their corresponding segmentation labels to twenty 1.5 T MR images, randomly selected from Alzheimer's Disease Neuroimaging Initiative (ADNI) dataset [25] . In total 300 warped images and segmentation label images were obtained as the augmented training dataset.\n(ii) Mindboggle-101: This dataset contains MRI T1 scans from 101 healthy subjects with 63 manual annotated brain structures [26] . In the present study, we randomly split the dataset into training (60%), validation (10%), and test (30%) sets. The best validation model was utilized for testing.\n(iii) Schizophrenia Bulletin (SchizBull) 2008: This dataset is part of the Child and Adolescent Neuro Development Initiative (CANDI) dataset, consisting of MRI T1 scans from 103 subjects with 32 manual labeled brain structures. In the present study, we randomly split the data into training (60%), validation (10%) and test (30%) set. The best validation model was utilized for testing.\nIn our experiments, all the images were resampled into an isotropic volume of 1 3 by \"mri_convert\" of FreeSurfer [27] . No other preprocessing procedures were applied to these images. We carried out ablation studies to evaluate how different components of our method contribute to the segmentation based on the 2012 MALC dataset. In particular, we adopted an improved version of QuickNAT (referred to as QuickNAT for simplicity) [17] as baselines that were built upon the same Dense U-Net structure as ACEnet. In the present study, we adopted the same training protocol without pretraining as used in [15] , but only used image slices in coronal view to train and evaluate the segmentation models.\nBased on the 2012 MALC test dataset with coarse-grained segmentation structures, we also compared our method with state-of-the-art alternative methods, including 3D CNN methods with 3D U-Net [28] , SLANT8, SLANT27 [3] , MO-Net [2] , Seg-Net [29] , and 2D CNN methods with SD-Net [16] , 2D U-Net [18] , and QuickNAT [17] . Except QuickNAT [17] , performance measures reported in respective studies were adopted. We also compared our method with QuickNAT based on the other three datasets. Image segmentation performance was evaluated based on the testing data using Dice Score, Jaccard Index, and Hausdorff distance between the ground truth and automatically segmented brain structures [30, 31] . Two-side Wilcoxon signed rank tests were adopted to compare ACEnet and QuickNAT in terms of Dice scores of individual brain structures. "}, {"section_title": "IV. EVALUATION RESULTS", "text": ""}, {"section_title": "A. Ablation Studies on Backbone Structure", "text": "ACEnet's backbone is a U-Net architecture, consisting of 4 densely connected blocks for both the encoder and the decoder. To investigate how the decoder setting affects the segmentation performance, we evaluated settings of 1) 2 layers of residue blocks [18] followed by a bilinear up-sampling ratio of 4, 2) 2 layers of dense blocks [19] followed by a bilinear up-sampling ratio of 4, and 3) 4 densely connected blocks [19] . As summarized in Table 1 (the top panel), the setting of the 4 densely connected blocks had the overall best performance in terms of the mean dice score. In all following experiments, the setting of the 4 densely connected blocks was used to build the networks. We also evaluated if the pixel-wise cross-entropy loss with the class weights could improve the segmentation performance. As summarized in Table 1 (the middle panel), the pixel-wise cross-entropy loss without the class weights had better performance. In all following experiments, the pixel-wise cross-entropy loss without the class weights was used."}, {"section_title": "B. Ablation Studies on Modules of Spatial Context, Anatomical Context, and Skull Stripping", "text": "We investigated the effectiveness of modules of 1) spatial context, 2) anatomical context, and 3) skull stripping. In the spatial context encoding module, we set = 5. As summarized in Table 1 (the bottom panel), the pixel-wise cross-entropy loss without the class weights had better performance when the spatial context encoding module was used and the best segmentation performance was achieved by the network with all the aforementioned modules. Specifically, the two-stage training strategy could improve the segmentation performance from 88.9% to 89.4% in terms of Dice score. To investigate how the parameter in the spatial context encoding module affects the segmentation performance by fixing other parameters, we evaluated networks built with different values of using the end-to-end training setting. As summarized in Table 2 , the best performance for the coarse-grained segmentation was achieved with = 3, while the best performance for the fine-grained segmentation performance was achieved with = 7. These values were adopted in all following experiments for the coarse-grained and fine-grained segmentation studies, respectively. "}, {"section_title": "C. Ablation Studies on training strategies", "text": "We investigated the effectiveness of the end-to-end training and two-stage training strategies. For the two-stage setting, we trained our model by utilizing only fused semantics outputs ( Fig. 1-(e) ) without skull stripping module ( Fig. 1-(d) ) in the first stage, and then in the second stage we incorporated the pre-trained weights obtained in the first training stage in the proposed architecture with the skull stripping module as an auxiliary task. We freeze the pretrained weights and fine-tuned the model on the second stage. As summarized in Table 3 , the end-to-end model yielded better results than the model without the skull stripping module obtained in the first stage, and the model obtained in the second stage obtained the best performance. We adopted the two-stage training strategy in all following experiments. "}, {"section_title": "D. Comparison with Alternative Methods with 2D or 3D CNNs for the coarse-grained segmentation", "text": "We compared our method with alternative state-of-the-art deep learning methods with 2D and 3D CNNs based on MALC dataset for the coarse-grained segmentation. Particularly, the deep learning methods built upon 3D CNNs were trained and evaluated for the segmentation with 25 structures [2, 3, 28] , while the those built upon 2D CNNs were trained and evaluated for the segmentation with 27 structures [15, 16, 18] . As summarized in Table 4 , our method our method with augmented training data achieved the best accuracy in terms of Dice score. In particular, without data augmentation, our method obtained a mean Dice Score of 89.2%, a 1.6% improvement compared with compared with the second best method, i.e., QuickNAT [17] . The data augmentation further improved our method and yielded a 2.0% improvement compared to QuickNAT. We then compared our method with QuickNAT [17] for the coarse-grained segmentation based on both the MALC dataset with 27 structures and the SchizBull 2008 dataset in terms of Dice score, Jaccard score, and Hausdorff distance. As summarized in Table 5 , our method outperformed QuickNAT on both the datasets. The QuickNAT models were trained using the same datasets as our models. We also reported the performance on the validation dataset of the SchizBull 2008 dataset. Representative segmentation results are visualized in Fig. 2 with zoomed-in regions to highlight differences among results obtained by the methods under comparison. As illustrated by the results on the top row, our method had visually better segmentation performance than QuickNAT for segmenting the left lateral ventricle on the MALC dataset. Statistical comparisons on Dice scores of individual structures have further confirmed that our method had significantly better performance than QuickNAT for segmenting all brain structures on the 2012 MALC testing dataset ( <0.05, two-sided Wilcoxon signed rank test). The results shown on the second row indicated that our method had better performance than QuickNAT for segmenting bilateral amygdala on the SchiBull 2008 dataset. As illustrated in Fig. 3 and Fig. 4 , statistical comparisons on Dice scores of individual structures have also indicated that our method had significantly better performance than QuickNAT for segmenting all brain structures on the SchiBull dataset ( <0.05, two-sided Wilcoxon signed rank test). Overall, two-sided Wilcoxon signed rank tests indicated that our method performed significantly better than QuickNAT for segmenting the coarse-grained brain structures in terms of Dice score on both the MALC and SchiBull datasets with values of 5.61 \u00d7 10 \u22126 and 7.95 \u00d7 10 \u22127 , respectively. "}, {"section_title": "E. Comparison with Alternative Methods with 2D or 3D CNNs for the Fine-grained Segmentation", "text": "We also compared our method with alternative state-of-the-art deep learning methods with 2D and 3D CNNs based on the 2012 MALC dataset for the fine-grained segmentation, including U-Net [2] and Seg-Net [29] with 3D CNNs and QuickNAT with 2D CNNs. We trained two ACEnet models, one based on the MALC training dataset and the other based on the augmented MALC training dataset. As summarized in Table 6 , both ACEnet models had better performance than alternative methods under comparison. These results also indicated that the data augmentation could improve our method for the fine-grained brain structure segmentation.\nIn particular, without data augmentation, our method obtained a mean Dice Score of 75.0%, a 6.3% improvement compared with QuickNAT [17] . The data augmentation further improved our method and yielded a 7.7% improvement compared to QuickNAT and a 3.9% improvement compared with Seg-NET, respectively. Furthermore, we compared our method with QuickNAT [17] for the fine-grained brain structure segmentation based on both the MALC dataset with 134 structures and the Mindboggle-101 dataset in terms of Dice score, Jaccard score, and Hausdorff distance. The QuickNAT models were trained using the same datasets as our models. We also reported the performance on the validation dataset of the Mindboggle-101 dataset. As summarized in Table 7 , our method outperformed QuickNAT on both the datasets in terms of Dice score, with a 2.8% improvement on the Mindboggle-101 dataset compared with QuickNAT. In terms of Jaccard score, our method with augmented training data achieved an 8.8% improvement on the 2012 MALC fine-grained dataset, and a 3.6% improvement on the Mindboggle-101 dataset compared with QuickNAT. The results of skull stripping were promising.\nRepresentative segmentation results for the fine-grained brain structure segmentation shown in bottom 2 rows of Fig. 2 have demonstrated that our method achieved better performance than QuickNAT. As illustrated in Fig. 5 and Fig. 6 , statistical comparisons on Dice scores of individual structures have also indicated that our method had significantly better performance than QuickNAT for segmenting most of the brain structures on both the MALC and Mindboggle-101 datasets ( <0.05, two-side Wilcoxon signed rank test). Overall, two-side Wilcoxon signed rank tests indicated that our method performed significantly better than QuickNAT for segmenting the fine-grained brain structures in terms of Dice score on both the MALC and Mindboggle-101 datasets with values of 3.22 \u00d7 10 \u221224 and 7.58 \u00d7 10 \u221212 , respectively."}, {"section_title": "V. DISCUSSIONS", "text": "We propose a new deep learning method, Anatomy Context-Encoding network (ACEnet), to segment brain structures from 3D MRI head scans using 2D CNNs enhanced by 3D spatial and anatomical context information. Experimental results based on three benchmark datasets have demonstrated that our method could achieve better segmentation accuracy than state-of-the-art alternative deep learning methods for both the coarse-grained and fine-grained brain structure segmentation tasks. Furthermore, the skull stripping module and the two-stage training strategy also obtained promising performance. The deep learning segmentation models built by our method could segment an MRI head scan of 256\u00d7256\u00d7256 within ~10 seconds on a NVIDIA TITAN XP GPU, facilitating real-time applications.\nWe have compared our method with state-of-the-art brain image segmentation methods built upon 2D CNNs and 3D CNNs base on the 2012 MALC dataset for both the coarse-grained and fine-grained brain structure segmentation tasks. Our method achieved better segmentation accuracy than the methods under comparison. For the fine-grained brain structure segmentation task, our method could be further improved by data augmentation. Our method was also compared with QuickNAT [17] based on the same training and testing datasets on the MALC (27 structures), MALC (134 structures), SchizBull, and Mindboggle-101 datasets. The experimental results have indicated that our method achieved better segmentation accuracy than QuickNAT in terms of Jaccard score, Hausdorff distance and Dice score with statistical significance.\nOur method is built upon QuickNAT with 3 additional modules. First, our method has a Spatial Context Encoding Module to encode 3D spatial context information of consecutive image slices of a 2D image slice under consideration as a multi-channel input. This module uses 2D convolutional layers to extract 3D spatial context information for computational efficiency. Ablation studies indicated that this module could improve the segmentation performance for both the coarse-grained and fine-grained brain structure segmentation tasks. Particularly, the coarse-grain brain structure segmentation requires a smaller number of slices than the fine-grained brain structure segmentation to encode 3D spatial information.\nSecond, our method has an Anatomical Context Encoding Module to guide 2D CNNs to focus on brain structures present in the 2D image slices under consideration. This module consists of an attention factor to encode the anatomical information, learned by optimizing an anatomical context encoding classification loss to identify the presence of specific brain structures in the 2D image slices. This anatomical context encoding module improves the brain structure segmentation in two aspects. First, the anatomical context information acts as an attention factor that provides a global anatomical prior to squeeze the intensity ambiguity between structures with similar appearances. Different from training separate CNNs for segmenting different brain structures [3] , the attention factor facilitates a single segmentation model to adaptively encode anatomical information for individual image slices. Second, the anatomical context information also serves as a regularizer to guide the 2D CNNs to focus on brain structures present in the 2D image slices under consideration, rather than all brain structures to be segmented. Such a regularizer could potentially make the segmentation more robust, especially for the fine-grained brain structure segmentation as only a small number of brain structure are present in individual image slices and therefore yield a classification problem with unbalanced training samples.\nFinally, our method has a skull stripping module as an auxiliary task to guide 2D CNNs to focus on brain structures rather than non-brain structures. Ablation studies indicated that this skull-stripping module could improve the brain structure segmentation performance.\nThe present study has following limitations. First, we did not tune the hyperparameters of the proposed method exhaustively due to high computational cost. Instead, we tuned the hyperparameters by fixing some of them, which may lead to inferior performance. Second, the parameter optimization and the ablation studies were carried out based on the MALC dataset alone. Fortunately, the optimized parameters generalized well to other datasets as our method achieved better segmentation accuracy than the alternative methods under comparison."}, {"section_title": "VI. CONCLUSIONS", "text": "Anatomy Context-Encoding network (ACEnet) provides a computationally efficient solution for both the coarse-grained and finegrained brain structure segmentation tasks. Our method could be potentially applied to other image segmentation problems, such as brain tumor segmentation [32] ."}]
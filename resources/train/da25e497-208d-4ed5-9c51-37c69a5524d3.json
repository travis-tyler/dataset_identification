[{"section_title": "Abstract", "text": "Harmful algal blooms (HABs) have frequently occurred in the James River. The State has convened a Scientific Advisory Panel (SAP) to review the James River chlorophyll-a standards. The SAP will conduct a scientific study to review the basis for setting the chlorophyll-a standards. To support the SAP study of chlorophyll-a standards, the State of Virginia has decided to develop a numerical modeling system that is capable of simulating phytoplankton and HABs. The modeling system includes a watershed model, a three-dimensional hydrodynamic model and water quality models. The focus of this study will be on the development and verification of the hydrodynamic model. In order to simulate the complex geometry of the James River, a high-resolution model has been implemented. The model has been calibrated for a long-term period of 23 years. A series of model experiments was conducted to evaluate the impact of forcings on dynamic simulation and transport time. It was found that freshwater discharge is the most sensitive for an accurate simulation of salinity and transport time. The water age predicted by the model in the tidal freshwater region represents the fluctuation of transport processes, and it has a good correlation with the algal bloom, while at the downstream, the transport time simulation agrees with the delay of the HAB in the mesohaline of the James after the HAB occurred in the Elizabeth River due to the transport processes.\nThe results indicate that the hydrodynamic model is capable of simulating the dynamic processes of the James and driving water quality models in the James River."}, {"section_title": "Introduction", "text": "The James River is a western tributary of the Chesapeake Bay (Figure 1 ). The unique geometry of the James River results in complex dynamic fields in both upstream and downstream portions of the James. The seasonal variation of the dynamic condition is believed to have a high influence on the frequent formation of harmful algal blooms (HABs) in the estuary.\nIn the tidal fresh portion of the James, the chlorophyll-a distribution is strongly influenced by hydrodynamic fields because of the limited mobility of phytoplankton. Bukaveckas et al. [1] found that the location of the chlorophyll-a maximum in the tidal freshwater James River is determined in part by the natural geomorphic features of the channel. The transition from a riverine-type (narrow, deep) cross-sectional morphology to a broad channel with shallow lateral areas provides favorable light conditions for the phytoplankton. The residence time increases during the low-flow period, which coincides with the summer period. Consequently, the phytoplankton bloom occurs frequently during summer in this region. The downstream portion of the James River is distinguished by a meandering main channel. An abrupt bend in the river occurs at Newport News Point (NNP), approximately 10.5 km from its mouth, where the orientation of the river changes from northeast-southwest in the lower river to southeast-northwest in the upper river. Hampton Flats is the shoal flanking the northern side of the deep channel in the lower James River (Figure 1 ). Water depth over the Hampton Flats is less than 5 m. This unique geometry results in a strong circulation and topographic eddy [2] , which contributes to both larval retention and the formation of the HAB in the mesohaline region of the James. Morse et al. [3] found that the Lafayette River inside the Elizabeth River, a sub-estuary of the James River, acted as the initiation region for the bloom of C. polykrikoides in the James River during the summers of 2007 and 2008. Although the bloom occurred initially in the Elizabeth River, C. polykrikoides was transported from the sub-estuary into the lower James River and a portion of the lower James due to this local estuarine circulation, and these form massive blooms over large portions of the tidal James River and the lower Chesapeake Bay.\nThe cause of the HAB in the James is attributed to the high nutrient input from both point and non-point sources. To improve the water quality condition of the estuary, nutrient reduction is needed for the upstream and lateral watersheds. Besides, the State has convened a Scientific Advisory Panel (SAP) to review and confirm or adjust the James River chlorophyll-a standards. The SAP will conduct a scientific study to review the basis for setting the chlorophyll-a standards. To support the SAP study of chlorophyll standards, a numerical model that is capable of simulating phytoplankton and harmful algal blooms is needed. The model system includes a watershed model, a three-dimensional hydrodynamic model and water quality models. The dynamic models have been often used for environmental studies and drive water quality models [4] [5] [6] [7] [8] [9] [10] .\nConsidering the variations of tidal, wind and baroclinic forcings, water movement in the tidal James is truly multi-dimensional and quite complex. The accurate simulation of transport time and residence time in the James River is the key to the success of the water quality model of the James River. To accurately simulate the hydrodynamics of the James, we developed a numerical model, which is capable of simulating the circulation features that span timescales of hours to months, and The downstream portion of the James River is distinguished by a meandering main channel. An abrupt bend in the river occurs at Newport News Point (NNP), approximately 10.5 km from its mouth, where the orientation of the river changes from northeast-southwest in the lower river to southeast-northwest in the upper river. Hampton Flats is the shoal flanking the northern side of the deep channel in the lower James River (Figure 1 ). Water depth over the Hampton Flats is less than 5 m. This unique geometry results in a strong circulation and topographic eddy [2] , which contributes to both larval retention and the formation of the HAB in the mesohaline region of the James. Morse et al. [3] found that the Lafayette River inside the Elizabeth River, a sub-estuary of the James River, acted as the initiation region for the bloom of C. polykrikoides in the James River during the summers of 2007 and 2008. Although the bloom occurred initially in the Elizabeth River, C. polykrikoides was transported from the sub-estuary into the lower James River and a portion of the lower James due to this local estuarine circulation, and these form massive blooms over large portions of the tidal James River and the lower Chesapeake Bay.\nThe cause of the HAB in the James is attributed to the high nutrient input from both point and non-point sources. To improve the water quality condition of the estuary, nutrient reduction is needed for the upstream and lateral watersheds. Besides, the State has convened a Scientific Advisory Panel (SAP) to review and confirm or adjust the James River chlorophyll-a standards. The SAP will conduct a scientific study to review the basis for setting the chlorophyll-a standards. To support the SAP study of chlorophyll standards, a numerical model that is capable of simulating phytoplankton and harmful algal blooms is needed. The model system includes a watershed model, a three-dimensional hydrodynamic model and water quality models. The dynamic models have been often used for environmental studies and drive water quality models [4] [5] [6] [7] [8] [9] [10] .\nConsidering the variations of tidal, wind and baroclinic forcings, water movement in the tidal James is truly multi-dimensional and quite complex. The accurate simulation of transport time and residence time in the James River is the key to the success of the water quality model of the James River. To accurately simulate the hydrodynamics of the James, we developed a numerical model, which is capable of simulating the circulation features that span timescales of hours to months, and simulate density circulation, geometry-induced circulation and residence time for a 23-year period. Although several models have been developed in the James River in the past, including the Chesapeake Bay water quality model [11] , a model study of dynamics related to larval transport and an environmental assessment [2, 3] , none of the models have been verified for such a long period and for the correctness of the simulation of transport time. On the other hand, the traditional model skill assessment through comparison of the tide, salinity, etc., may not be sufficient to ensure correct simulations of algae and HAB, which require accurate simulation of residence time and transport time. These characteristics are very difficult to evaluate using the traditional method. The question as to what is the influence of external forcing on simulating dynamic fields and consequently affecting the transport of water quality state variables is not well-evaluated. Therefore, the variation of the external forcing on the uncertainty of the hydrodynamic model prediction skill is the focus of this paper. Several model sensitivity simulations were conducted with respect to the variation of the external forcings, and the influence of the forcing condition on model prediction are evaluated. In order to address the influence of the accuracy of model dynamics on transport processes, we will further evaluate the model through a comparison of key transport timescales, such as water age and residence time, to evaluate model performance."}, {"section_title": "Materials and Methods", "text": ""}, {"section_title": "Study Area", "text": "The James River is the southernmost tributary of Chesapeake Bay (Figure 1 ). It is about 160.0 km long, and the width ranges from 300 m at its upstream and 6 km at the downstream with a mean depth of 3.76 m. The tidal range is about 0.74 m at Sewells Point near the mouth. The mean freshwater discharge is about 226 m 3 \u00b7s \u22121 . The monthly river discharge varies seasonally from 86 m 3 \u00b7s \u2212l in September to 365 m 3 \u00b7s \u2212l in March [2] . Salinity in the estuarine part of the James River varies seasonally, which is a common characteristic of estuaries in the mid-latitudes. Near the river mouth, the channel is more than 7 m deep, and salinity typically is around 25 parts per thousand (ppt). The horizontal salinity gradients are usually larger near the upper mesohaline of the river where the freshwater and saltwater converge. The denser, more saline bottom water enters the James River from the Chesapeake Bay and flows upstream, while the less dense surface waters, dominated by freshwater inflow, flow downstream toward the Bay [12, 13] ."}, {"section_title": "Model Configuration", "text": "The three-dimensional Environmental Fluid Dynamic Code (EFDC) was used for simulations for the James River and its tributaries. The EFDC model is a general hydrodynamic model that solves three-dimensional, time-dependent flows governed by hydrostatic primitive equations [14, 15] . The Mellor and Yamada [16] Level 2.5 turbulence closure scheme as modified by Galperin et al. [17] is implemented in the model. The model uses curvilinear, orthogonal horizontal coordinates and sigma vertical coordinates to represent the physical characteristics of a water body. A high-order transport scheme with an anti-numerical diffusion scheme is implemented in the numerical model, which is essential for simulating transport processes accurately in the Chesapeake Bay and its tributaries. A Cartesian grid model has been applied to the James to study the eddy generated at the mesohaline and polyhaline regions of the lower James [2, 18] . The model does not have sufficient resolution for the tidal freshwater region and Elizabeth River to simulate an algal bloom in these regions. A new model grid was developed for the long-term simulation of the dynamic fields. Because the water quality model simulation will span a 23-year period, the efficiency of computation needs consideration. We want to develop a model with sufficient spatial resolution for the simulation of all dynamic features, but maintaining a high efficiency of computation. The model grid cells were designed to follow the main channel of the James River. High resolution was placed on the main stem of the river to obtain the best representation of the topography in this area. The model grid is shown in Figure 1 . There are a total of 3066 grid cells in the horizontal and eight layers in the vertical. The bottom bathymetry is interpolated using the NOAA coastal relief model with 90-m resolution (https://www.ngdc.noaa.gov/mgg/coastal/crm.html). For the Elizabeth River, data measured during a survey conducted by the Army Corps (Norfolk District) were used. For small creeks, NOAA charts were used to obtain depths in shallow areas. Eight evenly-spaced sigma layers were applied in the vertical.\nThe model simulation periods are from 1991 to 2000 and from 2007 to 2013. To allow the model spin-up, the model started from 1990 and 2006, respectively, a full year in advance of each simulation period. Therefore, the impact of the initial conditions can be efficiently removed. Daily river discharges from upstream and lateral watersheds are obtained from the James River watershed model developed by TetraTech, Inc., [19] , which includes inflows from 87 sub-watersheds. The three main upstream freshwater discharges are from Richmond, the Appomattox River and the Chickahominy River, respectively. Hourly wind forcing data were obtained from the Norfolk and Richmond International Airports, which are located near the Sewells Point station at the mouth and near the fall line of the James, respectively. The open boundary conditions from 1990 to 2000 (which included hourly time-varying water level, temperature and salinity profiles) were obtained from the 3D model of the Chesapeake Bay Program [20] . Because the Chesapeake Bay Program (CBP) model does not simulate the period from 2006 to 2013, the tide boundary condition for this period used Sewells Point data with corrections of phase and amplitude. The mean differences of phase and amplitude were estimated based on CBP model outputs and measured tidal elevations at Sewells Point. The hourly salinity boundary conditions used for the 2006 to 2013 period are outputs from the large domain Chesapeake Bay model [21, 22] . The temperature boundary condition used hourly measurements at Sewells Point at the surface and monthly temperature data measured at CBP Station CB8.1. Differences of surface and bottom temperatures at Station CB8.1 were interpolated in time and applied to the hourly surface temperature data to obtain an estimation of bottom temperature. Because the temperature is highly determined by the air-sea exchange and the open boundary has less impact on the temperature inside the James, this approach yields a good model-data agreement. The radiation boundary conditions are used for the tide, salinity and temperature. Hourly wind forcing, surface pressure, humidity and solar radiation obtained from the hourly meteorological data from Norfolk and Richmond Airports were used for temperature simulations."}, {"section_title": "Age Calculation", "text": "Any change of hydrodynamic conditions will result in a change of transport processes, which is more important for transporting both nutrients and phytoplankton [21, 22] . Because it is difficult to evaluate the change of dynamic conditions (e.g., change of velocity, surface elevation) and their impact on algae and nutrient transport, we can use the transport timescale to evaluate the impact of dynamics on water quality because it shows a cumulative effect. Transport timescales, such as residence time and renewal time, are the first-order representatives of the dynamic conditions in the estuary, whereas the vertical transport time is directly related to DO exchange [21] .\nThe timescales can be computed using the concept of water age [23] . Freshwater age is the elapsed time since a water parcel leaves the head of a tributary (or any origin), where it has a continual freshwater input. The age at location x is the mean time required for a water parcel to be transported from its discharge location to location x, regardless of its pathway [24] . Delhez et al. [23] provided a way to use a numerical model to compute the water age. Assuming there is only one tracer released to a system without internal sources and sinks, the transport equation for computing the tracer concentration C(t, x ) and the age concentration \u03b1(t, x ) can be expressed as [24] :\nThe mean age can be calculated as follows:\nand K is the diffusivity tensor. To simulate age, the tracer was continuously released at the upstream or at Elizabeth River. The radiation boundary condition was applied at the mouth [18] . Because the upstream of the James River is very narrow, the age has minor variation laterally and vertically. Therefore, the difference of the cross-section average age between its upstream and downstream for a control volume is a good estimate of the local residence time for that control volume."}, {"section_title": "Results", "text": "\n"}, {"section_title": "Tidal Elevation and Current", "text": "Model validation for the tide was conducted for the entire simulation period. The surface elevations were compared to the observations at six stations. There is only one NOAA tidal station at Sewells Point. Another five stations are maintained by Virginia Estuarine and Coastal Observing System (VECOS, http://web2.vims.edu/vecos/), which measure water depth using pressure sensors. The bottom roughness height was adjusted to make the tidal propagation correct in the estuary. A constant roughness height of 0.33 cm was used. The statistics of model performance are summarized in the Taylor diagram. The Taylor diagram provides a concise statistical summary of how well patterns match each other in terms of their correlation, their root-mean-square difference and the ratio of their variance [25, 26] . Figure 2 shows the model results of tidal elevation. There are three axes shown in the diagram that represent correlation coefficients, the centered root-mean-square difference and standard deviation. All data (both modeled and observed) are normalized by the observed standard deviation at a reference station (APP001.83). The correlation axis shows the correlation between model results and observations. The standard deviation axis indicates the deviation of model results from measurements measured by the standard deviations. The circle of root-mean-square difference shows the root-mean-square difference (RMSD). The value used to normalize the RMSD is 0.3 m. \nwhere ( , \u20d7) is water age, \u2207= \u20d1 + \u20d1 + \u20d1\u20d1 and K is the diffusivity tensor. To simulate age, the tracer was continuously released at the upstream or at Elizabeth River. The radiation boundary condition was applied at the mouth [18] . Because the upstream of the James River is very narrow, the age has minor variation laterally and vertically. Therefore, the difference of the cross-section average age between its upstream and downstream for a control volume is a good estimate of the local residence time for that control volume.\nModel validation for the tide was conducted for the entire simulation period. The surface elevations were compared to the observations at six stations. There is only one NOAA tidal station at Sewells Point. Another five stations are maintained by Virginia Estuarine and Coastal Observing System (VECOS, http://web2.vims.edu/vecos/), which measure water depth using pressure sensors. The bottom roughness height was adjusted to make the tidal propagation correct in the estuary. A constant roughness height of 0.33 cm was used. The statistics of model performance are summarized in the Taylor diagram. The Taylor diagram provides a concise statistical summary of how well patterns match each other in terms of their correlation, their root-mean-square difference and the ratio of their variance [25, 26] . Figure 2 shows the model results of tidal elevation. There are three axes shown in the diagram that represent correlation coefficients, the centered root-mean-square difference and standard deviation. All data (both modeled and observed) are normalized by the observed standard deviation at a reference station (APP001.83). The correlation axis shows the correlation between model results and observations. The standard deviation axis indicates the deviation of model results from measurements measured by the standard deviations. The circle of root-mean-square difference shows the root-mean-square difference (RMSD). The value used to normalize the RMSD is 0.3 m. The modeled surface elevations are within 0.5 RMSD, which is less than 0.15 m. The RMSD is relatively low, and the simulation variations are close to observations based on the measure of the standard deviation, which is close to the reference site as observations. The correlation is larger than 0.86. It can be seen that the tide is well simulated.\nIn recent years, NOAA has conducted surface current observations in the lower James. The model-simulated currents at a station near EL5-4 are compared to the NOAA observations. Figure 3 shows the scatter plot of observations against the model simulations. The model skill, The modeled surface elevations are within 0.5 RMSD, which is less than 0.15 m. The RMSD is relatively low, and the simulation variations are close to observations based on the measure of the standard deviation, which is close to the reference site as observations. The correlation is larger than 0.86. It can be seen that the tide is well simulated.\nIn recent years, NOAA has conducted surface current observations in the lower James. The model-simulated currents at a station near EL5-4 are compared to the NOAA observations. Figure 3 shows the scatter plot of observations against the model simulations. The model skill, which is defined as 2 , was used to evaluate the model performance. Performance levels are categorized by the SS value as: >0.65 excellent; 0.65 to 0.5 very good; 0.5 to 0.2 good; <0.2 poor [25] . It can be seen that the model simulations vary each year. Overall, the simulations agree with observations with model correlation ranges from 0.6 to 0.82 and skill between 0.24 and 0.65, indicating that the current simulation is satisfactory. For detailed model results, the readers are referred to the James River Chlorophyll Study Modeling Report [19] . "}, {"section_title": "Salinity", "text": "The long-term transport processes are driven by sub-tidal circulation [12] . Correct calibration of salinity is important for accurate simulation of sub-tidal circulation. The calibration of salinity is focused on stratification and salinity intrusion. We used monthly data (measured once a month) to conduct the salinity calibration. The salinity calibration was conducted from 1991 to 2000, and the validation was conducted from 2007 to 2013. Although the data do not have high temporal resolution, these can be used to evaluate a long-term simulation of salinity for seasonal and inter-annual variations. Unlike the model calibration of surface elevation, there are no model parameters to \nThe long-term transport processes are driven by sub-tidal circulation [12] . Correct calibration of salinity is important for accurate simulation of sub-tidal circulation. The calibration of salinity is focused on stratification and salinity intrusion. We used monthly data (measured once a month) to conduct the salinity calibration. The salinity calibration was conducted from 1991 to 2000, and the validation was conducted from 2007 to 2013. Although the data do not have high temporal resolution, these can be used to evaluate a long-term simulation of salinity for seasonal and inter-annual variations. Unlike the model calibration of surface elevation, there are no model parameters to calibrate salinity for the 3D model. The discrepancy of salinity between modeled and observed is mainly caused by the freshwater discharge, boundary condition(s), the wind and bathymetry (which will be discussed in later sections). Both the transport scheme and turbulent scheme used in the model play important roles. EFDC uses a second-order transport scheme with anti-numerical diffusion; it can simulate salinity well in general. The summary of model prediction skill is shown in Figure 4 as a Taylor diagram, in which salinity is compared at seven monitoring stations along the James River (locations are shown in Figure 1 ). The value used to normalize the root-mean-square difference is 2.39 psu. It can be seen that the model has a high correlation with a low root-mean-square difference at each station. The model performance for the second period is better than that for the first period. calibrate salinity for the 3D model. The discrepancy of salinity between modeled and observed is mainly caused by the freshwater discharge, boundary condition(s), the wind and bathymetry (which will be discussed in later sections). Both the transport scheme and turbulent scheme used in the model play important roles. EFDC uses a second-order transport scheme with anti-numerical diffusion; it can simulate salinity well in general. The summary of model prediction skill is shown in Figure 4 as a Taylor diagram, in which salinity is compared at seven monitoring stations along the James River (locations are shown in Figure 1 ). The value used to normalize the root-mean-square difference is 2.39 psu. It can be seen that the model has a high correlation with a low root-mean-square difference at each station. The model performance for the second period is better than that for the first period. Important characteristics of the salinity simulation are the stratification and salinity intrusion, which are the key parameters that determine gravitation circulations. Examples of salinity stratification (difference between bottom and surface) are shown in Figure 5 for Stations LE5.1, LE5.2, LE5.3 and LE5.4, respectively, for 2008 and 2010. We compared the salinity difference between bottom and surface layers. It can be seen that the model simulated the salinity stratification during this period rather well. The model simulation of salinity intrusion is shown in Figure 6 , for surface and bottom salinity. We compared mean, minimum and a maximum of salinity for a three-day window of observations along the James River from the mouth to the salinity intrusion limit and compared it to the observations and their range. It can be seen that the simulation of modeled salinity intrusion agrees well with the observations. The model performance to simulate salinity is satisfactory. Important characteristics of the salinity simulation are the stratification and salinity intrusion, which are the key parameters that determine gravitation circulations. Examples of salinity stratification (difference between bottom and surface) are shown in Figure 5 for Stations LE5.1, LE5.2, LE5.3 and LE5.4, respectively, for 2008 and 2010. We compared the salinity difference between bottom and surface layers. It can be seen that the model simulated the salinity stratification during this period rather well. The model simulation of salinity intrusion is shown in Figure 6 , for surface and bottom salinity. We compared mean, minimum and a maximum of salinity for a three-day window of observations along the James River from the mouth to the salinity intrusion limit and compared it to the observations and their range. It can be seen that the simulation of modeled salinity intrusion agrees well with the observations. The model performance to simulate salinity is satisfactory. "}, {"section_title": "Temperature", "text": "Temperature is a key parameter for the eutrophication model, as all kinetic parameters depend on temperature, which varies from 5 to 30 \u2022 C. The observations are monthly (one observation each month at each location). A summary of model prediction skill for temperature simulation is shown in Figure 7 as a Taylor diagram, in which temperature is compared at ten monitoring stations along the James River. It can be seen that the model results include a high correlation at each station with a low root-mean-square difference. There is no difference for all stations statistically for model calibration and validation. The model results are satisfactory. \nTemperature is a key parameter for the eutrophication model, as all kinetic parameters depend on temperature, which varies from 5 to 30 \u00b0C. The observations are monthly (one observation each month at each location). A summary of model prediction skill for temperature simulation is shown in Figure 7 as a Taylor diagram, in which temperature is compared at ten monitoring stations along the James River. It can be seen that the model results include a high correlation at each station with a low root-mean-square difference. There is no difference for all stations statistically for model calibration and validation. The model results are satisfactory. "}, {"section_title": "Sensitivity Tests", "text": "For a three-dimensional model of the EFDC, the logarithmic wall function is used for shear stress. The only model parameter to be calibrated is the bottom roughness height, which determines the model simulation of the tide. However, the external forcing and open boundary conditions are critical for the accurate simulation of salinity, which is important for estuary dynamics and estuarine circulation. A series of model sensitivities is conducted to test the model performance and help understand the impact of external forcing on model performances.\nFor a three-dimensional model of the EFDC, the logarithmic wall function is used for shear stress. The only model parameter to be calibrated is the bottom roughness height, which determines the model simulation of the tide. However, the external forcing and open boundary conditions are critical for the accurate simulation of salinity, which is important for estuary dynamics and estuarine circulation. A series of model sensitivities is conducted to test the model performance and help understand the impact of external forcing on model performances."}, {"section_title": "Freshwater Discharge", "text": "Estuarine stratification is a competition between barotropic and baroclinic forcings. The large buoyant forcing is from freshwater discharge, which flows out of the estuary on top of the salty, dense water. It can be expected that a change of freshwater discharge can cause a change in salinity. For the current 3D model configuration, we used a watershed model output to drive the model. The model predictive skill is very high, but some discrepancy can be expected, as shown in Figure 8 , upstream of Richmond. A sensitivity run was conducted to replace three freshwater discharge input records from locations upstream of Richmond, Appomattox River and Chickahominy River with United States Geological Survey (USGS) flows (USGS02037500, USGS020416500 and USGS02042500). These three stations account for the majority of the flow. Figure 9 shows the comparison of the salinity difference when using watershed runoff and USGS flow. It can be seen that the model is very sensitive to the flow. The salinity can differ by 2 to 4 psu, which is on the same order as the root-mean-square error of the model calibration. Therefore, some discrepancy during salinity calibration can be expected when using flow from the watershed model. \nEstuarine stratification is a competition between barotropic and baroclinic forcings. The large buoyant forcing is from freshwater discharge, which flows out of the estuary on top of the salty, dense water. It can be expected that a change of freshwater discharge can cause a change in salinity. For the current 3D model configuration, we used a watershed model output to drive the model. The model predictive skill is very high, but some discrepancy can be expected, as shown in Figure 8 , upstream of Richmond. A sensitivity run was conducted to replace three freshwater discharge input records from locations upstream of Richmond, Appomattox River and Chickahominy River with United States Geological Survey (USGS) flows (USGS02037500, USGS020416500 and USGS02042500). These three stations account for the majority of the flow. Figure 9 shows the comparison of the salinity difference when using watershed runoff and USGS flow. It can be seen that the model is very sensitive to the flow. The salinity can differ by 2 to 4 psu, which is on the same order as the root-mean-square error of the model calibration. Therefore, some discrepancy during salinity calibration can be expected when using flow from the watershed model. It is interesting to know if the change of salinity, which is within the accepted error range due to flow or other forcings, will affect the long-term transport or export of nutrients, as the retention of nutrients and eutrophication are highly determined by the residence time [27] [28] [29] . The transport property of a substance can be quantified by the transport timescales, such as residence time and water age [21] [22] [23] [24] . The age of water is defined as the time elapsed since it leaves the headwaters. The age at each location indicates the time required for the water or conservative substance to travel from the headwaters to a specified location [18] . The age and the residence time are often sufficient to characterize the motions of a conservative substance. We computed the freshwater age along the James It is interesting to know if the change of salinity, which is within the accepted error range due to flow or other forcings, will affect the long-term transport or export of nutrients, as the retention of nutrients and eutrophication are highly determined by the residence time [27] [28] [29] . The transport property of a substance can be quantified by the transport timescales, such as residence time and water age [21] [22] [23] [24] . The age of water is defined as the time elapsed since it leaves the headwaters. The age at each location indicates the time required for the water or conservative substance to travel from the headwaters to a specified location [18] . The age and the residence time are often sufficient to characterize the motions of a conservative substance. We computed the freshwater age along the James It is interesting to know if the change of salinity, which is within the accepted error range due to flow or other forcings, will affect the long-term transport or export of nutrients, as the retention of nutrients and eutrophication are highly determined by the residence time [27] [28] [29] . The transport property of a substance can be quantified by the transport timescales, such as residence time and water age [21] [22] [23] [24] . The age of water is defined as the time elapsed since it leaves the headwaters. The age at each location indicates the time required for the water or conservative substance to travel from the headwaters to a specified location [18] . The age and the residence time are often sufficient to characterize the motions of a conservative substance. We computed the freshwater age along the James River using different flows and compared the results in Figure 10 . It can be seen that the transport process is very sensitive to the flow condition. The difference can be about five days for a given period for this example or at a particular day during the high-flow period. The change of flow can affect short-term transport processes. However, the annual mean water age does not change much as shown in Figure 11 , especially at the downstream. As the watershed model simulated flow is slightly lower than the USGS flow, even if it is higher during some high-flow periods, the transport slows slightly. However, the results indicate that it will not affect the long-term transport of nutrients in the estuary. River using different flows and compared the results in Figure 10 . It can be seen that the transport process is very sensitive to the flow condition. The difference can be about five days for a given period for this example or at a particular day during the high-flow period. The change of flow can affect shortterm transport processes. However, the annual mean water age does not change much as shown in Figure 11 , especially at the downstream. As the watershed model simulated flow is slightly lower than the USGS flow, even if it is higher during some high-flow periods, the transport slows slightly. However, the results indicate that it will not affect the long-term transport of nutrients in the estuary. "}, {"section_title": "Wind", "text": "Wind is a very important forcing to change estuarine circulation. Downstream wind can enhance the estuarine circulation, while upstream wind can increase mixing in the estuary. The wind plays an important role in the modulation of hypoxia in the Chesapeake Bay [30, 31] . A sensitivity test to determine the influence of the wind on salinity was conducted. It is unknown if the wind will have a large impact on salinity for this relatively small estuary. We reduced wind forcing by 10%, ran the model from 1990 to 1992 and compared the salinity at Stations LE5.4 and RET5.2, which represents the range of salinity intrusion in the estuary. The sensitivity results are shown in Figure 12 . It can be seen that a 10% reduction of wind can change salinity up to 2 psu at Station LE5.4, but causes less than a 0.5-psu change at Station RET5.2. Because the wind-forcing fluctuation has a frequency of three to five days in Chesapeake Bay, the short-term change of the wind on long-term transport appears not to be important for this narrow estuary. We compared water age (not shown here), as well, and found that there is no difference in water age. The results suggest that a 10% error in wind forcing will not affect the long-term transport of nutrients in the James River. \nWind is a very important forcing to change estuarine circulation. Downstream wind can enhance the estuarine circulation, while upstream wind can increase mixing in the estuary. The wind plays an important role in the modulation of hypoxia in the Chesapeake Bay [30, 31] . A sensitivity test to determine the influence of the wind on salinity was conducted. It is unknown if the wind will have a large impact on salinity for this relatively small estuary. We reduced wind forcing by 10%, ran the model from 1990 to 1992 and compared the salinity at Stations LE5.4 and RET5.2, which represents the range of salinity intrusion in the estuary. The sensitivity results are shown in Figure 12 . It can be seen that a 10% reduction of wind can change salinity up to 2 psu at Station LE5.4, but causes less than a 0.5-psu change at Station RET5.2. Because the wind-forcing fluctuation has a frequency of three to five days in Chesapeake Bay, the short-term change of the wind on long-term transport appears not to be important for this narrow estuary. We compared water age (not shown here), as well, and found that there is no difference in water age. The results suggest that a 10% error in wind forcing will not affect the long-term transport of nutrients in the James River. "}, {"section_title": "Open Boundary Condition", "text": "\n"}, {"section_title": "Discussion and Summary", "text": "The location of an algal bloom not only depends on light and nutrients, but also depends on residence time [28, 29] . A correct simulation of transport processes and residence time is critical for the algal bloom. To evaluate the model performance, we computed residence time in the tidal freshwater region and compared the results to the Chl-a observations at Stations TF5.5 and TF5.5A. It can be seen that the peak algal bloom corresponds to the low residence time at that region with a good correlation (R = 0.64, p = 0.001) ( Figure 14) . Because of the impact of available nutrients and light, it does not match all of the variation as expected. The results indicate that the model simulation transport process is satisfactory and can be used to simulate the HAB.\nHABs have occurred almost every year in summer in the mesohaline region of the James, and they are believed to be caused by the HAB bloom initiated in the Lafayette River, a tributary of the Elizabeth River [3] . After a HAB has occurred in the Elizabeth River, the bloom will occur in the James after 10 to 15 days. To verify the transport time for algal transport from the Elizabeth River to the James River, we computed the water age from the Elizabeth River to the James River. The tracer is released from the Elizabeth River; a water age at any location represents the time required for any dissolved materials to be transported from its source to the location. Figure 15 shows the age distribution. It can be seen that it takes about 10 to 15 days to reach the mesohaline region during spring and neap tides. The surface water moves upstream faster during spring tide than during neap tide. The bottom water moves 5-10 days faster upstream than surface water, which is due to the unique front and eddy system near the mouth of the James River [2] . A portion of the ebb flow will turn to the north and flood into the Hampton Flats, where a frontal system is well developed, and surface water will dive to the bottom through this frontal system and be transported upstream along the deep channel near the northern shore. Meanwhile, the flood tide will move surface water upstream [2] . The transport time for water to move from Elizabeth River to the mesohaline region of the James River agrees well with the time delay of the occurrence of the HAB in the James River after the HAB occurred in the Elizabeth River.\nThe location of an algal bloom not only depends on light and nutrients, but also depends on residence time [28, 29] . A correct simulation of transport processes and residence time is critical for the algal bloom. To evaluate the model performance, we computed residence time in the tidal freshwater region and compared the results to the Chl-a observations at Stations TF5.5 and TF5.5A. It can be seen that the peak algal bloom corresponds to the low residence time at that region with a good correlation (R = 0.64, p = 0.001) ( Figure 14) . Because of the impact of available nutrients and light, it does not match all of the variation as expected. The results indicate that the model simulation transport process is satisfactory and can be used to simulate the HAB.\nHABs have occurred almost every year in summer in the mesohaline region of the James, and they are believed to be caused by the HAB bloom initiated in the Lafayette River, a tributary of the Elizabeth River [3] . After a HAB has occurred in the Elizabeth River, the bloom will occur in the James after 10 to 15 days. To verify the transport time for algal transport from the Elizabeth River to the James River, we computed the water age from the Elizabeth River to the James River. The tracer is released from the Elizabeth River; a water age at any location represents the time required for any dissolved materials to be transported from its source to the location. Figure 15 shows the age distribution. It can be seen that it takes about 10 to 15 days to reach the mesohaline region during spring and neap tides. The surface water moves upstream faster during spring tide than during neap tide. The bottom water moves 5-10 days faster upstream than surface water, which is due to the unique front and eddy system near the mouth of the James River [2] . A portion of the ebb flow will turn to the north and flood into the Hampton Flats, where a frontal system is well developed, and surface water will dive to the bottom through this frontal system and be transported upstream along the deep channel near the northern shore. Meanwhile, the flood tide will move surface water upstream [2] . The transport time for water to move from Elizabeth River to the mesohaline region of the James River agrees well with the time delay of the occurrence of the HAB in the James River after the HAB occurred in the Elizabeth River. In summary, a three-dimensional hydrodynamic model has been developed for the James River. The Environmental Fluid Dynamics Computer Code (EFDC) is used for developing the James River hydrodynamic model. The model was calibrated for surface elevation over the period from 2006 to 2008, for current over the period from 2007 to 2012 and for salinity and temperature from 1991 to 2000. Furthermore, it is validated from 2007 to 2013 for salinity and temperature. The model validation results indicate that the model is robust; it adequately simulates the hydrodynamics and temperature; and it is suitable for the water quality model development for the James River. In summary, a three-dimensional hydrodynamic model has been developed for the James River. The Environmental Fluid Dynamics Computer Code (EFDC) is used for developing the James River hydrodynamic model. The model was calibrated for surface elevation over the period from 2006 to 2008, for current over the period from 2007 to 2012 and for salinity and temperature from 1991 to 2000. Furthermore, it is validated from 2007 to 2013 for salinity and temperature. The model validation results indicate that the model is robust; it adequately simulates the hydrodynamics and temperature; and it is suitable for the water quality model development for the James River."}]
[{"section_title": "Abstract", "text": "Abstract. Manifold learning of medical images plays a potentially important role for modeling anatomical variability within a population with applications that include segmentation, registration, and prediction of clinical parameters. This paper describes a novel method for learning the manifold of 3D brain images that, unlike most existing manifold learning methods, does not require the manifold space to be locally linear, and does not require a predefined similarity measure or a prebuilt proximity graph. Our manifold learning method is based on deep learning, a machine learning approach that uses layered networks (called deep belief networks, or DBNs) and has received much attention recently in the computer vision field due to their success in object recognition tasks. DBNs have traditionally been too computationally expensive for application to 3D images due to the large number of trainable parameters. Our primary contributions are 1) a much more computationally efficient training method for DBNs that makes training on 3D medical images with a resolution of up to 128 \u00d7 128 \u00d7 128 practical, and 2) the demonstration that DBNs can learn a low-dimensional manifold of brain volumes that detects modes of variations that correlate to demographic and disease parameters."}, {"section_title": "Introduction", "text": "The need for manifold learning often arises when very high-dimensional data needs to be analyzed but the intrinsic dimensionality of the data is much lower.\nData used in preparation of this article were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (adni.loni.ucla.edu). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at: http://adni.loni.ucla.edu/wp-content/uploads/how to apply/ADNI Acknowledgement List.pdf This situations occurs, for example, when trying to visualize variability and common patterns in a given group of magnetic resonance images (MRIs) of the brain. Each image can be regarded as a point in a high-dimensional image space (called the ambient space), with n x \u00d7n y \u00d7n z coordinates, where n x , n y , n z are the dimensions of each image. On the other hand, each image could also be identified by a smaller set of parameters that describe shape variations and patterns that are common for a particular group of images. These parameters span a new space called the manifold space. The task of manifold learning is to discover the low-dimensional space and its parameters which can then be used to model the anatomical variability within a population. Various methods for manifold learning have been proposed (e.g., locally linear embedding (LLE) [1] , Laplacian eigenmaps (LEM) [2] , Isomaps [3] ), with Isomaps and LEM being the most popular for medical image analysis. Both methods require a prebuild proximity graph. In order to build the proximity graph, it is assumed that the manifold space is locally linear, which means that distances between neighboring points in manifold space can be approximated by their distances in ambient space. Gerber et. al. have shown that the choice of a suitable distance measure is crucial for manifold learning using Isomaps and that the warping distance between brain images improves the learning performance over previously used Euclidean distances in the image space [4] .\nManifolds have been used to regularize the segmentation of brain ventricles [5] , and to constrain the deformable registration of brain images to have biologically plausible parameters [6] . Gerber et al. used Isomaps to predict clinical parameters of Alzheimers's (AD) patients [4] , and Wolz et al. used Laplacian eigenmaps to perform biomarker discovery [7] , also of AD patients, and atlas propagation for the segmentation of the hippocampus [8] .\nIn this paper, we propose a novel approach for learning the manifold of brain images that uses a deep belief network (DBN) [9] to discover patterns of similarity in groups of images. In contrast to previous brain manifold learning algorithms, DBNs do not assume the manifold space to be locally linear and do not require a previously defined similarity measure or the construction of a proximity graph. Despite their popularity in computer vision (e.g., hand-written digit classification [9] , object recognition [10] ), the use of DBNs has so far been largely limited to small 2D images due to the extremely high computational cost of training a DBN. The much higher resolution of medical images has traditionally made training of DBNs too slow to be practical. A recent advance in efficiency was the introduction of convolutional DBNs (convDBNs) [10] , which has made training of 2D images with a resolution of up to 200 \u00d7 200 pixels feasible. Our primary contributions are 1) a much more computationally efficient training method for convDBNs that performs parameter learning in frequency domain in order to avoid the time consuming calculation of convolutions while minimizing the number of transformations to and from frequency space; when executed in parallel on graphical processors, training on images with a resolution of 128 \u00d7 128 \u00d7 128 voxels can be done quite practically with low-cost consumer hardware, and 2) the demonstration that DBNs can learn a low-dimensional manifold of brain volumes that detects modes of variation that correlate to demographic and disease parameters."}, {"section_title": "Methods", "text": "Our proposed method performs manifold learning by reducing the dimensionality of the input images using a DBN, a deep generative model that is composed of multiple restricted Boltzmann machines (RBMs) [9] as illustrated by the simplified example in Fig. 1 . An RBM is a Markov random field with trainable weights whose nodes are divided into a visible layer v representing the inputs of the model and a hidden layer h representing extracted features from the inputs. The first RBM receives the intensity values of a group of images as input and reduces the dimensionality of each image by discovering patterns of similarity that are common within groups of images. Subsequent RBMs receive the hidden unit activations of the previous RBM as input, thus learning successively more complex and abstract patterns from a training set. The number of trainable weights increases significantly with the resolution of the training images. In order to scale the model to high-resolution images, the first several layers of our DBN are convolutional RBMs (convRBMs), a type of RBM that uses weight sharing to reduce the number of trainable weights, albeit at the cost of using the much more computationally expensive convolutions instead of multiplications. In the remainder of this section, we will briefly review the training of convRBMs, followed by a description of our novel training algorithm that performs parameter learning in frequency domain. For comprehensive introductions to RBMs and convRBMs, the reader is referred to [9] and [10] , respectively.\nOur algorithm for the dimensionality reduction of an input image using a convRBM is illustrated in Fig. 2 . In contrast to previous work that uses max pooling to reduce the dimensionality [10] , all steps involved in our method are invertible, which allows the reconstruction of images from their manifold coordinates. In the first step, the pixels of an input image are reorganized into multiple images of lower resolution in order to reduce the dimensionality of a single image. The number of images in the image vector is then reduced with the following \nwhere\nNw\u00d7Nw\u00d7Nw are the weights, N w is the size of a weight kernel, and * denotes circular convolution. A binary hidden unit can only encode two states. In order to increase the expressive power of the hidden units, we use noisy rectified linear units as the hidden units, which has shown to improve the learning performance [11] of RBMs. The hidden units can be sampled with\nwhere\n2 ) denotes Gaussian noise, and sigm(x) is the sigmoid function defined as sigm(x) = (1 + exp(\u2212x)) \u22121 , x \u2208 R. The weights and bias terms of a convRBM can be learned using contrastive divergence (CD) [9] . During each iteration of the algorithm, the gradient of the parameters is estimated and a gradient step with a fixed learning rate is performed. The gradient of the weights can be approximated by:\nwhere h j and h j are samples drawn from p(h j | v) and p(h j | v ) using (2) and\nThe computational bottleneck of the training algorithm is the calculation of convolutions, which has to be performed 4 \u00d7 V \u00d7 H times per iteration, where V = |v| and H = |h|. To speed up the calculation of convolutions, we perform training in frequency domain, which maps the calculation of convolutions to simple element-wise multiplications. For example, this reduces the number of multiplications required to calculate the activation of one hidden unit with a weight kernel size of 7 from 343\u00d7V to only V multiplications. In order to avoid the timeconsuming calculation of Fourier transforms every time an image is convolved with a weight kernel, we map all operations needed for training to frequency domain wherever possible. Flipping of a convolutional kernelh(a) = h(\u2212a) can be expressed by element-wise calculation of the complex conjugate, which follows directly from the time-reversal property of the Fourier transform and the reality conditionf (\u2212\u03be) =f (\u03be). The only operations that can not be directly mapped to frequency domain are the calculation of the maximum function and the generation of Gaussian noise. To perform these operations, an image needs to be mapped to the spatial domain and back. However, these operations need only be calculated H times per iteration and are therefore not a significant contributor to the total runtime. Using the aforementioned mappings, equations (1) to (3) can be rewritten as\n\u22121 denotes the inverse Fourier transform, and \u00b7 denotes element-wise multiplication. Training in frequency domain requires solely the calculation of element-wise operations and reductions, which can be efficiently performed on graphics cards."}, {"section_title": "Experiments and Results", "text": "We have evaluated the proposed method on a subset of the ADNI dataset [12] , containing 300 T1-weighted MRIs of Alzheimer's disease (AD) and normal subjects. The images were provided skull-stripped and bias field corrected. We resampled all images to a resolution of 128 \u00d7 128 \u00d7 128 voxels and a voxel size of 2.0 mm \u00d7 2.0 mm \u00d7 2.0 mm. We then normalized their intensities to a common range, and rigidly registered them to a group-wise mean image prior to training and testing. We did not perform non-rigid registration for spatial normalization in order to evaluate the capabilities of the method without the added confound of complex registration parameters. The dataset was divided into a training set and a test set such that each set contains 75 AD and 75 normal subjects. To learn the manifold of brain MRIs, we used a DBN with three convRBM layers and two RBM layers. After three convRBMs, the dimension of each image is reduced to 8 \u00d7 8 \u00d7 8 and small enough for RBMs. The training of the DBN took approximately 43 hours on two GeForce GTX 560 Ti graphics cards.\nThe geometric fit of the learned manifold model was evaluated in terms of the generalizability to new images and the specificity to images from the training set. The generalizability was measured as the average root mean squared error (RMSE) between an image and its reconstruction, normalized by the intensity range of the input image. The specificity was measured by calculating the average RMSE between images randomly generated from the manifold model and the most similar images from the training set. Figure 3 (a) shows a comparison of the reconstruction errors between the training and test sets, and the specificity at different layers of the DBN. The similarity of the reconstruction errors between the training and test images indicates that no overfitting is occurring. The average reconstruction error at the last layer is below 6 %. Even though the very small reconstruction error is partially due to head MRIs having a large amount of homogeneous background, it demonstrates the ability of the learned manifold to capture most of the visual information with only two manifold parameters. The opposite slopes of the reconstruction errors and error of generated images indicates a trade-off between generalizability and specificity in the earlier phases of training. The low errors at the end of training (Layer 5) indicates that the method is able to be both specific and generalizable. Figure 3 (b) shows axial slices of 16 volumes sampled at the grid points of a 2D regular grid in manifold space. Volumes sampled along the first manifold dimension (from left to right) appear to increase in brain size, and the images sampled along the second manifold dimension (from bottom to top) appear to increase in ventricle size. Figure 4 shows an axial slice of each image of the training set plotted against its manifold coordinates. Consistent with images sampled from the manifold, an increase in ventricle size, which is indicative of brain atrophy (a hallmark of AD), visually correlates with an increase of the second manifold coordinate. The AD/normal status is indicated by the frame color of each image. The vertical separation between AD and normals suggests that the second manifold coordinate is potentially of practical use in differentiating between AD and normal. To evaluate the potential of the manifold coordinates to reveal or predict clinically relevant information, we have calculated the Pearson correlation r of demographic parameters (age, gender) and disease parameters (mini-mental state examination (MMSE) score, AD/normal status) with the manifold coordinates (x 1 and x 2 ). The results of the correlation tests are summarized in Table 1 . Age, MMSE and AD/normal status show highly significant correlations with x 2 (p-values between 9.85 \u00d7 10 \u22129 and 3.53 \u00d7 10 \u22127 ), which makes intuitive sense because x 2 visually correlates with ventricle size. The first manifold coordinate correlates strongest with gender (p-value = 8.24 \u00d7 10 \u22129 ), which also makes sense in terms of the general difference in size between male and female. The strength and significance of the correlations demonstrate the potential of deep learning of brain images for classification and prediction of disease status."}, {"section_title": "Conclusions", "text": "We have proposed a novel approach to learning the manifold of brain MRIs. In contrast to previous work, our approach does not require an explicitly defined similarity measure, or building a proximity graph. Furthermore, we have shown that the learned manifold coordinates capture shape variations of the brain that correlate with demographic and disease parameters. Our manifold learning method uses deep learning to discover patterns of similarity and variability within a group of images. Our proposed DBN training algorithm is much more efficient than traditional, convolution-based methods and, when parallelized on graphics processors, makes DBN training on 3D MRIs practical for the first time. For future work, we plan to incorporate clinical parameters into the training process to learn a model of the joint probability of images and associated clinical parameters. We would also like to investigate the effect of spatial normalization using affine or deformable registration, which we expect would result in further improvements in correlations with clinically relevant parameters. In addition, we would like to compare our method to other state-of-the-art brain manifold learning methods to investigate relative strengths and weaknesses for particular clinical applications such as the prediction of mild cognitive impairment to AD conversion, which is a topic of strong clinical interest."}]
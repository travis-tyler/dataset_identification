[{"section_title": "Abstract", "text": "We offer a blazingly brief review of evolution of shape analysis methods in medical imaging. As the representations and the statistical models grew more sophisticated, the problem of shape analysis has been gradually redefined to accept images rather than binary segmentations as a starting point. This transformation enabled shape analysis to take its rightful place in the arsenal of tools for extracting and understanding patterns in large clinical image sets. We speculate on the future developments in shape analysis and potential applications that would bring this mathematically rich area to bear on clinical practice."}, {"section_title": "Introduction", "text": "The study of anatomical shape changes and of their relationship with disease processes is one of the central topics in medical image analysis. For example, many neurodegenerative disorders cause widespread brain shape changes that can be observed in 3D brain MRI scans, as illustrated in Fig. 1 . Identifying statistical shape differences between healthy subjects and patients affected by a disease promises to provide new clinical insights and ultimately improve diagnosis and treatment. In this paper, we briefly review the evolution of representations and statistical modeling techniques used for anatomical shape analysis and highlight recent developments that take us closer to routine applications of shape analysis based on large collections of medical images."}, {"section_title": "Shape representation", "text": "Shape representations commonly used in medical image analysis include landmarks, implicit representations, parametric representations, medial models, and deformation-based descriptors. Many variants have been proposed in the field based on these fundamental descriptors.\nLandmarks are points on the object's boundary that can be identified reliably ( Cootes et al., 1995; Bookstein, 1997 ) . Landmarks are detected automatically or placed manually based on geometric properties of the surface, such as curvature, and image intensity. Since the quality of landmarks directly affects the statistical efficiency of the resulting shape model, substantial research effort has been focusing on selecting distinct and reproducible * Corresponding author. Fax: +1 617-258-6287.\nE-mail address: polina@csail.mit.edu (P. Golland).\nlandmarks, including automatic methods for achieving compact representations of the group variability ( Davies et al., 2001 ) . Landmark-based methods most often characterize the object boundary and ignore the structure of the object's interior.\nTo overcome the sensitivity of the descriptor to the placement of the landmarks, a distance transform is commonly used as an implicit representation of the object's boundary ( Leventon et al., 20 0 0 ) . While more robust to the noise in the boundary, such implicit descriptors give rise to a highly non-linear space, necessitating approximations when modeling shape distributions ( Golland et al., 2005 ) .\nParametric descriptors represent the object boundary in a particular functional basis and thus reduce the representation to a small number of discrete coefficients that capture the entire continuous boundary. Examples include the Fourier basis in 2D ( Staib and Duncan, 1992 ) and the spherical harmonics in 3D ( Brechb\u00fchler et al., 1995 ) . While offering computational efficiency and robustness to noise in landmark locations, this inherently global descriptor makes it challenging to localize shape changes.\nBased on the original work of Blum (1973) , the medial axis descriptor represents the shape as an envelope of spheres whose centers define the object's \"core\" and whose radii determine the object's thickness at each point of the core. The original medial axis representation is sensitive to the noise in the binary label map that defines the object, which is overcome by robust fitting methods applied to medial representations of constrained topology ( Pizer et al., 1999 ) .\nIn contrast to the earlier descriptors that focused on binary segmentations of a specific organ, deformation-based representations capture shape information in the entire image ( Christensen et al., 1993; Rueckert et al., 2003 ) . With the underlying assumption that the geometric information in the deformations conveys a shape, descriptors in this class arise naturally by matching a template to an input image with smoothness constraints on the deformation field. In many applications, it is natural to require the deformation to be a diffeomorphism, i.e., a differentiable, bijective mapping with a differentiable inverse. While biological motivation for using diffeomorphic deformations may exist in some applications, the biggest advantage of using diffeomorphisms is computational. Employing diffeomorphic transformations greatly facilitates the mapping between the atlas and subject coordinate systems. Moreover, the theoretical framework of Large Deformation Diffeomorphic Metric Mapping (LDDMM) defines a metric in the space of deformations that in turn induces a distance metric on the shape space ( Beg et al., 2005 ) .\nThe deformation-based approach to shape representation transformed shape analysis from requiring binary segmentations to operating on raw images. This change enabled many new applications of shape analysis for which no robust segmentation methods are available."}, {"section_title": "Statistical analysis", "text": "Principal component analysis (PCA) is widely used in combination with various shape representations to capture anatomical variability in a population ( Cootes et al., 1995; Staib and Duncan, 1992; Leventon et al., 20 0 0; Brechb\u00fchler et al., 1995 ) . Many descriptors give rise to non-linear spaces, which require statistical analysis to account for the non-linearities in the model. Examples of such non-linear modeling methods include kernel PCA , principal geodesic analysis (PGA) that estimates lower-dimensional geodesic subspaces by minimizing the sum-ofsquared geodesic distances ( Fletcher et al., 2003 ) , and clustering ( Sabuncu et al., 2009 ) . And while most sophisticated methods for modeling high-dimensional distributions that capture lowdimensional phenomena has been attempted in the context of shape analysis, PCA and its manifold variants remain a workhorse of this field."}, {"section_title": "Deformation-based representations meet statistics on manifolds", "text": "In this section, we illustrate the ideas reviewed above in the context of a contemporary formulation based on a Bayesian variant of PGA. This particular approach encodes shape in the space of deformations parameterized through the so called geodesic shooting construction ( Miller et al., 2006 ) . The model employs an automatic relevance determination prior to encourage a compact representation. Detailed derivations of the statistical model and of the resulting inference algorithm can be found in ( Zhang and Fletcher, 2015 ) . "}, {"section_title": "Diffeomorphisms for shape representation", "text": "We define diffeomorphic transformations on a d -dimensional torus\nThe tangent space of diffeomorphisms at identity is the space V of smooth vector fields on . For any two vector fields v, w \u2208 V , there exists a weak Sobolev metric such that\nwhere L is a symmetric, positive-definite, differential operator that induces a metric on the shape space. Diffeomorphisms are generated by flows of time-varying velocity fields as a solution to an ordinary differential equation\nwhere v and \u03c6 are the time-varying velocity field and the resulting diffeomorphic transformation, respectively.\nGiven an initial velocity field at time t = 0 , the geodesic path on the manifold of diffeomorphisms is uniquely determined by the Euler-Poincar\u00e9 equations (EPDiff) ( Arnol'd, 1966; Miller et al., 2006 ) :\nwhere D is the Jacobian and div is the divergence operator. This process is known as geodesic shooting ( Miller et al., 2006 ) . This construction provides a representation of diffeomorphisms via initial velocities. With a slight abuse of notation, in the remainder of the paper we use v to denote the initial velocity field and \u03c6 to denote the corresponding final deformation. Fig. 2 illustrates the graphical model for Bayesian principal geodesic analysis (BPGA), first presented in Zhang and Fletcher (2015) . Given a set of N deformation fields { \u03c6 n }, we treat the input images { J n } as iid samples from a Gaussian distribution induced by the model of the image noise ( n = 1 , \u00b7 \u00b7 \u00b7 , N). In particular, input image J n is generated by applying deformation \u03c6 n to the image template I :"}, {"section_title": "Image likelihood", "text": "where \u03c3 2 is the image noise variance. The norm inside the exponent is the L 2 ( , R ) norm defined on a finite discretized grid. More sophisticated models of image noise can be readily converted into a likelihood model for the observed images."}, {"section_title": "Generative model of shape", "text": "We let the columns of matrix W \u2208 R d\u00d7K represent the K principal modes of variation in the d -dimensional space of the initial velocity fields. We let x n \u2208 R K denote a vector of K latent loading weights such that the initial velocity field v n = W x n generates diffeomorphism \u03c6 n in Eq. (4) . Similar to the Bayesian variant of PCA ( Bishop, 1999 ) , we impose a Gaussian prior on the loading factors:\nIn contrast to Bayesian PCA, this distribution includes principal components W to ensure the smoothness of the resulting geodesic shooting path. The prior distribution on W encourages sparsity by suppressing small principal initial velocity values towards zero, thus providing dimensionality reduction through automatic relevance determination ( Bishop, 1999 ) :\nwhere W k is the k th principal component of the model and \u03b3 k is the precision of the principal component W k ."}, {"section_title": "Learning and inference", "text": "The maximum likelihood estimates of the image template I , the noise variance \u03c3 2 , and the precision hyperparameters { \u03b3 k } are obtained through an iterative algorithm that is derived by observing that maximizing the likelihood of the input images is equivalent to minimizing the cost function that leads to geodesic shooting ( Miller et al., 2006 ) . The optimization procedure produces estimates of the hyperparameters { \u03b3 k } that often tend to infinity. Since high precision is equivalent to concentration around zero, this process yields sparse solutions. Other choices of sparsity, such as Laplacian priors, can also be used to implement dimensionality reduction. Once the algorithm converges, the maximum a posteriori estimates of the latent loading weights x n provide a compact representation of the anatomical shape in image J n and can be used for further analysis in clinical studies. Fig. 3 illustrates the application of this approach in a study of brain shape variability based on a set of 3D MRI scans of healthy subjects in ADNI. We display regions of expansion (in red) and contraction (in blue) captured in the first principal component, as well as the anatomical variability represented by this component. We observe that ventricle size change is a dominant factor in brain shape variability in this cohort."}, {"section_title": "Conclusions and discussion", "text": "In this paper, we briefly reviewed the evolution of statistical shape representations, from landmarks to diffeomorphisms, and of the statistical methods that have been employed to capture the variability in the resulting shape descriptors. We illustrated a contemporary approach to shape analysis by demonstrating one possible combination of diffeomorphism-based shape representation coupled with the Bayesian principal geodesic analysis to extract principal modes of variation in the brain anatomy of healthy aging population.\nIn addition to ever increasing sophistication in the mathematical methods for capturing shape and its variation, the field underwent an exciting development of realizing shape analysis on raw images rather than requiring accurate segmentation as a prerequisite step. While this transformation alleviated the challenges of obtaining high quality segmentations, it came at a cost of computational complexity. Since deformation-based shape descriptors exist in a high dimensional space defined by the image grid, manipulating these descriptors requires substantial computational resources and specialized programming techniques. We expect the future turns of the spiral in shape analysis evolution to produce efficient deformation representations that still capture all the intricate and clinically relevant anatomical detail. As an additional benefit, such representations will also bring us closer to efficient implementations of image alignment and practical applications of shape analysis in large scale studies of anatomical change in development, aging and disease.\nWe conclude by observing that shape analysis has not yet made its way into the standard medical practice or clinical research. While technical challenges of characterizing complex anatomical shape have been successfully addressed by the evolution of methods in medical image computing, the challenge of translation remains for the current and future researchers in this area. Only when clinical researchers and practitioners rely on shape analysis tools in the everyday decision making, can we confidently state that the research reviewed in this paper has lived up to its true potential. grants and by Wistron Corporation. The images in this work were provided by the Alzheimer's Disease Neuroimaging Initiative."}]
[{"section_title": "Abstract", "text": "Functional phenotypes (e.g., subcortical surface representation), which commonly arise in imaging genetic studies, have been used to detect putative genes for complexly inherited neuropsychiatric and neurodegenerative disorders. However, existing statistical methods largely ignore the functional features (e.g., functional smoothness and correlation). The aim of this paper is to develop a functional genome-wide association analysis (FGWAS) framework to efficiently carry out whole-genome analyses of functional phenotypes. FGWAS consists of three components: a multivariate varying coefficient model, a global sure independence screening procedure, and a test procedure. Compared with the standard multivariate regression model, the multivariate varying coefficient model explicitly models the functional features of functional phenotypes through the integration of smooth coefficient functions and functional principal component analysis. Statistically, compared with existing methods for genomewide association studies (GWAS), FGWAS can substantially boost the detection power for discovering important genetic variants influencing brain structure and function. Simulation studies show that FGWAS outperforms existing GWAS methods for searching sparse signals in an extremely large search space, while controlling for the family-wise error rate. We have successfully applied FGWAS to large-scale analysis of data from the Alzheimer's Disease Neuroimaging Initiative for 708 subjects, 30,000 vertices on the left and right hippocampal surfaces, and 501,584 SNPs."}, {"section_title": "Introduction", "text": "Functional responses that frequently arise in neuroimaging studies have been widely used to characterize brain structure and function (Miller and Qiu, 2009; Smith et al., 2006; Styner et al., 2005; Fischl, 2012; Goodlett et al., 2009; Yushkevich et al., 2008) . For instance, in diffusion tensor imaging, various diffusion properties (e.g., fractional anisotropy) have been extracted along major fiber bundles to reveal white matter tract maturation and integrity (Smith et al., 2006; Goodlett et al., 2009; Yushkevich et al., 2008) . Shape analysis has been widely used to characterize features of brain cortical and subcortical structures, including cortical complexity, curvature, spectral content, and other indices (Miller and Qiu, 2009; Styner et al., 2005; Fischl, 2012) . Thus, they have been widely used to better understand normal brain development and the neurological bases of neuropsychiatric and neurodegenerative diseases. Therefore, these functional responses may be effective phenotypes that facilitate the identification of causal genes and the mechanistic understanding of pathophysiological processes of neurological disorders (Zhao and Castellanos, 2016) . Our primary research interest is to identify novel genetic effects on the local changes of various functional responses.\nStatistically, we are interested in developing a fast and efficient statistical method to correlate functional phenotypes measured at tens of thousands of grid points (N V $ 10 3 \u00c0 10 6 ) with tens of millions of known genetic variants (N G $ 10 7 ), or so-called big data squared. Conventional analysis of such imaging-genetic data is based on methods for voxel-wise genome-wide association analysis studies (VGWAS). Such VGWAS methods primarily consist of three major steps: Gaussian smoothing of the functional responses across subjects, a total of N G N V ($ 10 10 \u00c0 10 12 ) massive univariate analyses, and correction for multiple comparisons in an expanded image\u00c2gene search space with N G N V elements (Hibar et al., 2011; Shen et al., 2010; Huang et al., 2015; Medland et al., 2014; Zhang et al., 2014; Thompson et al., 2014; Liu and Calhoun, 2014) . These methods are not only computationally extensive, but also involve major methodological limitations when searching for novel genetic markers associated with the local changes of functional phenotypes. Specifically, running VGWAS can pose significant computational challenges, including limited computer memory, finite CPU speed, and limited CPU nodes. For instance, for VGWAS, it is computationally intensive to compute all N V N G ($ 10 10 \u00c0 10 13 ) test statistics for all M ($ 10 3 \u00c0 10 4 ) bootstrapping replicates and to store and manage all N G N V M ($ 10 13 \u00c0 10 17 ) test statistic images in a limited computer hard drive. Moreover, due to massive model fitting, the statistical power is usually very low after adjusting for multiple comparisons, while the spatial correlation and smoothness features in functional phenotypes are not considered, leading to difficult interpretation of the results.\nWe propose two important strategies to address several fundamental bottlenecks of constructing brain-genetic association maps for functional responses in large-scale imaging genetic studies. First, instead of repeatedly fitting a univariate model to each voxel and each genetic marker, we treat all image measures as a single functional response measured at all N V grid points and focus on testing the coefficient function of interest, which is intrinsically low rank. We develop some functional data analysis (FDA) methods to explicitly account for the three key features of the functional phenotypes: spatial smoothness, spatial correlation, and the low-dimensional representation of functional data. The key advantage of using FDA is to reduce the dimension of the functional responses from N V to an intrinsically low dimension, denoted as N V0 , which is much smaller than N V . Second, we develop a new global sure independence screening (GSIS) procedure to eliminate most of the \"noisy\" genetic variants and a divide-and-conquer algorithm to efficiently perform multiple comparisons. The divide-and-conquer algorithm is critically important for performing FGWAS when N G is extremely large, such as for whole-genome sequencing.\nThe aim of this paper is to develop a FGWAS pipeline with several formal FDA tools as a novel extension of VGWAS for functional responses. A schematic overview of FGWAS is given in Fig. 1 . Although FDA methods have been widely studied in the literature, most focus on onedimensional curves. See Ramsay and Silverman (2005) ; Wang et al. (2016) ; Morris (2015) and references therein for a comprehensive review of FDA. Although there are a few methods for the association mapping of longitudinal phenotypes (Nicolae, 2016; Wu and Lin, 2006; Reimherr and Nicolae, 2014) , little has been done on the association mapping of functional phenotypes of two or higher dimensions. Compared with existing methods in the literature, five major methodological contributions of this paper are as follows.\nWe use a multivariate varying coefficient model (MVCM) as a special function-on-scalar regression model to fit the functional phenotypes with a large number of genetic variants (Zhu et al., 2011; Di et al., 2009; Zipunnikov et al., 2011; Zhu et al., 2014; Guo, 2002; Lin et al., 2014) , while explicitly accounting for their three key functional features as discussed above. The use of the MVCM can project N V imaging measures into the N V0 \u00c0dimensional space, leading to computational and efficiency gains on the order of O\u00f0N V =N V0 \u00de. Under MVCM, we use a local Wald-type test statistic to detect novel genetic variants that influence brain structure and function. Moreover, such a test statistic outperforms the test statistics used in other C. Huang et al. NeuroImage 159 (2017) 107-121 association mapping methods in terms of statistical power (Nicolae, 2016; Wu and Lin, 2006; Reimherr and Nicolae, 2014; Huang et al., 2015) . We introduce a GSIS procedure based on global test statistics to test the hypotheses of interest associated with functional phenotypes. The GSIS not only selects N G0 \"important\" genetic variants, but also offers the sure independence screening property (Fan and Lv, 2008 ) with a vanishing false selection rate. The use of GSIS can reduce the size of genetic variants from N G to N G0 , leading to a computational gain on the order of O\u00f0N G =N G0 \u00de.\nWe develop a divide-and-conquer algorithm coupled with parallel computing to efficiently perform multiple comparisons in order to detect subregion-locus pairs, while controlling for their family-wise error (FWE) rate. Compared with VGWAS, FGWAS achieves an extensive computational gain in terms of both memory and speed. The package for FGWAS, along with its documentation, are freely accessible from the website \"http://odin.mdacc.tmc.edu/bigs2/\" and \"https://github.com/BIG-S2\". To make it user-friendly, we developed a graphical user interface to package the code, which is also freely downloadable from the same website. Our FGWAS package can handle three types of functional phenotypes: curves, surfaces, and volumes in \u211d 3 . To facilitate its application to real data, we use three computing languages, Rcpp, Matlab, and Python, to develop the corresponding versions."}, {"section_title": "Method", "text": "Suppose that we observe functional responses, clinical covariates and genetic markers for n unrelated subjects. Without loss of generality, we focus on a compact set, denoted as D \u2282\u211d 3 , (e.g., cortical and subcortical regions), which is general enough to cover curves, surfaces, and volumes in \u211d 3 . Let d be a grid point in D . It is assumed that there are N V common grid points d 1 ; \u2026; d NV across all subjects. Let g be a locus in the set of N G genetic markers, denoted as G \u00bc fg 1 ; \u2026; g NG g. Specifically, for the i-th subject, we observe a J \u00c2 1 vector of imaging measurements at d, denoted as y i \u00f0d\u00de \u00bc \u00f0y i1 \u00f0d\u00de; \u2026; y iJ \u00f0d\u00de\u00de T , a p c \u00c2 1 vector of covariates (e.g., age and gender), denoted as x i with its first component being 1, and a p g \u00c2 1 vector associated with the genetic marker at the locus g and/or x i , denoted as z i \u00f0g\u00de \u00bc \u00f0z i;1 \u00f0g\u00de; \u2026; z i;pg \u00f0g\u00de\u00de T ."}, {"section_title": "FGWAS", "text": "We developed the FGWAS pipeline to efficiently carry out the association mapping of functional phenotypes. A schematic overview of FGWAS is given in Fig. 1 . Our FGWAS consists of three major components:\n(I) a multivariate varying coefficient model (MVCM); (II) a global sure independence screening procedure; (III) a test procedure based on the global and local test statistics.\nWe elaborate on these components below."}, {"section_title": "FGWAS (I): multivariate varying coefficient model", "text": "For the genetic marker at locus g, the MVCM is defined as y ij \u00f0d\u00de \u00bc x (Zhu et al., 2011 Zipunnikov et al., 2011; Guo, 2002 (Zhang and Chen, 2007) . To estimate all unknown parameters in model (1), we employ a weighted least squares (WLS) method based on the multivariate local polynomial kernel smoothing technique (Fan and Gijbels, 1996; Zhang and Chen, 2007 \nFinally, we can estimate P (Zhang and Chen, 2007; Zhu et al., 2012) . We standardize all covariates to have mean zero and standard deviation one; thus, we may choose a common bandwidth for all covariates. Moreover, following the arguments of Fan and Zhang (1999) , a small bandwidth leads to a small value of Bias\u00f0 b \u03b2 \u00f0g\u00de \u00f0d\u00de\u00de, which can be dropped from the test statistics hereafter. Four big-data challenges stem from the calculations of T n \u00f0g; d\u00de. The key idea of (S1) is to calculate b \u03a3 \u00f0g\u00de \u03b7 \u00f0d; d\u00de under the null hypothesis in (4), since it is expected that the null hypothesis H 0 holds for most loci.\nSimilar to the estimation procedure in (7), the estimate of\nwhere (8) is only related to the non-genetic covariates, the optimal bandwidth matrix H \u03b7 is calculated once at most for all loci. Thus, the total complexity of computing all f b \u03a3 \u03b7 \u00f0d\u00deg is at least min\u00f0N V ; N G \u00de times faster than calculating f b \u03a3 \u00f0g\u00de \u03b7 \u00f0d; d\u00deg. The key idea of (S2) Consequently, the optimal bandwidth in each group is determined as the average of all the k H bandwidths. Moreover, the number of MAF groups can be larger than 6. We elaborate on (S3) and (S4) in the next subsection."}, {"section_title": "FGWAS (II): A global sure independence screening procedure", "text": "The key idea of the GSIS procedure in (S3) is to detect potentially causal genetic markers by using a dimension reduction method and an approximation method (Huang et al., 2015) . Specifically, since only a small number of causal genetic markers are expected to contribute to the imaging phenotypic measures, we consider a global Wald-type statistic to eliminate many loci with weak or even no genetic effects. Let w\u00f0d\u00de be a prior distribution of d in D . The global Wald-type statistic at locus g, denoted as T\u00f0g\u00de, is an integral of T n \u00f0g; d\u00dew\u00f0d\u00de with respect to d 2 D ; that is, T\u00f0g\u00de \u00bc \u222b d2D T n \u00f0g; d\u00dew\u00f0d\u00dedL\u00f0d\u00de, where L\u00f0d\u00de is the Lebesgue measure.\nSelecting different w\u00f0d\u00de allows us to introduce the prior information of specific regions of interest (ROIs). If there is no such prior information, then a uniform prior can be used. In this case, except for a constant scalar, T\u00f0g\u00de can be approximated by\nwhere Y w \u00f0d\u00de \u00bc P NV m\u00bc1 a m \u00f0H \u03b2 ; d\u00de\u00bdy 1;\u22c5 \u00f0d m \u00de; \u2026; y n;\u22c5 \u00f0d m \u00de T , and Q zjx \u00f0g\u00de \u00bc Z T X \u00f0g\u00deZ X \u00f0g\u00de. At a specific locus g, if the area of the true genetic effect region, denoted by D \u00c3 \u00f0g\u00de, is relatively large and its corresponding measurements are moderate, then the value of T n \u00f0g\u00de should be relatively large. Thus, if the value of T n \u00f0g\u00de is large, then the locus g is more likely to be a causal locus. Our GSIS procedure consists of the following steps:\nStep (II.1). Calculate X T X and P X with the computational complexity of O\u00f0np 2 c \u00de.\nStep (II.3). For the locus g, calculate T n \u00f0g\u00de with the computational complexity of O\u00f0\u00f0p c \u00fe p g \u00de 2 n 2 \u00de."}, {"section_title": "Step (II.4). Repeat", "text": "Step (II.3) for all loci and calculate the p\u00c0value of T n \u00f0g\u00de using an approximation method (Zhang and Chen, 2007; Zhu et al., 2012; Huang et al., 2015) . Specifically, T n \u00f0g\u00de can be approximated by a \u03c7 2 \u00c0type random variable \u03b1 1 \u03c7 2 \u00f0\u03b1 2 \u00de \u00fe \u03b1 3 , where \u03b1 1 , \u03b1 2 , and \u03b1 3 are respectively given by \nwhere \u03ba k \u00f0T\u00de; k \u00bc 1; 2; 3; are respectively the first three sample cumulants of T n \u00f0g\u00de. Finally, the p\u00c0value of T n \u00f0g\u00de can be approximated by using P\u00f0\u03c7 2 \u00f0\u03b1 2 \u00de ! \u00bdT n \u00f0g\u00de \u00c0 \u03b1 3 =\u03b1 1 \u00de.\nStep (II.5). Sort the \u00c0log 10 \u00f0p\u00de\u00c0values of all T n \u00f0g\u00des and select the top N 0 loci (e.g.,\n. From here on, we call G \u00c3 0 a candidate significant locus set. Usually, we choose a relatively large N 0 so as to guarantee that all true positive loci are contained in G \u00c3 0 with high probability.\nThe computational complexity of GSIS is primarily associated with the number of loci, N G . If N G is of a super large scale (e.g., O\u00f010\n8 \u00de), the GSIS procedure can be very time consuming or even fail on a single computer core with limited computer memory. To address this issue, we propose a divide-and-conquer algorithm along with a parallel computing strategy, since the calculation of T n \u00f0g\u00de can be done independently. First, we divide the whole genetic data set into K G groups (e.g., each chromosome as a group). Then, we perform Steps (II.1)-(II.3) independently for each group of genetic markers. Finally, we combine the T n \u00f0g\u00de's across all groups and approximate their corresponding p\u00c0values based on the method used in Step (II.4). Subsequently, we determine the candidate significant locus set G \u00c3 0 . More details on the parallel computing strategy are provided in the next subsection."}, {"section_title": "FGWAS (III): A test procedure", "text": "The objectives of the test procedure are (O.1) to detect the genetic markers that are significantly associated with the functional phenotype as a whole; and (O.2) to detect the subregion(s) (or compact set(s)) of the functional phenotype that are significantly associated with some genetic marker(s).\nNote that it is important to detect significant voxel-locus pairs for VGWAS, but such detection is less meaningful for the functional responses, which are intrinsically smooth functions. Moreover, the existing GWAS methods for imaging phenotypes focus on (O.1), whereas we are particularly interested in (O.2).\nTo achieve (O.1), we calculate a maximum statistic of all T n \u00f0g\u00de's across all loci as follows:\nThe maximum statistic T n;G plays a crucial role in controlling the FWE rate.\nTo achieve (O.2), we resort to cluster size inference, which plays an important role in assessing the significance of each subregion that consists of interconnected grid points for which the p-values are greater than a given threshold, say \u03b1 I \u00bc 0:005 or 0.001 (Smith and Nichols, 2009; Ge et al., 2012) . For functional phenotypes, we prefer to replace the cluster by the subregion from here on. For the locus g, let p\u00f0g; d\u00de be the p\u00c0value of T n \u00f0g; d\u00de at the grid point d and let A\u00f0g; \u03b1 I \u00de be the largest subregion at a given threshold \u03b1 I based on the map of fp\u00f0g; d\u00de : d 2 D g. To detect significant subregion-locus pairs, we consider a maximum subregion statistic, i.e.,\nwhich, in practice, can be approximated by a local maximum subregion statistic A\u00f0G \u00c3 0 ; \u03b1 I \u00de in terms of both size and distribution (Huang et al., 2015) .\nWe use the wild bootstrap method to approximate the null distribution of T n;G and that of A\u00f0G \u00c3 0 ; \u03b1 I \u00de under the assumption that the null hypothesis H 0 in (4) holds for all \u00f0g; d\u00de 2 G \u00c2 D . We propose an efficient wild bootstrap procedure to simultaneously detect significant loci and subregion-locus pairs as follows:\nStep (III.1). Calculate T n \u00f0g \u00c3 ; d\u00de for each pair\nStep (III.2). Calculate the uncorrected p\u00c0values of T n \u00f0g \u00c3 ; d\u00de across all\nStep (III.4). Apply the wild bootstrap method to the set G suggest directly comparing T \u00f0b\u00de n \u00f0g; d\u00de with the 100\u00f01 \u00c0 \u03b1 I \u00deth percentile of the F distribution in order to determine significant subregions at each locus g.\nStep (III.5). Calculate the FWE corrected p\u00c0values of T n \u00f0g\u00de based on the empirical distribution of fT \u00f0b\u00de n;G g b\u00bc1;\u2026;B . Since N G is much larger than the sample size, choose a significance level, say \u03b1 \u00bc 0:5.\nStep (III.6). For each locus g 2 G Similar to the GSIS procedure, the computational issue still exists in the test procedure for large N G . We also use the divide-and-conquer algorithm here. Specifically, after generating bootstrap samples in Steps (III.4.1)-(III.4.2), we divide the whole genetic data set into K G disjoint groups such that G \u00bc \u222a \nA G under H 0 . Consequently, the corresponding corrected p\u00c0values are derived in Steps (III.5)-(III.6). In addition, this parallel computing strategy can be conducted on the bootstrap sampling level, which means calculations on different bootstrap samples in Step (III.4) can be carried out at the same time on different cores.\nThe divide-and-conquer algorithm coupled with parallel computing can achieve computational gain in terms of both memory and speed, while having the same statistical power as the standard method for significant locus detection. Specifically, in GSIS, since the computation of global test statistic across all loci is independent of each other, the divideand-conquer algorithm in Steps (II.1)-(II.3) does not change the test statistics. The same comment is also valid for T \u00f0b\u00de n;G and A\u00f0G \u00c3\u00f0b\u00de 0 ; \u03b1 I \u00de in the test procedure."}, {"section_title": "Simulation studies", "text": "In this section, we use Monte Carlo simulations to evaluate the finitesample performance of FGWAS. The hypothesis testing problem we focus on is to test the null hypothesis of no association for all the functional phenotypes at each locus. All computations for these numerical examples were done in Matlab on a Dell C6100 server. The computation for FGWAS is efficient even for large-scale imaging genetic data, as shown in the real data analysis.\nWe simulated imaging surface data at N V \u00bc 15; 000 vertices on the right hippocampus obtained from the publicly accessible ADNI data. More information on the ADNI data used in the current study is given in the next section. We only considered the additive genetic effect of SNPs on the right hippocampal surface data. The y i;j \u00f0d\u00des were generated from model \nfor i \u00bc 1; \u2026; n and j \u00bc 1; 2; where \u03b5 i \u00f0d\u00de $ N\u00f00; \u03a9 \u00bc diag\u00f0\u03c3 2 1 ; \u03c3 2 2 \u00de\u00de, z i \u00f0g\u00de were simulated genetic data as described below, and x i \u00bc \u00f01; x i1 ; \u2026; x i8 \u00de T were generated from U\u00f00; 1\u00de for continuous variables or from the Bernoulli distribution with a success probability of 0.5 for discrete variables.\nThe true values of \u03b2 \u00f0c\u00de j \u00f0d\u00de and \u03b7 i;j \u00f0d\u00de were set to the estimates b \u03b2 \u00f0c\u00de j \u00f0d\u00de and b \u03b7 i;j \u00f0d\u00de by fitting model (1) without genetic covariates to the real ADNI data set introduced in the next section. The elements in \u03b2 \u00f0g\u00de j \u00f0d\u00de for j \u00bc 1 and 2 corresponding to the pre-specified pairs of causal SNPs and affected ROIs were set to affect magnitude f\u03b2 \u00c3 j ; j \u00bc 1; 2g and zero otherwise. In addition, the affected ROI associated with the causal SNPs was pre-fixed as a circular region with radius r (Fig. 2) .\nWe simulated genetic data z i \u00f0g\u00de as follows. We used linkage disequilibrium (LD) blocks defined by the default method (Gabriel, 2002) of Haploview (Barrett et al., 2005) and PLINK (Purcell et al., 2007) to form SNP sets. To calculate the LD blocks, n subjects were simulated by randomly combining haplotypes of HapMap CEU subjects. We used PLINK to determine the LD blocks based on these subjects. We randomly selected 2000 blocks, and combined haplotypes of HapMap CEU subjects in each block to form genotype variables for these subjects. We randomly selected 10 SNPs in each block; thus, we had N G \u00bc 20; 000 SNPs for each subject. Moreover, we chose the first q SNPs as the causal SNPs. We set the sample size (n) and the number of causal SNPs (q) to be 1; 000 and 100, respectively. Finally, we used 100 Monte Carlo realizations.\nFirst, we evaluated the finite sample performance of the proposed GSIS for different settings of \u00f0N 0 ; \u03b2 \u00c3 1 ; \u03b2 \u00c3 2 ; \u03a9\u00de. Specifically, we set \u03b2\nin which a was chosen from the set f0:5; 1; 1:5; 2g, and N 0 between 100 and 2000. Moreover, we set the radius of the ROI as r \u00bc 6. We considered two different settings of \u03a9, including (i) \u03a9 \u00bc diag\u00f0\u03c3 1 \u00bc \u03c3 2 \u00bc 0:5\u00de; and (ii) \u03a9 \u00bc diag\u00f0\u03c3 1 \u00bc 0:8; \u03c3 2 \u00bc 1\u00de. We defined the causal SNP rate as the ratio of the number of causal SNPs in G \u00c3 0 over the total number of causal SNPs. Table 1 includes the causal SNP rates under different settings. As expected, the causal SNP rate increases as N 0 and a increase. However, the causal SNP rate is low for small N 0 , especially when \u03c3 1 and \u03c3 2 are quite large. When N 0 is set to be larger than 900, almost all causal SNPs are included in the set G Table 1 for more details. Second, we evaluated the finite sample performance of FGWAS when model is misspecified. Assume that the y i;j \u00f0d\u00des were generated from the model given by \nfor i \u00bc 1; \u2026; n and j \u00bc 1; 2: It can be seen that, the first 100 \u00fe q I SNPs are treated as causal SNPs here. The key difference between (17) and (16) is that there exists an extra interaction term (non-genetic effect \u00c2 genetic effect) in (17). Here x i , \u03b2 \u00f0c\u00de j \u00f0d\u00de, \u03b7 i;j \u00f0d\u00de, and the genetic data z i \u00f0g\u00de were set in the same way as those in (16). The elements of genetic effect coeffi-\nk\u00bc1 in the interaction term are observations from q I casual SNPs. The interaction effect is assumed to be homogeneous with non-zero magnitude across the whole ROI and zero otherwise. Specifically, we set \u03b2 I \u00bc a I \u03b2 \u00c3 ; in which a I was chosen from the set f0:1; 0:2; 0:5g, q I was chosen from the set f10; 20; 50g, and N 0 between 100 and 2000. Moreover, we set the radius of ROI as r \u00bc 6. The causal SNP rates under different settings were presented in Table 2 . According to the results, it can be found that, when the model is misspecified, FGWAS can still achieve a high causal SNP rate when N 0 is large. Nevertheless, the causal SNP rate increases when either the interaction effect or the number of non-causal SNPs included in the interaction term becomes larger. Third, we evaluated the finite sample performance of FGWAS in detecting the causal SNP and subregion pairs. We set n \u00bc 1; 000, q \u00bc 100, \u03a9 \u00bc 0:5I 2 , \u00f0\u03b2 \u00c3 1 ; \u03b2 \u00c3 2 \u00de \u00bc \u00f00:01; 0:01\u00de, and r \u00bc 6. Moreover, we used an uncorrected \u03b1 I \u00bc 0:005 p-value threshold to identify subregions consisting of contiguous supra-threshold vertices. If the vertices in a thresholded cluster overlapped with some vertices in the affected ROI at a causal SNP, then we call these vertices \"true positive vertices\". If a thresholded subregion did not overlap with any vertices of the affected ROI at any causal SNP, we call such a subregion a \"false positive\" subregion. We summarized the results by using the Dice overlap ratio (DOR), the number of false positive subregions, and the size in the number of vertices in false positive subregions. DOR is the ratio between the number of true positive pixels over the size of the affected ROI (Huang et al., 2015) . Thus, a higher DOR means a higher probability of detecting the affected ROI. As shown in Fig. 3 , no false positive subregion is detected. These results further demonstrate that the GSIS procedure can effectively detect and localize relatively strong genetic effects. Moreover, the average DOR of N 0 \u00bc 500 is higher than that of N 0 \u00bc 100.\nFourth, we compared the proposed FGWAS method with other two methods, i.e., the standard functional GWAS (Reimherr and Nicolae, 2014) and the FVGWAS package (Huang et al., 2015) . In order to make a fair comparison, we applied all three methods to the same simulated data sets. Since both standard functional GWAS and FVGWAS are feasible only for univariate imaging phenotypic measurements, we simplified model (16) by considering only one imaging measurement, i.e., \nThree factors are considered in the comparisons: (i) the genetic effect \u03b2 \u00c3 \u00f0d\u00de in the affected region, (ii) the number of candidate significant loci N 0 , and (iii) the radius r of the affected ROI. In order to illustrate how each factor affects the finite sample performance of the three methods, we fixed two factors and chose different values for one factor in each setting. Fig. 4 presents the receiver operating characteristic (ROC) curves for all three methods, corresponding to three different cases. In case 1, the genetic effect is set to \u03b2 \u00c3 \u00bc 0:005 and \u03b2 \u00c3 \u00bc 0:01, whereas other parameters \u03a9, n, N 0 , and r are set to 0.5, 1,000, 1,000, and 6, respectively. In case 2, the number of candidate loci is set to N 0 \u00bc 500 and N 0 \u00bc 1; 000, whereas other parameters \u03a9, n, \u03b2 \u00c3 , and r are set to 0.5, 1,000, 0.01, and 6, respectively. In case 3, the radius of the affected ROI is set to r \u00bc 3 and r \u00bc 9, whereas other parameters \u03a9, n, N 0 , and \u03b2 \u00c3 are set to 0.5, 1,000, 1,000, and 0.01, respectively. It can be found that, for each case, as the factor increases, the areas under the ROC curves for all the methods increase as well. Moreover, FGWAS outperforms both the standard functional GWAS and FVGWAS in all three cases, indicating that compared with standard functional GWAS and FVGWAS, FGWAS dramatically boosts the power for detecting various settings of genetic effects and affected ROIs."}, {"section_title": "ADNI hippocampal surface data analysis", "text": ""}, {"section_title": "ADNI data description", "text": "Data used in the preparation of this article were obtained from the ADNI database (adni.loni.usc.edu). The ADNI was launched in 2003 by the National Institute on Aging, National Institute of Biomedical Imaging and Bioengineering, Food and Drug Administration, private pharmaceutical companies and non-profit organizations as a $60 million, 5-year public-private partnership. The primary goal of ADNI has been to test whether serial magnetic resonance imaging (MRI), positron emission tomography, other biological markers, and clinical and neuropsychological assessment can be combined to measure the progression of mild cognitive impairment (MCI) and early Alzheimer's disease (AD). Determination of sensitive and specific markers of very early AD progression is intended to aid researchers and clinicians in developing new treatments and monitoring their effectiveness, as well as lessening the time and cost of clinical trials. The principal investigator of this initiative is Michael W. Weiner, MD, at the VA Medical Center and University of California, San Francisco. ADNI is the result of efforts of many coinvestigators from a broad range of academic institutions and private corporations, and subjects have been recruited from over 50 sites across the U.S. and Canada. The goal was to recruit 800 subjects, but the initial study (ADNI-1) has been followed by ADNI-GO and ADNI-2. To date, these three protocols have recruited over 1500 adults, ages 55 to 90, to participate in the research, consisting of cognitively normal older individuals, people with early or late MCI, and people with early AD. The follow-up duration of each group is specified in the protocols for ADNI-1, ADNI-2 and ADNI-GO. Subjects originally recruited for ADNI-1 and ADNI-GO had the option to be followed in ADNI-2. For up-to-date information, see www. adni-info.org."}, {"section_title": "Data processing", "text": "We applied FGWAS to the joint analysis of anatomical MRI and genetic data collected through ADNI-1. In this data analysis, we included 708 MRI scans from healthy controls and individuals with AD or MCI (186 AD, 388 MCI, and 224 healthy controls) from ADNI-1. The scans (from 462 men and 336 women, ages 75:42\u00b16:83 years), which were performed on a variety of 1.5 T MRI scanners with protocols individualized for each scanner, include standard T1-weighted images obtained using volumetric 3-dimensional sagittal MPRAGE or equivalent protocols with varying resolutions. The typical protocol includes: repetition time \u00bc 2400 ms, inversion time \u00bc 1000 ms, flip angle \u00bc 8 , and field of view \u00bc 24 cm, with a 256 \u00c2 256 \u00c2 170 acquisition matrix in the x\u00c0, y\u00c0, and z\u00c0dimensions, which yields a voxel size of 1:25 \u00c2 1:26 \u00c2 1:2 mm 3 . We processed the MRI data by using standard steps, including anterior commissure and posterior commissure correction, skull-stripping, cerebellum removing, intensity inhomogeneity correction, segmentation, and registration. Subsequently, we carried out automatic regional labeling by labeling the template and by transferring the labels following the deformable registration of subject images. After labeling 93 ROIs, we were able to compute volumes for each of these ROIs for each subject.\nWe adopted a hippocampal subregional analysis package based on surface fluid registration (Shi et al., 2013 ) that uses isothermal coordinates and fluid registration to generate one-to-one hippocampal surface registration for computing the surface statistics. Then, we computed the various surface statistics on the registered surface, such as multivariate tensor-based morphometry statistics, which retain the full tensor information of the deformation Jacobian matrix, together with the radial distance, which retains information on the deformation along the surface normal direction. More details can be found in (Wang et al., 2011) .\nWe considered the 818 subjects' genotype variables acquired by using the Human 610-Quad BeadChip (Illumina, Inc., San Diego, CA) in the ADNI database, which includes 620,901 SNPs. To reduce the population stratification effect, we used data from 749 Caucasians among all 818 subjects with complete imaging measurements at baseline. Quality control procedures included (i) call rate check per subject and per SNP marker, (ii) gender check, (iii) sibling pair identification, (iv) the HardyWeinberg equilibrium test, (v) marker removal by MAF, and (vi) population stratification. The second line preprocessing steps included removal of SNPs with (i) more than 5% missing values, (ii) MAF smaller than 5%, and (iii) Hardy-Weinberg equilibrium p-value < 10 \u00c06 .\nRemaining missing genotype variables were imputed as the modal value. After the quality control procedures, 708 subjects and 501,584 SNPs remained in the final data analysis."}, {"section_title": "Data analysis", "text": "The hippocampus is believed to be involved in memory, spatial navigation and memory, and behavioral inhibition. In AD, the hippocampus is one of the first regions of the brain to be affected, leading to the confusion and loss of memory so commonly seen in the early stages of the disease. Recent work has revealed that the hippocampus is structurally and functionally asymmetric, and hippocampal asymmetry changes with AD progression, with the left hippocampus affected first by dementia, followed by atrophy in the right hippocampus after a time lag.\nThe objective of this data analysis was to examine the genetic effect of Fig. 4 . Simulation results for comparisons among FVGWAS, standard functional GWAS, and FGWAS in identifying significant voxel-locus pairs: (a) Case 1. ROC curves of all three methods with \u03b2 \u00c3 \u00bc 0:005 and \u03b2 \u00c3 \u00bc 0:01, whereas other parameters \u03a9, n, N0, and r are set to 0.5, 1000, 1000, and 6, respectively. (b) Case 2. ROC curves of all three methods with N0 \u00bc 500 and N0 \u00bc 1; 000, whereas other parameters \u03a9, n, \u03b2 \u00c3 , and r are set to 0.5, 1000, 0.01, and 6, respectively. (c) Case 3. ROC curves of all three methods with r \u00bc 3 and r \u00bc 9, whereas other parameters \u03a9, n, N0, and \u03b2 \u00c3 are set to 0.5, 1000, 1000, and 0.01, respectively.\neach of 501,584 SNPs on either the left or right hippocampus and whether the genetic pathway of the left hippocampus overlaps with that of the right after partialing out the genetic effect of APOE \u03b54. To achieve this objective, we applied FGWAS with either the left or right hippocampal surface data as the functional phenotypes. Specifically, we chose the radial distance and determinant of Jacobian matrix as two different surface measurements. Moreover, in model (1), we included an intercept, gender, age, APOE \u03b54, and the top 5 principal component scores of all SNPs as covariates. We had 708 subjects, 30,000 vertices on the hippocampal surface (15,000 on each side), and 501,584 SNPs. The number of candidate loci was set as N 0 \u00bc 2; 000. Then, the total computational time was 91,423s and 92,091s for the left and right hippocampi, respectively. We have the following findings. Fig. 5(a)-(d) shows the Manhattan and QQ plots of the GWAS results for the left and right hippocampal surfaces, respectively. Moreover, Fig. 6(a, b) shows the density of the global Wald-type statistic and its \u03c7 2 approximation in the GSIS procedure, which are very close to each other, indicating the accuracy of the \u03c7 2 approximation. Tables 3 and 4 present the top 50 SNPs associated with the left and right hippocampal surfaces. At the 10 \u00c05 significance level, 11\nSNPs were detected as being associated with the left hippocampal surface, while 17 SNPs were found to be associated with the right hippocampal surface. Fig. 7(a, b) presents the LocusZoom plot (Pruim et al., 2010) , which shows the regional association results near the top 1 SNP (rs657132 on gene HRH4, chr 18) from the GSIS procedure on the left hippocampal surface, and the top 1 SNP (rs4681527 on gene C3orf58, chr 3) on the right hippocampal surface. In particular, histamine receptor H4 (HRH4) is a protein-coding gene, and disease associated with HRH4 includes cerebellar degeneration. Moreover, cholinergic receptor M4 (CHRM) is an important paralog of HRH4, and the loss of M4 receptors has been found in the hippocampus of AD patients (Mulugeta et al., 2003) . Further information about all top 2000 SNPs on each side of the hippocampal surfaces are available online at \"http://odin.mdacc.tmc. edu/bigs2/Top_2000_SNPs.html\". We also included the group effects into our MVCM and reran our FGWAS. The corresponding Manhattan and QQ plots are presented in Fig. 10 in Appendix. In order to compare the GWAS results obtained under the model including group effects with those under the model without group effects, the rank-rank analysis (Plaisier et al., 2010) was conducted to compare the rank consistency of top 2000 genes detected in each model. It shows that the results under the two models are highly consistent with each other. In\nStep (III), we first calculated the corrected p-values of T n \u00f0g \u00c3 ; d\u00de across all vertices and candidate loci in G \u00c3 0 to further detect significant vertex-locus pairs. In order to obtain the empirical distribution of T n \u00f0g \u00c3 ; d\u00de under H 0 , the wild bootstrap method was adopted. We set N 0 \u00bc 2; 000 and generated B \u00bc 500 bootstrapped samples. We considered a parallel computing strategy and divided the genetic data into K G \u00bc 10 pieces. Fig. 6(c, d) shows the density plots of T n \u00f0g \u00c3 ; d\u00de for N 0 \u00bc 2; 000, corresponding to the left and right hippocampal surfaces, respectively, which are close to their \u03c7 2 approximations. Subsequently, we calculated the corrected p\u00c0values of T n \u00f0g \u00c3 ; d\u00de. Fig. 7(c) shows the corrected \u00c0log 10 \u00f0p\u00de\u00c0values corresponding to the top 2 SNPs on the left and right hippocampal surfaces, where the color bar is presented as well.\nIn order to detect significant subregion-locus pairs, we set \u03b1 I \u00bc 0:0001 and calculated all possible subregions and their associated pvalues against the top N 0 \u00bc 2; 000 SNPs. Fig. 7(d) shows the \u00c0log 10 \u00f0p\u00de\u00c0values for significant subregions that correspond to the top 2 SNPs on both hippocampal surfaces, where the color bar is also presented. In particular, for the top 1 SNP, two subregions are found for the right hippocampal surface and one for the left hippocampal surface; whereas for the second top SNP, two subregions are found for each side of the hippocampal surfaces. Moreover, most significant subregions are likely to be symmetric across the left and right hippocampal surfaces. To specify the exact locations of significant subregions on the hippocampal surfaces, we recalled the cytoarchitectonic subregions mapped on blank MR-based models at 3 T of the hippocampal formation (Duvernoy, 2005; Frisoni et al., 2008) , which are presented in Fig. 8(a) . It shows that all the significant subregions are found in the CA1 subfield. Specifically, the most significant subregion (blue region indicated in Fig. 7(b) ) is found on the lateral and medial aspects of the tail (CA1 subfield), and other subregions are found on the dorsolateral aspect of the head (CA1 subfield). It is interesting to note that volumes of similar hippocampal subregions were found to be affected in AD (Frisoni et al., 2008) , indicating that the results obtained from FGWAS are in agreement with those of previous work.\nWe applied the rank-rank scatter plot in order to investigate the connection between the genetic pathway for the left hippocampus and that for the right hippocampus. We first selected the top 2000 genes in the GWAS result on each side of the hippocampal surface and combined them, i.e., 3; 562 genes in total. Note that the rank information of each gene was calculated based on the largest \u00c0log 10 \u00f0p\u00de\u00c0value of SNPs associated with this gene. According to the rank information, the rankrank scatter plot is presented in Fig. 8(b) . It can be found that the two genetic pathways have weak connection. Specifically, only a few top genes have similar rank information on the left and right hippocampal surfaces, indicating that hippocampal asymmetry exists. In fact, the hippocampus was found to be structurally and functionally asymmetric in both healthy adults and AD patients (Shi et al., 2009; Maruszak and Thuret, 2013) . Furthermore, different gene-environment interaction effects are found on different hippocampal subfields (Rabl et al., 2014) . Therefore, the hippocampal asymmetry in our studies may be sound. Apart from the existence of hippocampal asymmetry, we wanted to examine whether any common genetic effect is associated with AD on both the left and right hippocampal surfaces. There is one gene, RBFox1, with similar rank information on both sides of the hippocampus (rank: 134 on the left hippocampal surface and 137 on the right hippocampal surface). Specifically, the amyloid precursor protein (APP) was found to be altered by transient RBFox1 expression in HEK293 and HeLa cells. Moreover, proteolytic processing of APP leads to the formation of \u03b2-amyloid (A\u03b2) peptides, which accumulate in the brains of those affected by AD (Ghiso and Frangione, 2002) . Therefore, RBFox1, which presents a common genetic effect on both sides of the hippocampus, may play an important role in the progression of AD. Finally, we calculated the polygenic risk score (PRS) at each vertex for multiple thresholds of p-values (i.e., 0.001, 0.01, 0.05, and 0.1). Then, we used a vertex-wise linear regression model and the coefficient of determination, R 2 , to assess the proportion of variation in each imaging measurement that is explained by the PRS. The estimated R 2 values across all vertices for two different types of imaging measurements are reported in Fig. 9 . As the threshold increases, the estimated R 2 values across all vertices increase. When the threshold is 0.05 or 0.1, the estimated R 2 values are all above 0.5. Interestingly, comparing Fig. 9 with Fig. 8 . ADNI hippocampal surface GWAS: (a) Cytoarchitectonic subregions mapped on blank MR-based models at 3 T of the hippocampal formation (Duvernoy, 2005; Frisoni et al., 2006 Frisoni et al., , 2008 ; (b) Rank-rank scatter plots. The rank information of both the top 2000 genes on the left hippocampal surface and those on the right hippocampal surface, which were calculated based on the largest \u00c0log 10 \u00f0p\u00de\u00c0values of SNPs associated with each gene. Fig. 7 (d) reveals that the estimated R 2 values in the significant subregions, which were detected in Step (III), are larger than those in other regions and more likely increase as the threshold increases."}, {"section_title": "Conclusion and discussion", "text": "We have developed a FGWAS pipeline for efficiently carrying out genome-wide association analysis of surface-based imaging genetic data. Our proposed FGWAS consists of an MVCM, a GSIS procedure, and a detection procedure based on wild bootstrapping methods. Three key advantages of FGWAS have been discovered: (i) the spatial correlation structure of imaging data and variability of multiple phenotypic measurements considered in the multivariate varying coefficient model; (ii) much lower computational complexity compared to standard functional GWAS (Reimherr and Nicolae, 2014) , and (iii) a parallel computing strategy that makes FGWAS feasible for super large-scale genetic data. Simulation studies have been conducted to evaluate the finite sample performance of FGWAS. We successfully applied FGWAS to hippocampal surface data and genetic data from the ADNI. Our FGWAS is a valuable statistical toolbox for fast, large-scale imaging genetic analysis.\nThere are two substantial issues to be addressed in our future research. First, since our FGWAS is still a single SNP analysis framework (Huang et al., 2015) , the power of FGWAS may be undermined by unobserved causal SNPs, correlation among adjacent SNPs, and SNP-SNP interactions (Tzeng et al., 2011; Wu et al., 2011) . It has been shown that alternative approaches for testing the association between a single SNP set and individual phenotypes are promising for improving the power of GWAS (Ge et al., 2012; Thompson et al., 2013) . Therefore, it is of great importance to generalize our FGWAS for mapping the association between a SNP set and functional neuroimaging.\nSecond, in this paper, our FGWAS can only be used to detect the genetic markers that influence neuroimaging phenotypes. However, as in GWAS of AD, a question of interest is to test the null hypothesis of no association between functional phenotypes and the genotypes or genetic interactions (gene-environment), for example, genome-wide interaction analysis of relating SNPs to education level (Frost et al., 2016) , case control conditions or memory scores (Yan et al., 2015) . Meanwhile, detecting these interactions within genome-wide data can be challenging due to the loss in statistical power and computational efficiency. Therefore, generalizing our FGWAS for testing genetic interaction effects will be another aim in our future work. "}]
[{"section_title": "Abstract", "text": "Abstract"}, {"section_title": "Introduction", "text": "In recent years, computational neuroimaging has become an exciting interdisciplinary field with many applications in functional and anatomic brain mapping, image-guided surgery, and multimodality image fusion [1, 4, 7, 8] . The goal of image registration is to align, or spatially normalize, one image to another. In multi-subject studies, this reduces subject-specific anatomic differences by deforming individual images onto a population average brain template. When applied to serial scans of human brain, image registration offers tremendous power in detecting the earliest signs of illness, understanding normal brain development or aging, and monitoring disease progression. Recently, there has been an expanding literature on various nonrigid registration techniques, with different image matching functionals, regularization schemes, and numerical implementations. In [6, 9] , the authors systematically examined the statistical properties of Jacobian maps (the determinant of the local Jacobian operator applied to the deformations), and proposed an unbiased large-deformation image registration approach. In this context, unbiased means that the Jacobian determinants of the deformations recovered between a pair of images follow a log-normal distribution, with zero mean after log-transformation. The authors argued that this distribution is beneficial when recovering change in regions of homogeneous intensity, and in ensuring symmetrical results when the order of two images being registered is switched. The authors applied this method to a longitudinal MRI dataset from a single subject, and showed promising results in eliminating spurious signals. They also noticed that different registration techniques, when applied to the same longitudinal dataset, may sometimes yield visually very different Jacobian maps, causing problems in interpreting local structural changes. Given this ambiguity and the increasing use of registration methods to measure brain change, more information is required concerning the baseline stability, reproducibility, and statistical properties of signals generated by different nonrigid registration techniques.\nIn this paper, we introduce a novel Asymmetric Unbiased model (by contrast with the Symmetric Unbiased model) and, for the first time, we analyze unbiased models with mutual information based matching functionals (prior work has focused on the case where the summed squared intensity difference is used as the criterion for registration). Most importantly, we aim to provide quality calibrations for different non-rigid registration techniques in TBM. In particular, we compare two common matching functionals: L 2 , or the sum of squared intensity differences, versus mutual information, and three regularization techniques (fluid registration versus the Asymmetric Unbiased and Symmetric Unbiased techniques). Our experiments are designed to decide which registration method is more reproducible, more reliable, and offers less artifactual variability in regions of homogeneous image intensity. The foundation of our calibrations is based on the assumption that, by scanning healthy normal human subjects twice over a 2-week period using the same protocol, serial MRI scan pairs should not show any systematic biological change. Therefore, any regional structural differences detected using TBM over such a short interval may be assumed to be errors. We apply statistical analysis to the profile of these errors, providing information on the reliability, reproducibility and variability of different registration techniques. Moreover, serial images of 10 subjects from the ADNI follow-up phase (images acquired one year apart) were analyzed in a similar fashion and compared to the ADNI baseline data. In images collected one year apart, real anatomical changes are present; neurobiological changes due to aging and dementia include widespread cell shrinkage, regional gray and white matter atrophy and expansion of fluid-filled spaces in the brain. Thus, a good computational technique should be able to differentiate between longitudinal image pairs collected for the ADNI baseline (2-week) and follow-up (1-year) phases.\nAt this point, we would like to motivate the unbiased approach, which couples the computation of deformations with statistical analyses on the resulting Jacobian maps. As a result, the unbiased approach ensures that deformations have intuitive axiomatic properties by penalizing any bias in the corresponding statistical maps. In the following sections, we describe the mathematical foundations of this approach, define energy functionals for minimization, and perform thorough statistical analyses to demonstrate the advantages of the unbiased registration models."}, {"section_title": "Unbiased Image Registration", "text": "Let \u2126 be an open and bounded domain in R n , for arbitrary n. Without loss of generality, assume that the volume of \u2126 is 1, i.e. |\u2126| = 1. Let I 1 : \u2126 \u2192 R and I 2 : \u2126 \u2192 R be the two images to be registered. We seek to find the transformation g : \u2126 \u2192 \u2126 that maps the source image I 2 into correspondence with the target image I 1 . In this paper, we will restrict this mapping to be differentiable, one-to-one, and onto. We denote the Jacobian matrix of a deformation g to be Dg, with Jacobian denoted by |Dg(x)| := det(Dg(x)). The displacement field u(x) from the position x in the deformed image I 2 \u2022 g(x) back to I 2 (x) is defined in terms of the deformation g(x) by the expression g(x) = x \u2212 u(x) at every point x \u2208 \u2126. Thus, we consider the problems of finding g and u to be equivalent.\nWe now describe the construction of the Unbiased Large-Deformation Image Registration. We associate three probability density functions (PDFs) to g, g \u22121 , and the identity mapping id:\nBy associating deformations with their corresponding global density maps, we can now apply information theory to quantify the magnitude of deformations. In our approach, we choose the Kullback-Leibler (KL) divergence and symmetric Kullback-Leibler (SKL) distance. The KL divergence between two probability density functions, p 1 (x) and p 2 (x), is defined as\nWe define the SKL distance as\nThe Unbiased method solves for the deformation g (or, equivalently, for the displacement u) minimizing the energy functional E, consisting of the image matching term F and the regularizing term R which is based on KL divergence or SKL distance. The general minimization problem can be written as\nHere, \u03bb > 0 is a weighting parameter."}, {"section_title": "Asymmetric Unbiased Registration", "text": "To quantify the magnitude of deformation g, in this paper we introduce a new regularization term R KL , which is an asymmetric measure between P id and P g :\nThis regularization term can be shown to be"}, {"section_title": "Symmetric Unbiased Registration", "text": "We also examine the regularization functional based on the symmetric KL distance between P id and P g :\nAs shown in [6, 9] , the regularization term is linked to statistics on Jacobian maps as follows\nNotice that the symmetric unbiased regularizing functional is pointwise nonnegative, while the asymmetric unbiased regularizer in (2) can take either positive or negative values locally."}, {"section_title": "Fidelity Metrics", "text": "In this paper, the matching functional F takes two forms: the L 2 norm (the sum of squared intensity differences) and MI (mutual information). We briefly describe both distances in this section."}, {"section_title": "L 2 -norm", "text": "The L 2 -norm matching functional is suitable when the images have been acquired through similar sensors and thus are expected to present the same intensity range and distribution. The L 2 distance between the deformed image"}, {"section_title": "Mutual Information", "text": "One of the main advantages of using mutual information is that it can be used to align images of different modalities, without requiring knowledge of the relationship (joint intensity distribution) of the two registered images. To define the mutual information between the deformed image I 2 (x \u2212 u) and the target image I 1 (x), we denote by p "}, {"section_title": "I2", "text": "u the intensity distributions estimated from I 1 (x) and I 2 (x \u2212 u), respectively. An estimate of their joint intensity distribution is denoted as p\nGiven the displacement field u, the mutual information computed from I 1 and I 2 is provided by\nWe seek to maximize the mutual information between I 2 (x \u2212 u) and I 1 (x), or equivalently, minimize the negative of MI"}, {"section_title": "Minimization of Energy Functionals", "text": "In general, we expect minimizers of the energy functional E(u) to exist. Computing the first variation of the functional in (1), we obtain the gradient of E(u), namely \u2202 u E(u). We define the force field f , which drives I 2 into registration with I 1 , as\nHere, R(u) is either R KL (u) or R SKL (u). We minimize (1) using the fluid flow proposed in [1] . Given the velocity field v, the following partial differential equation can be solved to obtain the displacement field u:\nHere, \u03c4 is an artificial time variable. The instantaneous velocity as in [3] is obtained by convolving f with Gaussian kernel G \u03c3 of variance \u03c3 2 , v = G \u03c3 * f (x, u). To avoid possible confusion, we summarize the methods we will be referring to in our subsequent analyses. In later discussions, minimization of the following energies\nusing equations (4), (5) will be referred to as L 2 -Asymmetric Unbiased and L 2 -Symmetric Unbiased models, respectively. The model above, provided \u03bb = 0, will be referred to as the L 2 -Fluid model. Similarly, minimization of\nwill be referred to as the MI-Asymmetric Unbiased and MISymmetric Unbiased models, respectively. Such models, with \u03bb = 0, define the MI-Fluid model."}, {"section_title": "Statistical Analysis", "text": ""}, {"section_title": "Statistical testing on the deviation of log Jacobian maps in the absence of changes", "text": "Based on the authors' approach in [6] , we observe that, given that there is no systematic structural change within two weeks, any deviation of the Jacobian map from one should be considered error. Thus, we expect that a better registration technique would yield log |Dg| values closer to 0 (i.e., smaller log Jacobian deviation translates into better methodology). Mathematically speaking, one way to test the performance is to consider the deviation map dev of the logged (i.e., logarithmically transformed) Jacobian away from zero, defined at each voxel as dev(x) = | log |Dg(x)||. For two different registration methods A and B, we define the voxel-wise deviation gain of A over B (denoted by S A,B ) as\n. For the ADNI baseline dataset (in which patients are scanned twice with MRI, two weeks apart), we perform a group paired t test across subjects, by computing a voxelwise t-map of deviation gains. In order to statistically compare the performance of two registration methods, we rely on the standard t test on the voxel mean of S. To construct a suitable null hypothesis, we notice that the following relation would hold, assuming B outperforms A: S A,B > 0. Thus, the null hypothesis in this case would be testing if the mean deviation gain is zero: H 0 : \u00b5 S A,B = 0. To determine the ranking of A and B, we have to consider one-sided alternative hypotheses. For example, when testing if B outperforms A, we use the following alternative hypothesis:\nwhere\n, thus follows the Student's t distribution under the null hypothesis and may be used to determine the p-value that the null hypothesis is true. If the alternative hypothesis is accepted, we confirm that sequence B outperforms A at point x. Otherwise, we would rank A and B equally if the null hypothesis is not rejected."}, {"section_title": "Detecting Real Changes -Statistical testing on the mean log Jacobian", "text": "For both the ADNI follow-up dataset (in which patients are scanned twice with MRI, one year apart) and ADNI baseline dataset, we create a voxel-wise t map using the local log Jacobian values of the ten subjects, allowing us to test the validity of the zero mean assumption. To simplify the notation, we introduce J to denote J = |Dg|. The following voxel-wise T statistic compared to a two-tailed Student's t distribution may then be used to test the above null hypothesis\nwhere log J(\n. We reject the null hypothesis if the p value calculated above exceeds a pre-set threshold based on a suitable confidence interval."}, {"section_title": "Permutation Testing to Correct Multiple Comparisons", "text": "To determine the overall global effects of different registration methods on the deviation of log Jacobian maps throughout the brain, we performed permutation tests to adjust for multiple comparisons. Following the analyses in [5] , we resampled the observations by randomly flipping the sign of S A,B i (i = 1, 2, ..., n) under the null hypothesis. For each permutation, voxelwise t tests are computed. We then compute the percentage of voxels inside the chosen ROI (in this case the ICBM mask) with T statistics exceeding a certain threshold. The multiple comparisons-corrected p value may be determined by counting the number of permutations whose above-defined percentage exceeds that of the un-permuted observed data. For example, we say that sequence B outperforms A on the whole brain if this corrected p value is smaller than 0.05 (that is, less than 5% of all permutations have the above-defined percentage greater than that of the original data). All possible (2 10 = 1024) permutations were considered in determining the final corrected p value.\nMI-Symmetric Unbiased time 2 to time 1 time 1 to time 2 products of Jacobians Figure 1 . Nonrigid registration was performed on an image pair from one of the subjects from the ADNI Baseline study (serial MRI images acquired two weeks apart) using\n2 -Symmetric Unbiased, MI-Fluid, MIAsymmetric Unbiased, and MI-Symmetric Unbiased registration methods. Jacobian maps of deformations from time 2 to time 1 (column 1) and time 1 to time 2 (column 2) are superimposed on the target volumes. The unbiased methods generate less noisy Jacobian maps with values closer to 1; this shows the greater stability of the approach when no volumetric change is present. Column 3 examines the inverse consistency of deformation models. Products of Jacobian maps are shown for the forward and backward directions. For the unbiased methods, the products of the Jacobian maps are less noisy, with values closer to 1, showing better inverse consistency. "}, {"section_title": "Cumulative Distribution Function (CDF)", "text": "To visually assess the global significance level of the voxel-wise t tests on deviation gains and log-Jacobian values, we also employed the cumulative distribution function (CDF) plot. In brief, we plot observed cumulative probabilities against the theoretical distribution under the null hypothesis. In the case of deviation gains S of a worse technique A over a better technique B in the ADNI baseline data, we expect a CDF curve to lie above the Null line (y = x), in the sense that a better technique exhibits less systematic changes. In the case of log-Jacobian values, a better registration technique, on the other hand, should be able to separate the CDF curves between ADNI baseline and follow-up phases (this is what we refer to as the separation of CDF curves in the presence of real physiological changes)."}, {"section_title": "Results", "text": "In this section, we tested the Asymmetric Unbiased and Symmetric Unbiased models and compared the results to those obtained using the Fluid registration model [1, 3] . Of note, even though Asymmetric Unbiased and Symmetric Unbiased methods minimize different energy functionals, our experiments showed that they generate very similar maps. For each regularization technique, we employed both L 2 and mutual information matching functionals (see (6)- (9)). In order to obtain a fair comparison, re-gridding was not employed."}, {"section_title": "ADNI Baseline Scans", "text": "In this section, nonlinear registration was performed on a dataset that we shall refer to as the \"ADNI Baseline\" dataset, which includes serial MRI images of ten normal elderly subjects acquired two weeks apart. Each of the ten pairs of scans is represented on a 128 \u00d7 160 \u00d7 128 grid. Here, the foundation of calibrations is based on the assumption that, by scanning normal control human subjects serially within a two-week period using the same MRI protocol, no systematic structural changes should be recovered.\nHere, we compared Fluid, Asymmetric Unbiased, and Symmetric Unbiased methods coupled with both L 2 and mutual information matching. Uniform values of \u03bb = 500 and \u03bb = 1000 were used for all deformations using L 2 -Symmetric Unbiased and L 2 -Asymmetric Unbiased algorithms, respectively. Also, \u03bb = 5 and \u03bb = 10 were used for deformations using MI-Symmetric Unbiased and MIAsymmetric Unbiased methods. Since the Asymmetric Unbiased model quantifies only the forward deformation, the weight of the corresponding regularization functional is half Figure 4 . Nonrigid registration was performed on the ADNI Baseline study (serial MRI images acquired two weeks apart) of ten normal elderly subjects using L 2 -Fluid, L 2 -Asymmetric Unbiased, and L 2 -Symmetric Unbiased, MI-Fluid, MI-Asymmetric Unbiased, and MISymmetric Unbiased registration methods. For each method, the mean of the resulting 10 Jacobian maps is superimposed on one of the brain volumes. Visually, Fluid registration generates noisy mean maps, while maps generated using the Asymmetric Unbiased and Symmetric Unbiased methods are less noisy with values closer to 1. For all deformation models, regions with least stability, due to both spatial distortion and intensity inhomogeneity, are the brain stem, thalamus, and ventricles. the magnitude of that of the Symmetric Unbiased model, and hence, a weighting parameter twice as large should be used. Figures 1-3 show the results of registering a pair of serial MRI images for one of the subjects. The deformation was computed in both directions (time 2 to time 1, and time 1 to time 2) using all three regularization methods based on L 2 and mutual information matching. Results indicate the Asymmetric Unbiased and Symmetric Unbiased methods outperform Fluid method, generating more stable inverse consistent maps [2] with less variability. Figure 4 shows the mean Jacobian maps of ten subjects obtained using Fluid, Asymmetric Unbiased, and Symmetric Unbiased registration algorithms coupled with both L 2 and mutual information matching. Jacobian maps generated using unbiased models have values closer to 1, whereas Fluid model generated noisy mean maps. Figures  5 and 6(a,b) demonstrate the Unbiased regularization technique outperforming Fluid registration with statistical significance.\nTo emphasize the differences between the distributions of log Jacobian values for Fluid and unbiased (both asymmetric and symmetric) methods, in Figure 7 , we plotted the cumulative distribution function of the p-values in deviation gains (S A,B ). For a null distribution, this cumulative plot falls along the line y = x. Larger upward inflections of the CDF curve near the origin are associated with significant deviation gains, indicating that both Asymmetric Unbiased and Symmetric Unbiased methods outperform Fluid method in being less likely to exhibit structural changes in the absence of systematic biological changes.\nWe also compared L 2 and mutual information cost functionals for both Fluid and Symmetric Unbiased regularization. (Since Asymmetric Unbiased and Symmetric Unbiased regularizations produce similar results, we do not show the results for the asymmetric version). We showed that MI-Fluid outperforms L 2 -Fluid with statistical significance (Figure 6(c) ). However, the result of the comparison of L 2 -Symmetric Unbiased and MI-Symmetric Unbiased is inconclusive ( Figure 6(d) ). In other words, mutual information performs better (than L 2 ) when coupled with Fluid registration, but there is no statistical difference between mutual information and L 2 when the Symmetric Unbiased method is used. To explain this result, we postulate that by constraining the deformations less (i.e., as in Fluid registration), assuming intensity 1-to-1 correspondence (i.e., matching using L 2 ) may lead to local oscillations of the deformation maps, as minimizing L 2 forces a local search for the smallest intensity differences. One result of this is a Jacobian map with locally extreme values, translating into spurious signals and, in our case, less reproducibility. On the other hand, the Symmetric Unbiased method eliminates local oscillations, allowing globally better matching when intensity 1-to-1 correspondence can be assumed (i.e., when L 2 is ap- plicable as a data fidelity term)."}, {"section_title": "ADNI Follow-up Scans", "text": "In this section, we analyze a dataset we shall call the \"ADNI Follow-up\" phase dataset, which includes serial MRI images (220 \u00d7 220 \u00d7 220) of ten subjects acquired one year apart. As the images are now one year apart, real anatomical changes are present, which enables the comparison of methods in the presence of true biological changes.\nIn Figure 8 , nonlinear registration was performed using Fluid, Asymmetric Unbiased, and Symmetric Unbiased methods coupled with both L 2 and mutual information matching. Visually, the Fluid method generates noisy mean Jacobian maps, while maps generated using unbiased methods suggest a volume reduction in gray matter as well as ventricular enlargement. Here, both Asymmetric Unbiased and Symmetric Unbiased methods perform equally well. Figure 9 displays the cumulative distribution of p-values for the voxel-wise log Jacobian t-maps for both ADNI Baseline and ADNI Follow-up datasets. We expect a better method to separate these two CDF curves, indicating that a real biological change has occurred between the two time points. A greater separation is accomplished when Unbiased methods are used, while the Fluid method does not differentiate between the two datasets."}, {"section_title": "Conclusion", "text": "This paper is the first work to systematically investigate the reproducibility and variability of different registration methods in TBM. We showed that Asymmetric Unbiased and Symmetric Unbiased models perform significantly better than the fluid registration technique. Although various techniques have been extensively applied to detect disease effects and monitor brain changes with TBM, this paper is the first calibration study to compare registration models for tensor-based morphometry. We believe our results are important, as they provide greater insight into the interpretation of TBM results in the future. Figure 9 . Cumulative distribution of p-values for the voxelwise log Jacobian t-maps (as defined in Equation (11)) for both ADNI Baseline (in blue) and Follow-up (in green) using L 2 -Fluid, L 2 -Asymmetric Unbiased, and L 2 -Symmetric Unbiased methods. A better method should separate these two CDF plots (see Section 5.4) with the Null line in between, indicating a real biological change has occurred between these two time points. Hence, L 2 -Asymmetric Unbiased and L 2 -Symmetric Unbiased methods outperform L 2 -Fluid method."}]
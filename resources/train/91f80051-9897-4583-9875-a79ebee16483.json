[{"section_title": "Abstract", "text": "Complex statistical models such as scalar-on-image regression often require strong assumptions to overcome the issue of non-identifiability. While in theory it is well understood that model assumptions can strongly influence the results, this seems to be underappreciated, or played down, in practice.\nThe article gives a systematic overview of the main approaches for scalar-on-image regression with a special focus on their assumptions. We categorize the assumptions and develop measures to quantify the degree to which they are met. The impact of model assumptions and the practical usage of the proposed measures are illustrated in a simulation study and in an application to neuroimaging data. The results show that different assumptions indeed lead to quite different estimates with similar predictive ability, raising the question of their interpretability. We give recommendations for making modeling and interpretation decisions in practice, based on the new measures and simulations using hypothetic coefficient images and the observed data."}, {"section_title": "Introduction", "text": "Medical images allow us to look into the human body and therefore provide a rich source of information in statistical analyses. Scalar-on-image regression aims at finding a relationship between a scalar response and an image covariate. The results can be used to make subject-specific predictions, but also for finding interpretable associations and for generating hypotheses in neuroscientific research. In contrast to the widely used and very popular pixelwise or voxelwise methods, as for example statistical parametric mapping (SPM Friston et al. (2007) ), which fit a separate model in each pixel with the image information as the response, scalar-on-image regression models include the whole image as a predictor in a single model. Consequently, the number of variables in principle equals at least the number of pixels in the image, which is typically much larger than the sample size. The model is hence inherently unidentifiable and requires strong structural assumptions on the coefficients to overcome the issue of non-identifiability. While this is less problematic for prediction (different coefficient images may give similar predictions), it remains an issue for the estimation and particularly for the interpretability of the coefficient image. Although all this is well understood from a theoretical point of view, we consider it an underappreciated or underplayed problem in practice, which entails the risk of over-interpreting effects that are mainly driven by the model assumptions. The aim of this paper is three-fold. First, we provide a review of different conceptual approaches for scalar-on-image regression, including their assumptions and currently available implementations. Overall, we discuss eight models that represent the principal approaches for scalar-on-image regression. Some reduce the complexity by means of basis function representations of the coefficient image and can therefore be related to the broad field of scalar-on-function regression methods Reiss et al. (2017) ; M\u00fcller and Stadtm\u00fcller (2005) ; Cardot et al. (1999) . Others apply dimension reduction methods, partly combined with a basis function expansion Reiss and Ogden (2010) ; Reiss et al. (2015) . Finally, we also consider methods that formulate the model assumptions in terms of spatial Gaussian Markov random field priors Besag (1974) ; . We systematically compare the models from a theoretical point of view as well as in simulations and in a case study based on neuroimaging data from a study on Alzheimer's disease Weiner et al. (2015) . Second, due to the inherent non-identifiability of scalar-on-image regression models, we investigate the influence of the model assumptions on the coefficient estimates and examine the extent of the problem in practice. We argue that the structural assumptions made in the different models can come in different levels of abstraction that we characterize as underlying and parametric model assumptions. We show that different assumptions can indeed lead to quite different estimates, raising the question of interpretability of the resulting estimates. Third, we give recommendations and develop measures that can help to make modeling and interpretation decisions in practice. The article is structured as follows: Section 2 introduces the scalar-on-image regression model and the different estimation methods. Particular emphasis is put on the model assumptions. In Section 3, they are compared and categorized and measures are developed that allow to assess to what extent the assumptions of a certain model are met. Section 4 contains the simulation study and Section 5 presents the neuroimaging application. The paper concludes with a discussion and an outlook to potential future research in Section 6."}, {"section_title": "Overview of Methods for Scalar-on-Image Regression", "text": "This section introduces the scalar-on-image regression model and provides a systematic overview of the approaches considered in this paper. The presented models have been selected to represent the most important assumptions and all relevant model classes in scalar-on-image regression. In addition, we have focused on easily accessible methods, for which software solutions are already available or which we could implement without much effort. An overview of the implementations for the studied methods is given at the end of this section and in the code supplement of this article (available on GitHub: https://github.com/ClaraHapp/SOIR)."}, {"section_title": "The Scalar-on-Image Regression Model", "text": "The scalar-on-image regression model studied in this paper is assumed to be of the following form:\nx i,l \u03b2 l + \u03b5 i , i = 1, . . . , N.\n(1)\nThe observed data for each of the N \u2208 N observation units, as for example subjects in a medical study, consist of a scalar response y i , an image covariate x i with L \u2208 N pixels and scalar covariates w i \u2208 R p , including an intercept term. The images are assumed to be demeaned over all observations in the following. As in the standard linear model, the vector \u03b1 \u2208 R p contains the coefficients for w i and the error term \u03b5 i is assumed to be i.i.d. Gaussian with variance \u03c3 2 \u03b5 > 0. The coefficient image \u03b2 relates the observed images x i to the response in terms of a discrete inner product and therefore has the same size as x i . Note that this inner product can be seen as an approximation to an integral T x i (t)\u03b2(t)dt, by interpreting the images as functions x i (\u00b7) and \u03b2(\u00b7), mapping from a typically two-or three-dimensional domain T to R. This representation is particularly useful in basis function approaches (Section 2.2). The approximation in general must include integration weights to be valid. In most cases, however, the pixels are all equidistant and the weights can be set to one, at most changing the scale of \u03b2 (\u00b7) . Alternatively, the model can be written in matrix-form\nwith y = (y 1 , . . . , y N ), W \u2208 R N \u00d7p the matrix of scalar covariates, X \u2208 R N \u00d7L the matrix of vectorized image covariates, \u03b2 \u2208 R L the vectorized coefficient image and \u03b5 \u223c N(0, \u03c3 2 \u03b5 I N ) with I N \u2208 R N \u00d7N the identity matrix. Note that theoretically, the images x i and therefore also the coefficient image \u03b2 can be three-or even higher dimensional. In practice, increasing the dimensionality of the images is frequently associated with a considerable computational burden and is not supported by all implementations. For reasons of simplicity and comparability, only 2D images are considered in the following analysis. Model (1) is effectively a standard linear model with coefficients \u03b1 and \u03b2. In most cases, however, the total number of coefficients p + L will exceed the number of observation units N by far, i.e. the model will in general be unidentifiable. On the other hand, the coefficients \u03b2 l are known to form an image and thus will show dependencies between neighbouring pixels. It is therefore natural to make structural assumptions about \u03b2. These assumptions imply restrictions on the coefficients \u03b2 l and can thus help to overcome the issue of non-identifiability. As the true \u03b2 coefficient is unknown, the structural assumptions on \u03b2 have to be made prior to the analysis. They reflect prior beliefs about the unknown image and can be expected to have an influence on the result. In the following, we present the most common approaches for scalar-on-image regression. They can broadly be categorized into basis function approaches (Section 2.2) and random field methods (Section 2.3)."}, {"section_title": "Basis Function Approaches", "text": "Basis function approaches start from the idea that the unknown coefficient image is generated by a function \u03b2(\u00b7) : T \u2192 R. The function is evaluated at a rectangular grid of observation points t l \u2208 T (the pixels), such that \u03b2 l = \u03b2(t l ), and assumed to lie in the span of K known basis functions B 1 , . . . , B K on T , which is a K-dimensional space. Then (1) translates to\nThis assumption reduces the estimation of \u03b2 from L coefficients \u03b2 l to K coefficients b k , as usually the number of basis functions K is chosen much smaller than the number of pixels L. If further p + K < N , this solves the identifiability issue. Otherwise, one can make additional assumptions on the coefficients b k , depending on the basis functions used. If the basis functions B k are orthonormal with respect to the standard inner product in L 2 (T ), it can be useful to interpret the observed images x i as functions, too, and to expand them in the same basis functions as \u03b2(\u00b7) with coefficients \u03b8 i,m , as then\nwhich is a standard linear regression with the covariate vectors w i = (w i,1 , . . . , w i,p ) and \u03b8 i = (\u03b8 i,1 , . . . , \u03b8 i,K ) and the coefficient vectors \u03b1 and b = (b 1 , . . . , b K ). Given an estimateb, a simple plug-in estimate for \u03b2 then is\u03b2 l = K k=1b k B k (t l ). The choice of the basis functions has a considerable influence on the estimate\u03b2. We divide the methods into three classes with fixed basis functions, data-driven basis functions or a combination of the two."}, {"section_title": "Fixed basis functions", "text": "(Penalized) B-Splines, in the following referred to as Splines: B-Splines Eilers and Marx (1996) ; Marx and Eilers (1999); De Boor (1972) are a popular class of bases for representing smooth functions. In the case of a two-dimensional function evaluated on a grid of pixels, one can use tensor product splines, giving \u03b2(t) ="}, {"section_title": "Kx kx=1", "text": "Ky ky=1 b kx,ky B kx (t x )B ky (t y ) for t = (t x , t y ). In the B-spline based scalar-on-image regression model Marx and Eilers (2005) the unknown coefficients b and \u03b1 are found by minimizing a penalized least squares criterion including a quadratic penalty for penalizing differences in b along the x-and y-axes. This yields a smooth function and -in most cases -an identifiable model Happ (2013) ; Scheipl and Greven (2016) . The penalty parameters can be found e.g. by (generalized) cross-validation Marx and Eilers (2005) or using a restricted maximum likelihood (REML) approach Wood (2011) . The main assumption here is that the unknown coefficient function \u03b2(\u00b7) can be represented well by the K x \u00b7 K y tensor product spline basis functions and that it has smooth variation. In the context of neuroimaging this would mean that brain areas that are close to each other have a similar association with the response without abrupt changes in \u03b2(\u00b7)."}, {"section_title": "Wavelets, WNET :", "text": "Given a so-called pair of mother and father wavelet functions \u03c8 and \u03c6, an arbitrary function f on a real interval can be expressed as f (t) = n\u2208Z c M0,n \u03c6 M0,n (t) + M0 m=\u2212\u221e n\u2208Z d m,n \u03c8 m,n (t) with coefficients c M0,n = f, \u03c6 M0,n 2 and d m,n = f, \u03c8 m,n 2 . The basis functions \u03c6 M0,n and \u03c8 m,n are orthonormal for a given resolution level M 0 (and m \u2264 M 0 ) Daubechies (1988) ; Reiss et al. (2015) and derive from the original mother and father wavelets via dilatation and translation: Daubechies (1988) . In practical applications, f will be observed on a finite grid {t 1 , . . . , t L }, and thus the infinite sums will be truncated. For the two-dimensional case, one can again use a tensor-type approach, defining basis functions for the x-, y-and xy-directions. The basis coefficients can be obtained efficiently if the side length of the image is a power of 2 Mallat (1989) . In practice, one observes that only a few basis functions are needed to describe most functions well, even those with sharp, highly localized features, due to the different resolutions of the basis functions. The majority of the coefficients c M0,n , d m,n can therefore be set to 0 without affecting the important characteristics of the function. This is the basic idea of the WNET model Reiss et al. (2015) for scalar-on-image regression, where the expansion of the unknown coefficient function \u03b2(\u00b7) in wavelet basis functions is combined with a variable selection step. The authors propose to add a (na\u00efve) elastic net penalty Zou and Hastie (2005) which combines the smoothing property of Ridge regression with the variable selection obtained by LASSO. The algorithm can be extended by an additional screening step, retaining only the K * < K coefficients with the highest variance Johnstone and Lu (2009) . As a full wavelet basis could perfectly reproduce the observed image, the main assumption on \u03b2(\u00b7) is sparsity of the coefficients b k , i.e. that the signal concentrates on a few basis functions which may lead to local variations of smoothness. From a neuroimaging point of view, this means that the model should be able to produce estimates\u03b2(\u00b7) with local adaptivity, which can capture sharp features in some areas and have a high degree of smoothness elsewhere Reiss et al. (2015) .\nThe preselection step further assumes that the non-zero coefficients are those corresponding to the highest variation in the observed images x i and thus variation patterns in the data translate to the coefficient image."}, {"section_title": "Data-driven basis functions", "text": "Principal component regression, PCR2D: Functional principal component regression M\u00fcller and Stadtm\u00fcller (2005) expands the unknown function \u03b2(\u00b7) in principal components (functions or images), that are obtained from the data. They represent orthogonal modes of variation in the data and thus provide the most parsimonious representation of the data in terms of the number of basis functions needed to explain a given degree of variation in the data. Expanding x i and \u03b2(\u00b7) in the same K leading principal component functions and making use of their orthonormality yields (4) with covariates \u03b8 i,k , the individual principal component scores for each observation and each principal component, and coefficients b k to be estimated. In most cases the total number of unknown variables p + K will be much smaller than the number of observations N , thus the resulting model is identifiable. Smooth principal component images can be calculated using a regularized tensor product decomposition Allen (2013) based on a rank-one approximation (CANDECOMP/PARAFRAC) Carroll and Chang (1970) . In principle, the MFPCA approach for (multivariate) functional data Happ and Greven (2018) can also be used to calculate eigenimages, interpreting the images as multivariate functional data with a single element on a two-or three-dimensional domain. The crucial assumption on the coefficient function \u03b2(\u00b7) is that \u03b2(\u00b7) is a linear combination of the first K principal components, i.e. that \u03b2(\u00b7) shares the same modes of variation as the observed images x i . On the one hand, this seems plausible, as areas with high variation in the observed images are likely to explain differences in the response values. On the other hand, this corresponds to a strong restriction of \u03b2(\u00b7) to a K-dimensional subspace of L 2 (T ). The critical number K can be found e.g. by cross-validation."}, {"section_title": "Combined Methods", "text": "The following methods combine a basis function expansion of \u03b2(\u00b7) with a subsequent data-dependent dimension reduction based on principal component analysis or partial least squares."}, {"section_title": "Principal component regression based on splines, FPCR:", "text": "The FPCR method Reiss and Ogden (2010) proposes to expand \u03b2(\u00b7) in a spline basis and add a smoothness penalty on the coefficients b in order to impose smoothness on \u03b2(\u00b7), as in Splines. The least squares criterion to minimize thus becomes\nwith B \u2208 R L\u00d7K the matrix of the basis functions B 1 , . . . , B K evaluated on the observation grid {t 1 , . . . , t L }, \u03bb > 0 a regularization parameter and P \u2208 R K\u00d7K an appropriate penalty matrix, e.g. for penalizing first differences. This corresponds to a penalized linear model with design matrix XB for the coefficients b. In a next step, the singular value decomposition of XB is calculated: XB = U DV with V \u2208 R K\u00d7K containing the principal components of XB. Then b is assumed to lie in the span of the leading K 0 < K principal components of XB Reiss and Ogden (2010) , i.e. b = V 0b with V 0 \u2208 R K\u00d7K0 the matrix containing the first K 0 columns of V . Then (5) can be written as a model inb\nK 0 can be chosen by cross-validation and is usually much smaller than K, which makes the model identifiable inb if K 0 < n. Once an estimate forb is found, the estimated coefficient image is given by\u03b2 = BV 0b . In this approach, \u03b2(\u00b7) is assumed to lie in the span of a given spline basis with coefficients b and to be a smooth function, which is induced by a smoothness penalty, as in Splines. Moreover, the coefficient vector is assumed to lie in the span of the leading principal components of the matrix XB, which corresponds to a considerable dimension reduction, similar to PCR2D."}, {"section_title": "Principal component regression in wavelet space, WCR:", "text": "The WCR method Reiss et al. (2015) proposes to transform the unknown coefficient function \u03b2(\u00b7) to the wavelet space with coefficients b = (b 1 , . . . , b K ). In a subsequent screening step, only the K * coefficients \u03b8 i,k with the highest sample-variance across the images are retained, giving a matrix X * \u2208 R * with V * 0 the matrix containing the first K 0 columns of V * as in the spline-based approach. Given the estimated valuesb * , the estimated coefficient function\u03b2(\u00b7) can be obtained by calculating b * = V * 0b * , setting all other coefficients in b to zero and retransforming b to the original space. The coefficient function \u03b2(\u00b7) here is assumed to be representable by given wavelet basis functions, where only a small number K * of wavelet coefficients are assumed to be non-zero, notably those coefficients which have the highest variation in the images. Moreover, the coefficient vector is assumed to lie in the span of the leading principal components of the non-zero wavelet coefficients of the images. Overall, this means that \u03b2(\u00b7) is assumed to be similar to the observed images concerning patterns of variation, including local variation of smoothness Reiss et al. (2015) ."}, {"section_title": "Partial least squares in wavelet space, WPLS:", "text": "A variant of the last method is WPLS Reiss et al. (2015) , where principal component analysis is replaced by partial least squares. While principal component analysis focuses on the most important modes of variation in the covariate images x i or their wavelet coefficients \u03b8 i,k , partial least squares finds the components in x i that are most relevant for predicting the outcome y i . Similarly to the previous approach, \u03b2(\u00b7) is assumed to lie in the span of wavelets with a sparse coefficient vector b, having non-zero values only for those entries where the corresponding wavelet coefficients of the images have the highest covariation with the response. Moreover, the non-zero coefficients b * are assumed to lie in the span of the leading principal least squares components derived from the wavelet coefficients \u03b8 i,k of the observed images x i , but also from the response values y i ."}, {"section_title": "Random Field Methods", "text": "Random fields are frequently used to model the coefficient image \u03b2 in a Bayesian framework. In contrast to basis function approaches, \u03b2 is modeled directly on the pixel level, i.e. the unknown coefficient is \u03b2 = (\u03b2 1 , . . . , \u03b2 L ). Following the Bayesian paradigm, one assumes a prior distribution for all variables in model (2), assuming that \u03b1, \u03b2 and \u03c3 2 \u03b5 are independent: y \u03b1, \u03b2, \u03c3 \n.e. they are known distributions. Samples from the posterior distribution can thus be obtained by a simple Gibbs sampler. Random field priors for \u03b2 model the spatial dependence between pixels. In order to facilitate sampling from the posterior, one often chooses priors that yield simple full conditionals."}, {"section_title": "Gaussian Markov Random Fields, GMRF :", "text": "A commonly used class of priors for \u03b2 are (intrinsic) Gaussian Markov Random Fields (GMRF), which can induce smoothness and constitute a conjugate prior for \u03b2. The value of \u03b2 for a pixel l is assumed to depend only on the values of \u03b2 in the neighbourhood of l (Markov property), which can be modeled as\nthe number of neighbours of l and \u03b2 \u03b4(l) = {\u03b2 j : j \u223c l} is the set of all neighbouring coefficients of the l-th location, where j \u223c l means that the pixels j and l are neighbours Besag (1974) ; Rue and Held (2005) . The choice of the neighbourhood thus models the dependence structure in \u03b2. The common variance parameter \u03c3 2 \u03b2 is again assumed to have an IG(\u03b4\n\u03b2 > 0, which can be shown to be conjugate in this case. The prior assumption for \u03b2 can be rewritten in an unconditional form: p \u03b2 \u03c3\n\u2212 rank(P )/2 exp \u2212 1 2\u03c3 2 \u03b2 \u03b2 P \u03b2 with P \u2208 R L\u00d7L the neighbourhood matrix with p j,l = d l for j = l, p j,l = \u22121 for j \u223c l and p j,l = 0 otherwise. This is not a proper distribution, as P does not have full rank (rank(P ) = L \u2212 1). However, this prior assumption yields a proper Gaussian full conditional for \u03b2 if the data contains enough information, and hence samples from the posterior can be drawn by simple Gibbs sampling. The Bayesian approach with Gaussian Markov random field priors has an interesting correspondence to penalized basis function methods with constant local basis functions 1 l for each pixel, where the Gaussian prior corresponds to the quadratic penalty. The smoothing parameter in this penalized formulation is given by the fraction of the prior variances \u03bb =\nThe assumptions for the Bayesian GMRF models are given in terms of the priors. For the coefficient image \u03b2 the GMRF prior induces smoothness. As in the Splines model, this means that e.g. in neuroimaging adjacent brain areas have a similar association with the response without abrupt changes in \u03b2. However, the coefficient images can be expected to have more small scale structure, as smoothness is induced on the level of pixels rather than on the level of basis functions.\nSparse Gaussian Markov Random Field, SparseGMRF : The sparse GMRF method adds a variable selection aspect to the GMRF model to combine smoothness with sparsity. The basic idea here is that in general, not the full image x i will show a relevant association with the response and thus major parts of the coefficient image \u03b2 can be assumed to be zero. At the same time, the non-zero pixels of interest ideally should form smooth coherent clusters. The authors propose to combine the GMRF prior for \u03b2 with a latent binary Ising prior \u03b3 \u223c Ising(a, b). The corresponding prior for \u03b2 is given as\nwith \u03b4(0) the Dirac measure at 0. This model has an additional level \u03b3 in the hierarchical Bayesian model structure. Depending on the value of the Ising field \u03b3 in a pixel l, the corresponding \u03b2 coefficient is either set to 0 (if \u03b3 l = 0, pixel is not selected) or follows the GMRF prior distribution (if \u03b3 l = 1, i.e. pixel is selected). Samples from the joint full conditional of \u03b2 and \u03b3 can be obtained by single-site Gibbs sampling . The authors propose to choose the hyperparameters \u03c3 2 \u03b5 , \u03c3 2 \u03b2 , a and b via cross-validation with extremely short MCMC chains (e.g. 250 iterations). This model assumes the true \u03b2 image to be sparse with a few coherent smooth areas of non-zero pixels, which is modelled by a combination of a GMRF and a latent Ising field. It is particularly designed for neuroimaging data, where the assumptions translate to most image locations not being predictive for the response, while in the relevant parts of the brain neighbouring pixels have similar effects ."}, {"section_title": "Implementations", "text": "For most of the considered approaches, software implementations are available in existing Rpackages or easily made available. This was one of the inclusion criteria. The spline regression model (Splines) can be fit using the gam function for generalized additive models in the R-package mgcv Wood (2011 Wood ( , 2016 . The implementation is very flexible and can handle 2D, 3D or even higher dimensional data and many different basis functions. All wavelet-based approaches (WCR, WPLS and WNET ) are implemented in the refund.wave package Huo et al. (2014) (WCR and WPLS in wcr and WNET in wnet), heavily building on the wavethresh package Nason (2016) for calculating the transformations to the wavelet space. They all can handle 2D and 3D images with the restriction that the sidelength of the images must be the same power of 2 for all dimensions. For WNET, the glmnet package Friedman et al. (2010) is used for the elastic net part. The principal component regression approach based on splines (FPCR) is available in the function fpcr in the related package refund Goldsmith et al. (2016) . The implementation currently accepts only 2D images, but without restrictions on the sidelengths of the images. For the calculation of the eigenimages in PCR2D we use the implementation of the rank-one based approach Allen (2013) in the MFPCA package Happ (2016) which at present works only for 2D images. The reconstruction of the coefficient image\u03b2 using the estimated eigenimages and the regression coefficients can easily be done using the expandBasisFunction method in MFPCA.\nFor SparseGMRF, an R implementation of the Gibbs sampler in the supplementary files or the original article . For reasons of performance we (re-)implemented the Gibbs samplers in SparseGMRF and GMRF in C. The code is provided in the code supplement including an R interface. Both models are currently implemented only for 2D images, but can easily be extended to the 3D case by properly defining the neighbourhood structure. Usage examples for all methods are given in the code supplement of this article (https://github.com/ClaraHapp/SOIR)."}, {"section_title": "Discussion and Measures for Model Assumptions", "text": "As discussed in Section 2.1, the scalar-on-image regression model (1) in general is not identifiable, as the total number of model coefficients in most applications exceeds the number of observation units. All proposed models therefore need to make structural assumptions on \u03b2 to overcome the issue of non-identifiability and make estimation possible. However, \"we buy information with assumptions\" Coombs (1964) . This comes at the price that the estimate found by a certain model contains not only information from the data, but also from the model assumptions. It is hence important to be aware of the assumptions made and to understand how they influence the estimate."}, {"section_title": "Underlying and Parametric Model Assumptions", "text": "In the following, we distinguish between underlying and parametric model assumptions. Conceptually, this reflects two different steps of the modelling process: The underlying assumptions describe the fundamental model assumptions, such as smoothness or sparsity, and the general class of coefficient images that a model can handle, e.g. linear combinations of splines or wavelets. The parametric model assumptions reflect model-specific restrictions of the parameters in the estimation process, in terms of penalties or variable selection, in order to achieve the goals of the underlying assumptions. Although there may be some overlap between the two concepts, we believe that this distinction can be helpful for comparing and categorizing the models. For the discussed models, the underlying model assumptions can be broadly divided into three categories (cf. Table 1). They are 1. smoothness, which we interpret as neighbouring pixels having similar values, 2. sparsity, meaning that a few coefficients dominate all others and 3. projection, which reflects the assumption that the coefficient image can be expanded in given basis functions. While the latter is often motivated by technical considerations, sparsity and smoothness are very plausible assumptions e.g. in neuroimaging: If a certain number of pixels in a particular brain region shows a strong relationship with the response, one can expect that this effect carries over to the whole region rather than affecting only single, disconnected pixels. On the other hand, it is also likely that not all parts and structures of the brain or all coefficients of basis functions are equally associated with the response and some may even be completely omitted from the model by setting their coefficients to zero. The underlying smoothness assumption translates to parametric assumptions in terms of penalties on the coefficients (Splines, FPCR) or priors (GMRF, SparseGMRF ). Both enforce similarity among neighbours. In Bayesian models (GMRF, SparseGMRF ) smoothness is further affected by assumptions on the prior variance \u03c3 2 \u03b2 , which controls the variability in \u03b2. Sparsity is achieved by variable selection methods (WNET, SparseGMRF ) or restrictions on e.g. the number of principal components to include in the model (FPCR, PCR2D, WCR, WPLS) on the level of voxels (SparseGMRF ), basis functions (FPCR, PCR2D) or wavelet coefficients (WCR, WPLS, WNET ). This shows that a global, underlying assumption can be translated into different parametric assumptions, which might result in quite different coefficient images\u03b2. In other words, different parametric assumptions can aim at the same underlying assumption, but they achieve it in very different ways and not necessarily equally well. If the true coefficient image does not fulfill the assumptions, e.g. does not fall into the space spanned by the basis functions, then the estimate will be a (biased) approximation to \u03b2 in the given space. This bias cannot be detected from in-sample prediction error due to the non-identifiability of \u03b2, as different estimates\u03b2 can give equally good predictions. In order to understand how strongly the assumptions affect the estimate, we develop measures that quantify how well the underlying and parametric model assumptions are met. "}, {"section_title": "Measures for Quantifying the Impact of Model Assumptions", "text": "For better comparability, all following measures are constructed such that they take values between 0 and 1 with 0 meaning that the model assumptions are perfectly met and 1 meaning that the assumptions are not met at all."}, {"section_title": "Smoothness:", "text": "Smoothness is interpreted as neighbouring pixels having similar values. The sum of squared differences between neighbours can thus be used as a measure of smoothness. For \u03b2 \u2208 R L with a given neighbourhood structure, a natural smoothness measure is i\u223cj (\u03b2 i \u2212 \u03b2 j ) 2 = \u03b2 P \u03b2 for the symmetric and positive semidefinite neighbourhood matrix P \u2208 R L\u00d7L (see GMRF in Section 2.3). By the theorem of Rayleigh-Ritz Horn and Johnson (1985) and as the smallest eigenvalue of P is 0, we have that the smoothness measure\nwith \u03bb max (P ) the maximal eigenvalue of P lies between 0 (constant, i.e. extremely smooth image) and 1 (extremely nonsmooth images). This measure can be used to assess the smoothness of an image as an underlying model assumption and therefore can be compared over all models assuming smoothness. It can also measure the degree to which the parametric smoothness assumptions made in the GMRF based models are met. For the approaches using splines, \u03b2 can be replaced by the vector of spline coefficients (b 1 , . . . , b K ) and P \u2208 R K\u00d7K by the associated penalty matrix to measure the parametric model assumptions. Hurley and Rickard (2009) . Here\nwith m Sparsity (\u03b2) = 0 for complete inequality of \u03b2 across all pixels (very sparse case) and m Sparsity (\u03b2) = 1 indicating complete equality of \u03b2 across all entries (non-sparse case). This measure can also be applied to a coefficient vector b = (b 1 , . . . , b K ), e.g. of wavelet coefficients to measure the underlying sparsity assumption in WCR, WPLS and WNET and therefore allows a comparison between these methods. Parametric sparsity assumptions are in general implemented by variable selection methods. A sparsity measure for a coefficient vector b \u2208 R K is hence given by the proportion of non-zero coefficients in b:\nValues close to 0 indicate extreme sparsity (b \u2261 0), a value of 1 means no sparsity. The sparse GMRF approach \nwith P \u03b2 the orthogonal projection of \u03b2 onto the space spanned by B 1 , . . . , B K , P \u22a5 \u03b2 the projection onto the orthogonal complement of that space and\nA value of 1 means that \u03b2 lies completely in the orthogonal complement of the basis functions and m Projection (\u03b2) = 0, if \u03b2 is indeed a linear combination of the basis functions. For a given model, the estimate\u03b2 will always lie in the given model class. However, we will use this measure for underlying assumptions for the true \u03b2 in the simulation in Section 4.2."}, {"section_title": "Prior variability:", "text": "We use the Kullback-Leibler divergence between the (conditional) prior of a parameter and its (full conditional) posterior as a measure for the prior impact. A similar approach using the full prior and posterior densities has been proposed in the literature Itti and Baldi (2005) . Values close to 1 correspond to D \u2192 \u221e, i.e. situations where the information from the prior has little influence on the full conditional. In this case, model assumptions will in general not be met for the full conditional. By contrast, values close to 0 correspond to D \u2248 0. Here prior and full conditional are very similar, meaning that the full conditional is close to the prior assumptions.\nPrior assumptions are clearly model-specific. Therefore, this measure should only be compared within a model class.\nInterpreting the measures for an estimated coefficient image might be nontrivial in practical applications. We therefore propose to create artificial, hypothetic coefficient images, that can for example be motivated by the question of interest. The values for the estimated coefficient image can then be compared to the corresponding values for the hypothetic images to reveal e.g. differences in smoothness or sparsity. In addition, the hypothetic images can be used to generate new response values by combining them with the real data, as done in the following simulation study. Smoothness or sparsity measures for estimates obtained from this simulated data can also serve as reference values for interpreting the measures, as illustrated in Section 5."}, {"section_title": "Simulation Study", "text": "In this section, the performance of different scalar-on-image regression approaches is analyzed for various coefficient images \u03b2, reflecting the assumptions in the different models, and using real data from the Alzheimer's Disease Neuroimaging Initiative study (ADNI Weiner et al. (2015) ) that are also considered in the application in Section 5. On the one hand, this ensures that the image covariates have a realistic degree of complexity Ogden (2007, 2010) . On the other hand, this allows to study systematically which kind of features in the coefficient images can be found with the data at hand and how this translates to the measures proposed in the previous section."}, {"section_title": "Simulation Settings", "text": "The image covariates stem from FDG-PET scans, which measure the glucose uptake in the brain. The original scans were co-registered to simultaneously measured MRI scans in order to reduce registration effects Araque Caballero et al. (2015) . We use 64 \u00d7 64 subimages of the first N = 250 or N = 500 images in the original data as covariates x 1 , . . . , x N . Three example images are shown in Fig. 1 . The image size is determined by the wavelet-based methods, which require the sidelength of the images to be a power of 2. The demeaned images take values between \u22121 and 1.24. Figure 1: The first three image covariates x 1 , x 2 , x 3 after demeaning.\nWe consider four different coefficient images that reflect the main assumptions in the models (see Fig. 2 ):\n\u2022 bumpy Reiss et al. (2015) , an image with some high-peaked, clearly defined \"bumps\". It is a two-dimensional version of the bump function Donoho and Johnstone (1994) which has become a common benchmark for one-dimensional wavelet models. It is thus expected that the wavelet-based methods should be the most suitable ones for estimation.\n\u2022 pca, an image constructed as a linear combination of the first K = 5 principal components of the image covariates x 1 , . . . , x N found by the rank-one based method Allen (2013) with\nObviously, the principal component based method should work very well in this case.\n\u2022 smooth, a smooth image which corresponds to the smoothness assumption made in the splinebased models and for the Bayesian models using Gaussian Markov random fields. It is constructed as a mixture of three 2D normal densities.\n\u2022 sparse, an image that is mostly zero with two small, smooth spikes . This image corresponds to the assumption made for the SparseGMRF model.\nThe ADNI roster IDs (RID) of the subjects whose data was used for this simulation together with code for reproducing the coefficient images can be found in the code supplement (https: //github.com/ClaraHapp/SOIR)."}, {"section_title": "The response is constructed as", "text": ". . , N with \u03b1 = \u22121 as intercept, a total number of L = 64 2 = 4096 pixels and \u03b5 i chosen such that the signal-to-noise ratio\nis either equal to 4 or to 1 which corresponds to R 2 = 0.94 and 0.5 Reiss and Ogden (2007) . All eight models presented in Section 2 are considered in the simulation study. As the GMRF model with a commonly used IG(1, 1) prior for the variance parameters \u03c3 2 \u03b5 , \u03c3 2 \u03b2 , which is considered to be rather uninformative, performed poorly, we added another model, GMRF2, with a highly informative IG(10, 10 \u22123 ) prior (prior mean: 10 \u22123 , prior variance: 10 \u22129 ) for the variance parameters. The detailed settings for each of the models are given in Section 7.1 in the appendix. In total, the simulation study comprises nine different models, four coefficient images and two sample sizes and signal-to-noise ratios, each. For each setting, the simulation and analysis is repeated 100 times. A sensitivity study with varying coefficient images gave similar results, showing that the spatial distribution of features in the coefficient images has only a marginal impact on the results (see appendix, Section 7.3).\nThe resulting estimates\u03b2 and the fitted values\u0177 i =\u03b1 + L l=1 x i,l\u03b2l for each i = 1, . . . , N are evaluated with respect to the relative estimation accuracy and the relative (in-sample) prediction error\nTaking the relative errors allows to compare the results across coefficient images \u03b2 and datasets {(x i , y i ), i = 1, . . . , N } generated in different iterations of the study. A relative estimation error of 1 means that the estimated coefficient image gives equally good results as a constant image, taking the average value of the true \u03b2 in each pixel. This corresponds to a simpler model in the mean of the image covariate over pixels. Analogously, a relative prediction error of 1 means that the prediction is comparable to a simple intercept model, not taking the image information into account. Relative errors above 1 therefore are indicators for poor performance. In addition, the measures for underlying and parametric model assumptions from Section 3 are calculated for each estimate\u03b2 and -for the underlying assumptions -compared with those of the true images. As computation time plays an important role for the practical usability of the models, it is also recorded."}, {"section_title": "Results", "text": "Figures 3 to 6 show the results of the simulation study for N = 250 and SNR = 4. The settings for N = 500 and/or SNR = 1 gave similar results, which are shown in the online appendix together with example plots and predictions from all models in the N = 250/SNR = 4 setting. Overall, GMRF gives very poor results with extremely high estimation errors (median: 63.59, sd: 68.58 for N = 250/SNR = 4) and above average prediction errors (median: 0.71, sd: 64.03 for N = 250/SNR = 4). As GMRF2 performs reasonably well, this indicates that the choice of the prior for the variance parameters in Bayesian models matters and highly informative priors are required in this case. The GMRF model is therefore not considered in the following analysis. The predictive accuracy for the different coefficient images is rather constant over all models with values close to 0.05 (cf. Fig. 8 in the appendix), i.e. the models clearly perform better than the intercept model. For SNR = 1, the errors increase to values around 0.5 for all models. If the focus is only on prediction, the different models and their assumptions hence lead to equally good results. The scalar-on-image regression model, however, also aims at an interpretable coefficient image\u03b2, showing how the observed image covariates x i influence the response y i . The relative estimation error is thus of greater importance for assessing a model's ability of giving interpretable results.\nFigure 3: Relative estimation errors for N = 250 observations and SNR = 4 over all 100 simulation runs. Boxplots show the errors for all models except GMRF depending on the true coefficient image. Gray horizontal lines mark 1, which corresponds to a constant coefficient image, having the average value of the true \u03b2 image.\nAs seen in Fig. 3 , relative estimation errors can take values close to or considerably above 1, indicating poor results, even in the idealistic case of SNR = 4. In total, the error rates are lowest for smooth, meaning that this coefficient image is captured best. Except for sparse, Fig. 3 shows a lot of variation between the models, i.e. the different model assumptions indeed lead to quite different estimates with different quality. The best results are found for pca with PCR2D estimation and smooth when estimated by Splines or FPCR, hence settings in which the true coefficient image meets the models assumptions very well. This is also seen in the low corresponding measures for the underlying model assumptions, c.f. m Projection in Table 2 (relevant for pca/PCR2D) and m Smoothness in Fig. 4 (for the smooth image when estimated by Splines or FPCR). Notably, the measures for SparseGMRF and GMRF2, which assume smoothness on a pixel level, are somewhat higher, which leads to somewhat worse estimation results (cf. Fig. 3 ). While for pca and smooth the outcomes are mostly as expected in terms of best-performing methods, the result for bumpy is more surprising. One would expect the wavelet-based methods to perform best Reiss et al. (2015) . By contrast, all wavelet methods are outperformed by Splines, FPCR and GMRF2, hence methods that assume smoothness. This, however, is in line with previous results who found that wavelet methods did not clearly outperform non-wavelet methods for the bumpy coefficient image Reiss et al. (2015) . The measures for the underlying model assumptions give an explanation for this result: The bumpy image can be perfectly projected into the wavelet space, just as all coefficient images can (see Table 2 ), but has a similar sparsity in the wavelet space as pca and smooth (cf. Fig. 4) , meaning that the sparsity assumption in WCR, WPLS and WNET has no advantage for the estimation. The underlying smoothness measures for Splines, FPCR and True Coefficient Image Fig. 4 show that the resulting estimates are a bit too smooth, but they still yield better results than the wavelet-based methods. The sparse coefficient image is the most difficult to estimate, as it has two rather spiky features and the rest of the image is equal to zero. Indeed, all models have relative estimation errors close to 1, which means that the methods perform similarly as a simpler model, taking the average value of \u03b2 as a constant coefficient. In the case of sparse, the average is close to 0, hence the simpler model corresponds to a pure intercept model, without the image. Contrary to expectation, the SparseGMRF model does not clearly outperform the other models, although it involves a pixelwise variable selection step and hence the possibility to set entire areas of the image to zero. The model measures for parametric assumptions in Fig. 5 show that it produces estimates that are quite smooth, but completely non-sparse. This means that the sparsity assumption is more or less ignored in the estimation process. SparseGMRF hence behaves just as a non-sparse GMRF with the variance parameters chosen via cross-validation. This corresponds to a discrete prior with three values for each parameter, hence a highly informative prior. In order to check the agreement of the estimated coefficient images among each other and with the true \u03b2, correlations of the vectorized images were calculated, which are given in Fig. 6 . Notably, for sparse, all estimated coefficient images show medium to high correlation among themselves, but only moderate correlation with the true coefficient image. Moreover, the correlation between GMRF and all other models as well as the true coefficient image is rather weak, which reflects the extremely poor results for this model. In summary, the simulation shows that the assumptions made in the different models can lead to quite different results in terms of estimation accuracy, depending on the structure of the true coefficient image. At the same time, the predictive performance is quite similar over all models. This is a clear sign of non-identifiability, putting the interpretability of the estimates into question. For a higher SNR, the relative errors for estimation and prediction generally decrease. However, the methods still result in relatively high error rates for bumpy and sparse, coefficient images with highly localized features. In an overall comparison of the models in this simulation FPCR seems to give the best results, as it is always among the best two models in terms of estimation accuracy. Moreover, it is also by far the model with the shortest computation time (see Fig. 29 in the appendix). In particular, the combination of a spline basis representation and a principal component analysis for XB appears to be advantageous compared to the pure Splines models. Similarly, WCR performs better than the other wavelet basis methods in all settings considered in this study. As expected, PCR2D clearly outperforms all other methods for the pca coefficient image, which perfectly meets the assumptions made in this model. For all other coefficient images, the method gives intermediate results. Finally, for the GMRF based models, the highly informative GMRF2 model performs best, followed by SparseGMRF. The latter, however, does not make use of the integrated variable selection. In addition, it is computationally very demanding, as it required around 85% of the total computation time of the study, although a relatively simple setting was chosen with only three possible values for each hyperparameter."}, {"section_title": "GMRF2 in", "text": ""}, {"section_title": "Application", "text": "In this section, the scalar-on-image regression models are applied to data from the ADNI study Weiner et al. (2015) to illustrate the impact that model assumptions can have in practice. Moreover, we show how the simulation results from Section 4 can be used as reference for interpreting the measures introduced in Section 3. We use data from N = 754 subjects in the study having an FDG-PET scan and an MRI scan at baseline. Their roster IDs are given in the code supplement of this article. The aim is to find a relation between a neuropsychological test (Alzheimer's disease assessment scale -cognitive subscale, ADAS-Cog Rosen et al. (1984) ) at baseline and the FDG-PET scans, which were co-registered to the MRI scans in order to reduce registration effects. ADAS-Cog is a current standard for diagnosing Alzheimer's disease (AD). It takes values between 0 and 70, where higher values indicate worse global cognition and thus a higher risk of AD. In order to obtain approximate residual normality, the ADAS-Cog values were square root transformed before the analysis (see Fig. 36 in the appendix). For FDG-PET, which reflects the neural integrity of the brain, we use the same 64 \u00d7 64 subimages as in the simulation study for all N = 754 subjects. As additional covariates, we consider age at baseline, gender and years of education, which are known risk factors for AD. For each model, we calculate estimates\u03b1 for the scalar covariates and\u03b2 for the image covariates together with pointwise 95% credibility/confidence bands to illustrate the variability in the estimates. The results are shown in Fig. 7 for\u03b2 and in Fig. 37 for\u03b1. Details on the calculation of the credibility/confidence bands for the different models are given in Section 8.1 in the appendix. All measures for underlying and parameteric assumptions for each model are found in Table 3 in the appendix together with an illustration of the goodness of fit (Fig. 36) . All models have a very similar predictive performance, except for GMRF, which is in line with the results from our simulation study. The prediction error of around 0.6 is slightly higher than in the simulation setting with SNR = 1. The estimated coefficient images in Fig. 7 have some common features in the \"significant\" parts, i.e. pixels where the confidence bands do not contain zero, which we can interpret as data-driven: Regions with negative values are found especially in the center, in the area of the cingulate gyrus, which is related to emotion processing, learning and memory, Binder et al. (2009) and in the lower right part of the images, that can be identified with the supramarginal gyrus and thus language processing Petrides (2014) . Below-average FDG-PET values in these areas would be associated with a higher risk of AD, which is in line with the literature on early AD Minoshima et al. (1997) . Most estimated coefficient images further have positive \"bumps\" in the upper left and right part of the images, which correspond approximately to the precentral gyri and thus the primary motor cortex Binder et al. (2009) . Positive values are also found in the lower left corner in the area of the right angular gyrus, which links visual impressions to the corresponding notions Binder et al. (2009) . Above-average FDG-PET values in these areas would be associated with higher ADAS-Cog values, and thus a higher risk of Alzheimer's disease, which is more difficult to interpret. However, "}, {"section_title": "GMRF2", "text": "Figure 7: Coefficient image estimates for the application with pointwise 95% confidence bands/credible intervals. Coloured pixels correspond to \"significant\" pixels, i.e. the confidence band/credible interval in this pixel does not contain zero. Note that some pixels too many might be flagged, as the confidence bands do not account for e.g. variable selection via cross-validation and are mostly calculated on a pointwise basis. Note also the different scales for WPLS, WNET and GMRF.\nthe influence of the model assumptions is clearly seen and the percentage of the flagged pixels, their location and the shape of the \"significant\" regions differ considerably among the methods. The estimated coefficient images for FPCR and Splines are quite smooth, which is reflected in the rather low values for the underlying smoothness assumption (0.002, comparable to the true pca and bumpy images in the simulation with N = 500 and SNR = 1). The pixels flagged as \"significant\" by both models form mostly large, round shaped areas. GMRF2 and SparseGMRF induce smoothness on the pixel level rather than for basis function coefficients. The estimates resulting from these methods show more fine-scale structure, which manifests in somewhat higher measures for the underlying smoothness assumption (0.007 for SparseGMRF, 0.010 for GMRF2 ) and is in line with the results from the simulation. The parametric sparsity measure for SparseGMRF is equal to 1, meaning that sparsity is not achieved, as it was the case in the simulation study. However, when comparing the estimates, the image produced by SparseGMRF seems to be a bit blurred compared to GMRF2. This might be caused by setting the \u03b2 coefficients to zero in some MCMC iterations, shrinking the posterior mean towards zero. The fine scale structure of the estimate is also seen in the \"significant\" regions for SparseGMRF, which also contain \"non-significant\" pixels. GRMF2 does not flag any pixel at all. The wavelet-based methods show an even more pronounced small-scale structure with more abrupt changes between positive and negative values. A very characteristic feature here are the negative values in the center of the images (cingulate cortex), which might have been oversmoothed by the other models. The main assumption for all three models is sparsity in the wavelet space. The corresponding measures for the underlying model assumptions are lowest for WNET, followed by WPLS (cf. Table 3 in the appendix, best comparable to the smooth function in the simulation). This translates to a more \"spiky\" estimate in Fig. 7 . The last model, PCR2D, assumes sparsity in the principal component space. As seen for the parametric sparsity measure, the leading 20 of 25 possible eigenimages are selected by cross-validation to construct the estimate, which is relatively high compared to our simulation. What is striking here is the rectangular, \"streaky\" nature of the structures seen in the coefficient image. This is clearly caused by constructing the eigenimages based on rank-one tensor-product decompositions Allen (2013) . Overall, comparing the measures for underlying and parametric model assumptions of the estimates with reference patterns from the simulation indicates that the estimates are less smooth than the true smooth image in the simulation study and the majority of the corresponding estimates. Moreover, all methods that use principal component approaches for dimension reduction in different spaces yield estimates that require a rather high number of principal components, meaning that they exhibit a relatively complex structure. Overall, the lack of resemblance to patterns of the measures for the simulated coefficient images might indicate that none of the model assumptions for the used methods perfectly capture the structure of the true coefficient image. As in the simulation correlations are calculated between all estimates to measure similarities among the estimated coefficient images (see Fig. 38 in the appendix). The highest correlation is found between models that assume smoothness (SparseGMRF and FPCR: 92%, SparseGMRF and GMRF2 : 91%, FPCR and Splines: 90%). The GMRF estimate shows no correlation with any other method, which is also seen in Fig. 7 . There are no clear similarities in the correlation structure to any of the simulation settings. For the scalar covariates, all models except for GMRF find \"significant\" effects, as the confidence/credible intervals do not include zero (see Fig. 37 in the appendix). There is agreement between methods that the estimated intercepts and the effects for age at baseline are both positive, which makes sense as ADAS-Cog takes positive values and age is known to be a main risk factor for AD. For gender and years of education, the estimated coefficients are negative, i.e. on average, being female and a longer period of education are associated with lower ADAS-Cog values and a lower risk of AD. However, there is also notable variation between the methods, as the confidence bands do not necessarily overlap or contain the point estimates of all other methods. Note that some of the differences in\u03b1 might be related to the different coefficient image estimates\u03b2. In total, the results of the application show that while some methods used here show some common patterns in their results, they differ substantially in their details, as model assumptions have a strong influence on the results. In practical applications such as this one, this can entail the risk of over-interpreting effects that are mainly driven by the model assumptions.\nSparse GMRF pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca \nSparse GMRF pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca \nSparse GMRF pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca pca "}, {"section_title": "Discussion", "text": "Scalar-on-image regression is an inherently non-identifiable statistical problem due to the fact that the number of pixels in the coefficient image -and therefore the number of coefficients -exceeds the number of observations, in many cases by far. In order to overcome the issue of non-identifiability, different approaches have been proposed in the literature, making different structural assumptions on the coefficient image and including all forms and combinations of smoothness, sparsity or projection onto a subspace. Model assumptions mostly result from both methodological and applied considerations. In neuroimaging, one would for example assume that the coefficient image, which represents the association between the observed images and the responses, has no abrupt changes within contiguous brain regions, following human physiology. In practice, this can be achieved by minimizing differences between neighbouring coefficients. At the same time, this reduces the degrees of freedom in the estimation and mostly leads to an identifiable model under the assumptions made.\nWhereas the beneficial aspects of making assumptions are well known and understood, their impact on the estimates seems underappreciated or played down in practice. From a theoretical point of view it is obvious that models with different assumptions may lead to different estimates due to nonidentifiability. In practical applications, however, it is not always clear which model is appropriate and to what extent the model assumptions influence the results. While this is less crucial for predictions, it strongly affects the interpretability of the coefficient image estimates, as one cannot directly see whether features in the estimate are dominated by the model assumptions, driven by the data or supported by both, as one would ideally assume. In this paper, we have provided a systematic overview of the principal approaches to scalar-onimage regression and the assumptions made in the different models. The assumptions have been characterized as underlying ones, that describe the fundamental assumptions of a model, and parametric assumptions, that are expressed in terms of model-specific penalties or priors on the parameters and translate the underlying assumptions into an estimation approach. The methods discussed in this paper do not completely represent all published scalar-on-image models, but largely cover all main classes and their assumptions and focus on methods with available implementations. Variations include e.g. the LASSO-variant of WNET Zhao et al. (2015) (implemented in the R package refund.wave Huo et al. (2014) ), all types of models that combine smoothness of the coefficient image with a sparsity assumption as in SparseGMRF Huang et al. (2013) ; Shi and Kang (2015) ; Kang et al. (2018) ; Li et al. (2015) , tensor based methods as PCR2D Zhou et al. (2013) ; Miranda et al. (2018) or methods for scalar-on-function regression that can easily be extended to the scalar-on-image case Reiss et al. (2017) . All of these methods have in common that they build on a (linear) regression approach, which is obviously a strong (meta) assumption in itself. While linearity facilitates the estimation and interpretation of these high-dimensional models, it is of course questionable whether a simple linear association between image predictors and scalar responses adequately reflects the complexity in the data. Particularly in neuroimaging, the advent of highly nonlinear machine learning methods such as support vector machines Cortes and Vapnik (1995) and, more recently, deep neural networks Schmidhuber (2015) , have given rise to a vast body of literature that aims at relating imaging data (mainly structural and functional MRI) to scalar responses, with a main focus on classification Arbabshirani et al. (2017) . Making use of nonlinearity, these approaches can have a superior performance than the classical (generalized) linear regression model in terms of prediction accuracy. At the same time, a main criticism of these prediction based approaches is that they are mostly black box algorithms and therefore hardly interpretable, although first steps in this direction have been taken Ribeiro et al. (2016) . Interpretability, which is one key selling point of regression models compared to machine learning approaches, Dunson (2018) may however be strongly influenced by model assumptions, as our results show. In this case, one would ideally wish to have a diagnostic criterion that identifies problematic settings, i.e. settings in which the model assumptions dominate the estimate, in advance. This, however, seems very challenging, if even feasible. The measures proposed in this paper constitute a first step in this direction, as they quantify the degree to which the model assumptions are met by a given image or estimate. Their usage and interpretation has been illustrated in the simulation and in the case study in Section 5, showing for example that the sparsity assumption in SparseGMRF, which is particularly designed to identify predictive brain regions and set the remaining parts in the coefficient image to zero, is mostly ignored in the estimation process. In Bayesian approaches, where model assumptions are formulated in terms of priors, alternative measures have been proposed, e.g. for prior-data conflict Evans and Moshonov (2006) , prior informativeness M\u00fcller (2012) , or prior data size with respect to the likelihood Reimherr et al. (2014) . Together with our measures, they could serve as starting point for an overall measure for the appropriateness of model assumptions. However, most of these Bayesian measures are restricted to rather simple models and to proper priors. Further work is needed to be able to apply them to high-dimensional models such as scalaron-image regression, improper priors such as the intrinsic GMRF priors or non-Bayesian models that include dimension reduction or variable selection steps. For practical applications, we recommend to carefully check the assumptions in the models used. The measures proposed in this paper can help to interpret the results for real data, e.g. by relating values obtained for estimates from the observed data to the values for hypothetic coefficient images, as done in the application. Conducting simulations can also be indicative for the types of features that can be found with the chosen methods and the observed data. For the case of the FDG-PET images used in Sections 4 and 5, smooth coefficients and those lying in the span of the leading principal components were estimated quite well by methods with corresponding assumptions. At the same time, the coefficient images bumpy and sparse, which have highly localized features, are seen to be considerably more difficult to estimate with this data. Further, it seems helpful to compare the results with those of other approaches, making different assumptions, in order to find common patterns. These may help understanding which features in the estimated coefficient image are mostly driven by the data, the model assumptions or seem to combine both sources of information. Empirical confidence bands as in the application can serve as a first indicator, which regions of the estimated coefficient images might be of interest. For the ADNI data studied in Section 5, the empirical confidence bands agree most in the right upper and lower part of the images, in the area of the precentral gyrus. Within these regions of interest, one could for example check the agreement of the estimated coefficient images as an indicator of data-driven effects. The idea of combining different models is also adopted in ensemble methods, e.g. for scalar-on-function regression Goldsmith and Scheipl (2014) . A drawback of this approach, however, is that it is based on predictive performance in a cross-validation setting, which is not only associated with high computational costs, but also aims more at prediction and not at interpretability. As an alternative, one could replace the single model that incorporates the full imaging information by multiple models in separate brain locations, as commented by one of the reviewers. This of course would reduce the number of predictors in the models and therefore lower the risk of nonidentifiability. Apart from the fact that appropriate regions of interest would need to be defined, e.g. data-driven or based on medical knowledge, such an approach makes two important assumptions on its own: First, the relevant information is assumed to stem from the selected ROIs only, ignoring potentially important data in the remaining brain regions. Second, treating different ROIs in separate models implies the assumption that there is no correlation between these regions, which is also a quite strong assumption given the complexity of the human brain and thus no confounding by left-out regions. In summary, model assumptions are a necessary and helpful tool to overcome identifiability issues in complex and inherently non-identifiable models such as scalar-on-image regression. Our results show that in practical applications, it is very important to be aware of model assumptions and the impact that they can have on the coefficient estimates."}, {"section_title": "Appendix -Simulation", "text": ""}, {"section_title": "Model Settings", "text": "Splines: The unknown \u03b2 image is expanded in K x = K y = 15 cubic B-spline basis functions in each direction, penalizing the second squared differences of the corresponding coefficients. The smoothing parameter \u03bb is found via REML. The calculations can be done using the gam function in the R-package mgcv (Wood, 2011 (Wood, , 2016 . FPCR: As for the pure spline approach we use K x = K y = 15 basis functions for each marginal and choose the smoothing parameter via REML. The number K 0 of principal components retained for regression is chosen via five-fold cross-validation from {5, 10, 25, 50, 100, 150}. The model is fit using the function fpcr in the R-package refund (Goldsmith et al., 2016) . PCR2D: We calculate 25 two-dimensional principal components of the observed images using the approach of Allen (2013) as implemented in the MFPCA package (Happ, 2016) with second difference penalty for smoothing in each direction. The smoothing parameters \u03bb v , \u03bb w are chosen via GCV within the boundaries 10 \u22124 and 10 2 . The response y is regressed on the first K \u2208 {1, 5, 10, 15, 20, 25} score vectors to find the coefficients for the unknown coefficient image. An optimal choice of K is found via five-fold cross-validation. WCR: We use the function wcr in the package refund.wave (Huo et al., 2014) . The observed images are transformed to the wavelet space using Daubechies least-asymmetric orthonormal compactly supported wavelets with 10 vanishing moments. The resolution level M 0 is fixed to 3. Only the K * \u2208 {10, 25, 50, 100, 250, 500, 1000} coefficients having the highest variance are retained. The response y is regressed on the leading K 0 \u2208 {5, 10, 15, 25, 50, 75} principal components of the remaining coefficients (restricting K 0 \u2264 K * ) and the result is transformed back to the original space. An optimal combination of K * and K 0 is found via five-fold cross-validation. WPLS: The wavelet-based principal least squares method is implemented in the same function wcr of the refund.wave package, using the option method = \"pls\". For all parameters (M 0 , K * , K 0 ) we use the same specifications as for WCR. WNET : Here also we use Daubechies least-asymmetric orthonormal compactly supported wavelets with 10 vanishing moments and a resolution level M 0 = 3 to obtain wavelet coefficients from the observed images. The model is estimated using the wnet function in the R-package refund.wave (Huo et al., 2014) . As for the other two wavelet methods, the number of wavelet coefficients that are retained for the regression is chosen from K * \u2208 {10, 25, 50, 100, 250, 500, 1000}. For the elastic net part, the mixing parameter \u03b7 can take values in {0, 0.25, 0.5, 0.75, 1}, with 0 corresponding to the Ridge penalty and 1 giving the LASSO approach. Candidate values for the penalty parameter \u03bb are automatically generated by the glmnet function. An optimal combination of K * and \u03b7 is chosen via five-fold cross-validation. SparseGMRF : A constant prior for \u03b1 is used. The hyperparameters are chosen via five-fold crossvalidation from a \u2208 {\u22124, \u22122, \u22120.5}, b \u2208 {0.1, 0.5, 1.5}, \u03c3 2 \u03b5 , \u03c3 2 \u03b2 \u2208 {10 \u22125 , 10 \u22123 , 10 \u22121 }. For each parameter combination and each fold (in total 81 \u00b7 5 = 405 combinations), a short Gibbs sampling is run with 250 iterations, of which 100 are discarded as burnin (no thinning), following the settings in . For the starting values, \u03b3 l is sampled randomly from {0, 1} and if \u03b3 l = 1, \u03b2 l is sampled from N(0, \u03c3 2 \u03b2 ), otherwise \u03b2 l = 0. The pixels are updated in random order. GMRF: The prior for the unknown coefficient image \u03b2 is chosen as an intrinsic GMRF with four neighbours and for \u03b1 a constant prior is used. The priors for the variance parameters \u03c3 \u22123 ) (highly informative with a prior mean of 10 \u22123 and a prior variance of 10 \u22129 ; model GMRF2 ). For both models, the Gibbs Sampler is run over 5000 iterations, of which 500 are discarded as burnin and saving each 20th step (thinning). As a starting value, \u03b2 l is initialized with N(0,\u03c3 "}, {"section_title": "Estimated Correlation", "text": "Figure 28: Median correlation between the true coefficient images and the estimates for N = 500 observations and SNR = 1 over all 100 simulation runs. The figures show the median correlation of the vectorized images depending on the true images and the models.\nFigure 38: Correlation between the vectorized estimated coefficient images\u03b2 depending on the model used. "}, {"section_title": "Computation Times", "text": "q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q 10 100 1,000 10,000"}, {"section_title": "Model", "text": "Time in seconds q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q 10 100 1,000 10,000\nTime in seconds The results in Section 4.2 have been obtained for fixed coefficient images. As the covariate images x i do not have a constant variation over all pixels, some features of \u03b2 might be easier to find than others, notably if they are in areas with high variation and thus more information. In order to study the sensitivity of the results with respect to the spatial structure of \u03b2, a second study was conducted for N = 250 and SNR = 4 with spatially varying coefficient images. Therefore, a new coefficient image was generated in each iteration of the simulation, sampling the locations of the features randomly (for bumpy, smooth and sparse) or with a random number of principal components and randomly chosen coefficients b k (for pca). Examples for one iteration are shown in Fig. 30 . In this study, we consider all models except for GMRF due to extreme error rates in the first simulation study and SparseGMRF due to long computations. The results are given in Fig. 31 (error rates) and 35 (correlations of the estimates with the true coefficient image and across models). Boxplots of the measures for underlying and parametric model assumptions are given in Figs. 33, 34 and 32. Overall, the results are very similar to the ones from the previous simulation study with fixed image covariates. This shows that variations in the features of the true coefficient images \u03b2 have only marginal influence on the simulation results. Notable differences are found for the parametric model measures concerning principal components as well as in the results for the pca coefficient image. This is plausible, as for varying coefficient images \u03b2, different numbers of principal components might be optimal in the FPCR, PCR2D and WCR models. For pca, the higher variation can be explained by the fact that for this coefficient image, the number of eigenimages and their coefficients are resampled for generating new images \u03b2 and hence may lead to a higher variation. Figure 31 : Results of the sensitivity study. Boxplots show the relative prediction and estimation error for all seven models depending on the coefficient image over all 100 simulation runs. Gray horizontal lines mark 1, which corresponds to the simple intercept model (for prediction error) or to a constant coefficient image, having the average value of the true \u03b2 image (estimation error). All values on log-scale. Gray horizontal lines correspond to the median (solid line) and the 25% and 75% quantiles (dashed lines) for the true coefficient images.\nq q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q \nwith \u03a6 the distribution function of the standard normal distribution and se(\u03b2 l ) the standard error for\u03b2 in pixel l. For the\u03b1 coefficient, confidence intervals are constructed analogously, using the standard errors se(\u03b1 j ) produced by the summary.gam function from the mgcv package:\n[\u03b1 j + \u03a6 \u22121 (0.025) \u00b7 se(\u03b1 j ),\u03b1 j + \u03a6 \u22121 (0.975) \u00b7 se(\u03b1 j )].\nFPCR: Pointwise Bayesian standard errors for\u03b2 are calculated using the fpcr function in refund (Goldsmith et al., 2016) . In a next step, pointwise 95% Wald confidence bands are obtained in full analogy to the Splines model (6). For\u03b1, we use again the summary.gam function from the mgcv package to obtain standard errors and calculate 95% Wald confidence bands based on them as in (7). PCR2D: The confidence intervals for\u03b2 and\u03b1 are found based on a nonparametric bootstrap approach. To this end, the data was resampled 200 times and the coefficients were re-estimated using the optimal number K of eigenimages found for the original fit due to computational reasons. Pointwise confidence bands for\u03b2 and for the\u03b1 coefficients are obtained as 95% percentile bootstrap intervals. WCR/WPLS/WNET : For all three wavelet-based methods, the confidence bands for\u03b2 and\u03b1 are also based on a nonparametric bootstrap with 200 resampling iterations. For each bootstrap sample, the models are refit, using M 0 = 3 and the optimal parameters of the original fit (K * , K 0 for WCR and WPLS; K * , \u03b7, \u03bb for WNET ), similar to the case in PCR2D. The confidence bands are calculated as 95% percentile bootstrap intervals for both\u03b2 and\u03b1 on a pointwise basis. SparseGMRF/GMRF/GMRF2 : For the Bayesian methods, we construct Bayesian 95% credible intervals for each pixel in the coefficient image\u03b2 l and for each coefficient\u03b1 j based on the posterior drawings produced by the Gibbs sampling algorithm. The credible intervals are obtained as 2.5% and 97.5% empirical quantiles of the samples after burnin and potential thinning. "}]
[{"section_title": "Abstract", "text": "This report describes a new quality evaluation method for structural magnetic resonance images (MRI) of the brain. Pixels in MRI images are regarded as regionalized random variables that exhibit distinct and organized geographic patterns. We extract geo-spatial local entropy features and build three separate Gaussian distributed quality models upon them using 250 brain MRI images of different subjects. The MRI images were provided by Alzheimer's disease neuroimaging initiative (ADNI). Image quality of a test image is predicted in a three-step process. In the first step, three separate geo-spatial feature vectors are extracted. The second step standardizes each quality model using corresponding geo-spatial feature vector extracted from the test image. The third step computes image quality by transforming the standardized score to probability. The proposed method was evaluated on images without perceived distortion and images degraded by different levels of motion blur and Rician noise as well as images with different configurations of bias fields. Based on the performance evaluation, our proposed method will be suitable for use in the field of clinical research where quality evaluation is required for the brain MRI images acquired from different MRI scanners and different clinical trial sites before they are fed into automated image processing and image analysis systems.\nARTICLE HISTORY"}, {"section_title": "Introduction", "text": "Evaluation of image quality is a preliminary post-acquisition step. The quality of image acquisition devices, the necessary post-acquisition processing procedures, performance evaluation of image processing and image analysis algorithms and the level of utility of an image are determined by the outcome of image quality evaluation. Strategic imaging work-flow decisions, such as choice of imaging device, algorithms for image processing and image analysis, re-scan, reprocessing and re-analysis, are influenced by image quality evaluation. The extent to which a trained reader or an automated image analysis system can optimally extract the information contained in an image is determined by the image quality. Thus image quality assessment is a very important step in the process of utilization of an image.\nThe first step in the evaluation of image quality is the identification of manageable image quality attributes [1, 2] . These attributes expressed as quality features are then measured using different quality scores to obtain a total quality score referred to as an image quality index [3] . The goal of objective image quality evaluation is to derive an image quality metric which correlates with the evaluation by the human visual system in terms of 'fidelity', 'usefulness' and 'naturalness' [4] . Image quality can be evaluated by humans in what is referred to as a subjective method [5] or by a measuring device in what is referred to as an objective method [2] . This paper focuses on how to quantify the diagnostic information contained in structural magnetic resonance images of the brain without any reference to an original image and such that the evaluation correlates with the human visual system. Advances in image acquisition technology encouraged increasing interest in the use of magnetic resonance imaging (MRI) system images for the study of human anatomy [6, 7] diagnosis of diseases [8, 9] and the clinical trials of drugs for the treatment of neurological diseases [10] [11] [12] . The attractive feature of an MRI system is its potential to produce high-contrast images of soft anatomical structures. This potential is an ideal expectation because of the imperfections of the system components, trade-offs in system operating parameters, patient-induced artefact and operator error. The perceived visual quality of an MRI image of the brain is influenced by features that manifest in the image. The features include noise at different levels, intensity non-uniformity, acquisition artefacts, blurring, geometric distortion, lesion load and extraneous artefacts introduced by image processing and image analysis algorithms [13] . These features influence each other as well as the classical terms of perception such as sharpness, contrast and saturation, and thus makes image quality evaluation a nontrivial task [2] ."}, {"section_title": "Literature review", "text": "Several objective image quality measures have been proposed in the literature. They can be categorized into reference or reduced reference methods [13] [14] [15] [16] [17] [18] [19] and no-reference methods [20] [21] [22] [23] [24] [25] . A detailed review of image quality evaluation for a general class of images and MRI images can be found in [26] [27] [28] [29] [30] [31] [32] [33] . Despite the several contributions on image quality, the popular quality assessment metrics for medical images are the age-old techniques: root-mean-square error (RMSE), signal-to-noise ratio (SNR) and structural similarity index (SSIM) [14] . These metrics were designed to solve research problems that were not related to image interpretation but on efficient compression, storage and transmission of images. We identified six drawbacks in current automated image quality assessment methods. They are explained as follows:\n(1) Generalization of Medical Images. The popular quality evaluation metrics assume that all classes of medical images and all other natural images have the same descriptive features. Medical images exhibit characteristics such as texture, grey-scale colour, noise and homogeneity that distinguish them from each other and other classes of natural images. (2) Globalization. Different structures of the brain respond differently to the same level of distortion. Quality assessments in [14, 15, [22] [23] [24] take into account the entire image and do not allow focus towards region-of-interest. In some clinical applications, such as the study of disease progression in multiple sclerosis, the focus is detection of lesions in the white matter region. The focus changes to the cortical grey matter region in cortical grey matter atrophy measurement and to the ventricle in ventricular atrophy measurement. With global quality measures, there is the risk of non-optimal quality measure in a region which is the focus of the physician or a trained reader. (3) Distortion-Specific Bias. Many current quality assessment methods, such as [20, 22] , adopt specific type of distortion, considered as common, to evaluate the image under consideration. This approach can be said to be biased towards specific distortion, because all possible distortions combine with ideal features to manifest as image attribute [21] .\n(4) Fidelity Bias. Image quality as viewed by the human visual system can be represented in three dimensions: fidelity, usefulness and naturalness.\nResearchers have argued that the use of reference images such as in [14] for quality evaluation is a measure of fidelity and does not account for the other two attributes of image quality. (5) Limitations of Classical Statistics. All the current quality assessment metrics adopt the principles of classical statistics to describe quality attributes. Classical statistics does not account for the distinct geographic patterns of the constituent anatomic structures in medical images. The absence of spatial dependence in the description of these attributes excludes the naturalness of the image in the evaluation of image quality. The inability of popular image quality measures to perceptually distinguish different images was reported in [16] . The authors demonstrated that two images with the same RMSE can be perceptually dissimilar. They proposed a technique called null space analysis for quality evaluation. [36, 37] . After a careful review of the literature, we can say that, to the best of our knowledge, there is yet no proposed method on the application of the principles of spatial statistics to the evaluation of image quality."}, {"section_title": "Importance of automated Objective quality measures", "text": ""}, {"section_title": "Proposed quality metric", "text": "We propose a new fully automated, no-reference, objective method to evaluate the quality of MRI system images. It is based on encoding different image quality attributes with local entropy. Entropy is a direct measure of the classical image quality attributes such as luminous brightness, contrast, sharpness, noise and texture [38] . Our proposed method also exploits the similarity in the geometry of human anatomy across age, gender and race [39] [40] [41] . The human brain is regarded to be located in a fixed spatial region that exhibits distinct and organized patterns. Three geographic regions are defined to extract spatial information from the whole brain, axial slices and specific angular segments within slices in an MRI volume data. Three spatial quality models were built from brain MRI images of 250 subjects sourced from Alzheimer's disease neuroimaging initiative (ADNI) database."}, {"section_title": "Outline", "text": "This paper is organized as follows. The next section describes our methods forthe evaluation of image quality. Performance evaluation of our proposed method is in Section 3. Experimental results are discussed in Section 4. Section 5 concludes this report."}, {"section_title": "Methods", "text": ""}, {"section_title": "Data and sources of data", "text": "The proposed method utilized data from three different sources. They are T1-weighted MRI images acquired using three-dimensional magnetization-prepared rapid gradient echo (MPRAGE) images from the ADNI database. The MPRAGE images constitute the model database. The performance evaluation of our proposed method was carried out using original MRI data from NeuroRx research Inc and BrainCare Oy. The ADNI (http://adni.loni.usc.edu/) was launched in 2003 as a public-private partnership, led by the Principal Investigator Michael W. Weiner, MD. The primary goal of ADNI has been to test whether serial magnetic resonance imaging (MRI), positron emission tomography (PET), other biological markers, and clinical and neuropsychological assessment can be combined to measure the progression of mild cognitive impairment (MCI) and early Alzheimer's disease (AD). NeuroRx inc.\n(https://www.neurorx.com) is a clinical research organization dedicated to working with the pharmaceutical industry to facilitate clinical trials of new drugs for multiple sclerosis (MS) and other neurological diseases. BrainCare Oy (http://braincare.fi/) is a Tampere University of Technology spin-off company founded in 2013 to deliver personalized solutions to improve the quality of life of epilepsy patients. The organization recently concluded clinical trials for a novel mobile application and supporting solutions for long-term monitoring for epileptic patient.\nTwo hundred and fifty high-quality, high-resolution, 3D, T1-weighted MPRAGE MRI images were our choice for the model database, because images acquired using MPRAGE pulse sequence exhibit superior greywhite matter contrast compared to the conventional T1 and other structural brain MRI images [42] [43] [44] . Each slice has a thickness of 1.2 mm and a dimension of 190 \u00d7 160. Details of ADNI acquisition protocol and the initial processing steps are available in [45] . During data sourcing at ADNI website, we seek MRI data of patients with healthy and normal brains that were without lesions or with very mild lesions. For each MRI data, slices towards the most inferior and most superior sections are discarded, because they highlight more of scalp and bone structures than brain structures. There are variations in the number of useful slices for different patients. For each patient data, the index of useful slices were coded in a special function which can be called up by the algorithm during the modelling experiment.\nThere are one original T1-weighted, one T2-weighted and one Fluid Attenuated Inverse Recovery (FLAIR) images from NeuroRx research Inc. All the data from NeuroRx has same slice thickness of 2.4 mm, dimension 256 \u00d7 256 and consist of 60 slices. The images were without perceived distortion except the T1-weighted images which were originally acquired with intensity inhomogeneity. The data from BrainCare Oy are one original T2-weighted data with high lesion load and dimension 240 \u00d7 200 and another original T2-weighted image with dimension 480 \u00d7 360. They have the same slice thickness of 7.5mm and consists of 25 slices. Both data from BrainCare are without perceived distortion."}, {"section_title": "Geo-spatial model of MRI volume data", "text": "The slices that constitute an MRI volume data are assumed to be enclosed in a hypothetical geographic region (s) as described by a 3D cylindrical coordinate system of unit radius and height T shown in Figure 1 :\nwhere r and \u03b8 are the radial and angular distances of pixel locations in the foreground of each slice, respectively. The geographic region is regionalized as shown in Figure 2 by patching each slice into Q=4 equal angular segments\nwhere q = {1, 2, . . . , Q}."}, {"section_title": "Modeling experiment", "text": "There are seven steps in the modelling experiment. The outcome of the modelling experiment shows three separate Gaussian distributed quality models. Graphical description of the modelling experiment can be explained using the flow chart in Figure 3 ."}, {"section_title": "Foreground extraction", "text": "Foreground function FR extracts foreground image FI from each slice image TIM in each of the 250 MRI volume data."}, {"section_title": "Local entropy filtering", "text": "Local entropy feature image LEI is extracted from each slice using local entropy filter ENF of size 3 \u00d7 3. "}, {"section_title": "Binary transformation", "text": "The mean of the local entropy feature image is determined and used as a global threshold which transforms BT the local entropy feature image to a binary image BEI"}, {"section_title": "Local entropy classification", "text": "Binary classification BC extracts the high entropy feature image HIGH which represents the structural information in the slice. The pixel density in the high entropy region is determined from the ratio of the number of pixels in the high entropy region to the number of pixels in the foreground."}, {"section_title": "Coordinate transformation", "text": "Pixel locations in the high entropy feature image are transformed CT from the classical cartesian coordinate system to cylindrical coordinate system. The pixel locations are further segmented into four equal angular segments as shown in Figure 2 . Angular pixel density is the ratio of the number of high entropy pixels in each angular segment to the total number of foreground pixels."}, {"section_title": "Feature extraction", "text": "Three feature vectors FV are extracted from all the slices in each MRI volume data. They are whole brain angular segment pixel density X1, transverse segment pixel density X2 and whole brain pixel density X3.\n(1) Whole Brain Angular Segment Pixel Density X1. This feature vector is derived from each angular segment in a slice. Specific angular pixel density corresponding to all the slices is summed and averaged to obtain a 1 \u00d7 4 feature vector for each MRI volume data. (2) Transverse Segment Pixel Density X2. Variations in brain size across subjects within a population such as the ADNI database is the result of variation in the number of useful slices in each MRI volume data. Transverse segment pixel density is invariant to these variations. Invariance property is attained by arranging successive axial slices into four sets where each set contains, as much as possible, equal number of slices. Pixel density derived from the high entropy region in each group is summed and averaged to obtain a 1 \u00d7 4 transverse segment pixel density for an MRI volume data. (3) Whole Brain Pixel Density X3. It is derived from the pixel density of the high entropy feature image for each slice. The pixel density for the high entropy region in all the slices in a volume data are summed and averaged to obtain the whole brain pixel density for a volume data."}, {"section_title": "Quality models", "text": "Each feature vector extracted from an MRI volume data are defined within a finite interval, {0 \u2264 x \u2264 1}. Furthermore, each feature vector can be regarded as a random variable drawn from each of the 250 MRI volume data in the model database. Their mean and variance are finite. According to the central limit theorem, the distribution will tend to a Gaussian [46] [47] [48] . Figure 4 shows five histogram distributions of the whole brain pixel density feature vector fitted with normal data. Each distribution was derived from 50, 100, 150, 200 and 250 MRI volume data. We choose to transform histogram distribution of each feature vector based on 250 MRI volume data into quality model, because it potentially captures, as much as possible, the structural information across age, gender and race. The three quality models were named after the feature vectors: whole brain angular segment pixel density X 1 , transverse segment pixel density X 2 and whole brain pixel density X 3 . The mean value for the low and the high entropy areas for the whole brain pixel density are 0.4734 and 0.5471, respectively. This is in agreement with the results reported in [49] for the grey matter, white matter and cerebrospinal fluids. The Gaussian distributions for each feature model were centred at the mean of the random variables. The standard deviation was estimated using the principle of threesignal rule [50] ."}, {"section_title": "System operation", "text": "The algorithm was implemented in the MatLab computing environment. The flow chart in Figure 5 and the images displayed in Figure 6 explain how our proposed method predicts image quality. The test image TIM in Figure 6 (a) is rotated by 180 degrees as shown in Figure 6 (b) so as to be in the same orientation as the model images in the image database. Foreground extracted from the rotated image is shown in Figure 6 (c). Local entropy feature image of the test image computed using a 3 \u00d7 3 local entropy filter is shown in Figure 6 (d). Figure 6 (e,f) show the low and the high entropy regions extracted from the local entropy feature image by binarization using the mean of the local entropy feature image as global threshold. Three geospatial feature vectors are extracted FEX from the high entropy feature images of the slices in the MRI volume data. The feature vectors are whole brain angular segment pixel density x1, transverse segment pixel density x2 and whole brain pixel density x3. Each feature vector is used to standardize Z1, Z2, Z3 corresponding Gaussian distributed quality model X1, X2, X3 which were derived during the modelling experiment. This gives three corresponding standard scores S1, S2, S3 and normal distributions:\nwhere s X 1 , s X 2 and s X 3 are the estimate of the standard deviation for each quality model. Cumulative distribution function P1, P2, P3 for each standardized score gives corresponding three quality scores Q1, Q2, Q3 of the test image:\nThe whole brain angular segment pixel density quality score, transverse segment pixel density quality score and the whole brain pixel density quality score are displayed in Figure 6 (g)-(i). The whole brain pixel density quality score expresses the quality score of individual slices in the MRI volume data."}, {"section_title": "Experimental results", "text": "Quality evaluation was carried out on the test images in their original state and in their noisy and blurred versions. Two separate and identical Gaussian noise levels were generated to simulate the real and imaginary components in the complex plane of MRI acquisition process. Rician noise was added to the data by computing the magnitude of the complex data. The Rician noise level was based on the maximum pixel intensity level of the test image [51] . The noise levels range from 0 % to 9%. Motion blur was induced on a data by convolving it with a special filter that approximates the linear motion of a camera. The linear motion Figure 5 . The flow chart of our proposed method for quality evaluation of brain MRI images. Feature vector FV extracted from a test image is transformed FT to three separate random variable x1, x2 and x3. These random variables are used to standardize Z1, Z2, Z3 corresponding Gaussian distributed quality model X1, X2, X3 which gives normally distributed quality models S1, S2, S3. Cumulative probability distribution P1, P2, P3 for each standardized score gives corresponding quality scores Q1, Q2, Q3.\nis described by two parameters, the linear distance in pixels and the angular distance in degree as defined in [52] . Both parameters were scaled from 1 to 15."}, {"section_title": "T2 MRI volume data without perceived distortion", "text": "Quality evaluation results for T2-weighted MRI volume data from BrainCare are displayed in Figure 7 . Peri-ventricular and white matter lesions are visible in the slices shown in Figure 7 (a)-(c). The whole brain angular segment pixel density, transverse segment pixel density and whole brain pixel density quality scores for 10 successive slices in the MRI volume data are displayed in Figure 7 (d)-(f), respectively. Figure 8 (a)-(c) are slices in a FLAIR volume data from NeuroRx. The whole brain angular segment pixel density, transverse segment pixel density and whole brain pixel density quality scores are displayed in Figure 8 (d)-(f), respectively."}, {"section_title": "FLAIR MRI volume data without perceived distortion", "text": ""}, {"section_title": "Motion blur degradation", "text": "The image in Figure 9 (a) is one of the 60 slices in the T2-weighted MRI volume data from NeuroRx. The image in Figure 9 (b) is the same image in Figure 9 (a) but degraded by motion blur level=5. The blur level on the same image is significantly increased to 10 and 15 as shown in Figure 9 (c,d). Whole brain angular segment pixel density, transverse segment pixel density and whole brain pixel density quality scores of the MRI volume data for blur levels from 1 to 15 are displayed in Figure 9 (e)-(g), respectively."}, {"section_title": "Noise degradation", "text": "Figure 10(a) shows a slice in a T2-weighted MRI volume data without perceived distortion from BrainCare. The same slice in Figure 10 (a) is shown in Figure 10 (b)-(d) with 4 % , 7 % and 9% levels of Rician noise. Whole brain angular segment pixel density, transverse segment pixel density and whole brain pixel density quality scores for different levels of Rician noise are displayed in Figure 10 (e)-(g), respectively. Figure 11 demonstrates quality evaluation on T1-weighted MRI volume data from NeuroRx. The MRI volume data were acquired with different configurations of intensity inhomogeneity. Six slices in the MRI volume data are displayed in Figure 11 (af). whole brain angular segment pixel density, transverse segment pixel density and whole brain pixel density quality scores are displayed in Figure 11(g-i) , respectively."}, {"section_title": "Intensity inhomogeneity", "text": ""}, {"section_title": "Discussion", "text": ""}, {"section_title": "Focus towards region-of-interest", "text": "Our proposed method assess image quality at three levels of spatial information. In the first level, the image quality is predicted from each whole slice in the MRI volume data. This is expressed by the whole brain pixel density quality score for each slice. Whole brain pixel density quality score for the MRI volume data is predicted from the average of the whole brain pixel density quality scores for all the slices in the MRI volume data. The next level of spatial information assigns equal number of successive axial slices in an MRI volume data into four separate groups and assigns quality score to each group. The quality score is referred to as transverse segment quality score. The third level of spatial information is the whole brain angular segment pixel density. Each slice in an MRI volume data is partitioned into four equal angular segments. Quality score is assigned to each segment in a slice. Whole brain angular segment quality score is predicted from the average of a specific angular segment across slices in the MRI volume data. The third level of spatial information encourages focus towards region of interest, as combinations of angular segments can describe specific geographic region of the brain. The two angular segments that lie from 180\n\u2022 through 270\n\u2022 to 360\n\u2022 describe the frontal lobe of the brain. The remaining two angular segments that lie between 0 \u2022 and 180 cover the region described by the parietal lobe of the brain. Furthermore, the two angular segments that span 270\n\u2022 through 360\n\u2022 are the left hemisphere of the brain, while the right hemisphere is the region described by the angular segments from 90"}, {"section_title": "Correlation across images with acceptable quality", "text": "The plots in Figures 6-8 show that our proposed method can fairly predict the quality of slices in an MRI volume data. The whole brain pixel density quality score in Figures 6(i) , 7(f) and 8(f) expresses the quality scores of individual slices in the MRI volume data. Since these images under investigation are without any perceived distortion, our proposed method can be said to reveal the variations in image quality between individual slices in an MRI volume data. Average whole brain pixel density quality scores of 0.9, 0.5 and 0.8 predicted for the MRI volume data in Figures 6-8 are in agreement with the status of acceptable quality assigned to the test images."}, {"section_title": "Correlation with variations in image quality", "text": "Our proposed method can objectively differentiate images having different levels of image quality. Quality prediction shown in Figure 9 (e)-(g) for motion blur degradation and Figure 10 (e)-(g) for Rician noise degradation show correlation between quality index predicted by our proposed method and the different levels of degradation. In Figure 9 (g), the predicted image quality varies from 0.9 to 0.3 for successive blur degradation which varies from 1 to 15. The plots in Figure 10 (g) also show correlation between predicted quality scores that varies from 0.95 to 0.6 and the different levels of Rician noise which varies from 0 to 9%."}, {"section_title": "Incorporation of fidelity, usefulness and naturalness", "text": "The design philosophy behind our proposed method incorporate fidelity, usefulness and naturalness. The usefulness is derived from the use of brain MRI data from subjects across age, gender and race to build quality models. The fidelity property comes from comparing a test data with the quality models. The naturalness is derived by the use of local entropy filter to describe spatial correlation between constituent anatomic structures."}, {"section_title": "Interpretation of proposed quality score", "text": "The interpretation of quality score predicted by our proposed method is based on the probability scale. Thus we recommend quality score threshold of 0.4 to determine if a slice is of acceptable quality or without acceptable quality."}, {"section_title": "Absence of comparative performance evaluation", "text": "Image quality evaluation methods proposed for a general class of images will require significant modification before they can be applied for quality evaluation of medical images including brain images [53] . Existing quality evaluation methods adopt different distortion models. Our proposed method is based on a quality model that is different from the quality models adopted by existing quality evaluation methods for brain MRI images. There are many definitions of PSNR, SNR and MSE, which makes it difficult to compare quality measures from different imaging systems, modalities and researchers [54] . Performance evaluation results reported in the literature are both model and data dependent, because the different techniques are evaluated on different types of image data [55] . These factors make it difficult for us to carry out comparative performance evaluation of our proposed method."}, {"section_title": "Conclusion", "text": "In this report, we propose a new method to evaluate the quality of brain MRI images. It is based on the use of entropy to encode classical image quality attributes. Geo-spatial statistics of local entropy features exploit the geometric similarity of human anatomy across age, gender and race to build three quality models from model images provided by ADNI. A MRI image is evaluated based on how its extracted feature compares with a corresponding quality model. Our proposed method incorporates directional information and spatial dependencies of anatomic structures and this encourages image quality evaluation based on region-of-interest. Quality measures account for structures such as the cortical grey matter and the contrast between the constituent anatomical structures. Based on the test data and the performance evaluation of our proposed method, we are optimistic that our proposed method can be used for quality evaluation in clinical research organizations to assess longitudinal brain MRI images acquired from different scanners and different clinical trial sites. In the future, we intend to acquire more test data for performance evaluation on more types of distortion such as geometric distortion, slice thickness deviation, slice non-uniformity and high-contrast spatial resolution. Future work will also include subjective evaluation by radiologists in the performance evaluation. "}]
[{"section_title": "Introduction", "text": "Image segmentation is the process of dividing an image into its constituent non-overlapping components [1] [2] . This can be done in various forms such as labeling each pixel as a member pixel of each component. This labeling process relies mainly on gray value of pixels. Manual segmentation of images seems to be the first approach but it suffers from a few imperfections. First of all, it is highly time consuming\nand for large databases of images seems to be impossible. [7] [8] [9] [10] .\nIn order to overcome abovementioned restnctlOns and designing powerful segmentation algorithms, the use of problem specific information and involving expert's knowledge (radiologists) seems to be beneficial [7] . [n between the various methods used for brain MRI segmentation, the unsupervised Bayesian method has yielded acceptable results [11] [12] . Therewith, rule based fuzzy method has been accepted as a method of involving experts' knowledge in brain MRl segmentation [13] [14] . [n the following, section 2 explains the method used in this paper. Subsection 2.1 interprets Bayesian method and subsection 2.2 describes the fuzzy part of algorithm. [n section 3 the simulation results are described and compared with the segmentation method implemented in SPM [15] .\nFinally section 4 discusses the achieved results. "}, {"section_title": "Bayesian method", "text": "Bayesian classifier is an unsupervised classifier designed based on Bayes' probability formula (equation I).\n( I )\n[n which pew) is the priori probability of class w, p(xlw) is the likelihood probability, p(x) is the probability of gray value x and p(wlx) is the posterior probability which makes the final classification. Each gray value x is classified as a member of class w if the posterior probability of it is highest in between all other classes. p(x) is constant for all the classes and so the classification result is independent of it.\nIt has been shown that the distribution of gray values in all the tissues is normal and the expectation maximization (EM)\nis used for calculating these likelihood probabilities [16] [17] .\nIt is constituted of two iterative steps, Expectation and Maximization. In expectation step (E-Step) given the current estimate of distribution parameters, the conditional posteriori probability of w is calculated using Equation (I).\nIn maximization step (M-Step) based on the last classification performed in expectation step (E-Step), it\ncalculates new values of distribution parameters as well as a priori probability.\nGiven the normal distribution of intensities for each of brain tissues, there are two following steps E-Step:\nM-Step:\nE-Step aims to calculate the posteriori probabilities based on current estimate of distribution parameters and M-Step recalculates distribution parameters based on new posteriori probability. This iterative algorithm runs until converges.\nThe convergence criterion is a minimum value for Mean Square Error (MSE) or a specified number of iterations."}, {"section_title": "The proposed method uses EM for maximizing likelihood in", "text": "Bayesian classifier and at the end of this phase the classification result yields the segmented MR image."}, {"section_title": "Fuzzy method", "text": "Herein, the fuzzy classifier at second phase of the algorithm are the most important fuzzy rules are used in the algorithm.\n\u2022 If\"neighbors are WM\", then \"new center is WM\"\n\u2022 If\"neighbors are GM\", then \"new center is GM\"\n\u2022 If\"neighbors are CSF\", then \"new center is CSF\"\n\u2022 If \"neighbors are WM\", then \"new center is not a CSF\"\n\u2022 If \"neighbors are CSF\", then \"new center is not a"}, {"section_title": "WM\"", "text": "If \"old center is WM\" AND \"number of new objects is more than old ones\", then \"new center is WM\"\nIf \"old center is GM\" AND \"number of new objects is more than old ones\", then \"new center is"}, {"section_title": "GM\"", "text": "If \"old center is CSF\" AND \"number of new objects is more than old ones\", then \"new center is CSF\"\n\u2022 If \"neighbors have opposite separated WM objects\", then \"new center is WM\"\n\u2022 If \"neighbors have opposite separated GM objects\", then \"new center is GM\"\n\u2022 If \"neighbors have opposite separated CSF objects\", then \"new center is CSF\""}, {"section_title": "Results and discussion", "text": "Proposed method is tested on 10 simulated MR images of Brainweb and also on 10 real MR images of ADNI. The gold standard is the manually segmented version of these images. To evaluate the algorithm on each image, the similarity index [20] is used as the accuracy measure.\nAverage similarity index achieved in simulated images is 82% for SPM and 87.7% for proposed one. This can be shown in Fig. I . Better segmentation achieved in our algorithm is visually manifest (e.g. in areas indicated by rectangles in Fig. 1 ). This can be a visual reason for higher similarity index of our algorithm.\nIn a similar manner, average similarity index achieved in real images is 79% for SPM and 89.4% for proposed one.\nThis can be shown in Fig. 2 . Accordingly, better segmentation achieved in proposed algorithm is visually manifest (e.g. in areas indicated by rectangles in Fig. 2) which express the higher similarity index of our algorithm. Both experiments show that using proposed algorithm can increase the accuracy of segmentation with respect to the Ashburner's one implemented in SPM. This can be because of using problem specific information and expert knowledge in improving segmentation results."}, {"section_title": "Conclusion", "text": "Proposed method uses problem specific information and expert knowledge in segmenting Brain MR Images. This information enables it to make some improvements on misclassified voxels especially in border areas. The major advantage of using rule based fuzzy system in ameliorating segmentation results is its flexibility in incorporating new knowledge into the algorithm. This can be done by simply updating the fuzzy rules in the knowledge base.\nAs a suggestion for future work, it seems that using 3D MR images and 3D neighboring system can improve the segmentation power of the algorithm. This improvement is the result of using adjacent slices in configuring the neighboring system."}]
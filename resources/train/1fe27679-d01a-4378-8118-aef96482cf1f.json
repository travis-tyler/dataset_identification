[{"section_title": "Abstract", "text": "Recently, there has been increasing research to discover genomic biomarkers, haplotypes, and potentially other variables that together contribute to the development of diseases. Single Nucleotide Polymorphisms (SNPs) are the most common form of genomic variations and they can represent an individual's genetic variability in greatest detail. Genome-wide association studies (GWAS) of SNPs, high-dimensional case-control studies, are among the most promising approaches for identifying disease causing variants. METU-SNP software is a Java based integrated desktop application specifically designed for the prioritization of SNP biomarkers and the discovery of genes and pathways related to diseases via analysis of the GWAS case-control data. Outputs of METU-SNP can easily be utilized for the downstream biomarkers research to allow the prediction and the diagnosis of diseases and other personalized medical approaches. Here, we introduce and describe the system functionality and architecture of the METU-SNP. We believe that the METU-SNP will help researchers with the reliable identification of SNPs that are involved in the etiology of complex diseases, ultimately supporting the development of personalized medicine approaches and targeted drug discoveries."}, {"section_title": "Introduction", "text": "sequences. Among those variations, the most frequently observed are changes at single nucleotide level, called Single Nucleotide Polymorphisms (SNPs, pronounced snips), when occurred in over 1% of a given population. Recent developments in genotyping technologies, public access to whole genome and other genetic information and the start of the International HapMap Project [1] , [2] have facilitated the implementation of SNP based GWAS.\nInvestigating the genetic factors associated with the complex diseases and determining the contribution of multiple genes on a disease phenotype require working with a considerably large number of SNPs and individuals in a typical GWAS setting. Currently, it is infeasible to gather information and perform analysis on all of the SNPs in the human genome that are estimated to be around 30 million 1 In order to identify an informative SNP subset it is required to prioritize the SNPs according to well-defined criteria so that biologically more relevant SNPs are not overlooked among statistically significant SNP set. An intelligent way of performing such a prioritization is to develop a scoring mechanism for each SNP that would reflect SNP's biological and statistical relevance. Such an endeavor requires the employment of integrative approaches by incorporating information from biological databases to determine and rank the SNPs with high statistical association according to their potential for effecting biological functions.\n. This problem presents itself at three different levels: (1) the selection of the set of SNPs to be included in case-control based GWAS, (2) the prioritization of thousands of SNPs that are statistically found to be associated with the phenotype, (3) the identification of the smallest set of SNPs (informative SNPs) that can be utilized as a biomarker panel of the phenotype for downstream applications.\nThis study presents an integrated software application called METU-SNP, which is specifically designed for use in SNP based GWAS. METU-SNP is a java based desktop application, which provides state-of-the-art Analytic Hierarchy Process (AHP) based SNP prioritization and Gene Set Enrichment Analysis frameworks. It is also equipped with machine learning based feature selection schemes for further reducing the data dimension. The METU-SNP database gathers data from major public databases such as dbSNP [3] , Entrez Gene [4] , KEGG [5] and Gene Ontology [6] . Graphical User Interface (GUI) of METU-SNP offers access to the functionality provided by well-known third party tools utilized for GWAS such as PLINK [7] and BEAGLE [8] .\nThe system architecture, components of the graphical user interface and capabilities of METU-SNP are presented in the following sections along with a case study."}, {"section_title": "2", "text": "System Overview"}, {"section_title": "Availability", "text": "METU-SNP software is publicly accessible at http://metu.edu.tr/~yesim/metu-snp.htm. The website also contains video tutorial and help files. The integrated database is required for prioritization and gene/pathway based functionality and it is offered as an SQL dump file 2 In order for a flawless installation and execution of the software, the following requirements should be satisfied for the platform:\n.\n\u2022 Java Runtime Environment 5.0 or above, \u2022 MySQL 5.0 or above, \u2022 At least 5 GB free disk space,\n\u2022 At least 2GB RAM."}, {"section_title": "Functionality", "text": "METU-SNP provides the life scientist with an all-in-one tool for the case-control studies of SNP genotyping data from both microarray and next generation sequencing experiments. The raw GWAS data can be processed till an informative SNP subset, which is both statistically and biologically relevant for the phenotype under investigation, is achieved. Significant genes and pathways are also listed as an output at the end of the analysis. METU-SNP GUI is designed to guide the user through a step-by-step analysis process as depicted in Figure 1 . GUI consists of 6 tabs corresponding to each steps of the analysis: (1) configuration, (2) preprocess, (3) genome-wide association, (4) SNP prioritization, (5) SNP selection and (6) performance. "}, {"section_title": "Configuration", "text": "In the configuration step the user defines the mysql database name, user name/ password and the location of the GWAS case-control data files for use in the subsequent analysis steps. Data files should be in the form of pedigree (ped) and map format User is also given the option to define test data for prioritization and selection steps. Separated test sets can be used in k-fold cross validation runs at the performance step."}, {"section_title": "Preprocess", "text": "In the preprocessing step user is able to apply quality control (QC) based filtering and imputation on the raw SNP genotyping data, which usually includes redundant SNPs and individuals that do not satisfy certain thresholds such as minor allele frequency, missingness and Hardy Weinberg equilibrium. A comprehensive guide containing further information on the thresholds is provided on PLINK website 4 After specifying QC thresholds, user is given the option to impute the data with high missing rate by utilizing BEAGLE software. A threshold for allelic r 2 (default being 0.95) can be specified in order to include only well imputed markers in subsequent analysis. In order to provide an overview for the data after filtration, a set of descriptive statistics files, which are created as output during PLINK based QC analysis is provided.\n. The same default values of PLINK (0.05 for minor allele frequency, 0.1 for SNP missingness rate, 0.1 for individual missingness rate and 0.001 for Hardy Weinberg equilibrium) are set for METU-SNP as the most commonly used parameters for GWAS. User is able to change these values easily from the user interface."}, {"section_title": "Genome-wide Association", "text": "Third step in METU-SNP based analysis is the determination of the statistical significance of SNPs by calculating p-values of association. Depending on user's choice, three different methods can be used to calculate p-values: (1) uncorrected, (2) Bonferroni [9] and (3) False Discovery Rate [10] . The latter two approaches include adjusting for multiple testing. Depending on the threshold set by the user, SNPs are labeled as significant 5 Next, a second wave GWAS is performed by calculating the combined p-values as described in [11] , to reveal statistically significant (enriched) genes and pathways. Fisher's combination test is applied to combine p-values of all SNPs within a gene, where the statistics for combining K SNPs is given by or not in the related database table. Most widely accepted threshold for p-value is 0.05 and it is set as default. However according to the requirements of the analysis, it is possible to specify other threshold values as well.\n= \u22122 \u2211 =1 , which follows 2 2 distribution. In order to determine the overrepresentation of significantly associated genes among all genes in a pathway, the hypergeometric test (Fisher's exact test) is used. Assuming that total number of genes is N, the number of genes that are significantly associated with the disease is S and the number of genes in the pathway is m; p-value of observing k-significant genes in the pathway is calculated by:\nDepending on the calculated statistics, user is able to label genes and pathways as significant. ( 2) the number of significant genes and (3) the proportion of significant genes. We regard pathways as a combination of genes. Therefore, in addition to the combined p-value it is also possible to determine the enrichment of the pathway by evaluating how many significant genes there are within the pathway or proportion of significant genes over all the genes associated with the pathway. Following this step, three output files are created as explained in Table 1 . "}, {"section_title": "SNP Prioritization", "text": "SNP prioritization functionality utilizes our novel AHP based prioritization scheme 6 . This is an intelligent scoring mechanism that takes statistical and biological information into account for ranking SNPs after GWAS. AHP based prioritization involves forming a multihierarchical tree structure in which genomic location, molecular pathway data, disease annotation data and statistical information (GWAS p-value association and gene set enrichment analysis findings) are integrated. Weight scores are calculated for each leaf node, following a pair-wise comparison between nodes in the same level of the tree. In order to calculate the final score, which will guide the ranking of SNPs in the prioritization process, an indicator function I k (SNP i ) is used as follows:\nThe final score (SNP ) can be calculated for a particular SNP by using:\nwhere m denotes the number of SNPs for which AHP scores are calculated and W denotes the weight vector for leaf nodes.\nSNPs are ranked in a descending order according to the AHP scores where top ranking SNP is predicted to have the highest priority for the study. Two supplementary output files are created that presents the details of related SNP-gene-pathway information and DO-GeneRIF information inherent in the database structure (Table 2 and 3) . "}, {"section_title": "SNP Subset Selection", "text": "The functionality used to select a subset of SNPs to represent the whole set, is based on our novel Simulated Annealing (SA) based selection algorithm [12] . SA algorithm depends on a machine learning approach in order to further decrease data dimension without interfering the prediction performance of resulting SNP set. We have set our goal as to find the minimal set of representative SNPs for which the prediction error of selected SNP set over unselected set is minimized and used the following objective function:\nwhere n denotes the cardinality of the overall SNP set, denotes genotype data related with representative SNP set R of cardinality k and denotes genotype data related with \u2208 \\ .\nNaive Bayes classifier is set as default and additional classifiers offered by WEKA 7 7 http://weka.sourceforge.net/doc/weka/classifiers/Classifier.html can also be used. Current version of METU-SNP only supports those WEKA classifiers, which can handle multi-valued nominal attributes. A SNP subset is created as an output, which can be regarded as the minimal set of representative SNPs with competitive prediction accuracy."}, {"section_title": "Performance", "text": "The prediction performance of the resulting SNP subsets after AHP based prioritization and SA based selection steps can be measured in the final step of METU-SNP analysis. WEKA based classifiers supporting multi-valued nominal attributes can be used as supervised learning methods for performance measurement. At the initial configuration step of METU-SNP a test set has to be separated for the performance measures to be calculated.\nAdditionally, in order to measure the prediction performance of SNP sets created at either prioritization or selection step, METU-SNP creates an output file that contains certain classification measures such as correctly classified instances, incorrectly classified instances, Kappa statistic, mean absolute error, root mean squared error, root relative square error and confusion matrix (Figure 2 ). "}, {"section_title": "3", "text": "System Architecture METU-SNP is a Java based desktop application written with Java Swing GUI (Graphical User Interface) architecture using JDBC to interact through mysql databases (Figure 3 ). The application can be installed and run on a stand-alone computer in which Java Run Time Environment and MySQL database is previously installed."}, {"section_title": "Third Party Tools", "text": "In a typical GWAS, researcher basically follows a 4 step process: (1) a large number of individuals with disease or another trait of interest alongside with a suitable comparison group is selected, (2) in order to assure high genotyping quality, DNA isolation, genotyping and data review is performed, (3) statistical tests are applied to observe the association between SNPs and disease/trait, (4) significantly associated SNPs are prioritized and a representative SNP subset is selected,(5) Fine mapping to DNA locus and biological interpretation is performed. Many software tools such as PLINK, BEAGLE, SNPTEST [13] and GENABEL [14] have been developed recently that could be utilized for step 2 and step 3. METU-SNP specifically aims to support steps 4 and 5, where SNP prioritization and biological interpretation is automated. So, functionality offered by third party open-wares geared towards step 2 and step 3 is utilized to complement unique functionalities offered by METU-SNP to build an integrated system for GWAS. The logical flow of the METU-SNP system and integration of third party tools is presented in Figure 4 ."}, {"section_title": "PLINK", "text": "PLINK is an open-source whole genome association analysis toolset that offers immense set of functions for GWAS including: data management, summary statistics for quality control, population stratification detection, basic association testing, copy number variant analysis, meta-analysis, result annotation and reporting. In METU-SNP framework PLINK is used: (1) to divide the genomic data into chromosomal units to comply with BEAGLE format for imputation, (2) to perform quality control based filtering to exclude the SNPs or individuals that do not satisfy user defined thresholds, (3) to determine p-value association statistics, (4) to complete certain data management tasks, such as extracting set of SNPs, individuals etc., which is challenging to due to the size of the data sets with other tools.\nPLINK is essentially utilized in two major steps of the analysis process: (1) quality control based filtering and (2) association analysis."}, {"section_title": "BEAGLE", "text": "Imputation is a statistical method to substitute a calculated value for a missing data point and can be used to replace missing/un-genotyped data when percentage of the missing values exceeds a certain threshold specified by the researcher. Lately, imputation is becoming a part of the GWAS. Various methods have been proposed to predict sporadic missing data by imputation [15] and it has been used in the meta-analysis of different diseases and traits [16, 17] . Several software programs have been developed so far to account for the missing data in genetic data sets. Among those are BEAGLE, IMPUTE [13] , MACH, fastPHASE [18] and PLINK. We have chosen to integrate BEAGLE's imputation routine, which is based on [20] provides genomic coordinates of highly conserved elements across multiple species, allowing for the identification of SNPs overlapping with evolutionarily conserved regions of the human genome. Additionally, information related with mouse ECR (Evolutionary Conserved Regions) values originally extracted from ECRBase [21] are integrated into METU-SNP database and used within prioritization scheme."}, {"section_title": "Gene Data", "text": "Gene related information is extracted from NCBI Entrez Gene [22] and Entrez Gene ID is used as the primary key for identifying a particular gene. SNP-Gene associations are extracted from NCBI and dbSNP. 45,379 genes are annotated and relevant information is organized in the database as shown in Table 5 . "}, {"section_title": "Pathway Data", "text": "Gene and pathway information is integrated from major biological repositories. A summary of the integrated resources is presented in Table 6 .\nPathway-based analysis of GWA data is emerging as a useful tool for discovery of underlying molecular mechanisms of diseases associated with particular SNP biomarkers. In second wave GWAS, where combined p-value approach is used to identify associated genes and pathways to a phenotype; it is assumed that markers underlying a disease or phenotype are enriched in genes acting within the same pathway.\nFor each particular pathway suggested, METU-SNP provides the gene IDs within the pathway and an URL link to the listed pathway that would help researcher to reach external information. Table 7 presents an example for the type of information that is held within the database structure. "}, {"section_title": "Disease Data", "text": "We have utilized the GeneRIF-Disease Ontology (DO) mapping approach to construct our gene-disease association tables. It is suggested that GeneRIF-Disease Ontology (DO) mapping performs better than OMIM when the prediction performances are compared [23, 24] . Mapping process is illustrated in Figure 6 , where the association between Gene ID: 7040 and DO ID: 2585 is shown.\nWe have adopted the mapping format of the relational database at DO-RIF project page of Northwestern University 8 . The summary statistics of the annotation data residing in our database is presented in Table 8 . "}, {"section_title": "Results and Discussions", "text": "In order to evaluate the usability and performance of METU-SNP we used two real life GWAS data sets. The first data set was the whole genome association Rheumatoid Arthritis (RA) data from the North American Rheumatoid Arthritis Consortium (NARAC) including 868 cases and 1,194 controls. The NARAC data was used in the Genetic Analysis Workshop 16 (GAW 16) previously. It consists of 501,463 SNP-genotype fields from the Illumina 550K chip. The second data set was whole genome association data for Alzheimer's disease (AD) from the Alzheimer's disease Neuroimaging Initiative (ADNI) database. The ADNI data used included 149 AD cases and 182 controls. It consists of 555,850 SNP-genotype fields from the Illumina 610 Quad chip.\nMETU-SNP based analysis successfully identifies statistically significant SNPs, genes and pathways for the data sets under consideration. The novel AHP based algorithm is implemented and used for the prioritization of SNPs that are both statistically and biologically relevant. Next, the dimension of the SNP set is further decreased by applying machine learning based SA algorithm. Finally, the prediction performance for the resulting SNP sets is calculated and the results are cross-checked with the current literature."}, {"section_title": "Analysis Results", "text": "Quality control based filtering is applied by using following thresholds: minor allele frequency = 0.05, SNP missingness rate = 0.1, individual missingness rate = 0.1, Hardy Weinberg Equilibrium = 0.001. Missing markers are handled by imputation and test sets are separated to measure the prediction performance of the prioritized sets for both data sets. After the preprocessing step, the number of SNPs is decreased from 555,850 to 517,003 for the AD data with 112 cases and 121 controls separated for the training set and 22 cases and 27 controls for the test set, and from 501,463 to 473,613 for the RA data with 522 cases and 716 controls for training set and 180 cases and 232 controls for test set.\nFollowing the preprocessing step, the association study is performed and p-values are calculated for individual SNPs. Multiple hypothesis correction using false discovery rate is only applied to RA data as results were too conservative for ALZ data set. Additionally, statistically significant genes and pathways are determined by the combined p-value approach as stated in Section 2.2.3. We used p-value of 0.05 as the threshold of significance for SNPs, genes and pathways. Top 5 significant SNPs, genes and pathways according to p-values are presented in Tables 9, 10 and 11. AHP based prioritization is performed for both RA data and AD data following the association step. For the RA data 7,155 SNPs with p < 0.5 and for the AD data 26.545 SNPs with p < 0.05 are considered for prioritization. In the 5-fold cross validation (CV), Naive Bayes classifier is used as the supervised learning scheme. Table 12 presents top 10 SNPs prioritized with the novel AHP algorithm and Table 13 depicts prediction performance of resulting SNP sets. In the next step, the dimension of the AD data is reduced from 26,545 to 596 and the RA data is reduced from 7,155 to 481 SNPs by utilizing SA based algorithm while conserving the prediction performance. 5-fold classification of SA based list against WEKA based methods Chi-square and Relief-F is depicted in Table 14 , which shows the performance of the SA based selection algorithm against other well-known filtering based attribute selection schemes. "}, {"section_title": "5", "text": ""}, {"section_title": "Conclusions and Future Works", "text": "Here, we have introduced a java based integrated software system, METU-SNP, which can be effectively used for the GWAS and post-GWAS analysis of case-control based genotyping data for SNP-complex disease association. METU-SNP offers state-of-the-art AHP based SNP prioritization and Gene Set Enrichment Analysis frameworks and integrates well known third party tools such as PLINK and BEAGLE. METU-SNP, as an all-in-one GWAS application, offers a user friendly Graphical User Interface to manage the third party tools and it is equipped with novel functionality to prioritize and filter the most relevant SNPs from a massive initial SNP set.\nMETU-SNP version 1.0 is a java based desktop application with a MySQL back-end. The database integrates biological data from different major databases such as dbSNP, Entrez Gene, KEGG, Gene Ontology etc. The database structure currently lacks automated update functionality and it is designed to optimize the performance of AHP algorithm. Currently we are developing a new integrated SNP database with automated update functionality to periodically synchronize with the major biological databases. As a next step, METU-SNP functionality will be ported into the web environment, which will be hosted on a dedicated \"secure\" server within Middle East Technical University (METU) premises. The web based version will help us to reach a wider range of researchers worldwide. Additionally, development of a tool for graphical representation of the outputs and snp-gene-pathway relations, along with increased compatibility with different file formats are expected to be incorporated in the web based version.\nThe METU-SNP application provides researchers with a powerful tool that can be effectively used for GWAS of SNP genotyping data for case-control type analysis. We believe that METU-SNP will facilitate the reliable identification of SNPs that are involved in the etiology of complex diseases and ultimately support timely identification of genomic disease biomarkers, and the development of personalized medicine approaches and the targeted drug discoveries."}]
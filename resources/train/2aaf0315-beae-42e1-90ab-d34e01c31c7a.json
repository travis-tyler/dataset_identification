[{"section_title": "Abstract", "text": "The usage of biomedical imaging in the diagnosis of dementia is increasingly widespread. A number of works explore the possibilities of computational techniques and algorithms in what is called Computed Aided Diagnosis. Our work presents an automatic parametrization of the brain structure by means of a path generation algorithm based on Hidden Markov Models. The path is traced using information of intensity and spatial orientation in each node, adapting to the structural changes of the brain. Each path is itself a useful way to extract features from the MRI image, being the intensity levels at each node the most straightforward. However, a further processing consisting of a modification of the Gray Level Co-occurrence Matrix can be used to characterize the textural changes that occur throughout the path, yielding more meaningful values that could be associated to the structural changes in Alzheimer's Disease, as well as providing a significant feature reduction. This methodology achieves high performance, up to 80.3% of accuracy using a single path in differential diagnosis involving Alzheimer-affected subjects versus controls belonging to the Alzheimer's Disease Neuroimaging Initiative (ADNI)."}, {"section_title": "I. Introduction", "text": "Neurodegenerative diseases are considered one of the biggest challenges of the XXI century, specially in developed countries, where the ageing population is a major concern. According to the World Health Organization, the most common type of dementia is Alzheimer's Disease (AD), with more than 35.6 million people affected, and 7.7 million new cases every year [1] .\nThese diseases have a big impact on today's society, as they involve not only health services, but also a conglomerate of social, psychological and familiar care. Therefore, methods oriented to anticipate and improve the diagnosis are desirable. In this sense, the emergence and expansion of new imaging techniques, such as Magnetic Resonance Imaging (MRI), or Single Photon emission Computed Tomography (SPECT) have meant a breakthrough in the diagnosis of AD. Beyond manual processing of the images, there exists a trend in the usage of computed-aided systems to help in the differential diagnosis and even predict the conversion from prodromal stages (Mild Cognitive Impairment, or MCI) to AD [2] .\nGiven its high tissue contrast, the computational processing of MRI can be straightforward. A number of approaches have been proposed for the processing of MRI images, most of them using univariate analysis. Univariate analyses are performed using one single feature at a time, and frequently consists of a voxel-wise comparison between intensity levels, either over the images themselves (voxel based morphometry, or VBM [3, 4] ), Regions of Interest (ROIs) [5] or models of some brain features, such as cortical thickness [6] or intrinsic curvature [7] . This methodology has been implemented in the most prominent pieces of software used in clinical practice, such as FreeSurfer or SPM [8] , and is the most used in epidemiological studies.\nHowever, there is an increasing interest in multivariate approaches. Those, in contrast to univariate, are able to handle regional patterns, texture features and voxel and region-wise relationships [9, 10, 11, 12] . These approaches could reveal other information than the volumetric, complementing and providing new insights into the disease. Among them, some CAD systems based on texture features have been proposed [9, 13, 14] . Particularly, in Ref [13] , an easily computed texture descriptor, Local Binary Pattern (LBP) has demonstrated its utility in various high-level brain MR image analysis, and in Ref [15] , a Parkinson's Disease diagnosis system based on Haralick Texture Features was proposed.\nAt the same time, in Ref. [16] , a framework for feature extraction in MR Brain Images was proposed. It consists on the computation of different statistical and morphological values along some radia centred in the Anterior Comissure (AC) and spanning over all values of azimuth and elevation angles. Starting at this point, morphological measures such as cortical thickness, surface, or statistical texture features such as average, kurtosis or entropy of the voxels crossed by the mapping vector were computed. This provided a significant feature reduction, as well as some 2D maps representing each of these features, which could be considered a visual way to represent this information. Some of the features have been proved to be related to anatomical changes such as brain atrophy, yielding high performance in differential diagnosis. Furthemore, in Ref. [17] an extension to this algorithm provided characterization of the texture around the radius, with good performance as well.\nIn this work, a new algorithm to trace paths inside the brain is presented. It is intended to substitute the rectilinear radia in SBM with curvilinear paths that adapt to the structural information present in MRI brain images. Using this paths, the features (either intensity levels or more complex characteristics) will be more descriptive of the underlying brain structure. To complement the methodology, along with the intensity levels in the path, we have developed a radial method to compute the Gray Level Co-occurrence Matrix (GLCM). Firstly developed by Haralick [18] , the GLCM is one of the preferred methods to characterize the texture of 2D images, and have been successfully used in the characterization of brain images [15, 19] . In our approach, the original algorithm is modified to compute the GLCM along the extracted curvilinear paths and its neighbourhood, from which a number of descriptors of the underlying texture in each direction can be extracted. This paper is organized as follows: after this introduction, in Section II the overall methodology is presented, comprising an introduction to SBM, the whole path tracing algorithm using Hidden Markov Models and the computation of the radial GLCM. Later, in Section III, the database used in the article is introduced, along with the experimental setup, and the results obtained in each experiment. In Section IV, these results are discussed and analyzed, and finally, in Section V, some conclusions are drawn. Figure 1 . This representation of the brain is able to provide insight into different and useful properties of the anatomical structures such as brain folds or the cortical thickness in a 2D representation. However, the mapping process of reducing from 2D to 3D losses textural information in the vicinity of the vector p \u03b8,\u03d5 that may be important from a discriminative point of view. To avoid this, SBM was extended in Ref. [17] with a method that preserves part of the 3D textural information by means of a so-called Volumetric Radial Local Binary Pattern (VRLBP) descriptor which takes into account not only the voxels in the radius of a specific direction (\u03b8, \u03d5) but also the voxels in a helical neighbourhood."}, {"section_title": "II.2. Path tracing based on Hidden Markov Models", "text": "3D Biomedical Images can be understood as a tuple containing spatial information in the image range (x \u2208 I, where I \u2282 R 3 ) as well as intensity information (I(x) \u2208 R). There exist a number of possibilities in the interpretation of intensity data on the images, from plain intensity values to a sampling of the underlying tissue density (and thus, an estimation of the probability of finding a neuron in each position).\nFollowing our Spherical Brain Mapping approach, in which some radia are used to extract relevant statistical features from these images, we formulate a 3D path tracing algorithm suitable for extraction of curvilinear structures from 3D biomedical images, and directly linked to each direction (\u03d5, \u03b8) as in the original work. Our objective is to make these paths as representative of the underlying structure as possible. To do so, we must use both intensity and spatial information to construct maximum intensity-similarity paths oriented in the given direction Let us note a 3D path in a certain direction (\u03d5, \u03b8) as a Markov Model [20] :\nTherefore, our optimum path would be the one that maximizes the probability of the path:\nor, similarly, the probability of all the nodes:\nwhere x 0 is the node located at the Anterior Comissure (AC) and x N is the theoretical projection of the current direction (\u03d5, \u03b8) in the limits of the image I. Setting x 0 at the AC is the convention when using the Montreal Neurological Institute (MNI) coordinates [21] , however it provides one point that is connected with both hemispheres as well. Therefore, that setting ensures continuity during the path tracing. We can assume a first-order Hidden Markov Model (HMM) for the tracing of the path, and the i-th node will be computed as:\nand with this assumption, Eq. (3) becomes:\nIn our case, we will assume that the hidden state of each node will be its intensity I(x i ). Let I = {I(x 0 ), I(x 1 ), . . . I(x N )} be the vector of the intensities in each node. With the introduction of these factors, our optimal path defined in Eq. (2) can be view as:\nwhere:\nand P(I(x 0 ), . . . I(x N )) is the a priori probability of the intensities in the path. We can assume, without lack of generality, that this term is constant along the path, and therefore, it plays no part in the optimization process. For computational purposes, we will compute all the needed probabilities on a set of candidates\nTo estimate the individual probabilities needed for Eq. (9) P(I(x i )|x i ), we can assume a normal distribution of intensities of the candidates with mean I(x i\u22121 ) and variance \u03c3 2 c the variance of the intensities of the candidate set. By assuming this, the probability of a certain intensity in the candidate node x i increases as the intensity becomes more similar to the intensity of x i\u22121 . Therefore, the assumption supports the tracing of minimal intensity difference paths. The probability of the intensity of a candidate x i will be:\n4\nThe last term P(x 0 , . . . x N ) to be defined in Eq. (8) is directly related to the Spherical Brain Mapping framework defined before, as it will depend on the radial direction (\u03d5, \u03b8) that we want to \"force\" in the path. To define this term, we will define an attractor located in the position x N (the projection of the current direction (\u03d5, \u03b8) in the limits of the image I). We assume that this attractor defines the conditionality, that is, that it affects the transition probability between states by means of an isotropic Gaussian radial basis function (RBF), as defined in Eq. (11) . This definition helps the attractor to lightly condition the direction of the path at first, and more strongly as the path approaches the cortex, leading to a better representation of the underlying structure.\nwhere \u03a3 is the covariance matrix of the given distribution. As we will consider only isotropic gaussian kernel, the matrix can be considered as a 3 \u00d7 3 diagonal matrix whose diagonal elements are a scalar value \u03c3 2 , which we set in each iteration to the euclidean distance between x i and x N .\nStep Size\nIn this algorithm, instead of using a fixed step size, we evaluate each candidate point x \u2208 B 2,r (x \u2212 x i ), and thus, the only parameter to regulate is the radius of the L2-norm support ball r. As a trade-off between computational issues and definition of the defined path, we will use a value of r = 3, which gives approximately 200 candidate points in each iteration."}, {"section_title": "Stop Condition", "text": "Although the paths could be defined until they reach the last point x N (remember, the projection of the general direction onto the limits of I), our interest is to model the paths inside the brain, and therefore we establish a stop condition using an intensity threshold. This threshold is computed using the entropic thresholding, as defined in Ref. [22] . Let G m \u2261 {I 0 , I 1 , ...I m } denote the set of intensity levels of the whole image. We can compute a histogram to obtain the observed frequencies f I i , and thus, the observed probability of the different gray levels p i = f I i /N, where N is the number of voxels in our image I.\nFor a given intensity threshold I th = I s , if \u2211 s\u22121 i=0 p i is larger than zero and smaller than 1, the following distributions can be derived from this distribution after normalization:\nwhere P(I s ) = \u2211 s i p I i is the cumulative density function for the s-th gray level. Therefore, we choose the threshold so that the total amount of information provided by A and B (foreground and background of the image) is maximized. The total information provided by the s-th gray level is:\nA summary of our HMM-based path tracing method is shown in Algorithm 1. To illustrate the effect of the algorithm on a real example, Fig. 2 depicts the resulting set of paths computed over the standard MRI DARTEL template. \nGet the intensities of the candidates I(x c ) \u2200x c \u2208 X c ; foreach x c \u2208 X c compute P(x c |x N ) and P(I(x c )|x i ) ;"}, {"section_title": "II.3. Radial Texture Features", "text": "The paths extracted with the aforementioned algorithm present a meaningful representation of the structure of the intensity levels (and therefore, the tissue density) of the MRI brain images. At this point, one might consider using the intensity values located in those radia as features, and try to characterize each radius' discrimination ability by means of these intensities.\nConversely, the strategy proposed in Ref. [17] , which uses Local Binary Pattern (LBP) descriptors in the helical neighbourhood of a rectilinear mapping vector, might be consider useful as well. Due to the HMM paths topology, the helical sampling becomes difficult to compute and not even useful, therefore we propose a modification of the Gray Level Co-occurrence Matrix (GLCM) along the paths.\nThe GLCM, proposed by Haralick [18] , is one of the most widely used methods in texture characterization, and it has been successfully applied to medical imaging in the past [9, 15] . It works by storing the number of voxel-wise correspondences between K grey levels with a certain position offset \u2206 on a K \u00d7 K matrix (C \u2206 ) along all the image.\nOur modification will compute a node-wise GLC matrix, in which the number of greylevel transitions between adjacent nodes, noted as x i and x i+1 , is stored along the whole path X = {x 0 , x 1 . . . x N }. Mathematically, the computation of the GLCM in each point in the path will be:\nwhere the offset is different for each pair of nodes\nThe definition provided in Eq. (18) is intended for computing the values in each node. However, we can generalize this construction to include not only the nodes, but the intensity information around each node in the computation, which could potentially lead to more significant texture features. Let us note a set containing all the voxels in the closed neighbourhood of x i as X i . Therefore, Eq. (18) can be generalized for any voxel x \u2208 X i as:\nFrom the GLCM, a variety of texture descriptors, or features, can be extracted. In this work we will use ten texture features proposed in the original Haralick's article [18] as well as in Refs [23] and [24] : Contrast [18] (CNTR), Correlation [18] (CORR), Dissimilarity [23] (DISS), Energy [18] (ENER), Entropy [23] (ENT), Homogeneity [18] (HOMO), Difference Variance [18] (DVAR), Difference Entropy [18] (DENT), Inverse Difference Normalized [24] (IDN) and Inverse Difference Moment Normalized [24] (IDMN). The mathematical expressions for these features are presented in Equations 20 to 29."}, {"section_title": "II.4. MRI Brain Image Database", "text": "Data used in the preparation of this article were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). The ADNI was launched in 2003 as a public-private partnership, led by Principal Investigator Michael W. Weiner, MD. The primary goal of ADNI has been to test whether serial magnetic resonance imaging (MRI), positron emission tomography (PET), other biological markers, and clinical and neuropsychological assessment can be combined to measure the progression of mild cognitive impairment (MCI) and early Alzheimer's disease (AD). For up-to-date information, see www.adni-info.org.\nThe database used in this article was extracted from the ADNI1: Screening 1.5T (subjects who have a screening data) and contains 1075 T1-weighted MR images: 188 AD, 416 MCI and 201 NC.\nIn this work, a total number of 360 individuals (180 AD and 180 NC) have been randomly selected to avoid class prevalence. The images were preprocessed, co-registered and segmented using the Statistical Parametric Mapping (SPM) software [8] , and the Voxel-Based-Morphometry 8 (VBM8) toolbox [25, 4] . Demographics details about the subjects can be found at Table 1 . First, the preprocessing was performed using a nonlinear deformation field using the tissue probability maps provided by the International Consortium for Brain Mapping (ICBM). Secondly, we affine registered the data to the Montreal Neurological Institute (MNI) space and resized to 121 \u00d7 145 \u00d7 121 voxel. Finally, we performed the co-registration using the high-dimensional Dartel normalization using the standard Dartel template provided by VBM8 [4] , and a three-dimensional gaussian kernel with SD of 3mm was used to smooth the image maps and account for inter-subject misregistration."}, {"section_title": "III. Experiments and Results", "text": ""}, {"section_title": "III.1. Experimental Setup", "text": "In order to test our HMM-based path tracing algorithm, we propose the following experiments:\n\u2022 Firstly, in Sec. III.2 an evaluation of the algorithm over several synthetic 2D and 3D images which are not related to the biomedical task. \u2022 Secondly, in Sec. III.3, the HMM paths created using the DARTEL template will be evaluated in the differential diagnosis (NOR versus AD)."}, {"section_title": "AD", "text": "\u2022 Finally, in Sec. III.4, the proposed texture feature maps computed along the HMM paths will be evaluated in a differential diagnosis as well."}, {"section_title": "III.2. 2D and 3D demonstrations", "text": "A demonstration of the ability of our HMM path tracing algorithm can be found in Figures 3, 4 and 5. In Fig. 3 , the path tracing algorithm has been tested over a synthesized gaussian mixture probability density function using four isotropic gaussian kernels. The initial point was located at x 0 = (120, 20) and the attractor at x N = (20, 60). The resulting path maximizes both the orientation of the path (towards x N ) and the minimum change in the intensity values, which is specially visible in the last nodes of the path, where it approaches x N surrounding the nearby kernel. In this case, the chosen L2-norm of the support ball has been r = 3. The algorithm has been tested on a three-dimensional, helix-shaped point distribution as well (Fig. 4) . The tracing algorithm needs per-voxel intensity (or probability) values, therefore we have estimated the probability distribution of the points as the number of points within each voxel over the total number of points. Using x 0 as the point with minimum z coordinate in the data distribution and x N the one with maximum z, the resulting path follows the data distribution consistently until it reaches the attractor.\nFinally, we have tested the algorithm on a real world example, using a digital elevation model (DEM) of the Iberian Peninsula, generated by the LANDSAT SRTM30+ mission (see Fig. 5 ). We have tested a multiple path tracing by establishing sequentially x 0 and x N in ten cities. The resulting paths optimize both the distance and height variation, as well as resembling -in most cases-the roads that connect these cities in the real world. Given the dimensions of the image, in this case, the L2-norm of the support ball has been set to r = 30."}, {"section_title": "III.3. Intensity paths", "text": "In this section, we present the results of the first experiment involving paths in MRI brain images. First, the experiment performs an estimation of all the paths in each spatial direction (\u03d5, \u03b8), with \u03d5 \u2208 [0, 360] and \u03b8 \u2208 [\u221290, 90] over the DARTEL template [4] (from now on, DARTEL paths). After that, the paths computed in the template are applied to all images in the database in different ways. The first approximation is to compute the performance values of each path computed at each spatial direction (\u03d5, \u03b8). Thereby, the feature vector for each subject will be the intensity of the MRI brain image at the nodes of the path, which we have evaluated using a 10-Fold cross validation strategy. The performance is shown as the colour of each path traced in the DARTEL template in Figure 6 . The higher accuracy obtained using only one path is 0.8028 \u00b1 0.0873, and correspond to the light green paths that cross the temporal lobe.\nIt is interesting to question if the performance of this differential diagnosis could be improved using the information contained in more than one path at a time. To this end, we can select the higher accuracy paths according to the aforementioned performance measures, and select use all the voxels in these paths as features in the SVC. Additionally, we can use a t-test over the set Table 2 : Performance values (\u00b1STD) for the selected paths as features, and using t-test to select the voxels. of voxels selected by these paths, to further reduce the set to those voxels that have significant (p < 0.05) t-values (|t| > 1.96). The performance values for the experiment involving all voxels in the paths (first row) and the one that uses only those significant voxels (second row) are presented in Table 2 ."}, {"section_title": "III.4. Texture features", "text": "The second experiment proposed is based on the extraction of texture features from the DARTEL paths in each image. With this approach to the problem, we obtain one single value of a texture feature for each path in the subject. That is, each subject will be characterized by 2D, 361 \u00d7 181 array of scalars, one for each texture feature applied to the paths. Performance values for the nine texture features maps (Contrast (CNTR), Correlation corrm (CORR), dissimilarity (DISS), Energy (ENER), Entropy (ENT), Homogeneity (matlab) (HOMO), difference variance (DVAR), difference entropy (DENT), inverse difference normalized (IDN) and inverse difference moment normalized (IDMN)) are presented in Table 3 .\nThe first thing to note in this table is that the maximum accuracy obtained using any texture map is 0.736 \u00b1 0.070, obtained by Difference Variance. The performance values of the different texture features, all obtaining accuracies higher than 65% (most of them above 70%) reveal the discrimination abilities of these textures, although these values are not as good as those obtained using the plain paths, as in the previous section."}, {"section_title": "IV. Discussion", "text": "We have proposed a Hidden Markov Model based description of similar intensity paths to parametrize the internal structure of the brain. These paths have been using throughout this work as a feature selection method, either by selecting voxels or computing texture features. Later, we have tested the two approaches in a differential diagnosis using MRI brain images of controls and AD affected patients.\nEach path is constructed so that it follows a general direction set by the spherical coordinate pair (\u03d5, \u03b8) as well as keeping in a minimum intensity variation in the choice of the next node. This makes the paths very representative of the structure of the MRI brain image. There exists two possible approaches to the path creation, the first of them being the one used in this article. Our approach traces the HMM paths over the DARTEL template (the one used in the registration step) and then uses these paths to select the intensity levels in all the images in the dataset, and then perform several computations, including the characterization of texture along these paths. A second approach would compute the HMM paths independently on each subject in the dataset, and then morphologically compare the path features. However, this last approach is far more computationally expensive and does not allow a direct anatomical relationship between the paths in each subject and their discriminative power, and therefore, we have opted on the first.\nUsing the first of the proposed approaches, we have compared the discriminative power of the paths by using the set of intensity values at each node as the feature vector in a classifier, and then evaluating the performance in a differential diagnosis (AD versus NOR). In Fig. 7 , the paths that achieved best performance (accuracy higher than 0.75) in this differential diagnosis are shown along with some structures rendered from the Automated Anatomical Labeling (AAL) brain atlas [26] .\nThe paths that obtain higher accuracy are those that cross structures such as the Hippocampus, Amygdala, Thalamus, Fusiform and Inferior Temporal Gyrus. Particularly, grey matter loss in the Hippocampus has been described in the NINCDS-ADRDA criteria for AD diagnosis [27] and is widely accepted [28, 29, 30] . Furthermore, the evidence suggest that atrophy affects the surrounding structures (Amygdala, Parahippocampal and Fusiform Gyrus) as well [28, 29] . Some studies have found significant atrophy in the Thalamus and Putamen in early AD [30] as well. Generally, in advanced AD, most of the neocortex and grey matter suffer from atrophy [28, 29, 30] , which explains why most of the paths that involve the neocortex in Fig. 6 obtain accuracy rates around 0.7.\nRegarding the texture analysis, one can se the discrimination ability of the features in their performance results (Table 3) , where most of them surpass the barrier of 70% accuracy. While these results are poorer than in the case of single or combined paths, it is probably due to the definition of the paths itself: the paths are traced using a minimum intensity change criterium (the one that states the probability of the intensity of the next node using a RBF function centered in the current intensity value, as described in Eq. (10)). Therefore, the textural changes between the different nodes in the path should be minimal.\nThe usage of the 1-voxel closed neighbourhood of the nodes of the path might be a bad choice as well, specially regarding the spatial smoothing applied to the images to account for inter-subject misregistration. Consequently a wider neighbourhood could be more indicative of the underlying texture, allowing a better characterization of the atrophy of the different structures in the brain.\nHowever the real utility of these texture features might be related to the evolution of the disease and, therefore, its application in longitudinal studies, as it has been recently proven [19] . It is very convenient to use a single number to characterize a measure (in our case, texture features) in each direction. The texture obtained in each session can be used to construct a function of Paths that obtain more than 75% accuracy, and a three-dimensional representation of the structures crossed by them.\nneurodegeneration that allows the exploration of the different stages of the disease as the changes in the brain texture along the time within a single patient. Finally, it might be straightforward to compare our HMM based paths to Diffusion Tensor Imaging (DTI) fibers, which has indeed proved a good tool for the diagnosis of AD [31, 32] . Some could even argue that the resulting DTI tract reconstruction look similar to our computed paths (Figs. 2 and 6 ). However, they are based on very different principles and sources. DTI fibers are the result of a further processing over diffusion images that contain tensors that quantify the water molecule motion -in both direction and average magnitude-at the voxel level. Conversely, the HMM paths are extracted from the static, structural MRI images by means of their grey levels, and are used just as a tool to characterize the structure and perform feature extraction. Therefore, it is just the idea of \"connectivity\" what makes both strategies look similar, but each of them focus on very different aspects of the brain.\nAs we commented previously, the presented work uses the paths computed over the DARTEL template to extract features in all brains. It could be much more representative to compute the paths at a subject levels. Consequently, each image could be modelled by its own paths, and the further processing (in terms of intensity levels or texture features) would be far more specific, although extraordinarily computationally expensive. This will be an approach that we will probably adopt in future work."}, {"section_title": "V. Conclusions", "text": "In this work, a three dimensional path tracing algorithm based on Hidden Markov Models, where each node's location depends on the intensity levels of a 3D image and the relative position to an attractor. It has been proposed as a method to study the structure of the brain using Magnetic Resonance Imaging (MRI). The resulting paths, starting at the Anterior Comissure, generate a number of nodes that adapt to the distribution of intensities inside the MRI images, while maintaining a certain direction. After generating these paths, the values of the intensity in the nodes can be used as features. Furthermore, some further texture features can be extracted using the neighbourhood of the nodes in the path, using what we called radial Gray Level Co-occurrence Matrix and Haralick Texture Analysis. The resulting texture measures can be assembled to form a texture map in each direction of the space.\nWe have evaluated the discrimination ability of both the intensities that fall in the nodes of the image and the texture features extracted from the paths, obtaining up to a 0.8028 \u00b1 0.0873 accuracy in the differential diagnosis of AD when using one single path. The described texture features ability in the differential diagnosis is somehow less powerful that those of the single intensity values at the nodes, but their utility can reside in the fact that they model structural changes that could be applied to longitudinal studies. These features could model in future work a neurodegeneration function that characterizes the texture at different stages of the disease, providing a different approach for an anatomical model of AD to those currently being used."}]
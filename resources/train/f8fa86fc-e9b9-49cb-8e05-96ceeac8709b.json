[{"section_title": "Abstract", "text": "For precision medicine and personalized treatment, we need to identify predictive markers of disease. We focus on Alzheimer's disease (AD), where magnetic resonance imaging scans provide information about the disease status. By combining imaging with genome sequencing, we aim at identifying rare genetic markers associated with quantitative traits predicted from convolutional neural networks (CNNs), which traditionally have been derived manually by experts. Kernel-based tests are a powerful tool for associating sets of genetic variants, but how to optimally model rare genetic variants is still an open research question. We propose a generalized set of kernels that incorporate prior information from various annotations and multi-omics data. In the analysis of data from the Alzheimer's Disease Neuroimaging Initiative (ADNI), we evaluate whether (i) CNNs yield precise and reliable brain traits, and (ii) the novel kernel-based tests can help to identify loci associated with AD. The results indicate that CNNs provide a fast, scalable and precise tool to derive quantitative AD traits and that new kernels integrating domain knowledge can yield higher power in association tests of very rare variants."}, {"section_title": "Introduction", "text": "In this study, we focus on Alzheimer's disease (AD) as outcome of interest, which is a progressive neurodegenerative disease, appears late-onset and sporadic in most cases, and is the main cause of dementia in the elderly. As the cognitive symptoms emerge years after the appearance of brain atrophy and exhibit close correlation with the structural changes, brain magnetic resonance imaging (MRI) scans provide a direct way to obtain informative quantitative traits, and fast automated approaches are necessary for large-scale studies. AD has a high estimated heritability of 74% [1] and a prevalence of 4.4% in Europe [2] . However, the biological pathways underlying AD have not been well-understood and there is yet no known cure. Hence, the identification of AD markers for early detection and as targets for treatment is important.\nFor the detection of causal genetic loci, recent sequencing efforts allow in-depth analyses of rare variants in large cohorts, and kernel-based gene-level tests have been proposed for the analysis [3, 4, 5, 6, 7] . They derive similarity scores between samples in the form of a kernel matrix which is computed on a particular genomic locus or functional unit in the genome. Then, kernel-based variance-component test statistics are derived that yield robust and powerful tests. Kernel functions provide a highly flexible way to model genetic variation. However, their full capabilities have not been leveraged and existing approaches still provide suboptimal performance for the analysis of sequencing data [8] , where the overwhelming majority of genetic variation is extremely rare. Hence\nMachine Learning for Health (ML4H) Workshop at NeurIPS 2018."}, {"section_title": "arXiv:1812.00448v1 [stat.ML] 2 Dec 2018", "text": "extensions to the existing methods are warranted that leverage the full power of kernels to aggregate the signal of very rare single nucleotide variants (SNVs).\nOur contributions in this paper are in two areas. First, we use a convolutional neural network (CNN) to derive quantitative traits from MRI scans, and evaluate if precise traits are obtained on data from the Alzheimer's Disease Neuroimaging Initiative (ADNI), where also traits obtained by the popular yet computationally expensive FreeSurfer software [9] are available. Second, we propose novel kernels for association tests of rare genetic variants that incorporate prior biological knowledge from annotations and multi-omics measures. We perform association analyses between these novel kernels computed on sequencing data and CNN-derived traits to identify genetic loci associated with AD."}, {"section_title": "Related work", "text": "The association of a set of m genetic markers with a quantitative trait Y with n observations can be tested in a linear mixed model of the form\nwhere X is a covariate design matrix with fixed effects \u03b1, \u03b2 \u223c N (0, \u03c3 Figure 1 : Illustration of association tests using kernel maps.\nIncorporate information from available omics data Set W = AA T where A is the m \u00d7 p matrix (i) containing -log 10 p-values of association tests of the m SNVs with omics data e.g. gene expression levels of p genes or (ii) indicating for each of these p-values if they are < \u03b1, where \u03b1 is pre-specified constant. Set the elements ij of V to be indicators whether SNVs i and j both have p-value < \u03b1.\n3 Application: analysis of ADNI study\nIn the application, we analyzed whole-genome-sequencing data, gene expression measures, MRI data as well as AD biomarkers in n = 556 participants from ADNI, which is a longitudinal study to detect biomarkers and risk factors for AD [12, 13] .\nIn a first step, we designed a 3-dimensional CNN comprising seven convolutional layers followed by a max pooling layer and a final fully-connected layer to predict the volume of the 3 rd ventricle from the MRI scans (see Figure 2 for an illustration and see Appendix B, Figure S1 for details).\nTo evaluate the approach, we chose the 3 rd ventricle, as we found that the ventricular regions were displayed with a higher contrast and presumably easier to identify. The CNN predicted volume was then used as a quantitative trait in the following genetic association analyses, and evaluated against the predictions by the FreeSurfer software. Both models where trained on a dual Intel Xeon 6148 workstation equipped with an NVidia Titan-V graphics card.\nIn the main genetic association analysis we analyzed 17,013 (quality-controlled, biallelic, missingness <5%, of any MAF) SNVs in 125 genes in the 1Mbp region around the APOE gene on chromosome 19, similar to the study in [14] , to investigate rare variants in a genomic region where several common variants have been associated with AD. We performed cross-sectional association tests of these 125 genes with 9 different AD traits (peptides CSF A\u03b2, t-tau, p-tau, and the provided brain volumes of entorhinal cortex, hippocampus, medial temporal lobe, ventricles, 3 rd ventricle predicted by FreeSurfer, and 3 rd ventricle predicted from the CNN) adjusting for the covariates age, gender, education, ethnicity, and APOE4 allele. The association tests were performed based on different combinations of the new proposed kernels (in Appendix A) and using standard SKAT and SKAT-O. "}, {"section_title": "Results", "text": "The 125 genes contained on average 220 SNVs (min = 1, max = 1759). Of the 17,013 SNVs, 7575 were singletons, 1740 doubletons, and 12,337 SNVs had MAF < 0.01. 24 participants had dementia, 338 mild cognitive impairment, 194 were cognitive normal (see Table S1 for descriptive statistics).\nIn an evaluation of the predicted volume of the 3 rd ventricle, CNN and FreeSurfer predictions showed a high correlation (Pearson r = 0.92, see Figure S2 ). For small/large volumes, compared to FreeSurfer, CNN slightly over-/underestimated the volume, which we expect to disappear with larger training data. On the other hand, CNN was much faster (1 second versus 16 hours per scan).\nIn the main genetic association analyses, a first comparison showed that analyses using the CNNpredicted trait as outcome generally yielded similar and often smaller p-values compared to the FreeSurfer-predicted trait ( Figures S3-S4 ). Preliminary comparisons of all new kernels indicated that the three kernels reported in Table 1 "}, {"section_title": "Discussion", "text": "The empirical analyses indicated that (i) CNNs provide a precise, fast and scalable tool to derive quantitative traits from MRI scans and that (ii) new kernels integrating domain knowledge and omics data constitute a promising approach for the analysis of very rare variants. There is previous evidence for the association of the identified genes with AD [15, 16, 17, 18 ] to support our findings, and of note, the p-values are much smaller using the new kernels here compared to regular kernels [14] . Limitations of the current analyses are that only few functional annotations are available for rare SNVs, and that only a basic control for population stratification was used. In the interpretation of the results regarding their biological relevance, it can be noted that the analyses were adjusted for the risk factor APOE4, so that the identified genes and SNVs represent markers with independent effects on AD. Future research can investigate kernels measuring the similarity between the bivariate allelic sequences directly, and data-adaptive optimal combinations of different kernels."}, {"section_title": "Acknowledgments", "text": "Data used in the preparation of this article were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database adni.loni.usc.edu. As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at: http://adni.loni.usc.edu/wp-content/uploads/how_to_apply/ADNI_ Acknowledgement_List.pdf. Data collection and sharing of ADNI was funded by the Alzheimer's Disease Neuroimaging Initiative (ADNI) (National Institutes of Health Grant U01 AG024904) and DOD ADNI (Department of Defense award number W81XWH-12-2-0012). ADNI is funded by the National Institute on Aging, the National Institute of Biomedical Imaging and Bioengineering, and through generous contributions from the following: Alzheimer's Association; Alzheimer's Drug Discovery Consider the m \u00d7 m matrices V describing the similarity of SNVs where 1. V ij = similarity of SNVs i and j in terms of genomic closeness:\nwhere d ij is the genomic distance between SNVs i and j in base pairs. 2. V ij = indicator whether SNVs i and j both have a functional annotation: 4. V ij = indicator whether SNVs i and j have p-value < specified cutoff value \u03b1. V ij = 1 if i = j 1 if SNVs i, j both have p-value < \u03b1 0 else. where the p-value of SNV i is from an association test with a variable Z that provides relevant information about its biological function, e.g. where Z is the gene expression of the gene in which the SNV lies. 5. V is the product of the matrices in bullet points (1 and (2 or 3) ), (1 and 4), or (4 and (2 or 3)) 6. V is the product of the matrices in bullet points 1 and (2 or 3) and 4."}, {"section_title": "B Details on convolutional neural networks", "text": "Model architecture The model architecture is illustrated in Figure 2 , and in more detail in Figure  S1 . We designed a CNN made of a sequence of seven convolutional layers followed by a max pooling layer and a fully-connected layer. We used two types of convolutional layers: Regular and Down-Convolution. Regular convolutional layers comprised a 3 x 3 x 3 convolutional operation with 1 x 1 x 1 strides. The down-convolutional layers comprised a 2 x 2 x 2 convolutional operation with 2 x 2 x 2 strides. Each convolutional layer was followed by a Rectified Linear Unit non-linearity [19] . After the last convolutional layer, we used a max pooling layer with a filter size of 2 x 2 x 2. Subsequently, this layer was converted into a fully-connected layer, followed by the output layer containing a single node with a linear activation function."}, {"section_title": "Model implementation", "text": "The MRI scans were standardized to the spatial resolution of 1 x 1 x 1 millimeters and the size of 256 x 256 x 256 voxels. Additionally, for computational efficiency, they were cropped and down-sampled to 96 x 109 x 96 voxels.\nThe model was trained on 2100 MRI scans (from 411 subjects) for 200 epochs with the loss function set to the mean absolute error using the Adaptive Moment Estimation optimizer [20] , a learning rate of 10 \u22124 and a 3D spatial drop out regularization of 0.9.\nHyperparameter tuning was carried out on a validation dataset comprising 550 scans of 129 subjects that all had MRI data but did not have genetic data available so that they could not be included in the main analysis. The final evaluation was done on the test set including the 556 subjects of the main analysis that had all MRI, genetic, and gene expression data available. The model performance on the test set is visualized in Figure S2 ."}, {"section_title": "Computational comparison with FreeSurfer", "text": "Both models where trained on a dual 20 core Intel Xeon 6148 workstation with 768GB RAM equipped with an NVidia Titan-V graphics card. CNN computations made use of GPU optimization, taking 1 second for the prediction of the volume of the third ventricle per MRI scan. FreeSurfer, which did not utilize the GPU, took 16 hours per MRI scan. Figure S1 : Graphical visualization of the 3D convolutional neural network model in Keras. Shown are input and output of the different layers, and the respective voxels and channels. For example, the input volume had 96 \u00d7 109 \u00d7 96 voxels and 1 channel. As all computations were done in one batch, the batch size was not specified (noted as \"None\" in the graph). Figure S5 : Scatterplot of the -log 10 p-values from association tests of the 125 genes using SKAT (x axis) and the new kernel-based test 1 (y axis), for each of the 9 traits in separate panels. In addition, the diagonal is printed for a comparison of both tests."}, {"section_title": "C Supplementary tables and figures", "text": ""}]
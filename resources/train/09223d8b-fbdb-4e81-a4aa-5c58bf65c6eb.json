[{"section_title": "Introduction", "text": "To motivate the proposed methodology, we consider an imaging genetic data set from 745 subjects collected by the Alzheimer's Disease Neuroimaging Initiative (ADNI) study (http://www.adniinfo.org/) in order to advance the discovery in detection, invention, prevention as well as treatments of the Alzheimer's disease. Specifically, each subject has brain volumes of 93 regions of interest, single nucleotide polymorphisms (SNPs) on candidate genes of the Alzheimer's Disease, and other covariates including gender, age, education level, marital status and handedness. Alzheimer's Disease (AD) is characterized by death of nerve cells and accelerated cerebral atrophy, leading to the shrinkage of various brain volumes, such as hippocampus. Similar to a recent large-scale imaging study for schizophrenia in Franke et al. (2016) , we are interested in characterizing the genetic influences of the top 40 AD candidate genes listed on the AlzGene database (www.alzgene.org) as of June 10, 2010 on structural brain phenotypes in ADNI.\nA standard model in the imaging genetic literature (Vounou et al., 2010; Thompson et al., 2013; Sun et al., 2015) is the multivariate linear regression given by\nwhere Y is a r \u00d7 1 vector of multiple responses (e.g., brain volumes), X is a p \u00d7 1 vector of covariates, and the errors \u03b5 follows a distribution with mean 0 and positive definite covariance matrix \u03a3 \u2208 R r\u00d7r . Moreover, \u00b5 \u2208 R r and \u03b2 \u2208 R r\u00d7p are unknown intercept and regression coefficients. It is common to calculate the ordinary least squares estimator of \u03b2 by regressing each element in Y on the predictors of interest. This method, however, ignores the relationship among different response components. A novel envelope modeling framework introduced in Cook et al. (2010) explicitly uses such relationship to identify a part of the responses that is immaterial to the estimation of \u03b2, while bringing extraneous variation. This immaterial part is then accounted for in the subsequent estimation, making the estimation more efficient. After the original development, advances have been taken place to extend the scope of envelope model (Su and Cook, 2011 , 2012 Cook et al., 2013; Cook and Zhang, 2015; Khare et al., 2016 ).\nHowever, model (1) is not sufficient for addressing a more specific question of interest. Specifically, it is interesting to investigate how the associations between AD genetic variants and subcortical volume measures differ across male and female groups. Suppose that we observe imaging genetic data from subjects in L different groups. For each l = 1, . . . , L, the l\u2212th group has n (l) observations and the total sample size is n = L l=1 n (l) . By incorporating such group information, we can reformulate model (1) as\n. . , L and j = 1, . . . , n l ,\nwhere Y (l)j \u2208 R r is the jth observed response vector in the l\u2212th population, \u00b5 (l) \u2208 R r is the mean of the l\u2212th population, X (l)j \u2208 R p is the jth observed covariate vector in the l\u2212th population, \u03b2 (l) \u2208 R r\u00d7p contains the regression coefficients for the l\u2212th population, and \u03b5 (l)j follows some distribution with mean 0 and covariance matrix \u03a3 (l) . Throughout this paper, we use subscript (l) to denote the l\u2212th population and subscripts without parenthesis to number the observations.\nWithout loss of generality, we assume that\nat 0 in the sample for each group. Model (2) is referred to as the standard model in later discussion.\nThe aim of this paper is to develop a new groupwise envelope modelling framework for model (2), which allows for distinct regression coefficients and the heteroscedastic error structure across groups. Compared with the existing literature Cook et al., 2010) , we make at least three major contributions. First, we develop an efficient estimation method to estimate distinct genetic-volume associations across groups under the heteroscedastic error structure. In contrast, the existing envelope models assume either a homogenous error structure or distinct means across groups without covariate X. Second, we examine the asymptotic properties of the proposed estimates under some mild conditions. Third, our simulation studies and the ADNI data analysis confirm the efficiency gains obtained by using the groupwise envelope model. An alternative way to gain estimation efficiency in model (2) is to fit a separate envelope model to each group. However, as will be shown in Sections 3 and 5, efficiency is lost due to ignoring the common characteristics in response variables across groups.\nThe article is organized as follows. Section 2 reviews the envelope model and introduces the groupwise envelope model and its estimation procedure. Section 3 systematically investigates the asymptotic properties of all estimators. Simulation studies are conducted in Section 4. A real data analysis of the imaging genetic data set from ADNI is described in Section 5. Conclusion remarks are given in Section 6."}, {"section_title": "Methods", "text": ""}, {"section_title": "A Review of Envelope Models", "text": "We first introduce some notation. We use P S to denote the projection matrix onto span(S) or S if S is a matrix or a subspace, and Q S = I \u2212 P S . With a matrix A \u2208 R m\u00d7n , vec(A) \u2208 R mn stacks the columns of A into a vector. The Kronecker product is denoted by \u2297, X \u223c Y means X and Y has the same distribution, and X Y means that X and Y are independent.\nThe original envelope model (Cook et al., 2010 ) was developed for model (1). Under (1), we partition the response vector Y into a material part and an immaterial part, where the distribution of the material part changes with the predictor X and the distribution of the immaterial part does not. Condition (a) indicates that the distribution of the immaterial part does not depend on X, and condition (b) indicates that given X, the material part and immaterial part are uncorrelated. Let B = span(\u03b2). Conditions (a) and (b) are also equivalent to: (I) B \u2286 S and (II) Cook et al., 2010) . Condition (I) indicates that the immaterial part does not contain information on \u03b2 and condition (II) indicates that the variation \u03a3 can be decomposed into the variation due to the material part and the variation due to the immaterial part. When \u03a3 has the structure in condition (II), S is a reducing subspace of \u03a3 (Conway, 1990) . Then, the \u03a3-\n, is defined to be the smallest reducing subspace of \u03a3 containing B. Model (1) is called the envelope model when conditions (I) and (II) are imposed.\nLet u denote the dimension of E \u03a3 (B), \u0393 \u2208 R r\u00d7u be an orthogonal basis of E \u03a3 (B), and \u0393 0 \u2208 R r\u00d7(r\u2212u) be an orthogonal basis of E \u03a3 (B) \u22a5 . The coordinate form of the envelope model is\nwhere \u03b2 = \u0393\u03b7, \u03b7 \u2208 R u\u00d7p carries the coordinates of \u03b2 with respect to \u0393, and \u2126 = \u0393 T \u03a3\u0393 and\n\u03a3\u0393 0 carry the coordinates of \u03a3 with respect to \u0393 and \u0393 0 , respectively. When u = r, E \u03a3 (B) = R r , the envelope model degenerates to the standard multivariate linear regression model.\nAs shown in Cook et al. (2010) , the envelope estimator of \u03b2 is more efficient than or at least as efficient as the standard estimator. The efficiency gains can be substantial when\nwhere \u00b7 denotes the spectral norm of a matrix or vector."}, {"section_title": "Formulation of Groupwise Envelop Model", "text": "Under model (2), let S be a subspace of R r , L be an orthogonal basis of S and L 0 be an orthogonal\n. From conditions (A) and (B), S is a reducing subspace of all \u03a3 (l) and span(\u03b2 (l) ) \u2286 S for l = 1, . . . , L. Therefore, we define the groupwise envelope to be the intersection of all such S. More specifically, let M = {\u03a3 (1) , . . . , \u03a3 (L) } denote the collection of all covariance matrices, and B = span(\n, is the smallest subspace that reduces each matrix in M and\nwe have\nModel (2) is called the groupwise envelope model if conditions in (3) are imposed.\nLet \u0393 \u2208 R r\u00d7u be an orthogonal basis of E M (B) and \u0393 0 \u2208 R r\u00d7(r\u2212u) be its completion. The coordinate form of the groupwise envelope model is given by\nu\u00d7p carries the coordinate of \u03b2 (l) with respect to \u0393, and \u2126 (l) \u2208 R u\u00d7u and \u2126 0 \u2208 R (r\u2212u)\u00d7(r\u2212u) are symmetric matrices that carry the coordinates of \u03a3 (l) with respect to \u0393 and \u0393 0 , respectively. The groupwise envelope model degenerates to the envelope model in Cook et al. (2010) if L = 1.\nFor a fixed dimension u, the number of parameters in the groupwise envelope model (4) is\n. This is because we need Lr parameters for all \u00b5 (l) s', Lup parameters for all \u03b7 (l) s', Lu(u + 1)/2 parameters for all \u2126 (l) s', and (r \u2212 u)(r \u2212 u + 1)/2 parameters for \u2126 0 . The envelope subspace E M (B) is on an r \u00d7 u Grassmann manifold, which is the set of all u dimensional subspaces in an r dimensional space, so it has u(r \u2212 u) free parameters."}, {"section_title": "Estimation Procedure", "text": "The groupwise envelope model does not require normality, but we will use the normal likelihood function as a pseudo likelihood function to calculate estimators. Technical details are included in Supplemental Section A. Let \u03b8 = (\u00b5, \u03b7, \u2126, \u2126 0 ) be a collection of parameters, where \u00b5 =\n. For a fixed dimension u, u = 0, . . . , r, the normal log likelihood of the groupwise envelope model is given by\nWhen \u0393 is fixed, the estimators of \u00b5 (l) , \u03b7 (l) , \u2126 (l) , and \u2126 0 , which maximize (\u03b8), can be written as\n, and\nwhere\n\u00d7p is the centered data matrix for X and Y (l)c \u2208 R n (l) \u00d7r is the centered data matrix for Y for group l. Substitute them back to (\u03b8), we get\nwhere L r\u00d7u denotes the r \u00d7 u Grassmann manifold. To emphasize that \u0393 is an orthogonal basis of E M (B), we put subscript \u0393 on B. After we obtained E M (B \u0393 ), \u0393 can be any orthogonal basis of\n. . , L, the estimators for all other parameters are given as follows:\n\u2022\n,ols , where \u03b2 (l),ols is the ordinary least squares estimator of \u03b2 (l) ;\nTo estimate the dimension of E M (B \u0393 ), we apply the Bayesian information criterion (BIC). Let l * (u) be the maximized l for a fixed u, and N (u) be the number of parameters discussed in Section 2.2. We choose a value u opt that minimizes BIC(u) = \u22122l"}, {"section_title": "Theoretical Properties", "text": "In this section, we examine the theoretical properties of the groupwise envelope estimators. We present the following theoretical properties, whose proofs are included in Supplemental Section B.\nPROPOSITION 1: Under the groupwise envelope model (4), assume that the errors are independent and have finite fourth moments. Then\nProposition 1 establishes the \u221a n consistency of the groupwise envelope estimators. Notice that normality is not required even though the estimators are derived by maximizing the normal likelihood function.\nPROPOSITION 2: Suppose that the conditions of Proposition 1 hold and f (l) = n (l) /n does not change with n. Then, vec( \u03b2 (l) \u2212\u03b2 (l) ) converges in distribution to a multivariate normal distribution with mean 0 for each l = 1, . . . , L. Furthermore, under the normality, we have\nProposition 2 provides the asymptotic distribution of the groupwise envelope estimator and derives explicit form of the asymptotic variance under the normality. The first term f \u22121\nT is the asymptotic variance of \u03b2 (l) for known \u0393, and the second term (\u03b7\nis the cost of estimating the envelope subspace E M (B).\nSuppose that we fit separate envelope model to the data in each group, and we denote their estimators as \u03b2 (l),senv for l = 1, . . . , L. We have the following results.\nPROPOSITION 3: Suppose that the conditions of Proposition 1 hold, then vec(\nconverges in distribution to a multivariate normal distribution with mean 0 for l = 1, . . . , L.\nFurthermore, under the normality, we have\nwhere\nProposition 3 gives the asymptotic distribution of vec( \u03b2 (l),senv ). Corollary 4 indicates that the groupwise envelope estimator is more efficient. A close examination reveals that V (l) and V (l),env differ only in terms of T and T 2 . This suggests that if \u0393 is known, the asymptotic variance for\u03b7 (l) is the same. However, the cost of estimating E M (B) is smaller for the groupwise envelope model. This is because that the groupwise envelope model uses all the data to estimate E M (B), whereas the separate envelope model only uses the data from the l\u2212th group to estimate E M (B). We also notice that with finite sample, the envelope subspace E M (B) calculated by fitting separate envelope model varies across groups."}, {"section_title": "Simulation Study", "text": "In this section, we use Monte Carlo simulations to evaluate the finite-sample performance of the groupwise envelope model (4). We generated the data from model (4) with two groups (L = 2), which have 40% and 60% of the observations. We set r = 10, p = 3, and u = 1. The matrix (\u0393, \u0393 0 ) was obtained by normalizing an r \u00d7 r matrix of independent normal variates, \u00b5 (1) was a vector of 3 and \u00b5 (2) was a vector of 10, \u03b7 (1) was a vector of independent \u03c7 2 10 variates and \u03b7 (2) was a vector of independent \u03c7 2 20 variates. Let A \u2208 R (r\u2212u)\u00d7(r\u2212u) be a matrix of independent normal (5, 1 2 ) variates, \u2126 (1) and \u2126 (2) both be \u03c7 2 1 variates, and \u2126 0 = AA T . The predictors were independent normal (0, 5 2 ) variates for the first group and independent normal (0, 10 2 ) variates for the second group. We varied the sample size from 100, 300, 1000 and 3000. For each sample size, 200 replications were generated. The standard model (2), the envelope model (Cook et al., 2010 ), separate envelope model and the groupwise envelope model (4) were fit to the data. Standard deviation of each element in \u03b2 (1) and \u03b2 (2) was calculated based on the 200 replications for each method at each sample size. We also computed the bootstrap standard deviations of each element in \u03b2 (1) and \u03b2 (2) based on 200 bootstrap samples. The results for a randomly chosen element in \u03b2 (1) and a randomly chosen element in \u03b2 (2) are summarized in Figure 1 . For clarity, we did not draw the line for the standard deviation of the standard model, but only displayed its asymptotic standard deviation.\n[ Figure 1 about here.]\nWe have the following observations from Figure 1 . The groupwise envelope estimator is consistent and its standard deviation approaches to the asymptotic standard deviation as sample size increases, which agrees with Proposition 1. It is also observed that the groupwise envelope model achieves substantial efficiency gains over the standard model. Take the element in the right panel of Figure 1 for example, the standard deviation of the groupwise envelope estimator is already smaller than the asymptotic standard deviation of the standard estimator with n = 100. This means by using the groupwise envelope model, with 100 samples we have achieved the efficiency of taking infinity number of samples under the standard model. We also notice that the bootstrap standard deviation is a good estimation of the sample standard deviation. The envelope model with constant covariance structure (Cook et al., 2010) has standard deviation about five times as large as the groupwise envelope model, indicating that accommodating the groupwise error structure brings extra efficiency gains. The separate envelope model also has larger standard deviations than the groupwise envelope model, as asserted in Corollary 4. The difference is more pronounced in one group than the other.\nWe investigated the numerical properties of the groupwise envelope model under non-normal errors in Web Appendix A and Web Appendix B. In Web Appendix A, we considered the estimation standard deviation of the groupwise envelope model under different non-normal error distributions including t distribution with degrees of freedom 6, uniform distribution defined on the unit interval, and chi-squared distribution with degrees of freedom 4. We examined the selection performance of BIC under non-normal errors in Web Appendix B."}, {"section_title": "The Alzheimer's Disease Neuroimaging Initiative", "text": "We applied the groupwise envelope model to the imaging genetic data set obtained from ADNI study as described in Section 1. We used the image processing pipeline and quality control methods The efficiency gains can be explained by the covariance structure: \u2126 (1) = 1.27 \u00d7 10 \u22124 , \u2126 (2) = 0.1579 and \u2126 0 = 19.29. This indicates that the variation of the immaterial part is much larger than that of the material part, and by identifying and accounting for the immaterial variation, the groupwise envelope model achieves substantial efficient estimation in this case. The efficiency gains in estimation lead to better prediction performance. The prediction error is estimated by the average of 50 five-fold cross validations with random splits, and the identity inner product is used to bind the responses. The standard model has a prediction error of 21.27, and the groupwise envelope model has a prediction error of 9.65, which is more than a 50% reduction.\n[ Figure 3 about here.]\nWe also fitted the separate envelope model to the data. BIC suggested u = 1 for both male and female groups. The ratios of the bootstrap standard deviation under the standard model to that under the separate envelope model range from 1.05 to 16.63 with an average of 3.16 for the male group, and range from 1.01 to 13.93 with average of 2.68 for the female group. The ratios are also displayed in Figure 3 . The boxplot reveals that the groupwise envelope model and the separate envelope model are both more efficient than the standard model. But by using the information from all the groups in the estimation of E M (B), the groupwise envelope model achieves substantially more efficiency gains than the separate envelope model, which confirms the results in Corollary 4.\nTo investigate the genetic effects of the SNPs on the brain volumes of 93 ROIs through the groupwise envelope model, we looked at a submatrix of \u03b2, say \u03b2 sub , which consisted of columns corresponding to the 205 PCs and APOE 4. And we calculated c j,i = | \u03b2 sub,j,i |/ \u03b2 sub,j\u00b7 , where [ Figure 5 about here.]\nWe also tested if a coefficient equals to 0 for all elements in \u03b2. [ Table 1 We set the significance level at 0.05. Suppose Z * l,j are the significant genetic effects and \u03b2 * l are their coefficients, we can construct the polygenic score as S l,j = \u03b2 * l,j Z * l,j . We then fit the regression of Y l,j on S l,j , and calculated the total sum of squares SST l,j and regression sum of squares SSR l,j . We\nj=1 SST 2,j . Based on the value of R 1 and R 2 , the genetic effects of SNPs explain 9.55% and 9.60% of the variation in the male and female groups, respectively. The association of the polygenic score with the phenotypical variation is tested based on the chi-squared distribution with non-centrality parameter \u03bb l and degrees of freedom 1, where\n, n (1) = 441 and n (2) = 304. Then the power of the two-tailed chi-squared test with significance level \u03b1 is obtained from\nwhere \u03a6 is the cumulative distribution function for the standard normal distribution. We found both groups have power 1 with \u03b1 = 0.05 in the testing."}, {"section_title": "Conclusion", "text": "We have proposed a groupwise envelope model, which is an efficient model for estimating regression coefficients for heterogeneous groups. Since the interest of research in heterogeneity soars, such as the great attention in precision medicine, the development of models dealing with heterogeneity is desired in multivariate response analysis. The groupwise envelope model allows for distinct regression coefficients and heteroscedastic error structure for different groups. Our simulation studies and ADNI data analysis demonstrates the efficiency gains obtained by the groupwise envelope model, compared to both standard model and separate envelope model. The groupwise envelope model leads to a better understanding of the genetic effects of the top 40 AD candidate genes for male and female groups on brain volumes of 93 ROIs in the ADNI dataset.\nFor future research, a sparse groupwise envelope model that pinpoints the immaterial responses is desired for real applications, as it is more interpretable. If we consider the spatial structure of the brains, we would have a multi-dimensional array (tensor) response. Li and Zhang (2016) developed a tensor response envelope model that achieves efficient estimation in tensor regression. We can expand our methodology to handle heteroscedastic error structure in the tensor envelope model. In addition, a Bayesian version of this model that incorporates prior information from earlier studies is also worth exploration. As longitudinal data and missing data appear in Alzheimer's study, a groupwise envelope model that can handle these data structures would also be of practical use."}, {"section_title": "SUPPLEMENTARY MATERIALS", "text": "Web Appendix A and Web Appendix B referenced in Section 4 are available with this paper at the Biometrics website on Wiley Online Library. An R package implementing the groupwise envelope model with simulating data is available at https://github.com/BIG-S2/GENV."}, {"section_title": "ACKNOWLEDGMENT", "text": "We are grateful to the editor and two referees for their insightful suggestion and comments that helped us improve the paper. We thank Professors Dennis Cook and Hani Doss for helpful dis- \nSetting the derivative in (A.1) to 0 and using the fact that X (l) is centered at 0, we have\u03bc (l) =\u0232 (l) .\nSubstitute\u03bc (l) into the likelihood, we now consider the derivative of l in (5) with respect to \u03b7 (l) :\nWe set the the derivative in (A.2) to be 0 and obtain\nwhere X (l) is an n (l) \u00d7 p matrix with its ith row being X T (l),i , Y (l)c is an n (l) \u00d7 r matrix with its ith l) to the log likelihood function, we have\nWe can easily get the estimators of \u2126 (l) and \u2126 0 by taking the derivatives, and the estimators are\nSubstitution of (A.4) into (A.3) gives\nBy Lemma 6.2 of Cook et al. (2010) , we rewrite the function in (A.5) as\nand \u0393 can be obtained by minimizing the preceding objective function."}, {"section_title": "B: Proofs of theoretical results in Section 3", "text": "Proof of Proposition 1 and Proposition 2 For preparation, if A \u2208 R m\u00d7m is a symmetric matrix, We use Proposition 4.1 in Shapiro (1986) to prove Proposition 1. Let h denote the parameters under the standard model, and let \u03c6 denote the parameters under the groupwise envelope model.\nand \u03c6 = vec \u00b5\nWe use J to denote the Fisher information matrix under the standard model, and G to denote the gradient matrix. Then\nwhere g 1 = I Lr , g 2 is a Lpr \u00d7 Lpu block diagonal matrix whose all diagonal blocks are I p \u2297 \u0393,\nT , and\nT . Now we match Shapiro's notations with our notations. Shapiro's \u03b8 is our \u03c6; Shapiro's \u03be is our h; Shapiro'\u015d x is the standard estimator of h; Shapiro's \u2206 is our gradient matrix G; Shapiro's V is our J; and Shapiro's discrepancy function F is l max \u2212 l, where l is the log likelihood function and l max is the maximum value of l attained when h is the standard estimator of h. Specifically,\nIt is easy to see that l max \u2212 l satisfies the conditions 1 -4 in Section 3 of Shapiro (1986) .\nSince J is full rank, we have rank(G T JG) = rank(J). As the standard estimator of h is \u221a n consistent and converges in distribution to a normal distribution with mean 0 and covariance J \u22121 , all the conditions in Proposition 4.1 of Shapiro (1986) are satisfied. Thus, the groupwise envelope estimator\u0125 is a \u221a n consistent estimator of h, and \u221a n(\u0125 \u2212 h) has asymptotically normal distribution with mean 0.\nWhen the errors are normally distributed, then J has a closed form:\nwhere f (l) = n (l) /n is the proportion of the l\u2212th population, J 1 is a Lr \u00d7 Lr block diagonal matrix whose diagonal blocks are\n(L) , and J 3 is a {Lr(r + 1)/2} \u00d7 {Lr(r + 1)/2} block diagonal matrix whose diagonal blocks are\n(1) )E r , . . . ,\nThe asymptotic variance of\u0125 under the groupwise envelope model then has a closed form V env = G(G T JG) \u2020 G T , where A \u2020 denotes the Moore-Penrose generalized inverse of a matrix A. After some straightforward calculations, the asymptotic variance of vec(\nProof of Proposition 3 Proof of Proposition 3 follows directly from (5.7) in Cook et al. (2010) . Figure 5 : Heatmaps of the regression coefficients: the last on the horizontal axis denotes APOE 4 and the remaining is for the selected PCs. The first row is for groupwsie envelope model, and the second row is for the standard model (2). The left panel is for the male group, and the right panel is for the female group."}]
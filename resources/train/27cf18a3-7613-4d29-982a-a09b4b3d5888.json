[{"section_title": "Abstract", "text": "Abstract. The accurate diagnosis of Alzheimer's Disease (AD) and Mild Cognitive Impairment (MCI) is important in early dementia detection and treatment planning. Most of current studies formulate the AD diagnosis scenario as a classification problem and solve it using various machine learners trained with multi-modal biomarkers. However, the diagnosis accuracy is usually constrained by the performance of the machine learners as well as the methods of integrating the multi-modal data. In this study, we propose a novel diagnosis algorithm, the Multifold Bayesian Kernelization (MBK), which models the diagnosis process as a synthesis analysis of multi-modal biomarkers. MBK constructs a kernel for each biomarker that maximizes the local neighborhood affinity, and further evaluates the contribution of each biomarker based on a Bayesian framework. MBK adopts a novel diagnosis scheme that could infer the subject's diagnosis by synthesizing the output diagnosis probabilities of individual biomarkers. The proposed algorithm, validated using multimodal neuroimaging data from the ADNI baseline cohort with 85 AD, 169 MCI and 77 cognitive normal subjects, achieves significant improvements on all diagnosis groups compared to the state-of-the-art methods."}, {"section_title": "Introduction", "text": "Alzheimer's Disease (AD) is the most common neurodegenerative disorder among aging people and its dementia symptoms gradually deteriorate over years. Mild Cognitive Impairment (MCI) represents the transitional state between AD and cognitive normal (CN) with a high conversion rate to AD. The accurate diagnosis of AD, especially the early diagnosis of MCI converters who develop into AD in a short term, is important in identifying subjects at a high risk of dementia, thereby planning appropriate treatments accordingly.\nNeuroimaging, such as Magnetic Resonance Imaging (MRI) and Positron Emission Tomography (PET), is a fundamental component in the diagnosis and prognosis of AD and MCI. More recently, the large neuroimaging data repositories, e.g., the Alzheimers Disease Neuroimaging Initiatives (ADNI) [1] , boost the research in AD and MCI. Many non-imaging biomarkers, such as cerebrospinal fluid (CSF) measures, genetic biomarkers and clinical assessments, are also provided for the researchers to design algorithms to achieve more accurate diagnosis. Most of the current studies formulate the diagnosis scenario as a classification problem and solve it using various machine learners. These studies are conducted in a similar fashion. The primary features are usually extracted from the MRI data [2] [3] [4] [5] [6] [7] [8] [9] and/or PET data [4] [5] [6] [7] [8] , and sometimes combined with other biomarkers, e.g., CSF measures [4, 6, 8] , genetic biomarkers [4, 6, 7] and clinical assessments [6] . The features are then fed into the classifiers, which are trained for future classifications. A challenge of this workflow is how to combine the multi-modal data. Many studies select a subset of features [5, 7, 9] , based on the assumption that certain features are not important and therefore could be discarded. However, it is difficult to compare the multi-modal features on the same basis, and the grouping effects of features are usually ignored in feature selection. Several studies attempt to embed the multi-modal features into a unified feature space by linear analysis, e.g., Partial Least Squares (PLS) [4] , or non-linear analysis, e.g., ISOMAP [2] , yet the existing embedding algorithms could not sufficiently smooth the embeddings of multi-modal features. Another limitation is that the classification accuracy is always constrained by the performance of the classifiers, e.g., support vector machine (SVM) enforces the global consistency and continuity of the boundaries and ignores the local information. The domain knowledge can be used to manipulate the classifiers to further boost the performance [5] . However, the performance gain of such classifier-oriented manipulation might not be transferable when combined with other classifiers. In addition, the domain knowledge might lead to biased classification.\nIn this study, we propose a novel diagnosis algorithm, the Multifold Bayesian Kernelization (MBK), to model the diagnosis process as a synthesis analysis of multi-modal biomarkers. MBK constructs non-linear kernels to obtain the diagnosis probabilities based on individual biomarkers. It derives the weights of the biomarker-specific kernels with the minimum cost of diagnostic errors and kernelization encoding errors using a Bayesian framework, and infers the subjects diagnosis by synthesizing the output diagnosis probabilities of individual biomarkers. One prominent advantage of MBK is its multi-class nature, unlike other multi-modal methods based on two-class classifications [6] [7] [8] . We evaluate the MBK algorithm with 4 diagnosis groups from the ADNI baseline cohort, and the preliminary results show that the MBK algorithm outperforms the state-ofthe-art classification-based methods in the diagnosis of AD and MCI."}, {"section_title": "Multifold Bayesian Kernelization", "text": ""}, {"section_title": "Algorithm Overview", "text": "The goal of the Multifold Bayesian Kernelization (MBK) algorithm is to construct a set of kernels for multi-modal biomarkers and find an optimal way to integrate the diagnosis probabilities of individual biomarkers to enhance the AD and MCI diagnosis. It takes three steps to achieve this goal.\nAssume we have a feature set X of N subjects with a collection of B biomarkers, M , the labels of the subjects represented as Y = {y 1 , . . . , y N }, the feature for the i th biomarker,\nwhere V (i) is the dimension of the features. In the K-step, we aim to learn a kernel, K (i) , for each biomarker to encode X (i) in such a way to maximize the local neighborhood affinity. Then in the B-step, the contribution of each kernel is evaluated based on the Bayesian framework by iteratively minimizing two types of errors: the overall diagnostic errors and the sum of individual kernelization encoding errors. Finally, in the M-step, MBK infers the diagnosis of an unknown subject, x, by synthesizing the diagnosis probabilities of individual biomarkers available to x. The proposed diagnosis scheme could take arbitrary biomarkers for analysis. Figure 1 illustrates the workflow of this algorithm. "}, {"section_title": "K-step: Single-fold Kernelization", "text": "Single-fold kernelization aims to preserve the local information and provides a way to infer the subjects label from its affinity to its labeled neighbors. Such local information is essential in AD diagnosis because the features usually have high noise to signal ratio and the data points may not be linearly separable in the feature space.\nWe construct the kernels for the biomarkers individually by codebook quantization [10] . To begin with, we employ affinity propagation algorithm [11] to select a set of exemplars with least square errors to represent the dataset. The kernel, K (i) , is defined as the kernelization codebook of the derived T exemplars, i.e.,\n. Each exemplar, \u03b5 t , represents a cluster, C t , in the feature space, and the marginal distribution of labels given \u03b5 t is defined as:\nwhere N t is the number of members in C t , and P (x (i) ) is the label distribution for x (i) estimated from itself and its k nearest neighbors. K (i) is used to encode the original features of an unknown subject, x (i) , into a new codeword as:\nThe diagnosis probability of x (i) is derived as the label distribution of its nearest exemplar, i.e., P ( x (i) ) = P (y|sig( x (i) )), and the predicted label of x (i) is defined as:"}, {"section_title": "B-step: Bayesian Inference", "text": "In the B-step, we seek to optimally integrate the kernels, K, that could not only achieve more accurate diagnosis, but also preserve the local information of the original features [10] , i.e., K = arg max(I(K, Y ) + I(X, K)), where I( * , * ) is the mutual information between two items. This optimization problem is equivalent to deriving the weights of each kernel, W , with the minimum cost of the two types of errors, i.e., the overall cost of diagnostic errors and the sum of cost of individual kernelization encoding errors, as in Eq. (4):\n. (4) where y j,M,W is the synthesized diagnosis using all the biomarkers as defined in Eq. (6), D( * , * ) is the Kullback-Leibler divergence, and \u03b2 is the trade-off parameter between these two types of errors. We initialize W equally, assuming the contributions of all the biomarkers are the same and then iteratively update W as follows: we recalculate the cost derived from each kernel after each iteration and then normalize the costs by the total cost as the inferred posterior weights, W ; we subtract the average weights of all kernels from W to derive the change rates of the kernels, dW , then use (W \u2212 dW ) as the new input to the Bayesian framework; we repeat this process until the cost is minimized and no further improvement can be made."}, {"section_title": "M-step: Multifold Synthesis", "text": "The M-step is used to infer the diagnosis probabilities of a given testing subject with a set of biomarkers, M . The subjects are first encoded into the codewords with the single-fold kernels of M to derive the diagnosis probabilities based on each biomarker. The diagnosis probabilities using individual kernels are further combined using W to compute the integrated diagnosis probabilities as:\nwhere sig( x (i) ) is the codeword of x derived from the i th single-fold kernelization. Thus the synthesized diagnosis of x is defined as:\nNote that M is not required to be equal to M . This is because the outputs of the M-step are the diagnostic probabilities and the diagnosis can be made based on arbitrary number of biomarkers without a need to re-train the model, although more biomarkers may lead to more deterministic diagnoses. This flexibility makes the MBK algorithm more practical than the metric-based classifiers."}, {"section_title": "Experiments", "text": ""}, {"section_title": "Data Acquisition and Feature Extraction", "text": "The experiment datasets were obtained from the ADNI database [1] . Totally 331 subjects were selected from the ADNI baseline cohort, including 85 AD-, 169 MCI-and 77 CN-subjects. The MCI group was further divided into two sub-groups. There were 67 MCI subjects converted to AD in half to 3 years from the first scan, and they were considered as the MCI converters (cMCI). The other 102 MCI subjects were then considered as the non-converters (ncMCI). For each subject, an FDG-PET image and a T1-weighted volume acquired on a 1.5 Tesla MR scanner were retrieved. All the 3D MRI and PET data were processed following the ADNI image correction protocols [1, 12] . The PET images were aligned to the corresponding MRI image using FSL FLIRT [13] . We then nonlinearly registered the MRI images to the ICBM 152 template [14] with 83 brain functional regions using the Image Registration Toolkit (IRTK) [15] . The outputted registration coefficients by IRTK were applied to warp the aligned PET images into the template space. We finally mapped all brain functional regions on each registered MRI and PET image using the multi-atlas propagation with enhanced registration (MAPER) approach [16] . Four types of features were extracted from each of the 83 brain regions, including the average cerebral metabolic rate from PET data, and the grey matter volume, solidity, and convexity features from MRI data. Totally 332 sets of features were extracted for each subject. In this study, we used each set of features to represent a biomarker, thus, the feature dimension was 1 for all biomarkers, i.e.,\n. Figure  2 shows the process of the data pre-processing and feature extraction. "}, {"section_title": "Performance Evaluation", "text": "We compared the diagnosis performance of the proposed MBK algorithm to three state-of-the-art neuroimaging classification algorithms. We used ISOMAP, same as in [2] , as the benchmark of the feature embedding algorithms. Elastic Net was used as the benchmark of the feature selection algorithms, same as in [7] . We further implemented a domain-knowledge-learning graph cuts (DKL-GC) algorithm, a variant of [5] , as the benchmark of supervised learning algorithms. More specifically, we designed a cost function to encode the different AD conversion rates and minimize the type II error for cMCI, The features processed by EN and ISOMAP were fed into the SVM with Gaussian kernels. The optimal trade-off parameter (C) and the kernel parameter (\u03b3) for Gaussians in SVM, and the cost function weight parameters in DKL-GC were estimated via grid-search. The parameter settings of MBK were set by pilot experiments ([k, \u03b2] = [5, 0.5] in this study). A 5-fold cross-validation paradigm was adopted throughout all the algorithms for performance evaluation with a separate subset of the dataset as the testing set and the rest subset as training set each time. SVM was implemented using LIBSVM library [18] and the DKL-GC optimization was solved by the GCO V3.0 library [19] . Note that for the MBK method, the same training set was used to construct the single-fold kernels in K-step as well as to derive the kernel parameters in B-step for each fold. The average classification accuracy of 4 diagnosis groups was used to evaluate the performance of different algorithms."}, {"section_title": "Results", "text": "We divided the biomarkers into two groups according to their modalities, including 83 biomarkers from PET data, and 249 biomarkers from MRI data. We then conducted the Bayesian inference in the B-step in MBK using the PET group, MRI group and the merged group (PET + MRI). Figure 3 demonstrates the average diagnosis accuracy and the cost of errors based on the updated weights derived during iteration. The error bars indicate the mean values and standard deviations of the 5 measures by cross-validation. We found that the merged group achieved the highest accuracy with the lowest error cost after 11 iterations and its performance stays stable after 15 iterations. Table 1 shows the results of the proposed MBK algorithm compared to ISOMAP and EN with SVMs, and DKL-GC. The MBK algorithm outperformed the other classification-based algorithms in all diagnostic groups, achieving an average accuracy of 74.2% compared to 38.4% of the ISOMAP, 54.3% of EN, and 63.29% of DKL-GC. The ISOMAP method had the lowest performance, which indicated that it was not suitable for multi-modal feature embedding. EN introduced l 1 and l 2 penalties on the feature variables to encourage the grouping effect, therefore the correlation between features were better preserved and it achieved better results than ISOMAP. DKL-GC algorithm was specifically designed for prediction of cMCI, as a result the cMCI classification rate of DKL-GC was markedly higher than ISOMAP and EN. However, it required the prior knowledge to assign higher penalty for a cMCI type II error to achieve better cMCI detection; the performance of ncMCI classification was compromised due to such penalty function design. The MBK algorithm requires no domain knowledge and it will not bias the performance of certain diagnosis groups. Table 1 also shows the performance of MBK on 83 PET biomarkers alone using the average weights derived by 5-fold cross-validation for 332 PET+MRI biomarkers. The performance of PET biomarkers alone is not as high as the merged PET+MRI biomarkers, but is comparable with other algorithms. This demonstrates that the MBK works well with varying biomarker set."}, {"section_title": "Conclusions", "text": "In this study, we presented a novel diagnosis algorithm, the Multifold Bayesian Kernelization, for the diagnosis of AD and MCI. It differs from the classificationbased methods in that: 1) it models the diagnosis process as a synthesis analysis of multi-modal biomarkers; 2) it adopts a novel diagnosis scheme synthesizing the outputted diagnosis probabilities of individual biomarkers instead of combining the inputted features of the biomarkers. The preliminary results showed that the MBK algorithm outperformed the state-of-the-art classification-based methods and had a great potential in computer aided AD diagnosis."}]
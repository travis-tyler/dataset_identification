[{"section_title": "Abstract", "text": "Understanding the factors that explain differences in survival times is an important issue for establishing policies to improve national health systems. Motivated by breast cancer data arising from the Surveillance Epidemiology and End Results program, we propose a covariate-adjusted proportional hazards frailty model for the analysis of clustered right-censored data. Rather than incorporating exchangeable frailties in the linear predictor of commonly-used survival models, we allow the frailty distribution to flexibly change with both continuous and categorical cluster-level covariates and model them using a dependent Bayesian nonparametric model. The resulting process is flexible and easy to fit using an existing R package. The application of the model to our motivating example showed that, contrary to intuition, those diagnosed during a period of time in the 1990s in more rural and less affluent Iowan counties survived breast cancer better. Additional analyses showed the opposite trend for earlier time windows. We conjecture that this anomaly has to be due to increased hormone replacement therapy treatments prescribed to more urban and affluent subpopulations."}, {"section_title": "", "text": "Understanding the factors that explain differences in survival times is an important issue for establishing policies to improve national health systems. Motivated by breast cancer data arising from the Surveillance Epidemiology and End Results program, we propose a covariate-adjusted proportional hazards frailty model for the analysis of clustered right-censored data. Rather than incorporating exchangeable frailties in the linear predictor of commonly-used survival models, we allow the frailty distribution to flexibly change with both continuous and categorical cluster-level covariates and model them using a dependent Bayesian nonparametric model. The resulting process is flexible and easy to fit using an existing R package. The application of the model to our motivating example showed that, contrary to intuition, those diagnosed during a period of time in the 1990s in more rural and less affluent Iowan counties survived breast cancer better. Additional analyses showed the opposite trend for earlier time windows. We conjecture that this anomaly has to be due to increased hormone replacement therapy treatments prescribed to more urban and affluent subpopulations.\n1. Introduction. Based on data gathered for Iowa State in the Surveillance Epidemiology and End Results (SEER) program of the National Cancer Institute, we assess the effect of potential risk factors for womens' breast cancer. This involves the analysis of clustered time-to-event right-censored data, where event times of patients from the same county of residence are expected to be associated with each other, possibly due to sharing common unobserved characteristics, such as region-specific differences in environments, treatment resources or diagnosis of the patients. As is widely known, taking into account the clustered nature of the data is a must to obtain valid statistical inferences [see, e.g., Therneau and Grambsch (2000) , Chapter 8] .\nA standard way of modeling clustered survival data is to introduce a common random effect (frailty) into the survival model for each cluster, yielding shared frailty models. \"Frailties,\" termed by Vaupel, Manton and Stallard (1979) , were originally introduced to deal with possible heterogeneity due to unobserved covariates and are regarded as unobserved common characteristics for each cluster able to account for the dependence among event times. In the context of the proportional hazards (PH) model, as conventionally implemented, frailties are incorporated into the linear predictor, and the median or mean of the frailty distribution is constrained to be zero to avoid identifiability problems. Conditional on the frailty, the model retains its interpretation in terms of constants of proportionality of the hazards. Survival models with frailties have been extensively used in the statistical literature, especially when the comparison of event times within cluster is of interest.\nA common assumption in shared frailty survival models is the one of homogeneity, where the frailties are assumed to be independent and identically distributed (i.i.d.) random variables from a parametric or nonparametric distribution [see, e.g., Clayton and Cuzick (1985) , Gustafson (1997) , Qiou, Ravishanker and Dey (1999) , Walker and Mallick (1997) ]. Although the nonparametric approach provides flexibility in capturing a frailty distribution's variance, skewness, shape and even modality, it essentially assumes that these frailty distributional aspects are the same across all the clusters, which may be restrictive for particular data sets [Noh, Ha and Lee (2006) ]. For example, in the kidney transplantation study, Liu, Kalbfleisch and Schaubel (2011) argue that the frailty distribution may be affected by some cluster-level covariates, since \". . . urban transplant facilities may exhibit more uniform practices than rural transplant hospitals, corresponding to less heterogeneity (smaller variance) for frailties of urban centers. . . \" Ignoring such heterogeneity can drastically affect the inference for clusterspecific effects and prediction [McCulloch and Neuhaus (2011)] .\nAs the process generating the frailty terms is on its own right of scientific interest, different extensions of the i.i.d. frailty modeling approach have been considered. Wassell and Moeschberger (1993) studied the impact of interventions in the Framingham Heart Study by introducing a modified gamma frailty with a pairwise covariate-dependent parameter. Yashin and Iachine (1999) considered the dependence between frailty and observed covariates (BMI and smoking) in Danish twins to investigate the heritability of susceptibility to death. Noh, Ha and Lee (2006) verified frailty distribution heterogeneity in a well-known kidney infection data set by applying a dispersed normal model. Cottone (2008) assumed either Bernoulli or normal distributions for the frailties where the frailty distribution mean or variance depends on cluster-level covariates through specified link functions. Liu, Kalbfleisch and Schaubel (2011) proposed a covariate-dependent positive stable shared frailty model with an application to kidney transplantation data from the Scientific Registry of Transplant Recipients, and demonstrated the heterogeneity in facility performance. Wang and Louis (2004) studied a related approach for binary data that has both conditional and marginal interpretation using the so-called bridge distribution instead of positive stable.\nThe previously described model extensions allow for particular and specific aspects of distributional shape to change with cluster-level covariates. However, a more thorough evaluation of the effect of the predictors should account for potential changes in characteristics of the frailty distribution other than just, for example, the location or scale. It is, for instance, useful to examine potential changes in the skewness, symmetry and multimodality of the frailty distribution. Therefore, a nonparametric formulation that anticipates changes in shape, skew and modality beyond simple location models is of interest.\nIn this paper, we propose a practicable and general framework for modeling clustered survival data as a function of covariates, based on a predictordependent Bayesian nonparametric model for the frailties and the Cox's PH model. Under the proposed approach the frailty distribution flexibly changes with both continuous and categorical cluster-level covariates, thus allowing for full heterogeneity across clusters. We apply this modeling approach to a subset of the SEER county-level breast cancer data consisting of 1073 women diagnosed with malignant breast cancer during 1995-1998. Important patient-level covariates include age at diagnosis, race, county of residence and the stage of the disease. Additional county-level covariates potentially associated with breast cancer survival are also available from census data, including median household income, poverty level, education and a rurality measure. These area-level socioeconomic factors have been discovered to be associated with breast cancer by many researchers [e.g., Sprague et al. (2011) ]. Women living in more affluent or less rural geographic areas tend to survive breast cancer better after a diagnosis than those living in regions with indicators of low socioeconomic status. Moreover, rural counties may present more heterogeneity in access to quality care and screening for breast cancer, leading to more variability for frailties of rural counties [Zhao and Hanson (2011) ]. This suggests to us that the frailty distribution could be potentially affected by these county-level socioeconomic factors. The results show that the proposed model provides better goodness of fit to the data and is predictively superior to the traditional PH spatial frailty model, as well as helping to piece together a plausible story for the data in terms of the prescribing of hormone replacement therapy. The paper is organized as follows. In Section 2 we introduce the proposed frailty PH model, including a detailed description of the dependent Bayesian nonparametric model and the Markov chain Monte Carlo (MCMC) implementation of the posterior computations. Section 3 provides a detailed analysis of the motivating data set. Section 4 presents the results of simulation studies to evaluate the performance of the proposed model. Some concluding remarks and a final discussion are given in Section 5.\n2. Covariate-adjusted frailty proportional hazards model."}, {"section_title": "2.1.", "text": "The modeling approach. Suppose that right-censored survival data (w ij , t ij , \u03b4 ij ) are collected for the jth subject of the ith cluster, where j = 1, . . . , n i , i = 1, . . . , n, w ij is a p-dimensional vector of exogenous covariates, t ij is the recorded event time, and \u03b4 ij is the censoring indicator equaling 1 if t ij is an observed event time and equaling 0 if the event time is right-censored at t ij . Let T ij and C ij be the event and censoring times, respectively, for the jth subject in the ith cluster. To take into account the within-cluster association structure, a frailty PH model is assumed for T ij . The conditional PH assumption implies that the hazard function of T ij is given by\nwhere e = (e 1 , . . . , e n ) \u2032 is an unobserved vector of frailties, and \u03bb 0 (t) is the baseline hazard function corresponding to the event time of a subject with covariates w = 0 and e = 0. We additionally assume a conditionally independent censoring scheme, that is, C ij and T ij are independent given w ij and e i . Often the frailties are assumed to be exchangeable or i.i.d. from some parametric or nonparametric distribution G. For instance, Therneau, Grambsch and Pankratz (2003) considered exchangeable Gaussian frailties and proposed an estimation procedure based on a Laplace approximation of the likelihood function leading to a penalized partial likelihood. This approach, referred to below as GF, will be compared with our method in the simulation studies. Now consider a partition of the predictor vector w ij = (w \u2032 ij , x \u2032 i ) \u2032 , where x i \u2208 X \u2286 R q is a q-dimensional vector of cluster-level covariates andw ij is a (p \u2212 q)-dimensional vector of subject-specific covariates, respectively, and the corresponding partition of the regression coefficient vector \u03be = (\u03be \u2032 , \u03be \u2032 x ) \u2032 . On the scale of the linear predictor w \u2032 ij \u03be + e i , the frailty e i models the clusterspecific behavior and its distribution G is shifted by x \u2032 i \u03be x . Therefore, the homogeneity assumption implies that the vector of cluster-level covariates x i modifies only the location of the distribution of cluster-specific effects but not its shape. To relax this assumption, we consider a covariate-adjusted 5 frailty PH model, where the frailty distribution depends on cluster-level covariates x i . That is,\nwhere for every x \u2208 X , G x is a probability measure defined on R; this specifies a probability model for the entire collection of probability measures G X = {G x : x \u2208 X }, such that its elements are allowed to smoothly vary with the cluster-level covariates x. Specifically, we consider a mixture of linear dependent tailfree processes (LDTFP) prior for G X , denoted as\nand\nwhere J \u2208 N is the level of specification of the process, c \u2208 R + is a prior precision parameter controlling the prior variability of the process, h(\u00b7) = exp{\u00b7} 1+exp{\u00b7} , \u03a0 J,\u03b8 is a J -level sequence of binary partitions of R, depending on the scale parameter \u03b8 \u2208 R + , A J,c,\u03c1 = {2n/c\u03c1(1), . . . , 2n/c\u03c1(J)} is a collection of positive numbers depending on J , c and \u03c1, \u03c1 : N \u2212\u2192 R + is an increasing function, and Q is a probability measure defined on R + . The LDTFP is specified such that for every x \u2208 X , the process G x is centered around an N (0, \u03b8) distribution, that is, E(G x ) = N (0, \u03b8), for every x \u2208 X . Furthermore, the process is specified such that for every x \u2208 X , G x is almost surely a median-zero probability measure. The latter property is important to avoid identifiability problems. The LDTFP process includes as important special cases a nonparametric exchangeable frailty model where\nAs shown by , dependent tailfree processes have appealing theoretical properties, such as continuity as a function of the predictors, large support on the space of conditional density functions, straightforward posterior computation relying on algorithms for fitting generalized linear models, and the process closely matches conventional Polya tree priors [see, e.g., Hanson (2006a) ] at each value of the predictor, which justify its choice here. Polya trees have been extensively studied in the literature and have desirable properties in terms of support and posterior consistency. Details on the trajectories of LDTFP(h, \u03a0 J,\u03b8 , A J,c,\u03c1 ), useful for a complete implementation of algorithms for exploring the corresponding posterior distributions, are given in Appendix A of the supplementary material [Zhou et al. (2015) ].\nOther dependent processes could be considered for G X , but a highly limiting requirement is that some aspect of the location, for example, mean or median, can be fixed. There are few examples where the process changes smoothly with covariates; one is the multivariate beta process of Trippa, M\u00fcller and Johnson (2011) . Another approach using Dirichlet process mixtures can be found in Reich, Bondell and Wang (2010) , but this latter approach would have to be extended to allow the means or variances of the two mixture components to change with covariates.\n2.2. Posterior computation. The conditional likelihood for (\u03be, \u03bb 0 , e) is given by\nwhere \u039b 0 (t) = t 0 \u03bb 0 (s) ds is the cumulative hazard function. The piecewise exponential model provides a flexible framework to deal with the baseline hazard [see, e.g., Walker and Mallick (1997) ]. We partition the time period\n. . , K, where a 0 = 0 and a K = max{t ij }. The baseline hazard is assumed to be constant within each interval, that is,\nwhere \u03bb 1 , . . . , \u03bb K are unknown hazard values and I{A} is the usual indicator function, that is, 1 when A is true, 0 otherwise. The prior hazard is specified by the hazard values {\u03bb k } K k=1 and cut-point vector a = (a 1 , . . . , a K ). If the prior on the \u03bb k 's is taken to be independent gamma distributions and\nis a reasonably fine mesh, the gamma process [Kalbfleisch (1978) ] is approximated. To determine the cut-point vector a, one can set a k to be the k K th quantile of the empirical distribution of the t ij 's, or choose them based on other considerations (see Section 3.2). Some authors have considered random cut-points [see, e.g., Sahu and Dey (2004) ]. Regardless, the resulting model implies a Poisson likelihood [Laird and Olivier (1981) ] as follows. Let K(t) = min{k : a k \u2265 t}, \u2206 k (t) = min{a k , t} \u2212 a k\u22121 , and\nwhere \u03b9 k is a K-dimensional vector of zeros except the kth element is 1 and \u03bb = (log(\u03bb 1 ), . . . , log(\u03bb K )) \u2032 . Then the likelihood for (\u03b3, e) becomes\nwhere \u00b5 ijk = exp{z \u2032 ijk \u03b3 + e i + log(\u2206 k (t ij ))} and p(y ijk |\u03b3, e i ) is the probability mass function for a Poisson distribution with mean \u00b5 ijk . For each\nThus, the proposed covariate-adjusted frailty PH model takes the following hierarchical structure:\nwhich largely simplifies computations, where N p (m, S) refers to a p-variate normal distribution with mean m and covariance matrix S. This forms the basis of an efficient Markov chain Monte Carlo (MCMC) scheme for obtaining posterior inference, which can be implemented using available software for generalized linear mixed models. A full description of the MCMC algorithm is given in Appendix B of the supplementary material [Zhou et al. (2015) ]. Sample R code using the LDTFPglmm function available in DPpackage ] is provided in Appendix C of the supplementary material [Zhou et al. (2015) ]. Time-dependent subject-specific covariates that are step-processes [Hanson, Johnson and Laud (2009) ] are naturally accommodated by including the times where the covariate values change across all subjects into the cutpoint vector a. All that is changed above is z ijk = (\u03b9 \u2032 k , w \u2032 ijk ) \u2032 , that is, w ij is replaced with its time-varying analogue w ijk . Similarly, time-varying regression effects can be included by replacing z \u2032 ijk \u03b3 with z \u2032 ijk \u03b3 k in \u00b5 ijk , yielding very general models. The proposed model implies exchangeable frailties for 8 ZHOU, HANSON, JARA AND ZHANG each subgroup with a unique x \u2208 X . Time-dependent cluster-specific covariates are therefore naturally included in the model by simply allowing x to change with time. For example, in the SEER data set analyzed over a larger time window, for subjects living in the ith county, one could include into x i the median house income of that county at their particular diagnosis year. Furthermore, the frailty distribution can itself evolve in time by simply including time as a covariate in x, or a time-by-cluster covariate interaction could also be entertained."}, {"section_title": "Analysis of SEER county-level breast cancer data.", "text": "3.1. The Iowa SEER data. The SEER program of the National Cancer Institute (see http://seer.cancer.gov/) is an authoritative source of information on cancer incidence and survival in the US, providing county-level cancer data on an annual basis for particular states for public use. We fit our proposed covariate-adjusted frailty Cox's PH model to a subset of the Iowa SEER breast cancer survival data, which consists of a cohort of 1073 women from the 99 counties of Iowa, who were diagnosed with malignant breast cancer in 1995, with enrollment and follow-up continued through the end of 1998. The observed survival time, from 1 to 48, was calculated as the number of months from diagnosis to either death or the last followup. In our analysis, only deaths due to metastasis of cancerous nodes in the breast were considered to be events, while the deaths from other causes were censored at the time of death. That is, we consider cause-specific survival models assuming that all other deaths are independent of breast cancer. By the end of 1998, a total of 488 patients (45.5%) had died of breast cancer, while the remaining 585 patients were censored, either because they died of other causes or survived until the last follow-up.\nFor each patient, the observed survival time and county of residence at diagnosis are recorded. The data set also has individual-level covariates including age at diagnosis and the stage of the breast cancer: local (confined to the breast), regional (spread beyond the breast tissue), or distant (metastasis). We create two dummy variables for regional and distant, respectively, and treat the patients in the local group as the baseline. Although several individual-level covariates that affect breast cancer survival are not available (e.g., age at first child, age at menopause and breastfeeding), we are able to obtain county-level covariates potentially associated with breast cancer survival from census data, such as median household income (small area estimates in 1993), poverty level (percentage of families in poverty in 1990), education (percentage with Bachelor's degree or higher in 1990) and rurality (Rural-Urban Continuum Codes in 1993). The Economic Research Service Rural-Urban Continuum Codes (RUCC) vary from 1 to 9 (see www.ers.usda.gov/data-products/rural-urban-continuum-codes), distinguishing metropolitan counties by the population size of their metro area and nonmetropolitan counties by degree of urbanization and adjacency to a metro area. Higher RUCC indicates a more rural county. Other county-level covariates mentioned above are available at http://data.iowadatacenter. org/browse/counties.html. Since the effects of education and poverty on the survival times are not significant based on our initial model fitting by the proposed method, we exclude them in the analysis presented below. Thus, we have three-dimensionalw ij and two-dimensional x i . Table 1 presents several summary statistics for the data. As shown in Figure 1 , median household income and RUCC are significantly, negatively correlated.\nTo get an initial feeling about the role that each county-level covariate is playing, Table 2 provides the distribution of each county-level covariate stratified by the individual-level stage of disease. The gamma statistic (GK), originally proposed by Goodman and Kruskal (1954) , is calculated to quantify the association between each county-level covariate and the stage of disease. The GK values range from \u22121 (100% negative association) to 1 (100% positive association), where the value 0 indicates no association. We see that women with a distant-stage at diagnosis are much more likely than those with a local-stage to live in counties with a high degree of urbanization (GK = \u22120.11; 95% CI: from \u22120.20 to \u22120.01), while the association between stage and income is not significant (GK = 0.04; 95% CI: from \u22120.06 to 0.13). These associations roughly imply that women living in urban counties may suffer poorer survival, assuming that women in distant-stage are more likely to die than women in other stages. Next, we carefully examine , 11, 16, 17, 19, 20, 25, 28, 29, 36, 40, 44, 47 ).\nboth these individual-level and county-level covariates in relation to breast cancer survival, fitting the covariate-adjusted frailty proportional hazards model. 3.2. Models and model comparison. We fitted the proposed covariateadjusted frailty PH model for the Iowa SEER data with different countylevel covariates, including models with RUCC only (Model 1), with median household income only (Model 2) and with both (Model 3). To see how the piecewise assumption of baseline hazard affects the predictive ability of models, we considered three specifications of cut-point vector a as follows:\nCase I. a = (1, 11, 16, 17, 19, 20, 25, 28, 29, 36, 40, 44, 47) , which was determined by visually examining Breslow's estimate of \u03bb 0 (t) using the GF approach, which is given in panel (b) of Figure 1 .\nCase II. a = (3, 7, 12, 16, 19, 24, 29, 34, 41, 47) , where a k is the k 10 th quantile of the empirical distribution of observed survival times.\nCase III. a = (47), which yields an exponential baseline hazard.\nIn all cases, we set J = 4. We fitted all the models using the corresponding variants of the algorithm described in Appendix B of the supplementary material [Zhou et al. (2015) ] and similar prior specifications suggested in the simulation study. The Markov chain mixed reasonably well despite the high dimension of our models. For each version of our model and case, we ran a single Markov chain of 1,020,000. A total number of 20,000 were discarded as burn-in period and 10,000 samples were retained for posterior inference. Moreover, we also considered another case II with 13 cut-points and cutpoint specifications based on the event time quantiles from the Kaplan-Meier curve in Appendix E of the supplementary material [Zhou et al. (2015) ]. The results show that carefully choosing the cut-points is more important than simply increasing the number of cut-points.\nFor the sake of comparison, we further fitted the exchangeable MPT frailty Cox model and the Bayesian exchangeable Gaussian frailty Cox model. We compare the models using the log pseudo marginal likelihood (LPML) developed by Geisser and Eddy (1979) and the deviance information criterion (DIC) proposed by Spiegelhalter et al. (2002) . In the context of the frailty Cox model, the LPML for model M is defined as LPML = n i=1 n i j=1 log(CPO ij ), where CPO ij , the ijth conditional predictive ordinate, is given by [\u03bb(t ij ) \u03b4 ij e \u2212\u039b(t ij ) |D (ij) ] with D (ij) denoting the remaining data after excluding the ijth data point D ij . One can use the simple method suggested by Gelfand and Dey (1994) to estimate the CPO statistics from MCMC output. A larger value of LPML indicates the corresponding model has better predictive ability. Furthermore, Geisser and Eddy (1979) discussed the exponentiated difference in LPML values from two models to obtain what they termed as a pseudo Bayes factor (PBF). The PBF is a surrogate for the more traditional Bayes factor and can be interpreted similarly, but is more analytically tractable, much less sensitive to prior assumptions, and does not suffer from Lindley's paradox. Set \u2126 = (e, \u03b3, \u03b2, \u03b8) as the \nwhich is referred to as the deviance function, and p D =D \u2212 D(E \u2126|D {\u2126}) which is a measure of model complexity. Note that the DIC is also readily computed from MCMC output.\n3.3. Results. Table 3 shows the DIC and LPML for all models under consideration. All models under case I provide significantly better prediction as measured by both DIC and LPML, with differences in the range of 20-55 for DIC and 10-25 for LPML, which indicates that the determination of the cut-point vector for the baseline hazard plays an important role on model prediction and fit. Comparing the frailty specifications in Model 1 across all cases, the DIC and LPML show the same trend for goodness of fit, with the proposed model based on the LDTFP frailty model outperforming both the MPT and Gaussian models, although the differences are only in the range of 1-4. Comparing between Model 2 and Model 3, the proposed model is always preferred in terms of LPML, while the MPT model is slightly better than others in term of DIC under Model 2. Comparing all the proposed models across Model 1-Model 3, the results indicate that Model 1 always performs best. Overall, allowing the frailty distribution to change with county-level covariates (especially RUCC) does improve model prediction according to LPML. In what follows, we present the results under case I. Table 4 presents posterior medians and equal-tailed 95% credible intervals (CI) for main effects (components of \u03be) under Model 1-Model 3, with covariate-adjusted frailties, and compares the individual-level covariate effects, that is, (\u03be 1 , \u03be 2 , \u03be 3 ), to those obtained by Zhao, Hanson and Carlin Zhao, Hanson and Carlin (2009) has an LPML of \u22122226. Therefore, the pseudo Bayes factor for the proposed model versus the CAR model is e 2226-2222 \u2248 55, implying that the proposed model predicts about 55 times better than the model with CAR frailties. In addition, the proposed model offers a unique interpretation. The posterior medians and 95% CIs for all individual-level effects change little across the different versions of the proposed model, indicating that the Cox regression estimates are reasonably stable for these data, except for the estimate of \"Regional stage,\" for which the CAR model 95% CI is much wider than those under the considered versions of the proposed model. This may be partly due to the benefit of including county-level covariates. The best model according to LPML, Model 1, indicates that all the individual-level effects are significant at the 0.05 level. Higher age at diagnosis increases the hazard within each county. For instance, women are about e 0.019\u00d720 \u2248 1.46 times more likely to die from breast cancer than those twenty years younger who have the same disease stage and live in the same county. Compared with women having local stage of disease, women of the same age and living in the same county are e 0.27 \u2248 1.31 times more likely to die if their cancer is detected at the regional stage, and e 1.64 \u2248 5.16 times more likely to die if detected at the distant stage. We additionally present the fixed effects under the marginal PH model (i.e., using the R function coxph with option cluster) across Model 1-Model 3 in Appendix E of the supplementary material [Zhou et al. (2015) ]. Note that the coefficient estimates under the marginal PH model have population-averaged interpretations and cannot be directly compared with those fitted from the proposed frailty PH model due to different model structures.\nRegarding the effect of county-level covariates, living in a higher median household income or urban counties is associated with poorer survival after a breast cancer diagnosis. For example, the results under Model 1 indicate that after controlling for individual covariates and county, the hazard rate of women living in urban counties (with RUCC = 2) will be e 0.105\u00d77 \u2248 2 times larger than that of women in rural counties (with RUCC = 9). The results under Model 2 imply that after controlling for individual covariates and frailties, women have about a 1.7 times larger hazard rate if they live in median household income counties of $35,301 compared with median household income of $23,354 (see also Figure 2 ). Under Model 3, the results indicate that when both the county-level covariates are included simultaneously, their independent effects are attenuated, partly due to the multicollinearity between them (see the middle two plots in Figure 3) .\nWe obtain the fitted predictive frailty densities for both e i (median-zero) and e i + x \u2032 i \u03be x (full distribution) and survival curves for women with mean entry age 68.8 years and distant stage of disease who live in the counties with different levels of median household income or RUCC, under the different versions of the proposed model. The three levels are chosen from the 5%, 50% and 95% quantiles of each covariate value. The results are reported in Figures 2 and 3 . Under our best fitting, Model 1 (see left three plots in Figure 2) , the results indicate that higher values of RUCC increase the frailty variance and suggest a non-Gaussian shape (upper); we also see overall higher frailty after mixing over the location shift x \u2032 i \u03be x (middle) and so poorer survival (lower) in urban counties. Increasing heterogeneity as ruralness increases under Model 1 translates into increasing association among those living in more rural counties versus urban. In Appendix E of the supplementary material [Zhou et al. (2015) ], Kendall's tau is computed and plotted as a function of RUCC for individuals with mean entry age 68.8 years and distant stage. Kendall's tau increases by a factor of three as RUCC goes from 2 to 9. Note that under a traditional gamma frailty model the association is static.\nUnder Model 2, the frailty densities only slightly change compared with Model 1, but we do see poorer survival in counties with higher median household income. Figure 3 demonstrates that after adjusting individual covariates and median household income (right three plots), there is little effect of RUCC on either predictive frailty densities or survival curves; while after adjusting for RUCC (left three plots), the effect of median household income is almost negligible. In Appendix E of the supplementary material [Zhou et al. (2015) ], the survival curves are also compared with those obtained under the marginal PH model. Overall, the marginal PH model under-predicts survival time up to about 1 month, for example, it gives estimates of median survival a month less, compared with our proposed model for patients with mean entry age 68.8 years and distant stage of disease who live in the same county. This may be partly due to the fact that the marginal PH model averages over the changing behavior of the frailty distribution over the ruralness measure.\nIt is widely known that access to quality care and screening for breast cancer is more readily available to those with greater financial means and/or those living in urban areas. Therefore, our findings of increased survival for poorer and more rural counties for this cohort are initially puzzling. However, hormone replacement therapy (HRT) increased about 150% in the 1990s [Wysowski and Governale (2005) ], after several observational studies linked HRT to prevention of osteoporosis and protection from heart disease. However, this increasing use of HRT abated suddenly in 2002, when the Women's Health Initiative clinical trial linked HRT to aggressively invasive breast cancer [Rossouw et al. (2002) ]. In fact, overall breast cancer incidence rates peaked in 1999. Between 2001 and 2004 overall invasive breast cancer incidence declined, but fell much more drastically among women living in urban versus rural counties, and among women living in low-poverty versus high-poverty counties. Hausauer et al. (2009) attribute this discrepancy to greater use of postmenopausal estrogen/progestin hormone replacement therapy among more affluent women and/or women living in urban counties up until 2002, when the Women's Health Initiative trial was stopped prematurely on May 31, 2002, according to Rossouw et al. (2002) , \". . . because the test statistic for invasive breast cancer exceeded the stopping boundary for this adverse effect and the global index statistics supported risks exceeding benefits.\" It is plausible that increased risk (i.e., stochastically larger frailties) in more affluent and more urban counties has to do with a larger proportion of women being prescribed HRT in the late 1980s and 1990s. Further exploratory analyses on other cohorts of SEER Iowan breast cancer data (1975-1979, 1980-1984, 1985-1989 and 1990-1994) show a reversal of the effects of income and ruralness, agreeing with intuition. Paralleling our study, Krieger, Chen and Waterman (2010) used county-level census data on income and found rising and falling breast cancer incidence rates for the SEER data over the range 1992-2005 for caucasian women living in highincome counties, which \"mirrored the social patterning of hormone therapy use.\"\nIn a longer follow-up study of the Women's Health Initiative trial, Chlebowski et al. (2010) found that those on estrogen plus progestin compared to placebo had about 25% higher incidence of invasive breast cancer. Among those diagnosed with breast cancer, the two treatment arms had similar histology, but the estrogen plus progestin group were 78% more likely to have cancers that had spread to lymph nodes than placebo, and the estrogen plus progestin group were about twice as likely to die from breast cancer versus placebo. It would appear that hormone replacement therapy fortified the virulence of breast cancer, significantly increasing both incidence and mortality. This same study showed an impressive 7% one-year drop in incidence right after the Women's Health Initiative study was prematurely stopped and the medical community warned of a possible link between hormone replacement therapy and breast cancer.\n4. Simulation studies. We performed a simulation study to assess the performance of the proposed model. The simulated data are also used to compare the proposed approach with existing models. Specifically, we consider the GF approach described in Section 2.1 and the positive stable frailty Cox model proposed by Liu, Kalbfleisch and Schaubel (2011) . Under this latter model, the shape parameter is allowed to depend on cluster-level covariates. In terms of our notation, they assumed that the conditional hazard function of T ij is\nwhere the baseline hazard functions \u03bb 0i (t) and regression parameters\u03be i are cluster-specific, and exp(e i ) follows a positive stable distribution with shape parameter \u03b1 i \u2208 (0, 1), relying on the cluster-level covariates vector x i through a logit link function, denoted by P S(\u03b1 i ). They did not deal with this model directly, but rather derived the marginal model\nby imposing the restrictions \u03b7 = \u03b1 i\u03bei , H 0 (t) = {\u039b 0i (t)} \u03b1 i , where H 0 (t) = t 0 h 0 (s) ds and \u039b 0i = t 0 \u03bb 0i (s) ds. In other words, they essentially fitted the above marginal Cox model by maximizing the pseudo partial likelihood under the working independence assumption [Wei, Lin and Weissfeld (1989) ], and then utilized the imposed constraints to estimate the parameters in the frailty model. Although they considered a more flexible conditional Cox model, they made many assumptions to get the marginal model, some of which are difficult to check in practice. Moreover, they faced a nonidentifiability problem when a cluster-level covariate was included in the conditional Cox model, so cluster-level covariates had to be excluded from the marginal model as well, leading to potentially poorer prediction of the marginal survival function. Their method, referred to below as PSF, will be compared with our approach focusing on the prediction of survival functions in the simulation studies. A comparison of the two methods for the fixed effect estimates cannot be conducted, since they have different model structures. We conducted the simulation study in R. The GF and PSF approaches were implemented by using the function coxme and coxph (with the option cluster), respectively, included in the R packages coxme and survival.\n4.1. Simulation settings. Two scenarios for the frailty distributions were considered. In the first case, referred to as Scenario I, a covariate-dependent family of distributions is considered, where the density shape evolves from one mode to two as the cluster-specific covariate x increases its value; this mirrors the effect of RUCC in panel (a) of Figure 3 for Model 1. In the second case, referred to as Scenario II, a covariate-dependent positive stable distribution is considered. The specific distributional forms for each setting were the following:\nNote that the first setting is not a particular case of the proposed model; the second setting, chosen from the simulation study of Liu, Kalbfleisch and Schaubel (2011) , is included to evaluate the behavior of the proposed approach when the PSF model is correct.\nGiven the frailties, the data under Scenario I were simulated from the conditional PH model (1) with \u03bb 0 (t) = 1, w ij = (w 1ij , w 2ij , x i ) \u2032 and \u03be = (\u03be 1 , \u03be 2 , \u03be x ) \u2032 = (1.0, 0.5, 1.0) \u2032 ; the data under Scenario II were simulated from the PSF model (2) withw ij = (w 1ij , w 2ij ) \u2032 , \u03b7 = (1, 0.5) \u2032 and H 0 (t) = t. \u223c Bernoulli(0.5), i = 1, . . . , 100, j = 1, . . . , 10. In each case, a noninformative censoring scheme was considered, where the censoring times were simulated from an U (0.25, 4) distribution, so that the censoring rate is approximately 35% under Scenario I and 25% under Scenario II.\nFor each data set, the GF approach was employed, yielding point estimates of \u03be, var(e i ) and e i , which we denote by\u03be (0) ,\u03b8 2(0) and\u00ea (0) i , respectively. Based on these point estimates, the predictive survival function was calculated as follows: [see, e.g., Therneau, Grambsch and Pankratz (2003) , Section 2]. We then fitted the proposed model, by considering J = 4, K = 10, \u03c4 1 = 1.001, \u03c4 2 = 1.001\u03b8 2(0) , a c = 1, b c = 1, \u03b3 0 = 0 13 and S 0 = 10 3 \u00d7 I 13 . For each data set a single Markov chain of length 55,000 was obtained by using the algorithm described in Appendix B of the supplementary material [Zhou et al. (2015) ]. A burn-in period of 5000 scans was considered, and 5000 samples were retained for posterior inferences. The posterior mean of the corresponding parameters are denoted by\u03be,\u03b8 2 ,\u011d(e|x) and\u015c(t|w). Finally, the PSF approach was considered but including the cluster-level covariates in the linear predictor, and the associated predictive survival function, based on Breslow's estimator of the underlying baseline hazard function, was obtained and is denoted by\u015c PSF (t|w).\nThe competing approaches were compared regarding the estimation of the regression coefficients and also compared by computing the weighted integrated squared error (ISE) for the estimated survival distributions, given by\nwhere\u015c m (t|w), S(t|w) and f T (t|w) are the estimated survival function, the true survival function and density function, respectively, for a subject with covariate vector w."}, {"section_title": "Simulation results.", "text": "The results for the regression coefficients using the proposed model and the GF approach under Scenario I are given in Table 5 , where the bias of the corresponding point estimators, the Monte Carlo mean of the posterior standard deviation/standard error (MEAN-SD), the Monte Carlo standard deviation of the point estimates (SD-MEAN) and the Monte Carlo coverage probability (CP) of the 95% credible interval/confidence intervals are presented. The results suggest that the posterior means of \u03be are almost unbiased estimators and that the observed bias for \u03be x under the proposed approach is much smaller than the corresponding value obtained under the GF approach. Moreover, under the proposed model, the MEAN-SD and the SD-MEAN values are in fairly close agreement, indicating that the posterior standard deviation is an unbiased estimator of the frequentist standard error. Finally, the CPs are all around the nominal 95%. The same does not hold for GF, which substantially underestimates the standard error for \u03be x , leading to low coverage probabilities. The average of the estimated frailty distributions and survival functions across simulated data sets for some specific covariate values are presented in Figure 4 for Scenario I and in Figure 5 for Scenario II. The results in Scenario I reveal that the proposed model roughly captures the modal behavior of the covariate-dependent frailty distributions. Although not perfect, the proposed model performs remarkably well given that only n = 100 imperfectly-observed observations were generated for each data set. The situation is much less favorable for the GF approach, which fails to correctly capture the shape of the frailty distributions, leading to poor estimated survival functions. This behavior is likely driving the underestimation of survival noted in the SEER analysis. As expected, the PSF approach also suffers from bad prediction since the underlying assumption for frailty distribution is violated. The results in Scenario II show that the proposed model is still able to capture the frailty distributional shape even when the data were truly generated from the PSF model. Regarding the estimated survival curves, the results suggest that essentially no differences among the three methods are observed; all estimated functions are close to the truth, indicating that there is little price to be paid when using the proposed model for the clustered survival data that were truly generated from the PSF model.\nThe results of the comparison of the estimated survival curves in terms of ISE are presented in Table 6 , where the Monte Carlo mean and standard deviations for the ISE for two different predictor values are given. The results under Scenario I show a close agreement with the observed for the regression coefficients; the proposed model substantially outperforms the other two methods in terms of smaller means and standard deviations of the ISE. Even under Scenario II, the proposed model still provides almost the same results as the PSF model in terms of ISE.\nIn Appendix D of the supplementary material [Zhou et al. (2015) ], additional simulation results are presented which show that, under Scenario I, for larger sample sizes better estimates of the frailty distributions are obtained and that the approach is not affected by the choice of J in the specification of the LDTFP model. For further comparison, we also fitted the exchange- able mixture of Polya trees (MPT) [Hanson (2006b) ] frailty Cox's model using the function PTglmm available in DPpackage ] under Scenario I, in which the results show that our approach outperforms the 24 ZHOU, HANSON, JARA AND ZHANG MPT, and considered a third scenario favorable to the GP approach, where the results show that our method pays little price for the extra generality when using the proposed model when normality and exchangeability are valid assumptions. Overall, the proposed approach provides a flexible way to capture the heterogeneity in the frailty distribution, provides superior prediction, and yields an essential improvement for the estimation of population effects, especially when the intra-cluster correlation (or variability in frailties) is relatively large. When the frailty variances are small across clusters, the proposed approach is still recommended due to its flexibility.\n5. Concluding remarks. Very limited work has been done on covariateadjusted frailty survival models for clustered time-to-event data. Liu, Kalbfleisch and Schaubel (2011) proposed a stratified Cox model with positive stable frailties, where the shape parameter of the frailty distribution is allowed to depend on cluster-level covariates. However, they essentially fitted a marginal Cox model, and then utilized the positive stable assumption and some imposed constraints to estimate the parameters in their proposed model. The model proposed in this paper cleanly separates population-level effects from the cluster-level effects, which determine the shape of the frailty distribution. Frailty density shape is modeled using a tractable median-zero LDTFP prior. Other nonparametric density regression approaches could also be considered; however, model identifiability requires a location constraint such as mean-zero or median-zero. The proposed model provides a natural generalization of the conventional PH model with parametric or nonparametric exchangeable frailties, and accommodates frailty distribution \"evolution\" over cluster-level covariates providing superior prediction, as shown in our simulation studies. When data are truly generated according to an exchangeable Gaussian frailty PH model or the model of Liu, Kalbfleisch and Schaubel (2011) , our model does about the same as the underlying true model in terms of fixed effects and/or marginal survival estimations. We illustrate the usefulness of the proposed model with an analysis of a subset of the Iowa SEER breast cancer data, and demonstrate that higher degree of ruralness corresponds to a more bimodal frailty distributional shape with larger variance. In general, the proposed model is more flexible than currently existing frailty PH models, leading to more robust inferences, and thus is recommended. One drawback of the proposed model is that, as currently fit in R, obtaining inference takes longer.\nFor ease of computation, we have assumed a piecewise constant structure for the baseline hazard function \u03bb 0 (t) and taken the independent normal prior distributions for log(\u03bb k )'s, so that the baseline hazard heights \u03bb k and covariate effects \u03be can be updated simultaneously. The use of empiricallyderived cut-points has permeated much of the Bayesian survival literature for over a decade. Use of Breslow's baseline estimate coupled with the GF approach led to a greatly increased LPML over the empirical approach. An obvious extension of our current work is to employ a smoothed baseline, for example, using penalized B-splines [Hennerfeind, Brezger and Fahrmeir (2006) ], the piecewise exponential with random cut-points [Sahu and Dey (2004) ], MPT [Hanson (2006b) ], etc. Any of these approaches could improve model fit and prediction, but cannot currently be fitted in the R software. We are currently working on extending the methodology in this paper to other survival models and smoothed baselines."}]
[{"section_title": "Abstract", "text": "Early diagnosis, playing an important role in preventing progress and treating the Alzheimer's disease (AD), is based on classification of features extracted from brain images. The features have to accurately capture main AD-related variations of anatomical brain structures, such as, e.g., ventricles size, hippocampus shape, cortical thickness, and brain volume. This paper proposes to predict the AD with a deep 3D convolutional neural network (3D-CNN), which can learn generic features capturing AD biomarkers and adapt to different domain datasets. The 3D-CNN is built upon a 3D convolutional autoencoder, which is pre-trained to capture anatomical shape variations in structural brain MRI scans. Fully connected upper layers of the 3D-CNN are then finetuned for each task-specific AD classification. Experiments on the ADNI MRI dataset with no skull-stripping preprocessing have shown our 3D-CNN outperforms several conventional classifiers by accuracy and robustness. Abilities of the 3D-CNN to generalize the features learnt and adapt to other domains have been validated on the CADDementia dataset.\nIndex Terms-Alzheimer's disease, deep learning, 3D convolutional neural network, autoencoder, brain MRI."}, {"section_title": "INTRODUCTION", "text": "The Alzheimer's disease (AD), a progressive brain disorder and the most common case of dementia in the late life, causes the death of nerve cells and tissue loss throughout the brain, thus reducing the brain volume dramatically through time and affecting most of its functions [1] . The estimated number of affected people will double for the next two decades, so that one out of 85 persons will have the AD by 2050 [2] . Because the cost of caring for the AD patients is expected to rise dramatically, the necessity of having a computer-aided system for early and accurate AD diagnosis becomes critical [3] . This paper focuses on developing an adaptable deeplearning-based system for early diagnosis of the AD. Deep learning helps to solve such a complex medical diagnosis problem by leveraging hierarchical extraction of input data features to improve classification [4] . Several layers of feature extractors are trained to form a model being able to adapt to a new domain by transferring knowledge between different domains and learning distinctive properties of the new data [5, 6] . It has been shown that trained features turn from generality to specificity through layers of a deep network [7] , which relates to transferability of features.\nA robust diagnostics of a particular disease should adapt to various datasets, such as, e.g., MRI scans collected by several patient groups, as to diminish discrepancies in data distributions and biases toward specific groups. Deep learning aims to decrease the use of domain expert knowledge in designing and extracting most appropriate discriminative features [4] .\nSeveral popular non-invasive neuroimaging tools, such as structural MRI (sMRI), functional MRI (fMRI), and positron emission tomography (PET) have been investigated for developing such a system [8, 9] . The latter extracts features from the available images, and a classifier is trained to distinguish between different groups of subjects, e.g., AD, mild cognitive impairment (MCI), and normal control (NC) groups [3, [10] [11] [12] . The sMRI has been recognized as a promising indicator of the AD progression [3, 13] .\nComparing to the known diagnostic systems outlines below in Section 2, the proposed system employs a deep 3D convolutional neural network (3D-CNN) pretrained by 3D Convolutional Autoencoder (3D-CAE) to learn generic discriminative AD features in the lower layers. This captures characteristic AD biomarkers and can be easily adapted to datasets collected in different domains. To increase the specificity of features in upper layers of 3D-CNN, the discriminative loss function is enforced on upper layers (deep supervision). [14] . As shown below, our system can circumvent shortcomings of its more conventional counterparts."}, {"section_title": "PRIOR WORK", "text": "Voxel-wise, cortical thickness, and hippocampus shapevolume features of the sMRI are used to diagnose the AD [3] . The voxel-wise features are extracted after co-aligning (registering) all the brain image data to associate each brain voxel with a vector (signature) of multiple scalar measurements. Kl\u00f6ppel et al. [15] used the gray matter (GM) voxels as features and trained an SVM to discriminate between the AD and NC subjects. The brain volume in [16] is segmented to GM, white matter (WM), and CSF parts, followed by calculating their voxel-wise densities and associating each voxel with a vector of GM, WM, and CSF densities for classification. For extracting cortical thickness features, Lerch et al. [17] segmented the registered brain MRI into the GM, WM, and CSF; fitted the GM and WM surfaces using deformable models; deformed and expanded the WM surface to the GM-CSF intersection; calculated distances between corresponding points at the WM and GM surfaces to measure the cortical thickness, and used these features for classification. To quantify the hippocampus shape for feature extraction, Gerardin et al. [18] segmented and spatially aligned the hippocampus regions for various subjects and modeled their shape with a series of spherical harmonics. Coefficients of the series were then normalized to eliminate rotation-translation effects and used as features for training an SVM based classifier.\nLeveraging multi-view MRI, PET, and CSM data for trainable feature extraction of AD prediction involves various techniques of machine learning techniques. In particular, Liu et al. [19] extracted multi-view features using several selected templates in the subjects' MRI dataset. Tissue density maps of each template were used then for clustering subjects within each class in order to extract an encoding feature of each subject. Finally, an ensemble of support vector machines (SVM) was used to classify the subject. Deep networks were also used for diagnozing the AD with different image modalities and clinical data. Gupta et al. [20] employed 2D Convolutional Neural Network (CNN) for slice-wise feature extraction of MRI scans. To boost the classification performance, CNN was pretrained using Sparse Autoencoder (SAE) [21] trained on random patches of natural images. Suk et al. [22] used a stacked autoencoder to separately extract features from MRI, PET, and cerebrospinal fluid (CSF) images; compared combinations of these features with due account of their clinical mini-mental state examination (MMSE) and AD assessment scale-cognitive (ADAS-cog) scores, and classified the AD on the basis of three selected MRI, PET, and CSF features with a multi-kernel SVM. Later on, a multimodal deep Boltzmann machine (BM) was used [23] to extract one feature from each selected patch of the MRI and PET scans and predict the AD with an ensemble of SVMs. Liu et al. [24] extracted 83 regions-of-interest (ROI) from the MRI and PET scans and used multimodal fusion to create a set of features to train stacked layers of denoising autoencoders. Zhu et al. [25] proposed a joint regression and prediction model for clinical score and disease group. A linear combination of featurs are used with imposing group lasso constraint to sparsify the feature selection in regression or classification. Li et al. [26] developed a multi-task deep learning for both AD classification and MMSE and ADAS-cog scoring by multimodal fusion of MRI and PET features into a deep restricted BM, which was pre-trained by leveraging the available MMSE and ADAS-cog scores. Zu et al. [27] developed a multi-modal classification model, by proposing a multi-task feature selection method. The feature learning method was based on several regression models of different modalities, where label information is used as regularizer ro decrease the discrepancy of similar subjects across different modalities, in the new feature space. Then a multi-kernel SVM is used to fuse modelity-based extracted features for classification. Payan et al. [28] proposed a 3D Convolutional Neural Network (3D-CNN) for AD diagnosis based on pretraining by SAE. Randomly selected small 3D patches of MRI scans are used to pretrain SAE, where the trained weights of SAE are later used for pretraining of convolutional filters of 3D CNN. Finally, the fully connected layers of 3D-CNN are finetuned for classification.\nComparative evaluations of the sMRI-based feature extraction techniques reveal several limitations for classifying the AD [3, [10] [11] [12] . The voxel-wise feature vectors obtained from the brain sMRI are very noisy and can be used for classification only after smoothing and clustering to reduce their dimensionality [16] . The cortical thickness and hippocampus model features neglect correlated shape variations of the whole brain structure affected by the AD in other ROIs, e.g., the ventricle's volume. Extracted feature vectors highly depend on image preprocessing due to registration errors and noise, so that feature engineering requires the domain expert knowledge. Moreover, the developed trainable feature extraction and/or classifiers models [19, 20, [22] [23] [24] [25] [26] [27] [28] [29] are either dependent on using multi-modal data for feature extraction or biased toward a particular dataset used for training and testing (i.e., the classification features extracted at the learning stage are dataset-specific).\nIn contrast to all these solutions, the proposed deep 3D-CNN for learning generic and transferable features across different domains is able to detect and extract the characteristic AD biomarkers in one (source) domain and perform taskspecific classification in another (target) domain. The proposed network combines a generic feature-extracting stacked 3D-CAE, pre-trained in the source domain, as lower layers with the upper task-specific fully-connected layers, which are fine-tuned in the target domain [6, 7] . To overcome the aforementioned feature extraction limitations of the conventional approaches, the 3D-CAE learns and automatically extracts discriminative AD features capturing anatomical variations due to the AD. The pre-trained convolutional filters of the 3D-CAE are further adapted to another domain dataset, e.g., to the ADNI after pre-training on the CADDementia. Then the entire 3D-CNN is built by stacking the pre-trained 3D-CAE encoding layers followed by the fully-connected layers, which are fine-tuned to boost the task-specific classification performance by employing deep superivision [14] . Such adaptation of pre-learned generic features to specific tasks [7] allows for calling the proposed classifier a deeply supervised adaptable 3D-CNN (DSA-3D-CNN).\nData used in the preparation of this article were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). The ADNI was launched in 2003 as a public-private partnership, led by Principal Investigator Michael W. Weiner, MD. The primary goal of ADNI has been to test whether serial magnetic resonance imaging (MRI), positron emission tomography (PET), other biological markers, and clinical and neuropsychological assessment can be combined to measure the progression of mild cognitive impairment (MCI) and early Alzheimer?s disease (AD)."}, {"section_title": "MODEL", "text": "The proposed AD diagnostic framework extracts features of a brain MRI with a source-domain-trained 3D-CAE and performs task-specific classification with a deeply supervised target-domain-adaptable 3D-CNN. The 3D-CAE architecture and the AD diagnosis framework using the DSA-3D-CNN are detailed in Sections 3.1 and 3.3, respectively."}, {"section_title": "3D Convolutional Autoencoder (3D-CAE)", "text": "Conventional unsupervised autoencoder extracts a few coaligned scalar feature maps for a set of input 3D images with scalar or vectorial voxel-wise signals by combining data encoding and decoding. The input image is encoded by mapping each fixed voxel neighborhood to a vectorial feature space in the hidden layer and is reconstructed back in the output layer to the original image space. To extract features that capture characteristic patterns of input data variations, training of the autoencoder employs back-propagation and constraints on properties of the feature space to reduce the reconstruction error.\nExtracting global features from 3D images with vectorial voxel-wise signals is computationally expensive and requires too large training data sets. This is due to growing fast numbers of parameters to be evaluated in the input (encoding) and output (decoding) layers [30, 31] . Moreover, although autoencoders with full connections between all nodes of the layers try to learn global features, local features are more suitable for extracting patterns from high-dimensional images. To overcome this problem, we use a stack of unsupervised CAE with locally connected nodes and shared convolutional weights to extract local features from 3D images with possibly long voxel-wise signal vectors [32] [33] [34] . Each input image is reduced hierarchically using the hidden feature (activation) map of each CAE for training the next-layer of CAE.\nOur 3D extension of a hierarchical CAE proposed in [32] is shown in Fig. 1 . To capture characteristic variations of an input 3D image, x, each voxel-wise feature, h i:j:k , associated with the i-th 3D lattice node, j-th component of the input voxel-wise signal vector, and k-th feature map; k = [1, . . . , K], is extracted by a moving-window convolution (denoted below * ) of a fixed n \u00d7 n \u00d7 n neighborhood, x i:neib , of this node with a linear encoding filter specified by its weights, W k = [W j:k : j = 1, . . . , J] for each relative neighboring location with respect to the node i and each voxelwise signal component j, followed by feature-specific biases,\nand nonlinear transformations with a certain activation function, f (\u00b7):\nThe latter function is selected from a rich set of constraining differentiable functions, including, in particular, the sigmoid, f (u) = (1 + exp(\u2212u)) \u22121 and rectified linear unit (ReLU), f (u) = max (0, u) [35] . Since the 3D image x in Eq. (1) has the J-vectorial voxel-wise signals, actually, the weights W k define a 3D moving-window filter convolving the union of Jdimensional signal spaces for each voxel within the window.\nTo simplify notation, let\n) denote the entire encoding of the input 3D image with Jvectorial voxel-wise signals with the k-th 3D feature map, h k , such that its scalar components are obtained with Eq. (1) using the weights W k and bias vectors b k for a given voxel neighborhood. The similar inverse transformation, T inv (. . .), with the same voxel neighborhood, but generally with the different convolutional weights, P k , biases, b inv:k , and, possibly, activation function, g(\u00b7), decodes, or reconstructs the initial 3D image:\nGiven L encoding layers, each layer l generates an output feature image,\n, with K lvectorial voxel-wise features and receives the preceding output,\nThe 3D-CAE of Eqs. (1) and (2) is trained by minimizing the mean squared reconstruction error for T ; T \u2265 1, given training input images, x\n[t] ; t = 1, . . . , T ,\nwhere \u03b8 = [W k ; P k ; b k ; b inv:k : k = 1, . . . , K], and . . . number of free parameters, the decoding weights P k and encoding weights W k were tied by flipping over all their dimensions as proposed in [32] . The cost function Eq. (3) was minimized in the parameter space by using the stochastic gradient descent search and combined with error back-propagation. In order to obtain translational invariance, the feature maps, h (i) , are down-sampled by max-pooling, i.e., extracting the maximum value of non-overlapping sub-regions. For entangling shape variations in the higher-level feature maps of reduced size, the max-pooling output is used for training the higher layer CAE, as shown in Fig. 1(a) . Stacking the encoding 3D-CAE layers (abbreviated 3D-CAES below) halves the size of the feature map at each level of their hierarchy [32] ."}, {"section_title": "Transfer Learning and Domain Adaptation", "text": "To achieve good performance, supervised learning of a classifier often requires a large training set of labeled data. If this set is in principle of a too limited size, additional knowledge from building a similar classifier can be involved via so-called transfer learning. In particular, the goal classifier based on a deep CNN might employ initial weights been learned for solving similar task [36] [37] [38] [39] .\nWe focus on domain adaptation [40] [41] [42] , or source-totarget adaptation, when a classifier after training from a source data is adapted to the target data. Unlike usual supervised learning with a classifier trained from the scratch by minimizing a total quantitative loss from errors on the training data, the domain adaptation minimizes the same loss over the target domain by updating the classifier, which has been trained on the source domain. We leverage the unsupervised feature learning to transfer features found in the source domain to the target domain in order to boost the predictive performance of the deep CNN models [43, 44] ."}, {"section_title": "Deeply Supervised Adaptive 3D-CNN (DSA-3D-CNN)", "text": "While the lower layers of a goal predictive 3D-CNN extract generalized features, the upper layers have to facilitate taskspecific classification using those features [6] . The proposed classifier extracts the generalized features by using a stack of locally connected lower convolutional layers, while performing task-specific fine-tuning of parameters of the fully connected upper layers. Training the proposed hierarchical 3D-CNN consists of pre-training, initial training of the lower convolutional layers, and final task-specific fine-tuning. At the pre-training stage, the convolutional layers for generic feature extraction are formed as a stack of 3D-CAEs, which were pre-trained in the source domain. Then these layers are initialized by encoding the 3D-CAE weights [5] , and, finally, the deep-supervision-based [14] fine-tuning of the upper fullyconnected layers is performed for each task-specific binary or multi-class sMRI classification.\nDue to pre-training on the source domain data, the bottom convolutional layers can extract generic features related to the AD biomarkers, such as the ventricular size, hippocampus shape, and cortical thickness, as shown in Fig. 1(b) . We use the Net2Net initialization [5] , which allows for different convolutional kernel and pool sizes of the 3D-CNN layers, comparing to those in the 3D-CAE, based on the targetdomain image size and imaging specifications, and facilitates adapting the 3D-CNN across the different domains. To classify the extracted features in a task-specific way, weights of the upper fully-connected 3D-CNN layers are fine-tuned on the target-domain data by minimizing a specific loss function. The loss depends explicitly on the weights and is proportional to a negated log-likelihood of the true output classes, given the input features extracted from the training target-domain images by the pre-trained bottom part of the network.\nOur implementation of the 3D-CNN uses the ReLU activation functions at each inner layer and the fully connected upper layers with a softmax top-most output layer (Fig. 2) , predicting the probability of belonging an input brain sMRI to the AD, MCI, or NC group. The task-specific performance of this 3D-CNN was boosted by deep supervision of its upper layers [14, 45] . It performs a task-specific fine-tuning by minimizing a weighted sum of the like log-likelihood-based separate losses, depending each on the weights for each individual fully connected upper layer, plus the like loss of the top-most layer doing the softmax transformation of its convolved and biased inputs. Discriminative abilities of such a classifier are improved by regularizing the entire hierarchy of the weights of its hidden layers as shown in Fig. 3 . All these properties allow us to call the proposed classifier a deeply supervised and adaptable 3D-CNN (DSA-3D-CNN). The Adadelta gradient descent [46] was used to update the pre-trained 3D-CAE and fine-tune the entire DSA-3D-CNN."}, {"section_title": "EXPERIMENTS", "text": "Performance of the proposed DSA-3D-CNN for AD diagnosis was validated on 30 subjects of CADDementia, as source domain, and 210 subjects in the Alzheimers Disease Neuroimaging Initiative (ADNI) database, as target domain (demographic information mentioned in Table 1 ), for five classification tasks: four binary ones (AD vs. NC, AD+MCI vs. NC, AD vs. MCI, MCI vs NC) and the ternary classification (AD vs. MCI vs. NC). Classification accuracy was evaluated for each test by ten-fold cross-validation. The Theano library [47] was used to develop the deep CNN implemented for our experiments on the Amazon EC2 g2.8xlarge instances with GPU GRID K520. "}, {"section_title": "Generic and task-specific feature evaluation", "text": "Special 2D projections of the extracted features in Fig. 1(b) illustrate generalization and adaptation abilities of the proposed DSA-3D-CNN (Fig. 2) . Selected slices of the three feature maps from each layer of our stacked 3D-CAE (abbreviated 3D-CAES below) in Fig. 1(b) , show that the learnt generic convolutional filters can really capture features related to the AD biomarkers, e.g., the ventricle size, cortex thickness, and hippocampus model. These feature maps were generated by the pre-trained 3D-CAES for the CADementia database. According to these projections, the first layer of the 3D-CAES extracts the cortex thickness as a discriminative AD feature of AD, whereas the brain size (related to the patient gender), size of ventricles, and hippocampus model are represented by the subsequent layers. Each 3D-CAES layer combines the extracted lower-layer feature maps in order to train the higher level for describing more in detail the anatomical variations of the brain sMRI . Both the ventricle size and cortex thickness features are combined to extract conceptually higherlevel features at the next layers. Visualized in Fig. 3 , projections show capabilities of the extracted higher-layer features to separate the AD, MCI, and NC brain sMRI's in the lowdimensional feature space. Shown in Fig. 3 projected manifold distributions of the training ADNI sMRI over the hidden layers of our DSA-3D-CNN illustrate discriminative abilities of the generic and task-specific features. The generic layers (conv1, conv2, and conv3 in Fig. 3(a-c) ) gradually enhance the AD, MCI and NC discriminability along their hierarchy. The subsequent task-specific classification layers further enhance the discriminability of these three ADNI classes, as shown in Fig. 3(d-h) . The task-specific features are highlighted in Fig. 3(d) , depicting the distribution of all three classes when the AD+MCI subjects are to be distinguished from the NC subjects. Obviously, the AD, MCI, and NC cases are projected at closer distances and well separated in the task-specific feature space.\nThe three-class manifold distribution of the test dataset for ternary (AD vs. MCI vs. NC) classification in Fig. 4 indicates sound discriminative abilities of the learnt features to distinguish between these classes. Subject locations in these manifolds indicate that the extracted features correlate with the disease severity. The most severe AD cases are at the right-most side of the AD manifold, and the most normal (NC) cases are at the bottom of the NC manifold."}, {"section_title": "Classification performance evaluation", "text": "Performance of the proposed DSA-3D-CNN classifier for each specific task listed in Section 4.1 was evaluated and compared to competing approaches [19, [22] [23] [24] [25] [26] by using eight evaluation metrics. Let TP, TN, FP, and FN denote, respectively, numbers of true positive, true negative, false positive, and false negative classification results for a given set of data items. Then the performance is measured with the following metrics [49] : accuracy (ACC); sensitivity (SEN), or recall; specificity (SPE); balanced accuracy (BAC); positive predictive value (PPV), or precision; negative predictive value (NPV), and F1-score, detailed in Eq. (4) \nIn addition, after building a receiver operating characteristic (ROC) of the classifier, its performance is evaluated by the area under the ROC curve (AUC). Table 2 details the class-wise performance of our DSA-3D-CNN classifier for a selected cross-validation fold and five specific classification tasks. The ROCs / AUCs of these tests in Fig. 5 and the means and standard deviations of all the metrics of Eq. (4) in Table 3 indicate high robustness and confidence of the AD predictions by the proposed task-specific DSA-3D-NCC classifier. Its accuracy (ACC) is compared in Table 4 with seven other known approaches that use either just the same, or even additional inputs (imaging modalities). Table 4 presents the average results of ten-fold cross-validation of our classifier. Comparing these and other aforementioned experiments, the proposed DSA-3D-CNN outperforms other approaches in all five task-specific cases. This is in spite of employing only a single imaging modality (sMRI) and performing no prior skull-stripping."}, {"section_title": "CONCLUSION", "text": "This paper proposed a DSA-3D-CNN classifier which can more accurately predict the AD on structural brain MRI scans than several other state-of-the-art predictors. The transfer learning concept is used to enhance generality of the features capturing the AD biomarkers with three stacked 3D CAE network pretrained on CADDementia dataset. Subsequently, the features are extracted and used as AD biomarkers detection in lower layers of a 3D CNN network. Then three fully connected layers are stacked on top of the bottom lay- [20] MRI 85.0 n/a n/a 94.7 n/a 88.1 n/a 86.3 rm Suk et al. [22] PET+MRI+CSF n/a n/a 95.9 1.1 n/a 85.0 1.2 Suk et al. [23] PET+MRI n/a n/a 95.4 5.2 n/a 85.7 5.2 Zhu et al. [25] PET+MRI+CSF n/a n/a 95.9 n/a n/a 82.0 n/a Zu et al. [27] PET+MRI n/a n/a 96.0 n/a n/a 80.3 n/a Liu et al. [24] PET+MRI 53.8 4.8 n/a 91.4 5.6 n/a 82.1 4.9 Payan et al. [28] MRI 89.4 n/a n/a 95.39 n/a 86.8 n/a 92.1 n/a Liu et al. [19] MRI n/a n/a 93.8 n/a n/a 89.1 n/a Li et al. [26] PET+MRI+CSF n/a n/a 91. ers to perform AD classification on 210 subjects of ADNI dataset. To boost the classification performance, discriminative loss function was imposed on each fully connected layers, in addition to the output classification layers, to improve the discrimination between subjects. The results demonstrate that hierarchical feature extraction improved in hidden layers of 3D-CNN, by discriminating between AD, MCI, and NC subjects. Seven classification metrics were measured using ten-fold crossvalidation and were compared to the state-of-the-art models. The results have demonstrated the out-performance of the proposed DSA-3D-CNN."}, {"section_title": "ACKNOWLEDGMENT", "text": "Data collection and sharing for this project was funded by the Alzheimer's Disease Neuroimaging Initiative (ADNI) (Na- "}]
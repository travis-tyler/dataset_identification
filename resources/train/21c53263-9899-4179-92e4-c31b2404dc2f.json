[{"section_title": "Abstract", "text": "In this article, the authors aim to maximally utilize multimodality neuroimaging and genetic data for identifying Alzheimer's disease (AD) and its prodromal status, Mild Cognitive Impairment (MCI), from normal aging subjects. Multimodality neuroimaging data such as MRI and PET provide valuable insights into brain abnormalities, while genetic data such as single nucleotide polymorphism (SNP) provide information about a patient's AD risk factors. When these data are used together, the accuracy of AD diagnosis may be improved. However, these data are heterogeneous (e.g., with different data distributions), and have different number of samples (e.g., with far less number of PET samples than the number of MRI or SNPs). Thus, learning an effective model using these data is challenging. To this end, we present a novel three-stage deep feature learning and fusion framework, where deep neural network is trained stage-wise. Each stage of the network learns feature representations for different combinations of modalities, via effective training using the maximum number of available samples. Specifically, in the first stage, we learn latent representations (i.e., high-level features) for each modality independently, so that the heterogeneity among modalities can be partially addressed, and high-level features from different modalities can be combined in the next stage. In the second stage, we learn joint latent features for each pair of modality combination by using the high-level features learned from the first stage. In the third stage, we learn the diagnostic labels by fusing the learned joint latent features from the second stage. To further increase the number of samples during training, we also use data at multiple scanning time points for each training subject in the dataset. We evaluate the proposed framework using Alzheimer's disease neuroimaging initiative (ADNI) dataset for AD diagnosis, and the experimental results show that the proposed framework outperforms other state-of-the-art methods."}, {"section_title": "", "text": "strategy to fuse multimodality data for disease label prediction. In addition, discriminative multivariate analysis techniques have been applied to the analysis of functional neuroimaging data (Dai et al., 2012; Haufe et al., 2014; Rasmussen et al., 2012) . For instance, Dai et al. (Dai et al., 2012) proposed a multi-modality, multi-level, and multi-classifier (M3) framework that used regional functional connectivity strength (RFCS) to discriminate AD patients from healthy controls.\nRecently, imaging-genetic analysis (Lin, Cao, Calhoun, & Wang, 2014) has been utilized to identify the genetic basis (e.g., Single\nNucleotide Polymorphisms [SNPs] ) of phenotypic neuroimaging markers (e.g., features in MRI) and study the associations between them. In particular, various Genome-Wide Association Studies (GWAS) (Chu et al., 2017; Price et al., 2006; Saykin, Shen et al., 2010; Wang, Nie et al., 2012) have been done investigation on the relationship between the human genomic variants and the disease biomarkers. For example, GWAS has identified the associations between some SNPs and AD related brain regions (Biffi, Anderson et al., 2010; Shen et al., 2014; Shen, Kim et al., 2010) , where the SNPs found could be used to predict the risk of incident AD at earlier stage of life even before pathological changes begin. If success, such early diagnosis may help clinicians to identify prospectus subject to monitor for AD progression and find potential treatments to possibly prevent the AD. In our study, we aim to use the complementary information from both the neuroimaging and genetic data for the diagnosis of AD and its related early statuses. Based on this study, it shows that the complementary information from multimodality data can improve the diagnosis performance.\nThere are three main challenges in fusing information from multimodality neuroimaging data (i.e., MRI and PET) and genetic data (i.e., SNP) for AD diagnosis. The first challenge is data heterogeneity, as the neuroimaging and genetic data have different data distributions, different numbers of features, and different levels of discriminative ability to AD diagnosis (e.g., SNP data in their raw form are less effective in AD diagnosis). Due to the heterogeneity issue, simple concatenation of the features from multimodality data will result in an inaccurate prediction model (Di Paola et al., 2010; Liu et al., 2015; Ngiam et al., 2011; Zhu, Suk, Lee, & Shen, 2016) .\nThe second challenge is the high dimensionality issue. One neuroimage scan (i.e., MR or PET image) normally contains millions of voxels, while the genetic data of a subject has thousands of AD-related SNPs. In this study, we address the high dimensionality issue of the neuroimaging data by first preprocessing them to obtain the regionof-interest (ROI) based features using a predefined template. However, we do not have similar strategy to reduce the dimensionality of genetic data. Thus, we still have a high-dimension-low-sample-size problem, as we have thousands of features (dominated by SNPs) as compared to just hundreds of training samples.\nThe third challenge is the incomplete multimodality data issue, that is, not all samples in the training set have the complete three modalities. This issue will worsen the small-sample-size issue mentioned above, if we only use samples with complete multimodality data for training. In addition, using few samples during training may also degrade the performance of the classifier algorithm that relies on a large number of training samples to learn an effective model, such as deep learning (Schmidhuber, 2015; .\nTo address the above challenges, we propose a novel three-stage deep feature learning and fusion framework for AD diagnosis in this article. Specifically, inspired by the stage-wise learning in (Barshan & Fieguth, 2015) , we build a deep neural network and train it stage-wise, where, at each stage, we learn the latent data representations (highlevel features) for different combinations of modalities by using the maximum number of available samples. Specifically, in the first stage, we learn high-level features for each modality independently via progressive mapping of multiple hidden layers. After the first stage of deep learning, the data from different modality in the latent representation space (i.e., the output of the last hidden layer) are theoretically more discriminative to the target labels, and thus more comparable to each other. In other words, the heterogeneity issue of multimodality data is partially alleviated. In the second stage, we learn a joint feature representation for each modality combination by using the high-level latent features learned from the first stage. In the third stage, we learn the diagnostic labels by fusing the learned joint features from the second stage. It is worth emphasizing that we use the maximum number of all available samples to train each stage of the network more effectively.\nFor example, in the first stage, to learn the high-level latent features from MRI data, we use all the available MRI data; in the second stage, to learn the joint high-level features from MRI and PET data, we use all the samples with complete MRI and PET data; in the third stage, we use all the samples with complete MRI, PET and SNP data. In this way, the small-sample-size and incomplete multimodality data issues can be partially addressed. Moreover, to learn a more effective deep classification model, we further significantly increase the number of training samples by using multiple time-point data for each training subject, if available.\nThe main contributions of our work are summarized as follows:\n(a) To our best knowledge, this is the first deep learning framework that fuses multimodality neuroimaging and genetic data for AD diagnosis. (b) We propose a novel three-stage deep learning framework to partially address the data heterogeneity, as well as small-sample-size and incomplete multimodality data issues. (c) We propose to significantly increase the number of training samples by using multiple timepoint data scanned for each training subject in ADNI study, which is completely different from most of the existing methods that often consider only the data scanned at one time-point.\nThe rest of this article is organized as follows. We briefly describe the background and related works in Section 2, introduce the proposed framework in Section 3, describe the materials and the data preprocessing method used in this study in Section 4, present the experimental results in Section 5, and conclude our study in Section 6."}, {"section_title": "| BACKGROUND", "text": ""}, {"section_title": "| Feature extraction of neuroimaging data", "text": "There are basically three approaches for extracting features from neuroimaging data for analysis (Jack, Bernstein et al., 2008) : (a) voxelbased approach, which directly extracts features by using voxel intensity values from neuroimaging data, (b) patch-based approach, which extracts features from local image patches, and (c) region of interest (ROI) based approach, which extracts features from the predefined brain regions. Among these three approaches, the voxelbased approach is perhaps the most straightforward method, as it uses the raw low-level image intensity values as features. Because of that, it has the drawbacks of having high feature dimensionality and high computation load, as well as ignoring the regional information of the neuroimages as it treats each voxel in the neuroimaging data independently. In contrast, patch-based approach can capture brain regional information by extracting features from image patch. As diseased-related information and brain structures are more easily found in image patches, this approach generally can obtain much better classification performance than the voxel-based approach. A higher level of information can be extracted by using brain anatomical prior, as in the ROI-based approach. The dimensionality of ROI-based features depends on the number of ROIs defined in the template, which is comparatively smaller than the aforementioned approaches, and thus this is a good feature reduction method that can reflect the entire brain information (Barshan & Fieguth, 2015; Cuingnet, Gerardin et al., 2011; Suk et al., 2015; Wan et al., 2012; . Accordingly, we also use the ROI-based approach in this study to reduce the feature dimensionality of neuroimaging data."}, {"section_title": "| Deep learning in AD study", "text": "Deep learning has been widely used in learning high-level features and conducting classification, and achieves promising results (Barshan & Fieguth, 2015; Farabet, Couprie, Najman, & LeCun, 2013) .\nDeep learning can effectively capture hidden or latent patterns in the data. Recently, deep learning algorithms have been successfully applied to medical image processing and analysis (Litjens et al., 2017) .\nFor instance, Zheng et al. (2016) proposed a multimodal neuroimaging feature learning algorithm with the stacked deep polynomial networks for AD study. Fakoor et al. (2013) presented a novel method to enhance cancer diagnosis from gene expression data by using unsupervised deep leaning methods (e.g., stacked auto-encoder [SAE]). Suk et al. (2015) adopted SAE to discover the latent feature representation from the ROI-based features, and then used a multi-kernel learning (MKL) framework to combine latent features from multimodality data for AD diagnosis. Liu et al. (2015) also adopted an SAE-based multimodal neuroimaging feature learning algorithm for AD diagnosis. Suk, Lee et al. (2014) adopted Restricted Boltzmann Machine (RBM) to learn multi-modal features from 3D patches for AD/MCI diagnosis. Plis et al. (2014) adopted RBM and Deep Belief networks (DBN) to learn high-level features from MRI and fMRI for schizophrenia diagnosis. The common limitation of these deep learning methods is that they assume the data are complete, and thus only the data with complete multimodality can be used in the training and testing. This limitation may also reduce the effectiveness of training the deep learning model, as few number of samples can be used in the training. In the next section, we show how we address this limitation by proposing a stage-wise deep learning model. Figure 1 shows the overview of our proposed three-stage deep feature learning and fusion framework for AD classification by using multimodality neuroimaging data (i.e., MRI and PET) and genetic data (i.e., SNP). Our framework aims to maximally utilize all the available data from the three modalities to train an effective deep There are several advantages of this individual modality feature learning strategy. First, it allows us to use the maximum number of available training samples for each modality. For example, assume that we have N subjects, where only N 1 subjects contain MRI data, N 2 subjects contain PET data, and N 3 subjects contain SNP data."}, {"section_title": "| PROPOSED FRAMEWORK", "text": "The conventional multimodality model uses only the subjects with all three modality data, which is much less than min(N 1 , N 2 , N 3 ). On the other hand, by using our proposed framework, we can use all the N 1 , N 2 and N 3 samples to train three separate deep learning models for three modalities, respectively. It is expected that, by using more samples in training, our model can learn better latent representations for each model. Furthermore, this setting also partially addresses the incomplete multimodality data issue, as the framework is applicable for the training set with incomplete multimodality data. Second, it allows us to use both different number of hidden layers and different number of hidden neurons (for each layer) to learn the latent representations of each modality and modality combination. We argue that, as our multimodality data are heterogeneous with different feature size and discriminability for AD diagnosis, the number of hidden layers and the number of neurons in the neural network should be modality-dependent. For instance, for the modality with more number of features (i.e., SNPs in our case), we use more hidden layers and then gradually reduce the number of neurons for each layer to reduce the dimensionality of the modality; while for the modalities with less number of features or more direct relationship to the targets (i.e., ROI-based MRI and PET features in our case), we can use a few number of hidden layers to obtain the latent features. This strategy is also consistent with the strategy used in previous studies that also fuse multimodality data at the later stage of the hidden layers (Ngiam et al., 2011; Srivastava & Salakhutdinov, 2012; Suk, Lee et al., 2014) . As a result, the high-level features (i.e., the output of the last hidden layer) of each modality should be more comparable to each other as they are semantically closer to the target labels, thus partially addressing the modality heterogeneity issue. The proposed overall framework of three-stage deep neural network for AD diagnosis using MRI, PET, and SNP data. We first learn latent representations (i.e., high-level features) for each modality independently in stage 1. Then, in stage 2, we learn joint latent feature representations for each pair of modality combination (e.g., MRI and PET, MRI and SNP, PET and SNP) by using the high-level features learned from stage 1. Finally, in stage 3, we learn the diagnostic labels by fusing the learned joint latent feature representations from the stage 2 [Color figure can be viewed at wileyonlinelibrary.com] guide the learning of high-level features from two different modalities, while third output is used to guide the learning of joint high-level features for the two modalities.\nNote that we also use the maximum number of available samples for this stage. For instance, to learn feature representation for the combination of MRI and PET data, we use the samples with complete MRI and PET data to train the DNN model. Using the same example of the previous section, where N 1 subjects contain MRI data, N 2 subjects contain PET data, N 3 subjects contain SNP data, and N mp = min(N 1 , N 2 ) subjects contain both MRI and PET data. Then, we use N mp samples to train network for modality pair of MRI & PET in Stage 2, while use N 1 samples and N 2 samples to train the independent MRI and PET network models, respectively. The weights learned from Stage 1 are used as initial weights for Stage 2. We use a similar strategy to train neural network for other modality pairs; thus, in Stage 2, we train totally three DNN models for three combinations of modality pairs. "}, {"section_title": "| MATERIALS AND IMAGE DATA PREPROCESSING", "text": "We use the public Alzheimer's disease neuroimaging initiative (ADNI) database to evaluate the performance of our framework. The ADNI dataset was launched in 2003 by the National Institute on Aging, the National Institute of Biomedical Imaging and Bioengineering, the Food and Drug Administration, private pharmaceutical companies and nonprofit organizations with a 5-year public private partnership. The main goal of ADNI is to investigate the potential of fusing multimodality data, including neuroimaging, clinical, biological, and genetic biomarkers, to diagnose AD and its early statuses."}, {"section_title": "| Subjects", "text": "In this study, we used 805 ADNI-1 subjects, including 190 AD, 389 MCI, and 226 normal controls (NC) subjects, which have their MR images scanned at the first screening time (i.e., the baseline). Out of these subjects, 360 have PET data, and 737 have SNP data. The detailed demographic information of the baseline subjects is summarized in Table 1 . In addition, Table 2 shows the numbers of subjects with different combinations of modalities. From Table 2 , it is clear to see that some subjects have certain modalities missing, as only 360 subjects have complete multimodality data.\nAfter the baseline scan, follow-up scans were acquired every 6 or 12 months for up to 36 months. However, not all the subjects came back for follow-up scans, and also not all kinds of neuroimaging scans were acquired for each subject. Thus, the number of longitudinal data for each subject is different, and also the number of modality data at each time point is different for each subject. Nevertheless, our framework is still applicable in this case, as it is robust to incomplete multimodality data.\nFor the MCI subjects, we retrospectively labeled those who progressed to AD after a certain period of time as pMCI subjects, while those who remained stable as sMCI subjects. Following this convention, the labeling of sMCI/pMCI could be affected by both the reference time-point and the time period in which the patients are monitored for conversion to AD. We considered the 18-th month as the reference and 30 months as the time period to monitor for conversion, so that there is a sufficient number of earlier scan samples (i.e., samples at baseline, 6th and 12th month) in each cohort (i.e., pMCI and sMCI) for our study. Thus, MCI patients who were converted to AD within the 18th to 48th month (the duration of 30 months) are labeled as pMCI patients, while MCI patients whose conditions remained stable are labeled as sMCI patients.\nMCI patients who were progressed to AD prior to the 18th month were excluded from the study, because they were no longer MCI patients at the reference time point. Similarly, MCI patients who were converted to AD after the 48th month were also excluded to avoid ambiguity in labeling. In addition, as some MCI subjects dropped out of the study after the baseline scans, their sub-labels (pMCI or sMCI) cannot be determined.\nHence, the total number of pMCI (i.e., 157) and sMCI (i.e., 205) subjects does not match with the total number of baseline MCI subjects."}, {"section_title": "| Processing of neuroimages and SNPs", "text": "For this study, we downloaded the preprocessed 1.5 T MR images and PET images from the ADNI website.\n1 The MR images were collected by using a variety of scanners with protocols individualized for each scanner. In order to ensure the quality of all images, ADNI had reviewed these MR images and had corrected them for spatial distortion caused by B1 field inhomogeneity and gradient nonlinearity. For PET images, which were collected by 30-60 min post Fluoro-Deoxy Glucose (FDG) injection, multi-operations including averaging, spatially alignment, interpolation to standard voxel size, intensity normalization, and common resolution smoothing had been performed.\nAfter that, following some previous studies (Barshan & Fieguth, 2015; Suk et al., 2015) , we further processed these neuroimages to extract ROI-based features. Specifically, the MR images were processed using the following steps: anterior commissure-posterior commissure (AC-PC) correction by using MIPAV software, 2 intensity inhomogeneity correction using N3 algorithm (Sled, Zijdenbos, & Evans, 1998 ), brain extraction using robust skull-stripping algorithm (Wang, Nie et al., 2014) , cerebellum removal, tissues segmentation using FAST algorithm in FSL package (Zhang, Brady, & Smith, 2001 ) to obtain three main tissues (i.e., white matter (WM), gray matter (GM), and cerebrospinal fluid), registration to a template (Kabani, 1998) using HAMMER algorithm (Shen & Davatzikos, 2002) , and projection of ROI labels from the template image to the subject image. Finally, for each ROI in the labeled image, we computed the GM tissue volume, normalized it with the intracranial volume, and used it as ROI feature. Moreover, for each subject, we aligned the PET images to their respective T1 MR images by using affine registration, computed the average PET intensity value of each ROI, and regarded it as a feature. Thus, for a template with 93 ROIs, we obtained 93 ROI-based neuroimaging features for each neuroimage (i.e., MRI or PET). In addition, for SNP data, according to the AlzGene database, 3 only the SNPs belonging to the top AD gene candidates were selected. The selected SNPs were used to estimate the missing genotypes, and the illumina annotation information was also adopted to select a subset of SNPs Saykin, Shen et al., 2010) . In this study, we adopted 3,123 dimensional SNP data."}, {"section_title": "| EXPERIMENTAL RESULTS AND ANALYSIS", "text": ""}, {"section_title": "| Experimental setup", "text": "In this section, we evaluate the effectiveness of the proposed deep feature learning and fusion framework by considering four classifica- Figure 2 shows how we split the data for training, validation, and testing. For training set, we can either use the baseline data (single time-point) or the longitudinal data (multiple time-points) to train our deep learning model.\nNext we discuss how to set the network structure of our proposed deep learning framework. For clarity, we define \"hyperparameters\" as the parameters that are related to the network structure (e.g., the number of layers, the number of nodes in each layer, etc.) and network learning (e.g., regularization parameters, dropout, etc.).\nAs in many deep learning related studies, it is challenging to determine cross-validation and repeat for 50 times, the computation cost could become 3,000 days/GPU, which is not practical.\nDue to the enormous computation cost of adopting the inner cross-validation strategy, we have limited our search range to a small predefined range. First, we consider how to set the number of layers.\nWe have investigated the effects of different number of layers and found that the performance could degrade when more layers are used. As we have a limited number of training samples, too many layers (thus more network parameters) will cause over-fitting issue.\nThus, we consider the number of hidden layers to be fewer than five.\nSecond, we need to set the number of neurons in each layer. In our study, we use ROI-based neuroimaging features for PET and MRI data. From the literature , we know that not all the ROIs are related to the disease. Thus, with the feature selection, we set the number of neurons to be smaller than the number of ROIbased input features for each neuroimaging data. Similarly, for SNP data, previous studies have indicated that only a handful of SNPs is helpful for AD diagnosis . Thus, in our study, we also use a small number of hidden neurons for SNP data.\nThe hyperparameter combination to be selected for each stage of network is given as follows. In Stage 1, we search the best hyperpara- "}, {"section_title": "| Implementation details", "text": "As described in Sec. 4.1, we totally have 737 subjects (the corresponding RID set is denoted as \"R all \"), in which 360 subjects (with their corresponding RIDs denoted as \"R com \") have complete multimodality data (i.e., MRI, PET, and SNP). Besides, we denote the RID set corresponding to the subjects with MRI, PET, and SNP data as \"R MRI \", \"R PET \", and \"R SNP \", respectively. In the following, we introduce the implementation details of how to apply this dataset for our threestage training. First, we split the 360 subjects with complete data (\"R com \") into 20 subsets according to their RIDs, where one of the subsets are used as testing set, and the remaining subsets are further divided into two parts: validation set (10%) and training set (90%). We denote the RIDs corresponding to the testing set as \"R te \" and the RIDs corresponding to the validation set as \"R va \". also use all available subjects to train the submodels in Stage 2. For example, for MRI + PET submodel, the corresponding RID set used is R MRI \\ R PET \u2212 R va \u2212 R te (\\ denotes intersection). Similarly, the corresponding RID sets for MRI + SNP and PET+SNP submodels are given as R MRI \\ R SNP \u2212 R va \u2212 R te and R PET \\ R SNP \u2212 R va \u2212 R te , respectively.\nIn Stage 3, we use the subjects with complete three modalities to train the whole network. Thus, the corresponding RID set used is R MRI \\ R PET \\ R SNP \u2212 R va \u2212 R te . It is clearly shown that we have most number of training subjects in Stage 1, smaller number of training subjects in Stage 2, and the least number of training subjects in Stage 3. In brief, in each stage, we first find the RID set corresponding to the training subjects, and then use all data corresponding to the RID set (including data from time point other than the baseline, if using longitudinal data) as training samples."}, {"section_title": "| Comparison with other feature representation methods", "text": "We compared the proposed framework with four popular feature representation methods, that is, principal component analysis (PCA) (Wold, Esbensen, & Geladi, 1987) , canonical correlation analysis (Bron, Smits et al., 2015; Hardoon, Szedmak, & Shawe-Taylor, 2004) , locality preserving projection (LPP) (He et al., 2006) , and L21 based feature selection method (Nie et al., 2010) . For PCA and LPP, we determined the optimal dimensionality of the data based on their respective eigenvalues computed by the generalized eigen-decomposition method according to (He et al., 2006) . For CCA, we optimized its regularization parameter value by cross-validation in the range of }. To fuse the three modalities, we concatenated the feature vectors of the multimodality data into a single long vector for the above four comparison methods. We also compared our proposed framework with a deep feature learning method, that is, SAE (Suk et al., 2015) . For this method, we obtained SAE-learned features from each modality independently, and then concatenated all the learned features into a single long vector. We also set the hyperparameters of SAE to the values suggested in (Suk et al., 2015) , that is, we used a three-layer neural network for multi-modality data by using a grid search from [100; 300; 500; 1,000]-[50; 100]- [10; 20; 30] (bottom-top). As a baseline method, we further included the results for the experiment using just the original features without any feature selection (denoted as \"Original\"). In addition, we also compared to our method with Multiple Kernel Learning (MKL) (Althloothi, Mahoor, Zhang, & Voyles, 2014; De Bie et al., 2007) , as MKL is a common multi-modality fusion method. For this method, we first used PCA to reduce feature dimension for each modality, adopted MKL to fuse features from different modalities via a linear combination of kernels, and then used a support vector machine (SVM) classifier for classification. For MKL, we optimized the weights of different kernels by crossvalidating its value in the range of (0, 1) with the sum of weights set to 1. We used SVM classifier from LIBSVM toolbox (Chang & Lin, 2011) to perform classification for all the above comparison methods. Friedman test is generally used to test the difference between two groups of variables that are corresponding to the same set of objects. 3. From Figure 5 , we can see the percentages of both the correct and wrong classifications in each cohort of data. As the MCI is considered as the intermediate stage between AD and NC, it is much more difficult to differentiate MCI subjects from AD and NC subjects, which is supported by a relatively higher percentage of miss-classification rate in MCI cohort."}, {"section_title": "| Effects of different components of the proposed framework", "text": "We have two settings for our proposed framework, that is, \"OursbaseTP\", which uses only the baseline time-point data, and \"Ours-multiTP\", which exploits the longitudinal data scanned at multiple timepoints. As \"Ours-multiTP\" uses more data than \"Ours-baseTP\" when training the network, we expect \"Ours-multiTP\" would have better generalized network and would perform better than \"Ours-baseTP\". In addition, the good performance of our proposed framework could be due to the stage-wise feature learning strategy, which uses the while \"Ours-multiTP\" exploits the longitudinal. It can be seem from Figure 7 that the proposed methods (i.e., \"Ours-baseTP\" and \"OursmultiTP\") outperform \"Ours-complete\", implying the effectiveness of our stage-wise feature learning and fusion strategy that can best use of all the samples in the training set, regardless of their modality completeness. Besides, we first use a nonparametric Friedman test to evaluate the performance difference between \"Ours-multiTP\" and other competing methods (i.e., \"Ours-complete\" and \"Ours-baseTP\"), as shown in Figure 7 . From Figure 7 , the Friedman test results have indicated that \"Ours-multiTP\" is significantly better than \"Ours-complete\" and \"Ours-baseTP as demonstrated by very small p-values.\nMoreover, we also use a nonparametric Friedman test to evaluate the performance difference between \"Ours-baseTP\" and \"Ours-complete\", the results have verified that \"Ours-baseTP\" performs better than \"Ours-complete\". In summary, our experimental results indicate that the performance of deep neural network can be improved when using more data samples."}, {"section_title": "| Effects of different modality combinations", "text": "To further analyze the benefit of neuroimaging and genetic data fusion, Figure 8 illustrates the performance of our proposed framework for different combinations of modalities on the baseline timepoint data. Note that, in Figure 8 , we show the comparison results using the base time-point data. From Figure 8 , we can see that the performance of using only MRI modality is better than using PET or SNP, and the SNP shows the lowest performance. This is understandable as SNP data are the genotype features which are least related to the diagnostic label, compared to the MRI and PET data, which are the phenotypes features that are closely related to diagnostic labels.\nNevertheless, when we combined all the three modalities, the classification results are better than the results from any single modality or two-modality combinations (bimodal). The interesting part of the results in Figure 8 is that, for bimodal that involves SNP, the classification results are not always better than the results using individual modality. For example, for PET+SNP combination, its classification result is better than the results using individual modality for four-class (AD/pMCI/sMCI/NC) classification, but not for the three-class (AD/MCI/NC) and two-class (NC/AD and NC/MCI) classifications.\nFor MRI + SNP combination, it can be seen that its performances for four-class classification and NC/MCI tasks are better than the results using only its individual modality. These findings show that the SNP data have positive effect for four-class classification task when it combines with MRI, PET or both modality data. The effect of SNP data in bimodal network for other classification tasks is not consistent, and, in some cases, the inclusion of SNP data will degrade the classification performance. This could be caused by the network structure that we used, which is probably not optimal for bimodal network that involves SNP. Probably we should reduce the number of neurons for the output layer of the SNP submodel, so that the less discriminant SNP features can take less contribution in bimodal network, to circumvent the negative effect of SNP data. Nevertheless, it is worth noting that when all the three modalities are used, the performance of our model is better than any single modality or bi-modality models. Besides, we also use a nonparametric Friedman test to evaluate the performance difference between our method with three modalities and the other methods with single modality or any two-modality combination, as shown in Figure 8 , the results have indicated statistically significant improvement of our proposed method combing three modalities (i.e., MRI + PET+SNP) compared to the methods using single modality or any two-modality combination."}, {"section_title": "| Normal aging effects", "text": "Some studies (Dukart et al., 2011; Franke, Ziegler et al., 2010; Moradi, Pepe et al., 2015) have discovered the confounding effects of normal aging and AD, that is, there are overlaps between the brain atrophies caused by normal aging and AD. In order to evaluate the impact of removing age-related effects from the features derived from MRI and PET data, we followed a strategy described in previous studies (Dukart et al., 2011; Moradi, Pepe et al., 2015) . More specifically, we first estimated the relationship between volumetric features and ages for the subjects in NC cohort by learning multiple linear regression models, where ages are used to predict brain volumetric features, with one regression model learned for each feature. Then, we removed age-related effects by subtracting the predictions of the linear regression model from the original features of MRI and PET data, with the details described in Appendix B of Moradi, Pepe et al. (2015) . For convenience, we denote \"Ours-AgeEffectRemoved\" as our method with the aging effects removed. Figure 9 shows the comparison results between our methods using neuroimaging data with and without removal of normal aging effects. From Figure 9 , it can be observed that that the removal of age-related effects from MRI and PET data can indeed improve the classification performance. This is because, by removing age-related effects, we can focus more on the AD-related atrophies for classification. Besides, we also use a nonparametric\nFriedman test to evaluate the performance difference between \"OursAgeEffectRemoved\" and \"Ours-baseTP\". From Figure 9 , the Friedman test result has indicated that \"Ours-AgeEffectRemoved\" is significantly better than \"Ours-baseTP\"."}, {"section_title": "| The Most discriminative brain regions and SNPs", "text": "It is important to find out the most discriminative brain regions (i.e., ROIs) and SNPs for AD diagnosis. In this study, the most frequently selected ROI-based features or SNPs in cross-validations are regarded as the most discriminative brain regions or SNPs. These tified. These regions are consistent with some previous studies (Convit et al., 2000; Zhang, Shen et al., 2012; Zhu et al., 2016) and can be used as potential biomarkers for AD diagnosis.\nThe most frequently selected SNP features and their corresponding gene names are summarized in Table 4 . The SNPs in APOE have shown that they are related to neuroimaging measures in brain disorders Chiappelli et al., 2006) . Besides, some SNPs are found to be from DAPK1 and SORCS1 genes, which are the wellknown top candidate genes that are associated with hippocampal volume changes and AD progression. In addition, most selected SNPs are from PICLAM, ORL1, KCNMA1, and CTNNA3 genes Peng et al., 2016) , which have been shown to be AD-related in the previous studies. These findings indicate that our method is able to identify the most relevant SNPs for AD status prediction.\n6 | DISCUSSION"}, {"section_title": "| Comparison with previous studies", "text": "Different from the conventional multi-modality fusion methods, we proposed a novel stage-wise deep feature learning and fusion framework. In this stage-wise strategy, each stage of the network learns feature representations for independent modality or different combinations of modalities, by using the maximum number of available samples. The main advantage is that we can use more available samples to train our model for improving prediction performance. Further, our proposed method can automatically learn representations from multi-modality data and obtain diagnostic results using an end-to-end manner, while the traditional methods in the literature mostly employ feature selection, feature fusion, and classification in multiple separate steps (Peng et al., 2016; Zhang, Shen et al., 2012; Zhu et al., 2016) .\nIn addition, Bron, Smits et al. (2015) reported results of a challenge, where different algorithms are evaluated using same set of features derived from MRI data for AD diagnosis. The features used include regional volume, cortical thickness, shape, and signal intensity , and heterogenous (e.g., due to over 50 image collection centers), our problem is much more challenging than the problem presented in Bron, Smits et al. (2015) . Nevertheless, our method is still able to achieve 64.4% accuracy for three-class classification task, comparable to the best result reported in Bron et al.'s study (Bron, Smits et al., 2015) .\nSecond, the types and number of features used by both works are different. In Bron et al.'s paper (Bron, Smits et al., 2015) , when using only regional volume features, the reported accuracies are 49.7% for Dolph method and 47.7% for Ledig-VOL method, which are lower than 61% accuracy achieved by our method that only uses ROI features from MRI data. Third, the focus of both studies are different.\nWhile Bron et al.'s study is focusing on getting the best classification algorithm using a combination of multiple-view features from the MRI data, we are focusing on improving the classification performance by using a combination of neuroimaging and genetic data. We aim at overcoming the heterogeneity and incomplete data issues of these multi-modality data by proposing a novel deep learning based multimodality fusion framework. The bottom line is that the experimental results have validated the efficacy of our proposed framework as it outperforms the baseline method as well as other state-of-art methods. For instance, we also achieve an accuracy of 64.4% for three-class classification using the proposed method, which is about 18% improvement over our baseline method that uses original features."}, {"section_title": "| Clinical interest", "text": "AD is a progressive irreversible neurodegenerative disease. Before its disease onset, there is a prodromal stage called MCI. Some of the MCI subjects (i.e., pMCI) will progress to AD within few years, while the others (i.e., sMCI) are relatively stable and do not progress to AD within the same period. As AD is currently irreversible and incurable, the detection of its earlier stages, or multi-class classification for different AD stages is actually of much more clinical interest. Thus, unlike many previous studies in the literature that focused on binary classification tasks Zhu, Suk et al., 2017) , we focus our classification results on four different tasks: previous studies. For four-class classification task (i.e., NC vs. sMCI vs. pMCI vs. AD), our method achieves about 54% accuracy, outperforming other state-of-the-art methods. This performance seems lower than the other tasks, but it is due to the increased complexity of the problem, instead of the failure of the algorithm. The bottom line is that we have shown how to make use of all available data for training a robust deep learning model for multi-status AD diagnosis. Nevertheless, more works need to be done to improve the performance of this classification task for practical clinical usage, where the performance of this work could be used as a benchmark, and the strategy used for this work could be used as the foundation."}, {"section_title": "| Future work", "text": "Although our proposed prediction method achieves promising results in four classification tasks, there are several improvements that can be considered for future work. First, our method is focusing on using ROI features as input to the deep learning model; however, such handcrafted features may limit the richness of structural and functional brain information from MRI and PET images, respectively. To fully unleash the power of deep learning model in learning imaging features that are useful for our classification tasks, we may have to use the original imaging data, and utilize convolution or other more advanced deep neural networks in our framework. Second, as discussed in Section 5.6 about the effects of age, we can incorporate other confounding factors (e.g., gender, education level, etc.) into the proposed framework to possibly improve the performance."}, {"section_title": "| CONCLUSION", "text": "In this article, we focus on how to best use multimodality neuroimaging and genetic data for AD diagnosis. Specifically, we present a novel three-stage deep feature learning and fusion framework for AD diagnosis, which integrates multimodality imaging and genetic data gradually in each stage. Our framework alleviates the heterogeneity issue of multimodality data by learning the latent representations of different modality using separate DNN models guided by the same target. As the latent representations of all the modalities (i.e., outputs of the last hidden layer) are semantically closer to the target labels, the data heterogeneity issue is partially addressed. In addition, our framework also partially addresses the incomplete multimodality data issue by devising a stage-wise deep learning strategy. This stage-wise learning strategy allows samples with incomplete multimodality data to be used during the training, thus also allowing to use the maximum number of available samples to train each stage of the proposed network. Moreover, we exploit longitudinal data for each training subject to significantly increase the number of training samples. As our proposed deep learning framework can use more data in the training, we achieved better classification performance, compared with other methods. All these experimental results (using ADNI database) have clearly demonstrated the effectiveness of the proposed framework, and the superiority of using multimodality data (over the case of using single modality data) in AD diagnosis. "}]
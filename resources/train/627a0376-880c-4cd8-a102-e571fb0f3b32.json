[{"section_title": "Abstract", "text": "Abstract-Image super-resolution (SR) aims to recover high-resolution images from their low-resolution counterparts for improving image analysis and visualization. Interpolation methods, widely used for this purpose, often result in images with blurred edges and blocking effects. More advanced methods such as total variation (TV) retain edge sharpness during image recovery. However, these methods only utilize information from local neighborhoods, neglecting useful information from remote voxels. In this paper, we propose a novel image SR method that integrates both local and global information for effective image recovery. This is achieved by, in addition to TV, low-rank regularization that enables utilization of information throughout the image. The optimization problem can be solved effectively via alternating direction method of multipliers (ADMM). Experiments on MR images of both adult and pediatric subjects demonstrate that the proposed method enhances the details in the recovered high-resolution images, and outperforms methods such as the nearest-neighbor interpolation, cubic interpolation, iterative back projection (IBP), non-local means (NLM), and TV-based up-sampling."}, {"section_title": "", "text": "as imaging hardware, signal to noise ratio (SNR), and time constraints. Image SNR is proportional to voxel size and the square root of the number of averages in the voxel. Reducing the voxel size from 2 2 2 to 1 1 1 will require 64 averages for similar SNR [11] . This requires significantly longer scanning time, which may not be practical clinically.\nA possible alternative approach to this problem is image postprocessing. For this, interpolation methods (nearest neighbor, linear, and spine) are generally employed due to their simplicity. However, as pointed out in [1] , interpolation methods generally blur the sharp edges, introduce blocking artifacts in lines, and are unable to recover fine details. In view of this, we take a super-resolution (SR) approach for resolution enhancement of LR images [3] . Interpolation methods are not considered as SR methods since they do not consider the image degradation process (e.g., blurring, and down-sampling). Multi-frame SR algorithms reconstruct a HR image from multiple LR images [12] , [13] . These LR images are typically acquired repeatedly with slightly shifted field of view (FOV). In this paper, we propose a single-frame SR algorithm that requires the acquisition of only one LR image. A number of methods have been proposed for single-image SR [3] . For example, iterative back-projection (IBP) was proposed to estimate the HR image by back projecting the difference between the LR image simulated based on the estimated HR image via imaging blur and the input LR image [14] . This process is repeated to minimize the energy of the difference. Non-local means (NLM) is a method proposed to take advantage of image self-similarity [15] . Specifically, the input LR image is first denoised and the similar patches are used to reconstruct to a HR image. A correction step is then applied to ensure that the down-sampled HR image is close to the denoised LR image. The reconstruction and correction steps are iterated in a multi-scale manner. In another work, NLM was employed to enhance the resolution of a single LR T2 image with the guidance from an HR T1 image [16] .\nMatrix completion algorithms have recently been shown to be effective in estimating missing values in a matrix from a small sample of known entries [17] [18] [19] . For instance, it has been applied to the famous Netflix problem where one needs to infer user preference for unrated movies based on only a small number of rated movies [20] . Matrix completion methods assume that the recovered matrix has low rank and then uses this property as a constraint or regularization to minimize the difference between the given incomplete matrix and the estimated matrix. Candes et al. proved that, low-rank matrices can be perfectly recovered from a small number of given entries under some conditions [18] . In image processing, one advantage of matrix completion is that the remote information from the whole 0278-0062 \u00a9 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.\nSee http://www.ieee.org/publications_standards/publications/rights/index.html for more information. Fig. 1 . Recovering the missing values using low-rank matrix completion [14] . The red arrows mark the horizontal and vertical lines that the algorithm fails to recover.\nimage can be utilized in image recovery. Besides, matrix completion has been widely applied to image/video in-painting and decoding problems. However, low-rank regularization is limited when the matrix to be recovered contain rows or columns that are entirely missing. As shown in Fig. 1 , although voxels occluded by the words \"Low Rank\" can be recovered very well, the voxels masked by white horizontal and vertical lines cannot be recovered. In this case, each missing row or column will be simply filled by an arbitrary combination of other known rows or columns to meet the low rank requirement. This precludes the application of low-rank regularization to SR problem where missing values for many rows and columns need to be recovered in the process of recovering a HR image from a LR image. The limitation of low-rank regularization in SR problem could be remedied by imposing the additional local spatial consistency. Although local information may not be useful in applications such as the Netflix problem, where different rows (e.g., users) can be considered independently, it is valuable in recovering images. One possible choice is total variation (TV) [21] , defined as the integral of the absolute gradients of the image. Recently, TV has been applied to avoid the ringing and smearing caused by interpolation [22] .\nIn this paper, we propose a novel low-rank total variation method, referred to as LRTV, for recovering a HR image from a LR image. Our method 1) explicitly models the blurring effects when an image is down-sampled, 2) combines both low-rank and TV regularizations for more effective image recovery, and 3) works for 3D or 4D images by a tensor formulation [19] . A preliminary version of this work was presented at a conference [23] . The work is significantly extended in this article with more methodological details, validations, and discussions. Experiments on MR images of both adults and pediatric subjects are conducted, and the proposed method is compared to various interpolation methods, as well as the NLM and TV-based up-sampling methods."}, {"section_title": "II. METHOD", "text": "We first describe how image degradation processes such as blurring and down-sampling effects are modeled. We then describe the solution for the inverse problem of recovering the HR image from the LR image, using low-rank and TV regularization."}, {"section_title": "A. Super-Resolution Image Reconstruction Framework", "text": "As illustrated in Fig. 2 , the acquired image is affected by factors such as motion blur, field inhomogeneity, acquisition time, and noise.\nThe observation model could be mathematically formulated as: (1) where denotes the observed LR image, is a down-sampling operator, is a blurring operator, is the HR image that we want to recover, and represents the observation noise. In the case of single-image SR, the HR image can be estimated using this observation model by minimizing the following cost function:\nThis is a data fidelity term for penalizing the difference between the degraded HR image and the observed LR image . Since this is an ill-posed inverse problem, regularization terms are added to stabilize the solution. The cost function is thus rewritten as: (3) where is the regularization term often defined based on prior knowledge. The parameter is used to balance the contributions of the fidelity term and the regularization term."}, {"section_title": "B. Low-Rank Total-Variation (LRTV) Method", "text": "The proposed LRTV method is formulated as follows: (4) where the regularization can be separated into low-rank and total variation terms. and are the respective tuning parameters for those two terms."}, {"section_title": "1) Low-Rank Regularization:", "text": "The rank of a matrix is a measure of nondegenerateness of the matrix, calculated by the maximum number of linearly independent rows or columns in the matrix. The low-rank property implies that some rows or columns in the matrix can be linearly represented by other rows or columns, indicating redundant information in the matrix. Low-rank prior can be used in matrix completion when only a subset of elements is known [18] . Since the rank of a matrix is a nonconvex function of , a common approach is to approximate it using the trace norm , which leads to a convex optimization problem. Recently, Liu et al. extended the low-rank regularization to higher dimensional images and further referred to as tensor completion [19] . Basically, a -dimensional image can be seen as a high-order tensor. Since it is an NP-hard problem to compute the rank of a high-order tensor 1 , the rank is then approximated as the combination of trace norms of all matrices unfolded along each dimension: (5) where is the number of image dimensionality. In this study, we use 3D MR images and thus . are parameters satisfying and . is the unfolded along the -th dimension:\n. For example, a 3D image with size of can be unfolded into three 2D matrices, with sizes of , , and , respectively.\nis the trace norm of the matrix . 2) Total-Variation Regularization: Total variation was proposed as a regularization approach to remove noise and handle proper edges in images [21] . It is defined as the integral of the absolute gradients of an image:\n. Minimizing TV will enforce local spatial consistency in image recovery, remove noise, and preserve edges."}, {"section_title": "C. LRTV Optimization", "text": "We use the alternating direction method of multipliers (ADMM) algorithm to solve the cost function in (4). ADMM is proven to be efficient for solving optimization problems with multiple non-smooth terms in the cost function [24] . First, we introduce redundant variables to simulate in each dimension , by requiring that the unfolded along the -th dimension should be equal to the unfolded along this dimension . The new cost function is as follows:\nBased on ADMM in [24] , the augmented Lagrangian of the above cost function is written in below, where are Lagrangian parameters:\n1 http://en.wikipedia.org/wiki/Tensor_rank_decomposition 2 The operator is implemented by nearest-neighbor interpolation."}, {"section_title": "(7)", "text": "We further set , and combine the last two linear and quadratic terms for simplicity: (8) According to ADMM [24] , we break (8) into three sub-problems below that could be solved by iteratively updating the variables. In the below, denotes the current iteration step.\n1) Subproblem 1: Update by minimizing:\nThis subproblem can be solved by gradient descent, where the gradient of TV term is obtained from the associated EulerLagrange equation [22] ."}, {"section_title": "2) Subproblem 2:", "text": "Update by minimizing: which can be solved using a close-form solution according to [17] : (11) where is the inverse operator of , i.e., .\nis the Singular Value Thresholding operator [17] using as the shrinkage parameter.\n3) Subproblem 3: Update by:"}, {"section_title": "III. EXPERIMENTAL RESULTS", "text": ""}, {"section_title": "A. Low-Rank Approximation for Brain Images", "text": "We first evaluated whether brain images can be sufficiently characterized using their low-rank approximation. We selected a representative 2D axial slice from the T1 MR phantom in Brainweb 3 , which has a size of 181 181 with in-plane resolution of 1 mm (Fig. 3) . We then performed singular value decomposition (SVD) on this image and obtain 174 non-zero singular values. As shown in Fig. 3 , singular values decrease dramatically, with most values being close to zero. Next, we remove the small singular values and use the top 30, 60, 90, and 120 singular values to reconstruct the image. Note that the number of used singular values equals to the rank of the recovered image, implying that the recovered image is a low-rank approximation of the original image. The reconstructed images are shown in Fig. 3 for visual inspection and the difference maps between original and reconstructed images are also provided. Signal-to-noise ratio (SNR) in decibels (dB) is used to evaluate the quality of reconstruction:\n, where is the original HR image and is the recovered HR image.\nThe results show that, by using the top 60 singular values, the reconstructed image has high SNR (34.0 db), although small edge information in the brain boundary is lost. When using the top 90 or 120 singular values (out of 174), the resulting image does not show visual differences with respect to the original image. For the 3D Brainweb image with size 181 217 181, it has three ranks for its three unfolded matrices that are less than its longest image size 217. These ranks are relatively low in comparison to the total number of elements, suggesting brain images could be represented using their low-rank approximations with a relatively high SNR."}, {"section_title": "B. Experimental Settings", "text": "We applied our method to a set of down-sampled and blurred 3D brain images and evaluated whether our method can successfully recover the original high-resolution images. To do that, we use HR images as ground truth, and simulate LR images as shown in Fig. 4 . Blurring was implemented using a Gaussian kernel with a standard deviation of 1 voxel. The blurred image was then down-sampled by averaging every 8 voxels (to simulate the partial volume effect), resulting in half of the original resolution. The quality of reconstruction of all methods from the input LR images was evaluated by comparing with their corresponding original HR images.\nA number of comparison methods were also employed, including nearest-neighbor interpolation (NN), spline interpolation (Spline), IBP based up-sampling [14] , NLM based up-sampling [15] , and TV based up-sampling [22] . The estimated HR images from all methods were compared with the original HR image for accuracy of image recovery by using SNR. Note that, for NLM, we used the implementation made available by the authors 4 . TV-based up-sampling is realized by setting Parameters were optimized based on a small dataset, consisting of 5 adult and 5 pediatric images as described in the Real Data Evaluation section. In particular, are weights to combine unfolded matrices along each spatial dimension in rank computation. All dimensions are assumed to be equally important, i.e.,\n. The difference between iterations was measured by , and the program was stopped when this difference is less than . Since TV is a major component of the proposed method, we first optimized TV by setting from a group of candidate values (Fig. 5) . We thus chose . Then, we optimized the proposed method by employing the same while setting from a wide range of candidate values (Fig. 5) . We chose the rank regularization as . As for the input arguments, the blurring kernel (such as Gaussian distribution with 1 voxel standard deviation) was used in IBP, TV, and the proposed method. On the other hand, the default parameters in NLM implementation were used [15] . Both NN and Spline do not have any free parameters that require tuning.\nWe evaluate the performance of the proposed and comparison methods by comparing the recovered HR images with the original HR image. Besides SNR, we also employ another image quality measurement named Structural Similarity Index (SSIM), which is considered to be correlated with the quality perception of the human visual system (HVS) [25] . SSIM has been used in many image SR studies [15] , [26] [27] [28] . SSIM is defined as: where and are the mean values respectively in the original HR image and recovered image , and are the variances, is the covariance of two images, and with and , and is the dynamic range of voxel values [25] . SSIM ranges from 0 to 1, and 1 means perfect recovery."}, {"section_title": "C. Phantom Data Evaluation", "text": "We employed the T1 MR phantom from Brainweb to evaluate the recovery performance of the proposed and comparison methods in cases of no noise and with noise. The phantom has image size of 181 217 181 and spatial resolution of 1 1 1 . We downloaded images both without noise and with noise at different levels of 1%, 3%, 5%, 7%, and 9% of the maximum intensity. The noise in the phantom images has Rayleigh statistics in the background and Rician statistics in the signal regions. For our experiment, we generated images with 2 2 2 resolution using the above-mentioned LR image simulation pipeline (Fig. 4) , and upsample it again to 1 mm isotropic resolution using the proposed and comparison methods, respectively. 6 demonstrates the results when using noisy data at level of 3% as input image. A typical slice is shown for each of coronal, sagittal, and axial views, and the frontal region in sagittal view is zoomed up for better visual inspection. Compared to the original HR image, results of NN, Spline, IBP, and NLM appear blurry. TV provides better image reconstruction while the proposed method shows more fine details. Fig. 7 shows the SNR and SSIM measurements for all methods while changing the noise level from no noise to 9% noise level. The proposed method outperforms all other comparison methods in all noise levels for both SNR and SSIM. Another observation is that, the SNR improvement of the proposed method over other methods generally reduces when noise level increases, while the SSIM improvement maintains a similar level when the noise level increases."}, {"section_title": "D. Real Data Evaluation", "text": "We further evaluated the proposed method on two publicly available datasets. First, we randomly selected 45 adult subjects from ADNI 5 , with 15 from Alzheimer's disease (AD), 15 from mild cognitive impairment (MCI), and 15 from normal controls (NC). Their ages were old at MRI scan. T1 MR images were acquired with 166 sagittal slices at the resolution of 0.95 0.95 1.2 . Second, we also randomly selected 45 pediatric subjects from NDAR (http://ndar.nih.gov/), with age of old at MRI scan. T1 MR images were acquired with 124 sagittal slices at the resolution of 0.94 0.94 1.3 . Quantitative results on the images of 45 adults and 45 pediatric subjects are shown in Fig. 9 . Note that the original images were used as ground truth and the input was LR image simulated following the pipeline of Fig. 4 . The proposed method significantly outperforms all comparison methods ( using two-sample -tests). Results on adult subjects demonstrate less variance and higher accuracy than those on pediatric subjects, which may be because the image quality is higher in the matured brain and also clearer gyri/sulci patterns appear in the adult images. No significant difference was found between the adult subjects of AD, MCI, and NC, as shown in Fig. 10 .\nIn addition, we applied our method directly to images with typical imaging resolution. Fig. 11 shows the results of a typical AD subject for visual inspection, along with the close-up views of selected representative regions. As it can be observed, the proposed method recovers fine details and also preserves image edges."}, {"section_title": "E. Computational Time", "text": "All programs were run in Linux environment on a standard PC using a single thread of an Inter\u00ae Xeon\u00ae CPU (E5630 1.6 GHz). Interpolation methods are computationally efficient as it takes around 2 seconds for NN and 10 seconds for Spline for one 3D image. For the up-sampling methods, IBP takes 1 min, NLM takes 16 mins, TV takes 5 mins, and the proposed method takes about 30 mins."}, {"section_title": "IV. DISCUSSION", "text": "We have presented a novel super-resolution method for recovering high-resolution image from a single low-resolution image. For the first time, we show that combining low-rank and total-variation regularizations is a viable solution to the SR problem. This combination brings together global and local information for effective recovery of the high-dimensional image. Experimental results indicate that the proposed method is able to remedy the partial volume effect and recover the fine brain structure details from both adult and pediatric images. Quantitative comparisons show that the proposed method outperforms other popular methods such as the interpolation methods based on NN and Spline, and the up-sampling methods based on IBP, NLM, and TV.\nThe proposed method is computationally expensive compared with other methods. The major reason is that the program spends most of the time solving TV, which is implemented using gradient decent [22] in MATLAB. In future work, we will implement a faster TV solver, such as [29] , and also accelerate the program using C++. On the other hand, we'd like to clarify that our main purpose is to show that the TV-based MR image reconstruction can be improved by combining low-rank regularization. When a better TV solver is available, the performance of the proposed method could also be improved.\nThe proposed method is mainly developed for single-image SR. In the future, we will extend the proposed method to use multiple LR images [12] , [13] , training datasets [30] , and also for more applications such as 4D image recovery in functional MRI or diffusion MRI. The code for the proposed method will be released at our website 6 ."}]
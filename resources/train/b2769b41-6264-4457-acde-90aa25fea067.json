[{"section_title": "Abstract", "text": "Introduction: White matter hyperintensities (WMHs) are areas of abnormal signal on magnetic resonance images (MRIs) that characterize various types of histopathological lesions. The load and location of WMHs are important clinical measures that may indicate the presence of small vessel disease in aging and Alzheimer's disease (AD) patients. Manually segmenting WMHs is time consuming and prone to inter-rater and intra-rater variabilities. Automated tools that can accurately and robustly detect these lesions can be used to measure the vascular burden in individuals with AD or the elderly population in general. Many WMH segmentation techniques use a classifier in combination with a set of intensity and location features to segment WMHs, however, the optimal choice of classifier is unknown. Methods: We compare 10 different linear and nonlinear classification techniques to identify WMHs from MRI data. Each classifier is trained and optimized based on a set of features obtained from co-registered MR images containing spatial location and intensity information. We further assess the performance of the classifiers using different combinations of MRI contrast information. The performances of the different classifiers were compared on three heterogeneous multi-site datasets, including images acquired with different scanners and different scan-parameters. These included data from the ADC study from University of California Davis, the NACC database and the ADNI study. The classifiers (na\u00efve Bayes, logistic regression, decision trees, random forests, support vector machines, k-nearest neighbors, bagging, and boosting) were evaluated using a variety of voxel-wise and volumetric similarity measures such as Dice Kappa similarity index (SI), Intra-Class Correlation (ICC), and sensitivity as well as computational burden and processing times. These investigations enable meaningful comparisons between the performances of different classifiers to determine the most suitable classifiers for segmentation of WMHs. In the spirit of opensource science, we also make available a fully automated tool for segmentation of WMHs with pre-trained classifiers for all these techniques. Results: Random Forests yielded the best performance among all classifiers with mean Dice Kappa (SI) of 0.66 \u00b1 0.17 and ICC=0.99 for the ADC dataset (using T1w, T2w, PD, and FLAIR scans), SI=0.72 \u00b1 0.10, ICC=0.93 for the NACC dataset (using T1w and FLAIR scans), SI=0.66 \u00b1 0.23, ICC=0.94 for ADNI1 dataset (using T1w, T2w, and PD scans) and SI=0.72 \u00b1 0.19, ICC=0.96 for ADNI2/GO dataset (using T1w and FLAIR scans). Not using the T2w/PD information did not change the performance of the Random Forest classifier (SI=0.66 \u00b1 0.17, ICC=0.99). However, not using FLAIR information in the ADC dataset significantly decreased the Dice Kappa, but the volumetric correlation did not drastically change (SI=0.47 \u00b1 0.21, ICC=0.95). \nConclusion: Our investigations showed that with appropriate features, most off-the-shelf classifiers are able to accurately detect WMHs in presence of FLAIR scan information, while Random Forests had the best performance across all datasets. However, we observed that the performances of most linear classifiers and some nonlinear classifiers drastically decline in absence of FLAIR information, with Random Forest still retaining the best performance."}, {"section_title": "A B S T R A C T", "text": "Introduction: White matter hyperintensities (WMHs) are areas of abnormal signal on magnetic resonance images (MRIs) that characterize various types of histopathological lesions. The load and location of WMHs are important clinical measures that may indicate the presence of small vessel disease in aging and Alzheimer's disease (AD) patients. Manually segmenting WMHs is time consuming and prone to inter-rater and intra-rater variabilities. Automated tools that can accurately and robustly detect these lesions can be used to measure the vascular burden in individuals with AD or the elderly population in general. Many WMH segmentation techniques use a classifier in combination with a set of intensity and location features to segment WMHs, however, the optimal choice of classifier is unknown. Methods: We compare 10 different linear and nonlinear classification techniques to identify WMHs from MRI data. Each classifier is trained and optimized based on a set of features obtained from co-registered MR images containing spatial location and intensity information. We further assess the performance of the classifiers using different combinations of MRI contrast information. The performances of the different classifiers were compared on three heterogeneous multi-site datasets, including images acquired with different scanners and different scan-parameters. These included data from the ADC study from University of California Davis, the NACC database and the ADNI study. The classifiers (na\u00efve Bayes, logistic regression, decision trees, random forests, support vector machines, k-nearest neighbors, bagging, and boosting) were evaluated using a variety of voxel-wise and volumetric similarity measures such as Dice Kappa similarity index (SI), Intra-Class Correlation (ICC), and sensitivity as well as computational burden and processing times. These investigations enable meaningful comparisons between the performances of different classifiers to determine the most suitable classifiers for segmentation of WMHs. In the spirit of opensource science, we also make available a fully automated tool for segmentation of WMHs with pre-trained classifiers for all these techniques. Results: Random Forests yielded the best performance among all classifiers with mean Dice Kappa (SI) of 0.66 \u00b1 0.17 and ICC=0.99 for the ADC dataset (using T1w, T2w, PD, and FLAIR scans), SI=0.72 \u00b1 0.10, ICC=0.93 for the NACC dataset (using T1w and FLAIR scans), SI=0.66 \u00b1 0.23, ICC=0.94 for ADNI1 dataset (using T1w, T2w, and PD scans) and SI=0.72 \u00b1 0.19, ICC=0.96 for ADNI2/GO dataset (using T1w and FLAIR scans). Not using the T2w/PD information did not change the performance of the Random Forest classifier (SI=0.66 \u00b1 0.17, ICC=0.99). However, not using FLAIR information in the ADC dataset significantly decreased the Dice Kappa, but the volumetric correlation did not drastically change (SI=0.47 \u00b1 0.21, ICC=0.95)."}, {"section_title": "Introduction", "text": "White matter hyperintensities (WMHs), commonly identified as areas of increased signal in relation with the surrounding white matter regions on T2w, PD and FLAIR MRIs, are one of the non-specific yet typical and constant MRI expressions of cerebral small vessel disease (CSVD), along with lacunar infarcts and microhemorrhages (Conklin et al., 2014; Gouw et al., 2010) . They have been shown to be more extensive in patients with Alzheimer's disease compared to agematched healthy normal populations (Yoshita et al., 2005) . WMHs reflect ischemic injury in the elderly and AD populations and the existence and severity of WMHs can lead to or accelerate decline in cognitive as well as executive functions (Dubois et al., 2014) . As a result, the location and load of WMHs are important clinical measures, raising substantial need for their accurate quantifications. WMHs are generally detected using fluid attenuated inversion recovery (FLAIR) or T2w/PD scans. Manually labeling WMHs is challenging due to time constraints as well as inter-rater and intra-rater variabilities (Grimaud et al., 1996) . As a result, automated tools that can segment WMHs robustly and with high accuracy are extremely useful, particularly in large scale studies such the Alzheimer's Disease Neuroimaging Initiative (http://www.loni.ucla.edu/ADNI/), the National Alzheimer's Coordinating Center (NACC) database (https://www.alz. washington.edu/) and others where it is desired to estimate the contribution of neurovascular disease to cognitive decline.\nThe heterogeneity in the distribution and patterns of WMHs makes the segmentation task intrinsically complex (Caligiuri et al., 2015) . Automated segmentation tools usually integrate information from multiple complementary MRI contrasts including T1w, T2w, PD and FLAIR to reduce uncertainty and improve segmentation accuracy. Most successful fully automated WMH segmentation techniques extract a combination of location and intensity features from these images and use them as inputs to a linear or nonlinear classifier. Here we review the most commonly used linear and nonlinear classifiers in general as well as their application to the task of segmenting lesions in general or WMHs of vascular etiology specifically.\nWhile there have been many studies attempting to segment WMHs using these classification techniques, drawing meaningful comparisons between their performances is not possible since they have been applied to different datasets and results are highly variable across different populations and imaging protocols Caligiuri et al., 2015) . To our knowledge, no studies have compared the performance of these classification techniques for detecting WMHs against one another on the same datasets, especially for cases where classification is attempted without using the optimal FLAIR information. In this paper, we have extensively compared the performance of these different classification techniques in detecting WMHs with and without FLAIR information using 3 different large publicly available datasets with different scanners and acquisition protocols. This enables us to draw more generalizable conclusions regarding the performance of the classifiers. Our contributions include an extensive comparison of 10 widely used classification techniques in detecting WMHs across 4 different datasets, three of which are from multi-site and multi-scanner studies and across different combinations of imaging modalities. In addition, we make publicly available an implementation of the segmentation tool along with all the pre-trained classifiers (http://nist.mni.mcgill.ca/?p=221). The proposed tool is generalizable to data from different scanners since it has been trained on data from multiple scanners."}, {"section_title": "Materials and methods", "text": ""}, {"section_title": "Subjects", "text": "The performances of the different classifiers were assessed based on four datasets of subjects with different ranges of WMH loads. Table 1 shows the demographic information for each dataset."}, {"section_title": "ADC", "text": "This dataset consists of 70 individuals (70-90 years old) with normal cognition, mild cognitive impairment (MCI), and AD dementia from University of California, Davis Alzheimer's Disease Center (ADC) who were scanned using T1w, double-echo T2w/PD, and FLAIR MRI modalities."}, {"section_title": "NACC", "text": "This dataset consists of a patient sample of 32 MCI and AD subjects obtained from the National Alzheimer's Coordinating Center (NACC) database which is a database of subjects with a range of cognitive status, i.e. normal cognition, MCI, and demented who received T1w, and FLAIR MRI scans (https://www.alz.washington.edu/). Data consisted of variables from a Uniform Data Set collected from more than 30 Alzheimer's disease centers (ADC) throughout the United States and cataloged at the NACC. ADCs are National Institute on Aging-funded centers that enroll patients using different participation recruiting practices. A full description of the NACC data set has been previously provided (Beekly et al., 2004; Morris et al., 2006) . NACC data used here has been acquired at six different ADCs using eight different scanner models of three different manufacturers. Subjects were selected to have low, medium, and large WMH loads."}, {"section_title": "ADNI", "text": "Data used in the preparation of this article were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (adni. loni.usc.edu). The ADNI was launched in 2003 as a public-private partnership, led by Principal Investigator Michael W. Weiner, MD. The primary goal of ADNI has been to test whether serial magnetic resonance imaging (MRI), positron emission tomography (PET), other biological markers, and clinical and neuropsychological assessment can be combined to measure the progression of mild cognitive impairment (MCI) and early Alzheimer's disease (AD)."}, {"section_title": "ADNI1", "text": "This dataset consists of T1w, T2w, and PD scans of 53 subjects from ADNI1 study. Despite the fact that all subjects had to have Hachinski Ischemic Score of less than or equal to 4 as part of the inclusion criteria (Petersen et al., 2010) , we found many subjects that had high WMH loads. Subjects were selected from different sites and scanners and a preliminary assessment was performed to evaluate their WMH load with the goal of acquiring subjects with different scanner information as well as different loads of WMHs. For each scanner model, we selected datasets that had low, medium and high lesion loads. Approximately equal number of male and female subjects were selected. The age of the subjects was also considered for the selection, with the aim of achieving a normal distribution."}, {"section_title": "ADNI2/GO", "text": "This dataset consists of T1w and FLAIR scans of 46 subjects from ADNI2/GO studies. Subject selection criteria were the same as ADNI1. Table 2 summarizes the scanner information as well as the MR imaging parameters for each of the datasets."}, {"section_title": "MR imaging", "text": ""}, {"section_title": "Manual segmentation", "text": "In ADC, NACC, and ADNI2/GO datasets, the WMHs were manually segmented by experts with FLAIR used as the primary contrast and the other image contrasts used to aid in the decision process to include or exclude a voxel from the lesion mask. For the ADNI1 dataset, T2w was used as the primary contrast. All WMH masks were created fully manually, without using any thresholding technique. ADC, ADNI1 and ADNI2/GO datasets were scored by JM, an MD with training in general radiology, and specialized in MRI imaging methods of quantifying WM pathologies in MS and AD. JM has more than 12 years of experience in reading MRI and developing standardized MRI guidelines to detect WM lesions using different image modalities (Maranzano et al., 2016) . The lesions were fully manually traced using the interactive software package Display, part of the MINC Tool Kit (https://github.com/BIC-MNI) developed at the McConnell Brain Imaging Center of the Montreal Neurological Institute. The program allows simultaneous viewing and segmentation in the coronal, sagittal and axial planes, and cycling between each image volume. The image volumes were co-registered so that, when assessing a given voxel or region and switching from one contrast to another (e.g. T1w to FLAIR), the rater can assess the intensity signal of the same region of the brain on each contrast. In the NACC dataset, images were similarly segmented by two raters that had previously received training to segment WMHs, and ascertained by an expert neurologist. The between rater agreement was verified (Dice Kappa=0. 70) . All the manual raters were also asked to segment 3 scans with low ( < 5 cm Table 3 shows the intrarater Dice Kappa obtained from these segmentations as well as WMH volume information for each dataset. Fig. 1 shows examples of the available contrasts as well as the manual labels for each dataset."}, {"section_title": "Pre-processing", "text": "All the images were preprocessed using our standard pipeline from MINC toolkit, publicly available at https://github.com/BIC-MNI/ minc-tools (Aubert-Broche et al., 2013) through three steps: (I) Image noise reduction using mincnlm tool (Coupe et al., 2008) , (II) Correction of image intensity non-uniformity using nu_estimate tool (Sled et al., 1998) and (III) Normalization of image intensity into range (0-100) using an intensity histogram matching algorithm (volume_pol tool). The T1w, T2w, PD, and FLAIR images were linearly co-registered using a 6 parameter rigid registration (Collins et al., 1994) . The T1w images were linearly and then nonlinearly registered to an average template (Collins and Evans, 1997 ) created based on data from the ADNI1 study (Fonov et al., 2011a (Fonov et al., , 2011b , enabling the use of anatomical priors in the segmentation process. Brain extraction was performed on the linearly registered T1w images as part of the standard pipeline (Aubert-Broche et al., 2013) ."}, {"section_title": "Features", "text": "The classical features that are most commonly used in lesion segmentation tasks are the voxel intensities in each MRI contrast . Here, these classical features as well as a variety of intensity and spatial features were used to train the classifiers. These features have been previously validated and verified to be informative in detecting WMHs. The rationale behind the M. Dadar et al. NeuroImage 157 (2017) 233-249 selection of the suggested feature set as well as the contribution of each of the features has been described in more detail in an earlier work (Dadar et al., 2017) .\nI) Voxel intensity from T1w, T2w, PD, and FLAIR images II) Average voxel intensity of non-WMH tissue from T1w, T2w, PD, and FLAIR images for the specific voxel location obtained from averaging non-WMH voxels of the training subjects in stereotaxic space. Since datasets were selected to include subjects with very small WMH loads, there were at least several subjects in each training set that had no WMHs in each specific voxel location. The average intensity of non-WMH tissue feature was calculated using data from these subjects. III) Probability of voxel being a lesion (P WMH ) obtained by creating a probability distribution function (PDF) based on the intensity histogram of the WMH labels from manually segmented training data across all WMH voxels IV) Probability of voxel being healthy tissue (P H ) obtained by creating a PDF of Non-WMH voxels from manually segmented training data across all non-WMH voxels V) Ratio of P H / P WMH VI) Spatial WMH probability map created by averaging the WMH maps from the training dataset VII) Ratio of T2w/T1w, PD/T1w, FLAIR/T1w\nThe WMH segmentations were performed in the native space of the primary image contrast, i.e. T2w for ADNI1 and FLAIR for ADC, NACC, and ADNI2/GO datasets to avoid the blurring caused by resampling of the primary image contrast. To achieve this, all images were non-linearly transformed to the ADNI template space, and all the priors and averages were calculated in this stereotaxic space and then registered back and resampled in the native space using the inverse nonlinear transformations. The final segmentations were performed using the features in the native space of the image with optimal contrast. Therefore, the image with optimal contrast is not resampled, and only a 6-parameter rigid transformation is applied to the other coregistered contrasts (as opposed to other techniques where the nonlinearly registered images are used for segmentation). Fig. 2 illustrates a flow-chart of the preprocessing, registration, and feature selection steps of the pipeline."}, {"section_title": "Classification methods", "text": "In a binary classification setting, a classifier is a function that maps a set of input feature vectors x x x x = ( , , \u2026, ) n T 1 2 from feature space X to an output class label set y in Y = {0,1}. Here, we select and compare supervised methods as unsupervised techniques have been shown to be less robust, dependent on initialization, and do not necessarily arrive at meaningful segmentations (Clarke et al., 1995) . Specifically for the task of WMH segmentation, supervised methods generally outperform unsupervised techniques (Anbeek et al., 2004; Caligiuri et al., 2015) ."}, {"section_title": "Naive Bayes", "text": "Na\u00efve Bayes classifiers are a family of probabilistic classifiers that have been used for many simple classification tasks (Lewis, 1998) . Na\u00efve Bayes is a probabilistic classifier that returns the label that maximizes the posterior probability p y|x ( ) as the output, with the underlying assumption that given the class label, all the features are conditionally independent\nNa\u00efve Bayes classifiers have previously been used to segment diabetic retinopathy lesions (K\u00f6se et al., 2012) ."}, {"section_title": "Discriminant analysis", "text": "Linear and Quadratic Discriminant Analysis methods (LDA and QDA) are generalizations of Fisher's linear discriminant method that can be used for performing classification (Fisher, 1936; McLachlan, 2004) . Using the assumption that the conditional probability density functions of the classes are normally distributed with identical covariance, i.e.\nLDA predicts input vector x as belonging to a class y based on the log likelihood ratio p y |x p y |x\n. QDA is similar to LDA, without the identical covariance assumption.\nAmato et al. proposed a non-parametric discriminant analysis technique for segmenting MS lesions (Amato et al., 2003) . "}, {"section_title": "Logistic regression", "text": "The idea of logistic regression was introduced by Cox with the purpose of estimating a binary response based on a set of independent features (Cox, 1958) . The Logistic regression classifier models p y x\nand estimates the error using a cumulative logistic distribution function.\nS\u00e1nchez et al. used a logistic regression classifier for automatic detection of micro-aneurysms in retinal images (S\u00e1nchez et al., 2009 )."}, {"section_title": "Decision trees", "text": "The idea of performing induction using decision trees was first proposed by (Hunt et al. 1966 ) and later developed by Quinlan for classification tasks (Quinlan, 1986) . Decision tree classifiers map the feature vector x to draw conclusions about the target value y using a tree structure in which the leaves represent class labels y and the nodes represent partitionings of feature x that lead to these class labels. The decision tree is generally constructed in 2 phases: (1) A recursive, topdown procedure \"grows\" a tree to fit the training data. (2) A \"pruning\" phase to avoid overfitting. Decision tree classifiers have since been used for tissue classification (Chao et al., 2009 ) and lesion segmentation in Multiple Sclerosis (MS) (Kamber et al., 1992) ."}, {"section_title": "Random forests", "text": "Initially introduced by Breiman (Breiman, 2001) , Random decision forests perform classification and regression by constructing a multitude of independent decision trees and using the mode or mean of their predictions as the final output for classification or regression tasks, respectively. They have since been widely used for lesion segmentation in MS (Geremia et al., 2011; Maier et al., 2015; Mitra et al., 2014; Akselrod-Ballin et al., 2009 ) as well as for WMH segmentation in aging and AD populations (Ithapu et al., 2014) ."}, {"section_title": "K-nearest neighbors", "text": "The K-nearest neighbors (KNN) is a non-parametric instance based algorithm developed by Altman for classification and regression (Altman, 1992) . The KNN classifier uses majority voting between the labels for the K closest data points in the feature space in the training data to assign a label to the new unseen test data. The distance metric used for determining the closest data points is generally the Euclidian distance for continuous variables or Hamming distance for discrete variables. Due to its simplicity, it has been popular for various applications including segmentation of MS lesions (Wu et al., 2006b) and WMHs (Anbeek et al., 2004) ."}, {"section_title": "Support Vector Machines", "text": "The idea of performing nonlinear classification using support vector machines (SVMs) was introduced by Boser et al. (Boser et al., 1992) . SVMs perform classification by finding a maximum-margin hyperplane that separates the two classes while maximizing the distance between the nearest point from either class. SVMs have been widely used for lesion segmentation tasks in MS populations (Ferrari et al., 2003; Abdullah et al., 2011) as well as for WMH segmentation in aging and AD populations (Ithapu et al., 2014; Quddus et al., 2005) ."}, {"section_title": "Bagging", "text": "Bootstrap aggregating, also called bagging, is a model averaging technique initially introduced by Brieman et al. with the purpose of improving stability and reducing variance (Breiman, 1996) . Bagging is an ensemble method that builds multiple classifiers such as decision trees by uniformly sampling the training data with replacement, and voting, to output a consensus prediction. Madabhushi used bagging for detecting prostatic adenocarcinoma from high resolution MR images (Madabhushi et al., 2006) ."}, {"section_title": "AdaBoost", "text": "Adaptive Boosting or AdaBoost was developed by Freund and Schapire (Freund et al., 1999) . AdaBoost performs classification by aggregating the outputs of other learning algorithms (also called weak learners) into a weighted sum that represents the final output of the boosted classifier. The subsequent weak learners are tweaked in favour of the instances that were misclassified by previous classifiers to improve classification accuracy. It has been used for MS lesion segmentation (Wels et al., 2008) , interactive lesions segmentation (Li et al., 2007) , as well as segmentation of WMHs (Quddus et al., 2005; Ghafoorian et al., 2016a) .\nFor all classification tasks, the Scikit-learn Python library implementations were used (Pedregosa et al., 2011) . For Na\u00efve Bayes, LDA, QDA, SVM, and Decision Tree classifiers, the default settings were used. For KNN, 10 neighbors were used. For Bagging, KNN classifiers were used with the default parameters. For AdaBoost and Random Forests classifiers, 100 estimators were used. Ten-fold cross validation across subjects was used to train and validate the performance of the classifiers; i.e. no voxels from subjects used for validation were used in training and feature selection stages. It is worthwhile noting that the spatial WMH probability maps, average intensities, and P WMH and P H were also calculated through the cross-validation to avoid any overfitting (no data used in testing was used to generate the priors). All the segmentations were performed in the native space for the optimal primary modality to avoid resampling and further blurring of the lesion borders. To achieve this, all the priors and averages were first calculated in the stereotaxic template space and then registered back and recalculated in the native space using the inverse nonlinear transformations."}, {"section_title": "Evaluation metrics", "text": "There is no single similarity measure that can perfectly reflect the level of agreement between WMH segmentation maps. While Dice Kappa similarity measure (Dice, 1945) Griffanti et al., 2016; Schmidt et al., 2012; Sim\u00f5es et al., 2013; Steenwijk et al., 2013; Dadar et al., 2017) . In this study, while Dice Kappa was used as the primary similarity measure for validation of the classifiers, other similarity measures such as the two-way mixed single measures with absolute agreement intra-class correlation coefficient (ICC) for the total WMH loads to assess the volumetric correspondence between the manual and automatic segmentations (Koch, 1982) , true positive rate (TPR), positive prediction value (PPV), outline error rate (OER) measuring agreement of the raters in outlining of the same lesion (Wack et al., 2012) , and detection error rate (DER) measuring agreement in detecting the same regions (Wack et al., 2012) are reported to facilitate comparison with previously published papers. Table 4 shows the list of these metrics along with their definitions."}, {"section_title": "Results", "text": ""}, {"section_title": "Segmentation using T1w, T2w, PD, and FLAIR", "text": "The performance of each classifier was validated through 10-fold cross validation using T1w, T2w, PD, and FLAIR images for the ADC dataset. All voxels within a brain mask that contained the cerebrum, cerebellum and brain stem were classified. Table 5 shows the average Dice Kappa, detection/outline error rates (DER/OER), ICC, TPR, and PPV values for different classifiers. Fig. 3 shows boxplot diagrams for the same results separately for subjects with small, medium and large WMH loads. Fig. 4 shows the manual and automatic segmentation results of different classifiers on axial slices of one subject. To assess the statistical significance of the results, paired t-tests were performed on the Dice Kappa values of all pairs of classifier comparisons, and p- Table 5 Comparison between mean Dice Kappa, detection/outline error rate (DER/OER), intraclass correlation (ICC), true positive rate (TPR), and positive prediction value (PPV) of different classifiers for segmentation of WMHs using T1w, T2w, PD and FLAIR data in the ADC dataset. values were corrected for multiple comparisons using false discovery rate (FDR). Fig. 5 shows the negative logarithm of the FDR corrected pvalues."}, {"section_title": "Segmentation using T1w and FLAIR data", "text": "The performance of each classifier was validated through 10-fold cross validation using T1w and FLAIR images for the ADC, NACC, and ADNI2/GO datasets (recall that ADNI1 does not have FLAIR data). Table 6 shows the average Dice Kappa and detection/outline error rate (DER/OER) values for different classifiers. Table 7 shows corresponding ICC, TPR, and PPV values. Fig. 6 shows boxplot diagrams for the same results separately for subjects with small, medium and large WMH loads. Fig. 7 shows the manual and automatic segmentation results of different classifiers on axial slices of one subject. Fig. 8 shows the negative logarithm of the FDR corrected p-values of t-tests on Dice Kappa values of different classifier pairs. To assess the contribution of T2w+PD features in the performance of different classifiers, paired ttests were performed between the Dice Kappa values of the segmentations based on T1+T2w+PD+FLAIR and T1+FLAIR in the ADC dataset. The \"*\" in Table 7 indicates the significant differences between the two segmentations, after correction for multiple comparisons using FDR. The performance of Na\u00efve Bayes, QDA, and Bagging has significantly dropped without using T2w+PD information.\nSegmentation using T1w, T2w, and PD data While FLAIR scans have the optimal contrast for differentiating WMHs from normal appearing white matter (Barkhof and Scheltens, 2002; Alexander et al., 1996; Bakshi et al., 2001) , many studies forgo acquisition of FLAIR images in favour of other modalities. In order to take advantage of large studies such as ADNI1 that do not have FLAIR, segmentation methods that can provide accurate segmentation results without using the optimal FLAIR contrast are highly advantageous. A relatively easier task is to segment WMHs from T1w, T2w, and PD or T1w, and T2w images. While segmenting WMHs solely from T1w images with high accuracy proves to be extremely difficult, being able to obtain an estimate of the WMH load that is significantly correlated with the actual loads can still be useful.\nTo address the first challenge, we trained and validated the performance of the classifiers using the features obtained from T1w, T2w, and PD images from the ADC and ADNI1 datasets. Table 8 shows the mean Dice Kappa, detection/outline error rates (DER/OER), and the corresponding ICC, TPR, and PPV values for each classifier and dataset, respectively. Fig. 9 shows the corresponding boxplot diagrams for these results separately for subjects with small, medium and large WMH loads. Fig. 10 shows the segmentation results on the axial slices for different classifiers and datasets. Fig. 11 shows the negative logarithm of the FDR corrected p-values of t-tests on Dice Kappa values of different classifier pairs. To assess the contribution of FLAIR features in the performance of different classifiers, paired t-tests were performed between the Dice Kappa values of the segmentations based on T1+T2+PD+FLAIR and T1+T2+PD in the ADC dataset. The \"*\" symbol in Table 8 indicates the significant differences between the two segmentations, after correction for multiple comparisons using FDR. The performance of all classifiers has significantly dropped without using FLAIR information."}, {"section_title": "Segmentation using T1w and T2w data", "text": "Many studies forgo acquisition of PD images in favour of acquiring a higher resolution T2w image. Here we assess the performance of the classifiers without using PD images. Table 9 shows the mean Dice Kappa and detection/outline error rates (DER/OER), and the corresponding ICC, TPR, and PPV values for each classifier and dataset, Table 7 Comparison between intra-class correlation (ICC), true positive rate (TPR), and positive prediction value (PPV) of different classifiers for segmentation of WMHs in different datasets using T1w and FLAIR data for ADC, NACC, and ADNI2/GO datasets. respectively. Fig. 12 shows the corresponding boxplot diagrams for these results separately for subjects with small, medium and large WMH loads. Fig. 13 shows the segmentation results on the axial slices for different classifiers and datasets. Fig. 14 shows the negative logarithm of the FDR corrected p-values of t-tests on Dice Kappa values of different classifier pairs. To assess the contribution of PD feature in the performance of different classifiers, paired t-tests were performed between the Dice Kappa values of the segmentations based on T1+T2+PD and T1+T2 in ADC, and ADNI1 datasets. The \"*\" symbols in Table 9 indicate the significant differences between the two segmentations, after correction for multiple comparisons using FDR. No classifier has performed significantly worse after removing PD features for either dataset."}, {"section_title": "Segmentation using only T1w data", "text": "To address the second challenge, we trained and validated the performance of the classifiers with features only from T1w images from ADC, NACC, ADNI1, and ADNI2/GO datasets. Table 10 shows the mean Dice Kappa and detection/outline error rates (DER/OER), for each Fig. 7 . Axial slices comparing manual and automatic segmentations using T1w and FLAIR information in one subject from each of ADC, NACC, and ADNI2/GO datasets. Yellow color indicates regions labeled as WMH in both segmentations, blue color indicates regions only segmented by the automatic technique, and red color indicates regions only segmented by the manual rater. "}, {"section_title": "Table 8", "text": "Comparison between mean Dice Kappa (SI), detection/outline error rate (DER/OER), intra-class correlation (ICC), true positive rate (TPR), and positive prediction value (PPV) of different classifiers for segmentation of WMHs using T1w, T2w, and PD data, ADC and ADNI1 datasets. classifier and dataset. Table 11 shows the corresponding ICC, TPR, and PPV values. Fig. 15 shows boxplot diagrams for these results separately for subjects with small, medium and large WMH loads. Fig. 16 shows the segmentation results on the axial slices for different classifiers from each study. Fig. 17 shows the negative logarithm of the FDR corrected p-values of t-tests on Dice Kappa values of different classifier pairs. "}, {"section_title": "Oversegmentation/undersegmentation", "text": "To provide information regarding oversegmentation/undersegmentation of WMHs, paired t-tests were performed between manual and automated total WMH loads in small, medium, and large groups on T1+FLAIR (n=147) and T1+T2+PD (n=123) experiments. Table 12 shows the mean and standard deviation of the volumes as well as statistical significance of the differences after correcting for multiple comparisons using FDR correction. From the results, we can see that Na\u00efve Bayes and QDA significantly oversegment WMHs in all three groups. Logistic regression and Bagging significantly undersegment medium and large WMHs. LDA and Decision Trees seem to work well , right) WMH load using T1w and T2w information for ADC (red) and ADNI1 (blue) datasets. Fig. 13 . Axial slices comparing manual and automatic segmentations using T1w and T2w information for ADC and ADNI1 datasets. Yellow color indicates regions labeled as WMH in both segmentations, blue color indicates regions only segmented by the automatic technique, and red color indicates regions only segmented by the manual rater.\nwith T1+FLAIR images, but they tend to significantly oversegment when dealing with T1+T2+PD sequences. AdaBoost, KNN, SVM and Random Forest seem to work very well for medium and large WMHs, but slightly oversegment small lesions. However, KNN and SVM seem to show a lot of variability (high standard deviations) for small lesions using T1+T2+PD sequences."}, {"section_title": "Computational burden", "text": "In order for a segmentation technique to be applicable to large-scale datasets, reasonable computation time and memory demands are crucial. To assess this, all classifiers were trained on the same dataset consisting of 50 subjects and used to segment 20 subjects on an Intel(R) Core(TM) i7-5600 CPU @ 2.60 GHz machine with 20.0 GBs RAM. Table 13 shows the training as well as segmentation time per subject in seconds for each classifier. "}, {"section_title": "Table 10", "text": "Comparison between mean Dice Kappa and detection/outline error rate (DER/OER) values of different classifiers for segmentation of WMHs using T1 data for ADC, NACC, ADNI1, and ADNI2/GO datasets. Table 11 Comparison between intra-class correlation (ICC), true positive rate (TPR), and positive prediction value (PPV) of different classifiers for segmentation of WMHs in different datasets using T1 data for ADC, NACC, ADNI1, and ADNI2/GO datasets. , right) WMH load using only T1w information for ADC (red), NACC (black), ADNI1 (blue), and ADNI2/GO (magenta) datasets. proves to be practically impossible since the results are greatly influenced by the MRI acquisition characteristics and resolution as well as the quality of the manually segmented labels that are used for training and validation. Here we have validated and compared the performance of a variety of different supervised linear and nonlinear classifiers in segmenting WMHs using 4 relatively large datasets. We also provide our fully automated tool for segmentation of WMHs from multiple contrasts of MR images along with the pre-trained classifiers.\nSeveral commonly used linear and nonlinear classifiers with different levels of computational complexity were employed for segmentation of WMHs from multiple contrasts of MR images. In presence of FLAIR information, most methods performed relatively well and can be employed for WMH segmentation. However, the performance of the classifiers declined significantly in absence of the optimal FLAIR modality information, with Random forests and AdaBoost classifiers still retaining the best performance. Using only T1w images, the performance of all classifiers declined drastically with random forest and AdaBoost classifiers still providing the best results. These segmentations tend to detect only the brightest of the WMHs. However, their high volumetric correlation with the gold standard values shows that while not perfectly accurate, they still might be used as surrogate measures to reflect WMH burden if they are also associated with risk factors and clinical measures. This can prove extremely valuable in studies that only have T1w scans and need to take into account the WMH burden.\nOne of the major issues when using automated techniques for segmenting WMHs is the variability caused by differences in the scanner and acquisition sequences which would in turn lead to differences in contrast and borders of WMHs. As a result, classifiers that are trained on data from a single scanner with a specific acquisition sequence tend to perform poorly on data from different scanners and/or sequences. To increase the generalizability of our tools, we have trained and validated our classifiers using data from different scanners/sites.\nIt would be worthwhile to note that all of the voxels inside the brain were input to the classifiers and no white matter mask or any mask excluding either ventricles or cerebrospinal fluids were used. This makes the classification task more challenging, but on the other hand, makes the performance of the classifiers more easily comparable with other methods since the results will not be dependent on the quality of the tissue segmentation algorithm or whether specific regions such as brainstem or cerebellum which are generally more challenging to segment are masked out. Another valid concern in using tissue segmentation results is that most tissue classification techniques use only T1w images, on which some of the WMHs appear hypointense. This makes the tissue classification results prone to error since they will be likely to classify WMHs as grey matter while most WMHs occur in the white matter. This misclassification in the initial tissue segmentation will add an extra level of noise to the data that can significantly affect WMH segmentation results. One limitation of our technique is that it has not been validated on patients with stroke; the intensity profile in such subjects is likely very different from the subjects evaluated here.\nIn detecting WMHs, FLAIR is of the highest importance since it provides the best lesion to WM contrast when compared with T1w, T2w and PD sequences. PD provides the most variable contrast difference between tissue types directly related to the parameters used in its acquisition. The more T2 weighted the PD sequence, the less supplemental contrast information it provides (since the information is already provided by the T2w sequence). Hence, the PD sequence is most meaningful if the parameters allow the CSF to be of the lowest possible signal. The T1w sequence on its own should only be considered in cases where other modalities are not available or their poor image quality prevents their use. The lower information given by T1w images resides in a poorer contrast between the signal of lesions and surrounding WM. Lesion intensity spans from iso-intense to WM to deep hypointense, causing the difficulty in detecting lesions using only T1w images. Another factor that can significantly affect the quality of both manual and automated segmentations is the signal to noise ratio (SNR). A lower SNR will impact the image quality and number of artifacts, which would then translate into poorer performance of either software or manual rater. The ADC, NACC, and ADNI2 FLAIRs had an average SNR value of 17.25 \u00b1 2.37, 20.11 \u00b1 5.52, and 35.11 \u00b1 7.26 as estimated by our denoising tool (Coupe et al., 2008) , respectively. This may partially explain the poorer results for ADC data. As a general rule, the highest possible SNR should be attained in each modality employed. In addition to SNR, ringing or ghosting caused by movement and inter-package motion also contributes to the deterioration of image quality.\nManually segmenting WMHs is a challenging task. Lesion edges always exhibit a degree of hyperintense signal that decreases gradually towards the healthy surrounding WM. In other words, no lesion edge goes from one pathologic hyperintense voxel, to a contiguous healthy hypointense WM voxel, and the edges may shift from scoring to scoring by one or two voxels. Additionally, when cases have multiple lesions, the surface to volume ratio of the lesions increases. Even when the rater identifies exactly the same lesions, one extra voxel around the edge of a small lesion may have a large impact on the Dice Kappa value. The small DER values for the manual segmentations further confirm that most of the disagreement between the manual segmentations occurs around the edges (0.03 \u00b1 0.04, 0.05 \u00b1 0.04, 0.03 \u00b1 0.04, and 0.04 \u00b1 0.04 for ADC, NACC, ADNI1, and ADNI2, respectively). Also, the poorer image quality, in terms of SNR, of the ADC dataset, could partially account for the worse intra-rater performance for that dataset. Segmenting WMHs without the optimal FLAIR modality is a challenging task. Additional errors might arise from comparing segmentations obtained without FLAIR with manual labels that are based on FLAIR images. The extent and borders of WMHs generally do not look the same on the different MRI sequences (Filippi et al., 1996) . It has been shown that FLAIR sequence is less sensitive in detecting thalamic lesions in vascular disease populations (Leite et al., 2004) . Furthermore, FLAIR may present hyperintense artifacts that can lead to an increase in false positives such as the hyperintensities often observed in insula (Hirai et al., 2000) . As a result, a certain degree of disagreement between segmentations obtained with and without FLAIR information is expected. This explains the higher SI values for the ADNI1 dataset where the manual segmentations are based on T2w/ PD scans compared with automatic segmentations with the same contrasts in ADC dataset (T1w, T2w, and PD) where FLAIR information was used for the manual segmentations. Additionally, the difference in tissue contrast between the PD sequence of the ADC dataset and ADNI1 may also partially account for the higher SI values for ADNI1. The PD scans in ADNI1 dataset had higher white-to-grey matter contrast, higher white matter-to-lesion contrast, and better delineation of CSF as a different tissue type, given its low signal. All these characteristics were absent in the ADC dataset, where PD was heavily T2 weighted. These differential characteristics are critical in the WMH segmentation process either by a rater or an automatic tool, improving the accuracy of the segmentations in ADNI1 cases.\nUsing classifiers such as KNN and Bagging with KNN has the additional drawback of longer computation time for segmenting new data. The fact that they do not require rigorous training is generally outweighed by their longer classification times, especially when one needs to segment 100s or 1000s of MRI volumes in larger datasets. In addition, these methods are generally more susceptible to skewedness in class distributions, which is the case in lesion segmentation tasks, since most voxels in the brain are non-WMHs. As a result, the examples of the more frequent non-WMH class tend to dominate the new predictions, simply owing to the fact that they are more common.\nAccurate quantification and localization of WMHs is critical since they are important clinical measures in the elderly and AD populations. A Dice Kappa value of 0.7 is considered as a good segmentation in the literature (Caligiuri et al., 2015) . Random forest was able to obtain average Dice Kappa values higher than 0.7 for the medium lesion load and 0.8 for large lesion load groups, which is considered as excellent agreement. The average Dice Kappa for the small lesion group was higher than 0.5, which is still considered as a very good agreement, especially considering the fact that Dice Kappa values are smaller for objects with a high surface to volume ratio, as is the case for subjects with small lesion loads.\nThe Random Forests technique consistently had the best results across all the experiments when using Dice Kappa (SI) as the primary measure of comparison. Considering the fact that it also had a shorter computational time than the second-best classifier (AdaBoost), Random Forests was the best classifier amongst the nonlinear classification techniques tested. The Linear Discriminant Analysis method was the best linear classifier considering the Dice Kappa results and computation times.\nIn cases where different classifiers have different strengths and weaknesses, using an ensemble of all the classifiers can improve the overall classification accuracy. Here, performing a voting between the outputs of all 10 classifiers achieved Dice Kappa values of 0.68 \u00b1 0.17, (Schmidt et al., 2012) Markov random field 53 0.66 0.79 0.85 0.75 Sheei (Shiee et al., 2010) Fuzzy segmentation 10 0.63 0.63 Ong (Ong et al., 2012) Adaptive trimmed mean 38 0.36 0.56 0.71 0.47 Ithapu (Ithapu et al., 2014) Random Forests Support Vector Machine 38 0.67 0.54 0.67 0.54 Herskovits (Herskovits et al., 2008) Bayesian classification 42 0.60 0.60 Dyrby (Dyrby et al., 2008) Neural networks 362 0.45 0.62 0.65 0.56 Erus (Erus et al., 2014) Abnormality detection + principal component analysis 33 47\n0.54 0.66 0.54 0.66 Ghafoorian (Ghafoorian et al., 2016b) Convolutional neural networks 46 0.79 0.79 Sim\u00f5es (Sim\u00f5es et al., 2013) Gaussian Mixture Model 28 (14-9-5) 0.51 0.70 0.84 0.62 Yoo (Yoo et al., 2014) Variable thresholding 32 (7-10-15) 0.59 0.73 0.86 0.76 Griffanti (Griffanti et al., 2016) K 0. 74 \u00b1 0.10, 0.66 \u00b1 0.22, and 0.72 \u00b1 0.19 (versus 0.66 \u00b1 0.17, 0.72 \u00b1 0.10, 0.66 \u00b1 0.23, and 0.72 \u00b1 0.19 for the Random Forest classifier) for ADC, NACC, ADNI1, and ADNI2 datasets, respectively, suggesting a slight improvement for ADC (p=0.001), and NACC (p=0.004), and no difference for ADNI1 and ADNI2 (p > 0.05). As mentioned previously, drawing meaningful comparisons between techniques that have been applied to different datasets, using different brain masks, and with different definitions of WMHs should be done with care. Taking these considerations into account, our Random Forests classifier performs very well in comparison with other methods in the field (Table 14) .\nAccurate quantification of WMHs is critical for evaluating the vascular burden contributing to cognitive deficits in vascular dementia and AD patients as well as the aging population in general. Due to the high variability across different populations, image acquisition parameters and manual segmentation protocols, comparing different techniques in a meaningful way is practically impossible. Here we have extensively compared 10 most widely used off-the-shelf classifiers in segmenting WMHs with and without FLAIR information in terms of accuracy and computational burden. These experiments have enabled us to draw meaningful and generalizable comparisons between different methods and determine which classifiers are best suited to the task of segmenting WMHs."}]
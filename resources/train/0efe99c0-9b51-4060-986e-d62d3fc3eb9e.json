[{"section_title": "Abstract", "text": "There is an increasing need to develop and apply powerful statistical tests to detect multiple traits-single locus associations, as arising from neuroimaging genetics and other studies. For example, in the Alzheimer's Disease Neuroimaging Initiative (ADNI), in addition to genome-wide single nucleotide polymorphisms (SNPs), thousands of neuroimaging and neuropsychological phenotypes as intermediate phenotypes for Alzheimer's disease, have been collected. Although some classic methods like MANOVA and newly proposed methods may be applied, they have their own limitations. For example, MANOVA cannot be applied to binary and other discrete traits. In addition, the relationships among these methods are not well understood. Importantly, since these tests are not data adaptive, depending on the unknown association patterns among multiple traits and between multiple traits and a locus, these tests may or may not be powerful. In this paper we propose a class of data-adaptive weights and the corresponding weighted tests in the general framework of generalized estimation equations (GEE). A highly adaptive test is proposed to select the most powerful one from this class of the weighted tests so that it can maintain high power across a wide range of situations. Our proposed tests are applicable to various types of traits with or without covariates. Importantly, we also analytically show relationships among some existing and our proposed tests, indicating that many existing tests are special cases of our proposed tests. Extensive simulation studies were conducted to compare and contrast the power properties of various existing and our new methods. Finally, we applied the methods to an ADNI dataset to illustrate the performance of the methods. We conclude with the recommendation for the use of the GEE-based Score test and our proposed adaptive test for their high and complementary performance."}, {"section_title": "Introduction", "text": "Published genome-wide association studies (GWAS) have shown that single nucleotide polymorphisms (SNPs) associated with common diseases and complex traits are not easily detected. The main reason is due to their small effect sizes: the odds ratios from the identified associations are often only 1.1-1.3. It is also realized that using only one single phenotype may not suffice to identify the underlying genetic mechanism, as a complex disease may exhibit its occurrence or progression in several syndromes. Thus, multivariate trait analysis is being increasingly recognized as a potentially useful strategy in genetic studies (Zhu and Zhang, 2009 ). However, a dilemma in joint analysis of multiple traits is the inevitable power loss as more and more non-associated traits are being included; in practice, there is no guarantee that multiple traits being analyzed are all simultaneously associated with the same SNP. Therefore, a key issue in multivariate trait analysis is how to maximally maintain statistical power in the presence of many nonassociated traits while gaining the power when many or most of the traits are associated with an SNP.\nVarious methods have been proposed and applied to multivariate trait analysis. Broadly speaking, any existing method for pedigree or longitudinal data analysis is applicable; see a recent nice review by Yang and Wang (2012) . The methods can be classified into a few categories. The first category is to conduct univariate analysis on each trait, then combine their results (Yang et al., 2010) . For example, for any given SNP, one can conduct a single trait-single SNP analysis for each of the multiple traits, then take the minimum p-value from the univariate analyses with an adjustment for multiple testing. This is like the most commonly adopted approach to single trait-single SNP analysis in GWAS, the so-called UminP approach. The second class is based on dimension reduction on multivariate traits, usually by principal components analysis (PCA) (Lan et al., 2003; Wang and Abbott, 2007) or by principal components of heritability (PCH) (Klei et al., 2008) and related NeuroImage 96 (2014) [309] [310] [311] [312] [313] [314] [315] [316] [317] [318] [319] [320] [321] [322] [323] [324] [325] methods Wang et al., 2008) . For PCA, a main issue is that a few top PCs may not capture sufficient association signals (Aschard et al., 2013) . For PCH, the sample splitting strategy for population-based studies is not efficient (Yang and Wang, 2012) , though the modification of Lin et al. (2012) overcomes this downside. Nevertheless, the interpretation with the use of a few principal components may not be straightforward, and it is debatable whether there exist a few PCs that can genetically capture a large proportion of trait variations. Importantly, it is not clear how robust these methods are in the presence of many non-associated traits, and how many components are needed. Canonical correlation analysis (CCA) also belongs to this class; it seeks the linear combination of all traits yielding the greatest association with a locus (Ferreira and Purcell, 2009) . Another special case is simply to take the average (or sum) of multiple traits and then conduct a univariate analysis with this single average (or sum) trait, which is called Average (or Sum) method and has been applied to neuroimaging genetic data recently . As in the case for single trait-multilocus testing, the Average (or Sum) method suffers from severe power loss in the presence of opposite association directions between the traits and a locus (Pan, 2009) , or even worse, as to be shown later, in the presence of some non-associated traits. The third class includes some classical methods for multivariate data, such as MANOVA (Ferreira and Purcell, 2009 ), which however is not applicable to non-Normal traits, e.g. binary traits. Linear mixed models (LMMs) or generalized least squares for quantitative traits, and generalized linear mixed models (GLMMs) for discrete traits provide a more general alternative (Fitzmaurice and Laird, 1993; Li et al., 2011; Korte et al., 2012) . However, these likelihood-based approaches require one to correctly specify a model, including the correlation structure among the multiple traits, which is often difficult, especially for non-Normal traits. Furthermore, fitting GLMMs is computationally demanding. Alternatively, the generalized estimation equations (GEE) methodology (Liang and Zeger, 1986 ) is convenient to use, only requiring a correct specification of a marginal mean regression model, not a variance or covariance structure and other higher moments of the traits. In particular, its (generalized) score vector is easy to calculate, in contrast to the intractability in GLMMs. The GEE framework is general and flexible: it can accommodate covariates and various types of traits (Chen et al., 2011; Lange et al., 2003; Liu et al., 2009 ). Yang and Wang (2012) commented that there may be inflated Type I errors in GEE; we show here that the problem is mainly with the Wald test (Pan, 2001) while the Score test and other score-based tests seemed to work well. Hence, in this paper we adopt the GEE framework, applying some existing tests and developing some new ones, to test for association between a single SNP and multiple, possibly a large number of, quantitative traits.\nA challenge in association testing with multiple parameters, such as in multilocus analysis or multivariate trait analysis, is the lack of a uniformly most powerful test. Depending on the unknown truth of the underlying association patterns, any given and fixed test may or may not be powerful. For example, depending on how many of a given set of multiple traits are associated with a locus, different tests may be more powerful: if only few of the traits are associated, then a univariate minimum p-value (UminP) method based on choosing the most significant p-value of the univariate tests on each of the multiple traits, similar to TATES (van der Sluis et al., 2013) , would be more powerful; on the other hand, if most or all of the traits are associated with the locus with similar effect sizes, the simple Average method is expected to be more powerful. Our simulation results will confirm these points later. Accordingly, in multilocus association testing, adaptive tests based on weighting multiple loci differently have been proposed (e.g. Lin and Tang, 2011) . However, due to the use of fixed weights, these adaptive tests may still suffer from power loss under some situations. Here we propose a class of more highly adaptive tests with a wide range of weights on multiple traits. The goal is that, for a given situation with some unknown association patterns, we can find at least one set of the weights yielding a high-powered test. In our earlier example, if only one trait is associated with a locus, then assigning a large weight to the associated trait while assigning small weights to other traits would be optimal; on the other hand, if all traits are (almost) equally associated with the locus, we would like to assign an equal weight to all the traits. Our proposed class of tests are based on weighting the (generalized) score vector of a marginal generalized linear model (GLM) (McCullagh and Nelder, 1983) in GEE; it maintains the computational simplicity of the Score test and the generality and flexibility of GLMs. Each of our proposed test statistics is a sum of powered score statistics, say SPU(\u03b3), in which an integer \u03b3 indexes a set of weights on the multiple traits. Our adaptive SPU (aSPU) test essentially estimates and thus chooses the most powerful SPU test for a given dataset.\nAnother contribution of this work is to point out connections among the existing and new tests. Although some existing methods, such as classic ones like CCA and MANOVA, recently proposed ones like TATES (van der Sluis et al., 2013 ), MultiPhen (O'Reilly et al., 2012 and kernel machine regression (KMR) (Maity et al., 2012) , and some potentially usable ones like MDMR (McArdle and Anderson, 2001) , have been suggested for analysis of multivariate traits, their relationships with each other are largely unknown. Here we analytically illuminate on how these existing tests and our proposed tests are related. In particular, when testing on association between multiple quantitative traits and a single SNP in the absence of other covariates, we point out that many existing tests are special cases of the SPU tests. For example, CCA, MANOVA and the GEE-Score test are equivalent, which in turn are closely related to MultiPhen; the Average method coincides with the GEE-SPU(1) test, while TATES is closely related to the GEE-SPU(\u221e); Under suitable conditions, both MDMR and KMR are the same as the GEE-SPU(2) test. These analytical results will be confirmed in our extensive simulation studies.\nFinally we will apply these methods to the NIH Alzheimer's Disease Neuroimaging Initiative (ADNI) data. We aim to detect associations between SNPs and some multivariate neuroimaging phenotypes in several related regions of interest (ROIs). As both imaging and genotyping technologies advance, imaging genetics is emerging as a promising yet challenging field. In particular, due to numerous phenotypes measured for the ROIs, there is a high demand on developing and applying powerful association testing for multivariate traits, given limited multivariate methods available (Glahn et al., 2007) . Shen et al. (2010) applied the simple Average method and confirmed two associated genes, APOE and TOMM40. We aimed to investigate how our proposed new tests perform as compared to other existing tests. We will demonstrate the advantages and potential usefulness of the GEE-based tests."}, {"section_title": "Methods", "text": ""}, {"section_title": "Generalized estimating equations", "text": "Suppose that for each subject i = 1,\u2026,n, we have k traits Y i = (y i1 , y i2 , \u2026, y ik )\u2032, x i = 0, 1 or 2 is the genotype score (i.e. count of the minor allele) for an SNP of interest, and z i = (z i1 , z i2 ,\u2026, z iq ) is a row vector of q covariates. Define the design matrices for the SNP effects and covariates as\nwhere 0 is a row vector of all 0's. X i is a k \u00d7 k matrix, and Z i is a k \u00d7 k(q + 1) matrix including the intercept term. Define two regression coefficient vectors as \u03b2 = (\u03b2 1 ,\u2026,\u03b2 k )\u2032 for X i and \u03c6 = (\u03c6 11 ,\u2026,\u03c6 1(q + 1) , \u2026,\u03c6 k1 ,\u2026,\u03c6 k(q + 1) )\u2032 for Z i , where the main interest is on \u03b2, the SNP effects on the traits. The marginal means, E(Y i |x i ,Z i ) = \u03bc i , the SNP and covariates are modeled through a marginal generalized linear model (GLM):\nwith H i = (Z i ,X i ),\u03b8 = (\u03c6\u2032,\u03b2\u2032)\u2032 and g(.) as a suitable link function. The consistent and asymptotically Normal estimates of \u03b2 and \u03c6 are obtained by solving the GEE (Liang and Zeger, 1986) :\nwhere g(.) \u22121 is the inverse function of g(.), \u03d5 is a possible dispersion parameter,\nis a working correlation matrix that may depend on some unknown parameters \u03b1. Note that R w does not have to be correctly specified; for convenience, a working independence model with R w = I is often used, as done in this paper unless specified otherwise. With a canonical link function and a working independence model (i.e. R w = I), it is not difficult to obtain the (generalized) score vector and its consistent covariance estimate:\nwhere\u03bc i is an estimate of \u03bc i , e \u03a3 is partitioned according to the score vector components U .1 and U .2 for \u03c6 and \u03b2 respectively."}, {"section_title": "Binary traits", "text": "For binary traits (coded as 0 and 1), we use the logit link function, and v(\u03bc im ) = \u03bc im (1 \u2212 \u03bc im ). The (m, l)th element of \u2202\u03bc i /\u2202\u03b8\u2032 is H i,ml \u03bc im (1 \u2212 \u03bc im ) with H i,ml as the (m, l)th element of H i . We have the score vector and its covariance estimate as"}, {"section_title": "Quantitative traits", "text": "We use the identity link g(\u03bc im ) = \u03bc im and v(\u03bc im ) = \u03d5. Then we have\nIf we assume a common covariance matrix for Y i 's across all i, then a better covariance estimate is\nwhich is used by default for its better finite-sample performance (Pan, 2001) ."}, {"section_title": "Existing tests in GEE", "text": "Our goal is to detect whether there is any association between any of the traits and the SNP via testing the null hypothesis H 0 : \u03b2 = (\u03b2 1 , \u2026, \u03b2 k )\u2032 = 0 versus H 1 : \u03b2 \u2260 0.\nTo construct score-based tests with covariates Z i , we first fit the GEE model under H 0 , g(\u03bc i ) = Z i \u03c6, to obtain\u03c6 and\u03bc i . If we denote for subject i, U i1 as the score vector corresponding to covariates Z i , and U i2 as the score vector for the SNP, then the score vector under the null hypothesis, with an assumed independent working correlation structure for the traits, is:\nThe null distribution of the score vector for \u03b2 is asymptotically Normal under H 0 :\nwhere V 11 , V 12 , V 21 , V 22 are defined in Eq.\n(1). Pan, 2009) can be adopted, we use a simulation based method to calculate its pvalue. Specifically, we simulate the score vectors\nWith a working independence model R w = I, each component U .2, j is equal to the score function for the univariate analysis on the jth trait. Hence, the GEE-UminP test is equivalent to the usual UminP test that combines the univariate analyses on the multiple traits."}, {"section_title": "New tests in GEE", "text": "For association analysis of rare variants, weighting on the components of the score vector has been recognized as a general and effective approach to synthesizing information contained in the components of the score vector (Lin and Tang, 2011) . We borrow this idea and apply it to the current context, yielding a weighted score test:\nwhere the weights w j 's have to be specified, which is a key and challenging issue. Various choices of the weights have been proposed for analysis of rare variants, all of which are some fixed weights. Our goal is to specify a whole class of weights such that they can cover a wide range of situations: for any given data with unknown true association patterns, we hope that at least one member from the specified class of weights would yield a high-powered test. We reason that, since association information is largely contained in the score vector, the driving force of constructing various score-based tests (as reviewed above), it might be productive to use the score vector to construct the weights. Accordingly, we propose a class of weights w j = U .2,j \u03b3 \u2212 1 for a series of values of \u03b3 = 1, 2,\u2026, \u221e, leading to the sum of powered score (U) tests, called SPU tests:\nAs \u03b3 = 1, the SPU(1) test sums up the information in the multiple traits equally, just as the Average (Sum) test. As the power parameter \u03b3 increases, the SPU(\u03b3) test puts higher weights on the traits with larger |U .2,j |, while gradually decreasing the weights on the other traits with smaller |U .2,j |. By statistical theory, we know that a trait associated with the SNP is expected to have a larger |U .2,j | while a non-associated one has a smaller value. Hence, an increasing value of \u03b3 tends to put higher weights on those more strongly associated traits. An extreme situation is that, as \u03b3 \u2192 \u221e (as an even number), we have\ntaking only the largest one. In our experience, an SPU(\u03b3) test with \u03b3 N 8 often yields results similar to that of the SPU(\u221e) test. Hence, in all our following experiments, we only used \u03b3 \u2208 \u0393 = {1, 2, \u2026, 8, \u221e}. While the SPU(1) is similar to the Average (Sum) test, the SPU(2) test is the same as the SSU test outlined by Yang and Wang (2012) , an extension of the SSU test for single trait-multilocus analysis (Pan, 2009 ) to the current context for multiple traits and a single SNP.\nSuppose that the sample size is large enough for the asymptotic null distribution of the score vector to hold, we use a simulation method to estimate the p-value of an SPU test (Lin, 2005; Seaman and Mller-Myhsok, 2005) . Suppose that T is the test statistic for an SPU(\u03b3) test and\u03a3 :2 is the covariance matrix of the score vector based on the original data. We draw B samples of the score vector from its null distri- (|T (b) | N |T|)/B. Since the result of an SPU(\u03b3) test depends on the choice of the power parameter \u03b3 while in general it is unknown which value of \u03b3 is optimal for a given dataset, it would be convenient to have a test that dataadaptively and automatically chooses the parameter \u03b3. We propose an adaptive SPU (aSPU) test to estimate and thus select the most powerful SPU test for given data. Because it is difficult to characterize the power curve of an SPU test, we use the p-value of a SPU test to approximate its power; this idea has been widely used in practice. Accordingly, the aSPU test statistic is the minimum p-value among all SPU tests:\nwhere P SPU(\u03b3) is the p-value of the SPU(\u03b3) test. The p-value of aSPU can be obtained based on simulations. It may appear that a double simulation procedure is needed, but indeed not necessary. As before, first, we simulate B independent copies of the null score vector U (b) from N 0;\u03a3 :2 for b = 1, 2,\u2026B. We then calculate the corresponding SPU test statistics T SPU(\u03b3)\nand the final p-value of the aSPU test is P aSPU\nT aSPU )/B. Note that, in practice we can first use a smaller B, say B = 1000, to scan a genome, then gradually and repeatedly increase B for a few SNPs that pass an initial significance criterion (e.g. p-value b 5/B) in the previous step. The aSPU test aims to data-adaptively approximate the most powerful SPU test among a set of versatile SPU(\u03b3) tests with various values of \u03b3, thus maintaining high power at any given situation. Although we use the minimum p-value to approximate the most powerful SPU test, other combining methods (e.g. Pan et al., 2010) are also possible and may be explored. The aSPU test uses adaptive weights on the multiple traits to assess their aggregated effects (while down-weighting the effects of null traits).\nThe SPU and aSPU tests assume that the multiple traits are in the same scale; if not, e.g. when the variances of the traits vary a lot, one should first standardize the traits to have an equal sample variance. For example, when some null traits have larger variances than that of associated traits, an SPU test statistic will be dominated by the noises in the score components for the null traits, leading to concealing association signals and thus reduced power. Alternatively, to account for possibly different scales or variances of the multiple traits, one can use a variance-weighted SPU test (SPUw): for any \u03b3 \u2208 \u0393,\nNote that under the working independence model (R w = I) in GEE, the SPUw(\u221e) test is equal to the UminP test. The adaptive SPUw (aSPUw) test can be accordingly defined as for the aSPU test."}, {"section_title": "Properties of the GEE tests", "text": "We analyze how the proposed GEE-based tests are related to some existing tests in the absence of covariates while testing for association between a set of quantitative traits and a single SNP. By default (unless specified otherwise), we assume without loss of generality that both Y i and x i have been centered at 0; that is, \u2211 i = 0 n Y i = 0 and \u2211 i = 0 n x i = 0. For simplicity we also assume that there is no missing data, and each subject has all k traits observed.\nWe expect that most of our below conclusions can be extended to the case for quantitative traits with covariates Z i : we first regress Y i on Z i to obtain residuals r Y,i , and regress x i on Z i to obtain residuals r X,i ; then we apply the same arguments below to regression of r Y,i on r X,i (instead of regression of Y i on x i )."}, {"section_title": "Fitting a GEE working independence model and an equivalent model", "text": "In the current context, the GEE model is\nwith \u03b2 = (\u03b2 1 , \u2026, \u03b2 k )\u2032. Note that, due to centering both Y i and x i at mean 0, no intercept term is needed. To test H 0 : \u03b2 = 0, under the working independence model (i.e. R w = I), we have the score vector and its empirical covariance estimate as\nAs an alternative, we fit the below model:\nTo test H 0 : b = 0, we obtain its score vector and empirical covariance estimate, which are exactly the same as in Eq. (5).\nNote that, due to the possible correlations among the components of Y i and possibly non-Normality or non-constant variances of x i (the latter of which is true because x i is the genotype score), we have to use the empirical covariance estimate of the score vector. In summary, any test based on the score vector of fitting the GEE working independence model (4) can be equally constructed based on fitting a simple linear model (6). For example, a GEE-SPU(2) test based on the GEE model (4) is equivalent to the SSU test based on model (6) (Pan, 2009 ). We note that using the GEE score components and their variances to test for H m,0 : \u03b2 m = 0 separately for each trait m is the same as conducting a univariate Score test on each trait m individually. Hence, in addition to UminP, other methods could be applied to combine these univariate tests (Yang and Wang, 2012) ; in fact, if R w = I is used in GEE, all our proposed tests could be regarded in this way.\nFinally, we note that the above conclusion holds for other GLMs with a canonical link function, under which the score vector maintains the same form as in Eq. (5) (McCullagh and Nelder, 1983) ."}, {"section_title": "GEE-SPU versus GEE-SPUw tests", "text": "In the current context, based on Eq. (5), we have\nwhere the Hardy \u2212 Weinberg equilibrium is assumed in the second equality for Var(y ij ), f is the MAF of the SNP, and \u03c3 j 2 is the residual variance of trait j (after removing the effect of the SNP). We also assume that Var(y ij ) does not depend on i (but may depend on j). It is clear that the SPUw tests, but not SPU tests, are invariant to the scales of the traits. Hence, the SPUw and aSPUw tests can automatically account for different scales of the multiple traits, while the SPU and aSPU tests cannot, requiring one to standardize the (residual) variances of the traits if they differ a lot. On the other hand, if \u03c3 j 2 's are all equal, for an associated trait j with \u03b2 j \u2260 0, due to its larger Var(y ij ), any SPUw test would put a lower weight on it as compared to the corresponding SPU test, leading to power loss. However, for complex traits with typically small |\u03b2 j |, the power loss of the SPUw or aSPUw test is often negligible, resulting in almost equal power between the aSPUw and aSPU tests, as to be confirmed in our numerical examples."}, {"section_title": "Use of various working correlation structures in GEE", "text": "For quantitative traits, it is often reasonable to assume that the marginal covariance matrix Cov(Y i |H 0 ) = V 0 does not vary over i. Under this assumption (and thus a equal cluster size dim(Y i ) = k), we can write the working covariance matrix\nWith any working correlation matrix R w , the score vector and its covariance estimate are\nfrom which it can be seen that\nThat is, the GEE-Score test is invariant to R w , the working correlation structure.\nSince\nSurprisingly, as to be shown, the GEE-UminP, GEE-SPUw(\u221e) and GEE-SPU(\u221e) tests may lose power when the true correlation structure is used as R w . Here we consider a simple example. Suppose that the first 5 traits are associated with a SNP while all other remaining k \u2212 5 traits are not; the true covariance matrix Cov(Y i ) has a compound symmetry structure CS(r): Var(y ij ) = 1 and Cov(y ij , y il ) = r for any\nUnder the working independence model R w = I, assume that E(U j (I)) = 1 for 1 \u2264 j \u2264 k 1 , and E(U j (I)) = 0 for 5 b j \u2264 k. Hence, with R w = I, the component-wise signal magnitude (related to the non-centrality parameter for a univariate Score test on each trait) is\nwhich is 1 for 1 \u2264 j \u2264 5, and is 0 otherwise. On the other hand, in the ideal case with V w = Cov(Y i ), we have\nAccordingly, we can calculate its component-wise signal magnitude \u03bb j = E(U j (R w )) 2 /Var(U j (R w )). Table 1 shows some examples.\nIt is clear that, compared to using R w = I, one may gain or lose with respect to component-wise information contents in the score vector by using a correct correlation matrix as R w in GEE, depending on the value of between-trait correlation r and the number of traits k. In particular, with r N 0 and a small k, using a correct correlation matrix may give max j \u03bb j b 1, leading to loss of power by the UminP test, as compared to its using the working independence model in GEE; as k increases (while keeping the number of associated traits fixed), it will gain by using the correct correlation matrix as R w . This latter point is consistent "}, {"section_title": "Relationships between the new and existing tests", "text": "Our proposed tests cover several commonly used methods as special cases in the current context. A summary is given in Table 2 , and the details are relegated to the Appendix A."}, {"section_title": "Simulation Set-ups", "text": "Unless specified otherwise, by default each simulated dataset consisted of n = 1000 subjects with a varying number (k) of correlated quantitative traits, including the first k 1 = 5 traits associated with the SNPs to be tested under the alternative hypothesis H 1 (while all other k \u2212 k 1 traits were not associated). For each subject, we generated a block of p = 11 SNPs in linkage disequilibrium (LD) and the first one was the causal SNP under H 1 . Specifically, for each subject i, we first generated a latent vector G i = (G i1 , \u2026 G ip )\u2032 from a multivariate Normal distribution with a first-order auto-regressive (AR-1) covariance structure with parameter p = 0.5: Cov(G ij , G il ) = \u03c1 |j \u2212 l| . Second, each latent element G ij was dichotomized to 0 or 1 with probability Prob(G ig = 1) as its minor allele frequency (MAF), randomly drawn from a uniform distribution (Pan, 2009) . The MAF of the causal (i.e. first) SNP was from U(0.3, 0.4), while the MAFs of the other SNPs were independently drawn from U(0.1, 0.5). In this way, we generated a haplotype for subject i. Similarly, we independently generated another haplotype for subject i; by combining the two haplotypes we obtained the genotype of the subject. We tested on each of the first few SNPs nearest to the causal SNP.\nSimilarly, we also considered smaller sample sizes n = 500 and n = 200, and rare variants (RVs) with MAF = 0.01.\nThe phenotype for each subject i, Y i = (Y i1 , \u2026, Y ik )\u2032 was simulated from a linear model:\nx i is the genotype score of the causal SNP, and \u03f5 i was independently drawn form a multivariate Normal distribution N(0, \u03c3 2 R), with \u03c3 = 1 and R as either an AR-1 correlation matrix with parameter r or a compound symmetry (CS) matrix with parameter r; we considered r = \u00b10.3 or 0.5. In addition, we also considered using a correlation matrix estimated from the ADNI data. \u03b2 0m is the intercept for trait m. Under H 0 , we had \u03b2 = 0; under H 1 , we had \u03b2 m \u2260 0 for 1 \u2264 m \u2264 k 1 , and \u03b2 m = 0 for k 1 b m \u2264 k. The non-zero \u03b2 j 's were randomly drawn from a uniform distribution U(0.2, 0.3) for weak effects, or from U(0.8, 1) for strong effects. That is, under H 1 , only the first 5 traits were associated with the causal SNP, and we gradually increased the number of the non-associated (i.e. null) traits from 0 to 5, then 15, up to 35. Under each simulation set-up, 1000 datasets were independently generated and analyzed; we used B = 1000 to obtain p-values for any simulation-based method. Unless specified otherwise, by default, the working independence model was used in GEE. \nApplying the Score test on H 0 : \u03b1 1 = 0. Average = GEE-SPU(1). TATES (van der Sluis et al., 2013) Y ij = \u03b2 0,j + \u03b2 1,j x i + e ij for j = 1, 2,\u2026, k. Testing for H 0 : \u03b2 1,1 = \u2026 = \u03b2 1,k = 0 with analytical approximations to calculate a p-value.\nTATES \u2248 GEE-UminP \u2248 GEE-SPUw(\u221e). CCA = MANOVA (Ferreira and Purcell, 2009; Yang and Wang, 2012) CCA seeks to maximize the correlation between a linear combination of (Y i1 , \u2026, Y ik ) and x i . Test statistic:\nMDMR (Zapala and Schork, 2012 )\nKMR (Maity et al., 2012) Test statistic: Reilly et al., 2012) \u03c0 j (y) = Pr(x i = j|Y i = y), \u03ba j (y) = \u2211 m = 0 j \u03c0 m (y) for j = 0, 1, 2, log \u03ba j y \u00f0 \u00de 1\u2212\u03ba j y \u00f0 \u00de \u00bc \u03b1 j \u2212y 0 \u03b2 for j = 0 and 1. Applying the Score (or likelihood ratio) test on H 0 : \u03b2 = 0.\nMultiPhen \u2248 GEE-Score.\nGeneralized Kendall's tau (Zhang et al., 2010) \nGK-tau = GEE-Score."}, {"section_title": "Table 3", "text": "Empirical Type I error rates when the multiple traits were correlated with a CS structure with correlation coefficient r. An independence working correlation structure was used in GEE. For comparison, in addition to the GEE-based tests, we also applied some representative existing tests, including the Average method, MultiPhen, TATES, MANOVA (based on the Wilks statistic) and MDMR (based on the L 1 -norm or L 2 -norm as the distance metric)."}, {"section_title": "GEE", "text": "\nBetween an SPU(\u03b3) and SPUw(\u03b3) tests for a fixed \u03b3, the former one was more powerful (not shown). As analyzed in the Methods section, this was presumably due to the larger effect sizes of the associated traits, giving lower weights to associated SNPs in an SPUw(\u03b3) test than in an SPU(\u03b3). Accordingly, the aSPU test was also more powerful than the aSPUw test. Table 5 shows the results with weaker genetic effects. Now the GEE-Score and related MANOVA and MultiPhen tests were more powerful than the SPU/aSPU tests. Note the puzzling phenomenon: the former tests could have lower power with all k = 5 associated traits than that with some additional non-associated traits; this problem of MANOVA was pointed out by Ferreira and Purcell (2009) and studied by Cole et al. (1984) . In addition, due to the smaller effect sizes of the associated SNP, the SPU and SPUw tests, and thus aSPU and aSPUw tests, performed similarly (not shown).\n\nWhen the causal SNP had different effect directions on different traits, and/or when the correlations among the multiple traits were possibly negative, it was confirmed that the Average, SPU(1), SPUw(1) (and more generally, any SPU(\u03b3) or SPUw(\u03b3) test with \u03b3 as an odd number) would lose power; the better performance of the GEE-Score (and related tests) over that of aSPU, or vice versa, depended on the situations (not shown), as previously shown for the cases with a CS correlation structure.\n\n\n\n"}, {"section_title": "ADNI data", "text": "Data used in the preparation of this article were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). The ADNI was launched in 2003 by the National Institute on Aging (NIA), the National Institute of Biomedical Imaging and Bioengineering (NIBIB), the Food and Drug Administration (FDA), private pharmaceutical companies and non-profit organizations, as a $60 million, 5-year public-private partnership. The primary goal of ADNI has been to test whether serial magnetic resonance imaging (MRI), positron emission tomography (PET), other biological markers, and clinical and neuropsychological assessment can be combined to measure the progression of mild cognitive impairment (MCI) and early Alzheimer's disease (AD). Determination of sensitive and specific markers of very early AD progression is intended to aid researchers and clinicians to develop new treatments and monitor their effectiveness, as well as lessen the time and cost of clinical trials. The Principal Investigator of this initiative is Michael W. Weiner, MD, VA Medical Center and University of California -San Francisco. ADNI is the result of efforts of many coinvestigators from a broad range of academic institutions and private corporations, and subjects have been recruited from over 50 sites across the U.S. and Canada. The initial goal of ADNI was to recruit 800 subjects but ADNI has been followed by ADNI-GO and ADNI-2. To date these three protocols have recruited over 1500 adults, ages 55 to 90, to participate in the research, consisting of cognitively normal older individuals, people with early or late MCI, and people with early AD. The follow up duration of each group is specified in the protocols for ADNI-1, ADNI-2 and ADNI-GO. Subjects originally recruited for ADNI-1 and ADNI-GO had the option to be followed in ADNI-2. For up-to-date information, see www.adni-info.org.\nWe applied the methods to the ADNI cohort at baseline, which consisted of 680 non-Hispanic Caucasians with both genotype and phenotype data, including 192 healthy controls, 327 subjects with mild cognitive impairment and 161 patients with Alzheimer's disease. We would like to use a few structural MRI-derived multiple traits as intermediate phenotypes to assess their association with genetic variation. We downloaded from the ADNI website 56 cross-sectional FreeSurfer traits related to volumetric and cortical thickness measures at the baseline as processed by the UCSF team (Hartig et al., 2012) . For illustration, we only tested 20 SNPs shown by Shen et al. (2010) to be marginally significantly associated with one or more of the FreeSurfer traits. Here we considered only 7 multivariate traits consisting of a varying number of univariate traits as shown in Table 14 , which were singled out by Shen et al. (2010) to be more significantly associated with some of the 20 SNPs. The 7 multivariate traits included each of the six multivariate traits in Table 14 at the right side of the brain plus one of them (MeanPar) at the left side of the brain too. The covariates included were sex, handedness, brain volume, education (in years), and age. There were in total 680 subjects.\nWe first used B = 10,000 for any simulation-based method (i.e. GEE-UminP, GEE-SPU and GEE-aSPU tests) to calculate p-values. Then for those SNPs with p-value b 5/B, we gradually increased B to 10 5 , then to 10 6 , and finally up to 10 7 if needed. Other tests used asymptotics to calculate their p-values.\nWe present the heat maps of \u2212log 10 (p-values) of the new methods in Fig. 1 ; as a comparison, the results from four existing methods are shown in Fig. 2 . In agreement with our theoretical analysis and simulation study, it is confirmed that i) the GEE-Score test, MANOVA and MultiPhen, ii) the GEE-UminP test and TATES, and iii) the GEE-SPU(1) test and the Average method, yielded similar results. For this dataset, it turns out that the GEE-SPU(2), GEE-aSPU and GEE-aSPUw tests also gave p-values similar to each other, and to those of GEE-SPU(1). However, the three groups i)-iii) of the tests did give quite different results. Below, taking the GEE-Score, GEE-UminP and GEE-SPU(1) as a representative for each group, we show their identified marginally significant SNPs at p-values b 10 \u2212 6 and b 10 \u2212 5 respectively. i) The GEE-Score test identified an association between rs429358 (in gene ApoE; this SNP is also denoted as APOE in Figures 1-2) and RMeanPar (MeanPar at the right side of the brain) with a p-value of 8.45 \u00d7 10 \u22127 ; it also gave a p-value of 8.13 \u00d7 10 \u22126 for rs7526034 and RMeanLatTemp. ii) the GEE-UminP test detected rs7526034 marginally associated with RMeanLatTemp and RMeanTemp with p-values of 3.10 \u00d7 10 \u2212 6 and 7.90 \u00d7 10 \u22126 respectively; note that neither is significant at the level of p-value b 10 \u2212 6 . iii) the GEE-SPU(1) test identified rs7526034 to be associated with three traits, RMeanTemp, RMeanLatTemp and RMeanMedTemp, with p-values of 2.00 \u00d7 10 \u22127 , 6.00 \u00d7 10 \u22127 and 9.00 \u00d7 10 \u22127 respectively, in addition to a marginal association between rs12839763 and RMeanMedTemp with a p-value of 2.00 \u00d7 10 \u22126 . As a comparison, the GEE-aSPU test gave results similar to the GEE-SPU(1) test: for the above 4 associations indicated by the SPU(1) test, the aSPU test gave p-values of 6.00 \u00d7 10 \u22127 , 9.00 \u00d7 10 \u22127 , 1.80 \u00d7 10 \u22126 , and 4.20 \u00d7 10 \u2212 6 respectively; in addition, it also gave a p-value of 9.00 \u00d7 10 \u22126 to rs2075650 and LMeanPar. In summary, it appears that the three groups of the tests could identify different sets of (marginally) significant associations, though TATES and GEE-UminP did not identify any association with p-value b 10 \u22126 , illustrating a possible loss of power in taking out only most significant univariate associations.\nAs in the simulation study, the p-values obtained from the Average method and SPU(1) were very close. However, because the former was based on the asymptotic Wald test while the latter was a Score test based on simulations, their p-values might be slightly different. For example, for association between rs2075650 and LMeanPar, the Average method gave a p-value of 9.94 \u00d7 10 \u22126 , which was essentially the same as 1.10 \u00d7 10 \u22125 by the GEE-SPU(1) test. The similar results between the Average method (or SPU(1)) and SPU(2) or aSPU test were presumably due to the relatively small numbers of univariate traits consisting of the seven multivariate traits. To investigate the robustness of the tests to a larger number of traits, we pooled all seven multivariate traits together to form a combined trait; after removing duplicated ones, a total of 26 univariate traits remained. Since all the methods indicated marginal associations between the rs7526034 and/or rs429358 and several traits, we focused on the two SNPs. As shown in Table 15 , in agreement with earlier analyses of the seven individual multivariate traits, i) for SNP rs429358, the GEE-Score test and MultiPhen gave the most significant p-values; ii) for SNP rs7526034, the GEE-SPU(2) and aSPU tests yielded most significant results, followed by those given by TATES and GEE-UminP. However, the Average method and GEE-SPU(1) gave much less significant results, suggesting their non-robustness to a large number of non-associated traits as confirmed in the simulation study. In summary, it seems that the GEE-Score test (or equivalently MultiPhen) and the GEE-aSPU test could give complementary and useful results.\nTo demonstrate the feasibility of the new tests for GWAS, we conducted a genome-wide scan with a set of 31 FreeSurfer traits. Since the results did not offer additional new insights, to save space, we report the results in Supplementary materials."}, {"section_title": "Results", "text": ""}, {"section_title": "Simulations", "text": ""}, {"section_title": "CS", "text": "In Table 3 , the multivariate traits had a compound symmetry (CS) correlation structure with parameter r = 0.3 or 0.5. All the tests, except the GEE-Wald test, could control the Type I error. As the number of the traits, k, increased, the GEE-Wald test gradually had a severely inflated Type I error; in contrast, the GEE-Score test performed satisfactorily. Table 4 Empirical power when the multiple traits were correlated with a CS structure with correlation coefficient r; the first five traits were associated with a causal SNP with log-ORs \u03b2 j \u223c U(0.8, 1), while all others had \u03b2 j = 0. An independence working correlation structure was used in GEE. The poor performance of the Wald test and better performance of the Score test for finite-samples in GEE are well known (e.g. Guo et al., 2005) ; due to its inability to control Type I errors, we will omit the discussion on the GEE-Wald test in the sequel. Table 4 shows the power performance of the tests when the causal SNP had strong genetic effects on the associated 5 traits. Since the causal SNP and its nearest neighbor were strongly associated with (a subset of) the traits, the power of each test was close to 1 (not shown); hence, we tested on the second and third nearest SNPs next to the causal SNP. First, we can empirically verify our theoretical results derived earlier: i) the equivalence between MANOVA and the GEE-Score test, between MDMR(L2) and the GEE-SPU(2) test, and the Average and GEE-SPU(1) tests; ii) the similar performance between TATES and UminP (or SPUw(\u221e)), and between MultiPhen and the GEE-Score test. Since the traits had a multivariate Normal distribution, using the L 2 -norm as the distance was more powerful than using the L 1 -norm in MDMR; however, with other trait distributions, it is possible that the latter may edge over the former. Second, we note that the Average test, or equivalently the GEE-SPU(1) test, had the highest power when all k = k 1 = 5 traits were associated with the causal SNP (with similar effect sizes and the same effect direction); however, they quickly lost power as k increased, i.e. more non-associated traits were included. Third, as k increased, an SPU(\u03b3) test with a larger \u03b3 had higher power than those with smaller \u03b3. In particular, we highlight the case with k = 40: the power of the GEE-SPU(1) or GEE-SPU(2) test could be much lower than GEE-SPU(6) or SPU(\u221e); for example for SNP 2 and r = 0.3, the SPU(1), SPU(2) and SPU(6) tests had power as 0.084, 0.432 and 0.680 respectively. We also note that GEE-SPU(6) and SPU(\u221e) gave similar power, implying that using \u03b3 up to 6 or 8 (as done here) is good enough. Fourth, we see that, for any given situation, one of the SPU tests had high power, though its identity changed with the situation. Most importantly, the aSPU test seemed to be able to remain (nearly) most powerful across all situations. (See Table 4 .)"}, {"section_title": "AR-1", "text": "Now we consider the case where the multivariate traits had an AR-1 correlation structure. Table 6 shows that all the tests could control the Type I error rates around the nominal level of 0.05 satisfactorily.\nFor power (Table 7) , regardless of the value of r, we reached the same conclusions. First, it is clear that the aSPU test was more powerful than the MultiPhen, TATES, Score and UminP test. As more null traits were added, power of all methods generally decreased and the aSPU test still maintained its advantage. The power of MultiPhen was close Table 6 Empirical Type I error rates when the multiple traits were correlated with an AR1 structure with correlation coefficient r. An independence working correlation structure was used in GEE. Table 7 Empirical power when the multiple traits were correlated with an AR1 structure with correlation coefficient r; the non-zero \u03b2 j \u223c U (0.2, 0.3 ). An independence working correlation structure was used in GEE. It is confirmed that the SPU and SPUw tests, and thus aSPU and aSPUw tests, were always almost equally powered, presumably due to the small effect sizes here (not shown). Given that the majority of common SNPs that are associated with common diseases and other complex traits have only small effect sizes, we conclude that it is unlikely that the aSPU and aSPUw tests would perform much differently in practice; we recommend the use of the aSPU test (after standardizing the correlated traits to the same scale if needed)."}, {"section_title": "A more realistic correlation matrix", "text": "We also considered using a correlation matrix mimicking real data. Specifically, based on the ADNI data, we fitted a null model (with several covariates but no SNP) to a set of 26 neuroimaging traits and thus estimated their correlation matrix. These traits appeared to be strongly correlated with the first quartile, median and third quartile of pairwise correlations at 0.34, 0.47 and 0.59 respectively. We generated simulated data as before except fixing the number of the traits at 26 with their true correlation matrix as the one estimated from the ADNI data. As shown in Table 8 , under the null hypothesis, it is clear that the methods could control the Type I error rates satisfactorily (except the GEE Wald test, which was omitted). For power, we randomly picked up the first five traits to be associated with a causal SNP; we considered both strong and weak effects from the causal SNP. The conclusions were the same as before. For example, when the SNP-traits were strongly associated, the aSPU test was more powerful than the Score test. On the other hand, if the causal SNP was weakly associated with the five traits, given that the traits were strongly correlated as for the previous simulation case with a CS structure, the Score test appeared to be more powerful than the aSPU test."}, {"section_title": "Other cases with smaller sample sizes and association parameters", "text": "We considered whether the sample size would change our conclusions. We used a smaller sample size n = 500 or n = 200 while the multiple traits had a CS(0.3) correlation matrix. As shown in Table 9 , we reached the same conclusions. For example, the aSPU test was more powerful than the Score test in these cases.\nSo far we have always assumed that the association directions between a causal SNP and multiple traits are in the same direction. Next we considered the case where a subset of the traits were positively while another subset were negatively, and weakly associated with the causal SNP. We still used a CS(r) as the correlation matrix for the traits. As shown in Table 10 , as expected, the Average method and any SPU(\u03b3) test with \u03b3 being an odd number were always low powered. Between the Score and aSPU tests, if r = 0.3, then the Score test was more powerful; however, if r = \u2212 0.3, then the aSPU test was more powerful. Overall, either the Score test or the aSPU test was the winner. Table 8 Empirical Type I error rates (for \u03b2 = 0) and power (for \u03b2 \u2260 0) for 26 traits with the true correlation matrix estimated from the ADNI data; for \u03b2 \u2260 0, the first five traits were associated with a causal SNP with log-ORs \u03b2 j \u223c U(0.8, 1) or \u223cU(0.2, 0.3), while all others had \u03b2 j = 0. An independence working correlation structure was used in GEE. Table 9 Empirical power when the multiple traits were correlated with a CS(0.3) structure; the first five traits were associated with a causal SNP with log-ORs \u03b2 j~U (0.8,1), while all others had \u03b2 j = 0. An independence working correlation structure was used in GEE. "}, {"section_title": "Rare variants", "text": "As suggested by a reviewer, we considered rare variants with MAF fixed at 0.01 when simulating genotypes, while all other aspects were the same as before. To be consistent with our focus here on single SNP testing, we tested on each RV separately, though testing on multiple RVs was expected to be more powerful. As shown in Table 11 , the results were pretty much the same as those for common variants when the causal SNP was strongly associated with five traits. For example, it was confirmed again that the results between the Average and GEE-SPU(1), between TATES and GEE-UminP, and among MultiPhen, MANOVA and GEE-Score tests were almost the same respectively. More importantly, the aSPU test was much more powerful than the previous tests, especially as the number of non-associated traits increased."}, {"section_title": "Using other working correlation structures in GEE", "text": "It is confirmed that using a non-diagonal correlation structure in GEE may or may not improve the performance of the GEE-based tests. For example, when the true CS correlation structure was used as the working one, the performance of the SPU and aSPU tests improved (Table 12) ; on the other hand, if R w = CS was used for the case with an AR-1 as the true correlation structure, the power of the SPU and aSPU tests could be lower than that of using R w = I (Table 12 ). On the other hand, in the current context, as shown in the Methods section, the GEE-Score is invariant to the use of R w . We also note that the UminP and SPU(\u221e) (and SPUw(\u221e)) tests could have a severe loss of power with the use of a non-diagonal working correlation structure, even if the working correlation structure was the same as the true CS structure, as analyzed in the Methods section."}, {"section_title": "Combining the GEE Score and aSPU tests", "text": "It has been shown that, depending on the correlation structure for multiple traits and association parameters between SNPs and traits, one of the GEE Score test and aSPU test was better than the other, but neither could dominate the other across all situations. In light of this result and that in practice it is unknown which test would be more powerful, it might be productive to combine the two tests. A simple strategy is to take the minimum p-value of the two tests, yielding an aSPU.Sco test with test statistic\nwhere P Sco is the p-value of the Score test (and P SPU(\u03b3) is the p-value of the SPU(\u03b3) test). To calculate the p-value of the aSPU.Sco test, we do not need another level of resampling; we simply include the Score test along with the SPU tests in the simulation algorithm discussed earlier for the aSPU test. Table 13 shows the results for the multiple traits with a CS(0.3) correlation matrix. First, it is clear that the new test could maintain a satisfactory Type I error rate. Second, the performance of the new test was always between the other two tests, often closer to the winner. For example, in the case of a causal SNP weakly associated with 5 traits: i) when testing on the five associated traits, the Score test was less power than the aSPU test with their power as 0.464 and 0.632 respectively, while the power of the new test was 0.612, very close to the aSPU test; ii) on the other hand, when testing on 10 traits, the power of the Score test was 0.569, larger than 0.456 of the aSPU test, and the new test achieved the power of 0.537, again close to the winner. Table 10 Empirical power when the multiple traits were correlated with a CS(r) structure; the first five traits were associated with a causal SNP with log-ORs \u03b2 j \u223c \u2212 (\u22121) j U(0.2, 0.3), while all others had \u03b2 j = 0. An independence working correlation structure was used in GEE. Table 11 Empirical Type I error rates (for \u03b2 = 0) and power (for \u03b2 \u2260 0) when the multiple traits were correlated with a CS(0.3) structure; for \u03b2 \u2260 0, the first five traits were associated with a causal RV with log-ORs \u03b2 j \u223c U(7.5, 8), while all others had \u03b2 j = 0. All the RVs had MAF = 0.01. An independence working correlation structure was used in GEE. "}, {"section_title": "Discussion", "text": "In this paper we have developed a class of the so-called SPU tests for association analysis of multiple (correlated) traits and a single SNP. We have also proposed an adaptive test called the aSPU test to estimate and thus select the most powerful SPU test for a given dataset. For multivariate trait-single SNP analysis, based on a marginal regression model in GEE that allows the SNP to have different effect sizes and effect directions on different traits, the aSPU test can adapt to the existence and the number of the null (non-associated) traits effectively. With a larger power parameter \u03b3, the SPU(\u03b3) test reduces the influence of null traits and reinforces the associated ones. Thus this test can maintain high power in the presence of a large number of null traits. This property is especially useful for studies where many correlated phenotypes are collected but there are no established guidelines to selecting relevant phenotypes. On the other hand, in the presence of many associated traits, the SPU(\u03b3) test with a smaller \u03b3 will be more powerful. In particular, SPU(1) is quite similar to the Average (or Sum) method as used in Shen et al. (2010) , while SPU(2) is an extension of the SSU test for single trait-multilocus association analysis to multivariate trait-single locus analysis. As noted, under suitable conditions the SPU(2) test is the same as MDMR or KMR. We have also pointed out how some existing methods, like CCA/MANOVA, TATES and MultiPhen are related to the various GEE-based tests. We emphasize that, many of the existing methods, such as CCA/MANOVA and MultiPhen, may not be applicable to discrete traits or multiple loci, while our proposed GEE-Score and GEE-aSPU tests can with their general modeling and inference framework of GEE. Our proposed tests are potentially useful for a large number of traits, as arising as intermediate phenotypes in neuroimaging studies, which has not been adequately considered in the genetics literature. We also note that our proposed GEE-aSPU test can be equally applied to multiple principal components after PCA or PCH dimension reduction on a large number of traits, though further studies are needed.\nFrom simulation studies we observed that the relative performance of the GEE-based Score and aSPU tests varied with the degree of the correlations among the traits and with the effect sizes of the causal SNPs. When the traits were somewhat more weakly correlated (e.g. with an AR-1 correlation structure), regardless of the effects size of the causal SNP, the aSPU test was much more powerful than the Score test and UminP test. However, under some situations, e.g. when the traits had a compound symmetry correlation structure, the aSPU test might not be as powerful as the Score test when the effect sizes were small; the opposite conclusion held with larger effect sizes. We note that, the aSPU test largely combines the strengths of the SPU(1) (equivalently the Average method), SPU(2) (closely related to MDMR and KMR), and SPU(\u221e) (similar to UminP and TATES), but differing from the Score test and MultiPhen while the latter two (and CCA/MANOVA) perform similarly. Since currently we do not have a simple guideline on how to choose between the aSPU and Score tests in practice, we recommend the use of both; we have also explored combining the two tests with some promising preliminary results (see Table 13 ), though more studies are needed.\nWe have focused on multitrait association testing on a single SNP. A natural extension is to multitrait-multiple SNP testing. For univariate trait analysis, it has been established that testing on multiple SNPs simultaneously may gain power (Pan, 2009) , especially for RVs as evidenced by the increasing use of the burden tests and variance component tests (Basu and Pan, 2011) . Pan et al. (2014) have proposed and studied an analogous aSPU test for RVs, which data-adaptively over-weights (unknown and estimated) associated RVs (while downweighting non-associated RVs). In contrast, here our proposed aSPU test adaptively over-weights (unknown and estimated) associated traits (while down-weighting non-associated traits). It would be interesting to see whether combining the two ideas would work for multitrait-multiple SNP association testing, especially in the presence of large numbers of traits and of SNPs. An advantage of the aSPU test is its weighting on, rather than directly selecting, traits (or SNPs), in order to alleviate the effects of non-associated traits (or SNPs) on diminishing the power of a test, expected to be present with many traits (or SNPs); given small effect sizes of common variants (or small MAFs of RVs), weighting tends to outperform selection.\nIt seems to be a common belief that accounting for correlations among multiple traits would automatically increase power, which however may not be true, or at least not as simple as it may sound. Here are our arguments. First, using a non-independence working correlation matrix R w \u2260 I in GEE can be regarded as an attempt to account for correlations among multiple traits; however, as shown in Tables 1 and 12, in these situations a test may or may not have improved power. In particular, the GEE Score test is invariant to the use of the working correlation matrix (with an equal cluster size). Second, as directly shown numerically here (e.g. Table 9 ), the GEE-SPU(2) test could be more powerful than the GEE Score test, though the SPU(2) test statistic ignores the correlations among the components of the score vector (due to the correlations among the traits) while the Score test statistic does not. The same phenomenon is also observed in single trait-multiple SNP analysis Table 14 Multivariate traits. A letter \"L\" or \"R\" is to be added to each trait's ID to indicate the left or right side of the brain. Mean thickness of inferior temporal, middle temporal, superior temporal, fusiform, parahippocampal and lingual gyri, temporal pole and transverse temporal pole (Pan, 2009) , in which the SSU test (or equivalently KMR) is known to be often, but not always, more powerful than the Score test. Pan (2009) offers an explanation based on a test's rejection region, which however is hard to visualize for high-dimensional testing while the power also depends on some unknown association parameters. Certainly this is a topic worth further investigation. Finally, we have not compared our methods with those based on constructing latent composite traits such as PCA and PCH; a particularly a) MANOVA interesting topic is to investigate how our proposed tests compare with the modified PCH method of Lin et al. (2012) for high-dimensional neuroimaging traits.\nwhere 1 is an n \u00d7 1 vector of all 1's, \u03bc is a 1 \u00d7 p vector of unknown intercepts, B is a 1 \u00d7 p vector of unknown regression coefficients, and \u03f5 is an n \u00d7 p matrix of random errors. Following the same argument in Pan (2011) , it can be shown that\nwhich is the same as the GEE-SPU(2) test statistic for the multivariate linear model (9) under the working independence model. In particular, if the Euclidean distance (i.e. L 2 -norm) is used as the distance metric d(,), we have Z = Y; thus, MDMR(L 2 ), the MDMR implementation with the Euclidean distance, is the same as the GEE-SPU(2) test. Importantly, as to be shown, GEE-SPU(2) loses power in the presence of many null traits, so does MDMR. Furthermore, MANOVA is based on the same model (9) with Z = Y; however, the (approximate) F statistics in MANOVA are different from Eq. (8). For example, the Wilks statistic is based on\nwith |B| as the determinant of B. For this reason, MANOVA and MDMR(L 2 ) will not be the same."}]
[{"section_title": "Abstract", "text": "To probe individual variations in brain organization, population imaging relates features of brain images to rich descriptions of the subjects such as genetic information or behavioral and clinical assessments. Capturing common trends across these measurements is important: they jointly characterize the disease status of patient groups. In particular, mapping imaging features to behavioral scores with predictive models opens the way toward more precise diagnosis. Here we propose to jointly predict all the dimensions (behavioral scores) that make up the individual profiles, using so-called multi-output models. This approach often boosts prediction accuracy by capturing latent shared information across scores. We demonstrate the efficiency of multi-output models on two independent resting-state fMRI datasets targeting different brain disorders (Alzheimer's Disease and schizophrenia). Furthermore, the model with joint prediction generalizes much better to a new cohort: a model learned on one study is more accurately transferred to an independent one. Finally, we show how multi-output models can easily be extended to multi-modal settings, combining heterogeneous data sources for a better overall accuracy."}, {"section_title": "Introduction", "text": "Between-subject variability, be it in image-based brain features, psychological tests or clinical assessments, is a window into human neurosciences. Relating behavioral assessments to brain images helps grounding inter-individual vari-5 ability in anatomical and functional aspects of brain organization (Dubois and Adolphs, 2016; Abi-Dargham and Horga, 2016) . The corresponding imaging-based biomarkers can then serve as intermediate phenotypes, or neurophenotypes to characterize the subjects (Drysdale et al., 2016) . In this context, 10 recent years have witnessed the emergence of large-scale neuroimaging studies with rich assessments of subjects' traits and multiple brain-imaging modalities. Such studies aim at characterizing healthy subjects, such as the Human Connectome Project (Van Essen et al., 2013) , investigating brain genetics, 15 e.g. Enigma (Thompson et al., 2014) , or the impact of ageing, e.g. LIFE (Loeffler et al., 2015) or AIBL (Ellis et al., 2009) . They also investigate neurological pathologies as Alzheimer's Disease in ADNI (Jack et al., 2008) , psychiatric disorders, as autism in ABIDE (Di Martino et al., 2014) , or prospective epi-20 demiology, as with UK biobank (Elliott et al., 2008) .\nBehavioral or clinical scores bring a rich description of the individuals involved in these studies. Importantly, they go beyond a diagnosis system for psychiatric patients (Insel and Cuthbert, 2015; Hyman, 2007) , that can be overly strict and 25 sometimes subjective. Indeed, the neuropathophysiology is often continuous, and many mental disorders are spectrum, understood as dimensional phenotypes rather than healthy-versussick categories. They may encompass several clinical subtypes of diseases that are only captured in detailed neuro-cognitive 30 descriptions of the individuals (Fereshtehnejad et al., 2015; Insel et al., 2010) . Importantly, while each behavioral variable gives a limited and noisy information, considering them jointly brings a more complete clinical picture, as diagnosis is usually based on combinations of these behavioral assessments."}, {"section_title": "35", "text": "Predictive models can extract neurophenotypes by mapping brain imaging data to individual traits. The corresponding imaging features typically predict either each cognitive assessment in isolation or a composite score that reflects these assessments. As a result, they are highly sensitive to the reliability of 40 the score used, and probably under-exploit the rich clinical picture provided by the different assessments. To overcome these shortcomings, some studies use canonical correlation analysis (CCA) to relate multivariate imaging measurements to multiple scores: e.g. they capture co-variations between brain functional 45 connectivity and a set of lifestyle, demographic, and clinical questionnaires, that are then mixed into one compound variable (Smith et al., 2015) . On UK biobank's 5000-subjects cohort, Miller et al. (2016) found 9 basic modes of signal variation bridging brain images and traits, that mix information of very 50 different nature. CCA relates multiple blocks of data (imaging features on one hand, behavioral scores on the other hand) through a latent factor model. However, it is by construction a global predictor on a combination of clinical score and does not aim at predicting well each individual score."}, {"section_title": "55", "text": "Here we are interested in good prediction of each score from neuroimaging features, at the single-subject level. We show that jointly learning multiple scores from multiple sources indeed gives better descriptions of subjects and mitigates the noise inherent to cognitive assessments. For this purpose, we use multi-60 output (a.k.a. multi-task) learning models (Caruana, 1997; Argyriou et al., 2008; Bzdok et al., 2015) to predict jointly clinical scores (outputs) from neuroimaging data (sources)."}, {"section_title": "1", "text": "For population-imaging studies, resting-state functional MRI (rs-fMRI) is an interesting modality: it probes brain activity, and is a promising source of functional connectivity biomarkers. It is also easy to acquire and to compare across subjects, including on diminished subjects. Brain connectivity at rest is well suited to study pathologies (Greicius, 2008) as it is suitable for diminished patients and is impacted by neurodegenera-70 tive (Wang et al., 2006) , or neuropsychiatric disorders (Craddock et al., 2009; Castellanos et al., 2013; Abraham et al., 2016) . However, predicting clinical status of psychiatric or neurological patients from these data is challenging due to the low signal-to-noise ratio of the blood-oxygen-level dependent"}, {"section_title": "75", "text": "(BOLD) signal observed at rest.\nIn this paper, we show that fitting a richer clinical assessment of subjects based on multiple sources enhances rs-fMRI sensitivity and captures better neurophenotypes. The ensuing model exploits the correlation between multiple scores measuring sub-80 ject health or behavioral outcomes, and combines information accumulated from several functional-connectivity maps. Technically, this approach combines multiple sources -connectivity maps or imaging modalities-for the joint prediction of multiple outputs -i.e. clinical scores. It is thus a multi-modal and 85 multi-output model. We show that this approach improves the prediction of each output compared to single-output models and low-rank models like CCA. We provide an extensive validation on three different open datasets that characterize neurodegenerative (Alzheimer's Disease) and psychiatric disorders 90 (schizophrenia). Going one step further, we evaluate this approach across datasets: predictive models -neurophenotypesare learned on a cohort, but applied on another one with the same clinical scores and imaging modality (rs-fMRI). Our results show that modeling jointly multiple scores increases ac-95 curacy in the context of cross-cohort heterogeneity. Finally, we extend this framework by stacking heterogeneous sources -imaging, non-imaging-in multi-output models, and show the benefits of stacking compared to other multi-source combination strategies, such as multiple kernel learning or feature con-100 catenation."}, {"section_title": "Materials and methods", "text": ""}, {"section_title": "Related works", "text": "In predictive settings, multi-task learning methods (Caruana, 1997; Argyriou et al., 2008) have been successfully applied to 105 predict multi-output health outcomes from neuroimaging features. Notably, they have been used to fit individual memory performance scores (Wang et al., 2011) , or to learn disease subcategories (Wang et al., 2015) and progression , or to predict a task from fMRI contrast maps of multi-110 ple subjects (Marquand et al., 2014) , or to handle missing data (Yuan et al., 2012) .\nNeuroimaging studies often use low-rank multi-output models like CCA (Hotelling, 1936) and partial least squares (PLS) (Krishnan et al., 2011) to link imaging based features to other 115 blocks of data: to cross-predict fMRI and EEG (Deligianni et al., 2014) , to explain genetic outcomes (Floch et al., 2012) , behavioral and clinical scores (Monteiro et al., 2016; Miller et al., 2016; Smith et al., 2015) , or a different imaging modality (Avants et al., 2010; Sui et al., 2012) . Reduced rank regression 120 (Vounou et al., 2010; Izenman, 1975 ) is a related multi-output linear-regression. Unlike CCA, it does not discard explained variance during model fitting.\nOur goal is to predict several outputs from many -possibly heterogeneous -sources (multi-output and multi-source). 125 Zhang et al. (2012) have tackled multiple source/output prediction as joint feature selection with a multi-task / multi-modal model. More in detail, they use multi-output models to perform a feature selection across scores on each modality. Each score is then predicted separately by combining multiple sources with 130 a multiple kernel learning method (MKL) (Castro et al., 2014; Hinrichs et al., 2011) . It is not a fully multi-output model since clinical scores are not learned jointly when combining different sources.\nThe model that we propose is designed similarly as in Zhang 135 et al. (2012) but is completely multi-output, as it learns to jointly predict multiple scores from each source. Instead of using MKL to combine all sources, we use a versatile prediction stacking model as in Liem et al. (2016) ; Rahim et al. (2016) . It combines predictions from multiple sources in another multi-140 output learning scheme."}, {"section_title": "Overview of the methodological framework", "text": "Multi-output prediction from multiple sources. We want to improve the prediction of health outcomes from multiple connectivity sources computed from rs-fMRI. Figure 1 depicts the 145 workflow of the proposed model. It is a multi-output learning model built with a two-layer architecture. The first step performs a supervised dimension reduction with a multi-output classification or regression on each source separately. This yields a multi-output model for each source. Then, predictions 150 corresponding to all sources are stacked score-wise: each score is associated with the first level prediction, which forms a subjects \u00d7 sources matrix. The second level learns a non-linear combination of all these predictions in a common multi-output model, and returns the final prediction of the clinical scores, 155 based on all data sources.\nSeed-based connectivity maps. In our rs-fMRI experiments, sources are seed-based connectivity maps associated with different regions of interests (ROIs) from a brain atlas. A seedbased connectivity map is composed of correlations between 160 time-series of a given seed ROI and voxels of the whole brain. To avoid relying on a single ROI, we use a set of ROIs extracted from a brain atlas A. Each subject is represented by the resulting set of connectivity maps from which the predictive model is built."}, {"section_title": "165", "text": "Figure 1: Overview of the proposed method. Each subject from a population is characterized by imaging data (e.g rsfMRI) and clinical/behavioral data (e.g. phenotypes, scores). First, time-series are extracted from rs-fMRI. They are used to compute connectivity maps between ROIs and all brain voxels. Then, multi-output models are learned jointly across scores, yielding one multi-output model per source (in the present case, per ROI). Predictions from all sources are stacked score-wise (each score has a subjects \u00d7 sources matrix). Finally, a multioutput random forest model selects the relevant sources (ROIs) that predict all clinical scores."}, {"section_title": "Time-series extraction", "text": ""}, {"section_title": "Feature extraction", "text": ""}, {"section_title": "Multi-output random forests", "text": "Multi-output learning Table 1 summarizes the notations that we use in the description of the model. The principle of the proposed model is to first learn for each feature set (source X i ) to predict jointly multiple clinical scores (outputs Y). Then, a decision is learned to 170 determine the final prediction of the clinical scores by combining all available predictions (S). These two steps are performed as follows:"}, {"section_title": "Connectivity maps", "text": ""}, {"section_title": "Stacked multi-output model", "text": "1) Sparse multi-output model for each input. Such models are well suited for high-dimensional connectivity features (around 175 10 5 brain voxels). They assume that the relevant information is located in a limited number of features, hence they reduce the dimension to a subset of non-zero coefficients. Linear models estimate a linear combination of voxel features, yielding a coefficient vector for each source. An important benefit of 180 such models is that the coefficient vector can be interpreted as the discriminative map for the connectivity-based classification/regression.\nWe use a multi-task elastic-net regression (Argyriou et al., 2008) . It can enforce more or less sparsity for a given amount of regularization. The multi-task specificity is that the sparsity is common to the coefficients for the different outputs. For the i th source with a input matrix X i \u2208 R N\u00d7V and a output matrix Y \u2208 R N\u00d7T (for N subjects, V features, and T clinical scores), the coefficient matrix W i is estimated as:\nwhere \u03b1 > 0 controls the overall regularization parameter and \u03bb \u2208 [0, 1] the sparsity of the estimate. W 2,1 is the 2,1 mixed 185 norm of W (Kowalski, 2009) which is the key ingredient of group sparsity as in the group lasso (Yuan and Lin, 2006) . The estimated weights related to the i th source form a matrix W i = w i,1 , w i,2 , ..., w i,T , where each vector w i, j represents the predictive coefficients for the j th output. The 2,1 sparsity prior N number of subjects of the dataset."}, {"section_title": "190", "text": "V number of voxels of the entire brain."}, {"section_title": "T number of outputs (clinical scores).", "text": "R number of sources.\nX i Connectivity maps (sources) of all subjects according to the i th ROI, its dimension is N \u00d7 V. promotes zero weights jointly across the coefficients related to the various outputs. In other words, coefficients of the different vectors w i,\u00b7 are zero when they are not relevant across all outputs.\n2) Multi-output predictions stacking. First step predictions across different sources are often complementary and combining them efficiently increases prediction accuracy. Rather than averaging them or performing a majority voting, we propose to use another predictive model to optimally combine different per-source predictions. First, we define a multi-output prediction matrix according to a source i as the unthresholded predictions outputs X i W i from (1). Then, all sources are stacked score-wise yielding a 3D tensor S of dimension T \u00d7 N \u00d7 R. For the j th clinical score, the stacked matrix S j \u2208 R N\u00d7R is:\nWe use random forests (RF) to learn a mapping from stacked sources to multiple outputs. Such models make decisions by combining non-linearly a small number of sources and yield an importance index to quantify the contribution of each source to the final prediction. Regression random forests (Breiman, 2001) are an ensemble of regression trees, where a tree provides regression values (clinical scores) from input data (predictions according to multiple sources). Here we need a multioutput predictor since we have multiple inputs (stacked predictions S j ) associated with multiple outputs (clinical scores y j ): [S 1 , ..., S j , ..., S T ], [y 1 , ..., y j , ..., y T ] . For this, decision trees are constructed by finding nodes that split data according to a feature value minimizing an impurity criterion \u0393. In multioutput random forests, the impurity criterion is the sum of the impurities of each output:\nThe impurity criterion \u0393 j specific to the j th output is the squared error between outputs when choosing a split on a node:\nwhere the mean of Y j is taken on the samples selected accord-"}, {"section_title": "195", "text": "ing to some optimal split at a given node in S j . The difference with respect to classical random forests is that we determine jointly the splits across all outputs by taking the sum of all the impurities \u0393 j as the global impurity criterion (Segal and Xiao, 2011), as depicted in "}, {"section_title": "Stacked matrices", "text": ""}, {"section_title": "Impurity criterion", "text": "Figure 2: Multi-output random forests principle. Inputs are stacked predictions for each clinical score j. Nodes (subsets from stacking matrices S) are divided according to an impurity criterion over all outputs to be predicted."}, {"section_title": "Experiments: learning multiple neuropsychiatric profiles from resting-state data", "text": "We now demonstrate empirically that jointly fitting multiple clinical, neurological, and neuropsychiatric scores yields better 210 predictions than separate predictions. For this, we perform several experiments over three publicly available datasets with rsfMRI that study different clinical questions, namely schizophrenia, post-traumatic stress disorders and Alzheimer's Disease. (72) MCI (154) 3.1. Datasets 215 Table 2 summarizes the datasets used in our experiments. Table 3 lists clinical scores' acronyms. Details on Alzheimer's Disease and schizophrenia related scores can be found respectively in Petersen et al. (2010) and Calhoun et al. (2012) .\n-COBRE. The COBRE dataset characterizes the brain in 220 schizophrenia based on rs-fMRI. It is provided from the Center for Biomedical Research Excellence (cobre.mrn.org). It comprises anatomical and functional MRI data from 72 patients with schizophrenia and 75 healthy controls. Diagnostic information and clinical scores were collected using the Structured 225 Clinical Interview used for DSM Disorders (SCID).\n-ADNI. The Alzheimer's Disease Neuroimaging Initiative (www.adni-info.org) database is a multi-modal study of brain aging and neuro-degenerative diseases. Our goal is to study conversion of MCI subjects to AD. We consider a 230 proxy by estimating binary classification models to discriminate AD against MCI subjects. We use 211 subjects with one to five fMRI scans, resulting in a total of 694 fMRI scans. We also include hippocampus features extracted from anatomical MRI and biomarker measurements extracted from cere-235 brospinal fluid (CSF).\n-ADNIDOD. The US Department of Defense (DoD) Study of Brain Aging in Vietnam War Veterans (www.adni-info. org/DOD.html) gathers imaging and non-imaging measures from persons who had post-traumatic stress disorders and / or 240 traumatic brain injuries. The study investigates potential links between brain trauma and neuro-degenerative diseases. AD-NIDOD uses the same fMRI acquisition protocol (same scanner type) and the same clinical and cognitive examination protocols as ADNI. We use rs-fMRI scans at baseline from 127 subjects, 245 and 5 clinical scores common with ADNI. We use this dataset to validate predictive models learned on ADNI, but not to learn new ones."}, {"section_title": "Data preprocessing", "text": "For all datasets, we apply standard fMRI preprocessing: dis-250 carding first 3 frames from each scan, motion correction, fMRI coregistration to T1-MRI, normalization to MNI template using SPM12, (www.fil.ion.ucl.ac.uk/spm/), followed by spatial smoothing (6mm FWHM). Temporal preprocessing includes linear detrending and band filtering (0.01\u22120.1Hz). Then a matrix of confounds is built for each subject. It contains age, white matter, 12 motion components -6 motion parameters and their first order derivatives -and 6 noise components from CompCor (Behzadi et al., 2007) . Confounds are removed by subtracting the time-series projected into an orthonormal basis 260 of the confounds, using Nilearn v0.2.6 (Abraham et al., 2014) . All rs-fMRI scans are quality-checked. In addition to the visual inspection, we apply some simple rules: Scans are excluded when motion is higher than 2mm or when global signal variation is higher than 5%. Excluded subjects in ADNI and COBRE 265 are listed in the supplementary material.\nAnatomical MRI and CSF features are collected from processed and quality-checked data uploaded from ADNI database. For the CSF, three biomarkers measurements (A\u03b2 1-42 , t-tau, p-tau 181 ) are extracted from an analysis done at the Uni-270 versity of Pennsylvania (Shaw et al., 2011) . Based on anatomical MRI, we select sixteen volumetric features of segmented hippocampus extracted with FreeSurfer software (Dale et al., 1999) at the university of California in San Francisco. Beside the diagnosis -Alzheimer's Disease (AD), Mild Cognitive Im-275 pairment (MCI), schizophrenia, or controls-we predict Neuropsychiatric outputs form of continuous scores. We apply a Box-Cox transformation on continuous clinical scores. It yields a distribution of the outputs with more Gaussian-like characteristics and more stable variances. The optimal transformation 280 parameters are estimated such that they maximize the profile log-likelihood function (Box and Cox, 1964) ."}, {"section_title": "Experimental settings", "text": "We present three experiments studying the proposed multioutput framework on rs-fMRI: in a single dataset, across 285 datasets, and in a multi-modal setting. They assess:\n(i) The multi-output approach compared to single-output on a single cohort. This experiment is carried on COBRE, to predict schizophrenia, and on ADNI, to predict AD profiles. Models are evaluated with a cross-validation procedure as recom-290 mended in Varoquaux et al. (2016) : The data are split into stratified train/test sets at the subject level, to avoid fitting and testing on data from the same subject. Splits are randomized over 100 runs. Test sets represent 25% of the whole dataset. Singleoutput prediction relies on stacking elastic-net predictions from 295 each source by a single-output random-forest.\n(ii) The multi-output approach across datasets. This is done with a cross-dataset learning (train on ADNI, test on AD-NIDOD); in the cross cohort validation, the randomized splits are done over 90% of each dataset, as depicted in Figure 3 ."}, {"section_title": "(iii) Stacking compared to other source combination strategies.", "text": "We show the benefits of using prediction stacking for classification by comparing it to classical model aggregation strategies such as majority voting or prediction averaging.\n(iv) Stacked model versus other multi-output analysis ap-305 proaches. This experiment explores whether using the proposed stacked multi-output model is more accurate than other existing multi-output methods to predict clinical scores. For this, we compare the stacked multi-output model to CCA and reduced rank regression (RRR) to predict clinical scores. CCA 310 finds linear combinations to optimize correlations between X and Y. RRR is a multi-output linear regression that imposes a low-rank constraint on the coefficient matrix (Izenman, 1975) . This model seeks common latent factors across the different outputs to improve regression accuracy. CCA is not a direct pre-315 dictive model, but predictions of Y can be derived from learned components. They can be used then on test samples in order to measure the fidelity of the CCA on unseen data. We assess the prediction capacity of low-rank linear models compared to our stacked multi-output model. We use the concatenated connec-320 tivity maps as features for the CCA and RRR. The number of components of CCA and RRR is set to 2 by applying a nested cross-validation. Accuracies of these two models are compared to the stacked multi-output model by shuffling train and test splits over 100 runs."}, {"section_title": "325", "text": "(iv) Stacked multi-output model for multi-modality fusion. In this experiment, AD is characterized from heterogeneous modalities (anatomical, functional, biofluid) in ADNI. For combining the modalities, we compare our multi-output approachbased on prediction stacking-to other schemes: simple feature 330 concatenation or multiple kernel learning. -Assessing classification performance. We assess classification performance with the area under the receiver operating characteristic curve (AUC). It quantifies the sensitivity (true positive rates) and the specificity (false positive rates)."}, {"section_title": "335", "text": "-Assessing regression performance. We measure accuracy of clinical score regressions on each test fold with the crossvalidated determination coefficient 2 :\nwhere y k , y k , y test are respectively the true score, the predicted score, and the mean score on the test fold.\nIn all experiments, elastic-net hyper-parameters (\u03b1, \u03bb) are set by a nested 4-fold cross-validation. They are estimated inside each training set for each source. For the multi-output random 340 forest, we set the number of trees and the maximum depth of a tree to commonly-used values, 50 and 10 respectively.\nThe significance of the value of \u2206 cv for each model and each score is assessed by permutation tests with 10, 000 permutations. Single and multi-output models are compared in each 345 experiment through their respective \u2206 cv on the same folds. Finally, experiments are implemented in Python using ScikitLearn v0.17 (Pedregosa et al., 2011) ."}, {"section_title": "Results: performance factors in multi-output learning", "text": ""}, {"section_title": "Multi-output learning predicts better each score", "text": ""}, {"section_title": "350", "text": "We compare multi-output and single-output approaches for the prediction of clinical scores on COBRE and ADNI.\n2 Many studies use Pearson's correlation to evaluate regression accuracy. Correlations measure the linear accordance between true and predicted values, but they discard scaling and offsets. Using \u2206 cv brings a better assessment of regression quality -as compared to a mean-constant model. Also called r-squared metric, it is a relative distance that can be used to compare different models. Unlike correlations, it is sensitive to absolute differences between the prediction values and the true values, which is essential in the perspective of individualized predictions. -Predicting schizophrenia characteristics. Figure 4 compares accuracies of multi-output and single-output models on the COBRE dataset. The ROC curves (Figure 4a) show that, 355 compared to the single-output model, the stacked multi-output model has higher sensitivity to predict schizophrenia and also higher specificity against false positives. Additionally, the AUC has less variance over randomized folds for the stacked multi-output model. A gain of .1 in AUC, or 15% sensitivity at 50% specificity is substantial. Learning the diagnosis jointly with related quantitative clinical scores yields more accurate and more stable prediction of schizophrenia status. Overall, these results confirm previous successes predicting schizophrenia from rsfMRI (Savio and Gra\u00f1a, 2015; Rashid et al., 2016 ).\n365 Figure 4b shows that, for some cognitive scores, prediction from functional connectivity achieves only a limited accuracy: some cross-validation determination coefficients \u2206 cv are negative (WASI verb, WASI Sim), meaning that even the mean of the test values is hard to predict. Several hypotheses can be consid-370 ered. Besides the low SNR captured in the BOLD signal and the low number of subjects, some cognitive scores may not be reflected in functional connectivity. However, the stacked multioutput model improves the overall \u2206 cv for all scores, and notably the Brief Assessment Cognition in Schizophrenia (BACS), 375 that is considered as a reliable and reference evaluation metric of schizophrenia (Keefe, 2004) . Differences between \u2206 cv of the two models are positive in average, meaning that the stacked multi-output model is improving the overall accuracy.\n-Predicting AD characteristics. Comparing single and multi 380 output models on the ADNI dataset show results similar to those on the COBRE dataset. This confirms the positive impact of using a stacked multi-output model to characterize neuropsychiatric phenotypes from resting-state fMRI features. In Figure 5a , cross-validated classification shows better AD diag-385 nosis prediction with the stacked multi-output model.\nFor AD-related clinical scores regression, \u2206 cv differences between multi-output and single output models are in average around 0.1. Average \u2206 cv over shuffled train and test splits shows that for some clinical scores prediction is not better than chance. 390 This holds for npiq where the test set mean is poorly estimated (\u2206 cv < 0). This can be explained by the fact that this score does not yield a very sensitive characterization of dementia, nor does it differentiate between clinical groups (Lai, 2014) . Also, the clinical dementia rate (CDR) has only 5 possible values, 395 which makes regression approaches less accurate. However, predictions of most of the clinical scores (MMSE, ADAS ...) are statistically significant, and the multi-output model improves significantly the overall accuracy in all cases."}, {"section_title": "Multi-output stacking reduces variability across datasets", "text": ""}, {"section_title": "400", "text": "We study to what extent a model learned from a study generalizes to a different study with the same measures -rs-fMRI as input, clinical scores as outputs-but on different cohorts. Figure 6 shows that multi-output improves overall accuracy markedly for this cross-dataset prediction. These results also 405 show that predicting across datasets is hard: accuracies are lower than intra dataset. This is due to the variability between studies (sites, scanner, ...), coupled to the low SNR captured by rs-fMRI. As mentioned in (Woo et al., 2017) "}, {"section_title": "Stacking outperforms other source combination strategies", "text": "We show in this experiment the benefits of using random 415 forests to make final predictions from each source predictions. We compare random forests based stacking against model averaging and majority voting to predict the diagnosis for CO-tion strategy, using the same experiment design as presented in the manuscript (100 randomizations over train-test splits). We observe that stacking the predictions consistently outperforms majority voting and averaging. Differences with respect to the mean are increased on average by +4% and +2% for COBRE"}, {"section_title": "425", "text": "and ADNI, respectively. We also observe that the accuracies are more stable with the stacking, in particular for schizophrenia prediction.\n4.4. Stacked multi-output models predict better than low-rank multi-output models"}, {"section_title": "430", "text": "We compare regression \u2206 cv on COBRE and ADNI test folds with RRR, CCA, and the stacked multi-output model. Figure 7 shows that stacked multi-output model has the best overall prediction accuracy compared to CCA and RRR. CCA accuracy on test folds for each clinical score are not significant since most of 435 average \u2206 cv are below zero. This is not surprising, since CCA is not a model optimized for prediction. It is a latent factor analysis method that aims at detecting linear relationships between imaging features and clinical scores. RRR's \u2206 cv are lower than those of the stacked multi-output method. Also, we observe 440 that discrepancies between the accuracies of the clinical scores are consistent across the three methods. For example, BACS, WAIS Coding is better predicted than WASI Sim and WASI verb with all methods. This suggests that these scores better characterize the schizophrenia phenotype. Similar trends are observed 445 when comparing the multi-output model to CCA and RRR on the ADNI dataset. To summarize, these results show that the stacked multi-output model outperforms CCA and RRR to predict jointly multiple clinical and behavioral scores. This last experiment demonstrates using the proposed multioutput stacking approach on multi-modal data. On the ADNI dataset, predicting four clinical scores, we compare the multioutput approach with single output prediction, first with each modality separately (rs-fMRI, hippocampus, CSF), then by 455 combining modalities with a simple feature concatenation or a multiple kernel learning (MKL) method that is considered as a standard for multi-modal/dimensional learning (Schrouff et al., 2016; G\u00f6nen et al., 2011) . Figure 9 shows that predicting several clinical scores improves accuracies over learning each 460 score separately. CSF and hippocampus-only based predictions remain similar. This is not surprising, as the feature space is small (3 and 16 respectively), which limits the effect of the multi-output feature selection.\nCombining all modalities increases prediction accuracies, in 465 particular when the stacking approach is used. On average, the stacking approach leads to higher accuracies than MKL and feature concatenation."}, {"section_title": "Discussion and conclusion", "text": "We have introduced a stacked multi-output learning frame-"}, {"section_title": "470", "text": "work that leverages many input sources to jointly predict several clinical scores. It is a competitive alternative to classical multi-output analysis models like CCA or RRR. Systematic comparisons show that the stacked multi-output models predict more accurately neuropsychiatric profiles or diagnos-475 tic status from neuroimaging measures, in particular functionalconnectivity maps.\nMulti-output models improve the prediction of the different clinical scores. This is because they exploit similar and complementary quantifications of patient health outcomes, hence over-480 come the limitations of both the modality and the behavioral assessments (small dataset, noisy data). In both applications that we studied -schizophrenia and Alzheimer's disease-clinicalassessment scores complement the disease / healthy evaluation. Each score is individually noisy and difficult to predict. How-ever, our experiments show that capturing them jointly in a multi-output approach not only improves the prediction of these scores but also yields a net increase in patient / control classification.\nAdditionally, stacked multi-output models bring sizable ac-490 curacy gains when predicting to a new cohort studying brain disorders, here generalizing from the ADNI database to the ADNIDOD cohort. These results show that capturing jointly several clinical targets has a crucial impact in the face of data heterogeneity."}, {"section_title": "495", "text": "The proposed framework can include multi-modal information. Multi-output feature selection and prediction stacking together make the method more accurate when combining anatomical, functional, and biofluid biomarkers. The experimental results show that multi-output stacking is as accurate as 500 state-of-the-art multi-modal approaches such as multiple kernel learning. From a practical point of view, it is beneficial because it requires less parameter tuning and the prediction stacking step can easily incorporate any predictor or signal capturing a new source of information."}, {"section_title": "505", "text": "Future work calls for leveraging the proposed approach to build cross-study predictive models from the growing large multi-modal databases. Resources like UK biobank can provide novel hypotheses and biomarkers that can be tested in targeted clinical investigations. These rich cohorts typically pro-510 vide multiple clinical and cognitive scores. Our cross-dataset results suggest that, analyzed jointly, these scores will yield biomarkers that generalize better to new cohorts and provide new insights linking neuropathologies to the brain."}, {"section_title": "50%", "text": "60% 70% 80% 90%\nCross-validation accuracy "}]
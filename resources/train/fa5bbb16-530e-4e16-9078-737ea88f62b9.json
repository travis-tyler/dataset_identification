[{"section_title": "Abstract", "text": "Abstract-Visually comparing human brain networks from multiple population groups serves as an important task in the field of brain connectomics. The commonly used brain network representation, consisting of nodes and edges, may not be able to reveal the most compelling network differences when the reconstructed networks are dense and homogeneous. In this paper, we leveraged the block information on the Region Of Interest (ROI) based brain networks and studied the problem of blockwise brain network visual comparison. An integrated visual analytics framework was proposed. In the first stage, a two-level ROI block hierarchy was detected by optimizing the anatomical structure and the predictive comparison performance simultaneously. In the second stage, the NodeTrix representation was adopted and customized to visualize the brain network with block information. We conducted controlled user experiments and case studies to evaluate our proposed solution. Results indicated that our visual analytics method outperformed the commonly used node-link graph and adjacency matrix design in the blockwise network comparison tasks. We have shown compelling findings from two real-world brain network data sets, which are consistent with the prior connectomics studies."}, {"section_title": "INTRODUCTION", "text": "The study of human brain networks stands at the heart of brain connectomics, an increasingly prominent field of computational neuroscience to understand the landscape of neural connections in our brain [37] . In this paper, we focus on the macroscopic brain network defined by high-level Region Of Interests (ROI), versus the microscopic brain networks composed of cells, synapses and voxels [4] [15] . The structural brain network in the macroscopic level is typically constructed in two steps. First, magnetic resonance imaging (MRI) is used to accurately advanced methods can cause overfitting when the number of subjects is small, possibly leading to less reliable results. Second, it is costly to validate numerous computational models proposed in sophisticated brain network studies for which subject-matter experts are required.\nVisualization tools are important for addressing some of these challenges to compare high-dimensional connectivity patterns in the brain. On one hand they provide an interactive platform to fuse multiple sources of brain networks and measurements to test various computational models and parameters. On the other hand, the visual interface allows domain experts to work seamlessly with the data sets, analysis algorithms and comparison results for efficient evaluation of the data. A natural question arises regarding which visual representation works the best for comparing human brain networks. The pioneering work by Alper et al. [5] contributed towards answering this question. They found that the node-link representation, though popular in illustrating social and information networks, is not the best choice to visually compare weighted brain networks. Meanwhile an adjacency matrix design performs better in low-level brain network comparison tasks such as finding connectivity patterns and neighboring elements. In this work, we implement some of their user studies on real-world brain networks (versus the synthetic data set in Alper et al. [5] ). While most of our results align well with Alper's in that the matrix design outperforms the node-link graph, it is critical to notice that on real brain networks, both methods bear very low task accuracies and high completion times (e.g. < 72% and > 34s in Table 2 ). We argue that this is because the human brain network is dense and might be quite similar among population groups (Section 3.1). It can be infeasible, or at least difficult, to ask users to visually compare dense and homogeneous human brain networks with respect to their weighted connectivity patterns.\nIn this paper, we describe a new way to visually compare human brain networks. Instead of directly comparing the traditional ROIbased brain networks, we exploit the inherent block structure of the human brain by considering the blockwise brain network comparison problem (Section 3.2). The rationale behind the blockwise comparison can be explained as follows: from an anatomical standpoint, the human brain is composed of multiple blocks -meaning that ROIs can be divided into left and right hemispheres, and can be further broken down into several cerebral lobes, often linked to highly specialized brain functions. For example, the temporal lobe is responsible for forming long-term memory, while the insula is involved in human consciousness. Furthermore, due to the physical block structure, domain users generally compare brain network connectivity patterns in relation to this anatomical breakdown. It has been shown that Alzheimer's disease may lead to alterations in fiber connectivity in the temporal and parietal lobes primarily, predominantly in the left hemisphere [40] . More blockwise comparison studies in clinical practice are surveyed in Section 3.2. Computationally, we show in Section 4.2 that incorporating the block structure of ROIs can improve the predictive performance in classifying human brain networks while not interfering with the extraction of comparative patterns. In summary, the contribution of this work can be described as follows.\n\u2022 We propose the blockwise brain network comparison problem over the ROI-based network comparison studied previously (Section 3.2), and present an integrated visual analytics framework to address this new problem (Section 3.3). The effectiveness of our framework is demonstrated through case studies over two real-world data sets: one comparing the average brain network of a group of AD patients with that of healthy controls; another comparing between two groups of normal people with high and low creativity scores (Section 6).\n\u2022 In this framework, we introduce an adaptive clustering algorithm on the ROIs of human brain networks to maximize the predictive classification performance with the resulting blockwise connectivities (Section 4). The key challenge is to overcome local maxima in optimizing the feature selection process.\n\u2022 We adapt a hybrid visualization design, aka NodeTrix by Henry et al [20] as shown in Figure 1 , to optimize the blockwise network visual comparison task, which takes the ROI block struc- ture into account when displaying the human brain network (Section 5.1). To further improve the performance of NodeTrix in real-life comparison tasks, we propose to apply force-directed edge bundling algorithms according to the block representation of brain networks (Section 5.2). The NodeTrix visualization is evaluated in the user study by comparing to the classical nodelink and adjacency matrix visualization on blockwise brain network comparison tasks."}, {"section_title": "RELATED WORK", "text": "Brain network (aka the connectome) visualization is a popular interdisciplinary research topic. In the neuroscience community, Margulies et al. summarized three classes of visualizations based on the various steps in their data transformation pipeline [31] . On the low-level DWI data, in particular Diffusion Tensor Imaging (DTI), tensor glyphs in different shapes were invented to display the rich data dimensionality. For example, the latest design by Pr\u010dkovska et al. [34] augmented spherical polar ploy glyphs [21] with optimized shape and color scheme. Their design can highlight multiple maxima in order to make the \"peaks\" of glyphs more distinct in the visualization. On the streamline reconstructed by tractography [25] , traditional visualizations display a deterministic fiber tract without considering its uncertainty and dimensionality. Berres et al. [8] introduced nested surface layers to visualize probabilistic tractograms which can indicate the connectivity score between voxels. On the connectome constructed from whole-brain fiber tracts, which is more related to our work, both graph, matrix and chordmap [32] metaphors have been applied for visualization. For a more extended literature review on connectome visualization, we refer to this survey [31] . Most recently in the visualization community, Al-Awami et al. proposed Neurolines [4] , a novel visual metaphor to examine the neuronal connectivities at nano-scale. Neurolines designed a multiscale subway-like visualization which can be interactively rendered and scaled up to display thousands of neurites for the detailed analysis of neuronal structures and their connectivity. Everts et al. [15] studied the visual abstraction of brain fiber tracts from Diffusion Tensor Imaging (DTI) data. Through arranging the fiber tracts by their local similarity at multiple scales, the global white matter architecture inside the brain can be constructed from fiber tracts, with less visual clutters than previous approaches. Overall, these compelling methods on the visual abstraction of brain connectivity mostly work at the microscopic level of human brains, e.g., the neuron-level [4] or the voxel-level [15] . On the comparison of human brain networks across population groups, the difference at the microscopic level can be less significant, due to their higher uncertainty, than the macroscopic connectivities, i.e., the ROI-level brain networks.\nThe task of visually representing and comparing high-level brain networks is relatively less explored, though the general topic of visual comparison has been a focus of the information visualization research [19] [30] . Bach et al. presented Matrix Cube [6] , an effective 3D cube visual representation to display the functional brain networks. Their focus is on the dynamic pattern of brain networks, but not on the comparison between groups of average brain networks. The work by "}, {"section_title": "OVERVIEW 3.1 Preliminary User Study", "text": "We start from a controlled user experiment to compare two basic visualization designs for the brain network comparison: the node-link graph and the adjacency matrix. In addition, we consider two visual comparison methods: the overlaid comparison [5] and the straightforward side-by-side comparison. When combined, we study four candidate interfaces: node-link overlaid (NO), matrix overlaid (MO), nodelink side-by-side (NS), matrix side-by-side (MS). Alper et al. [5] first conducted this comparative study on NO and MO visualizations over a group of synthetic brain networks. In contrast, our study is carried out on real-world brain networks, comparing 42 AD patients with 50 healthy controls. Real-world brain networks have two significant differences from synthetic networks that can affect the user study result. First, high network density. For instance, the brain network of each of 92 subjects in our data set has 454\u223c1021 edges (i.e., fiber connectivity with nonzero strength) between 68 ROI nodes, leading to a network density of 0.2\u223c0.45, whereas the synthetic network in [5] has a 5% or 10% density. Second, similar network topology across subjects. We have built a Pearson's correlation coefficient matrix by the weighted topology vector of 92 subjects in our data set, each has a vector length of 2278. More than 90% pairs of subjects have a weighted topology correlation greater than 0.8, and the average correlation is close to 0.9.\nOur experiment result with 12 subjects over the real brain network data set is summarized in Table 1 (Trend task) and Table 2 (Connectivity task). The task design follows those in Alper et al. and the implementation details are the same with our second user study explained in Section 6.1. There are two observations with respect to the results by Alper and colleagues that motivate our follow-up research. First, the comparison between MO and NO methods leads to the same outcome: when the overlaid method is applied, the matrix design is significantly better in accuracy and completion time when compared to the node-link visualization, with the exception of the completion time in the Trend task. However, the actual task accuracy deteriorates greatly on the real data set: on the Trend task, it drops from 0.96 (MO) and 0.85 (NO) in Alper et al. to 0.86 and 0.50 in our study; on the Connectivity task, it drops from 0.90 (MO) and 0.71 (NO) to 0.72 and 0.33. The completion time measure has a similar pattern. These effects can be attributed to the dense and homogeneous nature of real brain networks in the ROI level, which prevents users from accomplishing visual comparison tasks. Our second finding, the side-by-side comparison design, though not considered in the previous study, leads to comparable performance to the overlaid design when the network density is high. This is especially true judging from subjective ratings. The scores for the node-link side-by-side design in user experience and usability (3.83 and 3.92 in the 7-point likert scale, higher is better) are only slightly below those of the matrix overlaid design (4.07 and 4.08). Note that the side-by-side comparison bears an additional advantage in much shorter training time than the overlaid comparison for ordinary users."}, {"section_title": "Blockwise Brain Network Comparison", "text": "The preliminary user study result indicates that it may not be effective to visually compare real brain networks solely at the macroscopic ROI level. The cortical connectivity at that level is adversely dense and little visual difference is presented between individual subjects. In fact, from the domain expert's view (neuroscientists, e.g., co-authors of this paper; doctors, our collaborators), rarely do they examine the brain network difference only from the ROI level between individual subjects. In this work, motivated by the inherent block structure of human brains (e.g., left/right hemispheres, anatomical lobe classifications), we consider a new problem of blockwise network comparison over the existing ROI-based brain network. At the ROI block level, the abstracted connectivity pattern can be more salient in visual comparison and far more useful for domain experts.\nTo validate the importance and characterize user tasks on the new problem, we did a literature review of 33 neuroscience studies on the comparison of human brain networks (aka the white matter connectivity) between diagnostic groups (AD, Schizophrenia, genetic disorders). We examined each study by the criterion that whether or not the comparison analysis had detected significant patterns in the ROI block level, rather than only detected between particular ROIs. The representative literature is given in Table 3 and a full list is documented in the supplemental material. In summary, 22 out of 33 studies (66.7%) in the review met our criterion. Dating back to the 19th century, Wernicke described the disconnection syndrome as a loss of connectivity between the sensory speech and the motor speech areas in the left hemisphere [42] , which was among the first block-level connectivity studies. On the group-based comparison studies between AD patients and controls, we examined 12 relevant studies cited by Daianu et al. [12] . Eight studies meet our criteria, details can be found in Table 3 . On the comparison study of Schizophrenia (SZ) patients, we reviewed 7 highly cited papers on the white matter deficiency -6 of which reported results based on higher-order brain subnetworks [33] , aka block-level networks considered here. We also reviewed 12 brain network studies related to genetics, cited by Thompson and colleagues [39] , 6 of which fitted our criterion. Based on the literature review, we conclude that the ROI block level difference among diagnostic groups are crucial for the classification and prediction of certain disease or symptom. We summarize a set of blockwise brain network comparison tasks based on the practice in the literature and feedbacks from domain experts."}, {"section_title": "B1: Given one ROI block, identify noticeable changes of its local connectivity between diagnostic groups. B2: Given one ROI block, identify noticeable changes of its global connectivity (i.e., between the ROIs of the current block and the ROIs in other connected blocks) between the diagnostic groups.", "text": "B3: Identify ROI blocks that have local/global connectivity changes between the diagnostic groups.\nB4: Identify pairs of ROI blocks that present connectivity changes between the diagnostic groups."}, {"section_title": "Visual Analytics Framework", "text": "Consider the design space for the blockwise comparison task defined above. The user study result in Section 6.1 shows that applying the classical node-link or matrix design leads to poor visual comparison performance, especially on the inter-block connectivities. In a few ROI definitions, two ROIs within the same block can be geometrically separate in the projected brain cortex, making it difficult for users to visually compare the block-level connectivities.\nIn this work, we propose a visual analytics framework to integrate the algorithmic ROI block generation with the interactive visualization to help identify and analyze blockwise brain network connectivity differences. As shown in Figure 2 , in the first stage, we apply clustering algorithms to detect a two-level ROI block hierarchy (Section 4). In the top level, the functional blocks divide all ROIs based on an anatomical or functional classification (e.g., the lobe classification); and in the bottom level, each functional block is partitioned into several comparison blocks, in a way to maximize the group-level difference in the network comparison. In the second stage, the raw ROI connectivity and its hierarchical block structure are integrated and represented by a hybrid NodeTrix visualization (Section 5). The functional blocks are shown as matrices, the comparison blocks are shown as merged rows/columns inside the matrix, and each ROI is represented by the individual row/column. To optimize the inter-block connectivity comparison across diagnostic groups, we introduce the force-directed edge bundling algorithm to visually aggregate the connections on the same pair of ROI blocks. "}, {"section_title": "ROI CLUSTERING", "text": "The top-level ROI hierarchy is composed of functional ROI blocks. In this work, we adopt the cerebral lobe classification that partitions each hemisphere into six lobes: frontal lobe, parietal lobe, occipital lobe, temporal lobe, limbic lobe, and insula. Other functional cortex parcellations are also applicable, depending on the targeted comparison task.\nIn the second-level ROI hierarchy, we apply clustering algorithms to detect comparison blocks that best reveal the connectivity difference among diagnostic groups. The main idea is to link the accuracy in the predictive analysis, i.e., the classification of brain networks into diagnostic groups, with the visual comparison performance among groups of brain networks. The problem of optimizing the blockwise brain network visual comparison is converted to finding the best ROI clustering that maximizes the brain network classification accuracy."}, {"section_title": "Brain Network Classification", "text": "The brain network classification problem is defined as predicting the label of a subject (outcome) using the features on the subject's brain network. Here the label indicates the diagnostic group. Throughout this paper, we consider the binary classification, i.e., the label has two levels, e.g., diseased or healthy subject. The brain network features are limited to the set of connectivity strengths, i.e., the number of fibers going through each pair of ROIs. These connectivity strengths become the edge weight in the brain network, so we also call them edge features interchangeably.\nThe formal notations in this definition are listed in Table 4 . We consider N subjects and their brain networks, denoted by G 1 , \u00b7\u00b7\u00b7 , G N . Each brain network has n nodes (i.e., ROIs) and p edges (i.e., fiber connections) between pairs of nodes, denoted by e 1 , \u00b7\u00b7\u00b7 , e p . The edge weight (i.e., connectivity strength) is defined by the variable X . On G i , the network of the ith subject, the edge weights are denoted by the vector X i = (x i1 , \u00b7\u00b7\u00b7 , x ip ) . At the network level, each subject is associated with a binary outcome variable Y (i.e., subject label). The value of Y on N subjects is denoted by the vector Y = (y 1 , \u00b7\u00b7\u00b7 , y N ) . Using a basic logistic regression model, the objective function to best fit the model given data is written as minimizing the Negative Log Likelihood (NLL)."}, {"section_title": "Min NLL(W", "text": "where W = (w 1 , \u00b7\u00b7\u00b7 , w p ) denotes the weight vector for all p edge features. The edge with a larger weight means that it has a higher influence on the outcome. When classifying brain networks, it is known that using all the edge features for training can lead to severe overfitting, which downgrades the classification accuracy in the testing set. The general approach is to apply feature selection that only picks the most informative features to predict the label. Here we adopt the lasso model [41] which adds a L 1 regularization term (||W || 1 , i.e., L 1 norm of the weight vector W ) for the edge feature selection. The objective function of the lasso model is given by\nwhere the parameter \u03bb > 0 controls the degree of overall model sparsity. A larger \u03bb will lead to less selected edge features. The weight vector W determines the feature selection result. The ith edge feature will be selected if w i = 0, and unselected if w i = 0. To determine the sparsity parameter \u03bb , we iterate over a list of logarithmically spaced parameter choices within the feasible range for nonzero weight vectors. The best \u03bb is chosen as the one leading to the highest classification accuracy in 10-fold cross-validations. The lasso model is popular because of its effectiveness to achieve good classification accuracy. However, lasso does not capture the interaction effect among features, nor does it take the feature group information as indicated by the block structure in our work. In our final classification model, we apply a recent variant of lasso, namely the sparse group lasso (SGL) [36] which incorporates feature grouping information to optimize the classification. These edge feature groups can be directly linked to the ROI clustering in that when network nodes are grouped, their edges are aggregated correspondingly. The objective function of the SGL model is defined by\nwhere M denotes the number of feature groups, W (m) is the partial weight vector of the mth feature group. The parameter \u03b1 controls the the group-wise sparsity. The remaining question is to determine which ROI clustering provides the best feature grouping information for the brain network classification."}, {"section_title": "Optimal ROI clustering", "text": "We start from a trivial setting of n ROI clusters, i.e., one cluster per ROI. In this setting, the objective function of the SGL model (Eq. [7] . Therefore, finding the best ROI clustering that yields the highest classification accuracy leads to an NP hard problem requiring O(n n ) computation time, when the exhaustive search on all possible ROI clusterings is applied.\nThe search-based solution can be improved by only combining ROIs within each functional block, but the complexity is still exponential. A more feasible approach is to apply the greedy search by clustering ROIs in an agglomerative manner. An illustration of this process, i.e., the search tree, is given in Figure 3(a) . In this tree, each node represents an ROI clustering setting and the node label indicates the classification accuracy when this ROI clustering is applied, i.e., a 0 for the initial clustering and a i j for the jth feasible clustering in the ith step. The directed link indicates the process to merge two ROI clusters into a new cluster, moving from one clustering setting to another. The search starts from the root of the tree where the trivial n-ROI-clustering is applied. In the next step, all feasible binary combinations of trivial ROI clusters are examined by classifying with the SGL model under the new clustering. These clusterings are represented as the nodes in the second hierarchy. The greedy search scheme will pick the clustering setting leading to the highest accuracy in each step, e.g., in this figure, the clustering that combines ROI cluster {#3} and {#4} which yields a classification accuracy of a 14 \u2265 a 1 j . After that, the search process is repeated one step further and combines the ROI cluster {#3,#4} with {#5}. In n \u2212 1 steps, all ROIs are combined into one cluster and the search process terminates.\nThe greedy search scheme leads to a cubic computational complexity assuming the SGL solver has a constant cost, which is feasible for computation because the number of ROIs (n) is small. However, due to the non-concave and combinatorial nature of the search space, the greedy search is highly likely to get stuck in the local maxima. To address this issue, we propose an improved greedy search scheme by adding roll-back operations. As shown in Figure 3(b) , instead of using the classification accuracy as the search heuristic, we turn to maximize the accuracy improvement from the last step, denoted by I i j for the jth combination in the ith step. This allows us to introduce a slope constraint S. In case the best accuracy improvement in certain step of the greedy search falls below S, e.g., I 23 < S in Figure 3(b) , we drop this search branch by overriding the accuracy improvement of its upper node (i.e., I 14 ) to I 23 . This branch will not be searched any more because I 14 < S. The search process restarts with a roll-back one step further, i.e., to the root node in this figure. As the previous best choice of I 14 has been dropped, the second best clustering indicated by the improvement I 12 is picked and the greedy search continues from this new branch. Except for the slope constraint S, we control another two parameters to keep the search process going: the maximal roll-back depth D max and the slope constraint step \u2206S. When the search rolls back more than D max hierarchies consecutively, we loosen the slope constraint by subtracting one step of |\u2206S| from S. This also fits the actual curve of the accuracy improvement. As shown in Figure 4 , the best accuracy appears in the middle of the clustering process, and after that drops almost monotonically.\nThe greedy search with roll-back scheme can lead to significantly increased computational complexity as more than one path on the search tree can be traversed. We introduce the caching strategy to reduce the computation requirement. As shown in Figure 3 (b), the same ROI cluster combination can appear in different steps of the search tree, e.g., I 11 /I 21 and I 13 /I 23 . The strategy is to assume the accuracy improvement by the same combination does not change much across search steps. Under this assumption, every new search in later steps can first fetch the accuracy improvement from the cache established in earlier steps. This greatly reduces the cost in repeating SGL modelings for every new clustering. We have applied the greedy search and the roll-back scheme in the 113-subject high-CCI v.s. low-CCI brain network data set. The performance curves are depicted in Figure 4 . The ROI clustering will mildly increase the classification accuracy before a half of the ROIs are grouped together, while the number of features selected remains constant. This demonstrates that the inherent block structure of human brain networks can be leveraged in its classification to better abstract, but not undermine, the comparison pattern, if only an adequate number of clusters is specified. When the clustering proceeds to generate over-simplified block structure, the classification accuracy will drop quickly and it is hard to discover good blockwise comparison patterns any more. We have integrated the classification accuracy measure during the search process into the visualization interface to guide the interactive visual comparison of brain networks."}, {"section_title": "VISUALIZATION DESIGN", "text": "We consider two design goals for the brain network visualization in our scenario: 1) optimize the user performance in the visual comparison of brain networks; 2) incorporate the two-level ROI block hierarchy into the visualization for blockwise comparisons. It has been shown in [5] that the node-link representation is not the best choice for visual comparison. Meanwhile, the adjacency matrix can be better than the node-link design in user performance, but it is difficult to embed multiple ROI block hierarchies into the matrix design while highlighting the blockwise comparison patterns. In this work, we explore the hybrid approach, that uses the NodeTrix representation to visualize the blockwise brain network connectivity for comparison between population groups. The NodeTrix metaphor was invented by Henry et al [20] to display social networks having inherent clustering nature. In their design, the dense social communities can be represented by matrices, while the sparser inter-community connections are drawn in the node-link diagram. We echo the same design rationale on brain networks. The weighted graph clustering result (k=12) on our brain network data set shows a very close structure to the 12-lobe brain parcellation: 46 out of 68 ROIs have the same membership in the graph clustering and the lobe classification. This demonstrates that the intralobe connectivity is on average denser than their inter-lobe counterpart, which advocates the use of the NodeTrix design. Figure 5 depicts an example of using NodeTrix to display the blockwise brain network comparison in a side-by-side design. For each brain network, the high-level visual representation is composed of several matrices, each corresponding to a functional block in the brain, i.e., one of the anatomical lobes in our setting. Each row/column in the matrix represents a single ROI whose index is drawn as labels on the border of the matrix, e.g., the largest frontal lobe contains 11 ROIs in each hemisphere. The rows and columns can be combined together to represent the comparison blocks in the ROI clustering hierarchy, as shown in Figure 1 . Inside each matrix, the entries drawn as colorcoded cells indicate the intra-lobe ROI connections. The red hue is selected as the default fill color, while the color saturation is used to represent the fiber strength of each ROI connectivity. The more saturated the color, the higher connectivity strength. The detailed strength-color mapping is indicated and controlled by the color map slider in the center of the control panel in Figure 5 . User interactions are supported to tune the color map and optimize the visual comparison (Section 5.3). Note that the diagonal cells in each matrix are greyed out as the fiber loops on each ROI are unimportant for the comparison of brain networks. For the inter-lobe ROI connections, curved edges are drawn between the matrices where the two endpoints are on the brim of the source and target ROI column/row. Both the edge thickness and color saturation indicate their connectivity strength."}, {"section_title": "NodeTrix Representation", "text": "Our design supports three comparison views by different projections of the brain network: sagittal view (Figure 9 ), axial view ( Figure  5 ), coronal view (supplemental video). They are also distinguished by separate background brain sketches. On the layout of each view, we consider optimizing both the topographical proximity and the performance for visual comparison. The matrices representing the functional blocks are placed in the center of their anatomical lobes. The ROIs within each functional/comparison block are initially ordered by their ROI indices. We also provide an interaction to reorder ROIs according to their magnitude of difference in the comparison."}, {"section_title": "Brain Connectivity Edge Bundling", "text": "The brain connectivities between ROI blocks are drawn as B-spline curves between matrices. These edges are bundled together by selecting appropriate control points for each curve. We propose two edge bundling algorithms for separate objectives: the semantic bundling to optimize the visual comparison and the geometric bundling to reveal the physical routing path of the underlying fiber pathways.\nSemantic edge bundling. In this method, the objective is to reduce the visual clutter raised by the dense ROI-level connections while preserving the blockwise connectivity patterns. We achieve this by a three-step force-directed edge bundling algorithm.\nIn the first step, we cluster all the ROI connectivity edges into groups according to their blockwise semantic information. The edges connecting the same source and destination matrices are grouped together and share the same set of control points. In other words, edges will be bundled to represent blockwise connectivities. In the second step, we determine the initial placement of control points in each edge bundle. To keep their original connectivity structure, the control points are uniformly sampled from the straightline connecting the center of their source and destination matrices. In the third step, we apply the force-directed edge bundling algorithm to adjust these control points to further alleviate visual clutter. The basic idea is to move the control points of all edge bundles towards each other to reduce the number of spatially distributed control points. In more detail, all control points are considered as nodes in a proximity graph. Then the force-directed layout [17] is conducted on this graph to refine the placement of all control points. The key choice is to decide the optimal distance (i.e., proximity) between each pair of control points. We apply Holten and Van Wijk's algorithm in [23] \n) k where C e = C a \u00b7C s \u00b7C p (4) where Dist 0 denotes the initial distance between the two control points. C a , C s , C p indicates the adjustment based on the angle, length and proximity of the matrix connection lines of these two control points. Geometric edge bundling. In another method, we start by aligning the brain network connectivity with the fiber tracts reconstructed through tractography. These fiber tracts can be geometrically clustered into bundles [26] where each bundle represents the connectivity between several ROI blocks. The control points for each blockwise connection can be selected from these bundles to reveal the geometric routing of fibers in the human brain.\nIn more detail, we introduce a two-step algorithm to compute the control points on each fiber track bundle. In the first step, a streamline is extracted from every track in the selected fiber bundle by uniform sampling. Then we use the sampled points in all tracks to compute a centerpiece streamline. The fiber track staying closest to this centerpiece streamline is selected to represent the entire fiber bundle. The second step is to re-sample the representative fiber track to extract a small number of control points for the edge bundling. Each fiber track is composed of a large number of points. We start from the first point and keep track of the accumulative curvature in iterating all the points, which is known as the winding angle. Once the winding angle is larger than a threshold, the current point is sampled and the winding angle is reset to zero. In the final algorithm, we choose a winding angle threshold of 360 degrees according to Tao et al. [38] . In case the winding angle does not reach the threshold after scanning the entire track, we apply uniform sampling. Mathematically, the curvature k i at point p i of a fiber track streamline is computed by\nwhere p i\u22121 and p i+1 are neighboring points of p i on the streamline."}, {"section_title": "Interaction for Visual Comparison", "text": "Following the visualization design, we support basic network interactions as well as a suite of customized interactions to facilitate the user's visual comparison task on brain networks. At the ROI level, we design an interactive color map, as shown in the range slider of the central panel in Figure 5 . The left range selector controls the edge filtering. All the edges below a specified strength threshold will be removed in the display. The right range selector controls the maximal edge strength. The edges above this maximum will be drawn in the largest color saturation. The edges with strength inside the range will have a linear mapping to the color saturation spectrum. When the binary mode is selected, the range selector becomes the point selector. All remaining edges after the filtering will be drawn in the same maximal color saturation. At the ROI block level, we introduce a matrix reorder interaction. All ROIs inside each lobe are first sorted by the difference between the two compared groups of networks. The ROI with the largest difference is placed in the matrix center and all ROIs are arranged from the center to the border by this order. At the network level we design a network contrast interaction which, when applied, each connectivity strength in the network is subtracted by the minimal strength of the two networks in comparison. Subsequently, only the connectivity difference is shown after this interaction."}, {"section_title": "EVALUATION 6.1 User Experiment on Blockwise Comparisons", "text": "We conducted a controlled experiment to understand the effect of visual designs on the user's performance in blockwise brain network comparison tasks. We compared three visualizations: node-link networks, adjacency matrices, and the proposed NodeTrix design (Figure 5) . NodeTrix applies a one-level blocked structure mapping brain lobes to the matrix. Within each lobe, the comparison blocks are not used because in our pilot study, users need additional time and training to locate the best clustering parameter. In all three designs, the side-by-side comparison is adopted. Experiment design. We recruited 16 subjects (10 male, 6 female) who were all computer science graduate students and have experience with data visualization. The experiment applied a full-factorial withinsubject design that every subject was tested on including all visualization methods. The experiment was divided into the training session and the test session for each visualization. In the training session, users warmed up by completing the same suite of tasks on a much easier setting (e.g., less nodes and edges in the brain network to compare). The organizer checked the result of each training task and addressed all questions before proceeding to the next step.\nTask. All four tasks listed below were conducted on the brain networks from 92 subjects (including controls vs. AD patients) to compare differences at anatomical network level."}, {"section_title": "T1 (Local connectivity): does the overall edge weight within the right frontal lobe subnetwork decrease or increase in controls when compared to AD patients? T2 (Lobe-Lobe connectivity): does the overall edge weight between the right frontal and the right temporal lobe decrease or increase in controls when compared to AD patients? T3 (Lobe-ROI connectivity): does the overall edge weight between the frontal lobe and all other ROIs decrease or increase in controls when compared to AD patients? T4 (Lobe connectivity retrieval): identify one lobe-lobe pair whose connectivity has the largest overall edge weight difference between brain networks of the two diagnostic groups?", "text": "Note that for each task\u00d7visualization pair, each user was tested on three difficulty levels by controlling the difficulty for detecting differences in the group comparison. This level is shuffled for different users and visualizations to eliminate learning and ordering effect. For each task, we recorded the subject's answer and completion time. The task completion time was measured after the subject had read the question, so that the reading skill variation was excluded. On T 1 through T 3, the relevant lobes in the task were highlighted using color coding in the matrix (node) outline of each visualization. On T 4, all lobe names are labeled on the visualization. This was done to minimize the visual search time for the lobe in the task. During the test session, subjects were also asked to respond to three subjective questions immediately after they completed all the tasks for each visualization. Answers were selected from a 0\u223c6 Likert scale (larger is better)."}, {"section_title": "Q1 (Usability): How much does this visualization help you in completing the tasks and finding the correct answers? Q2 (Cognitive Performance): How much does this visualization help you to understand the brain network data? Q3 (User Experience): How would you rank your experience with this visualization design?", "text": "Result. Experiment results were analyzed separately for each task. Significant level was set at 0.05 throughout the analysis.\nTask Accuracy: The user's accuracy in completing each task is summarized in Figure 6 (a). For T 1, the intra-lobe local connectivity task, all three visualizations led to rather high accuracies on average (NodeLink: 0.93, Matrix: 0.88, NodeTrix: 0.91), and there were small differences in between. For T 2, the lobe-lobe connectivity task, NodeTrix (0.93) had better accuracy than Matrix (0.86) and Node-Link (0.67). A repeated-measure ANOVA test on their average task accuracy (normality and sphericity held, the same below) shows that there were significant group-level differences (F(2, 26) = 8.943, p = 0.001). Posthoc test using the Bonferroni correction reveals a significant difference between Node-Link and NodeTrix (p = 0.001), but the difference between Node-Link and Matrix was not significant (p = 0.078). For T 3, the lobe-ROI connectivity, Node-Link (0.91) and NodeTrix (0.91) have better average accuracy than Matrix (0.76), but the difference was not significant (p = 0.12). For T 4, the lobe connectivity retrieval task, most subjects failed to complete it using the Node-Link visualization deisgn, so we only compared Matrix and NodeTrix designs. In average, NodeTrix (0.98) had a much higher accuracy than Matrix (0.36), and the difference was significant based on a paired samples t-test (t(13) = \u221213.0, p < 0.001).\nCompletion Time: The user's completion time in each task is summarized in Figure 6 (b). For T 1, the intra-lobe local connectivity task, Matrix (5.31s) and NodeTrix (5.17s) took slightly shorter time than Node-Link (6.01s) to complete, but the difference was not significant (p = 0.27). For T 2, the lobe-lobe connectivity task, again Matrix (5.43s) and NodeTrix (5.12s) took shorter time than Node-Link (7.75s). A repeated-measure ANOVA test (normality and sphericity held, the same below) showed a significant group-level difference (F(2, 26) = 6.598, p = 0.005). Post-hoc tests using the Bonferroni correction revealed a significant difference between Node-Link and NodeTrix (p = 0.045), but not between Node-Link and Matrix (p = 0.057). For T 3, the lobe-ROI connectivity, all visualizations took a similar amount of time: Node-Link (4.96s), Matrix (5.62s), NodeTrix (5.18s), and the differences were not significant (p = 0.53). For T 4, the lobe connectivity retrieval task, NodeTrix (8.87s) had a much shorter completion time than Matrix (20.21), and the difference was significant under a paired samples t-test (t(13) = 4.11, p = 0.001).\nSubjective Questions: The user's subjective scores are summarized in Figure 7 . It is shown that Node-Link and NodeTrix have better average scores than Matrix in all three subjective measures. We then applied the Friedman test to analyze their group-level difference, which does not require a normality assumption. Results indicate that while there was no significant difference in the usability score (p = 0.41, the average score, Node-Link: 4.36, NodeTrix: 4.36, Matrix: 3.79), the cognitive performance and user experience were significantly different across groups. On the cognitive performance, Node-Link (4.93) and NodeTrix (4.79) were significantly better than Matrix (4.21) under the Friedman test (\u03c7 2 (2) = 9.46, p = 0.009). The post-hoc Wilcoxon signed rank test results were p = 0.004, 0.046. On user experience, Node-Link (3.79), NodeTrix (4.36) and Matrix (3.21) have significant group-level difference by the Friedman test (\u03c7 2 (2) = 9.33, p = 0.009), but the post-hoc Wilcoxon signed rank test only detected significant difference between NodeTrix and Matrix (p = 0.004).\nDiscussion. The user study results show that, on the block-block connectivity tasks for both low-level examination (T 2) and high-level retrieval (T 4), the NodeTrix design performs significantly better than the Node-Link design, and better than the Matrix design, for both task accuracy and performance time. Especially for the high-level retrieval task of T 4, NodeTrix was significantly better than Matrix. This demonstrates the superiority of the NodeTrix design in revealing the block-level brain network structure, which is extremely important in exploratory tasks (like T 4) where noisy data is present. On the localized single-block tasks (T 1 and T 3), while the completion time is close because of the low difficulty level, NodeTrix achieved a similar task accuracy to the Node-Link design, and both were better than the Matrix design, though not significantly. This indicates that the hybrid block representation (NodeTrix) does not affect the local connectivity retrieval, while a full block design (Matrix) could downgrade the local comparison performance when no customized technique (e.g., overlaid design) is applied. For the user's subjective rating, we noticed that all users disliked comparing matrices side-by-side. Though the Matrix design can still work (no significance in usability), user's cognitive gain and experience were significantly poorer than NodeTrix and Node-Link design. This can be attributed to the counter-intuitive nature of the adjacency matrix. NodeTrix compensates this deficiency by keeping a high-level node-link representation."}, {"section_title": "Case Study", "text": "We evaluated the NodeTrix visualization design on two sets of real-life brain networks. The first is on Alzheimer's Disease patients. More recently, as studied in Thompson et al. [40] and Daianu et al. [12] , the AD patient's brain network tends to degenerate in an asymmetric fashion predominantly in the left hemisphere. Furthermore, the metaanalysis in [9] from five studies of 1138 subjects showed a converged effect of AD to the posterior cortical regions in the left hemisphere (mainly in the parietal lobe).\nWe analyzed the data set from ADNI -a publicly available AD Consortium [2] , and applied NodeTrix to reproduce the above brain network patterns. The ADNI data we used for this study contained DWIs from 202 subjects -50 healthy controls, 72 with early mild cognitive impairment (eMCI), 38 with late mild cognitive impairment (lMCI) and 42 AD patients. The participants underwent whole-brain MRI at 16 different site across North America [12] and their ages ranged between 55 to 90 years. For each subject, an ROI-level network was computed using an automated segmentation method, FreeSurfer [3] based on the Desikan-Killiany atlas [14] . The edge weights among ROIs described the fiber density between pair of ROIs (the number of fibers passing through a pair of ROIs). To focus on the alterations patterns in the network, we greyed out the connections from each ROI to itself (i.e., the diagonal cell in the adjacency matrix). We started the analysis by comparing the average brain network of 42 AD patients with those of 50 controls. The initial view was rather cluttered because of the high number of edges and complexity of the average brain networks ( Figure 5 ). Therefore, we focused on the network differences by manipulating the edge color map slider. First, we applied filters to eliminate many low-density connections that overwhelm the network view. Then we switched to the binary color mapping mode to only compare the unweighted connectivity controlled by a predefined density threshold. The result was illustrated in Figure 8(a) . It can be quickly identified that the high-density fiber connectivity network is more symmetrical (between left and right hemisphere) in the control group than in the AD group. The AD patients have relatively sparse connectivity in the left hemisphere (the right part of the AD network in Figure 8 (a) due to the projection method). It appears that the connectivity of the left parietal lobe breaks down the most. We further confirmed this hypothesis by using the network contrast interaction. As shown in Figure 8(b) , most of the large differences between the two population groups were located in the intra-or inter-parietal lobe connectivity subnetworks. A matrix reorder operation was also applied to place the ROIs with the largest differences in the center of each lobe matrix. This became clearer when we switch to the left sagittal view (Figure 9(a) ). Another observations was that the AD patients appeared to have thicker connectivity pattern between the right insula (ROI #36) and the right parietal/frontal lobes, though this finding needs to be validated from a statistical standpoint (Figure 8(b), Figure 9(b) ).\nIn the second case study, we deployed our visualization on the 113-subject brain networks from the Open Connectome project [1] . The raw brain networks were also defined using 70 ROIs in FreeSurfer based on the Desikan-Killiany atlas. Due to the higher resolution DWIs and possibly, difference in the processing methods, both the scale and distribution of the connectivity patterns appeared different from those in the ADNI data set (which is expected). In this case, we compared the subject's brain network using their Composite Creativity Index (CCI), which assesses the creativity of subjects in ten different domains (e.g., visual arts, music, etc.) through a questionnaire. The CCI score is normally distributed in population and we classified the scores into two classes for the comparison tasks: the high class with CCI higher than or equal to 100 (the average across populations) and the low class smaller than 100. Our goal was to validate the results from the seminal work by Flaherty [16] who showed that the frontal and temporal lobes are important areas involved in creative thinking and expression. Again, we started the analysis by displaying the brain networks of the CCI high vs. low population groups. The comparison view is further optimized by applying the network contrast and matrix reordering operation. As illustrated in Figure 10 , it is visible that the frontal and temporal lobe connectivity patterns are stronger in the high-CCI group than in the low-CCI group.\nIn recent work [27] [13], scientists found linkage between the prefrontal lobe and the creative mind and problem solving tendency. We reproduced this discovery by incorporating the optimal ROI clustering into the visualization design. As shown in Figure 1 , the sub-cluster corresponding to the prefrontal lobe in the frontal matrix reveals much stronger connectivity vs. the other lobes in the contrast view."}, {"section_title": "CONCLUSION AND FUTURE WORK", "text": "In this paper, we have presented an integrated visual analytics method for comparing blockwise brain network differences among population groups, a highly relevant task for clinical research aimed at visualizing the network of human brains. Existing visual representations such as node-link graph and adjacency matrix suffer from low accuracy when comparing real-life brain networks that are homogeneous and densely interconnected. We tackle this problem by proposing: 1) a greedy ROI clustering algorithm driven by the predictive classification performance; 2) an improved NodeTrix design for displaying the blockwise brain network connectivity patterns; and 3) a suite of customized interactions to accelerate the visual comparison between groups of interest. Visual clutter reductions and the linkage to the underlying fiber tract data are achieved by two edge bundling algorithms considering the separate semantic and geometric information. We demonstrate the effectiveness of our method in blockwise brain network visual comparison by both controlled user experiment in contrast to state-of-the-art visualization methods, and case studies on real-world brain networks.\nDespite the success of our method in visually comparing brain networks within the studied scope, there are several unsolved challenges due to the enormous complexity and uncertainty of real-world human brain networks. First, the current NodeTrix design supports up to two levels of network hierarchy, while the high-resolution human connectome can carry many more hierarchies, ranging from block and ROI level to voxel and neuronal level. One aspect of our future work is to explore new visualization and interaction designs to address this practical challenge. Second, in this work we only consider the pairwise side-by-side comparison of brain networks. In fact, many diagnostic classes are not bilateral, and comparisons are conducted among more than two groups. We plan to study how the proposed method can be extended to work with a multiple-comparison scenario. Finally, our method can be extended to support the visual comparison of many other geospatial networks (e.g., dynamic traffic and migration networks), on which there are inherent blockwise connectivity patterns and the network node positions are geospatially fixed."}]
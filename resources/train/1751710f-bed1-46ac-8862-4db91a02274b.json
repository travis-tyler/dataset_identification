[{"section_title": "Abstract", "text": "Abstract. Skull-stripping refers to the separation of brain tissue from non-brain tissue, such as the scalp, skull, and dura. In large-scale studies involving a significant number of subjects, a fully automatic method is highly desirable, since manual skull-stripping requires tremendous human effort and can be inconsistent even after sufficient training. We propose in this paper a robust and effective method that is capable of skull-stripping a large number of images accurately with minimal dependence on the parameter setting. The key of our method involves an initial skull-stripping by co-registration of an atlas, followed by a refinement phase with a surface deformation scheme that is guided by prior information obtained from a set of real brain images. Evaluation based on a total of 831 images, consisting of normal controls (NC) and patients with mild cognitive impairment (MCI) or Alzheimer's Disease (AD), from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database indicates that our method performs favorably at a consistent overall overlap rate of approximately 98% when compared with expert results. The software package will be made available to the public to facilitate neuroimaging studies."}, {"section_title": "Introduction", "text": "Automated skull-stripping is an indispensible tool for large-scale multi-site studies, such as the Alzheimer's Disease Neuroimaging Initiative (ADNI) [1] , where thousands of MRI scans need to be processed. An accurate and highly automated algorithm is hence highly desirable, preferably avoiding any form of human intervention that can possibly cause bias and inter-expert differences. The inaccuracy of skull-stripping may result in error in cortical thickness estimation, volumetric analysis, brain atrophy estimation, and registration between structural and functional images (fMRI and PET). For instance, the unremoved dura can result in an overestimation of cortical thickness [2] , whereas the unintended removal of brain tissue may lead to underestimation of cortical atrophy. These errors cannot be recovered in subsequent processing stages. The existing skull-stripping methods can generally be divided into three categories: 1) morphology-based methods, 2) surfacebased methods, and 3) meta methods.\nMorphology-based methods extract the brain through a series of thresholding and morphological operations [3, 4] . In [4] for example, a heuristic approach utilizing thresholding, morphological opening, and connected component analysis is devised to deal with specific problems encountered in skull-stripping. Another popular method is the Brain Surface Extractor (BSE) [5] , which removes non-brain tissue using a combination of anisotropic diffusion filtering, edge detection, and mathematical morphology. Also, a 3D watershed transform, modified by combining pre-flooding to avoid over-segmentation, is proposed in [6] . A graph cuts based method is introduced in [7] , utilizing intensity thresholding followed by removal of narrow connection using a graph theoretic image segmentation technique. While some published approaches are effective, morphology-based methods generally involve some degree of user interaction, and are also sensitive to the scanning parameters and intensity inhomogeneity.\nSurface-based methods rely mainly on the image gradient information to locate the brain surface, which is modeled by an active contour. In [8] , a tessellated ellipsoidal template is deformed to the inner surface of the skull, and is then iteratively deformed using forces derived from image gradients and a curvature constraint. Brain Extraction Tool (BET) [9] uses a deformable model that evolves a surface to fit the brain boundary by application of a set of locally adaptive forces. These forces account for surface smoothness and voxel intensity changes in the surface vicinity. Hybrid Watershed Algorithm (HWA) [10] combines watershed algorithm developed in [6] with a deformable-surface model, using surface curvature and statistics of the distance of the surface to the center of gravity (COG) to detect and correct inaccuracies in brain extraction. The above-described methods are generally more robust and less sensitive to image artifacts, and require less human interaction. However, these methods require that the initial active contour should be close enough to the targeted surface to avoid local minima; and failure to meet this requirement can cause unpredictable results.\nMeta methods combine various skull-stripping methods for achieving the best outcome [11, 12] . However, they rely heavily on the component methods and do not solve the fundamental problems pertaining to these methods.\nDue to the presence of imaging artifacts, anatomical variability, and varying contrast properties, most of these techniques, however, do not give satisfactory results over a wide range of scan types and neuroanatomies without some form of manual intervention. In this paper, we focus on a surface-based method, since it gives us the flexibility of incorporating both surface geometry and atlas-based prior information into the skull-stripping process. For a good initial extraction of the brain, we utilize FLIRT [13] and Demons-based registration [14] to warp an atlas, and hence its brain mask, to the targeted image for initial skull-stripping. We then employ a probability map, incorporating prior information gathered from a population of real brain images with manual extractions, to guide surface evolution for refinement of the skullstripping result. This allows us to guide the skull-stripping process using realistic shape and topological constraints to weight the forces in driving surface deformation, thus giving us more accurate and consistent results over a large number of images."}, {"section_title": "Method", "text": "The skull-stripping method consists of the following steps: 1) Initialization by warping an atlas to the target image, where the brain mask for the atlas is used for Robust Deformable approximate skull-strippin deformable-surface, guided images. The details are give"}, {"section_title": "Initialization", "text": "A good initialization of the and suboptimal solutions. T positioning of the initial a algorithm [14] are employe works especially well in t weighted MR image, the br fluid (CSF) level intensity, contrast for alignment. We target image and then use th over-skull-stripping, as an i deformable-surface-based a"}, {"section_title": "Deformable-Surface-", "text": ""}, {"section_title": "Brain Probability M", "text": "A probability map, indicati the brain tissue, is obtained we utilize the ICBM temp (with skulls) are aligned fi [14] . The manually delinea space using the same set o evaluate for each voxel t computing the fraction of b is, for each point , , , th represents the -th brain m probability map has a valu where the voxel membershi target image to guide skullhelps greatly restrict the e chance of it falling in a less Fig. 1 . Brain probability m e-Surface-Based Skull-Stripping for Large-Scale Studies ng, and 2) Refinement of the former result with d by a brain probability map generated from a set of r en in the following. deformable surface is important for avoiding local mini To facilitate more accurate parameter estimation for be active contour, FLIRT [13] and the Demons registrat ed to help mask out non-brain voxels. Demons registrat the image regions with clear intensity changes. In a rain boundary appears as a surface with low cerebrospi compared with the GM and the skull, thus providing go e first register the ICBM template (with skull) [15] to he accompanying brain mask, which is dilated for avoid initial skull-stripping, which will be further refined usin approach as described below."}, {"section_title": "-Based Skull-Stripping", "text": "Map ing the likelihood of whether a voxel belongs to a par from a set of manually skull-stripped images. Specifica plate as the reference image, onto which a set of ima rst linearly (FLIRT) [13] and then non-linearly (Demo ated brain masks of the images are warped to the temp of transformations. From the aligned brain masks, we the probability that it belongs to the brain by sim rain masks that consider this voxel a part of the brain. T he probability is , , \u2211 , , / , where mask out of a total of . From Fig. 1 , we can see that ue of 1 for the majority of the brain, except the bound ips are ambiguous. This probability map is warped onto -stripping using a deformable surface. The probability m xtent of deformation of the surface, thus minimizing s desirable region. "}, {"section_title": "Surface Deformation", "text": "Following the work of Smith [9] , the implementation 1 of the evolution equation is accomplished with a parametric active contour. The brain boundary is modeled by a surface tessellated using connected triangles. The surface deformation is driven by three main forces: 1) force from the smoothness constraint, 2) force from the intensity gradient in the surface vicinity, and 3) force from the brain probability map.\nThe force pertaining to the smoothness constraint consists of two parts: ,\nwhere and are the tangential and normal components of . is the difference vector between the positions of the current vertex and its mean neighboring vertices, i.e.,\nwhere is the surface outward normal at current vertex , is the number of neighboring vertices, and is the -th neighboring vertex. The sole role of the tangent force is to keep all vertices in the surface equally spaced, i.e., moving them only within the surface. The normal force is a curvature-reducing force to ensure smoothness of the surface during the evolution process. Usually is set as 0.5. To ensure that the surface is sufficiently smooth and meanwhile avoids underestimation of curvature at parts of the surface, is a nonlinear function adaptive to local surface geometry. For this purpose, we need first to determine the local radius of curvature :\n/ 2| | , where is the mean distance from vertex to neighboring vertices over the whole surface. Weight is then defined using a sigmoid function:\nwith 0.5 1 1 \u2044 \u2044 and 6/ 1 1 \u2044 \u2044 . Here, the values for and are empirically optimized for typical geometries in the human brain and are set as 3.33 mm and 10 mm, respectively. High local mean surface curvature is hence penalized to achieve surface smoothing.\nThe second force is derived from the image intensity information:\n,\nwhere and are the minimum and maximum of local intensities quantified along the normal direction pointing inward from the current vertex:\nThe search range pertaining to the minimum and maximum intensities are and , respectively. Typically, is set as 20 mm and /2. Here the image intensity minimum , the median intensity , and the threshold that separates brain and non-brain matter are approximately estimated according to the cumulative intensity histogram of the brain image. They're used to avoid voxels that are too dark or too bright.\nin Equation (4) is a locally estimated intensity threshold which is used to distinguish between brain and non-brain:\n. (5) Parameter is called the fractional intensity threshold and falls between the range of 0 and 1. The third force is derived from the brain probability map obtained in Section 2.2.1:\nwhere 0,1 is the probability value from the map. At a point where the surface is close to the brain boundary, 0.5, and is small; when 0.5, the point is likely within the brain, and an outward force is exerted; when 0.5, a inward force is exerted. This restricts the searching of the brain boundary in this range and drives it to find the true boundary. is directly added to with a certain weight , which we set as 1 here. Both of them act in the direction of . Thus, for each vertex at iteration , the update equation is: ,\nwhere 0.05 ."}, {"section_title": "Experimental Results", "text": ""}, {"section_title": "Dataset", "text": "The proposed algorithm was evaluated based on the ADNI dataset. Subjects were recruited from over 50 sites across the U.S. and Canada. MRI scans were acquired using GE, Philips, and Siemens scanners. The baseline T1-weighted MRI scans of 831 subjects (230 NC, 403 MCI, 198 AD; ages range: 55~90 years) were used in this work. We randomly selected images of 25 subjects from each group for generating the respective probability maps; the rest of the images were used as testing data for evaluation of all considered methods. For consistency, all images were resampled to be of dimensions 256\u00d7256\u00d7256 and resolution 1\u00d71\u00d71 mm 3 . Nonparametric nonuniform intensity normalization (N3) [16] was performed for correcting the intensity inhomogeneity."}, {"section_title": "Qualitative Evaluation", "text": "The following 5 methods were evaluated: 1) BET, 2) BET-B: BET with bias field correction and neck cleanup (option \"-B\"), 3) BSE, 4) HWA, and 5) the proposed method. Let and represent the extracted brain image and the manually skullstripped image, respectively. We measured their similarity using the Dice ratio: ; HWA, the default parameters with or without \"-less\", \"-more\", \"-atlas\", \"-less -atlas\" or \"-more -atlas\" were used. For the proposed method, a fractional intensity threshold value of 0.6 was used for all images. Typical results given by these 5 methods are shown in Fig. 2 . For the image of Fig. 2 , the best parameters selected are listed below: BET, fractional intensity threshold = 0.75; BET-B, fractional intensity threshold = 0.4, option \"-B\" turned on; BSE, diffusion constant = 5, edge detection constant = 0.7, diffusion iterations = 3; HWA, the default parameters were used; the proposed method, fractional intensity threshold = 0.6. The arrows in Fig. 2 highlight several problematic areas. BET typically over skull-strips the anterior frontal cortex, anterior temporal cortex, posterior occipital cortex, and the cerebellar areas. BSE typically leaves some dura unremoved in these regions. HWA retains most of the brain tissue, but leaves some dura intact. The proposed method successfully overcomes all these problems. "}, {"section_title": "Quantitative Evaluation", "text": "Similar to the qualitative evaluation, we compared the proposed method with BET, BET-B, BSE and HWA. And for each method compared, except our method, the optimal parameters for each image were selected as described in Section 3.2. For the proposed method, a fractional intensity threshold value of 0.6 was used for all images as described in Section 3.2. As can be appreciated from Fig. 3 , the proposed method yields consistently the best results when compared with all other methods, despite the fact that one single set of parameters was used for all images, whereas optimized parameters were used for other methods. Fig. 4 shows that the performance of the proposed method is insensitive to different fractional intensity threshold values. Of note, on a 2.8 GHz machine, the proposed method took approximately 2 minutes for registration using FLIRT and Demons, and an extra 1 minute for skull-stripping an image. Other methods typically took 60-70 seconds, except for BET when used with option \"-B\", which typically took 20-30 minutes.\n(NC) (MCI) (AD) "}, {"section_title": "Conclusion", "text": "We have proposed in this paper a robust and effective skull-stripping method that is capable of skull-stripping a large number of images automatically without human intervention. Our method combines an atlas-based approach, for coarse skullstripping, with a deformable-surface-based approach, for more localized refinement.\nExperimental results indicate that our method yields highly consistent results using only a set of fixed parameters. The software package will be released to the public for facilitating neuroimaging studies."}]
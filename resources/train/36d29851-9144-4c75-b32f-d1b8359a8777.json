[{"section_title": "Abstract", "text": "Visualization plays a vital role in the analysis of multi-modal neuroimaging data. A major challenge in neuroimaging visualization is how to integrate structural, functional and connectivity data to form a comprehensive visual context for data exploration, quality control, and hypothesis discovery. We develop a new integrated visualization solution for brain imaging data by combining scientific and information visualization techniques within the context of the same anatomic structure. New surface texture techniques are developed to map non-spatial attributes onto the brain surfaces from MRI scans. Two types of non-spatial information are represented: (1) timeseries data from resting-state functional MRI measuring brain activation; (2) network properties derived from structural connectivity data for different groups of subjects, which may help guide the detection of differentiation features. Through visual exploration, this integrated solution can help identify brain regions with highly correlated functional activations as well as their activation patterns. Visual detection of differentiation features can also potentially discover image based phenotypic biomarkers for brain diseases."}, {"section_title": "Introduction", "text": "Human connectomics [1] is an emerging field that holds great promise for a systematic characterization of human brain connectivity and its relationship with cognition and behavior. The analysis of human brain connectome networks faces two major challenges: (1) how to reliably and accurately identify connectivity patterns related to cognition, behaviour and also to neurological conditions based on an unknown set of network characterization and features; (2) how to seamlessly integrate computational methods with human knowledge and how to translate this into user-friendly, interactive software tools that optimally combines human expertise and machine intelligence to enable novel contextually meaningful discoveries. Both challenges require the development of highly interactive and comprehensive visualization tools that can guide researchers through a complex sea of data and information for knowledge discovery.\nScientific visualization has long been playing an important role in neuroimaging data analysis, by rendering detailed 3D anatomic structures from modalities such as magnetic resonance imaging (MRI) and diffusion tensor imaging (DTI) scans. Example studies include DTI fiber tract visualization [4] [5] [6] [7] [8] [9] , network visualization [10] [11] [12] [13] , and multi-modal data visualization [14] [15] [16] . In this context, recent development in information visualization provides new ways to visualize non-structural attributes or in-depth analysis data, such as graph/network visualization and time-series data visualization. These, however, are usually separate visual representations away from the anatomic structures. In order to maximize human cognitive abilities during visual exploration, we propose to integrate the visual representations of the connectome network attributes onto the surfaces of the anatomical structures of human brain. Multiple visual encoding schemes, combined with various interactive visualization tools, can provide an effective and dynamic data exploration environment for neuroscientists to better identify patterns, trends and markers."}, {"section_title": "Brain Imaging Data and Connectome Construction", "text": "The MRI and DTI data used in the preparation of this article were obtained from the Alzheimers Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). The ADNI was launched in 2003 as a public-private partnership, led by Principal Investigator Michael W. Weiner, MD. The primary goal of ADNI has been to test whether serial MRI, positron emission tomography (PET), other biological markers, and clinical and neuropsychological assessment can be combined to measure the progression of mild cognitive impairment (MCI) and early Alzheimers disease (AD). For up-to-date information, see www.adni-info.org.\nWe downloaded the baseline 3T MRI (SPGR) and DTI scans together with the corresponding clinical data of 134 ADNI participants, including 30 cognitively normal older adults without complaints (CN), 31 cognitively normal older adults with significant memory concerns (SMC), 15 early MCI (EMCI), 35 late MCI (LMCI), and 23 AD participants. In our multi-class disease classification experiment, we group these subjects into three categories: Healthy Control (HC, including both CN and SMC participants, N=61), MCI (including both EMCI and LMCI participants, N=50), and AD (N=23).\nUsing their MRI and DTI data, we constructed a structural connectivity network for each of the above 134 participants. Our processing pipeline is divided into three major steps described below: (1) Generation of regions of interest (ROIs), (2) DTI tractography, and (3) connectivity network construction."}, {"section_title": "(1) ROI Generation", "text": "Anatomical parcellation was performed on the high-resolution T1-weighted anatomical MRI scan. The parcellation is an automated operation on each subject to obtain 68 gyral-based ROIs, with 34 cortical ROIs in each hemisphere, using the FreeSurfer software package (http://freesurfer.net/). The Lausanne parcellation scheme [17] was applied to further subdivide these ROIs into smaller ROIs, so that brain networks at different scales (e.g., N roi = 83, 129, 234, 463, or 1015 ROIs/nodes) could be constructed. The T1-weighted MRI image was registered to the low resolution b0 image of DTI data using the FLIRT toolbox in FSL, and the warping parameters were applied to the ROIs so that a new set of ROIs in the DTI image space were created. These new ROIs were used for constructing the structural network."}, {"section_title": "(2) DTI tractography", "text": "The DTI data were analyzed using FSL. Preprocessing included correction for motion and eddy current effects in DTI images. The processed images were then output to Diffusion Toolkit (http://trackvis.org/) for fiber tracking, using the streamline tractography algorithm called FACT (fiber assignment by continuous tracking). The FACT algorithm initializes tracks from many seed points and propagates these tracks along the vector of the largest principle axis within each voxel until certain termination criteria are met. In our study, stop angle threshold was set to 35 degree, which meant if the angle change between two voxels was greater than 35 degree, the tracking process stopped. A spline filtering was then applied to smooth the tracks."}, {"section_title": "(3) Network Construction", "text": "Nodes and edges are defined from the previous results in constructing the weighted, undirected network. The nodes are chosen to be N roi ROIs obtained from Lausanne parcellation. The weight of the edge between each pair of nodes is defined as the density of the fibers connecting the pair, which is the number of tracks between two ROIs divided by the mean volume of two ROIs [18, 19] . A fiber is considered to connect two ROIs if and only if its end points fall in two ROIs respectively. The weighted network can be described by a matrix. The rows and columns correspond to the nodes, and the elements of the matrix correspond to the weights.\nTo demonstrate our visualization scheme for integrative exploration of the time-series of resting-state fMRI (rs-fMRI) data with brain anatomy, we employed an additional local (non-ADNI) subject, who was scanned in a Siemens PRISMA 3T scanner (Erlangen Germany). A T1-weighted sagittal MP-RAGE was obtained (TE =2.98 ms, TR partition = 2300ms, TI = 900ms, flip angle = 9, 128 slices with 111mmvoxels). A resting-state session of 10 minutes was also obtained. Subject was asked to stay still and awake, and to keep eyes closed. BOLD acquisition parameters were: TE = 29ms, TR = 1.25s, Flip angle = 79, 41 contiguous interleaved 2.5 mm axial slices, with in-plane resolution = 2.5 2.5 mm. BOLD time-series acquired were then processed according to the following steps (for details see [20] ): mode 1000 normalization; z-scoring and detrending; regression of 18 detrended nuisance variables (6 motion regressors [X Y Z pitch jaw roll], average gray matter (GM), white matter (WM) and cerebral spinal fluid (CSF) signals, and all their derivatives computed as backwards difference); band-pass filter of 0.009 to 0.08 Hz using a zero-phase 2nd order Butterworth filter; spatial blurring using a Gaussian filter (FWHM=2mm); regression of the first 3 principal components of WM (mask eroded 3 times) and CSF (ventricles only, mask eroded 1 time). The Desikan-Killiany Atlas (68 cortical ROIs, as available in the Freesurfer software) was registered to the subject. The resulting processed BOLD time-series where then averaged for each ROI. Note that the Lausanne parcellation scheme (mentioned above) at the level of N roi = 83 consists of the above 68 cortical ROIs together with the brain stem (as 1 ROI) and 14 subcortical ROIs. As a result, we will use 68 time series (one for each cortical ROI) in our time series visualization experiments."}, {"section_title": "Information Visualization: Methods and Results", "text": "In this section, we propose a few information visualization methods. Using the VTK (www.vtk.org) C++ library, we have implemented and packaged these methods into a software tool named as BECA, standing for Brain Explorer for Connectomic Analysis. A video has been made to demonstrate the proposed methods and is available at http:// www.iu.edu/~beca/bih15_demo.mp4."}, {"section_title": "Visualizing Structural Connectivity Networks", "text": "3D visualization of a connectivity network within an anatomical structure can provide valuable insight and better understanding of the brain networks and their functions. In a brain connectome network, we render nodes as ROI surfaces, which are generated using an iso-surface extraction algorithm from the MRI voxel sets of the ROIs. Drawing the network edges is, however, more challenging since straight edges will be buried inside the brain structures. We apply the cubic Bezier curves to draw curved edges above the brain structure. The four control points of each edge are defined by the centers of the ROI surfaces and the extension points from the centroid of the brain, as shown in Figure 1a . Figure 2 shows visualization examples of a connectome network, along with the cortical surface, the ROIs, and the DTI fibers."}, {"section_title": "Visualizing Network Attributes with Textural Mapping", "text": "Brain connectivity networks obtained through the above pipeline can be further taken into complex network analysis. Network measures (e.g., node degree, betweenness, closeness) can be calculated from individuals or average of a population. Different measures may characterize different aspects of the brain connectivity [21] . In order to visualize these network attributes, we propose a surface texture based approach. The main idea is to take advantage of the available surface area of each ROI, and encode the attribute information in a texture image, and then texture-map this image to the ROI surface. Since the surface shape of each ROI (as a triangle mesh) is highly irregular, it becomes difficult to assign texture coordinates for mapping the texture images. We apply a simple projection plane technique. A projection plane of an ROI is defined as the plane with a normal vector that connects the center of the ROI surface and the centroid of the entire brain. The ROI surface can then be parallelly projected onto its projection plane, and the reverse projection defines the texture mapping process. Thus, we can define our attribute-encoded texture image on this project plane to depict a visual pattern on the ROI surface. Visually encoding attribute information onto a texture image is an effective way to represent multiple attributes or time-series attributes. Below we will demonstrate this idea in two different scenarios: Time-series data from rs-fMRI and multi-class disease classification."}, {"section_title": "Visualizing fMRI Data and Functional Connectivity", "text": "As a functional imaging method, rs-fMRI can measure interactions between ROIs when a subject is resting [22] . Resting brain activity is observed through changes in blood flow in the brain which can be measured using fMRI. The resting state approach is useful to explore the brain's functional organization and to examine if it is altered in neurological or psychiatric diseases. Brain activation levels in each ROI represent a time-series that can be analyzed to compute correlations between different ROIs. This correlation based network represents the functional connectivity networks and, analogously to structural connectivity, it may be represented as a square symmetric matrix.\nUsing the surface texture mapping approach, we need to first encode this time-series data on a 2D texture image. We propose an offset contour method to generate patterns of contours based on the boundary of each projected ROI. The offset contours are generated by offsetting the boundary curve toward the interior of the region, creating multiple offset boundary curves (Figure 1b ). There are several offset curve algorithms available in curve/ surface modeling. Since in our application, the offset curves do not need to be very accurate, we opt to use a simple image erosion algorithm [23] directly on the 2D image of the map to generate the offset contours.\nIn time-series data visualization, the time dimension can be divided into multiple time intervals and represented by the offset contours. Varying shades of a color hue can be used to represent the attribute changes over time. Figure 3 shows the steps for constructing the contour-based texture. First, we map each ROI onto a projection plane perpendicular to the line connecting the centroid of the brain and the center of this ROI. The algorithm then iteratively erodes the mapped shape and assigns colors according to the activity level of this ROI at each time point. Lastly we overlay the eroded regions to generate a contour-based texture. We also apply a Gaussian filter to smooth the eroded texture image to generate more gradual changes of the activities over time. Figure 4 shows a few examples of the offset contours mapped to the ROIs. The original data has 632 time points, which will be divided evenly across the contours depending on the number of contours that can be fitted in to the available pixels within the projected ROI."}, {"section_title": "Visualizing Discriminative Patterns among Multiple Classes", "text": "In this case study, we performed the experiment on the ADNI cohort mentioned before, including 61 HC, 50 MCI and 23 AD participants. The goal is to generate intuitive visualization to provide cognitively intuitive evidence for discriminating ROIs that can separate subjects in different classes. This can be the first step of a diagnostic biomarker discovery process.\nThe goal of the visual encoding in this case is to generate a color pattern that can easily distinguish bias toward any of the three classes. To do so, we first assign a distinct color to each class. Various color patterns can be generated using different color blending and distribution methods. In our experiment, a noise pattern is applied with 3 colors representing the 3 classes. The same noise pattern approach can also accommodate more colors.\nSince color blending is involved in a noise pattern, we choose to use an RYB color model, instead of the RGB model. This is because color mix using RYB model is more intuitive in a way that the mixed colors still carry the proper amount of color hues of the original color components. For example, Red and Yellow mix to form Orange, and Blue and Red mix to form Purple. Thus, RYB model can create color mixtures that more closely resemble the expectations of a viewer. Of course these RYB colors still need to be eventually converted into the RGB values for display. For the conversion between these two color models, we adopt the approach proposed in [24, 25] , in which a color cube is used to model the relationship between RYB and RGB values. For each RYB color, its approximated RGB value can be computed by a trilinear interpolation in the RYB color cube.\nWe first construct noise patterns to create a random variation in color intensity, similar to the approach in [24] . Different color hues are used to represent the attributes in different classes of subjects. Any network measurement can be used for color mapping. In our experiment, we use the node degrees averaged across subjects in each class. A turbulence function [26] is used to generate the noise patterns of different frequencies (sizes of the sub-regions of the noise pattern). Figure 5 shows some examples of the texture mapped views of the three classes: HC (Red), MCI (Yellow) and AD (Blue). The colors of the edges also represent the blended RYB color values, based on the average edge weights in the three classes. From the resulting images, we can identify a specific ROI that exhibits bias toward one or two base colors. This can be a potential indication that this ROI may be a good candidate for further analysis as a potential imaging phenotypic biomarker."}, {"section_title": "Conclusions", "text": "We have presented an integrated visualization solution for human brain connectome data. Multiple modalities of images are involved including MRI, DTI and fMRI. Our focus is on the integration of analysis properties of the connectome networks into the anatomical brain structures. We apply a surface texture based approach to encode network properties and attributes onto the surfaces of the brain structures to establish visual connections and context. Surface texture is an effective approach to integrate information visualization and scientific visualization since scientific data typically have spatial structures containing surface areas, which can be taken advantage of for visual encoding.\nIn the future, we would like to continue developing the integrated visualization tool for public domain distribution, and the proposed BECA software tool will be available at http:// www.iu.edu/~beca/. We would also like to study interesting visual analytic topics to compare multiple networks from different network construction procedures, in particular, between structural networks and functional networks. Some examples of a connectome network with time-series data. Various transparencies are applied. "}]
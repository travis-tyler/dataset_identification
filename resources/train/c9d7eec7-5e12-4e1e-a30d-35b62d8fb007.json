[{"section_title": "Abstract", "text": "A two-way nested grid version of the Geophysical Fluid Dynamics Laboratory High Resolution Atmosphere Model (HiRAM) has been developed that uses simple methods for providing nested grid boundary conditions and mass-conserving nested-to-global communication. Nested grid simulations over the Maritime Continent and over North America were performed, each at two different resolutions: a 110-km mean grid cell width refined by a factor of 3, and a 50-km mean grid cell width refined by a factor of 2. Nested grid simulations were compared against uniform-resolution simulations, and against reanalyses, to determine the effect of grid nesting on both the modeled global climate and the simulation of small-scale features.\nOrographically forced precipitation was robustly found to be simulated with more detail and greater realism in a nested grid simulation compared with when only the coarse grids were simulated alone. Tropical precipitation biases were reduced in the Maritime Continent region when a nested grid was introduced. Both results were robust to changes in the nested grid parameterization tunings. In North America, cold-season orographic precipitation was improved by nesting, but precipitation biases in the central and eastern United States were little changed. Improving the resolution through nesting also allowed for more intense rainfall events, greater Kelvin wave activity, and stronger tropical cyclones. Nested grid boundary artifacts were more pronounced when a one-way, noninteractive nested grid was used."}, {"section_title": "Introduction", "text": "Regional climate models (RCMs; Christensen et al. 2007 ) typically use a limited-area numerical model, such as the Weather Research and Forecasting model (WRF; Skamarock et al. 2005) or the Regional Climate Model (RegCM; Giorgi et al. 2012) , with lateral boundary supplied by either a reanalysis or a global climate simulation. However, the boundary conditions are often available only at 6 h or longer intervals. The model used to produce the boundary conditions may be very different from the limited-area model used: the two models may use different numerical methods, different parameterizations, or even different dynamical equations. This inconsistency between models could cause errors that may propagate into the interior of the domain and contaminate the solution. The limited-area model cannot feed back onto the global domain, thereby preventing phenomena that modify their large-scale environment-especially tropical cyclones, orography, and deep convection-from correctly doing so. Highly idealized models (Harris and Durran 2010 , and references therein), anecdotal experience, and the general supposition of the numerical weather prediction community (Warner et al. 1997, and references therein) suggest that a lack of feedback between the large-and small-scale domains could cause additional errors in the limited-area domain.\nProblems with lateral boundary conditions can be avoided by using a uniformly high-resolution global grid, but this is often impractical for many purposes given current computational limitations. A number of strategies have been considered for local refinement of a global grid, to reduce the computational overhead compared to a uniformly high-resolution simulation.\nGrid stretching (Fox-Rabinovitz et al. 2006 ) is a very common technique to locally improve the resolution of the global grid by applying some transformation (cf. Schmidt 1977) to the global grid. The grid is still topologically the same as the undeformed grid. There are no boundary conditions to be satisfied and data are communicated between the refined region and the rest of the domain every time step. Depending on the stretching method the refinement may be so gradual that the resolution may go from coarsest to finest over a very broad region, and few if any grid artifacts can be seen even in highly idealized simulations designed to bring out these artifacts. However, a single stretched grid uses a single time step and single set of parameterization tunings. The time step is restricted by the highest-resolution region, and the parameterization tunings must be chosen as a compromise between those appropriate for the highest-resolution region and those for the lowestresolution region, unless scale-aware parameterizations are used. Also, depending on the stretching method, enhancing the resolution over one region may decrease it over another region of the domain, and errors created in the degraded-resolution region may propagate into the higher-resolution region.\nAnother method is to use an unstructured grid (cf. Thuburn et al. 2009; Ringler et al. 2011; Rauscher et al. 2013 ) that has a higher resolution over the region(s) of interest. Unstructured grids are highly flexible but require numerical methods designed specifically for unstructured grids, and saving the indices of neighboring grid cells introduces additional overhead compared to the simple array indexing available to regular locally Cartesian grids.\nA third method, grid nesting, uses a limited-area nested model domain with boundary data supplied from the coarse global grid, which are updated at a high frequency (,1 h). Two-way nesting periodically replaces the global grid's solution with the nested grid's solution where the two grids coincide, allowing feedback onto the global domain. Unlike limited-area RCMs, the nested grid uses the same solver as the global grid, avoiding the problem of model inconsistency between the two domains; as in limited-area RCMs, the abrupt refinement at the nested grid boundary can introduce error. Grid nesting is more flexible than stretching, although less so than an unstructured grid: a nested grid does not alter the structure of the global grid; any size nested grid can be used, in principle; and multiple nests can be used, including nests inside one another.\nA major advantage of grid nesting compared to stretched or unstructured grids is that many model settings can be chosen separately on the two grids. The time step can be chosen independently on each grid, and the global grid's time step is not restricted by the nested grid resolution. Physical parameterizations can also be tuned appropriately for each grid's resolution and location. For example, the strongly resolution-dependent entrainment and autoconversion parameters in the convective parameterization can be chosen separately on each grid to be values appropriate for that grid's resolution; or, if the nested grid has sufficiently high resolution, the deep convective parameterization could be disabled entirely.\nVery few global models have used two-way nesting. Lorenz and Jacob (2005) presented a two-way nested climate simulation with its nest centered over the Maritime Continent. They found zonal-mean summertime tropical troposphere temperature biases half of those in a uniform-resolution simulation. found a local improvement of temperature biases in a two-way nested simulation of eastern China, but did not indicate any effect upon larger-scale features.\nA two-way, global-to-regional nested grid version of the Geophysical Fluid Dynamics Laboratory (GFDL) finite-volume, cubed-sphere dynamical core (FV 3 ) was described in Harris and Lin (2013) . This form of grid nesting uses a simple interpolated boundary condition and a simple averaging two-way nested-to-global interaction. Coarse-grid air mass is conserved in two-way updating by simply not using the nested-grid air mass on the coarse grid-only the winds and temperature are updated to the coarse grid. Owing to the simple methodology, little degradation of the large-scale solutions was found in idealized shallow-water tests and in the three-dimensional Held and Suarez (1994) test, and identifiable improvements of small-scale features were found in the nested grid region.\nIn this paper, we describe the use of the nested dynamical core for climate simulation in the GFDL High Resolution Atmospheric Model (HiRAM) and evaluate the solutions against uniform-resolution simulations and reanalyses. We primarily evaluate regional and smallscale details of precipitation in the nested simulations given the importance of precipitation in many climate projections, as well as the availability of high-quality, high-resolution precipitation datasets against which the solutions can be compared. We also demonstrate that the global zonal-mean climate of the simulations are not degraded by introducing a nested grid. We aim to demonstrate that grid nesting can improve the local details compared to when their parent grids alone are used. We focus on grid nesting in two regions: the Maritime Continent, where there is substantial intense convection that affects the general circulation, and North America, where there is a substantial interest in regional climate changes.\nSection 2 describes HiRAM and the grid nesting methodology. Section 3 describes the simulation design and motivation. Section 4 describes the global climate of the nested simulations and compares them to the (quasi-) uniform simulations, and then describes the regional details of precipitation in the nested regions, and describes how they compare to reanalyses and to uniform-resolution simulations. Section 5 concludes the paper and discusses prospects for further research."}, {"section_title": "Model description a. HiRAM", "text": "The GFDL HiRAM (Zhao et al. 2009 ) has been designed for efficient high-resolution simulations, with a particular emphasis on tropical precipitation and tropical cyclones Lin 2011, 2013) . HiRAM uses the hydrostatic finite-volume cubed-sphere dynamical core described in Putman and Lin (2007) , Harris and Lin (2013) , and references therein. HiRAM solves the hydrostatic primitive equations, in flux form for scalars (including potential temperature) and in vector-invariant form for momentum, on the cubedsphere grid using the Lin and Rood (1997) algorithm in each horizontal layer extended to apply to a system with active thermodynamics. The finite-volume pressure gradient force algorithm of Lin (1997) is used. The fluxes are computed using the piecewise-parabolic method (Colella and Woodward 1984) ; the positivitypreserving constraint of Lin and Rood (1996) is enforced for air mass and tracers. The implicit diffusion from the piecewise-parabolic fluxes and the monotonicity constraint damps grid-scale noise. Further noise control is performed using fourth-order divergence damping, except for a more scale-selective sixth-order damper on c90 (see definition in next section) global grids to better preserve intermediately resolved features. Energy lost through divergence damping is restored locally as heat. Vertical mass transport is performed by the vertically Lagrangian remapping of Lin (2004) . A global energy fixer is applied on the coarse grid to restore energy lost by the dynamics. All simulations use 32 vertical levels as in Zhao et al. (2009) and have a constant-pressure top at 1 hPa.\nThe convective parameterization is the University of Washington shallow convection scheme of Bretherton et al. (2004) extended to also simulate deep convection as described in Zhao et al. (2009) . The six-category bulk microphysical scheme of Lin et al. (1983) is also used instead of a large-scale condensation scheme. The surface flux, boundary layer, orographic gravity wave drag, and radiative transfer parameterizations are the same as in the GFDL atmospheric model version 2.1 (AM2.1; Anderson et al. 2004) , although the time step at which the radiative tendencies are computed has been decreased from 3 h to 1 h, and there is no convective gravity wave drag parameterization. A simple dry convective adjustment is applied on the nested grid, to avoid explosive convection implicated in rare (about once every 10 model years) model crashes at higher resolutions. The simulations in this paper use sea surface temperatures and sea ice specified from the Hadley Centre Sea Ice and Sea Surface Temperature (HadISST; Rayner et al. 2003) 1-degree monthly dataset. Aerosols and well-mixed greenhouse gases are fixed at 1980 levels, while ozone and incoming solar radiation are time-varying; there is no volcanic aerosol, interactive chemistry, or aerosol indirect effect. All simulations use the GFDL Land Model, version 3 (Donner et al. 2011) with specified daily vegetation, although due to technical and personnel limitations the river module of the land model has been disabled."}, {"section_title": "b. Nesting methodology", "text": "The grid nesting follows that of Harris and Lin (2013) . The nested grid is a refinement of the coarse grid over a limited area of the global domain, aligned with the coarse cubed-sphere grid. The cubed-sphere grid is rotated to have a face in which the nested grid is centered. For all variables, including air mass and microphysical tracer mass, the nested grid's boundary conditions are simply the coarse grid's solution linearly interpolated into the nested grid's halo (ghost) cells. The nested and coarse grids are integrated concurrently; to permit time-evolving nested grid boundary conditions without needing to communicate boundary data every dynamical time step, the boundary conditions are extrapolated from two earlier coarse grid solutions. These boundary conditions have shown to be stable in our simulations, although a thorough analysis of the stability of the boundary conditions is beyond the scope of this article.\nIn two-way nested simulations, the coarse grid solution is periodically replaced by the nested grid solution in the region where the two grids coincide. This twoway updating is only performed for the winds and for temperature. To conserve mass on the coarse grid without needing to specify the mass fluxes at the nested grid boundary, the coarse grid air and tracer masses are not updated to the coarse grid, thereby trivially conserving mass by making no changes to the mass on the coarse grid. To be consistent with the finite-volume methodology, an area-weighted average of temperature is used to update the coarse grid cell overlying the corresponding nested grid cells, and a grid-lengthweighted average is used for the winds to update the coarse gridcell face overlying the corresponding nested gridcell faces, allowing conservation of vorticity during the update. Note that the two-way update does not conserve momentum or total energy. Since the air mass also determines the vertical coordinate, and differs on the two grids, the averaged nested grid data are interpolated from its vertical coordinate to the coarse grid's vertical coordinate using the same vertical remapping in the vertical integration step. In the regions the two grids overlie, correlation coefficients in the 30-yr simulations described below are no lower than 0.985 for precipitation and greater than 0.99 for sea level pressure and for three-dimensional specific humidity. These high correlations for these variables, none of which is altered on the coarse grid by the two-way updating process, imply that sufficient information is communicated to the coarse grid to constrain these fields to their nested grid values.\nUpdates to the boundary conditions and two-way updates can be done either on the physics time step or an integer number of times per physics time step; the last two-way update is always performed after the physics is advanced.\nIn nested grid simulations, the land grid is globally refined to match the local refinement of the nested grid. In the nested grid region the fluxes from the atmosphere into land model are chosen as those from the nested grid."}, {"section_title": "Simulation description", "text": "Two (quasi-) uniform-resolution control simulations (1g) are performed using c90 and c192 cubed-sphere grids. Here, a cN grid is one with N grid cells across a cubed-sphere face. The average grid cell widths of these grids are 110 and 50 km, respectively. These simulations are first tuned to a net annual energy surplus between 0 and 2 W m"}, {"section_title": "22", "text": ". These uniform-resolution simulations are then further tuned to attempt to improve global precipitation patterns and zonal-mean temperatures and winds. Nested grid simulations are then tuned by changing the parameterization configuration on the nested grid, while keeping the tunings on the coarse grid identical to those in the uniform-resolution control simulations, to improve precipitation patterns on the nested grid region without disturbing the global energy balance. The tuning parameters are largely those in the microphysical scheme-the prescribed cloud condensation nuclei concentrations, the assumed droplet radius, and the ice crystal terminal fall speed-and in the convective parameterization-the lateral entrainment rate, the ratio of entrainment rate between the land and ocean, and the autoconversion threshold. Additional tuning to correct stratospheric winds is done through the maximum gravity wave drag parameter and the strength of the wave-absorbing layers at the model top.\nTwo nested regions are used (Fig. 1) . The first is a nested grid over the Maritime Continent (MC), including the western Pacific warm pool; the second is a nested grid covering North America (NA) to improve regional climate details over the United States, Canada, and the Carribbean Sea. Both grids are placed so that the edge of the nests do not intersect either the steep Himalaya mountains or the Greenland ice sheet. The nests are very large, each covering nearly a full face of the cubed sphere, and thereby nearly a sixth of the global domain. Two simulations are run for each nest; a c90 coarse grid with a factor of 3 refined nested grid, and a c192 coarse grid with a factor of 2 refined nested grid. These are referred to as c90n3 and c192n2, respectively. The average gridcell width of the c90 nested grid is about 37 km. The timesteps used in all simulations are given in Table 1 . All use two-way nesting unless specifically noted to be one-way nested.\nUnless otherwise specified, all simulations are 30-yr runs forced with interannually varying HadISST sea surface temperatures and sea ice cover, following the methodology of the Atmospheric Model Intercomparison Project (AMIP; Gates et al. 1999 ). Short simulations that use climatological monthly-mean SSTs use a 1950-99 average."}, {"section_title": "Simulation results", "text": ""}, {"section_title": "a. Global mean climate", "text": "Global mean measures of the radiation budget, precipitation, and water vapor are given in Table 2 . All of the simulations have annual mean values of precipitation and water vapor path largely in line with observations and other climate models (Liu et al. 2012; Jiang et al. 2012 updated to the coarse grid demonstrate similar changes to the radiation balance. That adding a nested grid changes the radiative balance, requiring tuning of the nested grid parameters, is not surprising as the model must be retuned when the resolution is changed even in uniform-resolution simulations. The large size of the nested grid, which covers nearly one-sixth of the domain, and in the MC simulations covering much of the tropics (Fig. 1) , contributes to the size of the perturbation to the global radiation balance. Figure 2 compares the zonal-mean, annually averaged air temperature compared to the 1958-97 mean in the National Centers for Environmental Prediction (NCEP)-National Center for Atmospheric Research (NCAR) FIG. 4 . As in Fig. 2 , but for annually averaged precipitation, compared to GPCP climatology in (a). Units are mm day"}, {"section_title": "21", "text": ". In this and all following precipitation plots, green and blue colors represent low values of total precipitation or negative precipitation biases.\nreanalysis (Kalnay et al. 1996) . In all simulations the tropical temperature biases in the troposphere and stratosphere are very low, almost everywhere less than 1 K, and are slightly smaller in the c192 simulations than the c90 simulations. Temperature biases are larger in the higher latitudes; the c192 simulations have larger errors than the c90, mostly due to temperature errors in the polar vortices. Grid nesting has little effect on the errors. The root-mean-square (RMS) temperature error (Table  3) is between 1.4 and 1.5 K for the c90 simulations and between 1.65 and 1.8 for the c192 simulations; by comparison AM3 (Donner et al. 2011) Much of the error is from a too strong southern polar jet (Fig. 3) , although the southern jet is somewhat weaker in the North America nested simulations.\nThe broad pattern of precipitation errors (Fig. 4 ) is similar to those in previous HiRAM simulations and in other GFDL atmosphere models: low errors over most of the midlatitudes, too much rainfall in the oceanic ITCZ and western Pacific warm pool and over central Africa, and a dry bias over the east Indian Ocean, the American central plains, and the Amazon basin, although the dry bias in the latter is less pronounced than in previous model versions (cf. Anderson et al. 2004; Delworth et al. 2006) . The RMS error decreases in the c192 simulations, as tropical precipitation biases in particular are reduced; specific reductions in precipitation bias will be discussed in the next section. Note the absence of nested grid artifacts. (Yatagai et al. 2012 ; not shown) shows TRMM has 20%-30% less precipitation in June-September, and between 08 and 208N had greater than 15% undercatch in all months except March-May, when there was a 20%-30% overcatch. However, TRMM also had more precipitation than was found in APHRODITE between 208 and 408N latitude in all months except June-August, recording 110% more precipitation in November and nearly twice as much as did the land-based dataset in April and December. This overcatch is visible north of 258 latitude (see Fig. 7) . A 1.3 scaling factor for TRMM data is thereby justified in the tropics and in the monsoon months of June-August, although it is inappropriate for cold-season precipitation at higher latitudes; thereby the amplitude of midlatitude extrema such as the Pacific storm track off of the coast of Japan (Fig. 5a ) is likely biased high. Larger-scale and higherlatitude features can also be compared to GPCP, which is also believed to be biased low and is unable to resolve precipitation in mountainous regions.\nAnnually averaged precipitation (Fig. 5) depicts the broad precipitation patterns in the region: the ITCZ in both the Pacific and Indian Oceans, orographic precipitation in the Himalayas and on Borneo, Java, and New Guinea, and the storm track along the Kuriosho current. It is evident that as the resolution increases, the detail in the orographic precipitation improves and becomes more realistic, with better representations in the nested grid simulations than if their coarse grids alone are used. The nested grid simulations also have less precipitation over the western Pacific warm pool and a betterdefined ITCZ in the eastern Indian Ocean.\nMany features are better defined during the summer monsoon months (Fig. 6) . The fine structures in the Himalayas are much better resolved in the nested simulations than in the c90 and c192 single-grid simulations, as are the mountains on New Guinea. The large precipitation biases in the western Pacific in the single-grid simulations are largely alleviated in the nested grid simulations, and the bias in the South China Sea is decreased by a more modest amount in the nested simulations. The nested simulations have more precipitation over the Bay of Bengal, although it is shifted too far inland over Myanmar compared to TRMM. The nested simulations also better resolve the west coastal precipitation in India, although they have too much precipitation inland.\nThe nested grid can be tuned separately from the coarse grid. A valid question is whether a nested grid simulation can have a better result simply by virtue of having more degrees of freedom to tune the simulation. A second c90 Maritime Continent factor of 3 nested simulation was performed to answer this question, in which the nested grid's parameterization tuning was chosen to be the same as on the coarse grid. The nested grid's maximum gravity wave drag parameter, amount of convective mass transport, ratio of convective entrainment over land compared to over the ocean, and the convection scheme's autoconversion threshold were all reduced to match those on the coarse grid; the nested grid's divergence damping was changed from fourth to sixth order, and the dry convective adjustment was disabled. To save computer time, this simulation was integrated for only 10 years, using monthlymean climatological SSTs instead of interannually varying SSTs. The June-August mean precipitation in this simulation is depicted in Fig. 6g . Indeed, many of the features of the c90 nested simulation-better representation of topographic and coastal precipitation, reduced precipitation in the western Pacific and South China Sea, and increased Bay of Bengal precipitationare still present when the coarse grid's parameterizations are used, suggesting that these improvements are indeed the result of better resolution and not merely better parameter estimation. In particular, we expect that tuning would not improve the detail of topographically forced precipitation. The annual cycle of the central (Fig. 7) and Southeast Asian (Fig. 8) between 108 and 258N is greater in the nested simulations, although more than in the observations. The center of maximum precipitation also moves farther north at higher resolution, to its observed location of 208N in both nested simulations. The c192 nested simulation also shows a secondary maximum between 108 and 158N, which is in line with the secondary maxima in both datasets, although the model's maximum is later in the year. The precipitation maximum between 258 and 308N also becomes narrower and the amount less in the nested simulations, reflecting the finer resolution of the Himalayas on the nested grid. In Southeast Asia (Fig. 8) all of the simulations have more precipitation during the monsoon than is observed. The lowestresolution simulation, the c90 single grid, has a monsoon onset a month too early, whereas the others begin in June.\nBetter resolution of convection by the nested grid may also increase the activity in convectively coupled tropical wave modes, despite the nest only covering a portion of the tropics. The spectral decomposition of Wheeler and Kiladis (1999) is used to identify the equatorial wave modes in the uniform-resolution and Maritime Continent nested simulations. The c90 simulations (Figs. 9a,b) both have greater eastward-propagating Kelvin wave activity than do the c192 simulations (Figs. 9d,e) , as well as a stronger Madden-Julian oscillation (MJO) signal at frequencies lower than 0.05 cycles per day (cpd); this is due to the choice of a strong entrainment parameter in the convective scheme in the c90 simulations, which suppresses shallow convection and allows deep convection to become more vigorous, producing stronger convectively coupled waves. A 10-yr, climatological SST c90 simulation in which the entrainment parameter was FIG. 8. As in Fig. 7, but averaged between 1008 and 1408E. reduced to that in the c192 simulation (from 12 to 10; Fig. 9c ) shows greatly reduced Kelvin wave and MJO activity compared to the original c90 simulation. The nested grid simulations have greater Kelvin wave activity than do the corresponding uniform-resolution simulations, but less MJO activity. The westward-propagating modes, equatorial inertia waves, and mixed Rossbygravity waves have little power in our simulations.\nModels that only poorly resolve tropical cyclones do not produce storms that are as intense as observed (Zhao et al. 2009; Knutson et al. 2007 , and references therein). A simple feature tracker similar to that of Zhao et al. (2009) was used in our simulations to produce an intensity distribution of all tropical cyclones, defined as warm-core storms forming equatorward of 408 latitude, with a total lifetime of at least 72 h, having a warm core and a maximum surface wind speed of at least 17.5 m s Knapp et al. 2010 ; http://www. ncdc.noaa.gov/oa/ibtracs/) observations. However, the nested simulations produce proportionally fewer of these weak storms than do the single-grid simulations. The result is reversed for storms of maximum wind speeds between 40 and 70 m s\n; too few of these typhoon-strength storms occur in the single-grid simulations, whereas there are closer to the observed frequency in the nested grid simulations. None of the models is able to produce an appreciable number of cyclones stronger than 65 m s\n. Similar results are found in the North Atlantic basin (Fig. 10) ."}, {"section_title": "c. North American regional climate", "text": "Over the continental United States we will use the Parameter-Elevation Regressions on Independent Slopes Model (PRISM; Daly et al. 2008 ) high-resolution 1971-2000 precipitation dataset, which is specifically designed to provide reasonable climatologies in regions of complex terrain.\nIn the winter months, December-February (DJF), there is substantial precipitation in the mountain ranges of the west (Fig. 11c) , particularly in the coastal ranges of California, Oregon, and Washington State, while there is correspondingly less precipitation in the central and eastern United States. The biases in the central and eastern United States are little changed by increasing resolution (Fig. 11) . Increasing the resolution clearly helps to resolve finer topographic features in these ranges (Fig. 12) ; in particular, the representation of the Sierra Nevadas, Cascades, and Northern Rockies is much improved when going from the c90 single-grid to the c90 nested simulation, and the Oregon and Northern California coastal ranges and of the Olympic Mountains are better represented when going from the c192 single-grid to the c192 nested simulation. The model does produce more precipitation than observed in these mountainous regions (Fig. 11) except directly on the Pacific coast, where there is a dry bias.\nIn the spring months of March-May (Fig. 13) there is again improvement in the representation of orographic precipitation in the western United States in the nested simulations, especially in the Cascades, although again there is too little precipitation on the Pacific Northwest coast. There are more minor differences between the simulations in the central and eastern United States; the c90 nested simulation has smaller biases than its c90 single-grid counterpart, but the c192 nested simulation has larger biases than its c192 single-grid counterpart. In the summer months, June-August, there is very little difference between the simulations despite the increase in resolution. There is a strong dry bias in the central United States and a wet bias in the eastern United States, as well as a wet bias in the front range of the Rockies in Colorado. Klein et al. (2006) found that the central plains dry bias is largely due to the inability to properly simulate the propagation of mesoscale convection from the lee of the Rockies into the plains. The tendency for lee convection to not correctly propagate outward also causes the front range wet bias (Lee et al. 2007 ). In the summer months and in all simulations, the diurnal cycle of precipitation over the United States (not shown) peaks at local noon and reaches a minimum at 6 p.m. local time, whereas observations show that precipitation should be greatest at about 6 p.m. and least in the late morning.\nAs in the Maritime Continent nested simulations, a 10-yr c90 nested simulation with climatological SSTs was performed in which the nested grid's tunings were the same as those on the coarse grid. There was little difference between this simulation and the 30-yr AMIP simulation with the nested grid's own tunings, except for minor domainwide increases in precipitation in both; compare panels (d) and (f) in Figs. 11, 13, and 14. In particular there is no change in the representation of orographic precipitation, nor any appreciative change of the summer precipitation biases.\nImproved resolution allows smaller, more intense precipitation features to be represented in the model. The probability distribution of precipitation intensity (Fig. 15) over the North American nested region shows the nested simulations with more of the most intense precipitation events (.10 mm h 21 ) than the c192 simulation, which in turn has more intense events than the c90 simulation. Similar dependence on resolution was found over the Maritime Continent nested region, globally, and over the tropics. In all of our simulations there are more of the most intense events, and fewer events of intermediate strength (0.1-5 mm h 21 ), than observed by TRMM (1998 TRMM ( -2006 .\nAn annual time series of the North American monsoon (Fig. 16) shows only minor differences in JuneOctober precipitation south of 358N when a nested grid simulation is compared to a simulation of just its corresponding coarse grid alone: the c90 single-grid is very similar in timing and maximum to the c90n3 nested simulation, and the c192 single-grid simulation is similar to the c192n2 nested simulation. The precipitation in both the single-grid and nested c192 simulations is more similar to the observations than are the single-grid and nested c90 simulations; it may be that the FIG. 13 . As in Fig. 11 , but for March-May average U.S. precipitation.\nFIG. 14. As in Fig. 11 , but for June-August average U.S. precipitation."}, {"section_title": "4904", "text": "skill in simulating the North American monsoon is improved by increasing the resolution of some region or phenomenon outside the nested grid region. Note again that between 208 and 408N latitude TRMM yields significantly higher precipitation totals than does GPCP. A final 10-yr c90 nested simulation with climatological SSTs was carried out with one-way nesting-in which the two-way updates from the nested to the coarse grid are disabled-to determine if the solution is changed from that of two-way nesting. For comparison the December-February GPCP precipitation climatology is presented. Figure 17 shows that, compared to the singlegrid simulation, the two-way nested simulation shows greater precipitation in the Gulf Stream storm track. Some artifacts are also visible in the two-way simulation: for example, the northeast Pacific precipitation maximum is distorted near the nest's western boundary, some distortion of the ITCZ is present at the western boundary, and there are some artifacts at the nest's eastern boundary as well in the storm track. In the oneway nested simulation the artifacts are much more obvious, particularly on the eastern boundary, where the precipitation is much stronger and a large positive anomaly extends inward from the boundary. Artifacts are also visible in the one-way simulation on the western boundary near the northeast Pacific precipitation maximum. Away from the nest boundary there is less difference between the one-and two-way nested simulations, although there is some tendency for biases to be amplified in the one-way simulation, especially over the oceans. Other seasons show similar differences between one-way and two-way nesting. Although artifiacts due to one-way nesting are most visible near the boundaries far from the continental precipitation we have shown the most interest in, our results do suggest that artifacts due to one-way nesting could contaminate the area of interest if a smaller, less computationally expensive domain is used."}, {"section_title": "d. Timing", "text": "How efficient is running a nested grid simulation compared to a high-resolution uniform-grid simulation? The times used for a 31-day simulation on the two MC nested grid simulations are given in Table 4 , and can be compared to simulations for which just the coarse grid were used. Here, we have allowed the number of coarse grid processors to scale linearly with the resolution so that strong scalability can be neglected. The c90n3 simulation takes about 65% longer and uses more processor time than the c90 simulation, 4 times as much work as the uniform-resolution c90 simulation, although this is more efficient than the factor-of-3 3 greater work we would expect from a globally uniform c270 simulation. Similarly, the c192n2 simulation requires more processors but finishes in only 10% more time, whereas a uniform-resolution c384 simulation (using a 600-s physics time step and a 37.5-s dynamics time step) takes more time and many more processors, requiring about 2.5 times more work than does the c192n2 simulation; both the c384 and the c192n2 simulation are much faster than the theoretical estimate of 2 3 slower than c192 that we would expect a uniform-resolution c384 simulation to be. The fastest of five one-way nested simulations for the c90n3 MC simulation was less than 1% faster than the fastest twoway nested simulation, while for the c192n2 MC simulation the fastest one-way nested simulation was about 2% faster.\nThe c192 and c384 uniform-resolution simulations are all more efficient relative to the c90 simulation than values from theory- (192/90) 3 ' 9.7 and (384/90) 3 ' 77.7, respectively. The result is largely due to the scaling of the physics time step, which decreases only from 1200 to 900 to 600 s when increasing the resolution from c90 to c192 to c384. Further, the nested grid simulations are more efficient relative to their coarse grid simulations. Recalling that the nests cover nearly a sixth of the global domain, the c90n3 simulation would, in theory, require 1 1 3 3 /6 5 5.5 times as much work as the c90 simulation, and the c192n2 simulation 1 1 2 3 /6 ' 2.3 times as much work as the c192 simulation, whereas our nested simulations take 4 and1. 8 times as much work, respectively. This is due to the nested grid using the same physics time step as the coarse grid, and the nested grid's dynamics time step is larger than that found by dividing the coarse grid dynamics time step by the refinement ratio. It is FIG. 15 . June-August precipitation intensity probability distribution over the North America nest region, equatorward of 508 latitude, computed from 3-h average precipitation.\nlikely that we are able to take a larger nested grid time step since the nested grid avoids the strong southern stratospheric jet (Fig. 3a) that limits the time step in the global domain. The efficiency gains from grid nesting are offset by additional overhead imposed by transferring data between the two grids and by process load imbalancing, in which nested grid processors typically need to do more work than do the coarse grid processors due to the nested grid's smaller time step. Load imbalancing likely also explains the only minor performance improvement when using one-way nesting."}, {"section_title": "Conclusions", "text": "A nested grid version of the GFDL HiRAM model has been developed to locally increase the model resolution more efficiently than by globally refining a (quasi-)uniform resolution grid. The two-way nesting of Harris and Lin (2013) is implemented in the finite volume dynamical core, using a simple interpolation in space to provide the nested grid boundary conditions, and a linear extrapolation in time to allow the nested grid to run concurrently with the coarse grid. The twoway nested-to-global updating uses a simple averaging update on the winds and temperature, consistent with finite volume methodology, while trivially conserving mass on the coarse grid by not performing the two-way update on the air mass or tracer mass fields.\nAMIP climate simulations were performed and compared against single-grid simulations and reanalyses; in particular, the precipitation on the nested grid was analyzed to determine if grid nesting could improve the FIG. 16 . As in Fig. 7 , but between 1058 and 1158W.\nrepresentation of finescale features and reduce existing model biases. In all simulations orographic precipitation was represented with greater detail when nesting was used. The two-way nested simulations neither appreciably disrupted nor improved the zonal-mean temperature or winds compared to the uniform-resolution simulations. Nesting reduced tropical precipitation biases in the Maritime Continent region; the June-August wet bias over the western Pacific warm pool in the single-grid simulations was improved in the nested grid simulations. The nested simulations also were able to reduce precipitation biases in the South China Sea, the west coast of India, and in the Bay of Bengal, although in the latter the nested grid simulations tended to move the precipitation too far inland. Nested simulations had a larger number of intense precipitation events, and were found to have slightly more coupled convective wave activity, than did their uniform-resolution counterparts. Improving resolution through grid nesting also allowed better resolution of tropical cyclones, allowing intense typhoonand hurricane-strength storms to form more frequently than their lower-resolution single-grid counterparts. Grid nesting did not appreciably improve or degrade the zonal-mean global climate, although nesting did cause 1 W m 22 changes in the net radiation balance.\nGrid nesting was able to improve the representation of orographic precipitation in the mountainous western United States, implying improvements in simulated mountain snowpack and thereby of water supply in the western states. Comparatively little improvement was seen with improved resolution over the central and eastern United States. The central plains summertime dry bias, common in many climate models, was largely insensitive to increases in model resolution. It is likely that this bias can only be improved by either improved continental convection parameterizations, or by sufficiently high resolution that mesoscale convective systems can be well enough represented to exhibit realistic propagation and diurnal cycle. The nested grid is able to use a different set of physical parameterization tunings from those on the coarse grid; however, improvements in precipitation patterns due to improved representation of orography and of mesoscale tropical convection when a nested grid is used are retained when the coarse grid's parameterization tunings are used on the nested grid. This suggests that the increase in resolution from grid nesting can by itself improve some aspects of the simulation, and not simply because we have a greater number of parameters to tune in the physics. Finally, while nested-grid artifacts are present at the boundary of a two-way nested grid, severe artifacts appear in a one-way nested simulation, particularly at outflow, that do show some evidence of affecting the solution inward from the nest's boundary. This supports results from highly idealized models (Harris and Durran 2010) and the general perception within the meteorological community (Warner et al. 1997 ) that two-way nesting yields a better solution than does one-way nesting. Boundary artifacts from one-way nesting may cause substantial degradation of the solution if the nested domain were small enough that the boundary lies near the area of interest.\nThe utility of grid nesting has so far been demonstrated for resolutions comparable to those in existing regional climate modeling projects (cf. Mearns et al. 2009; Hewitt 2004; Giorgi et al. 2009 ). Higher-resolution nested simulations are currently being designed, as well as nesting for nonhydrostatic simulations and performance enhancements. "}]
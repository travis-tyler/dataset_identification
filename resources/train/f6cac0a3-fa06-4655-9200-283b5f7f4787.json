[{"section_title": "", "text": "* Correspondence: Frank A. Provenzano (fap2005@cumc.columbia.edu) or Scott A. Small (sas68@cumc.columbia.edu) 1 Data used in preparation of this article were partially obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at: http://adni.loni.usc.edu/wp-content/uploads/how_to_apply/ ADNI_Acknowledgement_List.pdf 2 Data used in the preparation of this article were partially obtained from the Australian Imaging Biomarkers and Lifestyle flagship study of ageing (AIBL) funded by the Commonwealth Scientific and Industrial Research Organisation (CSIRO) which was made available at the ADNI database (www.loni.usc.edu/ADNI). The AIBL researchers contributed data but did not participate in analysis or writing of this report. AIBL researchers are listed at www.aibl.csiro.au. 3 Data used in preparation of this article were partially obtained from the Frontotemporal Lobar Degeneration Neuroimaging Initiative (FTLDNI) database (http://4rtni-ftldni.ini.usc.edu). The investigators at NIFD/FTLDNI contributed to the design and implementation of FTLDNI and/or provided data, but did not participate in analysis or writing of this report.\narXiv:1907.00943v1 [cs.CV] 1 Jul 2019"}, {"section_title": "Introduction", "text": "Age estimation is the task of estimating an individual's age based on a set of other covariates. In particular, a large body of research focuses on the task of predicting brain age based on imaging studies. In addition to its utility in studying the aging process itself, estimated age, as derived from models trained on a healthy population, has emerged as a useful biomarker for diseases. Specifically, the divergence of one's estimated age from chronological age has been associated with various diseases, especially those thought to mimic an advanced age state.\nTypically, models for estimating brain age are trained on datasets representing a normal aging population free of obvious disease. When subsequently applied on (possibly abnormal) subjects, predicted brain age has been linked to education and self-reported physical activity [1] and has been utilized to characterize diseases including Alzheimer's Disease (AD) [2] , schizophrenia [3] , traumatic brain injury [4] , etc., where deviation from normal aging trajectory occurs alongside disease state.\nThere are three components necessary to determine brain age with this paradigm: 1) covariates: the measured brain characteristics which serve as inputs to the model, 2) dataset: the precise cohort of normal aging subjects upon which the model is trained, 3) model: the precise algorithms used to estimate the brain age given the available covariates. While brain characteristics can be derived via many methods, neuroimaging is the most common and comprehensive way to characterize the \"brain state\" in vivo. Within neuroimaging, past studies have addressed EEG (Electroencephalogram) [5] , DTI (diffusion tensor imaging) [6] , and resting state BOLD fMRI (blood-oxygen-level dependent functional MRI) [7] , which reflect different physiological brain measures. However, T1-weighted (T1w) structural MRI, which reveals features of the underlying anatomical characteristics of the brain, including gray and white matter delineation and gyral and sulcal patterns, is the most common modality in brain age estimation research. Imaging-derived neuroanatomical characteristics are biomarkers particularly sensitive to the aging process [8] . Practically, as one most widely available and standardized neuroimaging modalities, T1w structural MRI can be easily acquired for a large population. And within structural MRI domain, studies have used derived summary variables such as regional volumes or thickness estimation [9] , requiring additional software processing to generate such values, and also unprocessed MRI scans [10] .\nWe believe that for these tools to be broadly useful, they must be trained on adequately diverse datasets that reflect the diversity of the populations on which the model might potentially be deployed. In this study, we propose using a dataset aggregated from several publicly available multi-center neuroimaging datasets, representing a diverse healthy population. This healthy study pop-ulation is both larger in scale than those investigated by most previous age estimation studies and specifically designed to enable training age estimation models with an approximately uniform age distribution across the adult life span.\nLastly, given a study population and selected brain characteristics, the age is estimated based on statistical machine learning techniques. Another way to formulate the age estimation problem is to extract generalizable features from the brain that best capture the chronological age of a person provided the individual is undergoing a typical aging process that is present in a general healthy population. Numerous traditional machine learning methods have been proposed for age estimation including relevance vector machines [11, 12] , Gaussian processes [13, 14] , random forests [15] , hidden Markov models [16] , and nonnegative matrix factorization [17] .\nMore modern deep learning based methods are especially well suited to this task provided enough training data, and have been previously applied by [10] who demonstrated favorable performance. Interpretability is a critical aspect of deep neural network based method. We seek not only to achieve predictive performance, but also to derive insights by understanding which features are most predictive. In this work, we explore regional contributions in the regression task by considering both feature ablation experiments and an activation map based post hoc interpretation method.\nIn summary, we utilize a 3D deep convolutional neural network based regression model to estimate age using T1w structural MRI volumes from a diverse multi-study population that is sampled with even age distribution across adult age span. We achieved superior performance both in the hold-out test set from the same population and also in an independent life-span evaluation dataset.\nThe deviance of the estimated age from chronological age is linked to neuropsychological and neuromorphometric measures. We further demonstrate the prominence of frontal lobe in brain age estimation, and the pattern variability across life-span."}, {"section_title": "Method", "text": "In this section, we first describe the population and the experimental setup used in this study. We then describe the MRI pre-processing steps and the convolutional neural network used to estimate age. Next, given our learned model for estimating brain age, we present analysis that associates the divergence of the estimated age from the chronological brain age with neuropsychological and neuromorphometric measures. Finally, we describe multiple modes of regionality analysis for identifying which regions are most predictive. These consist of both ablation experiments and an extension of the class activation mapping method for interpreting feature importance in deep networks to the regression setting."}, {"section_title": "Study Population", "text": "It is necessary to build an adequate neuroimaging dataset for age prediction in the full adult life span, especially given study recruitment criteria the dataset is not necessarily evenly distributed across age. Increased participation in open data consortia and imaging datasets greatly facilitates the collection of such data. In this work, we collect more than 30,000 T1w MRI scans from multiple open neuroimaging datasets. The list of the datasets used in this study with the full names and sources are listed in supplementary Table S2 . Among those, we only include subjects with clear indication of normal neurological evaluations contingent on the individual data providers criteria for a subject that is considered free of disease. Specifically, we exclude subjects with any neurological or psychiatric disease, and also subjects with no available diagnosis label. We also chose 18 as the minimum age to cover adulthood and also to avoid the neurodevelopmental stage. This results in 10,158 MRI sessions from 6,142 unique subjects, the statistics are summarized in Table 1 .\nHowever, as shown in Figure 2 .1 A and B, where we illustrate the age distribution of the 10,158 sessions and 6,142 subjects respectively, the age distribution of the population is poorly balanced. Although there are studies covering the [20] , OASIS-1 [21] , and consortium-based studies such as CoRR [22] , SchizConnect [23] , many of the public imaging studies either focused on agerelated disease in the elderly population including ADNI, AIBL [24] , OASIS-2 [25] , PPMI [26] , NIFD; or on young subjects including BGSP [27] , SLIM [28] . To alleviate the potential bias toward a certain age segment, we sought to balance the age distribution that we ultimately use in the training population.\nIn this study, when constructing the dataset to be uniform across age-span, we adopt both 'oversampling' and 'undersampling'. Briefly, we oversample subjects from age ranges with fewer subjects by including the longitudinal follow-up sessions from the same subjects, which could be regarded as a natural augmentation. For age ranges with more subjects, we only include one scan per subject to increase the variability of the sample. If that number is still above the minimum across age bins, we further undersample stratified on confounding factors including acquisition site and gender.\nWe stratify the populations into age bins and use the bin with the minimum number of subjects as the basis number. The age bins used in this study are [18, 20) , [20, 25) , [25, 30) , ... , [85, 90), [90, 100).\nOne interesting observation is that the [35, 40) , [40, 45) are the two age bins with fewest number of subjects, so we use the number of subjects in this age segment as the base level and allow repeated scans from same subjects. The other age bins having multiple scans per subject are the two age bins at the tail end: [85, 90) and [90, 100], because of the relative lower number in these two age bins. We undersample the subjects in all other bins.\nThe final dataset consists of 2,852 MRI sessions from 2,694 subjects covering age range 18-97, with the mean age 54.34 years old, standard deviation 21.16 years old. The age distribution of the evenly-sampled adult age span dataset is shown in Figure 2 "}, {"section_title": "Experimental setup", "text": "We design training, validation and test sets of subjects for model training and evaluation. We build a validation set reflecting of general MRI scan distribution and population distribution. Similarly, a test set representative of the same population as the training and validation sets is important for evaluation.\nGiven this uniform age-distributed dataset we described in the section above, we perform stratified split based on acquisition sites and gender within each age bin: 8/10 as training set, 1/10 as validation set, 1/10 as test set, ensuring nonoverlapping subjects and similar distribution of age, gender and acquisition sites in the training, validation and test sets.\nWe also evaluate our model by testing it on an independent test set: Cam-CAN. Aiming to study the normal aging process through the adult life-span, Cam-CAN provided even age distribution across adult life-span and was previously used as an independent testing sample in another age estimation study [13] . We note that the trained model should be applicable to any similarly 8 acquired structural neuroimaging within this age range. However, the result on an independent sample, which usually reflects a homogeneous population or acquisition setting, might be over-or under-optimistic.\nAdditionally, we also perform a test-retest experiment using an independent dataset of three subjects scanned 40 times in 30 days [29] to evaluate the reproducibility of the model."}, {"section_title": "MRI Preprocessing", "text": "We apply basic pre-processing steps including nonparametric nonuniform intensity normalization (N3) based bias field correction [30] , brain extraction using FreeSurfer [31] , and affine registration to the 1mm 3 isotropic MNI152\nbrain template with trilinear interpolation using FSL FLIRT [32] . The dimension of the 3D volume is 182 \u00d7 218 \u00d7 182 (LR\u00d7AP\u00d7SI).\nAll the preprocessed scans were checked by a well-trained reviewer with visual inspection. Scans having obvious and severe MRI artifacts, brain extraction failure or poor registration were excluded."}, {"section_title": "Convolutional neural network", "text": "We use a three-dimensional convolutional neural network (3D-CNN) regression model for age estimation, with similar architecture as the 3D-CNN classification model for Alzheimer's disease classification used in [33] . We follow a general CNN architecture similar to the VGG classification architecture [34] with multiple interleaved convolutional blocks and max pooling layers and an increasing number of features along the depth. We replaced all 2D operations with 3D operations and included one fully-connected layer to reduce the number of parameters. We use convolutional layers with kernel size of 3 \u00d7 3 \u00d7 3, rectified linear unit (ReLU) as the activation function, and batch normalization (BN) layers before the activation functions. We flatten the output from the last convolutional layer and feed into a fully-connected (FC) layer. And the final activation is a linear operation instead of a softmax in classification tasks.\nWe include weight l2 regularization to prevent overfitting with a factor of 1.0."}, {"section_title": "9", "text": "The algorithm was optimized using Adam algorithm with mean absolute error (MAE) loss function, and with a batch size of 5. The initial learning rate was tuned in the range from 1e \u2212 4 to 1e \u2212 6 including [1e-4, 5e-5, 2e-5, 1e-5, 5e-6, 2e-6, 1e-6] and was set at 2e-5.\nWe implemented the algorithm using Keras and TensorFlow. An illustration of the framework is shown in Figure 2 . In this study, we use five (N in Figure 2) stages. The feature dimension of the first layer is 16 and increases by a factor of 2 in each subsequent stage. The optimal model is selected as the model with the lowest validation MAE. "}, {"section_title": "Comparison with model trained on unbalanced dataset", "text": "We also trained the model using all scans from unique subjects (N = 6,142, Figure 2.1 B) . We applied the trained model on the independent Cam-CAN dataset and studied the distribution of MAE over chronological age groups.\nBesides, a simple way to potentially correct the imbalance without adjusting the sampling of the dataset is re-weighting the samples, specifically, we assign different weights to different sample, with the weights in proportional to the inverse of the frequency of specific age segments. We note that while importance weighting is a principled statistical technique with well-known effects in traditional statistical models, its impact on the learned predictors in deep learning algorithms are a subject of active inquiry [35] ."}, {"section_title": "Neuropsychological and morphometric associations", "text": "To test the utility of the estimated age in studying cognitive functions across adult life-span, we evaluate the association between the summary scores of Benton face recognition test (BFRT) and the estimated age in Cam-CAN dataset.\nSpecifically, we use the signed difference of the estimated age and chronological age to reflect the deviance of individual brain age from their chronological age, and we refer to this value as age diff hereinafter. The BFRT is a commonly used neuropsychological instrument that can be easily and reliably administered in adult patients to test baseline visual memory and perception [36] . We adopted the SubScore-1, SubScore-2, TotalScore (SubScore-1 + SubScore-2) as dependent variables in individual linear regression models incorporating gender, chronological age, age diff , and the interaction of chronological age and age diff :\nScore \u223c \u03b2 age age + \u03b2 age diff age diff + \u03b2 age diff \u00d7age age \u00d7 age diff + \u03b2 gender gender Additionally, we evaluate the association between age dif f with cortical thickness generated using FreeSurfer [37] by performing a partial correlation with gender and chronological age as covariates. FreeSurfer parcellates the cortex into 68 cortical regions."}, {"section_title": "Age activation map", "text": "Class activation mapping [38, 39] is a commonly-used method for interpreting the classification using CNNs and has been previously used in CNN based medical image analysis [40] to marry potential disease pathology with classification findings. In this work, we use the idea of a class activation map in a regression setting by highlighting the small-valued gradient in grad-CAM framework. We use functions in the keras-vis package (https://github.com/ raghakot/keras-vis/). We generate the average activation map within each age group to investigate the age-specific pattern of underlying substrates for age estimation.\nWe expect the anatomical patterns characterizing different age groups to be different throughout lifetime but are consistent within a local age range. Thus we generate and illustrate the age activation maps every 5 years, in the same way as preparing the dataset. The 3D iso-surfaces of the average age activation maps are shown in Fig. 7 . The average age activation maps overlaid on the MNI152 template are shown in Fig. 8 (Left) . To accommodate the anatomical differences in different age groups, we also generated average T1w image within each age group, and overlaid the corresponding age activation map, as shown in Fig. 8 (Right). The 3D iso-surfaces (0.8) of the age activation maps at different age groups."}, {"section_title": "Slice based age estimation", "text": "Besides the post hoc saliency map based activation map method, we also propose an ablation analyses method focusing on part of the input data. We apply serial 2D CNNs for age estimation with the input being three consecutive slices along each axis. By doing so, we take into consideration the inter-subject alignment precision (i.e. not using just one slice) and also the similarity among different channels (i.e. not using five slices). The network architecture of the 2D CNN is the identical to the 3D CNN architecture described in the previous section with the 3D operations replaced with the corresponding 2D operations.\nWe report the predictive performance on various sets of 2D slices to analyze predictive importance.\nThe age estimation performance using 2D MRI slabs sliced at different coordinate planes is shown in Figure 9 . The slices with the best performance are also illustrated."}, {"section_title": "Lobe based age estimation", "text": "Besides sliced based age estimation, we propose using another more anatomically-informed way to study the regionality through ablation experiments at the lobar level. The individual lobe masks were generated following a previous study [33] . The ages are estimated using each lobe individually.\nThe MAE trained using different lobes are shown in Table 4 , where we show the best estimation performance achieved through frontal lobe. And temporal lobe achieved marginally lower performance. "}, {"section_title": "Results", "text": ""}, {"section_title": "Age prediction", "text": "In the hold-out test set, whose instances are distributed identically as the training and validation set, our model achieves an MAE of 4.06 years and correlation coefficient r = 0.970. An independent normal aging life-span dataset-Cam-CAN-was tested in a previous brain age study [13] . In that study, when the Cam-CAN data were pre-processed with the optimal parameters selected from the independent training sample, their proposed model achieved an MAE of 6.08 years and correlation coefficient r = 0.929. We tested out our model in Cam-CAN study processing the T1w MRI images using the same pipeline as the other samples. The relationship between the estimated age and chronological age in Cam-CAN is shown in Figure 3 .1. The correlation coefficient r is 0.960, MAE is 4.21 years, which outperforms the result in the previous study [13] . We also observe two obvious \"outliers\" among the 652 subjects tested, further investigation is needed to pinpoint potential sources of error, either methodological, constitutional or true poor estimation. The results demonstrate our proposed model achieves accurate estimation in all age segments. "}, {"section_title": "13", "text": ""}, {"section_title": "Reproducibility", "text": "We evaluate the reproducibility of the algorithm in test-retest acquisitions.\nWe show the results in Table 2 and Figure 4 , observing that there is a difference in the estimated age and actual reported chronological age that is consistent over the sessions with approximately a 1 year standard deviation."}, {"section_title": "Comparison with results using nonuniform dataset", "text": "We compare the results using nonuniform dataset with the MAE performance in Cam-CAN dataset. Using the nonuniform dataset achieves comparable overall MAE (4.27 years) as the balanced data. Re-weighting the samples helps slightly improves the MAE (4.17 years) than the balanced dataset despite using many more scans. Additionally, we observe the MAE using the nonuniform dataset is not evenly distributed across life-span: MAE is lower in the young age with more abundant data, as shown in Figure 5 (B). This could introduce potential bias in life-span studies. Using sample re-weighting ( Figure 5 (C)) alleviates the problem and using balanced dataset generates generally even distribution across age-span ( Figure 5 (A) ). "}, {"section_title": "Neuropsychological and neuromorphometric association", "text": "The association of the BFRT scores with the difference in the estimated age and the chronological age and its interaction with chronological age are summarized in Table 3 .\nThe association of the cortical thickness measures with the age diff is illustrated in Figure 6 . The thickness of cortical regions are significantly associated with the age diff . In addition, out of the 68 regions measured, 51 regions have a stronger correlation with the estimated age than the chronological age. This is expected as the age estimated through structural MRI image is in principle more coupled to structural phenotypes. "}, {"section_title": "i o r p a r i e t a l p r e c e n t r a l s u p e r i o r p a r i e t a l p o s t c e n t r a l p a r s o p e r c u l a r i s p a r s t r i a n g u l a r i s e n t o r h i n a l l a t e r a l o c c i p i t a l m e d i a l o r b i t o f r o n t a l b a n k s s t s p a r a c e n t r a l i n f e r i o r t e m p o r a l t e m p o r a l p o l e p a r s o r b i t a l i s i s t h m u s c i n g u l a t e i n s u l a f r o n t a l p o l e f u s i f o r m l i n g u a l c a u d a l a n t e r i o r c i n g u l a t e p o s t e r i o r c i n g u l a t e c u n e u s l a t e r a l o r b i t o f r o n t a l r o s t r a l a n t e r i o r c i n g u l a t e p e r i c a l c a r i n e p a r a h i", "text": ""}, {"section_title": "i o r p a r i e t a l i n f e r i o r p a r i e t a l c a u d a l m i d d l e f r o n t a l p a r s t r i a n g u l a r i s r o s t r a l m i d d l e f r o n t a l p a r a c e n t r a l p o s t e r i o r c i n g u l a t e p o s t c e n t r a l m i d d l e t e m p o r a l p a r s o p e r c u l a r i s l a t e r a l o c c i p i t a l b a n k s s t s i n s u l a e n t o r h i n a l i s t h m u s c i n g u l a t e p r e c e n t r a l f u s i f o r m i n f e r i o r t e m p o r a l p a r s o r b i t a l i s c a u d a l a n t e r i o r c i n g u l a t e f r o n t a l p o l e t r a n s v e r s e t e m p o r a l m e d i a l o r b i t o f r o n t a l t e m p o r a l p o l e p a r a h i p p o c a m p a l r o s t r a l a n t e r i o r c i n g u l a t e l a t e r a l o r b i t o f r o n t a l", "text": ""}, {"section_title": "Discussion", "text": "In this study, a large heterogeneous dataset of structural neuroimaging across the adult lifespan was aggregated from multiple publicly available data sources. A deep convolutional neural network was developed, trained and applied to predict the chronological age from the subject's scan.\nThis uniformly distributed dataset is able to achieve estimation without appreciable bias towards a certain age group, while maintaining training efficiency compared with training on an nonuniform dataset. While this study aims to examine the aging process across the adult life-span, other studies aiming to examine the role of aging in other conditions would likely benefit from other specific training dataset inclusion criteria. For example, for studies of autism and prodromal psychosis where age of onset skews younger, studies would require the inclusion of subjects below 18, and subjects in middle and old age would likely be less informative.\nThe regionality analysis in this study reveals patterns of neuroanatomical contributions of normal aging. All analyses provide evidence for the prominence of frontal regions in all epochs of age estimation in the adult lifespan.\nFrontal regions have been implicated in normal aging through both neuropsychological studies and neuroimaging studies [41, 42, 43] . In addition, the pattern shifts reflected in the age activation map based analysis imply a frontal lobe- One consideration is that the set of subjects with no current pathological symptoms might have disease at asymptomatic prodromal state that have yet to manifest in the clinical evaluation, such as pre-clinical AD. Such work would require follow-up data to preclude disease for a given period of time such that they remain stable as controls. However, this was not available for all subjects, and in a group of otherwise healthy individuals, it is likely that some healthy individuals do harbor occult disease. Additionally, subjects were considered normal using criteria germane to the disease of focus in different studies.\nGiven the diversity of the studies from which the model was trained, the protocols and acquisitions vary across both site and study. This in fact benefits this model compared to individual studies of unified aging because the variance of acquisition differences are included in the training, compared to training data where a more cohesive protocol is used. Such inclusion without appreciable loss of accuracy supports the use of this model on a wider variety of baseline scans."}, {"section_title": "Conclusion", "text": "This study has demonstrated the high accuracy of an age estimation framework using routine structural neuroimaging and a deep convolutional neural network, trained on a large-scale healthy population with uniform age distribution across adult age span. While there is considerable interest and value in a highly accurate estimation model that can be applied to a wide variety of structural MRI protocols, this study also demonstrates patterns of the regional contributions of aging across the lifespan using multiple methods, agnostic of tissue classes, structure delineation or surface parcellation. This framework can be used to generate meaningful quantitative and visual biomarkers for both aging studies and broad neuroimaging applications. Further studies may examine the estimated age and the regional contributions to see if they may be useful in understanding one's age divergence in the context of a particular disease or condition's pathology."}, {"section_title": "Conflicts of interest", "text": "FAP is a consultant for and has equity in Imij Technologies. SAS has equity in Imij technologies. XF, FAP and SAS have a patent application filed related to neuroimaging methods. Data collection and sharing for this project was funded by NIMH cooperative agreement 1U01MH097435."}, {"section_title": "Acknowledgment", "text": ""}]
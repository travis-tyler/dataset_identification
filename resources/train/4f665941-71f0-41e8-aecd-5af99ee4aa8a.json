[{"section_title": "Abstract", "text": "Potential biomarker detection is a crucial area of study for the prediction, diagnosis, and monitoring of Alzheimer's disease (AD). The voxelwise genome-wide association study (vGWAS) is widely used in imaging genomics studies that is usually applied to the detection of AD biomarkers in both imaging and genetic data. However, performing vGWAS remains a challenge because of the computational complexity of the technique and our ignorance of the spatial correlations within the imaging data. In this paper, we propose a novel method based on the exploitation of spatial correlations that may help to detect potential AD biomarkers using a fast vGWAS. To incorporate spatial correlations, we applied a nonlocal method that supposed that a given voxel could be represented by weighting the sum of the other voxels. Three commonly used weighting methods were adopted to calculate the weights among different voxels in this study. Then, a fast vGWAS approach was used to assess the association between the image and the genetic data. The proposed method was estimated using both simulated and real data. In the simulation studies, we designed a set of experiments to evaluate the effectiveness of the nonlocal method for incorporating spatial correlations in vGWAS. The experiments showed that incorporating spatial correlations by the nonlocal method could improve the detecting accuracy of AD biomarkers. For real data, we successfully identified three genes, namely, ANK3, MEIS2, and TLR4, which have significant associations with mental retardation, learning disabilities and age according to previous research. These genes have profound impacts on AD or other neurodegenerative diseases. Our results indicated that our method might be an effective and valuable tool for detecting potential biomarkers of AD."}, {"section_title": "Introduction", "text": "Alzheimer's disease (AD) is a complex neurodegenerative disease and the main cause of age-related dementia [1] , so far affecting millions of people worldwide. Moreover, the underlying pathological mechanism of AD is not well understood. Fortunately, recent studies have shown that the detection of AD biomarkers can contribute substantially to AD prediction, diagnosis, and monitoring [2] [3] [4] [5] .\nImaging genomics is a new field that has developed over the past two decades. It can be used to detect potential biomarkers of AD, helping to develop new treatments, monitor their effectiveness, and reduce the duration of clinical trials [6, 7] . In addition, discovering the biomarkers within both imaging and genetic data has at least three advantages. First, it helps us to gain insight into the underlying pathologic processes of AD or other neuropsychiatric and neurodegenerative diseases [8, 9] . Second, the genetic pathways by which relevant genes affect these diseases can be discovered with the help of neuroimaging under the assumption that we could, in some ways, identify the significant but hidden associations between causal genes and specific variations drawn from the brain regions [10] [11] [12] [13] . Third, morphometric changes in the brain areas in neuropsychiatric and neurodegenerative diseases can be detected, which is rather straightforward in clinical practice and can be an indicator of functional changes in diseases.\nUntil now, many methods have been proposed to solve a variety of problems in the field of imaging genomics studies. Among these methods, the voxel-wise genome-wide association analysis (vGWAS) approach offers a holistic perspective, and in recent years, it has become the most common way to analyze brain images and genetic data simultaneously. In contrast to traditional methods, which are based on candidate phenotype and/or candidate genotype analyses, a vGWAS detects potential biomarkers of neuropsychiatric and neurodegenerative diseases by combining multiple phenotypic variables (e.g., voxels in imaging A C C E P T E D M A N U S C R I P T space) and the whole genome (e.g., single nucleotide polymorphism, SNP) [14] . Therefore, a vGWAS does not require a priori pathological knowledge of diseases to select the candidate phenotypes and/or candidate genotypes of interest, thereby reducing the probability of missing both important genes and brain clusters [15] [16] [17] . However, a vGWAS is typically impossible without the support of large amounts of data of approximately 10 6 voxels and 10 6 SNPs for a subject because of its global reach as indicated in our previous study [18] , thus creating a heavy computational burden.\nTo tackle the computational complexity issue, we proposed a more efficient method, namely, the fast voxel-wise genome-wide association analysis (FVGWAS), to accelerate the calculation of traditional vGWAS in our previous study [18] . FVGWAS includes the following two steps: 1) A global sure independence screening (GSIS) procedure to eliminate many 'noisy' loci that had a weak association with the image phenotypes. 2) A detection procedure based on wild bootstrap methods that is intended to prevent the repeated analyses of simulated datasets. By decreasing both the data size and experimental times together, the FVGWAS has greatly alleviated the computational burden. To be specific, FVGWAS is dozens of times faster than traditional vGWAS.\nThe vGWAS is known to rely on the assumption that the voxels are independent of one another, and each voxel is treated as an individual unit to estimate the gene-voxel pairwise significance. Therefore, the correlations among voxels commonly known as spatial correlations in images is ignored in typical vGWAS methods [6, 19, 20] as well as in our FVGWAS.\nBiologically speaking, the disease-related regions in the brain are usually not separate but are actually contiguous because of the inherent biological structure and function of the organ. In other words, structural changes caused by disease always refer to a relatively large region in the brain [21] rather than the independent voxel or small clusters. In terms of image processing, the spatial correlations in images has been proven to contribute to different image-related tasks [22] [23] [24] [25] . Hence, exploiting spatial correlations within data provides a new way to approach neuroimaging studies. For example, Polzehl [26] proposed a structural adaptive segmentation method for structure denoising and signal detection in fMRI, which is conducted by iteratively updating the smoothing"}, {"section_title": "A C C E P T E D M A N U S C R I P T", "text": "parameters. In addition, some studies ( [5, 15, 27] ) have flexibly incorporated the neighboring areas of each voxel by using a multiscale adaptive regression approach whose parameters are iteratively updated in a sequence of hierarchically nested spheres with increasing radii. Tao [20] proposed a generalized reduced rank latent factor (GRRLF) regression approach, which works by smoothing the tensor fields that are parameterized by smoothing the basis functions in the model, to exploit the spatial structure of the neuroimaging data indirectly. Recently, a functional genome wide association analysis (FGWAS) [28] , exploiting the spatial correlations in imaging data based on a multivariate varying coefficient model, can effectively detect crucial genetic and functional biomarkers. Thus, based on the biological mechanism of disease and previous studies, exploiting the spatial correlations in images is expected to provide a new and effective point of view to improve the detection accuracy in vGWAS. However, most of the abovementioned methods incorporated the spatial correlations within imaging data by fitting a regression model and smoothing all the parameters for group analyses of the image phenotype, leading to high computational complexity.\nIn this paper, we introduce an alternative strategy to our framework for neuroimaging studies, which is known as nonlocal methods in the field of image processing. Due to the redundancy of the images, nonlocal methods employ local similarities between the patch centered at a given voxel and the patch centered at a neighboring voxel (or between the given voxel and its neighboring voxel) to approximately represent the given voxel. Note that the similarities identified here are expected to reflect the complex correlations among high-dimensional voxels.\nIn that case, it is reasonable to consider the nonlocal method within our framework to exploit the spatial correlations in neuroimaging data. In practice, the nonlocal method quantifies similarities with weightings. Therefore, the key to this method is how to assign weights to neighboring voxels. Here, we selected three kinds of weighted functions, namely, the Gaussian (GS) function, nonlocal means (NLM), and block-matching and 3D/4D filtering (i.e., BM3D for 2-dimensional images and BM4D for 3-dimensional images). In fact, the similarities in both NLM and BM3D/BM4D are based on the image patches, whereas the similarities in the GS function are based on voxels. All these weighted methods are widely used in the field of image processing, and have achieved good results. They are clearly representative enough to incorporate the spatial correlations in images.\nIn this study, we proposed a novel method using vGWAS based on spatial correlations exploitation with the aim of detecting more biomarkers of AD. A schematic overview of the proposed method is given in Fig. 1 . Our method includes two major steps, 1) a nonlocal method is used to integrate the correlations among voxels, which supposes that the given voxel can be represented by weighting the sum of its neighboring voxels; and 2) finding the potential AD biomarkers from images (phenotypes) and genetic data (genotypes) by using FVGWAS, which actually makes the computation more rapid. To validate our method, we designed both simulation studies and analyses with real data. For the simulation studies, we presented experiments to evaluate the effectiveness of the nonlocal method and compared the performance of three weighted approaches. For the analyses with real data, we empirically evaluated our proposed method with three different weighted approaches to detect potential biomarkers, and we successfully detected the three significant AD-related genes ANK3, MEIS2, and TLR4. The results showed that our method is very promising for detecting more biomarkers, and it may provide a new way to gain insight into the underlying pathological mechanism of AD. \n\nIn preparation for our analysis, both genetic data and anatomical MRI scans of the human brain were obtained from the ADNI database (http://adni.loni.usc.edu/).\nThe ADNI was launched in 2003, and it has been running since 2004; it is currently funded until 2021. This funding has been provided by the National Institute on Aging (NIA), the National Institute of Biomedical Image and Bioengineering (NIBIB), the Food and Drug Administration (FDA), private pharmaceutical companies and nonprofit organizations as a $60 million, 5-year public-private partnership. The primary goal of the ADNI has been to test whether serial image (MRI, PET) and nonimage (other biological markers) measures can be combined to measure the progression of mild cognitive impairment (MCI) and early AD. The determination of sensitive and specific markers of very early AD progression is intended to aid researchers and clinicians in developing new treatments and in monitoring their effectiveness, in addition to decreasing the time and money needed for clinical trials. Data are collected at a range of academic institutions and private corporations, and subjects have been recruited from over 50 sites across the United States and Canada. The complete background and methodological detail of the ADNI data as well as up-to-date information can be found on the project website.\nA total of 708 (421 men and 287 women, age 75.61\u00b16.76 years) subjects with anatomical MRI scans were involved, including 164 AD, 346 MCI, and 198 healthy subjects. These MRI scan were obtained on a 1.5 T MRI scanner using a 3D MPRAGE sequence in the sagittal plane. The scan parameters were as follows: the repetition time (TR) was 2400 ms, the inversion time (TI) was 1000 ms, the flip angle was 8\u00b0, and the field of view (FOV) was 24 cm with a 256\u00d7256\u00d7170 acquisition matrix (x-, y-, and z-dimensions), which yielded a voxel size of 1.25\u00d71.26\u00d71.2 mm 3 .\nThe standard process of approaching the MRI data included the following: (a) The use of a nonparametric nonuniform bias correction (N3) for image intensity inhomogeneity correction [29] . (b) Skull stripping [30] and warping a labeled template to each skull-stripped image to remove the cerebellum (aBEAT in version 1.0, http://www.nitrc.org/projects/abeat). (c) The segmentation of each brain image into four different tissues, i.e., white matter (WM), gray matter (GM), cerebrospinal fluid (CSF), and ventricles (VN), using the FAST method [31] A C C E P T E D M A N U S C R I P T (FAST in FMRIB Software Library version 5.0, https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/). (d) All the images were registered to the common template using the 4D-HAMMER method proposed in [32] (HAMMER in version 1.0, https://www.nitrc.org/projects/hammer/). (e) Finally, the use of the deformation field to generate the RAVENS maps [33] , which can be used to quantify the local volumetric group differences for the whole brain volume and for each of the tissue types (WM, GM, CSF, and VN).\nWe used the Human 610-quad Beadchip (Illumina, Inc., San Diego, CA) to acquire the genotype data of 818 subjects, including 620,901 SNPs, all of which were provided by the ADNI dataset. To avoid the effect of population stratification, we used only 749 Caucasians (selected from the 818 subjects) with both genetic data and imaging data at the baseline in our study. Then, quality control procedures (QCP), including the steps presented below, were performed to exclude unsatisfactory data through a (1) gender check; (2) population stratification; (3) sibling pair identification; (4) call rate check for each subject and each SNP marker; (5) marker removal according to the minor allele frequency; and (6) the Hardy-Weinberg equilibrium test.\nNext, we screened the SNPs for the following: (1) at least 95% retention values;\n(2) at least 95% minor allele frequency; and (3) Hardy-Weinberg equilibrium p-values >10 -6 . We input the remaining missing genetic data as the modal value. After the QCP and SNPs screening procedures, there were 708 subjects remaining, and each subject obtained 501,584 SNPs during the analysis to follow.\nrecovered using its neighboring voxels. To verify this assumption, we designed controlled trials by setting whether \uf028 \uf029 \u03a8 \uf0d7 was zero in the simulation studies. The result that applied the nonlocal method was supposed to be better if the assumption was valid. Moreover, in the analyses with real data, we performed our method with the nonlocal process to select the significant biomarkers. Considering that different weighted functions lead to different effects on correlations among voxels, here we selected three different weighted functions, namely, the GS function, NLM and BM3D/BM4D to perform our method, and their underlying theories are detailed below.\n\n\nmanual for optimal GS parameters [42] . During our experiment, we fixed 3 h \uf03d and changed G \u03a9 to the range (17\u00d717, 21\u00d721, 25\u00d725, 29\u00d729, 33\u00d733). As shown in Fig. 2A , 25 25 G \u03a9 \uf03d\uf0b4 had the highest AUC, whereas the AUC decreased with the value of G \u03a9 was higher or lower than 25\u00d725. We then fixed 25 25 G \u03a9 \uf03d\uf0b4, and changed h to a range of (3, 4, 4.3, 4.5, 4.7, 5) . As shown in Fig. 2B , the AUC decreased with the value of h was higher or lower than 4.3. Therefore, to achieve the best GS performance, the parameters G \u03a9 and h were set to 25\u00d725 and 4.3, respectively.\nFor weight setting by NLM, the parameters , the NLM achieved the highest AUC ( Fig. 2E) . Therefore, to achieve the best performance of NLM, the parameters 1 N \u03a9 , 2 N \u03a9 , and t were set to 11\u00d711, 7\u00d77, and 0.05, respectively.\nFor weight setting by BM3D, the parameter f (the degree of BM3D) was set\nbased on Dabov's study [39] . We changed f to a range of (2, 6, 10, 14, 18) . As shown in Fig. 2F, BM3D performed best when 10 f \uf03d . Therefore, f was set to 10 for the BM3D.The optimal parameter settings used in the three weights are summarized in Table 1 . Table 2 lists the computational costs of the nonlocal method mentioned above for either 2D simulation data or 3D real data. For the 2D imaging data process, NLM had a cost of close to 10 4 s, which took a hundred times slower than GS or BM3D. It was expected to have a higher computational cost for the 3D images. Due to the excessive computational burden of NLM, we excluded it from the real 3D data analysis procedure. To evaluate the performance of the nonlocal method in detecting casual SNP rate, we set \uf067 \uf02a= 0.0005, 0.001, 0.005, and 0.01, which correspond to the weak genetic signal (0.0005 and 0.001) and the moderate/strong signal (0.005 and 0.01),\nrespectively. The top 0 N SNPs were set to a range from 100 to 2000. In addition, the number of causal SNPs ( q ) was set to 100. The causal SNP rate casual R was calculated as\nwhere 0 N c was the number of causal SNPs in the candidate significant locus set 0 C , and q N was the total number of causal SNPs. As shown in Table 3 , the application of the nonlocal method presented larger causal SNP rates than not applying the nonlocal method, which indicated that more causal SNPs were included in set 0 C , and the nonlocal method whose weight setting was done by the GS function had the best result for a weak genetic signal. For medium/strong signals, the results were close to one another. To evaluate the performance of the nonlocal method in detecting the causal voxel-SNP pairs in the affected ROIs, we used the ROC curves as an evaluation approach. The parameters 0 , N \uf067 and q were set to 100, 0.01 and 100, respectively. To eliminate the effect of the location of the ROI, we chose three different brain areas with a size of 10\u00d710 as the prefixed effect ROIs for analysis, as shown in the first column of Fig. 3 . The second column of Fig. 3 presents the ROC curves that correspond to the three ROIs. As expected, at the three locations of the affected ROIs that we chose, the AUC values of applying the nonlocal method (GS, NLM, BM3D/4D) were larger than the values when not applying the nonlocal method (N-Weight). Moreover, the nonlocal method setting weights by the GS function, always obtained the best results for the three ROIs. From comparison of the three ROC curves, we can see that there was only slight difference among the three locations of the affected ROIs. To evaluate the performance of the nonlocal method in detecting the causal cluster-SNP pairs, we identified the clusters of the contiguous suprathreshold pixels using an uncorrected 0.01 p-value threshold. In addition, the other parameters , , , nq\uf073\uf067 and ROI were set to 1000, 100, 1, 0.01 and 10\u00d710, respectively. We used a number of \"false positive\" clusters (a threshold cluster that did not overlap with any pixels of the prefixed, affected ROI at any causal\n\nSNP) and the size of the number of pixels in the false positive clusters to demonstrate the accuracy of our detection method. In addition, we used the dice overlap ratio (DOR), which was the ratio of the number of true positive pixels to the size of the affected ROI, to compare the nonlocal method and the absence of nonlocal method application results. A larger average DOR value corresponded to more effective detection power. As shown in Fig. 4A and B , no false positive cluster was detected by our method either with nonlocal operation or without nonlocal operation. Fig. 4C shows that the nonlocal method has a larger average DOR value than the result of not applying the nonlocal method. Besides, the nonlocal method with weight setting by the GS function, had the largest average DOR value (Fig. 4C) and was thus believed to have the most effective detection power. To evaluate the overall Type I error rates (that is, the rate of rejecting the null hypothesis when it is true) of the nonlocal method, we set 0 \uf067 \uf03d (null hypothesis)\nand calculated the familywise error rate (FWER) at the level of both the (voxel, locus) pairs and the (cluster, locus) pairs [46, 47] . For each weight, we conducted 1000 replications in a test to assess the FWERs, and the significance level (\uf061 ) was varied between 0.1 and 0.5. For any particular multiple testing procedure, it is said that a particular Type I error rate must be controlled for at the level of I \uf061 . If the FWER was no larger than I \uf061 then the test was deemed conservative; otherwise, the test was deemed anticonservative or liberal [46] . Here, we set 0.005\n. As shown in Table 4 , we list the results of FWERs that corresponded to different significance levels of \uf061 to detect significant voxel-SNP pairs and significant cluster-SNP pairs. Applying the nonlocal method has larger rejection rates, indicated that it was more accurate for detecting significant voxel-SNP pairs and significant cluster-SNP pairs. Moreover, the nonlocal method with the weight setting by the GS function, always has the largest rejection rates. . Table 5 showed causal R with different top 0 N SNPs. We\nfound that the performance of applying the nonlocal method (GS, NLM, and BM3D) was better than that of FGWAS in terms of weak and moderate/strong signals, indicating that our method achieved a strong power to detect casual SNPs. \nthe assistance of prespecified values (ground truth), we addressed this problem based on statistics in this section. In the GSIS procedure, we defined W(c) as the global Wald-type statistic at c locus, and used an approximation method to calculate the p-value of all W(c)s. We sorted the \uf028 \uf029 . Biologically, it is expected that important genetic markers should be associated with relatively large ROIs [18, 28] . Therefore, we could use the p-values of W(c)s to estimate the association strength between the whole brain and the genetic data and to select the most relative loci. In this study, we applied a nonlocal method to process the images to incorporate spatial correlations. We hoped that incorporating the spatial correlations could strengthen the associations between the whole brain and the genetic data, leading to a reduced p-value of W(c). Therefore, we used the p-values of W(c)s to select the optimal parameters of the three different weighted functions. The optimal parameter settings used for the weights and the results are summarized in Table 6 .\n(1) For weight setting by the GS function, we fixed 4.3 h \uf03d , and changed G \u03a9 to a range of (11\u00d711, 15\u00d715, 19\u00d719, 23\u00d723, 25\u00d725). As shown in Table 6 , 15 15 G \u03a9 \uf03d\uf0b4 had the smallest p-values, whereas the p-value increased with the value of G \u03a9 was higher or lower than 15\u00d715. Then, we fixed 15 15 G \u03a9 \uf03d\uf0b4, and changed h to a range of (0.3, 0.5, 1.5, 2.5, 3.5). As shown in Table 6 , the p-values increased with the value of h was higher than 0.5. Therefore, the parameters G \u03a9 and h were set to 15\u00d715 and 0.5, respectively. (2) For weight setting by BM4D, we changed the parameter f to a range of (6, 8, 10, 12, 14) . As shown in Table 6 , BM4D performed best when 8 f \uf03d . Therefore, f was set to 8 for BM4D. Table 6 . The parameters and select results for the weight setting by the GS function and the weight setting by BM4D. The bold font corresponds to the parameter we selected (W is the GS window; h is the degree of GS; and f is the degree of BM4D) (GS: Gaussian; BM4D: Block-matching and 4D filtering). Fig. 5 shows the Manhattan and QQ plots of GWAS for the whole region of the brain's RAVENS maps. Fig. 5A shows the Manhattan plots with the weight setting by the GS function and we found that there was one detected SNP in chromosome 10 near the widely used threshold 5\u00d710 -8 in the GWAS. In Fig. 5C  (the QQ plot) , shows that the distribution of the observed p-values fit the expected p-values well for most p-values when the null hypothesis was true. Moreover, the distribution of the observed p-values in the upper tail could be compared against that of the expected p-values, which has an obvious deviation and indicates a strong association between these SNPs and the imaging data. Fig. 5B shows the Manhattan plot with the weight setting by BM4D and we found no SNP was detected to pass the threshold of 5\u00d710 - 8 . Fig. 5D shows the QQ plot with the weight setting by BM4D, which has a similar result to that of the GS function. However, there was slightly smaller deviation in the upper tail than deviation in Fig. 5C , demonstrating that the association between SNPs and imaging data found with BM4D is weaker than the association found with GS function. In Table 7 , we report the top 10 SNPs that were associated with the entire region of the RAVENS brain maps, including the corresponding SNPs, chromosome IDs, base pair (BP) values, p-values, and gene. As reported in Table 7 , all of the SNPs surpassed the significance level of 10 -5 with both the weight setting by GS function and the BM4D. The gene ANK3 (chr10) has been known to be associated with mental retardation. The mutations in the ANK3 gene could be involved in bipolar disorder and/or intellectual disability. The gene TYK2 (chr2) is known to be associated with immunodeficiency 35 and lymphomatoid papulosis. TLR4 (chr10) is an age-related gene. MEIS2 (chr15) is associated with learning disabilities and was found by the nonlocal method with weight setting by the GS function. ANK3 and TYK2 could be found by the nonlocal method with weight setting by BM4D. Table 7 . ADNI whole-brain GWAS: top 10 SNPs that were selected for association with the brain-wide conditions (GS: Gaussian; BM4D: Block-matching and 4D filtering). Table 8 . Fig.  7 shows some symmetric clusters that were observed; it could be biologically plausible to observe the symmetric associations between the SNPs and the clusters. \n\n\n\n\nFVGWAS was proposed in our previous studies [18] and has been applied within our framework to alleviate the computational burden. Considering the advanced acceleration of FVGWAS [18] , we did not compare our proposed method with the traditional vGWAS in terms of computational time in this study. Thus, our method not only retained low complexity and a fast calculation ability but also addressed the important spatial correlations issues that were ignored in previous work. In addition, the nonlocal method was supposed to have the potential to target a much larger number of significant AD-associated biomarkers in neuroimaging. Consequently, the exploitation of nonlocal method in vGWAS is meaningful for AD prediction, diagnosis, and monitoring.\nIn the simulation studies, we designed experiments to evaluate whether the nonlocal method applying in our framework work or not. For the results of the causal SNP rate shown in Table 3 , there are significant differences between the methods with nonlocal operation (GS function, NLM and BM3D) and those without nonlocal operation (procedure-weight) for a weak genetic signal, whereas for a moderate/strong signal, their results were close to one another. Therefore, it can be considered that the nonlocal method is effective within our framework, especially for the weak signal that was usually difficult to detect in other previous studies. In fact, the assumption of the nonlocal method, i.e., an unknown voxel can be estimated by the neighboring voxels, exactly satisfies the inherent characteristic of an image in which the information in the image is so redundant that we can even utilize the neighboring voxels to represent the unknown voxel. In other words, the results of the causal SNP rate verified this assumption further, as we mentioned in method section. On the other hand, we compared the three weighted functions in both the simulation studies and the analyses with real data. In Table 3 , the nonlocal method with weight setting by the GS function achieved the largest causal SNP rates when the genetic signal was weak, presenting a strong power to detect causal SNPs. In Fig. 3 , at the different ROI locations, the ROC curve with GS function outperformed the other methods, indicating a strong power to detect causal voxel-SNP pairs in the affected ROIs. In Fig. 4C , the nonlocal method with weight setting by the GS function also obtained the largest average DOR, suggesting that this method could detect the ROI correctly. In Table 4 , the nonlocal method with weight setting by the GS function had the largest rejection rates, implying that it was accurate for detecting significant voxel-SNP pairs and cluster-SNP pairs. In the analyses with real data, the QQ plot\nwith GS function had a slightly larger deviation in the upper tail than that shown in the QQ plot with BM4D, demonstrating that the association between SNPs and the imaging data found with GS function was stronger than the association found with BM4D ( Fig. 5 ). Therefore, the weights set by the GS function always had the best performance among the three weighted functions possibly because of the following reasons: 1) For a given voxel, the neighboring voxels are assigned weights that are decaying by distance in the GS function. This approach exactly conforms to the law of pathology present in neuroimaging in which disease-related regions are generally perceived to be contiguous. 2) In contrast to the GS function, which depends on the similarity among voxels, the weights set by NLM and BM3D/BM4D incorporate spatial correlations depending on the similarity among patches. Their worse performance compared with the GS function may be attributed to a lack of strong correlations between similar patches in the brain MRI scans.\n3) The MRI data collected in the spatial frequency space are usually corrupted by Gaussian noise [48] , and GS can help reduce the effect of Gaussian noise by exploiting the spatial correlations. Therefore, the nonlocal method with weight setting by the GS function always obtained the best results.\nBesides, there was a slight difference in the ROC curves among the three locations of the affected ROIs in Fig. 3 , presumably because of the gray difference degree at different locations in the brain. This finding could affect the weights setting and thus affect the estimate results.\nIn our method, some new risk genes and clusters were detected, which will contribute to the prevention and earlier treatment for AD. As listed in Table 7 , the genes that we detected included ANK3 (chr10), which is associated with mental retardation; MEIS2 (chr15), which is associated with learning disabilities; and TLR4 (chr10), which is an age-related gene. Therefore, we can conclude that those genes could affect the occurrence of AD. As shown in Table 8 , we found that the following areas of the brain that exhibited changes would be affected by the progression of AD: the hippocampus, which is related to memory and cognition [49] ; the inferior frontal gyrus, which is associated with language comprehension and production; the insula, which is involved in consciousness and plays a role in both self-awareness and cognitive functioning; the precuneus, which is involved in episodic memory, reflections on the self, and aspects of consciousness; the caudate nucleus, which experiences a 'significant reduction\nin the caudate volume' in AD patients [50] and is linked with patients diagnosed with schizophrenia; the putamen, which is associated with cognitive decline in AD and is also correlated with schizophrenia and depression; the thalamus, which provides differentiation in the functioning of recollective and familiarity memory; and the temporal gyrus, which is connected to memory, emotion, language comprehension and recognition.\nMany issues remain to be solved. Some unobservable and latent factors accounting for the final analyses have been completely ignored, as elucidated in some studies [51, 52] . To address this problem, for example, Zhu [53] proposed a Bayesian generalized low rank regression model (GLRR) based on a Markov chain Monte Carlo algorithm, but the cost of the computational complexity would be difficult to overcome. Overall, we can attempt to introduce unobservable latent factors into our model in some way to improve its performance. In addition, because of a variety of image phenotype characteristics drawn from different neuroimaging modalities (e.g., functional MRI, PET, and diffusion tensor imaging), different image phenotypes combined with our research would probably achieve better results.\n"}, {"section_title": "Materials and methods", "text": ""}, {"section_title": "Data preprocessing", "text": ""}, {"section_title": "Spatial correlations exploitation", "text": "We will begin our methods with a brief symbol introduction. Suppose that we observe imaging data, clinical variables, and genetic markers from n dependent subjects. Let V be a selected brain region that contains V N voxels, and let v be a voxel in \uf028 \uf029 \nas the genetic data for the i-th subject at locus c , where il z is the l-th genetic data and L is the dimensions of genetic data. In particular, we assign values of 0 (major homozygous alleles), 1 (heterozygote) and 2 (homozygotes of minor alleles) to the three types of SNPs.\nTo apply the spatial correlations reasonably in a vGWAS, the nonlocal method we broadly presented above should be introduced to our framework. The assumption of the nonlocal method is that an unknown voxel can be estimated by the neighboring voxels. The model is designed as follows:\nwhere \uf028 \uf029 j yv denotes the value of voxel j in neighborhood \uf051 centered at voxel i, and \uf028 \uf029 \u03a8 v denotes the weighted function. Obviously, the key to this model is to find a suitable function for fitting the weights of the neighboring voxels as well as possible. This strategy, which is always regarded as a nonlocal method, is applied during our first step, and we selected three commonly weighted functions to incorporate the spatial correlations in the images. The first weighted function was the GS function, which is most commonly used in image weighting processing [34, 35] . The second one was performed by NLM, which is known as the data-adaptive image process technique [36, 37] . Moreover, the last function involved BM3D/BM4D to process the imaging data because of its superior effect on image processing [38] [39] [40] . After that, the FVGWAS procedures, including the GSIS and detection procedures, were performed to detect significant biomarkers efficiently.\nIn the introduction section, we sketched our entire framework consisting of the nonlocal method and FVGWAS under the assumption that a given voxel could be"}, {"section_title": "GS weight", "text": "Empirically speaking, the correlation between two voxels depends on their distance because the voxels in the images are not isolated from one another. This distance leads in a direction for assigning the weights, and it is just what the GS function relies on. The 2-dimensional GS function has been widely used for image processing. It assumes that the weights of the voxels decay by the distance from the given voxel. In a square neighborhood \uf051 centered at a given voxel, the GS function configures a weight matrix to convolve with the voxels [41] for estimating the given one.\nThe weights calculated by the GS function are denoted as G \u03a8 , and in the same way N \u03a8 and B \u03a8 are for NLM and BM3D/4D, respectively. The\nwhere k v denotes voxel k belonging to domain\nH is a normalization constant, and h is the standard deviation. Specifically, a larger h leads to a stronger dependence between voxels. The optimal h could be set in the range of 11 64 mm h \uf02d\uf02d \uf0a3\uf0a3 [42] , where m was one dimension of the square neighborhood"}, {"section_title": "NLM weight", "text": "As the most popular application of the nonlocal method, the NLM approach proposed by Buades [36] is efficient and has provided an incredible breakthrough in image processing. In this paper, we scanned a search window ( 1 N \u03a9 ) of the image in search of similar patches (similar windows 2 N \u03a9 ) that clearly resemble the given patch of interest.\nThe weights for similar patches in the NLM are defined as\nwhere T is the normalizing constant, t is the standard deviation that controls the degree of weighting, and indicate the values of voxel vectors belonging to a given patch centered at voxel i and a similar patch centered at voxel j , respectively. It is therefore clear that the interpatch similarities are weighted by the Euclidean distance. Specifically, all the voxels in a similar patch have the same importance; that is, the weights of all the voxels in the same patch are shared."}, {"section_title": "BM3D/BM4D weight", "text": "BM3D (for 2-dimensional data in our simulation studies) or BM4D (for 3-dimensional data in our analyses with real data) are based on an enhanced sparse representation in the transform-domain, and each was proposed as a novel image processing method. Similar to NLM, BM3D/BM4D is based on the same assumption that there are mutually similar blocks in images [38] [39] [40] . To calculate the weight for each voxel, BM3D/BM4D has the following two major steps: basic estimate and final estimate; then there are three operations within both steps, namely, grouping, collaborative hard-thresholding (or Wiener filtering) and aggregation. Therefore, the formulation of weights is hard to describe, with details in [39] . Compared to the two other weighted methods, this strategy clearly has a higher computational cost."}, {"section_title": "FVGWAS procedure", "text": "During this step, we attempted to find the association between the genotypes and imaging phenotypes by using the FVGWAS framework. Here, we briefly introduce the rationales and the scientific basis of FVGWAS, and more details can be found in [18] .\nThe FVGWAS model formulation was as follows:\ncorresponded to the matrix of clinical covariates, the matrix of image measurements, and the matrix of genetic data, respectively.\nwere the coefficient matrices and they referred to the covariate effect and the genetic effect, respectively.\nis the measurement error.\nNote that it was crucial to test the null hypothesis. Here, for all (voxel, locus) pairs, we need to test the following:\nwhere 0 H represents that there is no association between the genetic data and the imaging data. We then introduce the standard Wald-type test statistic to obtain the p-values to test the null hypothesis.\nThe calculation of the Wald-type test statistic for the entire genome is computationally intensive. To solve this problem, the FVGWAS introduced a GSIS procedure to speed up the calculation. The primary idea of GSIS is to reduce the dimension from a very large scale to an appropriate scale by eliminating many 'noisy' loci (no-effect loci). Since detecting widespread genetic effects is more powerful and meaningful than testing for local effects during neuroimaging, we calculated a global Wald-type statistic at locus c as follows:\nA"}, {"section_title": "C C E P T E D M A N U S C R I P T", "text": "We then used an approximation method to select significant voxel-locus pairs, in virtue of sorting the \uf028 \uf029 10 log p \uf02d -value of all of the global Wald-type test statistics for the entire genome, and then we selected the top 0 N loci, denoted as\n, as the significant candidate locus set.\nThe detection procedure for FVGWAS contained two primary wild bootstrap methods. One was used to simultaneously detect the significant (voxel, locus) pairs by calculating a maximum statistic over all of the voxels for the top 0 N loci.\nThe other was used to simultaneously detect the significant (cluster, locus) pairs by calculating a maximum cluster size statistic for the top 0 N loci. As discussed before, the wild bootstrap can prevent the repeated analyses of simulated datasets and that is why it can considerably reduce the computational."}, {"section_title": "Results", "text": ""}, {"section_title": "Simulation studies", "text": "In this section, we executed simulation studies by using Monte Carlo simulation studies to evaluate the prediction performance of vGWAS with the nonlocal method. For simplicity, we considered only 2D imaging data during the simulation studies. All these numerical computations were performed on an IBMServer3 with MATLAB.\nThe simulated imaging data contained 3355 V N \uf03d pixels in the brain region of 128\u00d7128 images, which corresponded to the middle slice of the 3D brain images obtained from ADNI. With the assumption that the SNPs were additive and homogeneous, the simulation of imaging data \uf028 \uf029 i yv was, therefore, generated using the following model"}, {"section_title": "ACCEPTED MANUSCRIPT", "text": "where\nwere the simulated clinical covariates that were generated from either the binomial distribution with the probability of 0.5 (for discrete variables, e.g., gender) or \uf028 \uf029 0,1 U (for continuous variables, e.g., age).\nThe variables \uf028 \uf029 ij c z were the simulated genetic data generated by the linkage disequilibrium blocks defined by the default method [43] of Haploview [44] and PLINK [45] . The estimate values of \uf028 \uf029 For the other parameters of the FVGWAS framework, we chose the first q SNPs as the causal SNPs and set q as 100. The sample size ( n ), the standard deviation of the measurement error (\uf073 ) and the number of bootstrap samples were set to 1000, 1 and 100, respectively.\nWe performed a series of experiments to optimize the parameters of the three types of weight. For each experiment, we tuned only one parameter and fixed the other parameters. We then used the Receiver Operating Characteristic (ROC) curves to evaluate the effectiveness of the weight setting with different parameters for detecting the causal voxel-SNP pairs. The parameter that resulted in the highest Area Under Curve (AUC) value was regarded as the optimal value.\n\n"}, {"section_title": "Optimal parameters of three weighted functions", "text": "For weight setting by the GS function, the parameters G \u03a9 (the size of the GS window) and h (the degree of the GS) were set based on Seibold's introduction"}, {"section_title": "The effect of nonlocal method", "text": ""}, {"section_title": "Analyses with real data", "text": "Here, we considered the RAVENS maps to illustrate the power of the proposed method with 708 subjects, including 193,275 voxels and 501,584 SNPs. The clinical covariates included the age, gender, intercept, and whole brain volume as well as the top 5 principal component scores for the SNPs in the ADNI data analysis. When 0 1000 N \uf03d , the computational time of integrating the spatial correlations for all 708 subjects is given in Table 2 . Moreover, our whole framework with the weighted function of GS function and BM4D required 23,211 and 202,594 s, respectively.\nThe strategy of the optimal parameters selection for the three weighted functions should differ from that in simulation studies. With simulated data, we can prespecify the SNPs that remarkably contribute to the imaging measures and the affected ROIs, such as like prior knowledge in statistics. However, exact SNP-voxel/cluster pairs in GWAS have yet to be verified. In this case, without"}, {"section_title": "Conclusions and discussion", "text": "In this paper, we proposed a novel vGWAS method based on spatial correlations exploitation that is expected to boost the power of detecting potential AD biomarkers. On the one hand, the importance of spatial correlations in neuroimaging studies cannot be neglected, especially those that had been demonstrated many times in previous studies [14, 19, 20, 23, 24] . Therefore, in our paper, a nonlocal method has been employed to integrate the complex correlations among voxels in imaging data. It is actually a widely used strategy in the field of image processing, and it achieved good results. As we discussed before, the key of this method is the weighted function. Thus, we selected three representative weighted functions, including the GS function, NLM and BM4D, to integrate the neighboring information around each voxel. On the other hand,"}, {"section_title": "Conflicts of interest", "text": "We declare no conflicts of interest with this paper. Highlights \uf0b7 Exploiting spatial correlations in neuroimaging data holds the potential to improve detecting accuracy of AD biomarkers; \uf0b7 GS weighted method applied in the nonlocal operation performs best than other classic weighted methods; \uf0b7 Proposed method accelerates the whole calculation of traditional vGWAS; \uf0b7 Several AD-related genes and brain regions have been identified successfully."}]
[{"section_title": "Abstract", "text": "Due to its high dimensionality and high noise levels, analysis of a large brain functional network may not be powerful and easy to interpret; instead, decomposition of a large network into smaller subcomponents called modules may be more promising as suggested by some empirical evidence. For example, alteration of brain modularity is observed in patients suffering from various types of brain malfunctions. Although several methods exist for estimating brain functional networks, such as the sample correlation matrix or graphical lasso for a sparse precision matrix, it is still difficult to extract modules from such network estimates. Motivated by these considerations, we adapt a weighted gene co-expression network analysis (WGCNA) framework to resting-state fMRI (rs-fMRI) data to identify modular structures in brain functional networks. Modular structures are identified by using topological overlap matrix (TOM) elements in hierarchical clustering. We propose applying a new adaptive test built on the proportional odds model (POM) that can be applied to a high-dimensional setting, where the number of variables (p) can exceed the sample size (n) in addition to the usual p < n setting. We applied our proposed methods to the ADNI data to test for associations between a genetic variant and either the whole brain functional network or its various subcomponents using various connectivity measures. We uncovered several modules based on the control cohort, and some of them were marginally associated with the APOE4 variant and several other SNPs; however, due to the small sample size of the ADNI data, larger studies are needed."}, {"section_title": "Introduction", "text": "Resting-state functional magnetic resonance imaging (rs-fMRI) is gaining popularity in studies of brain functional connectivity with applications to detection of subtle network reorganizations in Alzheimer's disease. 1 Disruption of connectivity in the brain functional network is related to many pathological conditions in the brain, such as Alzheimer's disease, 2 schizophrenia, 3 or autism. 4 This necessitates the development of methods for modelling the brain functional network its statistical inference.\nA network is comprised of nodes and edges connecting the nodes. Based on functional MRI data, a popular choice of nodes are brain regions of interest (ROIs) while the edges are connectivities reflecting statistical dependencies between ROIs. An important network model, the scale-free network, 5 assumes that most nodes in a network are sparsely connected with the exception of a few \"hub\" nodes that are densely connected with other nodes. In the scale-free network model, new connections are more likely to occur for those hub nodes with already-high connectivity. There has been empirical evidence supporting this model for brain functional networks, 6 though it is still debatable. In addition, the scale-free network model also admits a modular topological structure, which can be extracted for more efficient analyses for human brains.\nMethods for drawing statistical inference to distinguish brain connectivity for different groups of subjects are still under development. The first question encountered is how to define brain functional connectivity. Ref. 7 discussed the choice between Pearson's marginal correlation coefficient and partial correlation coefficient as a network connectivity measure, though other measures are possible and it is yet unclear which one is best. To reduce dimensionality and to reach sparseness, graphical lasso is often used for estimating networks for different groups. Since an estimated network with the imposed sparsity penalty may not demonstrate modular structures, a better approach is to directly discover the modules in a network. A general framework for estimating scale-free networks and detecting modules is proposed in Ref. 8 for gene network analysis, which has gained tremendous popularity in genomics. 9 It starts by defining a similarity measure between two nodes in a network, called adjacency, using the marginal correlation coefficient. Soft-thresholding is then applied, leading to a weighted network. The soft-thresholded adjacency is further transformed to a topological overlap matrix (TOM) element, which is converted to a dissimilarity measure for hierarchical clustering, grouping closely connected nodes together as modules in the network. The above framework not only provides multiple network connectivity measures, but also carries out modular structure identification. The connectivity measures and identified modules in the brain functional network may help statistical inference and offer biological insights. 9 In this paper, for the first time, we adapt the use of WGCNA for gene expression data to rsfMRI data, constructing weighted brain functional networks and identifying their subnetworks or modules using the Alzheimer's Disease Neuroimaging Initiative (ADNI) data. We explored using the adjacency matrix element and TOM element, in addition to the marginal correlation or covariance, to characterize connectivity in brain functional networks. Taking advantages of detected network modules, we conduct association analysis of genetic variants with not only the whole brain functional network, but also its various subcomponents, including its modules, which aims to not only improve statistical power, but also offer better biological interpretation. We propose applying a new adaptive association test based on a proportional odds model (POM) accounting for the ordinal nature of the SNP genotype. We found evidence of associations between several network modules and the APOE4 variant, which is by far the most significant genetic risk factor for Alzheimer's disease. This paper is organized as follows. We first review the method of WGCNA, including its module identification, then introduce the adaptive test based on a POM. We demonstrate the application of our methods to the ADNI data before summarizing our findings and future research directions in the discussion section."}, {"section_title": "Methods", "text": ""}, {"section_title": "Module detection via weighted gene co-expression network analysis", "text": "In this section, we briefly review the work in Ref. 8 on the weighted gene-coexpression network analysis (WGCNA) framework for network construction and module identification."}, {"section_title": "Adjacency matrix", "text": "The first step of the WGCNA framework is to define a similarity measure between gene expression profiles; in the current context, we use the BOLD signals in each of multiple ROIs from one or more subjects to calculate a similarity between any two ROIs. The similarity measure is required to take values between 0 and 1. A typical choice of this similarity measure is the absolute value of the Pearson correlation coefficient s uv = |cor(u, v)|, for nodes u and v. Another choice, which preserves the sign of correlation, is defined as s uv = [1 + cor(u, v)]/2. We refer the first one as unsigned similarity measure, and the second one as the signed similarity measure. From our experience of applications to the ADNI data, the identified modules have negligible differences using either unsigned or signed similarity measure. We used the unsigned similarity measure throughout this paper.\nOnce the similarity measure is computed, the next step is to transform the similarity matrix S = [s uv ] into an adjacency matrix using an adjacency function. Hard thresholding is often used to yield a binary or unweighted network with a 0/1 adjacency indicating noconnection/connection and thus possible loss of information, though a more efficient multiscale approach with multiple thresholds yielding a set of binary networks has been proposed. 10 Soft thresholding is a simple and popular alternative with more flexibilities. One choice is the power adjacency function\nwith parameter \u03b4, which is chosen as the smallest integer such that the scale-free network model fitting is above a certain threshold."}, {"section_title": "Topological overlap matrix", "text": "Instead of using only the adjacency matrix, Ref. 11 advocated a topological overlap matrix \u2126 = [\u03c9 uv ] with its element as a potentially more useful measure that reflects the relative interconnectedness of two nodes u and v after accounting for their shared neighbors. The topological overlap matrix element is defined as\nwith k u = v a uv and l uv = q a uq a qv . For a binary network with a uv = 0 or 1, k u is the connectivity of node u representing the number of its direct neighbors, while l uv equals the number of nodes that connect both nodes u and v; \u03c9 uv = 0 if the nodes u and v are not connected and they are not connected to the same neighbors; in contrast, \u03c9 uv = 1 if the nodes u and v are connected and the neighbors of the node with fewer edges are also connected to the one with more edges. For any network, 0 \u2264 a uv \u2264 1 implies 0 \u2264 \u03c9 uv \u2264 1."}, {"section_title": "Module identification", "text": "To identify modules in a network, we need to have a dissimilarity or distance measure. An intuitive way is to convert a similarity measure. Based on the topological overlap matrix element \u03c9 uv , we can simply define the dissimilarity measure as d \u03c9 uv = 1 \u2212 \u03c9 uv . The TOM-based dissimilarity d \u03c9 uv is used as the input for average linkage hierarchical clustering. The output from hierarchical clustering is a dendrogram composed of branches and leaves. In a brain functional network, each leaf corresponds to a ROI. The hierarchical clustering algorithm groups the closest ROIs and forms the branches. By cutting the branches of the dendrogram, closely related ROIs are identified as a module. Among the several methods for cutting the branches of the dendrogram, the default used in the WGCNA framework is Dynamic Tree Cut from the R package dynamicTreeCut.\nOnce modules are identified, one can calculate an intramodular connectivity\nfor each node u in its module M . Ref. 8 pointed out that intramodular connectivities \u03c9.in may represent important features of the nodes (i.e. ROIs)."}, {"section_title": "An adaptive association test based on the proportional odds model", "text": "Let Y i = 0, 1, 2 denote the count of the minor allele for subject i for a given SNP of interest, then Y i has J = 3 ordered categories. The logistic regression model cannot be applied in this situation, because it only allows the response variable to be binary. A popular choice for ordinal data is the proportional odds model (POM), 12 which we will briefly describe here. Suppose subject i has p network connectivities denoted by X i = (x i1 , . . . , x ip ) and l covariates denoted by Z i = (z i1 , . . . , z il ). For the proportional odds model, we define the regression coefficients \u03b2 = (\u03b2 1 , . . . , \u03b2 p ) for the network connectivities and \u03b4 = (\u03b4 1 , . . . , \u03b4 l ) , and a vector of intercepts \u03b1 = (\u03b1 0 , . . . , \u03b1 J\u22122 ) . The proportional odds model is\nThe likelihood for equation Eq. 4 can be derived based on the multinomial distribution for the categorical variable Y i , from which maximum likelihood estimates and statistical inference can be obtained as implemented in R package MASS or VGAM. However, numerical issues such as non-convergence arise when p, the dimension of \u03b2, is relatively large as compared to the sample size n.\nHere we propose applying a class of tests that are applicable to the high-dimensional setting with p > n, from which an adaptive test is constructed to summarize information across the tests. No that most existing tests cannot be applied to the case p > n. To test the null hypothesis H 0 : \u03b2 = (\u03b2 1 , \u03b2 2 , . . . , \u03b2 p ) = 0, we can use the score vector derived in Ref. 13 ,\ncomes from the fitted null model of Eq. 4 (i.e. with Pacific Symposium on Biocomputing 2017 \u03b2 = 0);\u03b1 and\u03b4 are estimated by the polr function in the R package MASS. Let U k denote the kth component of the score vector U \u03b2 = (U 1 , . . . , U p ) . The SPU(\u03b3) test statistic is defined as\nwhere \u03b3 \u2265 1 is an integer. As the parameter \u03b3 increases, a connectivity with a larger absolute value of the score gains a higher weight. In the extreme situation, when \u03b3 \u2192 \u221e as an even integer, SP U (\u221e) takes only the maximum component of the score vector, i.e.,\nThe p-values of the SPU tests are computed by permuting the residuals from the null model B times, and the p-value can be calculated as\nwhere\nis the SPU(\u03b3) statistic based on the bth set of permuted residuals. Since the value of \u03b3 that yields highest power cannot be determined a priori, an adaptive SPU (aSPU) test is introduced to combine the evidence across multiple SPU tests,\nwhere P SP U (\u03b3) is the p-value of SP U (\u03b3) test statistics and \u0393 is a set of integers for the power of aSPU test. In the numerical examples throughout this paper, we chose \u03b3 from the set \u0393 = {1, 2, . . . \u03b3 , and the p-value of T aSP U is\nA step-wise procedure is used to gradually increase B if needed. We can start with B = 10 3 initially, then increase to B = 10 5 (or bigger) if a p-value is smaller than 5 \u00d7 10 \u22123 (or smaller). The test is implemented in R package POMaSPU to be available on CRAN."}, {"section_title": "Results", "text": ""}, {"section_title": "ADNI Data", "text": "Data used in the preparation of this article were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). We included all subjects from the normal and Alzheimer's disease (AD) groups in the ADNI data. We applied motion correction and global signal regression to reduce noises.\nHere we used the power adjacency function a uv = power(s uv , \u03b2) = |s uv | \u03b2 (equation (1)). \u03b2 was selected as the smallest \u03b2 such that the scale-free model fitting R 2 was above a pre-set threshold 0.85."}, {"section_title": "Distinct modular structures in brain functional networks based on APOE4 SNP genotype scores", "text": "For the ADNI data, we grouped the subjects based on the APOE4 SNP (rs429358) minor allele counts (0, 1, 2). APOE4 plays a major role in the pathogenesis of Alzheimer's disease. 14, 15 The APOE4 variant is a major risk factor for both early-and late-onset Alzheimer's disease. 14, 15 We removed those subjects with a missing rs429358 value, resulting in a total of 162 subjects. Among them, 73 subjects have no minor allele at rs429358, whereas 67 subjects have one minor allele and 22 subjects have two. In order to establish possible modular structures in brain functional networks in the normal condition, we first applied the WGCNA framework to the rs-fMRI data of the control subjects only. Specifically, for each ROI, we concatenated the BOLD time series of all the control subjects, which were used to calculate the similarity between any two ROIs (i.e. the absolute value of Pearson's correlation between any two BOLD time series), then conducting the subsequent analyses in the WGCNA framework. At the end, we identified four modules based on the data from the control cohort ( Figure 1 ). Based on the modules identified, we continued to explore them for each APOE4 SNP genotype group. To measure the network connectivities, we used the correlation matrix, covariance matrix, and the topological overlap matrix (TOM). The rows and columns are ordered in the same way as in Figure 1 . Distinct modular structures seem to be present in the correlation, covariance and TOM plots across the APOE4 genotype groups (Figure 2 )."}, {"section_title": "Adaptive testing for SNP-module associations", "text": "Using the APOE4 SNP (rs429358) minor allele counts as the response in a POM, we tested the association between the APOE4 SNP and the network connectivities. Covariates including age, gender and years of education were adjusted. Using the aSPU test, we found that the covariance matrix elements were marginally associated with the APOE4 SNP (P = 0.033, Table 1 ). We further decomposed the whole network connectivities into two exclusive subsets: connectivities within the four modules and those between the modules. Both the betweenmodular covariance and TOM were associated with the APOE4 SNP with P < 0.05.\nNext we focused on the network connectivities in each individual module, and tested their association with the APOE4 SNP ( Table 2 ). The network connectivities defined by the correlations in the yellow module showed evidence of association with the APOE4 SNP (P = 0.017). In addition, the network connectivities defined by covariance matrix elements in the blue and yellow modules were also associated with the APOE4 SNP (P = 0.034, P = 0.011).\nFinally we tested for association between each module-specific intramodular connectivity \u03c9.in and the APOE4 SNP. Only the yellow module showed a significant association with P = 0.007. temporal gyrus, and inferior temporal cortex. [16] [17] [18] We found that 15 ROIs in the yellow module are also related to the 18 nodes in the DMN. For example, the posterior cingulate cortex plays a pivotal role in the default mode network of the brain. 19, 20 The posterior cingulate cortex is linked to cognitive functions such spatial memory, configural learning, and maintenance of discriminative avoidance learning and. 21, 22 It is shown in the DMN that Alzheimer's disease affects the posterior cingulate cortex. 20 Angular gyrus is another region found in both DMN and the yellow module. Loss of grey matter volume in angular gyrus has been associated with dementia and progression to Alzheimer's disease. 23 The association between the APOE4 variant and the network connectivity measures in the yellow module also uncovers some key brain regions in DMN that were found to be affected in Alzheimer's disease.\nThe ROIs in the blue module includes the left/right sides of hippocampus, lingual gyrus, cuneus, calcarine fissure and superior occipital gyrus, cerebellum and vermis. Hippocampus is well known for its key role in memory. 24 Hippocampal neuronal loss and structural change have been connected with Alzheimer's disease. 25, 26 Alzheimer's disease patients have also demonstrated neuronal and glial loss and structural changes in cerebellum and vermis. 27 Lingual gyrus, cuneus, calcarine fissure and superior occipital gyrus are located in the occipital lobe, which are mainly related to vision processing. 28 In addition, lingual gyrus plays an important role in the identification and recognition of words. 29 The association between the APOE4 SNP and the network connectivity measures may reflect the pathological changes of the brain functional network in Alzheimer's disease."}, {"section_title": "GWAS scan with individual modules", "text": "We tested for associations of the SNPs across the whole genome with the functional connectivity measures in the yellow and blue modules respectively. For genotype data, we included all SNPs with a minor allele frequency (MAF) \u2265 0.05, genotyping rate \u2265 90%, and passing the Hardy-Weinberg equilibrium test with a p-value > 0.001. After filtering with the above criteria, we obtained 579,382 SNPs.\nThe genome-wide scan showed that among the SNPs associated with the network connectivities (measured by Pearson's correlation) in the yellow module, rs17114690 on chromosome 14 was the only SNP that had a p-value smaller than 10 \u22123 . Three SNPs were founded to be associated with the network connectivities (correlations) in the blue module, with p-values smaller than 10 \u22123 . They are located on chromosome 1 (rs7536105, rs11265187) and chromosome 2 (rs17498117). rs7536105 is located in the chromatin interactive region, while rs11265187 is located in the enhancer region of gene olfactory receptor family 10 subfamily J member 9 pseudogene (OR10J9P).\nThe genome-wide scan also identified 5 SNPs associated with the intramodular network connectivity \u03c9.in for the yellow module, with P < 10 \u22125 . They are located on chromosome 1 (rs6656071, rs12043216), chromosome 7 (rs1178127, rs12674460), and chromosome 13 (rs2819239). SNP rs1178127 is a missense variant in gene histone deacetylase 9 (HDAC9), 30 an important gene with function in transcriptional regulation and cell cycle in the Wnt signalling pathway."}, {"section_title": "Discussion", "text": "In this paper we adapted WGCNA for network construction and module detection to rs-fMRI data. Based on the identified modules, we also proposed applying a new adaptive association test for single SNP association with the connectivities of the whole network or its components in a proportional odds model. While the whole network was not associated, some modulebased connectivities were significantly associated with the APOE4 SNP rs429358. Given the major role of APOE4 in the pathogenesis of Alzheimer's disease, our finding seems plausible, suggesting its possible use for genome-wide scans to detect SNP variants associated with altered brain networks and AD. Although none of the associations was highly or genome-wide significant, it was perhaps due to a too small sample size; larger studies are needed. Our use of modules, with either various ROI-to-ROI connectivities (e.g. TOM in addition to standard correlations) or some module-based node measures (such as intramodular connectivity), not only may reduce the dimension and thus improve the statistical power, but also can enhance result interpretation, highlighting where is the association if any. In particular, we found that intramodular connectivities showed more significant associations with more SNPs, possibly due to their lower dimensions (i.e. p 1 in a module with p 1 ROIs as compared to p 1 (p 1 \u2212 1)/2 of ROI-to-ROI connectivities) and/or higher information contents.\nThe multiple traits used in this paper, including various network connectivity measures in the whole network or its various subcomponents, differ from most of the previous neuroimaging studies, 31 in which the focus was on some direct measures on ROIs, not their connectivities as shown here. These phenotypes are often high dimensional with dimension exceeding the sample size. Many software packages cannot handle such a situation with p > n, which limits their use. The adaptive association test used in this paper can be applied to such high-dimensional traits. It can be a useful and powerful method for identifying associations between high-dimensional neuroimaging traits and SNPs. In this paper, we have focused on the study of the association between neuroimaging phenotypes and SNP genotype scores; however, other ordinal outcomes such as a disease status (e.g. normal, MCI and AD in the ADNI data) can be tested for their associations with neuroimaging and other endophenotypes. "}]
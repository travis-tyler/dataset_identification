[{"section_title": "Abstract", "text": "Abstract. We propose a deep neural network for supervised learning on neuroanatomical shapes. The network directly operates on raw point clouds without the need for mesh processing or the identification of point correspondences, as spatial transformer networks map the data to a canonical space. Instead of relying on hand-crafted shape descriptors, an optimal representation is learned in the end-to-end training stage of the network. The proposed network consists of multiple branches, so that features for multiple structures are learned simultaneously. We demonstrate the performance of our method on two applications: (i) the prediction of Alzheimer's disease and mild cognitive impairment and (ii) the regression of the brain age. Finally, we visualize the important parts of the anatomy for the prediction by adapting the occlusion method to point clouds."}, {"section_title": "Introduction", "text": "Shape analysis of anatomical structures is of core importance for many tasks in medical imaging, not only as a regularization prior for segmentation tasks, but also as a powerful tool to assess differences between subjects and populations. A fundamental question when operating on shapes is to find a suitable numerical representation for a given task. Hence, many different types of parameterizations have been proposed in the past including point distribution models [2] , spectral signatures [16] , spherical harmonics [5] , medial representations [6] , and diffeomorphisms [11] . Even though these representations have proven their utility for the analysis of shapes in the medical domain, they might not be optimal for a particular task.\nIn recent years, deep networks have had ample success for many medical imaging tasks by learning complex, hierarchical feature representations from images. These representations have proven to outperform hand-crafted features in a variety of medical imaging applications [10] . One of the main reasons for the success of these methods is the use of convolutional layers, which take advantage of the shift-invariance properties of images [1] . However, the use of deep networks in medical shape analysis is still largely unexplored; mainly because typical shape representations such as point clouds and meshes do not possess an underlying Euclidean or grid-like structure.\nIn this work, we propose an alternative approach to perform supervised learning on medical shape data. Our method is based on PointNet [12] , a deep neural network architecture, which operates directly on a point cloud and predicts a label in an end-to-end fashion. Point clouds present a raw and simple parameterization that avoids complexities involved with meshes and that is trivial to obtain given a segmented surface. The network does not require the alignment of point clouds, as a spatial transformer network maps the data to a canonical space before further processing. PointNet has been proposed for object classification, where the category of a single shape is predicted. For many medical applications however, not just a single anatomical structure is important for the prediction but a simultaneous view of multiple structures is required for a more comprehensive analysis of a subject's anatomy. Hence, we propose the MultiStructure PointNet (MSPNet), which is able to simultaneously predict a label given the shape of multiple structures. We evaluate MSPNet in two neuroimaging applications, neurodegenerative disease prediction and age regression."}, {"section_title": "Related Work", "text": "Several shape representations have previously been used for supervised learning tasks. Spherical harmonics for approximating the hippocampal shape have been proposed in [5] . Shape information has been derived from thickness measurements of the hippocampus from a medial representation [3] . Statistical shape models to detect hippocampal shape changes were proposed by [14] . Multiresolution shape features with non-Euclidean wavelets were employed for the analysis of cortical thickness [9] . The use of medial axis shape representations was used to compare the brain morphology of autistic and normal populations [6] . Recently, shape representation based on spectral signatures have been introduced to perform age regression and disease prediction [16, 17] .\nAll the mentioned approaches rely on computing pre-defined shape features. Alternatively, a variational auto-encoder was proposed to automatically extract features from 3D surfaces, which can in turn be used in a classification task [13] . However different to our approach, this is not an end-to-end learning since the variational encoder is not directly linked to the classification task. Consequently, the learned features capture overall variation but are not directly optimized for the given task. In addition, this approach relies on computing point correspondences between meshes and focuses on a single structure, while we simultaneously model multiple structures."}, {"section_title": "Method", "text": "We propose a method for multiple structure shape analysis that is divided into two main stages: the extraction of point clouds representing the anatomy of different structures from medical images (section 2.1), and a Multi-Structure PointNet (MSPNet) (section 2.2). Figure 1 illustrates the architecture of MSPNet, which is based on PointNet [12] , and extends on it to allow the simultaneous processing of multiple structures. Fig. 1 . MSPNet Architecture. The network consists of one branch per structure (illustrated for three structures), which are fused before the final multilayer perceptron (MLP). Each structure is represented by a point cloud with n points that pass through transformer networks and multilayer perceptrons of the individual branch. Numbers in brackets are layer sizes."}, {"section_title": "Point Cloud Extraction", "text": "We extract point clouds from MRI T1-weighted images of the brain. We process the images with the FreeSurfer pipeline [4] and obtain segmentations of multiple neuroanatomical regions. From the resulting segmentations, point clouds are created by uniformly sampling the boundary of each brain structure. After this process, the anatomy of a subject is represented by a collection of m point clouds S = {P 0 , P 1 , . . . P m }, where each point cloud represents a structure. A point cloud is defined as a set of n points P = [p 0 , p 1 , . . . , p n ], where each point is a vector of Cartesian coordinates p i = (x, y, z)."}, {"section_title": "MSPNet Architecture", "text": "We aim at finding a network architecture corresponding to a function f : S \u2192 y, mapping a collection of shapes described by S to a prediction y. An overview of the network is shown in figure 1. MSPNet consists of multiple branches, where each branch processes the point cloud of one structure independently. This ensures that an optimal feature representation is learned per structure. At the end, the features of all branches are merged to perform a joint prediction. Each branch can be divided into the following stages: 1) point cloud alignment using a transformation network, 2) feature extraction, 3) feature alignment with a second transformation net, 4) dropout and 5) prediction. The first three stages of the architecture of each branch resemble that of a single PointNet architecture. The last two stages are particular to MSPNet.\nPoint Transformation Network: In contrast to previous approaches in deep medical shape analysis [13] , MSPNet does not require point correspondences across shapes, i.e., the i-th points of two shapes, p 1 i and p 2 i , respectively, do not need to represent the same anatomical position. We obtain the invariance to rigid transformations in MSPNet by (i) augmenting the training dataset by applying a random rigid transformation to each shape during training time and by (ii) introducing a transformation network (T-Net). This network estimates a 3 \u00d7 3 transformation matrix, which is applied to the input as a first step. One can think of the T-Net as a transformation into a canonical space to roughly align point clouds before any processing is done. The T-Net is shown in figure 2 and is composed of a multilayer perceptron (MLP), a max pooling operator and two fully connected layers.\nFeature Extractions: The transformed points are fed into a MLP with shared weights among points. This MLP layer can be thought of as the feature extraction stage of the network. At this stage of the network, each point has access to the position of all the remaining points of the point cloud, and therefore as the output of the network, we obtain a k-dimensional feature vector for each point (in our case k = 64). Although each point is assigned a single feature vector, in practice each feature vector point contains a global signature of the input point cloud.\nFeature Transformation: A second T-Net is applied to the computed features. This network has the same properties as the first transformation network, but its output corresponds to a k\u00d7k transformation matrix. This transformation matrix has a much higher dimension than the previous spatial transformation, which makes the optimization more challenging. To facilitate the optimization of this larger feature transformation matrix T , we constrain it to be close to an orthogonal matrix C reg = I \u2212 T T 2 F , similar to [12] . The regularization term ensures a more stable convergence of the network. After the points are transformed they are fed to a MLP layer."}, {"section_title": "Dropout and prediction:", "text": "Up to this point, the architecture of each branch mirrors that of the PointNet. However the final dropout and prediction stage is particular to MSPNet. In PointNet, the last stage corresponds to a maxpooling layer performed across n points, so that the output is a vector with size corresponding to the feature dimensionality. Instead of performing maxpooling, which leads to a strong shrinkage in feature space, we propose to keep the localized information per point. This leads to an increase in the network capacity, which may lend itself to overfitting. Hence, we introduce a dropout layer (keep probability = 0.3) for regularization. The main advantage of the new design is that more localized information is retained in the network, which we hypothesize may boost the predictive power of our network. Finally, the individual features from each branch are concatenated and fed into a last MLP to perform prediction. Batch normalization is used for all MLP layers and ReLU activations are used. The last MLP perceptron counts with intermediate dropout layers with 0.7 keep probabilities as in PointNet. To facilitate the exposition, we assumed that each structure per branch is described by the same number of n points, but in practice each structure can be represented by point clouds of different dimensions. Fig. 2 . Transformation network (T-Net) for predicting a transformation matrix to map a point cloud to canonical space before processing. A similar network is used to transform the features; the only difference is that the output corresponds to a 64 \u00d7 64 matrix."}, {"section_title": "Results", "text": "We evaluate the performance of MSPNet in two supervised learning tasks, classification and regression. For the classification task, we aim at using shape descriptors to discriminate between healthy controls (HC), and patients diagnosed with mild cognitive impairment (MCI) or Alzheimer's disease (AD). For the regression task, we perform age estimation of a subject based on shape information. In all our experiments, we compare to the standard PointNet architecture and spectral shape descriptors in BrainPrint [16] , which achieved high performance in a competition for Alzheimer's disease classification [17] . For PointNet, the multi-structure input corresponds to a concatenation of the point clouds of all structures. We use image data from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu) [8] . We work with a total of 7,974 images (2,423 HC, 978 AD, and 4,625 MCI)."}, {"section_title": "AD and MCI Classification on Shape Data", "text": "For this experiment, we perform classification based on the shape of the left and right hippocampus and the left and right lateral ventricles, due to their key importance in Alzheimer's disease [15] . Each structure is represented by a Pointcloud of 512 points. For our experiments the dataset is split in a training, validation and test set (75%,15%,15%). Splitting is done on a per subject basis, to guarantee that the same subject does not appear in different sets. Table 1 reports the results of the classification experiment, where we report average classification precision, recall and F1-score. In both classification scenarios, PointNet shows a higher accuracy than BrainPrint, illustrating the potential of learning feature representations. Further, MSPNet showed the best performance, highlighting the benefit of individual feature learning in each branch of the network. 0HDQ$EVROXWH(UURU\\HDUV Fig. 3 . Mean absolute error for the age prediction experiment on healthy subjects (left) and on all subjects, including MCI and AD (right)"}, {"section_title": "Age Prediction on Shape Data", "text": "For the age estimation task, we perform two different evaluations. In the first one, we perform age estimation only on the healthy controls of the ADNI database.\nFor the second evaluation, we also include patients diagnosed with MCI and AD. The evaluations are done again on the same brain structures used for the classification task. The results of these two experiments are summarized in the mean absolute error plots of figure 3. For the experiment on HC MSPNet significantly outperformed BrainPrint (p-value 2.69 \u00d7 10 \u22129 ) and PointNet (p-value 0.03). In the experiment on all subjects both PointNet and MSPNet presented comparable performance, both outperforming BrainPrint (p-value 0.01)."}, {"section_title": "Visualizing Point Importance", "text": "Of key importance for making predictions with shapes is the ability to visualize the part of the anatomy that is driving the decision. This holds in particular in the clinical context. In MSPNet, we introduce a simple yet effective method to visualize the importance that each point has in the prediction. Our visualization is inspired by the commonly used occlusion method [7] , which consists of occluding parts of a test image and observing differences in the network response. We apply a similar concept to visualize the response of MSPNet. In our case, we assess the importance of each point in the classification task by occluding this point (making the point coordinates equal to 0) together with its nearest neighbors. Then the occluded point cloud is passed through the network and the response of the output ReLU is compared to that obtained when the full point cloud is evaluated. The difference between these responses can then be assigned as the importance of this particular point. In figure 4 , we can observe the result of using this visualization technique for one of the AD test subjects in the HC-AD classification experiment. If a point tends towards the red side of the scale, it indicates that by occluding this particular point, the network increases the activation of the AD class. This means that the region around this point is used by the network to predict AD. The exact opposite is true for points on the blue side of the scale. White points indicate that the network response was not largely affected by occluding this point. In the particular case of the example in figure 4 , the decision of the network to give this subject a AD label is mainly driven by the left hippocampus."}, {"section_title": "Conclusion", "text": "We introduced MSPNet, a deep neural network for shape analysis on multiple brain structures. To the best of our knowledge, this is the first time that a neural network for shape analysis on point clouds is proposed in medical applications. We have shown that our method is able to achieve high accuracy in both classification and regression tasks, when compared to shape descriptors based on spectral signatures. This performance is achieved without relying on point correspondences or meshes. MSPNet learns feature representations from multiple structures simultaneously. Finally, we illustrated point-wise importance for the prediction by adapting the occlusion method."}]
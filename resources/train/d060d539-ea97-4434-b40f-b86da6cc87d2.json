[{"section_title": "Abstract", "text": "Motivation: Identifying the genetic basis of the brain structure, function and disorder by using the imaging quantitative traits (QTs) as endophenotypes is an important task in brain science. Brain QTs often change over time while the disorder progresses and thus understanding how the genetic factors play roles on the progressive brain QT changes is of great importance and meaning. Most existing imaging genetics methods only analyze the baseline neuroimaging data, and thus those longitudinal imaging data across multiple time points containing important disease progression information are omitted. Results: We propose a novel temporal imaging genetic model which performs the multi-task sparse canonical correlation analysis (T-MTSCCA). Our model uses longitudinal neuroimaging data to uncover that how single nucleotide polymorphisms (SNPs) play roles on affecting brain QTs over the time. Incorporating the relationship of the longitudinal imaging data and that within SNPs, T-MTSCCA could identify a trajectory of progressive imaging genetic patterns over the time. We propose an efficient algorithm to solve the problem and show its convergence. We evaluate T-MTSCCA on 408 subjects from the Alzheimer's Disease Neuroimaging Initiative database with longitudinal magnetic resonance imaging data and genetic data available. The experimental results show that T-MTSCCA performs either better than or equally to the state-of-the-art methods. In particular, T-MTSCCA could identify higher canonical correlation coefficients and capture clearer canonical weight patterns. This suggests that T-MTSCCA identifies time-consistent and timedependent SNPs and imaging QTs, which further help understand the genetic basis of the brain QT changes over the time during the disease progression."}, {"section_title": "Introduction", "text": "Brain imaging genetics studies the relationship between the quantitative traits (QTs) extracted from neuroimaging data and genotypic data such as single nucleotide polymorphisms (SNPs). This research methodology is expected to uncover the genetic basis of brain structure and function, thereby further offers new opportunities to interpret the relationships between genetic variations and brain disorders (Potkin et al., 2009; Saykin et al., 2015; Shen et al., 2010) .\nDuring the last decade, many efforts have been made to explore computational methods to identify the correlation between QTs and genetic factors (Du et al., 2016 (Du et al., , 2018 Hao et al., 2017; Shen et al., 2010; Vounou et al., 2010 Vounou et al., , 2012 Wang et al., 2012b; Witten and Tibshirani, 2009; Yan et al., 2014) . The early imaging genetic studies (Shen et al., 2010; Vounou et al., 2010) used pairwise univariate analysis to identify single-SNP-single-QT associations. To improve the identification power, the multivariate sparse regression methods were introduced later (Vounou et al., 2012; Wan et al., 2011; Wang et al., 2012b) . They either regressed a set of SNPs for a few candidate QTs, or regressed a set of QTs for a few candidate SNPs, and the relationship among predictors is usually taken into consideration via the regularization.\nRecently, sparse canonical correlation analysis (SCCA) becomes popular in imaging genetics since it can identify bi-multivariate associations between multiple SNPs and multiple imaging QTs without pre-selecting candidate biomarkers (Du et al., 2016; Witten and Tibshirani, 2009; Yan et al., 2014) . Most existing SCCA methods only employ neuroimaging data of one time point, e.g. the baseline, to study their correlation with SNPs. Neuroimaging techniques show improved power in investigating the characteristics of neurodegenerative progression in the spectrum from healthy controls (HCs) to patients with Alzheimer's disease (AD) (Cheng et al., 2019) . Thus, the brain structure and function along with the disease diagnosis change over time other than remain stationary. For example, a HC subject might progress to mild cognitive impairment (MCI) patient, and further to AD several years later; while another HC subject could remain healthy during these years. Therefore, understanding how the genetic factors modulate the trajectory of disease progression is particularly important and interesting.\nThe aforementioned methods might be insufficient to discover deep-seated imaging genetic relationship due to the ignorance of rich temporal information carried by the imaging data across multiple time points. To date, there are a few methods studying imaging genetics using the longitudinal phenotypic data. A common issue is that a preselection of candidate risk biomarkers is required before conducting the actual imaging genetic analysis. For example, Vounou et al. (2010) proposed a two-step method which first selected a small set of diseaserelated imaging voxels which can distinguish AD subjects from HC ones. Then a sparse reduced-rank regression was applied to identify those disease relevant SNPs by using the pre-selected voxels as responses and SNP as predictors (Vounou et al., 2012) . Given the complexity of the human brain (Mai et al., 1997) , only including a small proportion might be insufficient since this may lose important information carried by cerebral components which are not included (Shen et al., 2010) . Wang et al. (2012a) proposed a sparse regression model which uses a small set of pre-selected SNPs as responses and the brain-wide imaging phenotypes as predictors. Instead of identifying disease relevant SNPs (Vounou et al., 2010) , it identifies disease relevant brain imaging phenotypes with common influence on all candidate SNPs (Wang et al., 2012a) . Recently, Hao et al. (2017) proposed a temporally constrained group SCCA (TGSCCA) which simplified the multi-set/multi-view SCCA (mSCCA) model (Witten and Tibshirani, 2009 ) by dropping the pairwise association between longitudinal imaging phenotypes. Both TGSCCA and mSCCA require that one set of variables (SNPs) being associated with several sets of variables (longitudinal imaging QTs across multiple time points) simultaneously, which might be too strict to make full use of the complementary information embedded in different period of imaging data. Moreover, TGSCCA identified time-consistent markers for imaging QTs, which only revealed those relevant markers being shared by all time points. As a result, it could not uncover the heterogeneous progressive patterns of human brain. Neuroimaging studies have shown that the human brain cerebral decline, e.g. the atrophy in AD, presents regional differences in the atrophy rates (Fox and Schott, 2004; Harper et al., 2017) . This implies that, in many cases, the common progressive pattern is shared by multiple time points, but not all (Lee et al., 2010; Wang et al., 2011) . This regional variations may trace back to the involvement of different SNPs at different time points. Therefore, developing longitudinal imaging genetics methods, with the ability of identifying a trajectory of progressive and timedependent imaging genetic patterns, is of great importance and meaning. This could further help uncover the diverse genetic factors' roles in affecting brain changes over the disease progression.\nIn this article, using the longitudinal brain imaging QTs across multiple time points, we propose a novel Temporal Multi-Task SCCA (T-MTSCCA) framework which learns bi-multivariate associations between intermediate phenotypes and genotypes simultaneously. In this new model, each SNP or QT is denoted as a feature, and an SCCA task is conducted between each longitudinal imaging modality and SNPs. Distinct from mSCCA and TGSCCA who learn only one canonical weight vector for SNPs, our T-MTSCCA learns a canonical weight matrix for SNPs, where each column corresponds to one canonical weight of one SCCA task. This means that our method can make full use of the complementary information carried by imaging QTs at different time points. The inherent linkage disequilibrium (LD) (Pritchard and Przeworski, 2001 ) structure is taken into consideration by the group ' 2;1 -norm (G 2;1 -norm) (Wang et al., 2012b) to make the model practical. The ' 2;1 -norm is used to jointly select an individual feature for SNPs and phenotypic QTs. The longitudinal imaging QTs naturally present a temporal pattern across multiple time points, we use a fuse pairwise group lasso to accommodate this temporal relationship. In addition, the ' 1 -norm for both SNPs and imaging QTs assures a time-dependent feature selection, indicating its capability in finding markers which are only effective at a specific time point. We derive an efficient algorithm and show its convergence to a local optimum.\nIn the experiments, to evaluate the performance of T-MTSCCA, we used synthetic datasets with different characters and a real neuroimaging genetic dataset from the Alzheimer's disease neuroimaging initiative (ADNI) (Mueller et al., 2005) cohort. The real data included longitudinal structural magnetic resonance imaging (MRI) measurements over a two year period and 1085 SNPs near the APOE gene. Compared with two state-of-the-art methods, on both synthetic and real datasets, our method yielded improved canonical correlation coefficients, and clear canonical weight profiles showing its capability in identifying relevant biomarkers. Moreover, T-MTSCCA also identified time-dependent and progressive imaging and genetic markers, demonstrating it is a potential alternative method in longitudinal brain imaging genetics."}, {"section_title": "Materials and methods", "text": "Throughout this article, we denote scalars as italic letters, vectors as boldface lowercase letters and matrices as boldface uppercase Identifying progressive imaging genetic patterns via MTSCCA i475\nletters. The i-th row and j-th column of matrix X \u00bc \u00f0x i;j \u00de are denoted as x i and x j , respectively. The i-th matrix of a set of matrices is denotes as X i . The Euclidean norm of x is denoted as kxk 2 and the Frobenius norm of X is defined as"}, {"section_title": "The sparse canonical correlation analysis", "text": "Canonical correlation analysis (CCA) combined with sparse learning techniques is widely used in imaging genetics. Suppose we have T matrices, i.e. X i \u00f0i 2 \u00bd1; . . . ; T\u00de and T canonical weights w i , the SCCA can be formally defined as: min w1;...;wT\nX\u00f0w t \u00de is the sparsity-inducing term to select those features of interest and k t is the parameter to control the strength of sparsity. So far, SCCA studies have involved the Lasso (' 1 -norm) (Parkhomenko et al., 2009; Witten and Tibshirani, 2009) , group Lasso (Chen and Liu, 2012; Du et al., 2017) and graph Laplacian regularization (Chen and Bushman, 2013; Du et al., 2016; Yan et al., 2014) , to name a few. For the sake of description, we name an SCCA method based on the number of matrices involved. For example, we call it two-view or two-set SCCA (SCCA for short) when t \u00bc 2, and most existing studies are in this category. The multi-view or multi-set SCCA (mSCCA) studies the associations among three or more matrices (t ! 3).\nThe temporally constrained group SCCA (TGSCCA) (Hao et al., 2017) is introduced by relating the SNP data to the imaging data at each time point separately while enforcing a shared canonical loading on the genetic side, i.e. min u;v1;...;vT "}, {"section_title": "The T-MTSCCA", "text": "In this subsection, we aim to investigate the association between genotypes and longitudinal imaging phenotypes. In view that imaging phenotypes show regional variations over time owing to the impact of genotypes, the computational model should account for the regional variations. Inspired by the success of multi-task regression in imaging genetics studies (Wang et al., 2012a, b) , we propose a novel temporal multi-task SCCA (T-MTSCCA) method for longitudinal imaging genetics as follows:\nwhere\nT is the number of time points (SCCA tasks). X\u00f0U\u00de and X\u00f0V\u00de are the regularization terms for selection of time-dependent and time-consistent genotypic and imaging phenotypic markers. T-MTSCCA has three advantages over previous models mSCCA and TGSCCA. First, T-MTSCCA is a multi-task bi-multivariate method which jointly learns related SCCA tasks. The neurodegenerative disorders, e.g. AD, usually deteriorate gradually, implying the brain structure and function, might show little difference between two consecutive visits. This indicates that the longitudinal imaging QTs remain stable during this period, which further reveals that these SCCA tasks regarding associations between genotypes and longitudinal imaging phenotypes are correlated longitudinally. According to the multi-task learning theory (Argyriou et al., 2006) , T-MTSCCA is expected to yield enhanced performance owing to these longitudinally correlated SCCA tasks. Second, T-MTSCCA learns a weight matrix U with T vectors corresponding to T SCCA tasks. That is, an SCCA task will promote correlated tasks instead of enforcing them to be the same, which is meaningful when these tasks (associations between SNPs and longitudinal imaging phenotypes at different time points) are not perfectly related (Lee et al., 2010) . This strategy seeks common ground while reserving differences and offers a unique opportunity to identify both time-consistent and time-dependent markers simultaneously. Third, the blended regularization X\u00f0U\u00de subsumes G 2;1 -norm, ' 2;1 -norm and ' 1 -norm, and thus assures diverse sparsity including time-dependent, timeconsistent and smoothness crossing multiple time points but not all. X\u00f0V\u00de is also a blended regularization performing diverse feature selection for heterogeneous progressive patterns of imaging QTs. Therefore, T-MTSCCA is promising in discovering complex regional variations existing in the progression of neurodegenerative disorders (Fox and Schott, 2004) , and further identifying the deep-seated QT loci being responsible for the disorders."}, {"section_title": "Regularization for genotypes via group-sparsity and individual-sparsity", "text": "It is well known that the genetic markers, i.e. SNPs, affect the brain structure and function both conjointly at group level and individually. SNPs could exhibit different temporal patterns longitudinally, being supported by the truth that the human brain cerebral decline exhibits regional variations longitudinally (Fox and Schott, 2004) . Therefore, in order to take into consideration these complex temporal patterns, X\u00f0U\u00de is defined as:\nwhere k u1 ; k u2 and k u3 are non-negative tuning parameters. Specifically, the G 2;1 -norm is formulated as follows:\nU k is the k-th submatrix of U whose rows is indexed by\ndenotes K groups in accordance with the LD structure. This norm assures group sparsity since it penalizes SNPs in the same group (e.g. LD) jointly, meaning they will be selected or unselected simultaneously (Wang et al., 2012b) . The penalization is practical owing to packaging SNPs in the same LD block together, which makes the model consistent with the genotype mechanism.\nThe ' 2;1 -norm is defined as:\nThis regularization emphasizes on a single variable across multiple tasks, and could help identify a single SNP that plays a role in the brain development or disease progression via affecting the longitudinal imaging phenotypes. Finally, the temporal pattern implies that a SNP could not always play a role during the disease progression. Therefore, we use the ' 1 -norm for each u i to induce sparsity across all time points for each individual SNP, i.e.\nThis penalty is focused on selecting the relevant features at a specific time point. It is worth noting that, combining the three terms together, they can not only identify active SNPs shared by all time points, but also identify SNPs being only relevant at a specific time point."}, {"section_title": "Regularization for longitudinal imaging phenotypes via timeconsistent and time-dependent sparsity", "text": "The regularization aiming for sparsity with respect to imaging QTs is also desirable, being motivated by the fact that different imaging QTs play different roles during the disease progression. According to Equation (3), there is one canonical weight vector for imaging QTs at a specific time point. Then across multiple times points, an imaging QT describes the trajectory of the disease progression at this specific brain area. Based on the analysis earlier, regional variations, i.e. one brain region may remain stable while another may change significantly, should be taken into consideration.\nOn this account, we introduce a novel time-consistent and timedependent constraint which is defined as follows:\nwhere k v1 ; k v2 and k v3 are non-negative tuning parameters. The fused pairwise ' 2;1 -norm (FP 2;1 -norm) (Du et al., 2017 ) is defined as:\nThis norm first imposes the ' 2 -norm for two adjacent time points of one QT, then uses the ' 1 -norm for all QTs spanning the whole brain. As a result, the intermediate temporally stable pattern of one QT is considered as well as the sparsity among all QTs. Moreover, FP 2;1 -norm is convex and thus could be easily optimized compared to the non-convex fused Lasso of TGSCCA (Hao et al., 2017) . The ' 2;1 -norm:\nis used to assure the cross-task relationship for each imaging QT. Thus it could select or discard those imaging QTs remaining stable across all time points. Finally, as stated, the brain areas exhibit distinct atrophy patterns (Fox and Schott, 2004) . Therefore, identifying time-dependent imaging QTs is also very important to understand the disease pathology. We use the ' 1 -norm penalty, i.e.\nfor each v t to assure the individual-sparsity at a specific time point. Obviously, either the FP 2;1 -norm, ' 2;1 -norm or ' 1 -norm alone is insufficient due to the regional variations of both healthy and pathological brains. Therefore, we use all of them to regularize the longitudinal imaging QTs to account for both time-consistent and time-dependent feature selection. This make T-MTSCCA a very practical model, and thus suitable for longitudinal brain imaging genetics."}, {"section_title": "The optimization algorithm and its convergence", "text": "Writing the regularizers for genotypes and imaging phenotypes explicitly, the T-MTSCCA becomes:\nSince 8t; kXu t k 2 2 \u00bc 1 and kY t v t k 2 2 \u00bc 1, Equation (12) is equivalent to:\nIt is hard to solve Equation (13) above due to its non-convexity in the quadratic term and non-smooth in regularization terms. But the objective is biconvex in U and V even if it is still non-smooth. In particular, this objective is convex in U with all v t 's fixed; and it is convex in v t with U and the rest of v t 0 \u00f0t 0 6 \u00bc t\u00de fixed. Therefore, the solution can be easily attained via first using smoothing approximations of non-smooth terms, and then applying the efficient smooth optimization such as the alternative search method (Gorski et al., 2007) ."}, {"section_title": "Updating U", "text": "When V is fixed, the Lagrangian of Equation (13) regarding U writes:\nwith those constants vanish. Now this equation transforms to a multi-task regression problem. We take its derivative with respect to each u t and set it to zero, i.e.\nD 1 is a block diagonal matrix with the k-th diagonal block as 1 2kU k k F I k (I k is an identity matrix with size being equal to the k-th submatrix U k , and 1 k K), D 1 is also a diagonal matrix whose i-th diagonal element is\nand D 1t is a diagonal matrix with the i-th diagonal element being\nThis equation indicates that every u t can be solved in closed form. Simple mathematical derivation yields the updating rule for each u t , i.e.\nSinceD 1 ; D 1 and D 1t (t \u00bc 1; 2; . . . ; T) are latent variables which depend on U, we can solve Equation (16) using the efficient iterative algorithm (Wang et al., 2011 (Wang et al., , 2012b ."}, {"section_title": "Updating V", "text": "Now with U being fixed, the objective with respect to v t writes:\nTaking the derivative with respect to v t and setting it to zero, we have,\nThen, we arrive at: . This closed form shows that each v t can be obtained via the alternative iteration algorithm too.\nNow that U and V are solved, respectively, we summarize the optimization procedure in Algorithm 1, which guarantees to converge to a local optimum. In the iteration, Steps 1, 3 and 5 are computationally trivial. Steps 4 and 6 solve a system of linear equations, both of which are well studied in literature and can be solved efficiently."}, {"section_title": "Convergence analysis", "text": "The following theorem holds for Algorithm 1. PROOF. Denote the current estimate of U and V, respectively, as U and V (with a slight abuse of notation, for notational convenience), and their refined estimates using the updating rules in Equations (16) and (19) a\u015d U andV. Denote the objective function value of problem (13) as f \u00f0U; V\u00de.\nAccording to the update rule in Equation (16), we have,\nApplying \nWriting in matrix form, we obtain:\nThis reveals that, in each iteration of Equation (16), the objective decreases, namely, f \u00f0\u00db; V\u00de f \u00f0U; V\u00de.\nSimilarly, we can prove the convergence of updating v t 's one by one. Combined, in equations with respect to each v t yields:\nfrom which it follows that f \u00f0\u00db;V\u00de f \u00f0\u00db; V\u00de.\nCombining two conclusions above yields f \u00f0\u00db;V\u00de f \u00f0\u00db; V\u00de f \u00f0U; V\u00de, which completes the proof. h"}, {"section_title": "Algorithm 1 The T-MTSCCA algorithm", "text": ""}, {"section_title": "Require:", "text": "The genotype data matrix X 2 R n\u00c2p , longitudinal imaging phenotype data matrices of T time points Y t 2 R n\u00c2q ; t 2 \u00bd1; T, the pre-tuned k u1 ; k u2 ; k u3 , c u , k v1 ; k v2 ; k v3 and c v ."}, {"section_title": "Ensure:", "text": "Canonical weights U and V. (14) and (17) are lower bounded by zero and the T-MTSCCA problem is biconvex, the overall iteration algorithm will converge to a local optimum. In our experiments, we terminate Algorithm 1 when max i;t j\u00fb i t \u00c0 u j t j and max j;t jv i t \u00c0 v j t j satisfy, where is the pre-set error bound. We use \u00bc 10 \u00c05 in this article empirically based on experiments.\n3 Experimental results and discussions"}, {"section_title": "Experimental setup", "text": "In the experiments, we compare T-MTSCCA with two close counterparts including the mSCCA (multi-view SCCA) and TGSCCA (temporally constrained group SCCA) using both synthetic data and real neuroimaging genetic data. The mSCCA computes pairwise correlation coefficients between the SNPs data and the imaging QTs data including that between every two modalities of imaging QTs at different time points (Witten and Tibshirani, 2009) . TGSCCA is similar to mSCCA by dropping the pairwise correlation terms between those imaging QTs data at different time points (Hao et al., 2017) . We use the nested 10-fold cross-validation method to find the optimal parameters. These parameters generating the highest crosstask mean testing correlation coefficient will be chosen as the optimal parameters, i.e. CV\u00f0k; b; c\u00de \u00bc 1 10\nwhere X j and Y j;t are the j-th fold which are the complementary sets used for testing, and u j;t and v j;t are the canonical weights estimated from the training set. To further reduce the time effort, we fix c u \u00bc 1 and c v \u00bc 1 since they result in two scaling steps in Algorithm 1, and thus only affect the magnitude of U and V (Chen and Liu, 2012) . This indicates that the relative relationship among each variables remain the same. Finally, we tune these parameters from can- "}, {"section_title": "Results on simulation data", "text": "In this simulation study, to evaluate the T-MTSCCA method, we used four synthetic datasets with distinct properties which could thoroughly access the performance. First, we generated one sparse vector u 2 R p\u00c21 and four successive sparse vectors v t 2 R q\u00c21 . In particular, several non-zero variables are shared by all v t 's while some ones are time-dependent. Then, using a latent vector z 2 R n\u00c21 , we create X by x i $ N\u00f0z i u; e \u00c1 I p\u00c2p \u00de, and each Y t by y t;i $ N\u00f0z i v t ; e \u00c1 I q\u00c2q \u00de. Being embedded with different strengths of noise, the first three datasets share the same ground truth, i.e. n \u00bc 80, p \u00bc 100 and q \u00bc 120, on which could show one method's performance under different noises. The fourth dataset simulated a large and complex imaging genetic problem (n \u00bc 500, p \u00bc 2000 and q \u00bc 600). The details of the ground truths are presented in Figure 2 (top row). We presented the testing canonical correlation coefficients (CCCs) in Figure 1 (training CCCs are omitted due to the space limitation). The CCCs, i.e. CCC_T1, CCC_T2, CCC_T3, CCC_T4, of each method were calculated between X and Y t at every time point. In this figure, all methods obtained low testing CCCs, indicating they were over-fitted when the true CCC was quite low. As expected, their performances improve as the CCC increased. T-MTSCCA and TGSCCA obtained better CCCs than mSCCA on data 2 and data 3 attributing to the temporal constraints. On data 4 with thousands of variables, T-MTSCCA and TGSCCA also hold better CCCs than mSCCA, which demonstrates they were suitable for longitudinal imaging genetics.\nIn addition, the ability of feature selection, i.e. the selected SNPs and imaging QTs at intermediate time points, is also important. To make the results stable, we averaged the canonical weights across 10-folds and shown them in Figure 2 . The actual U and V were shown on the top row followed by those estimated by mSCCA, TGSCCA and T-MTSCCA. Within each method's panel, the canonical weights associated with all time points were stacked vertically. It is clear that T-MTSCCA identified a clear and clean pattern in terms of both U and V, whose non-zero variables were consistent to the ground truth. TGSCCA also obtained acceptable results due to its temporal constraint for the intermediate imaging QTs. It is worth mentioning that T-MTSCCA also identified time-dependent nonzero variables for U and V thanks to its novel time-dependent penalties. This is very interesting since, combined with the time-consistent penalty, our T-MTSCCA can not only identify those active variables at a specific time point, but also identify those active variables shared by all time points. To summarize, the results on this four distinct synthetic datasets demonstrate that T-MTSCCA could be a competitive alternative method for longitudinal bi-multivariate association's identification."}, {"section_title": "Results on real neuroimaging genetic data", "text": "The real genotyping and brain imaging data used in this article were obtained from the ADNI database (adni.loni.usc.edu). The primary goal of ADNI has been to test whether serial MRI, positron emission tomography (PET), other biological markers and clinical and U   T1 T2 T3 T4   T-MTSCCA   U   T1 T2 T3 T4   U   T1 T2 T3 T4   U   T1 T2 T3 T4   V   T1 T2 T3 T4   V   T1 T2 T3 T4   V   T1 T2 T3 T4   V   T1 T2 T3 T4 -0.01 0 0.01 Fig. 2 . Heat maps of canonical weights on synthetic data. Rows 1-4: Ground truth, mSCCA, TGSCCA and T-MTSCCA, respectively. In each row, U is on the left panel and V is on the right. Within each panel, there are four canonical weights associating with four time points. For our method, there are four canonical weights corresponding to four time points, i.e. T1, T2, T3, T4, for both U and V. For mSCCA and TGSCCA, the weight matrix U is stacked by the same canonical weight vector u.\nneuropsychological assessment can be combined to measure the progression of MCI and early AD. For up-to-date information, see www.adni-info.org.\nThe longitudinal neuroimaging data were from 408 nonHispanic Caucasian participants, including 125 healthy controls (HC), 192 MCI and 91 AD subjects at the baseline screening. Table 1 shown the demographic information. We used MRI T1-weighted imaging including baseline (BL), Month 06 (M6), Month 12 (M12) and Month 24 (M24) in this work. These preprocessed imaging data, i.e. the voxel-based morphometry (VBM), were aligned to each participant's same visit scan. Then the normalized gray matter density maps were created from MRI data in the standard Montreal Neurological Institute (MNI) space as 2 \u00c2 2 \u00c2 2 mm 3 voxels via the SPM software (Ashburner and Friston, 2000) . Based on the MarsBaR AAL atlas (Tzourio-Mazoyer et al., 2002), we further extracted 116 ROI level measurements of mean gray matter densities. Finally, we removed the cerebellum area and obtained 90 imaging measures, and finally used them as phenotypes of four time points in the experiments. Before the experiment, the imaging measures were adjusted by removing the effects of the baseline age, gender, education and handedness.\nThe genotyping data of the same 408 subjects were downloaded from the ADNI website too. The SNPs were generated by the Human 610-Quad or OmniExpress Array (Illumina, Inc., San Diego, CA, USA), and preprocessed according to the standard quality control (QC) and imputation steps. We included 1085 SNPs from the neighbor of the APOE gene based on the ANNOVAR annotation (see the Supplementary file). We aim to study associations between SNPs and longitudinal brain imaging measures, and identify those time-consistent and time-dependent markers in this ADNI dataset."}, {"section_title": "Improved bi-multivariate association", "text": "We applied three methods to this real neuroimaging genetic data. mSCCA and TGSCCA yielded one canonical weight u and four canonical weights v t associating with four longitudinal time points. By calculating association between SNPs and each imaging QTs of different time points, we obtained four CCCs for them. Our method naturally generated four pairs of canonical weights, and thus there were four CCCs with respect to four time points. We denoted these four CCCs as CCC_BL, CCC_M6, CCC_M12 and CCC_M24 for the sake of description, and presented them in Figure 3 separately. In this figure, the testing CCCs was shown with those training ones omitted due to the space limitation. As expected, owing to the utilization of temporal regularization, both TGSCCA and T-MTSCCA obtained better CCCs than mSCCA. This shows their effectiveness in longitudinal bi-multivariate association studies."}, {"section_title": "Identification of time-consistent and time-dependent SNPs", "text": "Besides the CCC which showing the strength of the association, the identification of longitudinally active SNPs and imaging QTs is of great importance. These time-dependent patterns help uncover the basis of the diverse progression stages of diseases. We illustrated the weight matrix U, whose absolute values show the importance of SNPs, of each method in Figure 4 . In this figure, each subfigure denotes a method, within which each row corresponds to one canonical weight at one time point. mSCCA and TGSCCA only reported one canonical weight vector with respect to SNPs, and thus, we stacked u for four times. T-MTSCCA yielded four u t 's, with each being associated to one time point. Finally, the canonical weights across 10-folds were averaged to make a stable selection.\nT-MTSCCA yielded a clear time-consistent and time-dependent pattern with respect to selected features (SNPs) across multiple time points owing to the jointly learning and the novel constraint. TGSCCA and mSCCA could only identify time-consistent imaging QTs. The reason is that both methods output only one canonical weight vector based on their modeling strategy, and thus cannot identify those ones being involved at a specific time point. This reveals that our method performs cleverly and suitably in longitudinal feature selection studies. For the selected features, we observed that the SNPs identified by T-MTSCCA have been reported to show increasing risk for AD or MCI progression in previous studies. Specifically, there are evidences showing that rs76692773 (TOMM40) and rs112262807 (PVRL2) were AD-risk loci. rs141622900 (APOC1) is a determinant of the cholesterol efflux Capacity (CEC) (Low-Kam et al., 2018) , whose reduction is a sign of MCI or AD (Yassine et al., 2016) . rs76075198 (CEACAM19) is a loci associated to Dyslipidemia which shares some pathology with AD (Carlsson, 2010) . It warrants further investigation to confirm the effects of the remaining loci since they were within in ADassociated genes such as PVRL2 (rs7343130), and RELB (rs141652051) (Nho et al., 2017) , BCL3 (rs7249244 and rs2927462) (Xiao et al., 2017) , CEACAM19 (rs141846480) (Jansen et al., 2019) , CLPTM1 (rs12983572) (Hao et al., 2018) . TGSCCA and mSCCA also identified AD-associated loci such as rs57537848 (Nazarian et al., 2019) and rs76692773, as well as loci falling within AD-risk genes such as rs1166329 (PVRL2) and rs7249244 (BCL3) which have not been reported to be associated with AD or MCI. Given these meaningful results, further investigation, such as a post-refined analysis, is warranted to confirm the role of these SNPs during the AD progression. It is interesting that all three method did not identify rs429358 which is a well-known AD risk locus. This might stem from the reduced effect of rs429358 in the AD progression, and, of course, it warrants further investigation to conform this. In summary, the results regarding SNPs selection show that the proposed method can not only identify SNPs being effective across multiple time points, but also identify those being only effective at a specific time point. This reveals that T-MTSCCA could be suitable to identify meaningful genetic markers in a longitudinal scenario."}, {"section_title": "Identification of time-consistent and time-dependent QTs", "text": "We want to know the dynamic patterns of imaging QTs longitudinally as well, which shows the interior behavior of diseases progression. We averaged each v t across 10-folds to assure a stable selection. These averaged results of every method on each imaging modality (BL, M6, M12 and M24) were shown in Figure 5 . Since TGSCCA could not yield sparse results due to the lack of individual sparse-inducing term, we show the top 10 imaging QTs with the highest absolute weight values. As expected, mSCCA identified irregular non-zero imaging QTs which is time-dependent for each individual time point due to the lack of temporal constraint. TGSCCA and T-MTSCCA yielded consistent imaging markers across all time points, indicating their ability in finding time-consistent markers. T-MTSCCA also identified imaging QTs being only effective at one time point, e.g. baseline screening in this study. We then investigated this by conducting a two-view SCCA between SNP data and imaging data at each time point separately (results were not shown due to the space limitation). These four independent tasks showed that the association pattern at BL is not closely correlated to those of the three successive time points, i.e. M6, M12 and M24. Therefore, there is a significant difference with respect to the non-zero imaging QTs between BL and M6, M12 and M24. This, on the contrary, demonstrates the value of T-MTSCCA for its time-dependent feature selection. T-MTSCCA identified seven imaging markers across all time points, indicating its ability in discovering time-consistent features. A literature search shows that all these brain areas are relevant to MCI or AD. For examples, the right angular gyrus, in which the glucose metabolism shows significant reduction, is associated to agingassociated cognitive decline (AACD) (Hunt et al., 2007) . The right middle frontal gyrus, the orbitofrontal cortex, the left insula, the left lingual gyru, and the left occipital were reported as AD-relevant brain regions in previous studies (Holroyd et al., 2000; Van Hoesen et al., 2000; Yao et al., 2010) . T-MTSCCA also reported several AD-associated imaging QTs, such as the right fusiform gyrus (Wang et al., 2015) and the left precuneus, at baseline. It is worth mentioning that the left precuneus has been demonstrated to be associated with early onset AD (Karas et al., 2007) . This is promising since T-MTSCCA could successfully identify the neurodegenerative biomarker at its early stage. In addition, T-MTSCCA also captured the aging-associated areas, such as the left calcarine cortex which shows predominantly atrophy with age (Bakkour et al., 2013) . This is interesting that, due to the unsupervised modeling strategy, our method could capture the temporal characters of the brain change happening to both HCs and ADs, thereby it can also be applied to brain aging studies. TGSCCA and mSCCA also identified imaging markers that were associated with MCI or AD, e.g. the left and right olfactory and the left and right parahippocampal gyri. To summarize, T-MTSCCA identified both time-consistent and time-dependent imaging QTs, which could help uncover the different changing patterns during different periods in MCI and AD progression, as well as the change caused by aging. This finally reveals that, using timeconsistent and time-dependent constraints simultaneously, T-MTSCCA could be very promising in longitudinal brain imaging genetics."}, {"section_title": "Conclusion", "text": "Studying the associations between multiple genetic markers and brain imaging measurements is an important task in brain science, with the aim to uncover the genetic basis of the brain structure, function and disorder. Longitudinal study is widely used in biomedical studies where the brain imaging measures are collected repeatedly over long periods of time. These longitudinal data carry rich information with respect to the disorder progression and brain aging. Most existing imaging genetics methods only use the baseline neuroimaging data, and thus ignore useful information embedded in the longitudinal imaging data across multiple time points. In this article, we present a novel temporal multi-task SCCA (T-MTSCCA) method which can identify time-consistent and time-dependent phenotypic and genotypic markers simultaneously. Being distinct from existing temporal SCCA, T-MTSCCA treats those temporally correlated SCCA jointly other than enforcing them to be the same. This strategy seeks common ground while reserving differences and can identify both time-consistent and time-dependent markers, and thus has better modeling ability. An efficient algorithm is proposed to optimize the problem, which is guaranteed to converge to a local optimum.\nWe compared T-MTSCCA with two state-of-the-art counterparts, i.e. the mSCCA (multi-view SCCA) (Witten and Tibshirani, 2009 ) and TGSCCA (temporally constrained group SCCA) (Hao et al., 2017) using both synthetic data and neuroimaging genetic data from the ADNI database. On the synthetic data, T-MTSCCA obtained better CCCs than the benchmarks and identified clearer canonical weight patterns which were consistent to the ground truths. On the real neuroimaging genetic data, our method obtained better or equal CCCs to mSCCA and TGSCCA at multiple time points. It succeeds in identifying a small set of SNPs and brain imaging QTs from all markers involved. It is worth noting that our method can not only find out time-consist features for SNPs and imaging QTs across multiple time points, but also identified time-dependent markers at baseline. These identified imaging QTs and SNPs were highly correlated to AD or MCI, and thus demonstrated that the proposed temporal multi-task SCCA could be a powerful alternative method in longitudinal brain imaging genetics. T-MTSCCA also identified aging-associated areas in elderly subjects. In the future, we aim to extend T-MTSCCA to the genome-wide brain-wide study, since the GWAS-oriented longitudinal brain imaging genetics is a major challenge."}]
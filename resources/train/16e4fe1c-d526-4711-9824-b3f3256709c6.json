[{"section_title": "Abstract", "text": "Abstract. Voxel based morphometry (VBM) is widely used in the neuroimaging community to infer group differences in brain morphology. VBM is effective in quantifying group differences highly localized in space. However it is not equally effective when group differences might be based on interactions between multiple brain networks. We address this by proposing a new framework called pattern based morphometry (PBM). PBM is a data driven technique. It uses a dictionary learning algorithm to extract global patterns that characterize group differences. We test this approach on simulated and real data obtained from ADNI . In both cases PBM is able to uncover complex global patterns effectively."}, {"section_title": "Introduction", "text": "VBM [4] is widely used in the neuroimaging community to quantify structural and functional group differences in the brain using 3D and 4D images. VBM involves mapping image data to a standard template space. This is followed by application of voxelwise statistical tests on deformation maps. However, VBM has several weaknesses which are discussed at length in [7] and [5] . For example, VBM fails to account for multivariate group differences, such as interactions between several voxels. Secondly, VBM uses mass univariate testing so that one has to correct for multiple testing. We address these issues by proposing a multivariate morphometric framework called pattern based morphometry(PBM).\nPBM is based on K-SVD [3] . K-SVD is a dictionary learning algorithm that has been successfully applied to problems in computer vision [8] . The driving principle behind K-SVD is that it can represent a large set of images as a sparse linear combination of a small set of 'basis images'.\nThe rest of the paper is structured as follows. Section 2 gives a brief introduction to K-SVD and details how we apply K-SVD to explore group differences. Section 3 describes the results obtained by applying our technique on simulated and real data. We conclude the paper in Section 4 with a discussion of applications and potential avenues for further development of this algorithm.\nK-SVD to obtain a dictionary of patterns which can represent these difference images in a sparse way; 3)Ranking and normalization of these patterns. We now describe each step in detail."}, {"section_title": "Step 1: Generating Difference Images from Data", "text": "Recall that we wish to identify patterns that represent group differences. Our driving assumption here is: Any image generated by subtracting an image in Group 1 from its neighbor in Group 2 can be expressed as a linear combination of a dictionary of image patterns that distinguish the two groups. Our objective is to discover this dictionary of image patterns.\nTo do this, a large set of difference images is generated by subtracting every image in Group 1 from its neighbors in Group 2. From here on we assume all images to be vectors. Let us denote Group1 by S = {S 1 , ..., S n } and Group 2 by Z. For every element S i \u2208 S we first compute the r-nearest neighbors in Z using a Euclidean metric. Let us denote these by {Z 1 , ..., Z r } \u2282 Z. Subsequently we subtract these r images from S i to obtain difference vectors D ij\nWe collect these difference vectors into a matrix\nis the number of voxels in the image(usually d >> nr)."}, {"section_title": "Step 2: K-Singular Value Decomposition", "text": "For our approach, K-SVD solves a matrix decomposition problem to extract a dictionary of K patterns from X. The patterns in this dictionary can be combined to reconstruct any element of X. We want the image patterns discovered to be as global as possible. This is enforced in K-SVD by using the sparsity constraint which, prohibits the disintegration of large global image patterns into smaller local ones. Formally K-SVD decomposes the matrix X into a basis matrix B \u2208 IR d\u00d7K and a sparse loadings matrix C \u2208 IR K\u00d7nr such that X \u2248 BC. Hence, K-SVD attempts to solve:\nwhere c i are columns of the matrix C ,T \u2264 K is an integer that controls sparsity, ||.|| F is the Frobenius matrix norm and ||.|| 0 is the L 0 vector norm. The columns of B are the discriminative morphological patterns extracted from data. The loadings matrix C is used to rank the extracted patterns according to their importance. K-SVD uses an iterative two stage approach to solve (2) . In the first stage, the c i are computed for the current estimate of B. This is done by solving nr separate minimization problems using the orthogonal matching pursuit [13] algorithm. Note that each c i corresponds to the column x i of X:\nwhere ||.|| 2 denotes the L 2 norm. In the second stage the algorithm updates B one column at a time. For each column of B, denoted by b k , the corresponding error matrix E k is computed as:\nwhere b j are the columns of B andc k are the rows of C. This error matrix quantifies the estimation error that would result from the removal of b k . Next the basis vector b k is updated by solving:\nThis is solved using singular value decomposition (SVD). The b k obtained by minimization of (5) is used in the computation of b k+1 . When the entire matrix B is computed the algorithm returns to stage 1 and iterates. A finite number of iterations are run to generate the basis set B whose columns are the high dimensional morphological patterns representing group differences. For more details on K-SVD we consult the readers to [3] ."}, {"section_title": "Step 3: Ranking and Normalization of the K-SVD Bases", "text": "The larger the value of the L 2 norm of the rowc k the more prominently "}, {"section_title": "Results", "text": "The results of our experiments on simulated and real datasets are presented in the following section. The simulated data as well as real data was obtained from structural magnetic resonance images(MRI) acquired as a part of the ADNI [1] study. The MR scans are all T1-weighted, acquired sagittally using volumetric 3D MPRAGE with 1.25\u00d71.25 mm in plane spatial resolution and 1.2 mm thick sagittal slices. All images were acquired on a 1.5 T scanner."}, {"section_title": "Preprocessing Protocol", "text": "Each image was rigidly aligned using the Anterior Commissure Posterior Commissure (AC-PC) points followed by skull removal using the BET algorithm [12] . Skull stripped images were warped to a template using HAMMER [11] . Tissue density maps for grey matter (GM), white matter (WM) and ventricles (VN)\nwere then generated using the RAVENS approach [6] . These maps were generated from 127 images of Alzheimer's patients and 127 images of normal controls. All RAVENS maps were smoothed by an 8mm full width at half maximum (FWHM) Gaussian kernel before further processing."}, {"section_title": "Results on Simulated Datasets", "text": "Generation of Simulated Data We first tested PBM on simulated data. We select 63 GM RAVENS maps from normal subjects. Three regions labeled {a, b, c} are selected as shown in Fig. 1 . Two patterns of atrophy are introduced by reducing the RAVENS maps values in selected locations. Pattern P 1 at locations {a, b} and pattern P 2 at locations {b, c}. In 31 of the 63 images atrophy is introduced, either according to pattern P 1 or according to pattern P 2 . These 31 images now represent the patient group in our simulated dataset. The remaining 32 images are not modified and serve as controls."}, {"section_title": "Analysis of Results.", "text": "We apply the method described in Section 2 to this simulated dataset with r = 3 , T = 1, ..., K and for K = 2, ..., 7 . For every K, the algorithm produces K ranked basis images. Figure 1 shows the first two bases by rank for three different parameter settings.For visualization purposes the intensity histograms of the images corresponding to the patterns represented by each basis are scaled so that all voxel intensities lie between 0 and 1. It should be noted that the results for other parameter settings are almost the same. These results indicate that PBM can discover the patterns P 1 and P 2 introduced in the data as the first two basis.The figure also shows VBM analysis. It can be clearly seen that the t-statistic from the VBM analysis compares poorly against the PBM analysis. VBM identifies regions that are relatively consistently involved in all subjects, but it doesn't identify the distinct sub-patterns. Neither is it effective when only some of the subjects show involvement of some region (e.g. regions a and c)"}, {"section_title": "Results on Real Datasets", "text": "In this section we apply PBM on the GM,WM and VN RAVENS maps of 127 Alzheimer's patients and 127 normal controls from the ADNI study. We present results for parameter settings of R = 3, K = 5 and T = 3. Note that repeating experiments with several other parameter values does not change the results greatly. The results are presented in Fig.2, Fig. 3 and Fig. 4 . Figure 2 shows that the first two patterns detected by PBM in GM are distinct from each other. One involves the putamen more prominently than the other. The insula and thalamic nuclei and the putamen show up in the PBM analysis and have been previously associated with Alzheimer's disease [9] . The other regions that are shown to be strongly associated with disease in GM include the hippocampus, the parahippocampus, the temporal lobe, as well as the frontal lobe and occipital lobes. These regions are known to play a pivotal role in Alzheimer's pathology. These preliminary results indicate that PBM could offer diagnostic value in the analysis of medical image data. Figure 3 associates atrophy in most of the major white matter tracts with Alzheimer's pathology. There is recently published evidence [2] to suggest that this is indeed the case. In case of WM the 2 nd ranked pattern identified by PBM, highlights periventricular WM atrophy, a hallmark of late onset Alzheimer's disease [10] . Corpus callosum and splenium also show up in PBM analysis as being strongly associated with Alzheimer's pathology. PBM Analysis of VN Maps. Figure 4 presents the results of a PBM analysis of the ventricles. The top ranked patterns highlight ventricular expansion and periventricular disease oriented pathology. The ventricles are known to be dilated in Alzheimer's disease and the results of PBM are consistent with this fact."}, {"section_title": "PBM Analysis of GM Maps.", "text": ""}, {"section_title": "Discussion", "text": "In this paper we present a novel multivariate approach to morphometry, PBM, which does not suffer from the limitations of VBM described in [7] . PBM can identify subtypes of patterns that don't necessarily involve the same brain regions and facilitate a global analysis of heterogeneous diseases. A limitation of the presented work is that it lacks formal ways of establishing statistical significance. Although the results presented here seem stable with respect to the parameters R, K and T further work is needed in the direction of optimal parameter estimation as well as to exploration of robustness of the method with respect to parameter settings. A second direction of future exploration relates to the Euclidean distance metric used here to evaluate 'nearness' between images. This could be replaced by a different metric in future work possibly yielding better results. Also PBM could be extended to diffusion imaging, fMRI and longitudinal analysis. In summary we have developed and applied a multivariate morphometric framework to quantify group differences between different populations which overcomes some of the limitations of VBM."}]
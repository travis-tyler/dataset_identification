[{"section_title": "Abstract", "text": "We propose a prediction procedure for the functional linear quantile regression model by using partial quantile covariance techniques and develop a simple partial quantile regression (SIMPQR) algorithm to efficiently extract partial quantile regression (PQR) basis for estimating functional coefficients. We further extend our partial quantile covariance techniques to functional composite quantile regression (CQR) defining partial composite quantile covariance. There are three major contributions. (1) We define partial quantile covariance between two scalar variables through linear quantile regression. We compute PQR basis by sequentially maximizing the partial quantile covariance between the response and projections of functional covariates. (2) In order to efficiently extract PQR basis, we develop a SIMPQR algorithm analogous to simple partial least squares (SIMPLS). (3) Under the homoscedasticity assumption, we extend our techniques to partial composite quantile covariance and use it to find the partial composite quantile regression (PCQR) basis. The SIMPQR algorithm is then modified to obtain the SIMPCQR algorithm. Two simulation studies show the superiority of our * Corresponding author Email address: lkong@ualberta.ca (Linglong Kong) 1 Part of the data used in preparation of this article were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (adni.loni.ucla.edu). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at: http://adni.loni.ucla.edu/wp-content/ uploads/how to apply/ADNI Acknowledgement List.pdf proposed methods. Two real data from ADHD-200 sample and ADNI are analyzed using our proposed methods."}, {"section_title": "Introduction", "text": "Nowadays, there is great need in the analysis of complex neuroimaging data obtained from various cross-sectional and clustered neuroimaging studies. These neuroimaging studies are essential to advancing our understanding of the neural development of neuropsychiatric and neurodegenerative disorders, substance use disorders, the normal brain and the interactive effects of environmental and genetic factors on brain structure and function. Such large imaging studies include the ADNI (Alzheimer's Disease Neuroimaging Initiative), the longitudinal magnetic resonance imaging (MRI) study of schizophrenia, autism, and attention deficit hyperactivity disorder (ADHD), the NIH human connectome project, among many others. Neuroimaging studies usually collect structural, neurochemical, and functional images over both time and space [15, 16, 33] . These structural, neurochemical, and functional imaging modalities include computed axial tomography (CT), diffusion tensor imaging (DTI), functional magnetic resonance imaging (fMRI), magnetic resonance imaging (MRI), magnetic resonance spectroscopy (MRS), positron emission tomography (PET), single photon emission tomography (SPECT), electroencephalography (EEG), and magnetoencephalography (MEG), among many others. For instance, by using anatomical MRI, various measures of the morphology of the cortical and subcortical structures (e.g., hippocampus) are extracted to understand neuroanatomical differences in brain structure across different populations [14, 36] . In DTI, various diffusion properties and fiber tracts are extracted for quantitative assessment of anatomical connectivity across different populations [4, 48, 49, 50] . Functional images, such as resting-state functional MRI (rsfMRI), have been widely used in behavioral and cognitive neuroscience to understand functional segregation and integration of different brain regions across different populations [21, 34] .\nA common feature of many imaging techniques is that massive functional data are observed/calculated at the same design points, such as time for functional images (e.g., PET and fMRI) and arclength for structure imaging the functional linear regression model is of the form\nwhere \u03b1 is the intercept, \u03b2 = (\u03b2 1 , \u00b7 \u00b7 \u00b7 , \u03b2 p ) T is a p \u00d7 1 vector of coefficients, x i = (x i1 , \u00b7 \u00b7 \u00b7 , x ip )\nT is a p \u00d7 1 vector of scalar covariates of interest, \u03b3(t) = (\u03b3 1 (t), \u00b7 \u00b7 \u00b7 , \u03b3 q (t))\nT is a q \u00d7 1 vector of coefficient functions of t, z i (t) = (z i1 (t), \u00b7 \u00b7 \u00b7 , z iq (t))\nT is a q \u00d7 1 vector of functional covariates, and i is a random error. It is usually assumed that i is independent and identical copy of normal distribution with zero mean and variance \u03c3 2 . For simplicity, we let t \u2208 [0, 1]. Model (1) is a generalization of the classical linear regression model corresponding to the case \u03b3(t) is a constant. If it is not constant, the contributions of z i (t) characterized by \u03b3(t) change in terms of t. The model has been well studied and applied in many fields including neuroimaging data analysis [2, 23, 29, 37] . To facilitate the estimation of \u03b3(t), we usually require that it satisfies certain smoothness conditions and restrict it onto a functional space. For example, we may require that it its second derivative exists and that the square of \u03b3(t) is integrable, that is, \u03b3(t) \u2208 L 2 [0, 1]. Even in such a case, the estimation is still an infinite-dimensional problem.\nThe common practice is to project \u03b3(t) into a functional space with a finite functional basis. There are three major methods to choose the functional basis: general basis, functional principal component basis (fPC), and partial least square basis (PLS). There are various options on the selection of general basis, for example B-spline basis [6, 9] , wavelet basis [45] and so on. In order to provide a good approximation of the functional coefficients, a large number of basis should be chosen. However, this may cause overfitting of the model and to remedy that various penalty methods have been proposed [10, 44] . The fPC method has been extensively studied [19, 27] where the fPC of z i (t) serve as the basis. Its generalization to the reproducing kernel Hilbert space (RKHS) was proposed by Cai and Yuan [7, 43] who also studied its minimax rates. Although fPC basis are more data-adapted than the general basis as they use the information of functional covariates and the formed space can explain most of the variation of z i (t), it is not necessary all the fPC basis will contribute to the variation of the responses. Therefore, another appealing choice is the PLS basis which use both the information of functional covariates and the responses. The PLS basis use the linear projects of z i (t) which best predict the responses [12] .\nAn alternative to model (1) is the functional linear quantile regression where the conditional quantiles of the responses are modeled by a set of scalar covariates and functional covariates. There are at least three advantages to use conditional quantiles instead of conditional means. First, quantile regression, in particular median regression, provides an alternative and complement to mean regression while being resistant to outliers in responses. It is more efficient than mean regression when the errors follow a distribution with heavy tails. Second, quantile regression is capable of dealing with heteroscedasticity, the situation when variances depend on some covariates. More importantly, quantile regression can give a more complete picture on how the responses are affected by covariates: for example, some tail behaviors of the responses conditional on covariates. For more background on quantile regression, see the monograph of Koenker [25] . In our case, we consider functional linear quantile regression: for given \u03c4 \u2208 (0, 1),\nwhere Q \u03c4 (y i |x i , z i (t)) is the \u03c4 -th conditional quantile of y i given covariates x i and z i (t), \u03b1 \u03c4 is the intercept,\nT is a q \u00d7 1 vector of coefficient functions. In the existing literature, model (2) has been well studied and various methods have been proposed. As in functional linear regression, to estimate functional coefficients \u03b3 \u03c4 (t) it is convenient to restrict it in a functional space with a finite basis. Similarly, general basis like B-spline can be used to approximate the coefficient functions [8, 39] . fPC basis have also been throughly investigated with and without scalar covariate x i while only one functional covariate presents [24, 32, 40] . However, there is no analogue to the PLS basis method in functional linear regression model. Therefore, none of the existing methods for model (2) is able to provide more efficient prediction by extracting information from the responses.\nIn this paper, we propose a prediction procedure for the functional linear quantile regression model (2) by using partial quantile covariance techniques and develop an algorithm inspired by simple partial linear regression, SIM-PLS [11] , to efficiently extract partial quantile regression (PQR) basis for estimating functional coefficients. We further extend our partial quantile covariance techniques to functional composite quantile regression (CQR) [51] by defining partial composite quantile covariance. The major contributions of this paper can be summarized as follows. We first define partial quantile covariance between two scalar variables through linear quantile regression. Motivated by extracting PLS basis in functional linear regression, we found PQR basis by sequentially maximizing the partial quantile covariance between the response and projections of functional covariates. In order to efficiently extract PQR basis, we develop a simple partial quantile regression (SIMPQR) algorithm analogue to SIMPLS. Under the homoscedasticity assumption, we extend our techniques to partial composite quantile covariance and use it to find the partial composite quantile regression (PCQR) basis. The SIMPQR algorithm is then modified to obtain the SIMPCQR algorithm.\nThe rest of this paper is organized as follows. In Section 2, we define partial quantile covariance and describe how to use it to extract PQR basis in functional linear quantile regression model. In Section 3, we develop the SIMPQR algorithm and discuss its properties. We discuss how to calculate the PCQR basis by using partial composite quantile covariance and propose the SIMPCQR algorithm in Section 4. Two sets of simulation studies are presented in Section 5 with the known ground truth to examine the finite sample performance of our proposed methodology. In Section 6, we use PQR and PCQR to predict ADHD index and MMSE using data from NYU site from ADHD-200 sample and ADNI, respectively. Some discussions and 6 future research directions are given in Section 7."}, {"section_title": "Partial Functional Linear Quantile Regression", "text": "In model (2), we assume without loss of generality that t \u2208 [0, 1] and restrict the functional coefficients \u03b3 \u03c4 (t) \u2208 L 2 [0, 1]. For simplicity, we assume q = 1, that is, we only consider one functional covariate. The extension of our methodology to more functional covariates is straightforward. The estimation \u03b3 \u03c4 (t) is in general a difficult question as it lies in an infinitedimensional space. However, if it can be well approximated in a finite element space, say, H[0, 1], the solution for the model (2) can be found. Let b k\u03c4 (t), (2) can be then rewritten as\nwhere\nis simply a linear quantile regression problem, which is essentially a linear programing problem; its solutions can be obtained by many algorithms-for example, the simplex method [5] , the interior point method [25] , the MM algorithm [22] and many others, already implemented in various statistical softwares like quantreg in R [26] .\nIn the literature, there are many methods devoted to find the crucial basis functions in model (3) . The general basis B-spline was proposed and studied by Cardot and others [8, 39] . In various models, fPC basis has also been studied [24, 32, 40] . However, neither basis does use information of the responses and hence they are less efficient to do prediction. In this session, as the motivation of our proposal, we first review the PLS basis in model (1) where both information of the functional covariates and the responses are used to choose the basis functions. Then we propose our developed methodology to choose basis for model (2) , namely, partial quantile regression (PQR) basis.\nIn functional linear regression model (1), the first PLS basis is chosen to be\nwhich is the analogue to the partial least square regression in multivariate analysis. The subsequent basis is chosen by iteratively using (4) after taking account of and subtracting the information from previous basis. For more details, see Delaigle and Hall [12] . The essential idea of criteria (4) is to find a direction b(t) so that the projection of Z(t) on it explains as much as possible the variation of the response after adjusting some covariates. Therefore, as shown in [12] , it is equivalent to find a basis b(t) such that the partial covariance\nis maximized, where\nT . Based on this equation, Delaigle and Hall [12] found an equivalent space with the same dimension as the PLS space and proved the estimation and precision consistency.\nThe parameters in model (2) are estimated by solving\nwhere \u03c1 \u03c4 (u) = u(\u03c4 \u2212 I(u < 0)) is the quantile loss function [25] with I as the indicator function. When \u03c4 = 0.5, the loss is \u03c1 \u03c4 (u) = |u|/2 and the results is then the median, or least absolute deviation (LAD) regression. To adapt to the idea of PLS basis, that is, to find a direction b \u03c4 (t) so that the projection of z(t) on it contributes as much as possible to predict the quantile of the response after adjusting some covariates, we first propose the concepts of quantile covariance (QC) and partial quantile covariance (PQC). For given \u03c4 \u2208 (0, 1) and a random variable X, the partial quantile covariance COV qr (Y, Z) between two random variables Y and Z is of the form\nwhere we first normalize Z to have mean zero and variance one. If there is no X, then COV qr (Y, Z) is quantile covariance between Y and Z. The quantile covariance measures the contribution of Z to the \u03c4 -th quantile of Y . It was first proposed and studied by Dodge and Whittaker [13] in the context of partial quantile regression. Li, Li and Tsai [28] proposed a similar concept of quantile correlation and used it to study quantile autoregressive model.\nTo find the partial quantile regression basis (PQR), similar to that of PLS to maximize the covariance we propose to compute the b \u03c4 (t) by maximizing\nThe subsequent basis is computed by iteratively maximizing (8) after taking account of and subtracting the information of the previous basis. Let\nis the k-th PQR basis. Denote Z (k+1) (t) as Z(t) after subtracting the information from the first k basis. Then the (k + 1)-th basis b (k+1)\u03c4 (t) is obtained by maximizing the partial quantile covariance\nWe will discuss detailed algorithms in the next section. Once we find an adequate number, K of functional basis elements, we have the approximation model (3), where the parameters are obtained by minimizing\nThe number of PQR basis can be chosen use BIC or cross validation (CV) as in choosing the number of fPC basis adapted by Kato and other authors [24, 40, 32] ."}, {"section_title": "SIMPQR Algorithm", "text": "In this section, we propose a simple partial quantile regression (SIMPQR) algorithm to iteratively extract the PQR basis from the functional covariates z(t). Similar algorithm has been studied by Dodge and Whittaker [13] in partial quantile regression with multiple covariates. It is parallel to the SIMPLS for partial least square regression [11] . The motivation is to subsequently maximize (8) after accounting and subtracting the information of the previous basis. To simplify the description of the SIMPQR algorithm, we will drop the scalar covariates x in model (9) in this section. Let 0 < t 1 < \u00b7 \u00b7 \u00b7 < t m < 1 denote the discretized sample points for the functional covariates and we assume they are equally spaced. Recall that we set q = 1 and we focus on only one functional covariate z(t). The SIMPQR algorithm is described as follows.\nStep 1, Initialization: Normalize z i (t j ) for each j so that it has mean zero and variance one.\nStep 2, Repeat:\nT as the projections for each subjects. 3. Predict z i (j) by using simple linear regression with the projection z i as the covariate, denoting the result by\u1e91 i (j). 4. Subtract the information from the projection z i by replacing z i (j) by their residuals z i (j) \u2212\u1e91 i (j).\nStep 3, Stop: Check stopping criterion and retain the projections Z 1 , . . . , Z K .\nStep 4, Model: Fit the model (3) by minimizing equation (10) .\nThe SIMPQR algorithm follows the same line of SIMPLS with the covariance being replaced by quantile covariance. The nature of our proposed quantile covariance implies that it is not necessary to adjust the response Y each time after a new basis is obtained. The resulting functional basis is orthogonal to each other due to the prediction in step 2.3. However, it is worth noting that due to the nonadditivity of conditional quantiles, we need to fit model (3) after all the basis elements are picked out, instead of estimating the coefficients of each basis projections once they are chosen."}, {"section_title": "Partial Functional Linear Composite Quantile Regression", "text": "Despite the success of quantile regression (QR), its relative efficiency to the least square regression can be arbitrarily small [25, 51] . Composite quantile regression (CQR) proposed by Zou and Yuan [51] inherits some good properties of QR and is capable of providing more efficient estimators under certain conditions. Given two random variables X and Y and quantile level set 0 < \u03c4 1 \n10 where \u03c1 \u03c4 l is the \u03c4 l -th quantile loss function. Under the homoscedasticity assumption, that is, the model errors do not depend on covariates, all conditional regression quantiles are parallel and they have the same slope \u03b2 but different intercepts. The CQR is equivalent to fit QR at different quantile levels. However, CQR estimators are more efficient. For given 0 < \u03c4 1 < \u00b7 \u00b7 \u00b7 < \u03c4 L < 1 and a random variable X similar to (7), the partial composite quantile covariance (PCQC) COV cqr (Y, Z) between two random variable Y and Z is of the form\nwhere we first normalize Z to have mean zero and variance one. If there is no X, then COV cqr (Y, Z) is composite quantile covariance (CQC) between Y and Z. The composite quantile covariance measures the contribution of Z to the quantiles of Y at levels 0 < \u03c4 1 < \u00b7 \u00b7 \u00b7 < \u03c4 L < 1. There are some connections between composite quantile covariance and covariance; however, these are beyond the scope of this paper and we plan to discuss them elsewhere.\nWith the definition of PCQC, we can obtain the PCQR basis for functional linear composite quantile regression by maximizing\nfor a given quantile level set 0 < \u03c4 1 < \u00b7 \u00b7 \u00b7 < \u03c4 L < 1. The subsequent basis is computed by iteratively maximizing (13) after accounting and subtracting the information of the previous basis. Once the PCQR basis is found, the functional linear composite quantile regression can be easily fitted by a linear program, for example quantreg in R [26] . The algorithm to compute the PCQR basis follows the same line of SIMPQR in the last section; we only need to replace COV qr by COV cqr in step 2.1 and keep the rest unchanged."}, {"section_title": "Simulation Studies", "text": "In this section, we investigate the finite sample performance of our proposed prediction methods, namely partial quantile regression (PQR) basis and partial composite quantile regression (PCQR) basis methods. We compare them with the fPC basis method in functional linear quantile regression (QRfPC) and functional linear composite quantile regression (CQRfPC) models. In addition, we compare them with PLS basis and fPC basis methods in functional linear regression model. We conduct our simulations in two settings where the first one is in favor of the fPC basis and the second one is a more general case. Both simulations show superior or comparable performance of our proposed methods.\nSimulation I. In this simulation, we adapt the setup in Kato [24] . In particular, the model is of the form\nEach X i (t) was observed at m = 201 equally spaced grid points on [0, 1]. We choose the sample size n to be 100, 200, and 500. The error \u03b5 follows either Gaussian with mean zero and variance one or Cauchy distribution. In this design we have\nwhere F \u03b5 is the cumulative distribution function of \u03b5. It should be pointed out that the simulation set up is in favor of fPC basis methods as the functional coefficients lie on the same fPC space of functional covariates. It is expected that fPC basis methods may be superior to other methods.\nTo facilitate the comparison, we set \u03c4 = 0.5T for QR methods and \u03c4 l = l/(1 + L) with L = 9 for CQR methods. One criteria we use is the mean integrated errors (MISE) of the functional coefficients,\nwhere\nIn the simulation, we set the total number of replication S = 100. For the first three cutoff levels, Table 1 gives us a summary of the different configurations of parameters for the six methods. Although the simulation design is in favour of fPC based methods, for the small number of cutoff levels, the PLS, PQR and PCQR methods perform better regarding the performance measurements of Bias 2 and MISE. Due to the natures of sensitivity against skewness of errors, Figure 2 shows that the performances of PLS and fPC are much worse in general compared with the other four methods when the errors follow the Cauchy distribution. On the other hand, when the Gaussian errors are employed, for the lower cutoff levels, the PLS, PQR and PCQR methods are very similar. And when the number of cutoff levels becomes larger, the PCQR performs slightly better than the PLS while PQR performs much better than the PCQR. fPC based methods are similar to each other crossing all cutoff levels.\nThe averaged mean squared error (MSE) of the responses is another prediction performance criteria we consider. Figure 3 indicates that the prediction errors are much lower for PLS, PQR, PCQR methods compared with those for fPC based methods, due to the fact that fPC based methods are only data driven while the other three methods are both data and response adapted. For the Gaussian errors, although with regard to the functional coefficients estimation PQR is better than both PLS and PCQR methods, taking into consider of the prediction errors, the PLS and PCQR methods perform better than PQR. For the Cauchy errors, PQR performs the best out of the PLS, PQR, PCQR methods which indicates that PQR is more robust against the skewness of error distribution.\nSimulation II. In this simulation, we take the Z i (t)s from a real data study, and generate the Y i s according to the linear model of\nwhere the error \u03b5 is taken as Gaussian and Cauchy. The centres of errors are taken as zero while the scales are taken as the empirical standard deviation of the true responses multiplied by \u221a 5. The Z i s are taken from a benchmark Phoneme dataset, which can be downloaded from http://statweb.stanford.edu /\u223ctibs/ElemStatLearn/. In these data, Z i (t) represents log-periodgrams constructed from recordings of different phonemes. The periodgrams are available at 256 equally-spaced frequencies t, which for simplicity we denote by 0 = t 1 < t 1 < . . . < t m = 1, where m = 256 [20] . We used n = 1717 data curves Z i (t) that correspond to the phonemes \"aa\" as in \"dark\" and \"ao\" as in \"water\". This example can also be found in [12] .\nComputing the first J = 20 empirical fPCbasis functions\u03c6 1 (t), . . . ,\u03c6 J (t), we consider four different curves \u03b3(t) by taking \u03b3(t) = J j=1 a j\u03c6i (t) for four different sequence of a j s:\nGoing through case (i) to (iv), the models become less favorable for fPC, while we will see the PLS, PQR and PCQR methods manage to capture the interaction between Z and Y using only a few terms.\nWe take \u03c4 = 0.5 and compare the six methods by looking at the MISE, Bias 2 and Var. As shown in Figure 4 , from case (i) to (iv), PLS, PQR and PCQR methods perform better and better compared with the fPC based methods. In fact, all the PLS, PQR and PCQR methods manage to obtain a very good fitting using only a much small number of components no matter how the errors are distributed. This shows great superiority of our proposed methods when the functional coefficients do not lie on the fPC space. Figure 5 displays the prediction errors MSE when the errors follow Gaussian (left panels) and Cauchy (right panels) distributions. The PLS, PQR and PCQR methods predict better in general compared with fPC based methods. Except for the PLS of Cauchy errors, the MSEs of PQR and PCQR methods decrease immediately with the increase of cutoff levels, while the fPC based methods performed differently under each case. From case (i) to (iv), the MSEs of fPC based methods begin to drop significantly after a larger and larger cutoff level. And for the same cutoff levels, the differences of the prediction errors between the PLS, PQR and PCQR methods and the fPC based methods become more and more signifiant from case (i) to (iv).\nOne interesting phenomenon here is that although the PCQR method outperforms the PQR method when the errors are Gaussian distributed, the PQR method regains its superiority when the errors are Cauchy distributed. Compared with what we have observed from simulation I, it may indicate that the PCQR method is only a slightly less favourable alternative to the PLS method when the errors are symmetric. On the other hand, when the errors are distributed in an extremely skewed manner, the PCQR method could not out-perform the PQR method. That is exactly the same situation as the fPC based methods when the CQR method is implemented."}, {"section_title": "Real Data Analysis", "text": "Real Data Analysis I: ADHD-200 fMRI Data. We apply our proposed method to a dataset on attention deficit hyperactivity disorder (ADHD) from the ADHD-200 Sample Initiative Project. ADHD is the most commonly diagnosed behavioral disorder of childhood, and can continue through adolescence and adulthood. The symptoms include lack of attention, hyperactivity, and impulsive behavior. The dataset we use is the filtered preprocessed resting state data from New York University (NYU) Child Study Center using the Anatomical Automatic Labeling (AAL) [42] atlas. AAL contains 116 Regions of Interests (ROI) fractionated into functional space using nearest-neighbor interpolation. After cleaning the raw data that failed in quality control or has missing data, we include 120 individuals in the analysis.\nThe response of interest is the ADHD index, Conners' parent rating scalerevised, long version (CPRS-LV), a continuous behavior score reflecting the severity of the ADHD disease. In the AAL atalas data, the mean of the grey scale in each region is calculated for 172 equally spaced time points. We choose six parts of the brain which contain at least 4 ROIs, namely cerebelum, temporal, vermis, parietal, occipital, and frontal. The six functional predictors for each candidate part are computed by taking the average grey scale of the ROIs corresponding to each part, see Figure 1 (Left) for some selected subjects at cerebellum. The scalar covariates of primary interest include gender (female/male), age, handedness (continuous between -1 and 1, where -1 denotes totally left-handed and 1 denotes totally right-handed), diagnosis status (categorical with 3 levels: ADHD-combined, ADHD-inattentative and Control as baseline), medication status (yes/no), Verbal IQ, Performance IQ and Full4 IQ. We build model to predict ADHD index adjusting these 9 scalar covariates (coded with dummy variables) using each of the six functional predictors. We consider the models for each individual functional covariates adjusting for the 9 scalar covariates. Figure 6 displays the changes of MSEs for all six methods, with the increase of the number of cutoff level L for different brain regions. Here the quantile level \u03c4 is chosen to be fixed as 0.5. As shown in the figure, PLS, PQR and PCQR methods perform much better than the fPC based methods while PCQR shows a significant superiority. In general, for each method only a few basis functions is capable of predicting the response well and additional basis functions do not decrease MSE much. This is more obvious for PLS, PQR and PCQR methods as they consider information from the response while choose basis functions.\nReal Data Analysis II: ADNI DTI Data. We use our model methods to analyze a real DTI data set with n = 214 subjects collected from NIH Alzheimer's Disease Neuroimaging Initiative (ADNI) study. Data used in the preparation of this article were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (adni.loni.ucla.edu). The ADNI was launched in 2003 by the National Institute on Aging (NIA), the National Institute of Biomedical Imaging and Bioengineering (NIBIB), the Food and Drug Administration (FDA), private pharmaceutical companies and non-profit organizations, as a $60 million, 5-year public private partnership. The primary goal of ADNI has been to test whether serial magnetic resonance imaging (MRI), positron emission tomography (PET), other biological markers, and clinical and neuropsychological assessment can be combined to measure the progression of mild cognitive impairment (MCI) and early Alzheimer's disease (AD). Determination of sensitive and specific markers of very early AD progression is intended to aid researchers and clinicians to develop new treatments and monitor their effectiveness, as well as lessen the time and cost of clinical trials. The Principal Investigator of this initiative is Michael W. Weiner, MD, VA Medical Center and University of California, San Francisco. ADNI is the result of efforts of many coinvestigators from a broad range of academic institutions and private corporations, and subjects have been recruited from over 50 sites across the U.S. and Canada. The initial goal of ADNI was to recruit 800 subjects but ADNI has been followed by ADNI-GO and ADNI-2. To date these three protocols have recruited over 1500 adults, ages 55 to 90, to participate in the research, consisting of cognitively normal older individuals, people with early or late MCI, and people with early AD. The follow up duration of each group is specified in the protocols for ADNI-1, ADNI-2 and ADNI-GO. Subjects originally recruited for ADNI-1 and ADNI-GO had the option to be followed in ADNI-2. For up-todate information, see www.adni-info.org. The significance level is an ongoing public-private partnership to test whether genetic, structural and functional neuroimaging, and clinical data can be integrated to assess the progression of mild cognitive impairment (MCI) and early Alzheimer's disease (AD). The structural brain MRI data and corresponding clinical and genetic data from baseline and follow-up were downloaded from the ADNI publicly available database (https://ida/loni/usc/edu).\nThe DTI data were processed by two key steps including a weighted least squares estimation method Basser et al. [3] ; Zhu et al. [50] to construct the diffusion tensors and a FSL TBSS pipeline Smith et al. [38] to register DTIs from multiple subjects to create a mean image and a mean skeleton. Speciffically, maps of fractional anisotropy (FA) were computed for all subjects from the DTI after eddy current correction and automatic brain extraction using FMRIB software library. FA maps were then fed into the TBSS tool, which is also part of the FSL. In the TBSS analysis, the FA data of all the subjects were aligned into a common space by non-linear registration and the mean FA image were created and thinned to obtain a mean FA skeleton, which represents the centers of all WM tracts common to the group. Subsequently, each subjects aligned FA data were projected onto this skeleton. We focus on the midsagittal corpus callosum skeleton and associated FA curves from all subjects, see Figure 1 (Right) for some selected subjects. The corpus callosum (CC) is the largest fiber tract in the human brain and is a topographically organized structure, see Figure 7 (Left). It is responsible for much of the communication between the two hemispheres and connects homologous areas in the two cerebral hemispheres. It is important in the transfer of visual, motoric, somatosensory, and auditory information.\nWe are interested in predicting mini-mental state examination (MMSE) scores, one of the most widely used screening tests, which are used to provide brief, objective measures of cognitive functioning for almost fifty years. The MMSE scores has been seen as a reliable and valid clinical measure quantitatively assessing the severity of cognitive impairment. It was believed that the MMSE scores to be affected by demographic features such as age, education and cultural background, but not gender [41] . After quality control and excluding the missing data, we include 200 subjects from the total 217 subjects. The functional covariate is fractional anisotropy (FA) values along the corpus callosum (CC) fiber tract with 83 equally spaced grid points, which can be treated as a function of arc-length. The scale covariates are the gender variable (coded by a dummy variable indicating for male), the age of the subject (years), the education level (years), an indicator for Alzheimer's disease (AD) status (19.6%) and an indicator for mild cognitive impairment (MCI) status (55.1%), and genotypes for apolipoprotein E -4 (coded by three indicator variables for four levels).\nThe MSEs are shown in figure 7 . In general, PLS, PQR and PCQR methods present consistently better than fPC based methods while PCQR outperforms PQR and PCQR methods. The phenomenon has been observed from the previous read data analysis, which indicates that for brain imaging data PCQR method has a improved prediction accuracy compared with PQR and PCQR methods. With the number of functional basis increases, the MSEs do not decreases much for fPC based methods while constantly decrease for PLS, PQR and PCQR methods. This indicates that the fPC basis is not suitable to do prediction though they may account a large portion of the variations of functional covariates. The PLS, PQR and PCQR methods is capable of explaining a large percentage variation of the response and reducing the MSEs by proving appropriate basis functions. Our proposed methods show great superiority to the fPC based methods and the PLS methods and provide a powerful tool to do prediction in practice."}, {"section_title": "Discussion", "text": "In this paper, we first define the concept partial quantile covariance (PQC) to measure the contribution of one covariate to the response. We then propose the partial functional linear quantile regression method to use partial quantile regression (PQR) to extract PQR basis to effectively predict the response. This is motivated by the success of the partial least square (PLS) basis in functional linear regression model. The key idea is to use both information from the functional covariates and the response and therefore both PQR basis and PLS basis can be treated as supervised learning while fPC based methods are semi-supervised learning as they only use information from the functional covariates. The algorithm SIMPQR we developed is analogue to that of SIMPLS. We extend PQC to partial composite quartile covariance (PCQC) and propose the PCQR basis and its SIMPCQR algorithm under the homoscedasticity condition.\nThe simulations show that PLS, PQR and PCQR in general perform better than the fPC based methods. However, PQR method is more robust against skewness of error distribution while the PLS and PCQR methods act similarly to each other and perform better than PQR method when the error distribution is symmetric. This advantage from PQR method can be explained by the general nature of quantile method which obtains its robustness by sacrificing certain efficiency. By assuming homoscedasticity, the PCQR method acts similarly to the PLS method when the error distributions are symmetric but retains its robustness when the error distributions are extremely skewed.\nOur proposed methods, PQR and PCQR methods, significantly outperform other methods, especially those fPC based methods in both ADHD-200 fMRI data analysis and ADNI DTI data analysis. In ADHD-200 fMRI data analysis, our methods are capable of reducing much more MSEs by using only a few basis while fPC based method are not even by adding more basis. In ADNI DTI data analysis, both PQR and PCQR methods reduce significant amount MSEs with more and more basis. On the other hand, fPC based methods perform poor even with more basis. Overall in the two neuroimaging data analysis, PCQR performs slightly better than PQR though.\nThe consistency of the PLS methods was proved by Delaigle and Hall [12] where they found an equivalent space with explicit expressed basis functions to the PLS basis space. For PQR and PCQR methods, it is difficult to find such equivalent space and therefore their consistency may not be easy to show. The difficulty of the problem lies on the iterative nature of PQR and PCQR methods where basis is sequentially extracted. One way to overcome that is to find preselected number of basis simultaneously [47] . Another direction is to impose certain structure on the selected basis, for example, sparsity and smoothness in PLS methods [35] . This can be done for simultaneous basis selection as well [46] .\nIn both simulation studies and real data analysis, only univariate functional covariate case is considered. However, the extension of PQR and PCQR methods to multivariate functional covariates is straightforward. The computation becomes more complex and intensive due to the iterative basis extraction nature. Such complexity is expected to be significantly reduced by applying simultaneous basis selection or imposing certain structure on the selected basis. Further details are out of the scope of this manuscript and will be pursuit in the future research. "}]